@interface MADAutoAssetControlManager
+ (BOOL)assetBeingGarbageCollected:(id)collected atEmergencyUrgency:(BOOL)urgency;
+ (BOOL)assetSetToBeIncluded:(id)included consideredClientDomain:(id)domain basedOnControl:(id)control;
+ (BOOL)autoSetJobAvailableAtomicInstanceForSetDescriptor:(id)descriptor;
+ (BOOL)descriptorToBeIncluded:(id)included basedOnControl:(id)control;
+ (BOOL)isMessageNameForSetMessage:(id)message;
+ (BOOL)jobDescriptorOnFilesystemConfirmed:(id)confirmed;
+ (BOOL)persistSetJobDescriptor:(id)descriptor withCurrentSetStatus:(id)status withFirstClientName:(id)name fromLocation:(id)location;
+ (BOOL)preferenceAlwaysPromoteStagedAssets;
+ (BOOL)preferenceAsIfBackgroundOrUse:(BOOL)use;
+ (BOOL)preferenceAsIfRampOrUse:(BOOL)use;
+ (BOOL)preferenceAutoAssetLogSetCompare;
+ (BOOL)preferenceAutoAssetNoPersistedOverflowLimit;
+ (BOOL)preferenceAutoAssetObserverIgnoreNetworkStatus;
+ (BOOL)preferenceForceStartupHealthReport;
+ (BOOL)preferencePerformanceLoggingEnabled;
+ (BOOL)preferencePersistedTableLoggingEnabled;
+ (BOOL)preferenceScheduledAlwaysNonDiscretionary;
+ (BOOL)preferenceScheduledAsIfNotInternal;
+ (BOOL)preferenceScheduledBackupTriggersDisabled;
+ (BOOL)preferenceSecureSimulateFailureAll;
+ (BOOL)preferenceSecureSimulateGraftFailure;
+ (BOOL)preferenceSecureSimulateRequireAll;
+ (BOOL)preferenceStagerDetermineLastRequiredTimesOut;
+ (BOOL)preferenceStagerDownloadFirstNotInCatalog;
+ (BOOL)preferenceStagerInjectAvailableDups;
+ (BOOL)preferenceStagerInjectAvailableOlderVersions;
+ (BOOL)preferenceStagingLookupFlipRequiredOptional;
+ (BOOL)preferenceStartupSimulateFirstBoot;
+ (BOOL)selectorToBeIncluded:(id)included basedOnControl:(id)control;
+ (id)_getAutoControlManagerStateTable;
+ (id)allocIntervalString:(int64_t)string;
+ (id)assetTypeForClientDomainName:(id)name forSetIdentifier:(id)identifier alreadyOnStateQueue:(BOOL)queue;
+ (id)autoControlManager;
+ (id)buildDirectivesSummary;
+ (id)createSeverMessageWithName:(id)name sender:(id)sender clientID:(id)d response:(id)response error:(id)error;
+ (id)fileManagerFailureErrorString;
+ (id)getHealthReportForSets:(id)sets;
+ (id)loadDescriptorsForJobSelector:(id)selector promotingIfCurrentlyStaged:(id)staged immediatelyPromotedDescriptor:(id *)descriptor;
+ (id)localAssetURLForAtomicEntry:(id)entry;
+ (id)localAssetURLForDescriptor:(id)descriptor fromLocation:(id)location;
+ (id)newAtomicInstancesDownloadedForSetIdentifier:(id)identifier;
+ (id)newSummaryForRequestMessage:(id)message includingSelector:(BOOL)selector;
+ (id)newSummaryForSetRequestMessage:(id)message includingSetAtomicInstance:(BOOL)instance;
+ (id)newestDownloadedForSetDescriptor:(id)descriptor;
+ (id)preferenceActivityAggressiveAssetType;
+ (id)preferenceActivityHeightenedAssetType;
+ (id)preferenceAsIfBootedOSIsBuildVersion;
+ (id)preferenceAsIfBootedOSIsOSVersion;
+ (id)preferenceConnectorBackoffRetryTimes;
+ (id)preferenceHealthReportAdditionalSetNames;
+ (id)preferenceScheduledOnlyForAssetTypes;
+ (id)preferenceSessionIDBase;
+ (id)replyMessageNameForRequest:(id)request;
+ (id)restoreVersionFromOSVersion:(id)version;
+ (id)selectDispatchQueue:(id)queue;
+ (id)stagerSetPolicy;
+ (int64_t)preferenceActivityAggressiveIntervalSecs;
+ (int64_t)preferenceActivityHeightenedIntervalSecs;
+ (int64_t)preferenceActivityIntervalSecs;
+ (int64_t)preferenceActivityTickerSecs;
+ (int64_t)preferenceBeforeFirstDefaultTimeoutSecs;
+ (int64_t)preferenceBeforeFirstPollSecs;
+ (int64_t)preferenceConnectorInitialWaitSecs;
+ (int64_t)preferenceConnectorWaitBeforeRetrySecs;
+ (int64_t)preferenceLookupCacheAssetSelectorValidSecs;
+ (int64_t)preferenceLookupCacheSetConfigurationValidSecs;
+ (int64_t)preferenceMaxStagerDeterminingSecs;
+ (int64_t)preferenceMaxStagerFilesystemMegabytes;
+ (int64_t)preferencePushActivityIntervalSecs;
+ (int64_t)preferenceSimulatedDownloadFailureResult;
+ (int64_t)preferenceSimulatedStagingLookupFailureResult;
+ (int64_t)preferenceStagerDeterminePallasResponseFewer;
+ (int64_t)previousOTASituation;
+ (void)analyticsReportSecureOperationResults:(id)results clientName:(id)name secureReason:(id)reason operation:(int64_t)operation fromLocation:(id)location mountError:(id)error graftError:(id)graftError personalizeError:(id)self0 mapToExclaveError:(id)self1;
+ (void)assetConfigJobFinished:(id)finished withDownloadInfo:(id)info error:(id)error;
+ (void)assetDownloadJob:(id)job progressReport:(id)report;
+ (void)assetDownloadJobFinished:(id)finished error:(id)error;
+ (void)autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger:(id)trigger;
+ (void)autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger:(id)trigger;
+ (void)autoAssetJobFinished:(id)finished withAutoAssetUUID:(id)d schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure;
+ (void)autoAssetJobIssueProgress:(id)progress forAutoAssetSelector:(id)selector withAutoAssetUUID:(id)d withJobInformation:(id)information withResponseError:(id)error;
+ (void)autoAssetJobIssueReply:(id)reply forAutoAssetSelector:(id)selector withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withOriginalSelector:(id)originalSelector withJobInformation:(id)information withResponseError:(id)error;
+ (void)autoAssetJobObtainLookupGrant:(id)grant forAutoAssetUUID:(id)d fromAutoAssetJob:(id)job;
+ (void)autoAssetJobReadyToDownload:(id)download withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withOriginalSelector:(id)selector downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor;
+ (void)autoAssetJobReleaseLookupGrant:(id)grant forAutoAssetUUID:(id)d fromAutoAssetJob:(id)job;
+ (void)autoAssetJobSetLookupResponseReceived:(id)received forAssignedSetDescriptor:(id)descriptor withCatalogLookupResponse:(id)response;
+ (void)autoAssetStagerJobDownloadDone:(id)done withDownloadedDescriptor:(id)descriptor withDownloadError:(id)error;
+ (void)autoAssetStagerSetJobDetermineDone:(id)done withBaseForStagingDescriptors:(id)descriptors withDetermineError:(id)error;
+ (void)autoJobAssetSetIDsForJob:(id)job mostRecentlyReceived:(id *)received latestToVend:(id *)vend;
+ (void)autoSetJobFinished:(id)finished forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure;
+ (void)autoSetJobIssueProgress:(id)progress forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d withSetJobInformation:(id)information withResponseError:(id)error;
+ (void)autoSetJobIssueReply:(id)reply forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error;
+ (void)autoSetJobSchedulerNoClientDownloaded:(id)downloaded forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error;
+ (void)autoSetJobSchedulerNoClientFoundSame:(id)same forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error;
+ (void)catalogDownloadJobFinished:(id)finished withCatalog:(id)catalog error:(id)error;
+ (void)considerPerfomingCrosscheckTrim;
+ (void)copyCurrentDownloadedDescriptors:(BOOL)descriptors unlockedUnreferencedDescriptors:(id *)unreferencedDescriptors unlockedReferencedDescriptors:(id *)referencedDescriptors lockedOverridableDescriptors:(id *)overridableDescriptors lockedNeverRemoveDescriptors:(id *)removeDescriptors stagedDescriptors:(id *)stagedDescriptors;
+ (void)daemonProcessStartupBegun;
+ (void)downloadManagerStateSyncDetermined:(id)determined;
+ (void)downloadManagerStateSyncSkipped;
+ (void)garbageCollectionOperationComplete:(BOOL)complete originalUnlockedUnreferencedDescriptors:(id)descriptors originalUnlockedReferencedDescriptors:(id)referencedDescriptors originalLockedOverridableDescriptors:(id)overridableDescriptors originalLockedNeverRemoveDescriptors:(id)removeDescriptors originalStagedDescriptors:(id)stagedDescriptors totalReclaimedSpace:(int64_t)space results:(id)self0;
+ (void)handleReceivedPushNotifications:(id)notifications;
+ (void)installAutoAssetWithDescriptor:(id)descriptor;
+ (void)lockerResumed;
+ (void)persistForJobSelector:(id)selector persistingJobDescriptor:(id)descriptor justDownloaded:(BOOL)downloaded justPatched:(BOOL)patched withJobInformation:(id)information withFirstClientName:(id)name;
+ (void)postNotificationName:(id)name forAssetType:(id)type forAssetSpecifier:(id)specifier fromModule:(id)module fromLocation:(id)location;
+ (void)postSetNotificationName:(id)name forClientDomainName:(id)domainName forAssetSetIdentifier:(id)identifier forAtomicInstanceUUID:(id)d fromModule:(id)module fromLocation:(id)location;
+ (void)schedulerEliminatedSelector:(id)selector;
+ (void)schedulerEliminatedSetDomainName:(id)name forAssetSetIdentifier:(id)identifier;
+ (void)schedulerResumed:(id)resumed;
+ (void)schedulerTickOccurred;
+ (void)schedulerTriggeredNoActivity;
+ (void)schedulerTriggeredSelectors:(id)selectors;
+ (void)schedulerTriggeredSets:(id)sets;
+ (void)secureOperationsFinished:(id)finished forSetDescriptor:(id)descriptor forAutoAssetDescriptors:(id)descriptors;
+ (void)shutdown;
+ (void)stagerCancelCurrentJob;
+ (void)stagerEliminatedSelector:(id)selector;
+ (void)stagerEliminatedSetConfiguration:(id)configuration;
+ (void)stagerPurgeStagedContent:(id)content;
+ (void)stagerRequestAlreadyDownloadedDescriptors;
+ (void)stagerResumed:(id)resumed withSetLookupResults:(id)results performingNewOSPromotion:(BOOL)promotion requiringLoadPriorToUse:(BOOL)use;
+ (void)stagerStartJobDownloadForStaging:(id)staging withStagerSetConfiguration:(id)configuration usingCachedAutoAssetCatalog:(id)catalog usingBaseForPatching:(id)patching withAssetTargetOSVersion:(id)version withAssetTargetBuildVersion:(id)buildVersion;
+ (void)stagerStartSetJobDetermineIfAvailable:(id)available withAssetTargetOSVersion:(id)version withAssetTargetBuildVersion:(id)buildVersion withAssetTargetTrainName:(id)name withAssetTargetRestoreVersion:(id)restoreVersion;
- (BOOL)_acceptPersonalizationFromPSUSToBecomeLatestToVend:(id)vend forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized;
- (BOOL)_acceptPersonalizationToAttempt:(id)attempt forSetDescriptor:(id)descriptor withCandidates:(id)candidates extendingToBePersonalized:(id)personalized;
- (BOOL)_acceptPersonalizationToAttempt:(id)attempt forSetLookupResult:(id)result withCandidates:(id)candidates extendingToBePersonalized:(id)personalized;
- (BOOL)_acceptPersonalizationToProvideLatestToVend:(id)vend forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized;
- (BOOL)_acceptPersonalizationToProvidePreinstalled:(id)preinstalled forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized;
- (BOOL)_decideRemoveDescriptorWithNewerDownloaded:(id)downloaded maintainingRemoveDescriptors:(id)descriptors allowRemovalWithoutNewerDescriptor:(BOOL)descriptor fromLocation:(id)location;
- (BOOL)_doesClientRequestInvolveSetConfiguration:(id)configuration;
- (BOOL)_doesEliminateSelector:(id)selector matchAssetType:(id)type withAssetSpecifier:(id)specifier withAssetVersion:(id)version fromLocation:(id)location;
- (BOOL)_doesSetDescriptorDownloadedMatchLatestToVend:(id)vend forSetDescriptor:(id)descriptor;
- (BOOL)_doesSetDescriptorRequirePersonalization:(id)personalization forSetDescriptor:(id)descriptor;
- (BOOL)_handleResumeFromSoftwareUpdateRequest;
- (BOOL)_handleSuspendForSoftwareUpdateRequestWithNeededBytes:(unint64_t)bytes bytesBySetIdentifier:(id)identifier completionBlock:(id)block;
- (BOOL)_haveSetAssetEntriesForSchedulerTriggered:(id)triggered;
- (BOOL)_inDownloadsInFlight:(id)flight;
- (BOOL)_inMatchedTaskDescriptors:(id)descriptors addingMatchingJobUUID:(id)d;
- (BOOL)_isClientRequestForSetJob:(id)job;
- (BOOL)_isClientRequestSubjectToElimination:(id)elimination;
- (BOOL)_isDownloadedDescriptorPartOfLatestToVend:(id)vend fromLocation:(id)location;
- (BOOL)_isDownloadedSetDescriptorLatestToVend:(id)vend fromLocation:(id)location;
- (BOOL)_isSetDescriptorAvailableToClient:(id)client forSetDescriptor:(id)descriptor;
- (BOOL)_messageAssetPolicyDownloadUserInitiated:(id)initiated forClientRequest:(id)request;
- (BOOL)_messageBlockedUntilDownloadManagerSync:(id)sync;
- (BOOL)_messageBlockedUntilFirstUnlock:(id)unlock forAssetSelector:(id)selector;
- (BOOL)_messageBlockedUntilFirstUnlock:(id)unlock forSetInstance:(id)instance;
- (BOOL)_messageShouldBeScheduled:(id)scheduled forAssetSelector:(id)selector;
- (BOOL)_removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:(id)location setDescriptor:(id)descriptor allowRemovalWithoutNewerDescriptor:(BOOL)newerDescriptor;
- (BOOL)_selectorBeingEliminated:(id)eliminated fromLocation:(id)location;
- (BOOL)_setInstanceBeingEliminated:(id)eliminated fromLocation:(id)location;
- (BOOL)_setMessageCanCreateSetConfiguration:(id)configuration;
- (BOOL)_setMessageInvolvesSchedulerPolicy:(id)policy;
- (BOOL)_setMessageShouldBeScheduled:(id)scheduled forSetConfiguration:(id)configuration forLatestEventInfo:(id)info;
- (BOOL)_taskDescriptorEncountered:(id)encountered inMatchedDescriptors:(id)descriptors;
- (BOOL)_updateTrackedDescriptor:(id)descriptor fromLatestDescriptor:(id)latestDescriptor;
- (BOOL)addToTryPersonalize:(id)personalize forDescriptor:(id)descriptor;
- (BOOL)atomicInstanceFromPSUSLookupResultOncePersonalized:(id)personalized forSetConfiguration:(id)configuration;
- (BOOL)atomicInstanceHasDownloadedSetDescriptor:(id)descriptor verboseLogging:(BOOL)logging;
- (BOOL)atomicInstanceIsCurrentlyLocked:(id)locked;
- (BOOL)cancelActiveSetJob:(id)job activeSetJob:(id)setJob;
- (BOOL)clientRequestIndicatesNoWait:(id)wait;
- (BOOL)doSetAtomicEntries:(id)entries matchOtherAtomicEntries:(id)atomicEntries;
- (BOOL)doesSelectorArray:(id)array coverAssetDescriptor:(id)descriptor;
- (BOOL)doesSetConfiguration:(id)configuration coverAssetDescriptor:(id)descriptor;
- (BOOL)doesSetDescriptor:(id)descriptor alignWithSetConfiguration:(id)configuration;
- (BOOL)doesSetDescriptor:(id)descriptor coverAllForAtomicInstanceEntries:(id)entries;
- (BOOL)doesSetDescriptor:(id)descriptor coverAllForAutoAssetEntries:(id)entries;
- (BOOL)doesSetDescriptor:(id)descriptor coverRequestedAutoAssetEntries:(id)entries;
- (BOOL)doesSetDescriptor:(id)descriptor matchSetConfiguration:(id)configuration;
- (BOOL)doesSetDescriptor:(id)descriptor referenceAssetDescriptor:(id)assetDescriptor;
- (BOOL)doesSetDescriptor:(id)descriptor referenceSetConfiguration:(id)configuration;
- (BOOL)doesSetDescriptor:(id)descriptor satisfySetConfiguration:(id)configuration allowingMoreDownloaded:(BOOL)downloaded;
- (BOOL)doesSetDescriptorReferenceAllPreInstalledContent:(id)content;
- (BOOL)doesSetDescriptorReferenceDropped:(id)dropped forSetDescriptor:(id)descriptor;
- (BOOL)doesSetDescriptorWithoutVersion:(id)version referenceAssetDescriptor:(id)descriptor;
- (BOOL)doesSetJobDescriptor:(id)descriptor representSameContentAs:(id)as;
- (BOOL)filesystemDoesDirectoryExist:(id)exist atPath:(id)path isDirectory:(BOOL *)directory;
- (BOOL)filesystemDoesFileExist:(id)exist atPath:(id)path;
- (BOOL)handleClientCheckForNewer:(id)newer forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location;
- (BOOL)handleClientLockContent:(id)content forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location;
- (BOOL)handleClientPotentialJob:(id)job alreadyScheduledSelector:(BOOL)selector forAutoJob:(id)autoJob fromLocation:(id)location;
- (BOOL)handleClientPotentialSetJob:(id)job forAutoJob:(id)autoJob fromLocation:(id)location;
- (BOOL)handleSetClientCheckAtomic:(id)atomic forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location;
- (BOOL)handleSetClientLockAtomic:(id)atomic forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location;
- (BOOL)isAnyAssetEntryOnFilesystemForSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor;
- (BOOL)isAtomicEntry:(id)entry desiredForAutoAssetSetEntries:(id)entries;
- (BOOL)isAtomicInstanceForCurrentSetJob:(id)job;
- (BOOL)isAtomicInstanceLatestToVendForSet:(id)set;
- (BOOL)isAtomicInstancePartOfPSUS:(id)s;
- (BOOL)isAutoAssetBeingEliminated:(id)eliminated;
- (BOOL)isConnectionAuthorized:(id)authorized;
- (BOOL)isDescriptorCurrentlyLocked:(id)locked forDescriptor:(id)descriptor;
- (BOOL)isEveryAssetEntryOnFilesystemForSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor;
- (BOOL)isNoWaitRequestInvolvingSecureAsset:(id)asset;
- (BOOL)isSetDescriptor:(id)descriptor coveredBySetDescriptorStatus:(id)status;
- (BOOL)isSetDescriptorCurrentlyLocked:(id)locked forSetDescriptor:(id)descriptor;
- (BOOL)isSetIdentifierBeingEliminated:(id)eliminated forClientDomainName:(id)name ofSetIdentifier:(id)identifier;
- (BOOL)isSetIdentifierCurrentlyLocked:(id)locked forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (BOOL)isShortTermLockableSetDescriptor:(id)descriptor;
- (BOOL)isSuspendedForSoftwareUpdate:(id)update forAssetSetIdentifier:(id)identifier;
- (BOOL)jobDescriptorInFlightNowOnFilesystem:(id)filesystem;
- (BOOL)jobDescriptorOnFilesystemValidated:(id)validated forOSBuild:(id)build;
- (BOOL)jobToBeIncluded:(id)included basedOnControl:(id)control;
- (BOOL)newAtomicInstanceAndSetDescriptor:(id)descriptor fromSetLookupResult:(id)result vendingLatestForConfiguration:(id)configuration inStartup:(BOOL)startup allowEmpty:(BOOL)empty notifyClients:(BOOL)clients forCreationReason:(id)reason recordingHistoryOperation:(int64_t)self0;
- (BOOL)removeShortTermLockingOfSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor endingAll:(BOOL)all performingHardEliminate:(BOOL)eliminate error:(id *)error;
- (BOOL)schedulerReferencesDescriptor:(id)descriptor;
- (BOOL)setConfiguration:(id)configuration matchesAssetEntriesFromInfoInstance:(id)instance;
- (BOOL)setConfigurationAdoptLatestToVend:(id)vend fromSetDescriptor:(id)descriptor toSetConfiguration:(id)configuration fromPreSUStaging:(BOOL)staging allowEmpty:(BOOL)empty;
- (BOOL)setConfigurationAllPreviouslyVendedForceUnlock:(id)unlock forSetConfiguration:(id)configuration;
- (BOOL)setConfigurationClearAvailableForUseError:(id)error forSetConfiguration:(id)configuration appendingToPersistReason:(id)reason withReason:(id)withReason maintainingHistoryOperation:(int64_t *)operation;
- (BOOL)setConfigurationForgetIfTrackedAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration removingAtomicInstance:(id)instance;
- (BOOL)setConfigurationIsTrackedAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration forAtomicInstanceUUID:(id)d;
- (BOOL)setConfigurationPotentialLatestToVend:(id)vend forSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration;
- (BOOL)setConfigurationReferencesDescriptor:(id)descriptor;
- (BOOL)setConfigurationTrackAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration addingAtomicInstance:(id)instance;
- (BOOL)setConfigurationTrackLatestToVend:(id)vend forSetConfiguration:(id)configuration becomingLatestToVend:(id)toVend historyOperation:(int64_t)operation fromPreSUStaging:(BOOL)staging;
- (BOOL)setDescriptorAllDiscoveredEntriesDownloaded:(id)downloaded forSetDescriptor:(id)descriptor loggingEntryExists:(BOOL)exists;
- (BOOL)setDescriptorAllEntriesDownloaded:(id)downloaded forSetDescriptor:(id)descriptor loggingEntryExists:(BOOL)exists;
- (BOOL)setDescriptorLocked:(id)locked;
- (BOOL)setDescriptorVerifyNoDuplicates:(id)duplicates;
- (BOOL)setJobFoundAllContent:(id)content forJobAtomicInstance:(id)instance withCurrentSetStatus:(id)status;
- (BOOL)setPolicyValidate:(id)validate fromLocation:(id)location;
- (BOOL)setTargetEntries:(id)entries match:(id)match;
- (BOOL)setTargetEntries:(id)entries matchSetConfiguration:(id)configuration;
- (BOOL)setTargetPersistedMatchesClientSpecified:(id)specified;
- (BOOL)shouldAdoptJobFoundAllContent:(id)content forJobAtomicInstance:(id)instance withCurrentSetStatus:(id)status;
- (BOOL)startupActivationIsFirstExecutionSinceBoot:(id)boot;
- (BOOL)statusErrorConsideredMatch:(id)match to:(id)to;
- (BOOL)timerStartForRequest:(id)request fromLocation:(id)location;
- (BOOL)trackSetDescriptor:(id)descriptor fromLocation:(id)location forLatestDownloaded:(BOOL)downloaded forSpecificAtomicInstance:(id)instance withCurrentSetStatus:(id)status changedWhileTerminated:(BOOL)terminated changedNeverBeenLocked:(BOOL)locked notifyingIfJustDownloaded:(BOOL)self0 latestToVend:(BOOL)self1 historyOperation:(int64_t)self2 firstClientName:(id)self3 fromPreSUStaging:(BOOL)self4;
- (BOOL)verifySetDescriptorIsLockable:(id)lockable fromLocation:(id)location notLocakableError:(id *)error corruptedAtomicEntries:(id *)entries;
- (BOOL)wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:(id)instance;
- (MADAutoAssetControlManager)init;
- (const)osTransactionNameAutoJob:(id)job forJobUUID:(id)d;
- (id)_acceptPersonalizationToAttempt:(id)attempt forAtomicEntry:(id)entry;
- (id)_allPreInstalledDescriptor:(id)descriptor forAssetType:(id)type;
- (id)_alreadyDownloadedDescriptorsArray:(id)array limitingToSupportingStaging:(BOOL)staging;
- (id)_autoAssetJobProgressNewValidatedCurrentStatus:(id)status requiringProgress:(BOOL)progress;
- (id)_autoAssetSetJobProgressNewValidatedCurrentStatus:(id)status;
- (id)_combinedStatisticsWithStagerClientRepliesSuccess:(id)success withStagerClientRepliesFailure:(id)failure withStagerTotalStaged:(id)staged withStagerTotalUnstaged:(id)unstaged;
- (id)_constructSetInfoSameFoundFrom:(id)from forSetConfiguration:(id)configuration fromSetStatus:(id)status;
- (id)_currentSetStatusClearDownloadProgress:(id)progress clearingSetStatus:(id)status forClearingReason:(id)reason;
- (id)_errorUnlessSameVersionFound:(id)found changedReportedError:(BOOL *)error;
- (id)_getHealthReportForSets:(id)sets;
- (id)_handleClientAlterLockOperationForDescriptor:(id)descriptor forEventInfo:(id)info error:(id *)error;
- (id)_latestDownloadedDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier;
- (id)_latestDownloadedDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier matchingAssetVersion:(id)version;
- (id)_limitSetAtomicEntries:(id)entries fromSetDescriptor:(id)descriptor requestedAutoAssetEntries:(id)assetEntries;
- (id)_limitToCheckAtomicEntries:(id)entries;
- (id)_newAtomicInstancesDownloadedForSetIdentifier:(id)identifier;
- (id)_newTrimmedToAutoAssetsInFlight:(id)flight;
- (id)_newestVersionDownloaded:(id)downloaded;
- (id)_persistedKnownDescriptorForFullAssetSelector:(id)selector;
- (id)_persistedKnownDescriptorForPersistedEntryID:(id)d;
- (id)_preInstalledDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier;
- (id)_preInstalledRelocateAutoAssets;
- (id)_preInstalledSetAtomicEntriesFromInstanceEntries:(id)entries;
- (id)_shortNameForSelector:(id)selector;
- (id)_shortTermCreateSymbolicLink:(id)link symbolicLinkFilename:(id)filename linkedToFilename:(id)toFilename forSetDescriptor:(id)descriptor usingFileManager:(id)manager;
- (id)_shortTermPersistSetStatus:(id)status forSetDescriptor:(id)descriptor persistingSetStatus:(id)setStatus toFilename:(id)filename;
- (id)_shortTermSharedLockOpenExclusive:(id)exclusive forSetDescriptor:(id)descriptor atomicInstanceFilename:(id)filename error:(id *)error;
- (id)_shortTermSharedLockRemove:(id)remove removingSharedLockFilename:(id)filename usingFileManager:(id)manager removingDescription:(id)description;
- (id)_softwareUpdateSuspendResumeEligibleSetEntryIDs;
- (id)_specifierVersionNamesForAtomicInstance:(id)instance;
- (id)_specifierVersionNamesForSetConfiguration:(id)configuration;
- (id)_specifierVersionNamesForSetDescriptor:(id)descriptor;
- (id)_specifierVersionNamesForSetEntries:(id)entries;
- (id)_startupActivationProcessIdentifier;
- (id)_statsCombinedCopy:(BOOL)copy;
- (id)_summary;
- (id)_updateLatestSummary;
- (id)_updatePolicyForSelector:(id)selector;
- (id)_updateSandboxExtensionForResponse:(id)response responseError:(id)error clientRequest:(id)request alreadyOnStateQueue:(BOOL)queue;
- (id)alreadyHaveSetDescriptorMatching:(id)matching;
- (id)atomicInstanceForSetDescriptor:(id)descriptor;
- (id)atomicInstanceMatchingInfoInstance:(id)instance withSetInfoInstance:(id)infoInstance;
- (id)atomicInstanceNewEntryIDForSetAtomicInstance:(id)instance;
- (id)atomicInstanceNewIdentifierForSetAtomicInstance:(id)instance;
- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation forClientDomainName:(id)name forSetClientName:(id)clientName forAssetSetIdentifier:(id)identifier representingInstanceEntries:(id)entries recoveringAtomicInstanceUUID:(id)self0 asSubAtomicFrom:(id)self1;
- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation forSetInfoInstance:(id)infoInstance asSubAtomicFrom:(id)from;
- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation recoveringForSetDescriptor:(id)descriptor usingAsSetClient:(id)client;
- (id)atomicInstanceNewSubAtomicFromAtomic:(id)atomic forSubsetInfoInstance:(id)instance error:(id *)error;
- (id)atomicInstanceOverflowRemove:(id)remove;
- (id)atomicInstanceUUIDArrayForSetDescriptor:(id)descriptor;
- (id)atomicInstanceUUIDForNewSetJob:(id)job forReason:(id)reason;
- (id)atomicInstanceUUIDFromCurrentStatus:(id)status;
- (id)autoAssetDescriptorsForSet:(id)set;
- (id)buildFoundResponseMessage:(id)message forClientRequest:(id)request withFoundDescriptor:(id)descriptor withInstance:(id)instance withDesire:(id)desire fromLocation:(id)location error:(id *)error;
- (id)buildReportedSetStatus:(id)status forClientDomainName:(id)name forSetIdentifier:(id)identifier forAtomicInstance:(id)instance withFoundSetDescriptor:(id)descriptor withSubAtomicInstance:(id)atomicInstance reportingLocalContentURLs:(BOOL)ls;
- (id)buildSetFoundResponseMessage:(id)message forClientRequest:(id)request withFoundSetDescriptor:(id)descriptor withSubAtomicInstance:(id)instance forLatestDownloaded:(BOOL)downloaded withInstance:(id)withInstance withDesire:(id)desire fromLocation:(id)self0;
- (id)buildShortTermLockError:(id)error code:(int64_t)code description:(id)description forSetDescriptor:(id)descriptor underlyingError:(id)underlyingError;
- (id)clientRequestMessageDesire:(id)desire;
- (id)clientRequestMessageInstance:(id)instance;
- (id)clientRequestMessageName:(id)name;
- (id)clientRequestMessageSetDesire:(id)desire;
- (id)clientRequestMessageSetEnd:(id)end;
- (id)clientRequestMessageSetInstance:(id)instance withEventInfo:(id)info;
- (id)clientRequestMessageSetPolicy:(id)policy;
- (id)currentJobBySelector:(id)selector;
- (id)currentJobByUUID:(id)d fromLocation:(id)location notFoundCode:(int64_t)code notFoundReason:(id)reason;
- (id)currentJobByUUID:(id)d potentiallyResumingJob:(id)job withOriginalSelector:(id)selector fromLocation:(id)location notFoundCode:(int64_t)code notFoundReason:(id)reason downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)self0;
- (id)currentSetStatusFromJobInformation:(id)information;
- (id)eliminateTrackerForSelector:(id)selector;
- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByDescriptor:(id)descriptor;
- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByLookupResult:(id)result;
- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByStatus:(id)status;
- (id)findSetEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByConfiguration:(id)configuration;
- (id)firstAssetTypeForSetEntries:(id)entries;
- (id)getCorruptedEntryInfo:(id)info;
- (id)jobControlInformationForSelector:(id)selector;
- (id)jobControlInformationForSetConfiguration:(id)configuration;
- (id)jobControlInformationForSetJobKey:(id)key;
- (id)jobToBeGivenGrant:(id)grant;
- (id)latestShortTermLockableAtomicInstanceForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)locateActiveAutoJobForSetDescriptor:(id)descriptor;
- (id)locateActiveJobDescriptorBySelector:(id)selector;
- (id)locateCancelingSetJobForClientDomain:(id)domain byIdentifier:(id)identifier;
- (id)locateDownloadedByFullSelector:(id)selector;
- (id)locateDownloadedNewBySelectorForAssetType:(id)type;
- (id)locateDownloadedNewBySelectorLimitedToStaging:(BOOL)staging;
- (id)locateDownloadedNewForSelector:(id)selector assetSelector:(id)assetSelector limitedToStaging:(BOOL)staging;
- (id)locateNewAllSetConfigurations;
- (id)locateNewAllSetTargets;
- (id)locatePersistedKnownDescriptorEntryIDs:(id)ds forAssetType:(id)type;
- (id)locateSetAtomicInstanceByInstanceUUID:(id)d;
- (id)locateSetConfigurationByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)locateSetDescriptor:(id)descriptor forAtomicInstanceUUID:(id)d requireExists:(BOOL)exists;
- (id)locateSetDescriptorActiveJobByAtomicInstanceUUID:(id)d;
- (id)locateSetDescriptorActiveJobByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)locateSetDescriptorActiveJobPreferringByAtomicInstance:(id)instance elseByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)locateSetDescriptorForAssetDescriptor:(id)descriptor;
- (id)locateSetDescriptorForSelector:(id)selector;
- (id)locateSetDescriptorsDownloaded;
- (id)locateSetJobForClientDomain:(id)domain byIdentifier:(id)identifier;
- (id)locateSetLookupResultSatisfying:(id)satisfying;
- (id)locateSetStatusByInstance:(id)instance;
- (id)locateSetStatusForDomainName:(id)name byIdentifier:(id)identifier;
- (id)locateSetStatusPreferringByInstance:(id)instance elseByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier fromLocation:(id)location;
- (id)newAssetSetStatus:(id)status forReason:(id)reason forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier withAtomicInstancesDownloaded:(id)downloaded withNewerAtomicInstanceDiscovered:(id)discovered withNewerDiscoveredAtomicEntries:(id)entries withLatestDownloadedAtomicInstance:(id)self0 withLatestDownloadedAtomicInstanceFromPreSUStaging:(BOOL)self1 withLatestDowloadedAtomicInstanceEntries:(id)self2 withCurrentNotifications:(id)self3 withCurrentNeedPolicy:(id)self4 withSchedulerPolicy:(id)self5 withStagerPolicy:(id)self6 withDownloadUserInitiated:(BOOL)self7 withDownloadProgress:(id)self8 withDownloadedNetworkBytes:(int64_t)self9 withDownloadedFilesystemBytes:(int64_t)filesystemBytes extendingWithCurrentLockUsage:(BOOL)usage withSelectorsForStaging:(id)forStaging withAvailableForUseError:(id)error withNewerVersionError:(id)versionError;
- (id)newAssetStatusForSelector:(id)selector withNotifications:(id)notifications withAvailableForUseAttributes:(id)attributes withNewerVersionAttributes:(id)versionAttributes withNeverBeenLocked:(BOOL)locked withDownloadUserInitiated:(BOOL)initiated withDownloadProgress:(id)progress withDownloadedNetworkBytes:(int64_t)self0 withDownloadedFilesystemBytes:(int64_t)self1 withDownloadedAsPatch:(BOOL)self2 withPatchedFromBaseSelector:(id)self3 withPatchedFromBaseFilesystemBytes:(int64_t)self4 withPatchingAttempted:(BOOL)self5 withStagedPriorToAvailable:(BOOL)self6 withStagedFromOSVersion:(id)self7 withStagedFromBuildVersion:(id)self8 extendingWithCurrentLockUsage:(BOOL)self9 withAvailableForUseError:(id)error withPatchingAttemptError:(id)attemptError withNewerVersionError:(id)versionError;
- (id)newAtomicInstancesDownloadedForDescriptor:(id)descriptor;
- (id)newSetDescriptorFromAlreadyDownloaded:(id)downloaded forSetInfoInstance:(id)instance fromDownloadedSetDescriptor:(id)descriptor forAtomicInstance:(id)atomicInstance;
- (id)newSetDescriptorLimitedToCheckInformation:(id)information;
- (id)newSetEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)newSetEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier ofAtomicInstance:(id)instance;
- (id)newSetEntryIDForClientDomainName:(id)name forAssetSetIdentifier:(id)identifier forMinTargetOS:(id)s forMaxTargetOS:(id)oS;
- (id)newSetInfoLimitedToCheckInformation:(id)information forAssetSetIdentifier:(id)identifier fromSetInfoFound:(id)found;
- (id)newSetLockUsageMapKeyForClientDomain:(id)domain forSetIdentifier:(id)identifier;
- (id)newSetTargetFromClientProvidedSetTarget:(id)target forClientDomainName:(id)name forSetIdentifier:(id)identifier;
- (id)notifyLockerAsIndicatedByJob:(id)job;
- (id)notifyLockerAsIndicatedBySetJob:(id)job withSetInstance:(id)instance withSetDesire:(id)desire forSetDescriptor:(id)descriptor withClientReplyCompletion:(id)completion;
- (id)notifyLockerJustLockedDescriptor:(id)descriptor forClientInstance:(id)instance withClientDesire:(id)desire respondingToClientRequest:(id)request withClientCompletion:(id)completion;
- (id)persistedKnownDescriptorForSetAtomicEntry:(id)entry;
- (id)preInstalledSetDescriptor:(id)descriptor forClientDomainName:(id)name forSetClientName:(id)clientName forAssetSetIdentifier:(id)identifier forAssetType:(id)type;
- (id)setAtomicEntriesRemoveDuplicates:(id)duplicates dedupingAtomicEntries:(id)entries;
- (id)setConfigurationAssetEntries:(id)entries;
- (id)setConfigurationAssetEntries:(id)entries forAssetSetIdentifier:(id)identifier;
- (id)setConfigurationCopy:(id)copy;
- (id)setConfigurationForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)setConfigurationForDescriptorIfManagedAsSet:(id)set;
- (id)setConfigurationFromMessageName:(id)name withInfoInstance:(id)instance errorCode:(int64_t *)code errorDescription:(id *)description;
- (id)setConfigurationNewEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (id)setConfigurationNewEntryIDForInfoInstance:(id)instance;
- (id)setConfigurationNewEntryIDForSetConfiguration:(id)configuration;
- (id)setConfigurationPreviouslyVendedLockedAtomicInstances:(id)instances;
- (id)setConfigurationVendingDescriptor:(id)descriptor managedAsSet:(BOOL *)set;
- (id)setDescriptorDedupDownloadedEntries:(id)entries forSetDescriptor:(id)descriptor;
- (id)setDescriptorNewEntryIDForDownloaded:(id)downloaded;
- (id)setDescriptorWalkKeys;
- (id)setDescriptorWalkKeysForClientDomainName:(id)name assetSetIdentifier:(id)identifier;
- (id)setDescriptorWalkLocate:(id)locate forKey:(id)key;
- (id)setJobInstanceKeyForSetInstance:(id)instance;
- (id)setJobInstanceKeyFromSetDescriptor:(id)descriptor forLatestDownloaded:(BOOL)downloaded;
- (id)setJobInstanceKeyFromSetStatus:(id)status forLatestDownloaded:(BOOL)downloaded;
- (id)setLockUsageMapForClientDomain:(id)domain forSetIdentifier:(id)identifier;
- (id)setLockUsageMapForSetDescriptor:(id)descriptor;
- (id)setTargetNewEntryIDForClientDomainName:(id)name forAssetSetIdentifier:(id)identifier forClientProvidedSetTarget:(id)target;
- (id)shortTermLockSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor forSpecificAtomicInstance:(id)instance;
- (id)startupActivationResourceSummary;
- (id)updateAutoAssetSetStatus:(id)status forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier forJobResponse:(id)response withResponseError:(id)error clearingDownloadProgressReason:(id)reason withAssetSetStatus:(id)setStatus;
- (id)updateAutoAssetStatus:(id)status forActiveJobUUID:(id)d forJobResponse:(id)response withResponseError:(id)error;
- (int)setLockUsageMapForAtomicInstance:(id)instance clientLockUsageMap:(id)map lockReason:(id)reason;
- (int64_t)_bytesDownloadedForDescriptor:(id)descriptor;
- (int64_t)_filesystemCachedInfo:(id)info forPath:(id)path;
- (int64_t)_scheduleAndCreateSetConfiguration:(id)configuration fromLocation:(id)location errorString:(id *)string;
- (int64_t)actionUnknownAction:(id)action error:(id *)error;
- (int64_t)action_AdditionalSynced:(id)synced error:(id *)error;
- (int64_t)action_AttemptNextGraft:(id)graft error:(id *)error;
- (int64_t)action_AttemptNextPersonalize:(id)personalize error:(id *)error;
- (int64_t)action_Before1stAssetFinished:(id)finished error:(id *)error;
- (int64_t)action_Before1stCatalogFinished:(id)finished error:(id *)error;
- (int64_t)action_Before1stConfigFinished:(id)finished error:(id *)error;
- (int64_t)action_CancelActivityAck:(id)ack error:(id *)error;
- (int64_t)action_ClearInProgressSecure:(id)secure error:(id *)error;
- (int64_t)action_CoalesceLateJobScheduled:(id)scheduled error:(id *)error;
- (int64_t)action_CoalesceLateJobSetScheduled:(id)scheduled error:(id *)error;
- (int64_t)action_DecideNeedGraft:(id)graft error:(id *)error;
- (int64_t)action_DecideNeedPersonalize:(id)personalize error:(id *)error;
- (int64_t)action_DecrementTickDriven:(id)driven error:(id *)error;
- (int64_t)action_EliminateSchedulerDone:(id)done error:(id *)error;
- (int64_t)action_EliminateStagerDone:(id)done error:(id *)error;
- (int64_t)action_EliminateStagerSetDone:(id)done error:(id *)error;
- (int64_t)action_FailClientTimedOut:(id)out error:(id *)error;
- (int64_t)action_GraftFailureDecideMore:(id)more error:(id *)error;
- (int64_t)action_GraftSuccessDecideMore:(id)more error:(id *)error;
- (int64_t)action_HandlePushNotifications:(id)notifications error:(id *)error;
- (int64_t)action_IgnorePushNotifications:(id)notifications error:(id *)error;
- (int64_t)action_InstallAssets:(id)assets error:(id *)error;
- (int64_t)action_IssueClientReplyJobResponse:(id)response error:(id *)error;
- (int64_t)action_IssueClientReplySetJob:(id)job error:(id *)error;
- (int64_t)action_LoadPersistedResumeLocker:(id)locker error:(id *)error;
- (int64_t)action_ObtainLookupGrant:(id)grant error:(id *)error;
- (int64_t)action_PersonalizeFailureDecideMore:(id)more error:(id *)error;
- (int64_t)action_PersonalizeSuccessDecideMore:(id)more error:(id *)error;
- (int64_t)action_PollDecideBefore1stUnlock:(id)unlock error:(id *)error;
- (int64_t)action_PromoteStagedMigrate:(id)migrate error:(id *)error;
- (int64_t)action_ProvidePersistedForJob:(id)job error:(id *)error;
- (int64_t)action_QueueClientRequest:(id)request error:(id *)error;
- (int64_t)action_QueueClientRequestBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_QueueDownloadManager:(id)manager error:(id *)error;
- (int64_t)action_ReleaseLookupGrant:(id)grant error:(id *)error;
- (int64_t)action_RemoveFinishedJob:(id)job error:(id *)error;
- (int64_t)action_RemoveQueuedClient:(id)client error:(id *)error;
- (int64_t)action_ResumeJobs:(id)jobs error:(id *)error;
- (int64_t)action_ResumeJobsBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_ResumeScheduler:(id)scheduler error:(id *)error;
- (int64_t)action_ResumeStager:(id)stager error:(id *)error;
- (int64_t)action_RouteAssetFinished:(id)finished error:(id *)error;
- (int64_t)action_RouteCatalogFinished:(id)finished error:(id *)error;
- (int64_t)action_RouteClientClosed:(id)closed error:(id *)error;
- (int64_t)action_RouteClientRequest:(id)request error:(id *)error;
- (int64_t)action_RouteConfigFinished:(id)finished error:(id *)error;
- (int64_t)action_ScheduleJobs:(id)jobs error:(id *)error;
- (int64_t)action_ScheduleJobsBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_ScheduleSetJobs:(id)jobs error:(id *)error;
- (int64_t)action_SchedulerJobDownloaded:(id)downloaded error:(id *)error;
- (int64_t)action_SchedulerJobFoundSame:(id)same error:(id *)error;
- (int64_t)action_SetJobLookupResponseRcvd:(id)rcvd error:(id *)error;
- (int64_t)action_StagerAlreadyDownloaded:(id)downloaded error:(id *)error;
- (int64_t)action_StagerJobCancel:(id)cancel error:(id *)error;
- (int64_t)action_StagerJobDoneDetermine:(id)determine error:(id *)error;
- (int64_t)action_StagerJobDoneDownload:(id)download error:(id *)error;
- (int64_t)action_StagerJobStartDetermine:(id)determine error:(id *)error;
- (int64_t)action_StagerJobStartDownload:(id)download error:(id *)error;
- (int64_t)action_StagerRemoveAllNotPromoted:(id)promoted error:(id *)error;
- (int64_t)action_StartUnlockPollingTimer:(id)timer error:(id *)error;
- (int64_t)action_SyncDecideBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_SyncInFlightDownloads:(id)downloads error:(id *)error;
- (int64_t)action_SyncSkippedDecideBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_Synced:(id)synced error:(id *)error;
- (int64_t)action_SyncedResumeStager:(id)stager error:(id *)error;
- (int64_t)action_SyncedReviewBefore1st:(id)before1st error:(id *)error;
- (int64_t)action_SyncedReviewUnlocked:(id)unlocked error:(id *)error;
- (int64_t)atomicInstanceNextCreationIndex:(id)index forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (int64_t)clientRequestTimeoutSecs:(id)secs timeoutWasSpecified:(BOOL *)specified;
- (int64_t)locateDownloadedCurrentDownloadedCount;
- (int64_t)performAction:(id)action onEvent:(id)event inState:(id)state withInfo:(id)info nextState:(id)nextState error:(id *)error;
- (int64_t)setConfigurationNewSetConfiguration:(id)configuration forSetInfoInstance:(id)instance dueToMessageName:(id)name selectedConfig:(id *)config;
- (int64_t)setConfigurationSelectUsingInfoInstance:(id)instance dueToMessageName:(id)name selectedConfig:(id *)config;
- (int64_t)setLockUsageMapLockCount;
- (unint64_t)_handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:(id *)identifier;
- (unsigned)isLocalContentValidForSetAtomicEntry:(id)entry fromLocation:(id)location;
- (void)_addCompletionCallbackForSetJobKey:(id)key completionCallback:(id)callback;
- (void)_addEvictedCallbackForAtomicInstanceUUID:(id)d completionCallback:(id)callback;
- (void)_awaitingResumeReduceToLatest;
- (void)_awaitingResumeRemoveType:(int64_t)type;
- (void)_clearAtomicInstanceFromAllSetConfigurations:(id)configurations fromLocation:(id)location;
- (void)_clearAtomicInstanceFromSetConfiguration:(id)configuration forSetDesriptor:(id)desriptor forSetAtomicInstance:(id)instance fromLocation:(id)location;
- (void)_eliminateAtomicTriggeredByClient:(id)client forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier awaitingUnlocked:(BOOL)unlocked;
- (void)_eliminateAtomicTriggeredWhileLoading:(id)loading forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (void)_eliminateBegin:(id)begin forAssetSelector:(id)selector limitingToActivity:(BOOL)activity fromLocation:(id)location;
- (void)_eliminateCompleteIfAllDone:(id)done;
- (void)_eliminateForgetAtomicLostToVend:(id)vend forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (void)_eliminatePromotedNeverLocked:(id)locked forAssetSelector:(id)selector;
- (void)_eliminateSecureOperationFinished:(id)finished forEliminateDescriptor:(id)descriptor;
- (void)_eliminateSecureOperationFinished:(id)finished forEliminateSetDescriptor:(id)descriptor;
- (void)_forceSetUngraftAndEliminateAllSetLocks:(id)locks forSetDescriptor:(id)descriptor;
- (void)_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:(id)nonce sortedKeys:(id)keys setConfigurationsToEvict:(id)evict completionBlock:(id)block;
- (void)_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:(id)nonce sortedKeys:(id)keys setConfigurationsToEvict:(id)evict completionBlock:(id)block;
- (void)_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:(id)nonce setConfigurationsToEvict:(id)evict completionBlock:(id)block;
- (void)_initializeAutoControl;
- (void)_initializeCachedPreferences;
- (void)_initializeConnectionServer;
- (void)_initializeSUCore;
- (void)_initializeServerConnectionPolicy;
- (void)_logAtomicInstanceEntries:(id)entries forAtomicInstance:(id)instance;
- (void)_logLookupGrantAwaiting:(id)awaiting ofLookupGrant:(id)grant message:(id)message;
- (void)_logLookupGrantObtained:(id)obtained ofLookupGrant:(id)grant message:(id)message;
- (void)_logLookupGrantReleased:(id)released ofLookupGrant:(id)grant message:(id)message;
- (void)_logPersistedEntry:(id)entry forComponentType:(id)type operation:(id)operation forPersistedEntryID:(id)d forClientRequest:(id)request withJobUUID:(id)iD withAssetDescriptor:(id)descriptor baseForPatchDescriptor:(id)self0 message:(id)self1;
- (void)_logPersistedRemovedEntry:(id)entry forComponentType:(id)type removedPersistedEntryID:(id)d removedDescriptor:(id)descriptor message:(id)message;
- (void)_logPersistedSetAtomicInstance:(id)instance operation:(id)operation forPersistedEntryID:(id)d withSetAtomicInstance:(id)atomicInstance message:(id)message;
- (void)_logPersistedSetAtomicInstanceRemoved:(id)removed removedPersistedEntryID:(id)d removedSetAtomicInstance:(id)instance message:(id)message;
- (void)_logPersistedSetAtomicInstanceTableOfContents:(id)contents;
- (void)_logPersistedSetConfiguration:(id)configuration operation:(id)operation forPersistedEntryID:(id)d withSetConfiguration:(id)setConfiguration historyOperation:(int64_t)historyOperation recordingSpecifiers:(BOOL)specifiers message:(id)message;
- (void)_logPersistedSetConfigurationRemoved:(id)removed removedPersistedEntryID:(id)d removedSetConfiguration:(id)configuration message:(id)message;
- (void)_logPersistedSetConfigurationTableOfContents:(id)contents;
- (void)_logPersistedSetDescriptor:(id)descriptor forComponentType:(id)type operation:(id)operation forPersistedEntryID:(id)d forClientRequest:(id)request withJobUUID:(id)iD withSetDescriptor:(id)setDescriptor message:(id)self0;
- (void)_logPersistedSetDescriptorRemoved:(id)removed forComponentType:(id)type removedPersistedEntryID:(id)d removedSetDescriptor:(id)descriptor message:(id)message;
- (void)_logPersistedSetDescriptorTableOfContents:(id)contents forComponentType:(id)type;
- (void)_logPersistedSetLookupResult:(id)result operation:(id)operation forPersistedEntryID:(id)d withSetLookupResult:(id)lookupResult message:(id)message;
- (void)_logPersistedSetLookupResultRemoved:(id)removed removedPersistedEntryID:(id)d removedSetLookupResult:(id)result message:(id)message;
- (void)_logPersistedSetTarget:(id)target operation:(id)operation forPersistedEntryID:(id)d withSetTarget:(id)setTarget message:(id)message;
- (void)_logPersistedSetTargetRemoved:(id)removed removedPersistedEntryID:(id)d removedSetTarget:(id)target message:(id)message;
- (void)_logPersistedSetTargetTableOfContents:(id)contents;
- (void)_logPersistedTableOfContents:(id)contents forComponentType:(id)type;
- (void)_logSetConfigurationEntries:(id)entries forSetConfiguration:(id)configuration;
- (void)_logSetDescriptorEntries:(id)entries forSetDescriptor:(id)descriptor;
- (void)_logTrackedDescriptors:(id)descriptors forAssetType:(id)type withAssetSpecifier:(id)specifier matchingAssetVersion:(id)version;
- (void)_logTrackedSetDescriptors:(id)descriptors forSetJobDescriptor:(id)descriptor;
- (void)_moveFromAwaitingResumedInto:(id)into forSelector:(id)selector;
- (void)_preInstalledMakeDescriptorAvailable:(id)available fromLocation:(id)location;
- (void)_preInstalledMigrateAssets;
- (void)_preinstalledTrackBySelector:(id)selector;
- (void)_promotePreviouslyStagedNowDownloaded:(id)downloaded forHistoryOperation:(int64_t)operation;
- (void)_reclaimDownloadedDescriptorsWhenJustDownloaded:(id)downloaded fromLocation:(id)location;
- (void)_removeAllContentForEliminateTracker:(id)tracker unlessCurrentlyLocked:(id)locked;
- (void)_removeAllUnlockedForOtherAtomicInstances:(id)instances fromLocation:(id)location;
- (void)_removeDescriptorFromFilesystem:(id)filesystem droppingDescriptor:(id)descriptor forHistoryOperation:(int64_t)operation firstClientName:(id)name;
- (void)_removeDownloadedDescriptorsWithNewerDownloaded:(id)downloaded;
- (void)_removeFromPersistedActiveJobs:(id)jobs;
- (void)_removeIncompleteSetDescriptorFromLocation:(id)location incompleteSetDescriptor:(id)descriptor historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d;
- (void)_removeJobFromDownloadsInFlight:(id)flight;
- (void)_removeNextDownloadedDescriptorIfNewerDownloaded:(id)downloaded;
- (void)_removeSetDeterminedToBeIncomplete:(id)incomplete;
- (void)_removeUnlockedForOlderSelectorsWithoutVersion:(id)version;
- (void)_requestDownloadManagerSync;
- (void)_routeAssetFinished:(id)finished withEventInfo:(id)info;
- (void)_routeAssetProgress:(id)progress toCurrentJobByUUID:(id)d withDownloadProgress:(id)downloadProgress;
- (void)_routeCatalogFinished:(id)finished withEventInfo:(id)info;
- (void)_routeClientRequest:(id)request alreadyScheduledSelector:(BOOL)selector fromLocation:(id)location;
- (void)_routeConfigFinished:(id)finished withEventInfo:(id)info;
- (void)_schedulePushNotifications:(id)notifications;
- (void)_scheduleSelector:(id)selector;
- (void)_scheduleSetConfiguration:(id)configuration withClientSetPolicy:(id)policy;
- (void)_scheduledAndRouteClientRequest:(id)request fromLocation:(id)location;
- (void)_schedulerTickOccurred;
- (void)_shortTermChangeAtomicInstance:(id)instance forAtomicInstance:(id)atomicInstance toShortTermSupported:(BOOL)supported;
- (void)_shortTermForceForget:(id)forget forSetDescriptor:(id)descriptor;
- (void)_shortTermSharedLockClose:(id)close forSetDescriptor:(id)descriptor atomicInstanceFileDescriptor:(id)fileDescriptor;
- (void)_stagedNewOSPromoteAdoptSetTargets;
- (void)_statsClearingAfterReporting;
- (void)_statsIncrement:(id)increment forClientRequest:(id)request;
- (void)_statsIncrementAutoAssetJobsStarted;
- (void)_statsIncrementAutoJobsFinished;
- (void)_statsIncrementDownloadedForDescriptor:(id)descriptor;
- (void)_statsIncrementFailuresToStartJobs;
- (void)_statsIncrementPreviouslyDownloadedForDescriptor:(id)descriptor;
- (void)_statsIncrementPromotedForDescriptor:(id)descriptor;
- (void)_statsIncrementRemovedForDescriptor:(id)descriptor;
- (void)_statsIncrementResumedInFlightJobs;
- (void)_statsIncrementSchedulerTriggeredJobs;
- (void)_statsIncrementStagerDetermineJobsFinished;
- (void)_statsIncrementStagerDetermineJobsStarted;
- (void)_statsIncrementStagerDownloadJobsFinished;
- (void)_statsIncrementStagerDownloadJobsStarted;
- (void)_statsMaintainReporting;
- (void)_statsRestartNextMaintentanceReport;
- (void)_trackActiveDescriptor:(id)descriptor operation:(id)operation usingSelector:(id)selector withJobUUID:(id)d triggeredByClientMessage:(id)message downloadingDescriptor:(id)downloadingDescriptor baseForPatchDescriptor:(id)patchDescriptor message:(id)self0;
- (void)_trackPerformanceStartupBegin;
- (void)_updateCurrentSetStatus:(id)status forSetIdentifier:(id)identifier withSetStatus:(id)setStatus;
- (void)addActiveJobs:(id)jobs basedOnControl:(id)control;
- (void)addSuccessfullyDownloadedJobs:(id)jobs basedOnControl:(id)control;
- (void)addToCurrentJobs:(id)jobs usingSelector:(id)selector withJobUUID:(id)d triggeredByClientMessage:(id)message downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor usingSetDescriptor:(id)setDescriptor fromLocation:(id)self0;
- (void)assetPersonalizatonAttemptCompletePostEvent:(id)event withControlParam:(id)param;
- (void)atomicInstanceDropOncePersonalized:(id)personalized forSetConfiguration:(id)configuration;
- (void)atomicInstanceEliminate:(id)eliminate forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (void)atomicInstanceForceUnlock:(id)unlock dueToError:(id)error forgettingAtomicInstance:(id)instance historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d;
- (void)atomicInstanceLoadedFromPersisted:(id)persisted persistedEntryID:(id)d;
- (void)atomicInstanceRemove:(id)remove setAtomicInstanceUUID:(id)d removingForReason:(id)reason historyOperation:(int64_t)operation;
- (void)atomicInstanceRemovedSetJob:(id)job removingForReason:(id)reason historyOperation:(int64_t)operation;
- (void)atomicInstanceTrackSetDescriptor:(id)descriptor fromLocation:(id)location forSpecificAtomicInstance:(id)instance;
- (void)atomicInstanceTrimOverflowAfterPersisting:(id)persisting;
- (void)atomicInstanceUpdateUsageStatus:(id)status toNewStatus:(id)newStatus forAtomicInstance:(id)instance;
- (void)clearDownloadedFromSetStatus:(id)status forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (void)clientRequestsAwaitingDispatchAll:(id)all;
- (void)clientRequestsAwaitingSyncToAwaitingFirstUnlock:(id)unlock;
- (void)connectionClosedForClientID:(id)d;
- (void)considerDownloadedWithPSUSLookupResultsForLatestToVend;
- (void)decrementClientRequestCount:(id)count forEventInfo:(id)info;
- (void)eliminateUngraftDescriptor:(id)descriptor forAutoAssetDescriptor:(id)assetDescriptor failingClientRequestForEventInfo:(id)info;
- (void)eliminateUngraftSetDescriptor:(id)descriptor failingClientRequestForEventInfo:(id)info;
- (void)ensureStagerFullyResumed;
- (void)finishSetEliminateIfAwaitingUnlocked:(id)unlocked forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier;
- (void)firstSchedulerCrosscheckTrim;
- (void)firstSchedulerCrosscheckTrimAtomicInstances;
- (void)firstSchedulerCrosscheckTrimSetDescriptors;
- (void)firstSchedulerShortTermLockContentChecks:(id)checks;
- (void)forceGlobalSetUnlock:(id)unlock dueToError:(id)error ofSetDescriptor:(id)descriptor historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d;
- (void)forceGlobalUnlockFromLocation:(id)location dueToError:(id)error fullAssetSelector:(id)selector historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d;
- (void)handleClientAlterLockOperation:(id)operation forAutoJob:(id)job;
- (void)handleClientCancelActivityForSelectorRequest:(id)request;
- (void)handleClientCurrentStatusRequest:(id)request forAutoJob:(id)job;
- (void)handleClientEliminateAllForAssetTypeRequest:(id)request;
- (void)handleClientEliminateAllForSelectorRequest:(id)request;
- (void)handleClientEliminatePromotedNeverLockedForSelectorRequest:(id)request;
- (void)handleClientMapLockedToExclaveRequest:(id)request fromLocation:(id)location;
- (void)handleControlClientActiveJobSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientAvailableForStagingSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientControlStatisticsRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientForceGlobalAbandonRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientForceGlobalForgetRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientForceGlobalPurgeRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientForceGlobalUnlockRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientKnownAssetSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientLockedAssetSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientScheduledJobSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientSimulateSetJobOperation:(id)operation;
- (void)handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:(id)request;
- (void)handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:(id)request;
- (void)handleControlClientStagedAssetSummaryRequest:(id)request forAutoJob:(id)job;
- (void)handleControlClientStagerOverviewRequest:(id)request forAutoJob:(id)job;
- (void)handleEstimateEvictableBytesForSoftwareUpdateRequest:(id)request;
- (void)handleMessage:(id)message proxyObject:(id)object reply:(id)reply;
- (void)handleResumeFromSoftwareUpdateRequest:(id)request;
- (void)handleSetClientAlterEntriesRepresentingAtomicRequest:(id)request forAutoJob:(id)job whenCancelingSetJob:(id)setJob alteringFromSetConfiguration:(id)configuration;
- (void)handleSetClientAssetSetForStagingRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientContinueAtomicLockRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientCurrentStatusRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientEliminateAtomicRequest:(id)request whenCancelingSetJob:(id)job forAutoJob:(id)autoJob;
- (void)handleSetClientEndAtomicLockRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientEndAtomicLocksForClientRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientFormSubAtomicRequest:(id)request forAutoJob:(id)job;
- (void)handleSetClientMapLockedAtomicEntryRequest:(id)request forAutoJob:(id)job fromLocation:(id)location;
- (void)handleSetClientNeedForAtomicRequest:(id)request fromLocation:(id)location;
- (void)handleSetControlClientAssetSetsOverviewRequest:(id)request forAutoJob:(id)job;
- (void)handleSetControlClientInstanceInfoRequest:(id)request forAutoJob:(id)job;
- (void)handleStagingClientCancelOperation:(id)operation;
- (void)handleStagingClientDetermineAllAvailableForUpdateRequest:(id)request;
- (void)handleStagingClientDetermineAllAvailableRequest:(id)request;
- (void)handleStagingClientDetermineGroupsAvailableForUpdateRequest:(id)request;
- (void)handleStagingClientDownloadAllRequest:(id)request;
- (void)handleStagingClientDownloadGroupsRequest:(id)request;
- (void)handleStagingClientEraseAllRequest:(id)request;
- (void)handleStagingClientPurgeAllRequest:(id)request;
- (void)handleStatusForSoftwareUpdateRequest:(id)request;
- (void)handleSuspendForSoftwareUpdateRequest:(id)request;
- (void)handleSuspendResumeForSoftwareUpdateDaemonStartup;
- (void)initialStatusForJob:(id)job usingSelector:(id)selector withJobUUID:(id)d downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor withClientAssetPolicy:(id)policy;
- (void)initialStatusForSetJob:(id)job withJobUUID:(id)d usingSetDescriptor:(id)descriptor usingSetPolicy:(id)policy;
- (void)issueBuiltResponseForEventInfo:(id)info issuingResponseMessage:(id)message withResponseError:(id)error fromLocation:(id)location;
- (void)issueResponseForEventInfo:(id)info withAutoAssetError:(id)error fromAction:(id)action withDescription:(id)description;
- (void)issueResponseForEventInfo:(id)info withErrorCode:(int64_t)code fromAction:(id)action withDescription:(id)description;
- (void)issueResponseToClientRequest:(id)request issuingResponseMessage:(id)message withResponseError:(id)error;
- (void)issueResponseToFailedAutoAssetLockRequest:(id)request forEventInfo:(id)info withResponseError:(id)error forAttemptedDescriptor:(id)descriptor;
- (void)issueResponseToFailedSetLockRequest:(id)request forEventInfo:(id)info forAtomicInstance:(id)instance withResponseError:(id)error;
- (void)loadPersistedActiveJobs;
- (void)loadPersistedAtomicInstancesSupportingShortTermLocking;
- (void)loadPersistedCrosscheckStaleForceUnlock;
- (void)loadPersistedDescriptors;
- (void)loadPersistedSetActiveJobDescriptors;
- (void)loadPersistedSetAtomicInstances;
- (void)loadPersistedSetConfigurations;
- (void)loadPersistedSetDownloadedDescriptors;
- (void)loadPersistedSetTargets;
- (void)lockAutoAssetReplyJobResponse:(id)response forEventInfo:(id)info lockingChosenDescriptor:(id)descriptor;
- (void)modifySetConfiguration:(id)configuration toEntriesFromSetTarget:(id)target;
- (void)notifyCompletionCallbacksForSetJobKey:(id)key;
- (void)notifyEvictedCallbacksForSetDescriptor:(id)descriptor;
- (void)persistSetDescriptorActiveJob:(id)job fromLocation:(id)location;
- (void)persistSetDescriptorDownloadedJob:(id)job fromLocation:(id)location;
- (void)promoteAnyPreviouslyStagedNowDownloaded:(id)downloaded;
- (void)removeActiveJobForFullSelector:(id)selector removingFullSelector:(id)fullSelector alsoRemovingNoVersionSelector:(id)versionSelector;
- (void)removeClientRequest:(id)request fromLocation:(id)location;
- (void)removeCurrentJob:(id)job schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure fromLocation:(id)location;
- (void)removeCurrentSetJob:(id)job schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure fromLocation:(id)location historyOperation:(int64_t)operation;
- (void)removePreviouslyStagedSetDescriptors;
- (void)removeSetDescriptorActiveJobByAtomicInstanceUUID:(id)d;
- (void)removeSetDescriptorActiveJobByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier fromLocation:(id)location;
- (void)removeSetDescriptorDownloaded:(id)downloaded fromLocation:(id)location checkingByInstance:(BOOL)instance regardlessOfLatest:(BOOL)latest historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d;
- (void)removeSetTargetsForClientDomain:(id)domain forSetIdentifier:(id)identifier fromLocation:(id)location;
- (void)resumeJobsWhenBeforeFirstUnlock:(BOOL)unlock;
- (void)resumeSetJobsWhenBeforeFirstUnlock:(BOOL)unlock;
- (void)scheduledJobsResumed:(id)resumed;
- (void)secureCheckUngraft:(id)ungraft forDescriptorNoLongerLocked:(id)locked;
- (void)secureCheckUngraftAll:(id)all forSetDescriptorNoLongerLocked:(id)locked;
- (void)secureClearInsecureLatestAtomicInstances;
- (void)secureForceUngraft:(id)ungraft forDescriptorBeingRemoved:(id)removed;
- (void)securePersonalizeGraftLockSet:(id)set lockingSetDescriptor:(id)descriptor forEventInfo:(id)info fallingBackToSetDescriptor:(id)setDescriptor fromPreSUStaging:(BOOL)staging;
- (void)securePersonalizeGraftLockSet:(id)set lockingSetDescriptor:(id)descriptor forEventInfo:(id)info replyingOnError:(BOOL)error fromPreSUStaging:(BOOL)staging completion:(id)completion;
- (void)secureStartupEstablishOperationSequence:(id)sequence forRequiringPersonalization:(id)personalization forRequiringGrafting:(id)grafting;
- (void)setConfigurationAssetSetIDLatestToVend:(id)vend fromSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration buildingPersistReason:(id)reason;
- (void)setConfigurationAssetSetIDMostRecentlyReceived:(id)received fromSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration buildingPersistReason:(id)reason;
- (void)setConfigurationEliminate:(id)eliminate forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier;
- (void)setConfigurationForceUnlocked:(id)unlocked forSetConfiguration:(id)configuration;
- (void)setConfigurationLoadedFromPersisted:(id)persisted persistedEntryID:(id)d;
- (void)setConfigurationPersist:(id)persist fromLocation:(id)location forReason:(id)reason dueToAlter:(BOOL)alter forHistoryOperation:(int64_t)operation;
- (void)setConfigurationRemovedAtomicInstance:(id)instance fromLocation:(id)location;
- (void)setConfigurationTickForPreviouslyVended;
- (void)setConfigurationsPrePersonalizedJustCommitted:(id)committed;
- (void)setConfigurationsRefreshStaleIndications;
- (void)setDescriptorAddedPreInstalled:(id)installed;
- (void)setDescriptorEliminate:(id)eliminate triggeredByClient:(id)client forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier awaitingUnlocked:(BOOL)unlocked;
- (void)setDescriptorEliminateMatching:(id)matching forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier eliminatingSetIdentifer:(BOOL)identifer;
- (void)setIdentifierEliminate:(id)eliminate usingEliminateTracker:(id)tracker whenCurrentlyLocked:(BOOL)locked beginningToEliminate:(BOOL)toEliminate removingContent:(BOOL)content;
- (void)setJobIndicationOfPotentialLatestToVend:(id)vend forEventInfo:(id)info issuingClientReply:(BOOL)reply;
- (void)setLockUsageMapEliminateForClientDomain:(id)domain forSetIdentifier:(id)identifier;
- (void)setLockUsageMapEndedLockForSetDescriptor:(id)descriptor forLockReason:(id)reason endedLockCount:(int64_t)count;
- (void)setLockUsageMapLockedSetDescriptor:(id)descriptor forLockReason:(id)reason;
- (void)shortTermLockFilesHealthCheck;
- (void)startupActivationCompleted:(id)completed;
- (void)timerStopForClientRequest:(id)request fromLocation:(id)location;
- (void)trackClientRequest:(id)request;
- (void)trackDescriptor:(id)descriptor persisting:(BOOL)persisting fromLocation:(id)location changedWhileTerminated:(BOOL)terminated changedNeverBeenLocked:(BOOL)locked historyOperation:(int64_t)operation firstClientName:(id)name isPromoted:(BOOL)self0;
- (void)trackDescriptorForgetAssetSelector:(id)selector forHistoryOperation:(int64_t)operation firstClientName:(id)name;
- (void)trackDescriptorForgetAssetType:(id)type firstClientName:(id)name;
- (void)trackDescriptorForgetAssetType:(id)type forAssetSpecifier:(id)specifier firstClientName:(id)name;
- (void)trackPerformanceFilesystemExistCheck:(id)check atPath:(id)path withFilesystemInfo:(int64_t)info justUpdatedCache:(BOOL)cache;
- (void)trackPerformanceIteration:(id)iteration ofContainer:(id)container;
- (void)trackPerformancePhaseBegin:(id)begin;
- (void)trackPerformancePhaseEnd:(id)end;
- (void)trackPerformanceStartupEnd:(id)end;
- (void)trackPerformanceStartupStep:(id)step beginningStep:(id)beginningStep;
- (void)trackShortTermLockedSetDescriptor:(id)descriptor forSpecificAtomicInstance:(id)instance isReadOnlyForResumeFromPersisted:(BOOL)persisted;
- (void)updateAssociatedNoVersionStatus:(id)status currentStatus:(id)currentStatus forAssetSelector:(id)selector;
- (void)updateAutoAssetSetStatus:(id)status forSetDescriptor:(id)descriptor;
- (void)updateAutoAssetStatus:(id)status forActiveJobUUID:(id)d withLatestJobStatus:(id)jobStatus matchingAssetVersion:(id)version fromLocation:(id)location;
- (void)updateAutoAssetStatusForChosenDownloadedDescriptor:(id)descriptor matchingAssetVersion:(id)version fromLocation:(id)location;
- (void)updateCurrentAssetStatus:(id)status currentStatus:(id)currentStatus forAssetSelector:(id)selector forActiveJobUUID:(id)d matchingAssetVersion:(id)version downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor;
- (void)validateShortTermLockURL:(id)l normalizedClientDomainNameURL:(id)rL normalizedAssetSetIdentifierURL:(id)uRL fileManager:(id)manager isLatestLocker:(BOOL *)locker isSpecificLocker:(BOOL *)specificLocker;
- (void)verifyLockerLatestSymlink;
@end

@implementation MADAutoAssetControlManager

- (id)_softwareUpdateSuspendResumeEligibleSetEntryIDs
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = objc_opt_new();
  if (!v5)
  {
    v27 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} unable to alloc NSMutableSet", buf, 2u);
    }

    goto LABEL_69;
  }

  if (!_MAPreferencesIsInternalAllowed())
  {
    v26 = &off_4F8318;
    goto LABEL_49;
  }

  v6 = _MAPreferencesCopyNSDictionaryValue(@"AutoAssetSuspendResumeForSUSetsOverride");
  v7 = v6;
  if (!v6)
  {
    v8 = _MADLog(@"AutoControl-SuspendResume");
    v26 = &off_4F8318;
    if (!os_log_type_enabled(v8, OS_LOG_TYPE_DEBUG))
    {
LABEL_47:

      goto LABEL_48;
    }

    *buf = 138412290;
    v86 = &off_4F8318;
    v28 = "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} override not set | value:\n%@";
    v29 = v8;
    v30 = OS_LOG_TYPE_DEBUG;
LABEL_39:
    _os_log_impl(&dword_0, v29, v30, v28, buf, 0xCu);
    goto LABEL_47;
  }

  v80 = 0u;
  v81 = 0u;
  v78 = 0u;
  v79 = 0u;
  v8 = v6;
  v63 = [v8 countByEnumeratingWithState:&v78 objects:v89 count:16];
  if (!v63)
  {

LABEL_37:
    v26 = v8;
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_47;
    }

    *buf = 138412290;
    v86 = v26;
    v28 = "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} override set | value:\n%@";
    v29 = v8;
    v30 = OS_LOG_TYPE_DEFAULT;
    goto LABEL_39;
  }

  v56 = v7;
  v65 = *v79;
  v61 = 1;
  v57 = v5;
  v59 = v8;
  while (2)
  {
    for (i = 0; i != v63; i = i + 1)
    {
      if (*v79 != v65)
      {
        objc_enumerationMutation(v8);
      }

      v10 = *(*(&v78 + 1) + 8 * i);
      v11 = objc_autoreleasePoolPush();
      objc_opt_class();
      if ((objc_opt_isKindOfClass() & 1) == 0)
      {
        v37 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
        {
          v38 = v8;
          v39 = objc_opt_class();
          v40 = v39;
          v41 = objc_opt_class();
          *buf = 138412546;
          v86 = v39;
          v87 = 2112;
          v88 = v41;
          v42 = v41;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for key | expected:%@ found:%@", buf, 0x16u);

          v8 = v38;
        }

        goto LABEL_46;
      }

      v12 = v10;
      v13 = [v8 objectForKeyedSubscript:v12];
      if (!v13 || (objc_opt_class(), (objc_opt_isKindOfClass() & 1) == 0))
      {
        v31 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
        {
          v32 = v8;
          v33 = objc_opt_class();
          v34 = v33;
          v35 = objc_opt_class();
          *buf = 138412546;
          v86 = v33;
          v87 = 2112;
          v88 = v35;
          v36 = v35;
          _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for value | expected:%@ found:%@", buf, 0x16u);

          v8 = v32;
        }

LABEL_46:
        objc_autoreleasePoolPop(v11);
        v26 = &off_4F8318;
        v7 = v56;
        goto LABEL_47;
      }

      v14 = v13;
      v74 = 0u;
      v75 = 0u;
      v76 = 0u;
      v77 = 0u;
      v15 = v14;
      v16 = [v15 countByEnumeratingWithState:&v74 objects:v84 count:16];
      if (v16)
      {
        v17 = v16;
        v18 = *v75;
        while (2)
        {
          for (j = 0; j != v17; ++j)
          {
            if (*v75 != v18)
            {
              objc_enumerationMutation(v15);
            }

            objc_opt_class();
            if ((objc_opt_isKindOfClass() & 1) == 0)
            {
              v21 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
              {
                v22 = objc_opt_class();
                v23 = v22;
                v24 = objc_opt_class();
                *buf = 138412546;
                v86 = v22;
                v87 = 2112;
                v88 = v24;
                v25 = v24;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} found wrong type for array member | expected:%@ found:%@", buf, 0x16u);
              }

              v61 = 0;
              v20 = 0;
              goto LABEL_24;
            }
          }

          v17 = [v15 countByEnumeratingWithState:&v74 objects:v84 count:16];
          if (v17)
          {
            continue;
          }

          break;
        }

        v20 = 1;
LABEL_24:
        v5 = v57;
        v8 = v59;
      }

      else
      {
        v20 = 1;
      }

      objc_autoreleasePoolPop(v11);
      if (!v20)
      {
        goto LABEL_29;
      }
    }

    v63 = [v8 countByEnumeratingWithState:&v78 objects:v89 count:16];
    if (v63)
    {
      continue;
    }

    break;
  }

LABEL_29:

  v7 = v56;
  if (v61)
  {
    goto LABEL_37;
  }

  v26 = &off_4F8318;
LABEL_48:

LABEL_49:
  v72 = 0u;
  v73 = 0u;
  v70 = 0u;
  v71 = 0u;
  v27 = v26;
  v62 = [v27 countByEnumeratingWithState:&v70 objects:v83 count:16];
  if (v62)
  {
    v58 = *v71;
    v60 = v27;
    do
    {
      v43 = 0;
      do
      {
        if (*v71 != v58)
        {
          objc_enumerationMutation(v27);
        }

        v64 = v43;
        v44 = *(*(&v70 + 1) + 8 * v43);
        v45 = [v27 objectForKeyedSubscript:v44, v56];
        v66 = 0u;
        v67 = 0u;
        v68 = 0u;
        v69 = 0u;
        v46 = [v45 countByEnumeratingWithState:&v66 objects:v82 count:16];
        if (v46)
        {
          v47 = v46;
          v48 = *v67;
          do
          {
            for (k = 0; k != v47; k = k + 1)
            {
              if (*v67 != v48)
              {
                objc_enumerationMutation(v45);
              }

              v50 = *(*(&v66 + 1) + 8 * k);
              v51 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v44 forAssetSetIdentifier:v50];
              if (v51)
              {
                [v5 addObject:v51];
              }

              else
              {
                v52 = v5;
                v53 = _MADLog(@"AutoControl-SuspendResume");
                if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138543618;
                  v86 = v44;
                  v87 = 2114;
                  v88 = v50;
                  _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_softwareUpdateSuspendResumeEligibleSetEntryIDs} unexpected nil for setEntryID | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", buf, 0x16u);
                }

                v5 = v52;
              }
            }

            v47 = [v45 countByEnumeratingWithState:&v66 objects:v82 count:16];
          }

          while (v47);
        }

        v43 = v64 + 1;
        v27 = v60;
      }

      while ((v64 + 1) != v62);
      v62 = [v60 countByEnumeratingWithState:&v70 objects:v83 count:16];
    }

    while (v62);
  }

  v54 = v5;
LABEL_69:

  return v5;
}

- (BOOL)isSuspendedForSoftwareUpdate:(id)update forAssetSetIdentifier:(id)identifier
{
  updateCopy = update;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!updateCopy || !identifierCopy)
  {
    _softwareUpdateSuspendResumeEligibleSetEntryIDs = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(_softwareUpdateSuspendResumeEligibleSetEntryIDs, OS_LOG_TYPE_ERROR))
    {
      v15 = 138543618;
      v16 = updateCopy;
      v17 = 2114;
      v18 = identifierCopy;
      _os_log_impl(&dword_0, _softwareUpdateSuspendResumeEligibleSetEntryIDs, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} missing required parameter | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v15, 0x16u);
    }

    v10 = 0;
    goto LABEL_18;
  }

  if (([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]& 0xFFFFFFFFFFFFFFFELL) != 0x64)
  {
    _softwareUpdateSuspendResumeEligibleSetEntryIDs = [(MADAutoAssetControlManager *)self _softwareUpdateSuspendResumeEligibleSetEntryIDs];
    if (_softwareUpdateSuspendResumeEligibleSetEntryIDs)
    {
      v12 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:updateCopy forAssetSetIdentifier:identifierCopy];
      if (v12)
      {
        v10 = [_softwareUpdateSuspendResumeEligibleSetEntryIDs containsObject:v12];
LABEL_17:

LABEL_18:
        goto LABEL_19;
      }

      v13 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        v15 = 138543618;
        v16 = updateCopy;
        v17 = 2114;
        v18 = identifierCopy;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} isSuspendedForSoftwareUpdate:forAssetSetIdentifier observing nil setEntryID | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v15, 0x16u);
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        LOWORD(v15) = 0;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "{isSuspendedForSoftwareUpdate} isSuspendedForSoftwareUpdate:forAssetSetIdentifier observing nil softwareUpdateSuspendResumeEligibleSetEntryIDs", &v15, 2u);
      }
    }

    v10 = 0;
    goto LABEL_17;
  }

  v10 = 0;
LABEL_19:

  return v10;
}

- (void)_addCompletionCallbackForSetJobKey:(id)key completionCallback:(id)callback
{
  keyCopy = key;
  callbackCopy = callback;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  completionCallbacksBySetJobKey = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
  if (!completionCallbacksBySetJobKey)
  {
    completionCallbacksBySetJobKey = objc_opt_new();
    [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:completionCallbacksBySetJobKey];
  }

  v10 = [completionCallbacksBySetJobKey objectForKeyedSubscript:keyCopy];
  if (!v10)
  {
    v10 = objc_opt_new();
    [completionCallbacksBySetJobKey setObject:v10 forKeyedSubscript:keyCopy];
  }

  v11 = objc_retainBlock(callbackCopy);
  [v10 addObject:v11];
}

- (void)notifyCompletionCallbacksForSetJobKey:(id)key
{
  keyCopy = key;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  completionCallbacksBySetJobKey = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
  if (completionCallbacksBySetJobKey)
  {
    if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_B8.segname[1])
    {
      if (keyCopy)
      {
        v8 = [completionCallbacksBySetJobKey objectForKeyedSubscript:keyCopy];
        v9 = v8;
        if (v8)
        {
          v20 = 0u;
          v21 = 0u;
          v18 = 0u;
          v19 = 0u;
          v10 = [v8 countByEnumeratingWithState:&v18 objects:v23 count:16];
          if (v10)
          {
            v11 = v10;
            v12 = *v19;
            do
            {
              for (i = 0; i != v11; i = i + 1)
              {
                if (*v19 != v12)
                {
                  objc_enumerationMutation(v9);
                }

                (*(*(*(&v18 + 1) + 8 * i) + 16))();
              }

              v11 = [v9 countByEnumeratingWithState:&v18 objects:v23 count:16];
            }

            while (v11);
          }

          completionCallbacksBySetJobKey2 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
          [completionCallbacksBySetJobKey2 setObject:0 forKeyedSubscript:keyCopy];

          completionCallbacksBySetJobKey3 = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];
          v16 = [completionCallbacksBySetJobKey3 count];

          if (!v16)
          {
            [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:0];
          }
        }

        goto LABEL_19;
      }

      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        v17 = "{notifyCompletionCallbacksForSetJobKey} basic invariant violated";
        goto LABEL_18;
      }
    }

    else
    {
      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        v17 = "{notifyCompletionCallbacksForSetJobKey} infeasible path. If callbacks are registered we must be .Suspending";
LABEL_18:
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, v17, buf, 2u);
      }
    }

LABEL_19:
  }
}

- (void)_addEvictedCallbackForAtomicInstanceUUID:(id)d completionCallback:(id)callback
{
  dCopy = d;
  callbackCopy = callback;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  evictedCallbacksByAtomicInstanceUUID = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];
  if (!evictedCallbacksByAtomicInstanceUUID)
  {
    evictedCallbacksByAtomicInstanceUUID = objc_opt_new();
    [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:evictedCallbacksByAtomicInstanceUUID];
  }

  v10 = [evictedCallbacksByAtomicInstanceUUID objectForKeyedSubscript:dCopy];
  if (!v10)
  {
    v10 = objc_opt_new();
    [evictedCallbacksByAtomicInstanceUUID setObject:v10 forKeyedSubscript:dCopy];
  }

  v11 = objc_retainBlock(callbackCopy);
  [v10 addObject:v11];
}

- (void)notifyEvictedCallbacksForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  evictedCallbacksByAtomicInstanceUUID = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];
  if (evictedCallbacksByAtomicInstanceUUID)
  {
    if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_B8.segname[1])
    {
      if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"notifyEvictedCallbacksForSetDescriptor" forSetDescriptor:descriptorCopy])
      {
        latestDownloadedAtomicInstance = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(latestDownloadedAtomicInstance, OS_LOG_TYPE_ERROR))
        {
          summary = [descriptorCopy summary];
          *buf = 138543362;
          v24 = summary;
          _os_log_impl(&dword_0, latestDownloadedAtomicInstance, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} notifyEvictedCallbacksForSetDescriptor invoked for locked set descriptor | setDescriptor:%{public}@", buf, 0xCu);
        }
      }

      else
      {
        latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
        if (latestDownloadedAtomicInstance)
        {
          v10 = [evictedCallbacksByAtomicInstanceUUID objectForKeyedSubscript:latestDownloadedAtomicInstance];
          if (v10)
          {
            if ([(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"evictSetDescriptorIfAwaitingUnlocked" setDescriptor:descriptorCopy allowRemovalWithoutNewerDescriptor:1])
            {
              v20 = 0u;
              v21 = 0u;
              v18 = 0u;
              v19 = 0u;
              v11 = v10;
              v12 = [v11 countByEnumeratingWithState:&v18 objects:v22 count:16];
              if (v12)
              {
                v13 = v12;
                v14 = *v19;
                do
                {
                  v15 = 0;
                  do
                  {
                    if (*v19 != v14)
                    {
                      objc_enumerationMutation(v11);
                    }

                    (*(*(*(&v18 + 1) + 8 * v15) + 16))(*(*(&v18 + 1) + 8 * v15));
                    v15 = v15 + 1;
                  }

                  while (v13 != v15);
                  v13 = [v11 countByEnumeratingWithState:&v18 objects:v22 count:16];
                }

                while (v13);
              }

              [evictedCallbacksByAtomicInstanceUUID setObject:0 forKeyedSubscript:{latestDownloadedAtomicInstance, v18}];
              if (![evictedCallbacksByAtomicInstanceUUID count])
              {
                [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:0];
              }
            }

            else
            {
              v16 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
              {
                summary2 = [descriptorCopy summary];
                *buf = 138543362;
                v24 = summary2;
                _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "{notifyEvictedCallbacksForSetDescriptor} unable to remove downloaded set descriptor | setDescriptor:%{public}@", buf, 0xCu);
              }
            }
          }
        }
      }
    }

    else
    {
      latestDownloadedAtomicInstance = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(latestDownloadedAtomicInstance, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, latestDownloadedAtomicInstance, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} infeasible path. If callbacks are registered we must be .Suspending", buf, 2u);
      }
    }
  }
}

- (void)handleEstimateEvictableBytesForSoftwareUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  mach_absolute_time();
  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== &stru_20.flags)
  {
    if (_MAPreferencesIsInternalAllowed())
    {
      HIBYTE(v25) = 0;
      if (_MAPreferencesGetAppBooleanValue(@"AutoAssetSuspendResumeForSUEnabled", &v25 + 7))
      {
        v7 = 1;
      }

      else
      {
        v7 = HIBYTE(v25) == 0;
      }
    }

    else
    {
      v7 = 1;
    }

    LODWORD(v25) = v7;
    v8 = [(MADAutoAssetControlManager *)self _handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:0, v25];
    mach_absolute_time();
    v9 = +[MADAnalyticsManager getAnalyticsManager];
    v26[0] = @"totalFileSystemBytes";
    v10 = [NSNumber numberWithUnsignedLongLong:v8];
    v27[0] = v10;
    v26[1] = @"suspendResumeEnabled";
    v11 = [NSNumber numberWithBool:v7];
    v27[1] = v11;
    v26[2] = @"durationSeconds";
    MAConvertTicksToSeconds();
    v12 = [NSNumber numberWithDouble:?];
    v27[2] = v12;
    v26[3] = @"duringStartup";
    startupTransaction = [(MADAutoAssetControlManager *)self startupTransaction];
    v14 = [NSNumber numberWithInt:startupTransaction != 0];
    v27[3] = v14;
    v15 = [NSDictionary dictionaryWithObjects:v27 forKeys:v26 count:4];
    v16 = [v9 recordEventWithName:@"com.apple.mobileassetd.handleEstimateEvictableBytesForSoftwareUpdateRequest" assetType:0 payload:v15];

    if (!v25)
    {
      v8 = 0;
    }

    clientRequestMessage = [requestCopy clientRequestMessage];
    v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

    v19 = [[MAAutoAssetSuspendResumeForSoftwareUpdateEstimateEvictableBytesResponseInfo alloc] initWithEstimatedEvictableBytes:v8];
    v20 = objc_alloc_init(NSMutableDictionary);
    [v20 setSafeObject:v19 forKey:@"suspendResumeForSU"];
    v21 = [SUCoreConnectMessage alloc];
    clientRequestMessage2 = [requestCopy clientRequestMessage];
    clientID = [clientRequestMessage2 clientID];
    v24 = [v21 initWithType:2 messageName:v18 clientID:clientID version:0 message:v20];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v24 withResponseError:0 fromLocation:@"handleEstimateEvictableBytesForSoftwareUpdateRequest"];
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleEstimateEvictableBytesForSoftwareUpdateRequest" withDescription:@"handleEstimateEvictableBytesForSoftwareUpdateRequest - not in state .Running, unable to estimate."];
  }
}

- (unint64_t)_handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:(id *)identifier
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v6 = objc_opt_new();
  v55 = 0u;
  v56 = 0u;
  v57 = 0u;
  v58 = 0u;
  _softwareUpdateSuspendResumeEligibleSetEntryIDs = [(MADAutoAssetControlManager *)self _softwareUpdateSuspendResumeEligibleSetEntryIDs];
  v8 = [_softwareUpdateSuspendResumeEligibleSetEntryIDs countByEnumeratingWithState:&v55 objects:v64 count:16];
  if (v8)
  {
    v9 = v8;
    v46 = 0;
    v10 = *v56;
    v42 = _softwareUpdateSuspendResumeEligibleSetEntryIDs;
    v43 = v6;
    v41 = *v56;
    do
    {
      v11 = 0;
      v44 = v9;
      do
      {
        if (*v56 != v10)
        {
          objc_enumerationMutation(_softwareUpdateSuspendResumeEligibleSetEntryIDs);
        }

        v12 = *(*(&v55 + 1) + 8 * v11);
        knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v14 = [knownSetConfigurationsByIdentifier objectForKeyedSubscript:v12];

        v50 = v12;
        if (v12)
        {
          latestAtomicInstanceToVend = [v14 latestAtomicInstanceToVend];
          if (latestAtomicInstanceToVend)
          {
            v47 = v14;
            v48 = v11;
            previouslyVendedLockedAtomicInstances = [v14 previouslyVendedLockedAtomicInstances];
            v16 = [previouslyVendedLockedAtomicInstances count];

            if (v16)
            {
              v17 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v61 = v12;
                v62 = 2048;
                v63 = v16;
                _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} has non-zero previously vended locked atomic instances | assetSetIdentifier:%{public}@ previouslyVendedLockedAtomicInstancesCount:%llu", buf, 0x16u);
              }

              [v6 setObject:&off_4F7EC8 forKeyedSubscript:v12];
            }

            else
            {
              v20 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"_handleStatusForSoftwareUpdateRequest" forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:0];
              v51 = 0u;
              v52 = 0u;
              v53 = 0u;
              v54 = 0u;
              v45 = v20;
              latestDowloadedAtomicInstanceEntries = [v20 latestDowloadedAtomicInstanceEntries];
              v22 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v51 objects:v59 count:16];
              if (v22)
              {
                v23 = v22;
                v24 = 0;
                v25 = *v52;
                do
                {
                  for (i = 0; i != v23; i = i + 1)
                  {
                    if (*v52 != v25)
                    {
                      objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
                    }

                    v27 = *(*(&v51 + 1) + 8 * i);
                    v28 = objc_autoreleasePoolPush();
                    v29 = [(MADAutoAssetControlManager *)self persistedKnownDescriptorForSetAtomicEntry:v27];
                    v30 = v29;
                    if (v29)
                    {
                      metadata = [v29 metadata];
                      v32 = [metadata safeIntegerForKey:@"_UnarchivedSize"];

                      v24 = v24 + (v32 & ~(v32 >> 63));
                    }

                    else
                    {
                      v33 = _MADLog(@"AutoControl-SuspendResume");
                      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
                      {
                        summary = [v27 summary];
                        *buf = 138543618;
                        v61 = v50;
                        v62 = 2114;
                        v63 = summary;
                        _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} missing download descriptor | assetSetIdentifier:%{public}@ setAtomicEntry:%{public}@", buf, 0x16u);
                      }
                    }

                    objc_autoreleasePoolPop(v28);
                  }

                  v23 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v51 objects:v59 count:16];
                }

                while (v23);
              }

              else
              {
                v24 = 0;
              }

              v35 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138543618;
                v61 = v50;
                v62 = 2048;
                v63 = v24;
                _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} done calculating latest atomic instance to vend size | assetSetIdentifier:%{public}@ setFileSystemBytes:%llu", buf, 0x16u);
              }

              v46 += v24;
              v36 = [NSNumber numberWithUnsignedLongLong:v24];
              v6 = v43;
              [v43 setObject:v36 forKeyedSubscript:v50];

              v10 = v41;
              _softwareUpdateSuspendResumeEligibleSetEntryIDs = v42;
              v9 = v44;
            }

            v14 = v47;
            v11 = v48;
          }

          else
          {
            v19 = _MADLog(@"AutoControl-SuspendResume");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v61 = v12;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} has no latest instance to vend | assetSetIdentifier:%{public}@", buf, 0xCu);
            }

            [v6 setObject:&off_4F7EC8 forKeyedSubscript:v12];
          }

          v18 = latestAtomicInstanceToVend;
        }

        else
        {
          v18 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v61 = 0;
            _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{_handleEstimateEvictableBytesForSoftwareUpdateRequest} no known set configuration | assetSetIdentifier:%{public}@", buf, 0xCu);
          }
        }

        v11 = v11 + 1;
      }

      while (v11 != v9);
      v9 = [_softwareUpdateSuspendResumeEligibleSetEntryIDs countByEnumeratingWithState:&v55 objects:v64 count:16];
    }

    while (v9);
  }

  else
  {
    v46 = 0;
  }

  v37 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 134217984;
    v61 = v46;
    _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "_handleEstimateEvictableBytesForSoftwareUpdateRequest done | totalSystemFileSystemSpace:%llu", buf, 0xCu);
  }

  if (identifier)
  {
    v38 = v6;
    *identifier = v6;
  }

  return v46;
}

- (void)handleSuspendForSoftwareUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = mach_absolute_time();
  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];
  v10 = [message safeObjectForKey:@"suspendResumeForSU" ofClass:objc_opt_class()];

  if (!v10)
  {
    v12 = @"handleSuspendForSoftwareUpdateRequest - missing request info";
    selfCopy2 = self;
    v14 = requestCopy;
    v15 = 6102;
LABEL_7:
    [(MADAutoAssetControlManager *)selfCopy2 issueResponseForEventInfo:v14 withErrorCode:v15 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:v12];
    goto LABEL_22;
  }

  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]== stru_B8.segname)
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - already suspended!", buf, 2u);
    }

    v12 = @"handleSuspendForSoftwareUpdateRequest - already suspended";
    selfCopy2 = self;
    v14 = requestCopy;
    v15 = 6703;
    goto LABEL_7;
  }

  v35 = v10;
  neededBytes = [v10 neededBytes];
  v39 = 0;
  v16 = [(MADAutoAssetControlManager *)self _handleEstimateEvictableBytesForSoftwareUpdateRequestWithBytesBySetIdentifier:&v39];
  v34 = v39;
  mach_absolute_time();
  v17 = +[MADAnalyticsManager getAnalyticsManager];
  v44[0] = @"availableBytes";
  v18 = [NSNumber numberWithUnsignedLongLong:v16];
  v45[0] = v18;
  v44[1] = @"neededBytes";
  v19 = [NSNumber numberWithUnsignedLongLong:neededBytes];
  v45[1] = v19;
  v44[2] = @"durationSeconds";
  v32 = v7;
  MAConvertTicksToSeconds();
  v20 = [NSNumber numberWithDouble:?];
  v45[2] = v20;
  v44[3] = @"duringStartup";
  startupTransaction = [(MADAutoAssetControlManager *)self startupTransaction];
  v22 = [NSNumber numberWithInt:startupTransaction != 0];
  v45[3] = v22;
  v23 = [NSDictionary dictionaryWithObjects:v45 forKeys:v44 count:4];
  v24 = [v17 recordEventWithName:@"com.apple.mobileassetd.handleSuspendForSoftwareUpdateRequest-spaceCheck" assetType:0 payload:v23];

  if (neededBytes <= v16)
  {
    v25 = v34;
    v10 = v35;
    if (!v34)
    {
      v27 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "handleSuspendForSoftwareUpdateRequest | unexpectedly empty bytesBySetIdentifier!", buf, 2u);
      }

      v25 = objc_opt_new();
    }

    v36[0] = _NSConcreteStackBlock;
    v36[1] = 3221225472;
    v36[2] = __97__MADAutoAssetControlManager_SoftwareUpdateSuspendResume__handleSuspendForSoftwareUpdateRequest___block_invoke;
    v36[3] = &unk_4B3D88;
    v38 = v32;
    v36[4] = self;
    v28 = requestCopy;
    v37 = v28;
    v29 = objc_retainBlock(v36);
    v30 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
    {
      v31 = [v28 description];
      *buf = 138412290;
      v41 = v31;
      _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - transition to suspended. | eventInfo=%@", buf, 0xCu);
    }

    if (![(MADAutoAssetControlManager *)self _handleSuspendForSoftwareUpdateRequestWithNeededBytes:neededBytes bytesBySetIdentifier:v25 completionBlock:v29])
    {
      (v29[2])(v29, 100);
    }
  }

  else
  {
    v25 = v34;
    v26 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
    {
      *buf = 134218240;
      v41 = neededBytes;
      v42 = 2048;
      v43 = v16;
      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{handleSuspendForSoftwareUpdateRequest} bytes needed unavailable | neededBytes:%llu availableBytes:%llu", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6108 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:@"handleSuspendForSoftwareUpdateRequest - bytes needed are unavailable"];
    v10 = v35;
  }

LABEL_22:
}

void __97__MADAutoAssetControlManager_SoftwareUpdateSuspendResume__handleSuspendForSoftwareUpdateRequest___block_invoke(uint64_t a1, uint64_t a2)
{
  mach_absolute_time();
  v4 = +[MADAnalyticsManager getAnalyticsManager];
  v22[0] = @"suspended";
  v5 = [NSNumber numberWithInt:a2 == 1];
  v23[0] = v5;
  v22[1] = @"result";
  if (a2 > 102)
  {
    if (a2 <= 200)
    {
      if (a2 == 103)
      {
        v6 = @"EvictionTimerFired";
        goto LABEL_24;
      }

      if (a2 == 200)
      {
        v6 = @"StatusUnknownState";
        goto LABEL_24;
      }
    }

    else
    {
      switch(a2)
      {
        case 201:
          v6 = @"StatusUnexpectedNonce";
          goto LABEL_24;
        case 202:
          v6 = @"StatusUnepxectedState";
          goto LABEL_24;
        case 203:
          v6 = @"StatusWriteError";
          goto LABEL_24;
      }
    }

    goto LABEL_23;
  }

  if (a2 <= 99)
  {
    if (!a2)
    {
      v6 = @"Unknown";
      goto LABEL_24;
    }

    if (a2 == 1)
    {
      v6 = @"Success";
      goto LABEL_24;
    }

LABEL_23:
    v6 = @"Unexpected";
    goto LABEL_24;
  }

  if (a2 == 100)
  {
    v6 = @"FailedToStart";
  }

  else if (a2 == 101)
  {
    v6 = @"AutoJobCancellationTimerFired:";
  }

  else
  {
    v6 = @"CannotSetEmptyAtomicInstance";
  }

LABEL_24:
  v23[1] = v6;
  v22[2] = @"durationSeconds";
  MAConvertTicksToSeconds();
  v7 = [NSNumber numberWithDouble:?];
  v23[2] = v7;
  v22[3] = @"duringStartup";
  v8 = [*(a1 + 32) startupTransaction];
  v9 = [NSNumber numberWithInt:v8 != 0];
  v23[3] = v9;
  v10 = [NSDictionary dictionaryWithObjects:v23 forKeys:v22 count:4];
  v11 = [v4 recordEventWithName:@"com.apple.mobileassetd.handleSuspendForSoftwareUpdateRequest-suspendComplete" assetType:0 payload:v10];

  if (a2 == 1)
  {
    v12 = [*(a1 + 40) clientRequestMessage];
    v13 = [MADAutoAssetControlManager replyMessageNameForRequest:v12];

    v14 = objc_alloc_init(MAAutoAssetSuspendResumeForSoftwareUpdateResponseInfo);
    v15 = objc_alloc_init(NSMutableDictionary);
    [v15 setSafeObject:v14 forKey:@"suspendResumeForSU"];
    v16 = [SUCoreConnectMessage alloc];
    v17 = [*(a1 + 40) clientRequestMessage];
    v18 = [v17 clientID];
    v19 = [v16 initWithType:2 messageName:v13 clientID:v18 version:0 message:v15];

    [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 40) issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleSuspendForSoftwareUpdateRequest"];
  }

  else
  {
    if (([*(a1 + 32) _handleResumeFromSoftwareUpdateRequest] & 1) == 0)
    {
      v20 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        *v21 = 0;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{handleSuspendForSoftwareUpdateRequest} error transitioning to resume!", v21, 2u);
      }
    }

    [*(a1 + 32) issueResponseForEventInfo:*(a1 + 40) withErrorCode:6102 fromAction:@"handleSuspendForSoftwareUpdateRequest" withDescription:@"handleSuspendForSoftwareUpdateRequest - failed to transition to suspended"];
  }
}

- (BOOL)_handleSuspendForSoftwareUpdateRequestWithNeededBytes:(unint64_t)bytes bytesBySetIdentifier:(id)identifier completionBlock:(id)block
{
  identifierCopy = identifier;
  blockCopy = block;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!identifierCopy || !blockCopy)
  {
    v13 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v32 = objc_retainBlock(blockCopy);
      *buf = 138543618;
      v57 = identifierCopy;
      v58 = 2114;
      v59 = v32;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} missing required parameter | bytesByAssetSetIdentifier:%{public}@ completionBlock:%{public}@", buf, 0x16u);
    }

    goto LABEL_30;
  }

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  if ([MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0]!= &stru_20.flags)
  {
    v13 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unexpected status!", buf, 2u);
    }

LABEL_30:
    v33 = 0;
    goto LABEL_59;
  }

  v13 = +[NSUUID UUID];
  if (!v13)
  {
    v14 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to alloc/init NSUUID!", buf, 2u);
    }

    v33 = 0;
    goto LABEL_58;
  }

  v14 = objc_opt_new();
  if (!v14)
  {
    v16 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to alloc/init NSMutableArray!", buf, 2u);
    }

    goto LABEL_56;
  }

  v15 = [identifierCopy keysSortedByValueUsingComparator:&__block_literal_global_17];
  v16 = v15;
  if (!v15)
  {
    v34 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
    {
LABEL_55:

LABEL_56:
      v33 = 0;
      goto LABEL_57;
    }

    *buf = 0;
    v35 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to resolve sorted bytesBySetIdentifier";
    v36 = v34;
    v37 = OS_LOG_TYPE_DEFAULT;
LABEL_54:
    _os_log_impl(&dword_0, v36, v37, v35, buf, 2u);
    goto LABEL_55;
  }

  if (!bytes)
  {
LABEL_48:
    if ([p_weak_ivar_lyt[387] writeNewSuspendingStateWithNonce:v13 setConfigurationsToEvict:v14])
    {
      [(MADAutoAssetControlManager *)self _handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:v13 sortedKeys:v16 setConfigurationsToEvict:v14 completionBlock:blockCopy];
      v33 = 1;
      goto LABEL_57;
    }

    v43 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to write suspend file, resuming...", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
    v34 = _MADLog(@"AutoControl-SuspendResume");
    if (!os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_55;
    }

    *buf = 0;
    v35 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} failed to write suspend file, resumed";
    v36 = v34;
    v37 = OS_LOG_TYPE_ERROR;
    goto LABEL_54;
  }

  bytesCopy = bytes;
  v49 = v14;
  v46 = v13;
  v47 = blockCopy;
  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  v45 = v15;
  obj = v15;
  v17 = [obj countByEnumeratingWithState:&v51 objects:v55 count:16];
  if (!v17)
  {
    v19 = 0;
    goto LABEL_42;
  }

  v18 = v17;
  v19 = 0;
  v20 = *v52;
  while (2)
  {
    for (i = 0; i != v18; i = i + 1)
    {
      if (*v52 != v20)
      {
        objc_enumerationMutation(obj);
      }

      v22 = *(*(&v51 + 1) + 8 * i);
      v23 = [identifierCopy objectForKeyedSubscript:v22];
      knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      v25 = [knownSetConfigurationsByIdentifier objectForKeyedSubscript:v22];

      if (!v25)
      {
        v27 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v57 = v22;
          v28 = v27;
          v29 = OS_LOG_TYPE_ERROR;
          v30 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} missing set configuration | assetSetIdentifier:%{public}@";
          v31 = 12;
LABEL_21:
          _os_log_impl(&dword_0, v28, v29, v30, buf, v31);
        }

LABEL_22:

        goto LABEL_23;
      }

      unsignedLongLongValue = [v23 unsignedLongLongValue];
      if (!unsignedLongLongValue)
      {
        v27 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          v28 = v27;
          v29 = OS_LOG_TYPE_DEFAULT;
          v30 = "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} latest instance to vend already the empty set!";
          v31 = 2;
          goto LABEL_21;
        }

        goto LABEL_22;
      }

      v19 += unsignedLongLongValue;
      [v49 addObject:v25];
      if (v19 >= bytesCopy)
      {
        v38 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 0;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} found sufficient bytes to evict!", buf, 2u);
        }

        goto LABEL_42;
      }

LABEL_23:
    }

    v18 = [obj countByEnumeratingWithState:&v51 objects:v55 count:16];
    if (v18)
    {
      continue;
    }

    break;
  }

LABEL_42:

  v14 = v49;
  v40 = v19 >= bytesCopy;
  v13 = v46;
  blockCopy = v47;
  v16 = v45;
  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
  if (v40)
  {
    goto LABEL_48;
  }

  v41 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unable to evict expected bytes, resuming...", buf, 2u);
  }

  [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
  v42 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdateRequestWithNeededBytes} unable to evict expected bytes, resumed", buf, 2u);
  }

  v33 = 0;
  v16 = obj;
LABEL_57:

LABEL_58:
LABEL_59:

  return v33;
}

- (void)_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce:(id)nonce sortedKeys:(id)keys setConfigurationsToEvict:(id)evict completionBlock:(id)block
{
  nonceCopy = nonce;
  keysCopy = keys;
  evictCopy = evict;
  blockCopy = block;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  objc_initWeak(&location, self);
  group = dispatch_group_create();
  v74 = 0u;
  v75 = 0u;
  v76 = 0u;
  v77 = 0u;
  obj = keysCopy;
  v13 = [obj countByEnumeratingWithState:&v74 objects:v83 count:16];
  if (v13)
  {
    v14 = *v75;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v75 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v16 = *(*(&v74 + 1) + 8 * i);
        knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v18 = [knownSetConfigurationsByIdentifier objectForKeyedSubscript:v16];

        clientDomainName = [v18 clientDomainName];
        assetSetIdentifier = [v18 assetSetIdentifier];
        v21 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName byIdentifier:assetSetIdentifier];

        if (v21)
        {
          clientDomainName2 = [v18 clientDomainName];
          autoAssetSetIdentifier = [v21 autoAssetSetIdentifier];
          v24 = autoAssetSetIdentifier;
          if (clientDomainName2 && autoAssetSetIdentifier)
          {
            clientDomainName3 = [v18 clientDomainName];
            v26 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName3 forAssetSetIdentifier:v24];

            if (v26)
            {
              if ([(MADAutoAssetControlManager *)self cancelActiveSetJob:@"_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce" activeSetJob:v21])
              {
                v27 = _MADLog(@"AutoControl-SuspendResume");
                if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
                {
                  *buf = 138543874;
                  *&buf[4] = clientDomainName2;
                  *&buf[12] = 2114;
                  *&buf[14] = v24;
                  *&buf[22] = 2114;
                  v80 = group;
                  _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} found active auto-asset-job, waiting for cancellation. | clientDomainName:%{public}@ setJobIdentifier:%{public}@ suspendingDispatchGroup:%{public}@", buf, 0x20u);
                }

                *buf = 0;
                *&buf[8] = buf;
                *&buf[16] = 0x2020000000;
                LOBYTE(v80) = 0;
                dispatch_group_enter(group);
                v68[0] = _NSConcreteStackBlock;
                v68[1] = 3221225472;
                v68[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke;
                v68[3] = &unk_4B3DF0;
                objc_copyWeak(&v73, &location);
                v72 = buf;
                v69 = clientDomainName2;
                v70 = v24;
                v71 = group;
                [(MADAutoAssetControlManager *)self _addCompletionCallbackForSetJobKey:v26 completionCallback:v68];

                objc_destroyWeak(&v73);
                _Block_object_dispose(buf, 8);
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl-SuspendResume");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                *&buf[4] = clientDomainName2;
                *&buf[12] = 2114;
                *&buf[14] = v24;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} unable to compute setJobKey | clientDomainName:%{public}@ setJobIdentifier:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v26 = _MADLog(@"AutoControl-SuspendResume");
            if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              *&buf[4] = clientDomainName2;
              *&buf[12] = 2114;
              *&buf[14] = v24;
              _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} missing required parameter | clientDomainName:%{public}@ setJobIdentifier:%{public}@", buf, 0x16u);
            }
          }
        }
      }

      v13 = [obj countByEnumeratingWithState:&v74 objects:v83 count:16];
    }

    while (v13);
  }

  if (_MAPreferencesIsInternalAllowed() && (buf[0] = 0, AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetSuspendResumeTimeoutCancelOverride", buf), buf[0]))
  {
    v30 = AppIntegerValue;
    if (!AppIntegerValue)
    {
      dispatch_group_enter(group);
    }
  }

  else
  {
    v30 = 30;
  }

  v66[0] = 0;
  v66[1] = v66;
  v66[2] = 0x2020000000;
  v67 = 0;
  v31 = voucher_copy();
  *buf = 0;
  *&buf[8] = buf;
  *&buf[16] = 0x3032000000;
  v80 = __Block_byref_object_copy__10;
  v81 = __Block_byref_object_dispose__10;
  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
  v82 = dispatch_source_create(&_dispatch_source_type_timer, 0, 0, extendedStateQueue2);

  v34 = *(*&buf[8] + 40);
  v35 = dispatch_time(0, (1000000000 * v30) | 1);
  dispatch_source_set_timer(v34, v35, 0xFFFFFFFFFFFFFFFFLL, 0);
  v36 = *(*&buf[8] + 40);
  handler[0] = _NSConcreteStackBlock;
  handler[1] = 3221225472;
  handler[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1206;
  handler[3] = &unk_4B3E18;
  objc_copyWeak(&v65, &location);
  v63 = v66;
  v64 = buf;
  v37 = v31;
  v61 = v37;
  v38 = blockCopy;
  v62 = v38;
  dispatch_source_set_event_handler(v36, handler);
  v39 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
  {
    *v59 = 0;
    _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job cancellation timer scheduled", v59, 2u);
  }

  dispatch_activate(*(*&buf[8] + 40));
  autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue3 = [autoControlManagerFSM3 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1207;
  block[3] = &unk_4B3E40;
  objc_copyWeak(&v58, &location);
  v56 = v66;
  v57 = buf;
  v52 = nonceCopy;
  v53 = obj;
  v54 = evictCopy;
  v55 = v38;
  v42 = v38;
  v43 = evictCopy;
  v44 = obj;
  v45 = nonceCopy;
  dispatch_group_notify(group, extendedStateQueue3, block);

  objc_destroyWeak(&v58);
  objc_destroyWeak(&v65);
  _Block_object_dispose(buf, 8);

  _Block_object_dispose(v66, 8);
  objc_destroyWeak(&location);
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 64));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 56) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
      {
        v8 = *(a1 + 32);
        v9 = *(a1 + 40);
        v10 = *(a1 + 48);
        v12 = 138543874;
        v13 = v8;
        v14 = 2114;
        v15 = v9;
        v16 = 2114;
        v17 = v10;
        _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} found active auto-asset-job, finished cancellation. | clientDomainName:%{public}@ setJobIdentifier:%{public}@ suspendingDispatchGroup:%{public}@", &v12, 0x20u);
      }

      dispatch_group_leave(*(a1 + 48));
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      LOWORD(v12) = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} _addCompletionCallbackForSetJobKey:completionCallback self not found", &v12, 2u);
    }
  }
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1206(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 64));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 48) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = *(*(a1 + 56) + 8);
      v8 = *(v7 + 40);
      *(v7 + 40) = 0;

      v9 = *(a1 + 32);
      v10 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        *v12 = 0;
        _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job cancellation timer fired", v12, 2u);
      }

      (*(*(a1 + 40) + 16))();
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} dispatch_source_set_event_handler self not found", buf, 2u);
    }
  }
}

void __173__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1207(uint64_t a1)
{
  WeakRetained = objc_loadWeakRetained((a1 + 80));
  v3 = WeakRetained;
  if (WeakRetained)
  {
    v4 = [WeakRetained autoControlManagerFSM];
    v5 = [v4 extendedStateQueue];
    dispatch_assert_queue_V2(v5);

    v6 = *(*(a1 + 64) + 8);
    if ((*(v6 + 24) & 1) == 0)
    {
      *(v6 + 24) = 1;
      v7 = *(*(a1 + 72) + 8);
      v8 = *(v7 + 40);
      *(v7 + 40) = 0;

      v9 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
      {
        *v11 = 0;
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job canellations finished", v11, 2u);
      }

      [v3 _handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:*(a1 + 32) sortedKeys:*(a1 + 40) setConfigurationsToEvict:*(a1 + 48) completionBlock:*(a1 + 56)];
    }
  }

  else
  {
    v10 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} dispatch_group_notify self not found", buf, 2u);
    }
  }
}

- (void)_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce:(id)nonce sortedKeys:(id)keys setConfigurationsToEvict:(id)evict completionBlock:(id)block
{
  nonceCopy = nonce;
  keysCopy = keys;
  evictCopy = evict;
  blockCopy = block;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v71 = objc_opt_new();
  v107 = 0u;
  v108 = 0u;
  v109 = 0u;
  v110 = 0u;
  obj = evictCopy;
  group = [obj countByEnumeratingWithState:&v107 objects:v117 count:16];
  if (!group)
  {

LABEL_44:
    groupa = dispatch_group_create();
    v103 = 0u;
    v104 = 0u;
    v105 = 0u;
    v106 = 0u;
    v74 = v71;
    v73 = [v74 countByEnumeratingWithState:&v103 objects:v116 count:16];
    if (!v73)
    {
LABEL_72:

      v55 = 300000000000;
      if (_MAPreferencesIsInternalAllowed())
      {
        buf[0] = 0;
        AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetSuspendResumeTimeoutEvictOverride", buf);
        if (buf[0])
        {
          v55 = 1000000000 * AppIntegerValue;
        }
      }

      v93[0] = 0;
      v93[1] = v93;
      v93[2] = 0x2020000000;
      v94 = 0;
      v57 = voucher_copy();
      *buf = 0;
      *&buf[8] = buf;
      *&buf[16] = 0x3032000000;
      v112 = __Block_byref_object_copy__10;
      v113 = __Block_byref_object_dispose__10;
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
      v114 = dispatch_source_create(&_dispatch_source_type_timer, 0, 0, extendedStateQueue2);

      v60 = *(*&buf[8] + 40);
      v61 = dispatch_time(0, v55);
      dispatch_source_set_timer(v60, v61, 0xFFFFFFFFFFFFFFFFLL, 0);
      v62 = *(*&buf[8] + 40);
      handler[0] = _NSConcreteStackBlock;
      handler[1] = 3221225472;
      handler[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1215;
      handler[3] = &unk_4B3E90;
      handler[4] = selfCopy;
      v91 = v93;
      v92 = buf;
      v63 = v57;
      v89 = v63;
      v64 = blockCopy;
      v90 = v64;
      dispatch_source_set_event_handler(v62, handler);
      v65 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
      {
        *v87 = 0;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseSuspendAutoJobsWithNonce} auto-job eviction timer scheduled", v87, 2u);
      }

      dispatch_activate(*(*&buf[8] + 40));
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      extendedStateQueue3 = [autoControlManagerFSM3 extendedStateQueue];
      block[0] = _NSConcreteStackBlock;
      block[1] = 3221225472;
      block[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1216;
      block[3] = &unk_4B3EB8;
      block[4] = selfCopy;
      v85 = v93;
      v86 = buf;
      v82 = nonceCopy;
      v83 = obj;
      v84 = v64;
      dispatch_group_notify(groupa, extendedStateQueue3, block);

      _Block_object_dispose(buf, 8);
      _Block_object_dispose(v93, 8);

      goto LABEL_78;
    }

    v72 = *v104;
LABEL_46:
    v39 = 0;
    while (1)
    {
      if (*v104 != v72)
      {
        v40 = v39;
        objc_enumerationMutation(v74);
        v39 = v40;
      }

      v75 = v39;
      v41 = *(*(&v103 + 1) + 8 * v39);
      v42 = [v74 objectForKeyedSubscript:v41];
      v101 = 0u;
      v102 = 0u;
      v99 = 0u;
      v100 = 0u;
      v43 = v42;
      v44 = [v43 countByEnumeratingWithState:&v99 objects:v115 count:16];
      if (v44)
      {
        break;
      }

LABEL_70:

      v39 = v75 + 1;
      if ((v75 + 1) == v73)
      {
        v73 = [v74 countByEnumeratingWithState:&v103 objects:v116 count:16];
        if (!v73)
        {
          goto LABEL_72;
        }

        goto LABEL_46;
      }
    }

    v45 = *v100;
LABEL_51:
    v46 = 0;
    while (1)
    {
      if (*v100 != v45)
      {
        objc_enumerationMutation(v43);
      }

      v47 = *(*(&v99 + 1) + 8 * v46);
      v48 = [v43 objectForKeyedSubscript:v47];
      v49 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543874;
        *&buf[4] = v41;
        *&buf[12] = 2114;
        *&buf[14] = v47;
        *&buf[22] = 2114;
        v112 = v48;
        _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} found latestAtomicInstanceToVend, scheduling eviction. | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ latestAtomicInstanceToVend:%{public}@", buf, 0x20u);
      }

      if ([(MADAutoAssetControlManager *)selfCopy isSetIdentifierCurrentlyLocked:@"notifyEvictedCallbacksForSetDescriptor" forClientDomainName:v41 forAssetSetIdentifier:v47])
      {
        *buf = 0;
        *&buf[8] = buf;
        *&buf[16] = 0x2020000000;
        LOBYTE(v112) = 0;
        dispatch_group_enter(groupa);
        v95[0] = _NSConcreteStackBlock;
        v95[1] = 3221225472;
        v95[2] = __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke;
        v95[3] = &unk_4B3E68;
        v98 = buf;
        v95[4] = v41;
        v95[5] = v47;
        v50 = v48;
        v96 = v50;
        v97 = groupa;
        [(MADAutoAssetControlManager *)selfCopy _addEvictedCallbackForAtomicInstanceUUID:v50 completionCallback:v95];

        _Block_object_dispose(buf, 8);
      }

      else
      {
        v51 = _MADLog(@"AutoControl-SuspendResume");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          *&buf[4] = v47;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} already unlocked! | assetSetIdentifier:%{public}@", buf, 0xCu);
        }

        v52 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce" forAtomicInstanceUUID:v48 requireExists:0];
        if (!v52)
        {
          v53 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            *&buf[4] = v48;
            _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} unable to locate set descriptor | latestAtomicInstanceToVend:%{public}@", buf, 0xCu);
          }

          goto LABEL_67;
        }

        if (![(MADAutoAssetControlManager *)selfCopy _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"notifyEvictedCallbacksForSetDescriptor" setDescriptor:v52 allowRemovalWithoutNewerDescriptor:1])
        {
          v53 = _MADLog(@"AutoControl-SuspendResume");
          if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
          {
            summary = [v52 summary];
            *buf = 138543362;
            *&buf[4] = summary;
            _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} unable to remove downloaded set descriptor | setDescriptor:%{public}@", buf, 0xCu);
          }

LABEL_67:

          goto LABEL_68;
        }
      }

LABEL_68:

      if (v44 == ++v46)
      {
        v44 = [v43 countByEnumeratingWithState:&v99 objects:v115 count:16];
        if (!v44)
        {
          goto LABEL_70;
        }

        goto LABEL_51;
      }
    }
  }

  v13 = 1;
  v77 = *v108;
LABEL_3:
  v14 = 0;
  while (1)
  {
    if (*v108 != v77)
    {
      objc_enumerationMutation(obj);
    }

    v15 = *(*(&v107 + 1) + 8 * v14);
    clientDomainName = [v15 clientDomainName];
    assetSetIdentifier = [v15 assetSetIdentifier];
    v18 = assetSetIdentifier;
    if (clientDomainName && assetSetIdentifier != 0)
    {
      break;
    }

    v20 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543618;
      *&buf[4] = clientDomainName;
      *&buf[12] = 2114;
      *&buf[14] = v18;
      v21 = v20;
      v22 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} setConfiguration missing clientDomainName or assetSetIdentifier| clientDomainName:%{public}@ assetSetIdentifier:%{public}@";
      v23 = 22;
LABEL_20:
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, v22, buf, v23);
    }

LABEL_25:
    v13 = 0;
LABEL_26:

    if (group == ++v14)
    {
      v35 = [obj countByEnumeratingWithState:&v107 objects:v117 count:16];
      group = v35;
      if (!v35)
      {

        if ((v13 & 1) == 0)
        {
          goto LABEL_40;
        }

        goto LABEL_44;
      }

      goto LABEL_3;
    }
  }

  firstEntryAssetType = [v15 firstEntryAssetType];
  v20 = firstEntryAssetType;
  if (!firstEntryAssetType)
  {
    v20 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      *&buf[4] = v18;
      v21 = v20;
      v22 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} missing asset type | assetSetIdentifier:%{public}@";
      v23 = 12;
      goto LABEL_20;
    }

    goto LABEL_25;
  }

  latestAtomicInstanceToVend = [v15 latestAtomicInstanceToVend];
  if (!latestAtomicInstanceToVend)
  {
    v28 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      *&buf[4] = v18;
      v29 = v28;
      v30 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} missing latestAtomicInstanceToVend | assetSetIdentifier:%{public}@";
      v31 = 12;
LABEL_23:
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, v30, buf, v31);
    }

LABEL_24:

    goto LABEL_25;
  }

  previouslyVendedLockedAtomicInstances = [v15 previouslyVendedLockedAtomicInstances];
  v27 = [previouslyVendedLockedAtomicInstances count];

  if (v27)
  {
    v28 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543618;
      *&buf[4] = v18;
      *&buf[12] = 2048;
      *&buf[14] = v27;
      v29 = v28;
      v30 = "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} has non-zero previously vended locked atomic instances | assetSetIdentifier:%{public}@ previouslyVendedLockedAtomicInstancesCount:%llu";
      v31 = 22;
      goto LABEL_23;
    }

    goto LABEL_24;
  }

  v32 = [v71 objectForKeyedSubscript:clientDomainName];
  if (!v32)
  {
    v32 = objc_opt_new();
    [v71 setObject:v32 forKeyedSubscript:clientDomainName];
  }

  [v32 setObject:latestAtomicInstanceToVend forKeyedSubscript:v18];
  v33 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    *&buf[4] = v18;
    _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} evicting  | assetSetIdentifier:%{public}@", buf, 0xCu);
  }

  v34 = [[MADAutoSetLookupResult alloc] initForAssetType:v20 withCatalogCachedAssetSetID:0 withCatalogDownloadedFromLive:0 withCatalogLastTimeChecked:0 withCatalogPostedDate:0 withRequestedAutoAssetEntries:0 withDiscoveredAtomicEntries:0 withCatalogFromPallasResponse:0];
  if ([(MADAutoAssetControlManager *)selfCopy newAtomicInstanceAndSetDescriptor:@"_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce" fromSetLookupResult:v34 vendingLatestForConfiguration:v15 inStartup:0 allowEmpty:1 notifyClients:1 forCreationReason:@"FROM_SU_SUSPEND" recordingHistoryOperation:229])
  {

    goto LABEL_26;
  }

  v36 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
  {
    assetSetIdentifier2 = [v15 assetSetIdentifier];
    *buf = 138543362;
    *&buf[4] = assetSetIdentifier2;
    _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} failed to mark latest to vend | assetSetIdentifier:%{public}@", buf, 0xCu);
  }

LABEL_40:
  v38 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} failed setup empty atomic instances, failing suspend.", buf, 2u);
  }

  (*(blockCopy + 2))(blockCopy, 102);
LABEL_78:
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke(uint64_t a1)
{
  v1 = *(*(a1 + 64) + 8);
  if ((*(v1 + 24) & 1) == 0)
  {
    *(v1 + 24) = 1;
    v3 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
    {
      v4 = *(a1 + 32);
      v5 = *(a1 + 40);
      v6 = *(a1 + 48);
      v7 = 138543874;
      v8 = v4;
      v9 = 2114;
      v10 = v5;
      v11 = 2114;
      v12 = v6;
      _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} found latestAtomicInstanceToVend, evicted! | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ latestAtomicInstanceToVend:%{public}@", &v7, 0x20u);
    }

    dispatch_group_leave(*(a1 + 56));
  }
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1215(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v4 = *(*(a1 + 56) + 8);
  if ((*(v4 + 24) & 1) == 0)
  {
    *(v4 + 24) = 1;
    v5 = *(*(a1 + 64) + 8);
    v6 = *(v5 + 40);
    *(v5 + 40) = 0;

    v7 = *(a1 + 40);
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      *v9 = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} eviction cancellation timer fired", v9, 2u);
    }

    (*(*(a1 + 48) + 16))();
  }
}

void __178__MADAutoAssetControlManager_SoftwareUpdateSuspendResume___handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce_sortedKeys_setConfigurationsToEvict_completionBlock___block_invoke_1216(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  dispatch_assert_queue_V2(v3);

  v4 = *(*(a1 + 64) + 8);
  if ((*(v4 + 24) & 1) == 0)
  {
    *(v4 + 24) = 1;
    v5 = *(*(a1 + 72) + 8);
    v6 = *(v5 + 40);
    *(v5 + 40) = 0;

    v7 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v8 = 0;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "{_handleSuspendForSoftwareUpdate_phaseEvictAtomicInstancesWithNonce} evictions finished", v8, 2u);
    }

    [*(a1 + 32) _handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:*(a1 + 40) setConfigurationsToEvict:*(a1 + 48) completionBlock:*(a1 + 56)];
  }
}

- (void)_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce:(id)nonce setConfigurationsToEvict:(id)evict completionBlock:(id)block
{
  nonceCopy = nonce;
  blockCopy = block;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v20 = 0;
  v11 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:&v20];
  v12 = v20;
  v13 = v12;
  if (!v12)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} current nonce now nil, do not attempt to update.", v19, 2u);
    }

    v16 = 200;
    goto LABEL_20;
  }

  nonce = [v12 nonce];
  v15 = [SUCore objectIsEqual:nonceCopy to:nonce];

  if ((v15 & 1) == 0)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} nonce has changed, do not attempt to update.", v19, 2u);
    }

    v16 = 201;
    goto LABEL_20;
  }

  if (v11 != 201)
  {
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} unexpected state, must be suspending.", v19, 2u);
    }

    v16 = 202;
    goto LABEL_20;
  }

  [v13 setStatus:200];
  if (([v13 write] & 1) == 0)
  {
    v18 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} failed to write suspend file, resuming...", v19, 2u);
    }

    [(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest];
    v17 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      *v19 = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{_handleSuspendForSoftwareUpdate_phaseSuspendedWithNonce} failed to write suspend file, resumed", v19, 2u);
    }

    v16 = 203;
LABEL_20:

    goto LABEL_21;
  }

  v16 = 1;
LABEL_21:
  blockCopy[2](blockCopy, v16);
}

- (void)handleResumeFromSoftwareUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest])
  {
    clientRequestMessage = [requestCopy clientRequestMessage];
    v8 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

    v9 = objc_alloc_init(MAAutoAssetSuspendResumeForSoftwareUpdateResponseInfo);
    v10 = objc_alloc_init(NSMutableDictionary);
    [v10 setSafeObject:v9 forKey:@"suspendResumeForSU"];
    v11 = [SUCoreConnectMessage alloc];
    clientRequestMessage2 = [requestCopy clientRequestMessage];
    clientID = [clientRequestMessage2 clientID];
    v14 = [v11 initWithType:2 messageName:v8 clientID:clientID version:0 message:v10];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v14 withResponseError:0 fromLocation:@"handleEstimateEvictableBytesForSoftwareUpdateRequest"];
    requestCopy = v8;
  }

  else
  {
    v15 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      *v16 = 0;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "SuspendResumeStatus - Issue encountered transitioning to running!", v16, 2u);
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6108 fromAction:@"handleResumeFromSoftwareUpdateRequest" withDescription:@"handleResumeFromSoftwareUpdateRequest - already running"];
  }
}

- (BOOL)_handleResumeFromSoftwareUpdateRequest
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  completionCallbacksBySetJobKey = [(MADAutoAssetControlManager *)self completionCallbacksBySetJobKey];

  if (completionCallbacksBySetJobKey)
  {
    v6 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} clearing outstanding completionCallbacksBySetJobKey.", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self setCompletionCallbacksBySetJobKey:0];
  }

  evictedCallbacksByAtomicInstanceUUID = [(MADAutoAssetControlManager *)self evictedCallbacksByAtomicInstanceUUID];

  if (evictedCallbacksByAtomicInstanceUUID)
  {
    v8 = _MADLog(@"AutoControl-SuspendResume");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} clearing outstanding evictedCallbacksByAtomicInstanceUUID.", buf, 2u);
    }

    [(MADAutoAssetControlManager *)self setEvictedCallbacksByAtomicInstanceUUID:0];
  }

  v30 = 0;
  v9 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:&v30];
  v10 = v30;
  v11 = v10;
  if (v9 != 100)
  {
    if (v10)
    {
      v28 = 0u;
      v29 = 0u;
      v26 = 0u;
      v27 = 0u;
      setConfigurationsToEvict = [v10 setConfigurationsToEvict];
      v14 = [setConfigurationsToEvict countByEnumeratingWithState:&v26 objects:v31 count:16];
      if (v14)
      {
        v15 = v14;
        v16 = *v27;
        do
        {
          for (i = 0; i != v15; i = i + 1)
          {
            if (*v27 != v16)
            {
              objc_enumerationMutation(setConfigurationsToEvict);
            }

            v18 = *(*(&v26 + 1) + 8 * i);
            clientDomainName = [v18 clientDomainName];
            assetSetIdentifier = [v18 assetSetIdentifier];
            [MADAutoAssetScheduler triggerWithRetrySetDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier usingSetUpdatePolicy:0];
          }

          v15 = [setConfigurationsToEvict countByEnumeratingWithState:&v26 objects:v31 count:16];
        }

        while (v15);
      }

      if (+[MADAutoAssetSoftwareUpdateSuspendResumeState clear])
      {
        goto LABEL_22;
      }

      v24 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "{_handleResumeFromSoftwareUpdateRequest} failed to clear resuming file.", buf, 2u);
      }
    }

    else
    {
      v22 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        v23 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        *buf = 138412290;
        v33 = v23;
        _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{_handleResumeFromSoftwareUpdateRequest} expected a state file but none was returned | currentStatus:%@", buf, 0xCu);
      }

      +[MADAutoAssetSoftwareUpdateSuspendResumeState clear];
    }

    v21 = 0;
    goto LABEL_30;
  }

  v12 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{_handleResumeFromSoftwareUpdateRequest} already running, nothing to do.", buf, 2u);
  }

LABEL_22:
  v21 = 1;
LABEL_30:

  return v21;
}

- (void)handleSuspendResumeForSoftwareUpdateDaemonStartup
{
  v3 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
  if (v3 != 100)
  {
    if (v3 != 101)
    {
      if (v3 == 200)
      {
        return;
      }

      v4 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
      {
        v5 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        v8 = 138412290;
        v9 = v5;
        _os_log_impl(&dword_0, v4, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} daemon found anomalous status on startup, resuming | status:%@", &v8, 0xCu);
      }
    }

    if ([(MADAutoAssetControlManager *)self _handleResumeFromSoftwareUpdateRequest])
    {
      [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
      v6 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        v7 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
        v8 = 138412290;
        v9 = v7;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} resumed! | status:%@", &v8, 0xCu);
      }
    }

    else
    {
      v6 = _MADLog(@"AutoControl-SuspendResume");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_ERROR))
      {
        LOWORD(v8) = 0;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_ERROR, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} failed to resume", &v8, 2u);
      }
    }
  }
}

- (void)handleStatusForSoftwareUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [MADAutoAssetSoftwareUpdateSuspendResumeState currentStatusWithStateHandle:0];
  v8 = _MADLog(@"AutoControl-SuspendResume");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    v9 = MAAutoAssetSuspendResumeForSoftwareUpdateStatusString();
    v18 = 138412290;
    v19 = v9;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{handleSuspendResumeForSoftwareUpdateDaemonStartup} status checked...! | status:%@", &v18, 0xCu);
  }

  clientRequestMessage = [requestCopy clientRequestMessage];
  v11 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

  v12 = [[MAAutoAssetSuspendResumeForSoftwareUpdateStatusResponseInfo alloc] initWithStatus:v7];
  v13 = objc_alloc_init(NSMutableDictionary);
  [v13 setSafeObject:v12 forKey:@"suspendResumeForSU"];
  v14 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v17 = [v14 initWithType:2 messageName:v11 clientID:clientID version:0 message:v13];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v17 withResponseError:0 fromLocation:@"handleStatusForSoftwareUpdateRequest"];
}

+ (id)_getAutoControlManagerStateTable
{
  v776[0] = @"Startup";
  v774[0] = @"StartupBefore1st";
  v2 = kSUCoreNextStateKey;
  v3 = kSUCoreActionKey;
  v772[0] = kSUCoreNextStateKey;
  v772[1] = kSUCoreActionKey;
  v773[0] = @"Before1stBeforeResumeSync";
  v773[1] = @"StartUnlockPollingTimer";
  v263 = [NSDictionary dictionaryWithObjects:v773 forKeys:v772 count:2];
  v775[0] = v263;
  v774[1] = @"StartupUnlocked";
  v770[0] = v2;
  v770[1] = v3;
  v771[0] = @"ResumingLockerSync";
  v771[1] = @"LoadPersistedResumeLocker";
  v262 = [NSDictionary dictionaryWithObjects:v771 forKeys:v770 count:2];
  v775[1] = v262;
  v261 = [NSDictionary dictionaryWithObjects:v775 forKeys:v774 count:2];
  v777[0] = v261;
  v776[1] = @"Before1stBeforeResumeSync";
  v768[0] = @"PollForDeviceUnlocked";
  v766 = v3;
  v767 = @"PollDecideBefore1stUnlock";
  v260 = [NSDictionary dictionaryWithObjects:&v767 forKeys:&v766 count:1];
  v769[0] = v260;
  v768[1] = @"DownloadManagerSyncSkipped";
  v764 = v3;
  v765 = @"SyncSkippedDecideBefore1st";
  v259 = [NSDictionary dictionaryWithObjects:&v765 forKeys:&v764 count:1];
  v769[1] = v259;
  v768[2] = @"DownloadManagerSynced";
  v762 = v3;
  v763 = @"SyncDecideBefore1st";
  v258 = [NSDictionary dictionaryWithObjects:&v763 forKeys:&v762 count:1];
  v769[2] = v258;
  v768[3] = @"DownloadCatalogFinished";
  v760 = v3;
  v761 = @"Before1stCatalogFinished";
  v257 = [NSDictionary dictionaryWithObjects:&v761 forKeys:&v760 count:1];
  v769[3] = v257;
  v768[4] = @"DownloadConfigFinished";
  v758 = v3;
  v759 = @"Before1stConfigFinished";
  v256 = [NSDictionary dictionaryWithObjects:&v759 forKeys:&v758 count:1];
  v769[4] = v256;
  v768[5] = @"DownloadAssetFinished";
  v756 = v3;
  v757 = @"Before1stAssetFinished";
  v255 = [NSDictionary dictionaryWithObjects:&v757 forKeys:&v756 count:1];
  v769[5] = v255;
  v768[6] = @"TimeoutAwaitingSynced";
  v754 = v3;
  v4 = kSUCoreFSMActionNoOp;
  v755 = kSUCoreFSMActionNoOp;
  v254 = [NSDictionary dictionaryWithObjects:&v755 forKeys:&v754 count:1];
  v769[6] = v254;
  v768[7] = @"TimeoutClientQueued";
  v752 = v3;
  v753 = @"FailClientTimedOut";
  v253 = [NSDictionary dictionaryWithObjects:&v753 forKeys:&v752 count:1];
  v769[7] = v253;
  v768[8] = @"ClientRequest";
  v750 = v3;
  v751 = @"QueueClientRequestBefore1st";
  v252 = [NSDictionary dictionaryWithObjects:&v751 forKeys:&v750 count:1];
  v769[8] = v252;
  v768[9] = @"ClientClosed";
  v748 = v3;
  v749 = @"RemoveQueuedClient";
  v251 = [NSDictionary dictionaryWithObjects:&v749 forKeys:&v748 count:1];
  v769[9] = v251;
  v768[10] = @"PushNotificationReceived";
  v746 = v3;
  v747 = @"IgnorePushNotifications";
  v250 = [NSDictionary dictionaryWithObjects:&v747 forKeys:&v746 count:1];
  v769[10] = v250;
  v768[11] = @"SecureOperationsFinished";
  v744 = v3;
  v745 = @"ClearInProgressSecure";
  v249 = [NSDictionary dictionaryWithObjects:&v745 forKeys:&v744 count:1];
  v769[11] = v249;
  v768[12] = @"SyncedStillBefore1st";
  v742 = v2;
  v743 = @"Before1stBeforeResume";
  v248 = [NSDictionary dictionaryWithObjects:&v743 forKeys:&v742 count:1];
  v769[12] = v248;
  v768[13] = @"SyncedNowUnlocked";
  v740[0] = v2;
  v740[1] = v3;
  v741[0] = @"ResumingLocker";
  v741[1] = @"LoadPersistedResumeLocker";
  v247 = [NSDictionary dictionaryWithObjects:v741 forKeys:v740 count:2];
  v769[13] = v247;
  v768[14] = @"PolledNowUnlocked";
  v738[0] = v2;
  v738[1] = v3;
  v739[0] = @"ResumingLockerSync";
  v739[1] = @"LoadPersistedResumeLocker";
  v246 = [NSDictionary dictionaryWithObjects:v739 forKeys:v738 count:2];
  v769[14] = v246;
  v245 = [NSDictionary dictionaryWithObjects:v769 forKeys:v768 count:15];
  v777[1] = v245;
  v776[2] = @"Before1stBeforeResume";
  v736[0] = @"PollForDeviceUnlocked";
  v734 = v3;
  v735 = @"PollDecideBefore1stUnlock";
  v244 = [NSDictionary dictionaryWithObjects:&v735 forKeys:&v734 count:1];
  v737[0] = v244;
  v736[1] = @"DownloadManagerSyncSkipped";
  v732 = v3;
  v733 = v4;
  v243 = [NSDictionary dictionaryWithObjects:&v733 forKeys:&v732 count:1];
  v737[1] = v243;
  v736[2] = @"DownloadManagerSynced";
  v730 = v3;
  v731 = @"SyncDecideBefore1st";
  v242 = [NSDictionary dictionaryWithObjects:&v731 forKeys:&v730 count:1];
  v737[2] = v242;
  v736[3] = @"DownloadCatalogFinished";
  v728 = v3;
  v729 = @"Before1stCatalogFinished";
  v241 = [NSDictionary dictionaryWithObjects:&v729 forKeys:&v728 count:1];
  v737[3] = v241;
  v736[4] = @"DownloadConfigFinished";
  v726 = v3;
  v727 = @"Before1stConfigFinished";
  v240 = [NSDictionary dictionaryWithObjects:&v727 forKeys:&v726 count:1];
  v737[4] = v240;
  v736[5] = @"DownloadAssetFinished";
  v724 = v3;
  v725 = @"Before1stAssetFinished";
  v239 = [NSDictionary dictionaryWithObjects:&v725 forKeys:&v724 count:1];
  v737[5] = v239;
  v736[6] = @"TimeoutAwaitingSynced";
  v722 = v3;
  v723 = v4;
  v238 = [NSDictionary dictionaryWithObjects:&v723 forKeys:&v722 count:1];
  v737[6] = v238;
  v736[7] = @"TimeoutClientQueued";
  v720 = v3;
  v721 = @"FailClientTimedOut";
  v237 = [NSDictionary dictionaryWithObjects:&v721 forKeys:&v720 count:1];
  v737[7] = v237;
  v736[8] = @"ClientRequest";
  v718 = v3;
  v719 = @"QueueClientRequestBefore1st";
  v236 = [NSDictionary dictionaryWithObjects:&v719 forKeys:&v718 count:1];
  v737[8] = v236;
  v736[9] = @"ClientClosed";
  v716 = v3;
  v717 = @"RemoveQueuedClient";
  v235 = [NSDictionary dictionaryWithObjects:&v717 forKeys:&v716 count:1];
  v737[9] = v235;
  v736[10] = @"PushNotificationReceived";
  v714 = v3;
  v715 = @"IgnorePushNotifications";
  v234 = [NSDictionary dictionaryWithObjects:&v715 forKeys:&v714 count:1];
  v737[10] = v234;
  v736[11] = @"SecureOperationsFinished";
  v712 = v3;
  v713 = @"ClearInProgressSecure";
  v233 = [NSDictionary dictionaryWithObjects:&v713 forKeys:&v712 count:1];
  v737[11] = v233;
  v736[12] = @"SyncedStillBefore1st";
  v710 = v3;
  v711 = v4;
  v232 = [NSDictionary dictionaryWithObjects:&v711 forKeys:&v710 count:1];
  v737[12] = v232;
  v736[13] = @"SyncedNowUnlocked";
  v708[0] = v2;
  v708[1] = v3;
  v709[0] = @"ResumingLocker";
  v709[1] = @"LoadPersistedResumeLocker";
  v231 = [NSDictionary dictionaryWithObjects:v709 forKeys:v708 count:2];
  v737[13] = v231;
  v736[14] = @"PolledNowUnlocked";
  v706[0] = v2;
  v706[1] = v3;
  v707[0] = @"ResumingLocker";
  v707[1] = @"LoadPersistedResumeLocker";
  v230 = [NSDictionary dictionaryWithObjects:v707 forKeys:v706 count:2];
  v737[14] = v230;
  v229 = [NSDictionary dictionaryWithObjects:v737 forKeys:v736 count:15];
  v777[2] = v229;
  v776[3] = @"ResumingLockerSync";
  v704[0] = @"PollForDeviceUnlocked";
  v702 = v3;
  v703 = v4;
  v228 = [NSDictionary dictionaryWithObjects:&v703 forKeys:&v702 count:1];
  v705[0] = v228;
  v704[1] = @"LockerResumed";
  v700 = v2;
  v701 = @"AwaitingSync";
  v227 = [NSDictionary dictionaryWithObjects:&v701 forKeys:&v700 count:1];
  v705[1] = v227;
  v704[2] = @"DownloadManagerSyncSkipped";
  v698 = v2;
  v699 = @"ResumingLocker";
  v226 = [NSDictionary dictionaryWithObjects:&v699 forKeys:&v698 count:1];
  v705[2] = v226;
  v704[3] = @"DownloadManagerSynced";
  v696[0] = v2;
  v696[1] = v3;
  v697[0] = @"ResumingLocker";
  v697[1] = @"Synced";
  v225 = [NSDictionary dictionaryWithObjects:v697 forKeys:v696 count:2];
  v705[3] = v225;
  v704[4] = @"DownloadCatalogFinished";
  v694 = v3;
  v695 = @"QueueDownloadManager";
  v224 = [NSDictionary dictionaryWithObjects:&v695 forKeys:&v694 count:1];
  v705[4] = v224;
  v704[5] = @"DownloadConfigFinished";
  v692 = v3;
  v693 = @"QueueDownloadManager";
  v223 = [NSDictionary dictionaryWithObjects:&v693 forKeys:&v692 count:1];
  v705[5] = v223;
  v704[6] = @"DownloadAssetFinished";
  v690 = v3;
  v691 = @"QueueDownloadManager";
  v222 = [NSDictionary dictionaryWithObjects:&v691 forKeys:&v690 count:1];
  v705[6] = v222;
  v704[7] = @"TimeoutAwaitingSynced";
  v688[0] = v2;
  v688[1] = v3;
  v689[0] = @"ResumingLocker";
  v689[1] = @"SyncInFlightDownloads";
  v221 = [NSDictionary dictionaryWithObjects:v689 forKeys:v688 count:2];
  v705[7] = v221;
  v704[8] = @"TimeoutClientQueued";
  v686 = v3;
  v687 = @"FailClientTimedOut";
  v220 = [NSDictionary dictionaryWithObjects:&v687 forKeys:&v686 count:1];
  v705[8] = v220;
  v704[9] = @"ClientRequest";
  v684 = v3;
  v685 = @"QueueClientRequest";
  v219 = [NSDictionary dictionaryWithObjects:&v685 forKeys:&v684 count:1];
  v705[9] = v219;
  v704[10] = @"ClientClosed";
  v682 = v3;
  v683 = @"RemoveQueuedClient";
  v218 = [NSDictionary dictionaryWithObjects:&v683 forKeys:&v682 count:1];
  v705[10] = v218;
  v704[11] = @"PushNotificationReceived";
  v680 = v3;
  v681 = @"IgnorePushNotifications";
  v217 = [NSDictionary dictionaryWithObjects:&v681 forKeys:&v680 count:1];
  v705[11] = v217;
  v704[12] = @"SecureOperationsFinished";
  v678 = v3;
  v679 = @"ClearInProgressSecure";
  v216 = [NSDictionary dictionaryWithObjects:&v679 forKeys:&v678 count:1];
  v705[12] = v216;
  v215 = [NSDictionary dictionaryWithObjects:v705 forKeys:v704 count:13];
  v777[3] = v215;
  v776[4] = @"ResumingLocker";
  v676[0] = @"PollForDeviceUnlocked";
  v674 = v3;
  v675 = v4;
  v214 = [NSDictionary dictionaryWithObjects:&v675 forKeys:&v674 count:1];
  v677[0] = v214;
  v676[1] = @"LockerResumed";
  v672[0] = v2;
  v672[1] = v3;
  v673[0] = @"ResumingStager";
  v673[1] = @"ResumeStager";
  v213 = [NSDictionary dictionaryWithObjects:v673 forKeys:v672 count:2];
  v677[1] = v213;
  v676[2] = @"DownloadManagerSyncSkipped";
  v670 = v3;
  v671 = v4;
  v212 = [NSDictionary dictionaryWithObjects:&v671 forKeys:&v670 count:1];
  v677[2] = v212;
  v676[3] = @"DownloadManagerSynced";
  v668 = v3;
  v669 = @"AdditionalSynced";
  v211 = [NSDictionary dictionaryWithObjects:&v669 forKeys:&v668 count:1];
  v677[3] = v211;
  v676[4] = @"DownloadCatalogFinished";
  v666 = v3;
  v667 = @"QueueDownloadManager";
  v210 = [NSDictionary dictionaryWithObjects:&v667 forKeys:&v666 count:1];
  v677[4] = v210;
  v676[5] = @"DownloadConfigFinished";
  v664 = v3;
  v665 = @"QueueDownloadManager";
  v209 = [NSDictionary dictionaryWithObjects:&v665 forKeys:&v664 count:1];
  v677[5] = v209;
  v676[6] = @"DownloadAssetFinished";
  v662 = v3;
  v663 = @"QueueDownloadManager";
  v208 = [NSDictionary dictionaryWithObjects:&v663 forKeys:&v662 count:1];
  v677[6] = v208;
  v676[7] = @"TimeoutAwaitingSynced";
  v660 = v3;
  v661 = v4;
  v207 = [NSDictionary dictionaryWithObjects:&v661 forKeys:&v660 count:1];
  v677[7] = v207;
  v676[8] = @"TimeoutClientQueued";
  v658 = v3;
  v659 = @"FailClientTimedOut";
  v206 = [NSDictionary dictionaryWithObjects:&v659 forKeys:&v658 count:1];
  v677[8] = v206;
  v676[9] = @"ClientRequest";
  v656 = v3;
  v657 = @"QueueClientRequest";
  v205 = [NSDictionary dictionaryWithObjects:&v657 forKeys:&v656 count:1];
  v677[9] = v205;
  v676[10] = @"ClientClosed";
  v654 = v3;
  v655 = @"RemoveQueuedClient";
  v204 = [NSDictionary dictionaryWithObjects:&v655 forKeys:&v654 count:1];
  v677[10] = v204;
  v676[11] = @"PushNotificationReceived";
  v652 = v3;
  v653 = @"IgnorePushNotifications";
  v203 = [NSDictionary dictionaryWithObjects:&v653 forKeys:&v652 count:1];
  v677[11] = v203;
  v676[12] = @"SecureOperationsFinished";
  v650 = v3;
  v651 = @"ClearInProgressSecure";
  v202 = [NSDictionary dictionaryWithObjects:&v651 forKeys:&v650 count:1];
  v677[12] = v202;
  v201 = [NSDictionary dictionaryWithObjects:v677 forKeys:v676 count:13];
  v777[4] = v201;
  v776[5] = @"AwaitingSync";
  v648[0] = @"PollForDeviceUnlocked";
  v646 = v3;
  v647 = v4;
  v200 = [NSDictionary dictionaryWithObjects:&v647 forKeys:&v646 count:1];
  v649[0] = v200;
  v648[1] = @"DownloadManagerSyncSkipped";
  v644[0] = v2;
  v644[1] = v3;
  v645[0] = @"ResumingStager";
  v645[1] = @"ResumeStager";
  v199 = [NSDictionary dictionaryWithObjects:v645 forKeys:v644 count:2];
  v649[1] = v199;
  v648[2] = @"DownloadManagerSynced";
  v642[0] = v2;
  v642[1] = v3;
  v643[0] = @"ResumingStager";
  v643[1] = @"SyncedResumeStager";
  v198 = [NSDictionary dictionaryWithObjects:v643 forKeys:v642 count:2];
  v649[2] = v198;
  v648[3] = @"DownloadCatalogFinished";
  v640 = v3;
  v641 = @"QueueDownloadManager";
  v197 = [NSDictionary dictionaryWithObjects:&v641 forKeys:&v640 count:1];
  v649[3] = v197;
  v648[4] = @"DownloadConfigFinished";
  v638 = v3;
  v639 = @"QueueDownloadManager";
  v196 = [NSDictionary dictionaryWithObjects:&v639 forKeys:&v638 count:1];
  v649[4] = v196;
  v648[5] = @"DownloadAssetFinished";
  v636 = v3;
  v637 = @"QueueDownloadManager";
  v195 = [NSDictionary dictionaryWithObjects:&v637 forKeys:&v636 count:1];
  v649[5] = v195;
  v648[6] = @"TimeoutAwaitingSynced";
  v634[0] = v2;
  v634[1] = v3;
  v635[0] = @"ResumingStager";
  v635[1] = @"ResumeStager";
  v194 = [NSDictionary dictionaryWithObjects:v635 forKeys:v634 count:2];
  v649[6] = v194;
  v648[7] = @"TimeoutClientQueued";
  v632 = v3;
  v633 = @"FailClientTimedOut";
  v193 = [NSDictionary dictionaryWithObjects:&v633 forKeys:&v632 count:1];
  v649[7] = v193;
  v648[8] = @"ClientRequest";
  v630 = v3;
  v631 = @"QueueClientRequest";
  v192 = [NSDictionary dictionaryWithObjects:&v631 forKeys:&v630 count:1];
  v649[8] = v192;
  v648[9] = @"ClientClosed";
  v628 = v3;
  v629 = @"RemoveQueuedClient";
  v191 = [NSDictionary dictionaryWithObjects:&v629 forKeys:&v628 count:1];
  v649[9] = v191;
  v648[10] = @"PushNotificationReceived";
  v626 = v3;
  v627 = @"IgnorePushNotifications";
  v190 = [NSDictionary dictionaryWithObjects:&v627 forKeys:&v626 count:1];
  v649[10] = v190;
  v648[11] = @"SecureOperationsFinished";
  v624 = v3;
  v625 = @"ClearInProgressSecure";
  v189 = [NSDictionary dictionaryWithObjects:&v625 forKeys:&v624 count:1];
  v649[11] = v189;
  v188 = [NSDictionary dictionaryWithObjects:v649 forKeys:v648 count:12];
  v777[5] = v188;
  v776[6] = @"ResumingStager";
  v622[0] = @"PollForDeviceUnlocked";
  v620 = v3;
  v621 = v4;
  v187 = [NSDictionary dictionaryWithObjects:&v621 forKeys:&v620 count:1];
  v623[0] = v187;
  v622[1] = @"StagerResumed";
  v618[0] = v2;
  v618[1] = v3;
  v619[0] = @"MigratingAssets";
  v619[1] = @"PromoteStagedMigrate";
  v186 = [NSDictionary dictionaryWithObjects:v619 forKeys:v618 count:2];
  v623[1] = v186;
  v622[2] = @"DownloadManagerSyncSkipped";
  v616 = v3;
  v617 = v4;
  v185 = [NSDictionary dictionaryWithObjects:&v617 forKeys:&v616 count:1];
  v623[2] = v185;
  v622[3] = @"DownloadManagerSynced";
  v614 = v3;
  v615 = @"AdditionalSynced";
  v184 = [NSDictionary dictionaryWithObjects:&v615 forKeys:&v614 count:1];
  v623[3] = v184;
  v622[4] = @"DownloadCatalogFinished";
  v612 = v3;
  v613 = @"QueueDownloadManager";
  v183 = [NSDictionary dictionaryWithObjects:&v613 forKeys:&v612 count:1];
  v623[4] = v183;
  v622[5] = @"DownloadConfigFinished";
  v610 = v3;
  v611 = @"QueueDownloadManager";
  v182 = [NSDictionary dictionaryWithObjects:&v611 forKeys:&v610 count:1];
  v623[5] = v182;
  v622[6] = @"DownloadAssetFinished";
  v608 = v3;
  v609 = @"QueueDownloadManager";
  v181 = [NSDictionary dictionaryWithObjects:&v609 forKeys:&v608 count:1];
  v623[6] = v181;
  v622[7] = @"TimeoutAwaitingSynced";
  v606 = v3;
  v607 = v4;
  v180 = [NSDictionary dictionaryWithObjects:&v607 forKeys:&v606 count:1];
  v623[7] = v180;
  v622[8] = @"TimeoutClientQueued";
  v604 = v3;
  v605 = @"FailClientTimedOut";
  v179 = [NSDictionary dictionaryWithObjects:&v605 forKeys:&v604 count:1];
  v623[8] = v179;
  v622[9] = @"ClientRequest";
  v602 = v3;
  v603 = @"QueueClientRequest";
  v178 = [NSDictionary dictionaryWithObjects:&v603 forKeys:&v602 count:1];
  v623[9] = v178;
  v622[10] = @"ClientClosed";
  v600 = v3;
  v601 = @"RemoveQueuedClient";
  v177 = [NSDictionary dictionaryWithObjects:&v601 forKeys:&v600 count:1];
  v623[10] = v177;
  v622[11] = @"PushNotificationReceived";
  v598 = v3;
  v599 = @"IgnorePushNotifications";
  v176 = [NSDictionary dictionaryWithObjects:&v599 forKeys:&v598 count:1];
  v623[11] = v176;
  v622[12] = @"SecureOperationsFinished";
  v596 = v3;
  v597 = @"ClearInProgressSecure";
  v175 = [NSDictionary dictionaryWithObjects:&v597 forKeys:&v596 count:1];
  v623[12] = v175;
  v174 = [NSDictionary dictionaryWithObjects:v623 forKeys:v622 count:13];
  v777[6] = v174;
  v776[7] = @"MigratingAssets";
  v594[0] = @"PollForDeviceUnlocked";
  v592 = v3;
  v593 = v4;
  v173 = [NSDictionary dictionaryWithObjects:&v593 forKeys:&v592 count:1];
  v595[0] = v173;
  v594[1] = @"MigratedAssets";
  v590 = v3;
  v591 = @"DecideNeedPersonalize";
  v172 = [NSDictionary dictionaryWithObjects:&v591 forKeys:&v590 count:1];
  v595[1] = v172;
  v594[2] = @"DownloadManagerSyncSkipped";
  v588 = v3;
  v589 = v4;
  v171 = [NSDictionary dictionaryWithObjects:&v589 forKeys:&v588 count:1];
  v595[2] = v171;
  v594[3] = @"DownloadManagerSynced";
  v586 = v3;
  v587 = @"AdditionalSynced";
  v170 = [NSDictionary dictionaryWithObjects:&v587 forKeys:&v586 count:1];
  v595[3] = v170;
  v594[4] = @"DownloadCatalogFinished";
  v584 = v3;
  v585 = @"QueueDownloadManager";
  v169 = [NSDictionary dictionaryWithObjects:&v585 forKeys:&v584 count:1];
  v595[4] = v169;
  v594[5] = @"DownloadConfigFinished";
  v582 = v3;
  v583 = @"QueueDownloadManager";
  v168 = [NSDictionary dictionaryWithObjects:&v583 forKeys:&v582 count:1];
  v595[5] = v168;
  v594[6] = @"DownloadAssetFinished";
  v580 = v3;
  v581 = @"QueueDownloadManager";
  v167 = [NSDictionary dictionaryWithObjects:&v581 forKeys:&v580 count:1];
  v595[6] = v167;
  v594[7] = @"TimeoutAwaitingSynced";
  v578 = v3;
  v579 = v4;
  v166 = [NSDictionary dictionaryWithObjects:&v579 forKeys:&v578 count:1];
  v595[7] = v166;
  v594[8] = @"TimeoutClientQueued";
  v576 = v3;
  v577 = @"FailClientTimedOut";
  v165 = [NSDictionary dictionaryWithObjects:&v577 forKeys:&v576 count:1];
  v595[8] = v165;
  v594[9] = @"ClientRequest";
  v574 = v3;
  v575 = @"QueueClientRequest";
  v164 = [NSDictionary dictionaryWithObjects:&v575 forKeys:&v574 count:1];
  v595[9] = v164;
  v594[10] = @"ClientClosed";
  v572 = v3;
  v573 = @"RemoveQueuedClient";
  v163 = [NSDictionary dictionaryWithObjects:&v573 forKeys:&v572 count:1];
  v595[10] = v163;
  v594[11] = @"JobObtainLookupGrant";
  v570 = v3;
  v571 = @"ObtainLookupGrant";
  v162 = [NSDictionary dictionaryWithObjects:&v571 forKeys:&v570 count:1];
  v595[11] = v162;
  v594[12] = @"JobReleaseLookupGrant";
  v568 = v3;
  v569 = @"ReleaseLookupGrant";
  v161 = [NSDictionary dictionaryWithObjects:&v569 forKeys:&v568 count:1];
  v595[12] = v161;
  v594[13] = @"JobAssignPersistedState";
  v566 = v3;
  v567 = @"ProvidePersistedForJob";
  v160 = [NSDictionary dictionaryWithObjects:&v567 forKeys:&v566 count:1];
  v595[13] = v160;
  v594[14] = @"JobSetLookupResponseReceived";
  v564 = v3;
  v565 = @"SetJobLookupResponseRcvd";
  v159 = [NSDictionary dictionaryWithObjects:&v565 forKeys:&v564 count:1];
  v595[14] = v159;
  v594[15] = @"JobIssueClientReply";
  v562 = v3;
  v563 = @"IssueClientReplyJobResponse";
  v158 = [NSDictionary dictionaryWithObjects:&v563 forKeys:&v562 count:1];
  v595[15] = v158;
  v594[16] = @"JobFinished";
  v560 = v3;
  v561 = @"RemoveFinishedJob";
  v157 = [NSDictionary dictionaryWithObjects:&v561 forKeys:&v560 count:1];
  v595[16] = v157;
  v594[17] = @"SetJobIssueClientReply";
  v558 = v3;
  v559 = @"IssueClientReplySetJob";
  v156 = [NSDictionary dictionaryWithObjects:&v559 forKeys:&v558 count:1];
  v595[17] = v156;
  v594[18] = @"SetJobSchedulerFoundSame";
  v556 = v3;
  v557 = v4;
  v155 = [NSDictionary dictionaryWithObjects:&v557 forKeys:&v556 count:1];
  v595[18] = v155;
  v594[19] = @"SetJobSchedulerDownloaded";
  v554 = v3;
  v555 = v4;
  v154 = [NSDictionary dictionaryWithObjects:&v555 forKeys:&v554 count:1];
  v595[19] = v154;
  v594[20] = @"PushNotificationReceived";
  v552 = v3;
  v553 = @"IgnorePushNotifications";
  v153 = [NSDictionary dictionaryWithObjects:&v553 forKeys:&v552 count:1];
  v595[20] = v153;
  v594[21] = @"SecureOperationsFinished";
  v550 = v3;
  v551 = @"ClearInProgressSecure";
  v152 = [NSDictionary dictionaryWithObjects:&v551 forKeys:&v550 count:1];
  v595[21] = v152;
  v594[22] = @"StagerAlreadyDownloaded";
  v548 = v3;
  v549 = @"StagerAlreadyDownloaded";
  v151 = [NSDictionary dictionaryWithObjects:&v549 forKeys:&v548 count:1];
  v595[22] = v151;
  v594[23] = @"StagerStartDetermine";
  v546 = v3;
  v547 = @"StagerJobStartDetermine";
  v150 = [NSDictionary dictionaryWithObjects:&v547 forKeys:&v546 count:1];
  v595[23] = v150;
  v594[24] = @"StagerStartDownload";
  v544 = v3;
  v545 = @"StagerJobStartDownload";
  v149 = [NSDictionary dictionaryWithObjects:&v545 forKeys:&v544 count:1];
  v595[24] = v149;
  v594[25] = @"StagerDetermineDone";
  v542 = v3;
  v543 = @"StagerJobDoneDetermine";
  v148 = [NSDictionary dictionaryWithObjects:&v543 forKeys:&v542 count:1];
  v595[25] = v148;
  v594[26] = @"StagerDownloadDone";
  v540 = v3;
  v541 = @"StagerJobDoneDownload";
  v147 = [NSDictionary dictionaryWithObjects:&v541 forKeys:&v540 count:1];
  v595[26] = v147;
  v594[27] = @"StagerPurgeStagedContent";
  v538 = v3;
  v539 = @"StagerRemoveAllNotPromoted";
  v146 = [NSDictionary dictionaryWithObjects:&v539 forKeys:&v538 count:1];
  v595[27] = v146;
  v594[28] = @"HaveNeedingPersonalize";
  v536[0] = v2;
  v536[1] = v3;
  v537[0] = @"ResumingPersonalizing";
  v537[1] = @"AttemptNextPersonalize";
  v145 = [NSDictionary dictionaryWithObjects:v537 forKeys:v536 count:2];
  v595[28] = v145;
  v594[29] = @"HaveNeedingGraft";
  v534[0] = v2;
  v534[1] = v3;
  v535[0] = @"ResumingGrafting";
  v535[1] = @"AttemptNextGraft";
  v144 = [NSDictionary dictionaryWithObjects:v535 forKeys:v534 count:2];
  v595[29] = v144;
  v594[30] = @"NoneNeedingPersonalize";
  v532[0] = v2;
  v532[1] = v3;
  v533[0] = @"ResumingScheduler";
  v533[1] = @"ResumeScheduler";
  v143 = [NSDictionary dictionaryWithObjects:v533 forKeys:v532 count:2];
  v595[30] = v143;
  v142 = [NSDictionary dictionaryWithObjects:v595 forKeys:v594 count:31];
  v777[7] = v142;
  v776[8] = @"ResumingPersonalizing";
  v530[0] = @"PollForDeviceUnlocked";
  v528 = v3;
  v529 = v4;
  v141 = [NSDictionary dictionaryWithObjects:&v529 forKeys:&v528 count:1];
  v531[0] = v141;
  v530[1] = @"DownloadManagerSyncSkipped";
  v526 = v3;
  v527 = v4;
  v140 = [NSDictionary dictionaryWithObjects:&v527 forKeys:&v526 count:1];
  v531[1] = v140;
  v530[2] = @"DownloadManagerSynced";
  v524 = v3;
  v525 = @"AdditionalSynced";
  v139 = [NSDictionary dictionaryWithObjects:&v525 forKeys:&v524 count:1];
  v531[2] = v139;
  v530[3] = @"DownloadCatalogFinished";
  v522 = v3;
  v523 = @"QueueDownloadManager";
  v138 = [NSDictionary dictionaryWithObjects:&v523 forKeys:&v522 count:1];
  v531[3] = v138;
  v530[4] = @"DownloadConfigFinished";
  v520 = v3;
  v521 = @"QueueDownloadManager";
  v137 = [NSDictionary dictionaryWithObjects:&v521 forKeys:&v520 count:1];
  v531[4] = v137;
  v530[5] = @"DownloadAssetFinished";
  v518 = v3;
  v519 = @"QueueDownloadManager";
  v136 = [NSDictionary dictionaryWithObjects:&v519 forKeys:&v518 count:1];
  v531[5] = v136;
  v530[6] = @"TimeoutAwaitingSynced";
  v516 = v3;
  v517 = v4;
  v135 = [NSDictionary dictionaryWithObjects:&v517 forKeys:&v516 count:1];
  v531[6] = v135;
  v530[7] = @"TimeoutClientQueued";
  v514 = v3;
  v515 = @"FailClientTimedOut";
  v134 = [NSDictionary dictionaryWithObjects:&v515 forKeys:&v514 count:1];
  v531[7] = v134;
  v530[8] = @"ClientRequest";
  v512 = v3;
  v513 = @"QueueClientRequest";
  v133 = [NSDictionary dictionaryWithObjects:&v513 forKeys:&v512 count:1];
  v531[8] = v133;
  v530[9] = @"ClientClosed";
  v510 = v3;
  v511 = @"RemoveQueuedClient";
  v132 = [NSDictionary dictionaryWithObjects:&v511 forKeys:&v510 count:1];
  v531[9] = v132;
  v530[10] = @"JobObtainLookupGrant";
  v508 = v3;
  v509 = @"ObtainLookupGrant";
  v131 = [NSDictionary dictionaryWithObjects:&v509 forKeys:&v508 count:1];
  v531[10] = v131;
  v530[11] = @"JobReleaseLookupGrant";
  v506 = v3;
  v507 = @"ReleaseLookupGrant";
  v130 = [NSDictionary dictionaryWithObjects:&v507 forKeys:&v506 count:1];
  v531[11] = v130;
  v530[12] = @"JobAssignPersistedState";
  v504 = v3;
  v505 = @"ProvidePersistedForJob";
  v129 = [NSDictionary dictionaryWithObjects:&v505 forKeys:&v504 count:1];
  v531[12] = v129;
  v530[13] = @"JobSetLookupResponseReceived";
  v502 = v3;
  v503 = @"SetJobLookupResponseRcvd";
  v128 = [NSDictionary dictionaryWithObjects:&v503 forKeys:&v502 count:1];
  v531[13] = v128;
  v530[14] = @"JobIssueClientReply";
  v500 = v3;
  v501 = @"IssueClientReplyJobResponse";
  v127 = [NSDictionary dictionaryWithObjects:&v501 forKeys:&v500 count:1];
  v531[14] = v127;
  v530[15] = @"JobFinished";
  v498 = v3;
  v499 = @"RemoveFinishedJob";
  v126 = [NSDictionary dictionaryWithObjects:&v499 forKeys:&v498 count:1];
  v531[15] = v126;
  v530[16] = @"SetJobIssueClientReply";
  v496 = v3;
  v497 = @"IssueClientReplySetJob";
  v125 = [NSDictionary dictionaryWithObjects:&v497 forKeys:&v496 count:1];
  v531[16] = v125;
  v530[17] = @"SetJobSchedulerFoundSame";
  v494 = v3;
  v495 = v4;
  v124 = [NSDictionary dictionaryWithObjects:&v495 forKeys:&v494 count:1];
  v531[17] = v124;
  v530[18] = @"SetJobSchedulerDownloaded";
  v492 = v3;
  v493 = v4;
  v123 = [NSDictionary dictionaryWithObjects:&v493 forKeys:&v492 count:1];
  v531[18] = v123;
  v530[19] = @"PushNotificationReceived";
  v490 = v3;
  v491 = @"IgnorePushNotifications";
  v122 = [NSDictionary dictionaryWithObjects:&v491 forKeys:&v490 count:1];
  v531[19] = v122;
  v530[20] = @"SecureOperationsFinished";
  v488 = v3;
  v489 = @"ClearInProgressSecure";
  v121 = [NSDictionary dictionaryWithObjects:&v489 forKeys:&v488 count:1];
  v531[20] = v121;
  v530[21] = @"StartupPersonalizeSuccess";
  v486 = v3;
  v487 = @"PersonalizeSuccessDecideMore";
  v120 = [NSDictionary dictionaryWithObjects:&v487 forKeys:&v486 count:1];
  v531[21] = v120;
  v530[22] = @"StartupPersonalizeFailed";
  v484 = v3;
  v485 = @"PersonalizeFailureDecideMore";
  v119 = [NSDictionary dictionaryWithObjects:&v485 forKeys:&v484 count:1];
  v531[22] = v119;
  v530[23] = @"StagerAlreadyDownloaded";
  v482 = v3;
  v483 = @"StagerAlreadyDownloaded";
  v118 = [NSDictionary dictionaryWithObjects:&v483 forKeys:&v482 count:1];
  v531[23] = v118;
  v530[24] = @"StagerStartDetermine";
  v480 = v3;
  v481 = @"StagerJobStartDetermine";
  v117 = [NSDictionary dictionaryWithObjects:&v481 forKeys:&v480 count:1];
  v531[24] = v117;
  v530[25] = @"StagerStartDownload";
  v478 = v3;
  v479 = @"StagerJobStartDownload";
  v116 = [NSDictionary dictionaryWithObjects:&v479 forKeys:&v478 count:1];
  v531[25] = v116;
  v530[26] = @"StagerDetermineDone";
  v476 = v3;
  v477 = @"StagerJobDoneDetermine";
  v115 = [NSDictionary dictionaryWithObjects:&v477 forKeys:&v476 count:1];
  v531[26] = v115;
  v530[27] = @"StagerDownloadDone";
  v474 = v3;
  v475 = @"StagerJobDoneDownload";
  v114 = [NSDictionary dictionaryWithObjects:&v475 forKeys:&v474 count:1];
  v531[27] = v114;
  v530[28] = @"StagerPurgeStagedContent";
  v472 = v3;
  v473 = @"StagerRemoveAllNotPromoted";
  v113 = [NSDictionary dictionaryWithObjects:&v473 forKeys:&v472 count:1];
  v531[28] = v113;
  v530[29] = @"HaveNeedingPersonalize";
  v470 = v3;
  v471 = @"AttemptNextPersonalize";
  v112 = [NSDictionary dictionaryWithObjects:&v471 forKeys:&v470 count:1];
  v531[29] = v112;
  v530[30] = @"NoneNeedingPersonalize";
  v468 = v3;
  v469 = @"DecideNeedGraft";
  v111 = [NSDictionary dictionaryWithObjects:&v469 forKeys:&v468 count:1];
  v531[30] = v111;
  v530[31] = @"HaveNeedingGraft";
  v466[0] = v2;
  v466[1] = v3;
  v467[0] = @"ResumingGrafting";
  v467[1] = @"AttemptNextGraft";
  v110 = [NSDictionary dictionaryWithObjects:v467 forKeys:v466 count:2];
  v531[31] = v110;
  v530[32] = @"NoneNeedingGraft";
  v464[0] = v2;
  v464[1] = v3;
  v465[0] = @"ResumingScheduler";
  v465[1] = @"ResumeScheduler";
  v109 = [NSDictionary dictionaryWithObjects:v465 forKeys:v464 count:2];
  v531[32] = v109;
  v108 = [NSDictionary dictionaryWithObjects:v531 forKeys:v530 count:33];
  v777[8] = v108;
  v776[9] = @"ResumingGrafting";
  v462[0] = @"PollForDeviceUnlocked";
  v460 = v3;
  v461 = v4;
  v107 = [NSDictionary dictionaryWithObjects:&v461 forKeys:&v460 count:1];
  v463[0] = v107;
  v462[1] = @"DownloadManagerSyncSkipped";
  v458 = v3;
  v459 = v4;
  v106 = [NSDictionary dictionaryWithObjects:&v459 forKeys:&v458 count:1];
  v463[1] = v106;
  v462[2] = @"DownloadManagerSynced";
  v456 = v3;
  v457 = @"AdditionalSynced";
  v105 = [NSDictionary dictionaryWithObjects:&v457 forKeys:&v456 count:1];
  v463[2] = v105;
  v462[3] = @"DownloadCatalogFinished";
  v454 = v3;
  v455 = @"QueueDownloadManager";
  v104 = [NSDictionary dictionaryWithObjects:&v455 forKeys:&v454 count:1];
  v463[3] = v104;
  v462[4] = @"DownloadConfigFinished";
  v452 = v3;
  v453 = @"QueueDownloadManager";
  v103 = [NSDictionary dictionaryWithObjects:&v453 forKeys:&v452 count:1];
  v463[4] = v103;
  v462[5] = @"DownloadAssetFinished";
  v450 = v3;
  v451 = @"QueueDownloadManager";
  v102 = [NSDictionary dictionaryWithObjects:&v451 forKeys:&v450 count:1];
  v463[5] = v102;
  v462[6] = @"TimeoutAwaitingSynced";
  v448 = v3;
  v449 = v4;
  v101 = [NSDictionary dictionaryWithObjects:&v449 forKeys:&v448 count:1];
  v463[6] = v101;
  v462[7] = @"TimeoutClientQueued";
  v446 = v3;
  v447 = @"FailClientTimedOut";
  v100 = [NSDictionary dictionaryWithObjects:&v447 forKeys:&v446 count:1];
  v463[7] = v100;
  v462[8] = @"ClientRequest";
  v444 = v3;
  v445 = @"QueueClientRequest";
  v99 = [NSDictionary dictionaryWithObjects:&v445 forKeys:&v444 count:1];
  v463[8] = v99;
  v462[9] = @"ClientClosed";
  v442 = v3;
  v443 = @"RemoveQueuedClient";
  v98 = [NSDictionary dictionaryWithObjects:&v443 forKeys:&v442 count:1];
  v463[9] = v98;
  v462[10] = @"JobObtainLookupGrant";
  v440 = v3;
  v441 = @"ObtainLookupGrant";
  v97 = [NSDictionary dictionaryWithObjects:&v441 forKeys:&v440 count:1];
  v463[10] = v97;
  v462[11] = @"JobReleaseLookupGrant";
  v438 = v3;
  v439 = @"ReleaseLookupGrant";
  v96 = [NSDictionary dictionaryWithObjects:&v439 forKeys:&v438 count:1];
  v463[11] = v96;
  v462[12] = @"JobAssignPersistedState";
  v436 = v3;
  v437 = @"ProvidePersistedForJob";
  v95 = [NSDictionary dictionaryWithObjects:&v437 forKeys:&v436 count:1];
  v463[12] = v95;
  v462[13] = @"JobSetLookupResponseReceived";
  v434 = v3;
  v435 = @"SetJobLookupResponseRcvd";
  v94 = [NSDictionary dictionaryWithObjects:&v435 forKeys:&v434 count:1];
  v463[13] = v94;
  v462[14] = @"JobIssueClientReply";
  v432 = v3;
  v433 = @"IssueClientReplyJobResponse";
  v93 = [NSDictionary dictionaryWithObjects:&v433 forKeys:&v432 count:1];
  v463[14] = v93;
  v462[15] = @"JobFinished";
  v430 = v3;
  v431 = @"RemoveFinishedJob";
  v92 = [NSDictionary dictionaryWithObjects:&v431 forKeys:&v430 count:1];
  v463[15] = v92;
  v462[16] = @"SetJobIssueClientReply";
  v428 = v3;
  v429 = @"IssueClientReplySetJob";
  v91 = [NSDictionary dictionaryWithObjects:&v429 forKeys:&v428 count:1];
  v463[16] = v91;
  v462[17] = @"SetJobSchedulerFoundSame";
  v426 = v3;
  v427 = v4;
  v90 = [NSDictionary dictionaryWithObjects:&v427 forKeys:&v426 count:1];
  v463[17] = v90;
  v462[18] = @"SetJobSchedulerDownloaded";
  v424 = v3;
  v425 = v4;
  v89 = [NSDictionary dictionaryWithObjects:&v425 forKeys:&v424 count:1];
  v463[18] = v89;
  v462[19] = @"PushNotificationReceived";
  v422 = v3;
  v423 = @"IgnorePushNotifications";
  v88 = [NSDictionary dictionaryWithObjects:&v423 forKeys:&v422 count:1];
  v463[19] = v88;
  v462[20] = @"SecureOperationsFinished";
  v420 = v3;
  v421 = @"ClearInProgressSecure";
  v87 = [NSDictionary dictionaryWithObjects:&v421 forKeys:&v420 count:1];
  v463[20] = v87;
  v462[21] = @"StartupGraftSuccess";
  v418 = v3;
  v419 = @"GraftSuccessDecideMore";
  v86 = [NSDictionary dictionaryWithObjects:&v419 forKeys:&v418 count:1];
  v463[21] = v86;
  v462[22] = @"StartupGraftFailed";
  v416 = v3;
  v417 = @"GraftFailureDecideMore";
  v85 = [NSDictionary dictionaryWithObjects:&v417 forKeys:&v416 count:1];
  v463[22] = v85;
  v462[23] = @"StagerAlreadyDownloaded";
  v414 = v3;
  v415 = @"StagerAlreadyDownloaded";
  v84 = [NSDictionary dictionaryWithObjects:&v415 forKeys:&v414 count:1];
  v463[23] = v84;
  v462[24] = @"StagerStartDetermine";
  v412 = v3;
  v413 = @"StagerJobStartDetermine";
  v83 = [NSDictionary dictionaryWithObjects:&v413 forKeys:&v412 count:1];
  v463[24] = v83;
  v462[25] = @"StagerStartDownload";
  v410 = v3;
  v411 = @"StagerJobStartDownload";
  v82 = [NSDictionary dictionaryWithObjects:&v411 forKeys:&v410 count:1];
  v463[25] = v82;
  v462[26] = @"StagerDetermineDone";
  v408 = v3;
  v409 = @"StagerJobDoneDetermine";
  v81 = [NSDictionary dictionaryWithObjects:&v409 forKeys:&v408 count:1];
  v463[26] = v81;
  v462[27] = @"StagerDownloadDone";
  v406 = v3;
  v407 = @"StagerJobDoneDownload";
  v80 = [NSDictionary dictionaryWithObjects:&v407 forKeys:&v406 count:1];
  v463[27] = v80;
  v462[28] = @"StagerPurgeStagedContent";
  v404 = v3;
  v405 = @"StagerRemoveAllNotPromoted";
  v79 = [NSDictionary dictionaryWithObjects:&v405 forKeys:&v404 count:1];
  v463[28] = v79;
  v462[29] = @"HaveNeedingGraft";
  v402 = v3;
  v403 = @"AttemptNextGraft";
  v78 = [NSDictionary dictionaryWithObjects:&v403 forKeys:&v402 count:1];
  v463[29] = v78;
  v462[30] = @"NoneNeedingGraft";
  v400[0] = v2;
  v400[1] = v3;
  v401[0] = @"ResumingScheduler";
  v401[1] = @"ResumeScheduler";
  v77 = [NSDictionary dictionaryWithObjects:v401 forKeys:v400 count:2];
  v463[30] = v77;
  v76 = [NSDictionary dictionaryWithObjects:v463 forKeys:v462 count:31];
  v777[9] = v76;
  v776[10] = @"ResumingScheduler";
  v398[0] = @"PollForDeviceUnlocked";
  v396 = v3;
  v397 = v4;
  v75 = [NSDictionary dictionaryWithObjects:&v397 forKeys:&v396 count:1];
  v399[0] = v75;
  v398[1] = @"SchedulerResumed";
  v394[0] = v2;
  v394[1] = v3;
  v395[0] = @"Active";
  v395[1] = @"ResumeJobs";
  v74 = [NSDictionary dictionaryWithObjects:v395 forKeys:v394 count:2];
  v399[1] = v74;
  v398[2] = @"DownloadManagerSyncSkipped";
  v392 = v3;
  v393 = v4;
  v73 = [NSDictionary dictionaryWithObjects:&v393 forKeys:&v392 count:1];
  v399[2] = v73;
  v398[3] = @"DownloadManagerSynced";
  v390 = v3;
  v391 = v4;
  v72 = [NSDictionary dictionaryWithObjects:&v391 forKeys:&v390 count:1];
  v399[3] = v72;
  v398[4] = @"DownloadCatalogFinished";
  v388 = v3;
  v389 = @"QueueDownloadManager";
  v71 = [NSDictionary dictionaryWithObjects:&v389 forKeys:&v388 count:1];
  v399[4] = v71;
  v398[5] = @"DownloadConfigFinished";
  v386 = v3;
  v387 = @"QueueDownloadManager";
  v70 = [NSDictionary dictionaryWithObjects:&v387 forKeys:&v386 count:1];
  v399[5] = v70;
  v398[6] = @"DownloadAssetFinished";
  v384 = v3;
  v385 = @"QueueDownloadManager";
  v69 = [NSDictionary dictionaryWithObjects:&v385 forKeys:&v384 count:1];
  v399[6] = v69;
  v398[7] = @"TimeoutAwaitingSynced";
  v382 = v3;
  v383 = v4;
  v68 = [NSDictionary dictionaryWithObjects:&v383 forKeys:&v382 count:1];
  v399[7] = v68;
  v398[8] = @"TimeoutClientQueued";
  v380 = v3;
  v381 = @"FailClientTimedOut";
  v67 = [NSDictionary dictionaryWithObjects:&v381 forKeys:&v380 count:1];
  v399[8] = v67;
  v398[9] = @"ClientRequest";
  v378 = v3;
  v379 = @"QueueClientRequest";
  v66 = [NSDictionary dictionaryWithObjects:&v379 forKeys:&v378 count:1];
  v399[9] = v66;
  v398[10] = @"ClientClosed";
  v376 = v3;
  v377 = @"RemoveQueuedClient";
  v65 = [NSDictionary dictionaryWithObjects:&v377 forKeys:&v376 count:1];
  v399[10] = v65;
  v398[11] = @"JobObtainLookupGrant";
  v374 = v3;
  v375 = @"ObtainLookupGrant";
  v64 = [NSDictionary dictionaryWithObjects:&v375 forKeys:&v374 count:1];
  v399[11] = v64;
  v398[12] = @"JobReleaseLookupGrant";
  v372 = v3;
  v373 = @"ReleaseLookupGrant";
  v63 = [NSDictionary dictionaryWithObjects:&v373 forKeys:&v372 count:1];
  v399[12] = v63;
  v398[13] = @"JobAssignPersistedState";
  v370 = v3;
  v371 = @"ProvidePersistedForJob";
  v62 = [NSDictionary dictionaryWithObjects:&v371 forKeys:&v370 count:1];
  v399[13] = v62;
  v398[14] = @"JobSetLookupResponseReceived";
  v368 = v3;
  v369 = @"SetJobLookupResponseRcvd";
  v61 = [NSDictionary dictionaryWithObjects:&v369 forKeys:&v368 count:1];
  v399[14] = v61;
  v398[15] = @"JobIssueClientReply";
  v366 = v3;
  v367 = @"IssueClientReplyJobResponse";
  v60 = [NSDictionary dictionaryWithObjects:&v367 forKeys:&v366 count:1];
  v399[15] = v60;
  v398[16] = @"JobFinished";
  v364 = v3;
  v365 = @"RemoveFinishedJob";
  v59 = [NSDictionary dictionaryWithObjects:&v365 forKeys:&v364 count:1];
  v399[16] = v59;
  v398[17] = @"SetJobIssueClientReply";
  v362 = v3;
  v363 = @"IssueClientReplySetJob";
  v58 = [NSDictionary dictionaryWithObjects:&v363 forKeys:&v362 count:1];
  v399[17] = v58;
  v398[18] = @"SetJobSchedulerFoundSame";
  v360 = v3;
  v361 = v4;
  v56 = [NSDictionary dictionaryWithObjects:&v361 forKeys:&v360 count:1];
  v399[18] = v56;
  v398[19] = @"SetJobSchedulerDownloaded";
  v358 = v3;
  v359 = v4;
  v55 = [NSDictionary dictionaryWithObjects:&v359 forKeys:&v358 count:1];
  v399[19] = v55;
  v398[20] = @"PushNotificationReceived";
  v356 = v3;
  v357 = @"IgnorePushNotifications";
  v54 = [NSDictionary dictionaryWithObjects:&v357 forKeys:&v356 count:1];
  v399[20] = v54;
  v398[21] = @"SecureOperationsFinished";
  v354 = v3;
  v355 = @"ClearInProgressSecure";
  v53 = [NSDictionary dictionaryWithObjects:&v355 forKeys:&v354 count:1];
  v399[21] = v53;
  v398[22] = @"StagerAlreadyDownloaded";
  v352 = v3;
  v353 = @"StagerAlreadyDownloaded";
  v52 = [NSDictionary dictionaryWithObjects:&v353 forKeys:&v352 count:1];
  v399[22] = v52;
  v398[23] = @"StagerStartDetermine";
  v350 = v3;
  v351 = @"StagerJobStartDetermine";
  v51 = [NSDictionary dictionaryWithObjects:&v351 forKeys:&v350 count:1];
  v399[23] = v51;
  v398[24] = @"StagerStartDownload";
  v348 = v3;
  v349 = @"StagerJobStartDownload";
  v50 = [NSDictionary dictionaryWithObjects:&v349 forKeys:&v348 count:1];
  v399[24] = v50;
  v398[25] = @"StagerDetermineDone";
  v346 = v3;
  v347 = @"StagerJobDoneDetermine";
  v49 = [NSDictionary dictionaryWithObjects:&v347 forKeys:&v346 count:1];
  v399[25] = v49;
  v398[26] = @"StagerDownloadDone";
  v344 = v3;
  v345 = @"StagerJobDoneDownload";
  v48 = [NSDictionary dictionaryWithObjects:&v345 forKeys:&v344 count:1];
  v399[26] = v48;
  v398[27] = @"StagerPurgeStagedContent";
  v342 = v3;
  v343 = @"StagerRemoveAllNotPromoted";
  v47 = [NSDictionary dictionaryWithObjects:&v343 forKeys:&v342 count:1];
  v399[27] = v47;
  v46 = [NSDictionary dictionaryWithObjects:v399 forKeys:v398 count:28];
  v777[10] = v46;
  v776[11] = @"Active";
  v340[0] = @"PollForDeviceUnlocked";
  v338 = v3;
  v339 = v4;
  v45 = [NSDictionary dictionaryWithObjects:&v339 forKeys:&v338 count:1];
  v341[0] = v45;
  v340[1] = @"DownloadManagerSyncSkipped";
  v336 = v3;
  v337 = v4;
  v44 = [NSDictionary dictionaryWithObjects:&v337 forKeys:&v336 count:1];
  v341[1] = v44;
  v340[2] = @"DownloadManagerSynced";
  v334 = v3;
  v335 = @"AdditionalSynced";
  v43 = [NSDictionary dictionaryWithObjects:&v335 forKeys:&v334 count:1];
  v341[2] = v43;
  v340[3] = @"DownloadCatalogFinished";
  v332 = v3;
  v333 = @"RouteCatalogFinished";
  v42 = [NSDictionary dictionaryWithObjects:&v333 forKeys:&v332 count:1];
  v341[3] = v42;
  v340[4] = @"DownloadConfigFinished";
  v330 = v3;
  v331 = @"RouteConfigFinished";
  v41 = [NSDictionary dictionaryWithObjects:&v331 forKeys:&v330 count:1];
  v341[4] = v41;
  v340[5] = @"DownloadAssetFinished";
  v328 = v3;
  v329 = @"RouteAssetFinished";
  v40 = [NSDictionary dictionaryWithObjects:&v329 forKeys:&v328 count:1];
  v341[5] = v40;
  v340[6] = @"TimeoutAwaitingSynced";
  v326 = v3;
  v327 = v4;
  v39 = [NSDictionary dictionaryWithObjects:&v327 forKeys:&v326 count:1];
  v341[6] = v39;
  v340[7] = @"ClientRequest";
  v324 = v3;
  v325 = @"RouteClientRequest";
  v38 = [NSDictionary dictionaryWithObjects:&v325 forKeys:&v324 count:1];
  v341[7] = v38;
  v340[8] = @"ClientClosed";
  v322 = v3;
  v323 = @"RouteClientClosed";
  v37 = [NSDictionary dictionaryWithObjects:&v323 forKeys:&v322 count:1];
  v341[8] = v37;
  v340[9] = @"JobObtainLookupGrant";
  v320 = v3;
  v321 = @"ObtainLookupGrant";
  v36 = [NSDictionary dictionaryWithObjects:&v321 forKeys:&v320 count:1];
  v341[9] = v36;
  v340[10] = @"JobReleaseLookupGrant";
  v318 = v3;
  v319 = @"ReleaseLookupGrant";
  v35 = [NSDictionary dictionaryWithObjects:&v319 forKeys:&v318 count:1];
  v341[10] = v35;
  v340[11] = @"JobAssignPersistedState";
  v316 = v3;
  v317 = @"ProvidePersistedForJob";
  v34 = [NSDictionary dictionaryWithObjects:&v317 forKeys:&v316 count:1];
  v341[11] = v34;
  v340[12] = @"JobSetLookupResponseReceived";
  v314 = v3;
  v315 = @"SetJobLookupResponseRcvd";
  v33 = [NSDictionary dictionaryWithObjects:&v315 forKeys:&v314 count:1];
  v341[12] = v33;
  v340[13] = @"JobIssueClientReply";
  v312 = v3;
  v313 = @"IssueClientReplyJobResponse";
  v32 = [NSDictionary dictionaryWithObjects:&v313 forKeys:&v312 count:1];
  v341[13] = v32;
  v340[14] = @"JobFinished";
  v310 = v3;
  v311 = @"RemoveFinishedJob";
  v31 = [NSDictionary dictionaryWithObjects:&v311 forKeys:&v310 count:1];
  v341[14] = v31;
  v340[15] = @"JobFinishedRerouteScheduled";
  v308 = v3;
  v309 = @"CoalesceLateJobScheduled";
  v30 = [NSDictionary dictionaryWithObjects:&v309 forKeys:&v308 count:1];
  v341[15] = v30;
  v340[16] = @"SetJobIssueClientReply";
  v306 = v3;
  v307 = @"IssueClientReplySetJob";
  v29 = [NSDictionary dictionaryWithObjects:&v307 forKeys:&v306 count:1];
  v341[16] = v29;
  v340[17] = @"SetJobSchedulerFoundSame";
  v304 = v3;
  v305 = @"SchedulerJobFoundSame";
  v28 = [NSDictionary dictionaryWithObjects:&v305 forKeys:&v304 count:1];
  v341[17] = v28;
  v340[18] = @"SetJobSchedulerDownloaded";
  v302 = v3;
  v303 = @"SchedulerJobDownloaded";
  v27 = [NSDictionary dictionaryWithObjects:&v303 forKeys:&v302 count:1];
  v341[18] = v27;
  v340[19] = @"SetJobFinishedRerouteScheduled";
  v300 = v3;
  v301 = @"CoalesceLateJobSetScheduled";
  v26 = [NSDictionary dictionaryWithObjects:&v301 forKeys:&v300 count:1];
  v341[19] = v26;
  v340[20] = @"SchedulerTriggered";
  v298 = v3;
  v299 = @"ScheduleJobs";
  v25 = [NSDictionary dictionaryWithObjects:&v299 forKeys:&v298 count:1];
  v341[20] = v25;
  v340[21] = @"SchedulerSetsTriggered";
  v296 = v3;
  v297 = @"ScheduleSetJobs";
  v24 = [NSDictionary dictionaryWithObjects:&v297 forKeys:&v296 count:1];
  v341[21] = v24;
  v340[22] = @"SchedulerNoActivity";
  v294 = v3;
  v295 = v4;
  v23 = [NSDictionary dictionaryWithObjects:&v295 forKeys:&v294 count:1];
  v341[22] = v23;
  v340[23] = @"SchedulerTickOccurred";
  v292 = v3;
  v293 = @"DecrementTickDriven";
  v22 = [NSDictionary dictionaryWithObjects:&v293 forKeys:&v292 count:1];
  v341[23] = v22;
  v340[24] = @"SchedulerEliminatedSelector";
  v290 = v3;
  v291 = @"EliminateSchedulerDone";
  v21 = [NSDictionary dictionaryWithObjects:&v291 forKeys:&v290 count:1];
  v341[24] = v21;
  v340[25] = @"PushNotificationReceived";
  v288 = v3;
  v289 = @"HandlePushNotifications";
  v20 = [NSDictionary dictionaryWithObjects:&v289 forKeys:&v288 count:1];
  v341[25] = v20;
  v340[26] = @"SecureOperationsFinished";
  v286 = v3;
  v287 = @"ClearInProgressSecure";
  v19 = [NSDictionary dictionaryWithObjects:&v287 forKeys:&v286 count:1];
  v341[26] = v19;
  v340[27] = @"StagerAlreadyDownloaded";
  v284 = v3;
  v285 = @"StagerAlreadyDownloaded";
  v18 = [NSDictionary dictionaryWithObjects:&v285 forKeys:&v284 count:1];
  v341[27] = v18;
  v340[28] = @"StagerStartDetermine";
  v282 = v3;
  v283 = @"StagerJobStartDetermine";
  v17 = [NSDictionary dictionaryWithObjects:&v283 forKeys:&v282 count:1];
  v341[28] = v17;
  v340[29] = @"StagerStartDownload";
  v280 = v3;
  v281 = @"StagerJobStartDownload";
  v16 = [NSDictionary dictionaryWithObjects:&v281 forKeys:&v280 count:1];
  v341[29] = v16;
  v340[30] = @"StagerDetermineDone";
  v278 = v3;
  v279 = @"StagerJobDoneDetermine";
  v5 = [NSDictionary dictionaryWithObjects:&v279 forKeys:&v278 count:1];
  v341[30] = v5;
  v340[31] = @"StagerDownloadDone";
  v276 = v3;
  v277 = @"StagerJobDoneDownload";
  v6 = [NSDictionary dictionaryWithObjects:&v277 forKeys:&v276 count:1];
  v341[31] = v6;
  v340[32] = @"StagerCancelCurrentJob";
  v274 = v3;
  v275 = @"StagerJobCancel";
  v7 = [NSDictionary dictionaryWithObjects:&v275 forKeys:&v274 count:1];
  v341[32] = v7;
  v340[33] = @"StagerEliminatedSelector";
  v272 = v3;
  v273 = @"EliminateStagerDone";
  v8 = [NSDictionary dictionaryWithObjects:&v273 forKeys:&v272 count:1];
  v341[33] = v8;
  v340[34] = @"StagerEliminatedConfiguration";
  v270 = v3;
  v271 = @"EliminateStagerSetDone";
  v9 = [NSDictionary dictionaryWithObjects:&v271 forKeys:&v270 count:1];
  v341[34] = v9;
  v340[35] = @"StagerPurgeStagedContent";
  v268 = v3;
  v269 = @"StagerRemoveAllNotPromoted";
  v10 = [NSDictionary dictionaryWithObjects:&v269 forKeys:&v268 count:1];
  v341[35] = v10;
  v340[36] = @"CancelActivityAck";
  v266 = v3;
  v267 = @"CancelActivityAck";
  v11 = [NSDictionary dictionaryWithObjects:&v267 forKeys:&v266 count:1];
  v341[36] = v11;
  v340[37] = @"InstallAssetsEvent";
  v264 = v3;
  v265 = @"InstallAssets";
  v12 = [NSDictionary dictionaryWithObjects:&v265 forKeys:&v264 count:1];
  v341[37] = v12;
  v13 = [NSDictionary dictionaryWithObjects:v341 forKeys:v340 count:38];
  v777[11] = v13;
  v57 = [NSDictionary dictionaryWithObjects:v777 forKeys:v776 count:12];

  v14 = [[NSDictionary alloc] initWithDictionary:v57 copyItems:1];

  return v14;
}

- (int64_t)performAction:(id)action onEvent:(id)event inState:(id)state withInfo:(id)info nextState:(id)nextState error:(id *)error
{
  actionCopy = action;
  infoCopy = info;
  if ([actionCopy isEqualToString:kSUCoreFSMActionNoOp])
  {
    v13 = 0;
  }

  else
  {
    if ([actionCopy isEqualToString:@"StartUnlockPollingTimer"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StartUnlockPollingTimer:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"PollDecideBefore1stUnlock"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PollDecideBefore1stUnlock:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncSkippedDecideBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncSkippedDecideBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncDecideBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncDecideBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"LoadPersistedResumeLocker"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_LoadPersistedResumeLocker:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ResumeStager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeStager:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncedResumeStager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedResumeStager:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"PromoteStagedMigrate"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PromoteStagedMigrate:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ResumeScheduler"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeScheduler:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncInFlightDownloads"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncInFlightDownloads:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"Synced"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Synced:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"AdditionalSynced"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AdditionalSynced:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ResumeJobsBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeJobsBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ResumeJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ResumeJobs:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"FailClientTimedOut"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_FailClientTimedOut:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"QueueClientRequest"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueClientRequest:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"QueueClientRequestBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueClientRequestBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RemoveQueuedClient"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RemoveQueuedClient:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RouteClientRequest"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteClientRequest:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RouteClientClosed"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteClientClosed:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"QueueDownloadManager"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_QueueDownloadManager:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RouteCatalogFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteCatalogFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RouteConfigFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteConfigFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RouteAssetFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RouteAssetFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"Before1stCatalogFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stCatalogFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"Before1stConfigFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stConfigFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"Before1stAssetFinished"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_Before1stAssetFinished:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncedReviewUnlocked"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedReviewUnlocked:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SyncedReviewBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SyncedReviewBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ObtainLookupGrant"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ObtainLookupGrant:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ReleaseLookupGrant"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ReleaseLookupGrant:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ProvidePersistedForJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ProvidePersistedForJob:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SetJobLookupResponseRcvd"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SetJobLookupResponseRcvd:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"IssueClientReplyJobResponse"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IssueClientReplyJobResponse:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"RemoveFinishedJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_RemoveFinishedJob:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"CoalesceLateJobScheduled"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CoalesceLateJobScheduled:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"CoalesceLateJobSetScheduled"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CoalesceLateJobSetScheduled:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"IssueClientReplySetJob"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IssueClientReplySetJob:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SchedulerJobFoundSame"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SchedulerJobFoundSame:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"SchedulerJobDownloaded"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_SchedulerJobDownloaded:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ScheduleJobsBefore1st"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleJobsBefore1st:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ScheduleJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleJobs:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ScheduleSetJobs"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ScheduleSetJobs:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"DecrementTickDriven"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecrementTickDriven:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"IgnorePushNotifications"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_IgnorePushNotifications:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"HandlePushNotifications"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_HandlePushNotifications:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"ClearInProgressSecure"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_ClearInProgressSecure:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"DecideNeedPersonalize"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecideNeedPersonalize:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"DecideNeedGraft"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_DecideNeedGraft:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"AttemptNextPersonalize"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AttemptNextPersonalize:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"AttemptNextGraft"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_AttemptNextGraft:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"PersonalizeSuccessDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PersonalizeSuccessDecideMore:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"PersonalizeFailureDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_PersonalizeFailureDecideMore:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"GraftSuccessDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_GraftSuccessDecideMore:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"GraftFailureDecideMore"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_GraftFailureDecideMore:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerAlreadyDownloaded"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerAlreadyDownloaded:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerJobStartDetermine"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobStartDetermine:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerJobStartDownload"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobStartDownload:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerJobDoneDetermine"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobDoneDetermine:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerJobDoneDownload"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobDoneDownload:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerJobCancel"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerJobCancel:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"StagerRemoveAllNotPromoted"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_StagerRemoveAllNotPromoted:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"EliminateSchedulerDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateSchedulerDone:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"EliminateStagerDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateStagerDone:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"EliminateStagerSetDone"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_EliminateStagerSetDone:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"CancelActivityAck"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_CancelActivityAck:infoCopy error:error];
    }

    else if ([actionCopy isEqualToString:@"InstallAssets"])
    {
      v14 = [(MADAutoAssetControlManager *)self action_InstallAssets:infoCopy error:error];
    }

    else
    {
      v14 = [(MADAutoAssetControlManager *)self actionUnknownAction:actionCopy error:error];
    }

    v13 = v14;
  }

  return v13;
}

+ (id)autoControlManager
{
  if (autoControlManager_dispatchOnceAutoControlManager != -1)
  {
    +[MADAutoAssetControlManager autoControlManager];
  }

  v3 = autoControlManager___autoControlManager;

  return v3;
}

void __48__MADAutoAssetControlManager_autoControlManager__block_invoke(id a1)
{
  v1 = _MADLog(@"Auto");
  if (os_log_type_enabled(v1, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v1, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initializing the shared auto-control-manager | init...", buf, 2u);
  }

  v2 = objc_alloc_init(MADAutoAssetControlManager);
  v3 = autoControlManager___autoControlManager;
  autoControlManager___autoControlManager = v2;

  v4 = _MADLog(@"Auto");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *v5 = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initializing the shared auto-control-manager | ...init", v5, 2u);
  }
}

+ (void)shutdown
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v2 autoControlManagerFSM];

  v4 = _MADLog(@"AutoControl");
  v5 = os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT);
  if (autoControlManagerFSM)
  {
    if (v5)
    {
      *buf = 0;
      _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Beginning shutdown sequence for AutoAssetControlManager", buf, 2u);
    }

    autoControlManagerFSM2 = [v2 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __38__MADAutoAssetControlManager_shutdown__block_invoke;
    block[3] = &unk_4B2AA0;
    v10 = v2;
    dispatch_sync(extendedStateQueue, block);

    v8 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown}: Shutdown sequence for AutoAssetControlManager complete", buf, 2u);
    }

    v4 = v10;
  }

  else if (v5)
  {
    *buf = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Skipping shutdown sequence since FSM not initialized", buf, 2u);
  }
}

void __38__MADAutoAssetControlManager_shutdown__block_invoke(uint64_t a1)
{
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    v2 = [*(a1 + 32) connectionServer];

    if (v2)
    {
      v3 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Suspending SUCoreConnectServer", buf, 2u);
      }

      v4 = [*(a1 + 32) connectionServer];
      [v4 suspendListenerAndInvalidate];

      [*(a1 + 32) setConnectionServer:0];
    }
  }

  v5 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    *v12 = 0;
    _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down MADAutoAssetScheduler", v12, 2u);
  }

  +[MADAutoAssetScheduler shutdown];
  v6 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down MADAutoAssetStager", v11, 2u);
  }

  +[MADAutoAssetStager shutdown];
  v7 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    *v10 = 0;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{shutdown} Shutting down myself. Goodbye!!", v10, 2u);
  }

  v8 = [*(a1 + 32) autoControlManagerFSM];
  v9 = [v8 extendedStateQueue];
  dispatch_suspend(v9);
}

- (MADAutoAssetControlManager)init
{
  v110.receiver = self;
  v110.super_class = MADAutoAssetControlManager;
  v2 = [(MADAutoAssetControlManager *)&v110 init];
  v3 = v2;
  if (v2)
  {
    [(MADAutoAssetControlManager *)v2 _initializeSUCore];
    if (__isPlatformVersionAtLeast(2, 26, 0, 0) && (objc_opt_respondsToSelector() & 1) != 0)
    {
      +[MAAutoAssetError mapAutoAssetErrorIndications];
    }

    v4 = +[NSDate date];
    [v4 timeIntervalSince1970];
    v3->_startupTimeBeginSeconds = v5;

    v3->_startupTimeDurationSeconds = -1.0;
    latestSafeSummary = v3->_latestSafeSummary;
    v3->_latestSafeSummary = @"INIT";

    persistedActiveJobs = v3->_persistedActiveJobs;
    v3->_persistedActiveJobs = 0;

    persistedKnownDescriptors = v3->_persistedKnownDescriptors;
    v3->_persistedKnownDescriptors = 0;

    uTF8String = [@"com.apple.MobileAsset.daemon.autoassetdispatch" UTF8String];
    v10 = dispatch_queue_attr_make_with_autorelease_frequency(0, DISPATCH_AUTORELEASE_FREQUENCY_WORK_ITEM);
    v11 = dispatch_queue_create(uTF8String, v10);
    sharedDispatchQueue = v3->_sharedDispatchQueue;
    v3->_sharedDispatchQueue = v11;

    connectionServer = v3->_connectionServer;
    v3->_connectionServer = 0;

    serverConnectionPolicy = v3->_serverConnectionPolicy;
    v3->_serverConnectionPolicy = 0;

    v15 = objc_alloc_init(NSMutableDictionary);
    currentStatusBySelector = v3->_currentStatusBySelector;
    v3->_currentStatusBySelector = v15;

    v17 = objc_alloc_init(NSMutableDictionary);
    currentJobsBySelector = v3->_currentJobsBySelector;
    v3->_currentJobsBySelector = v17;

    v19 = objc_alloc_init(NSMutableDictionary);
    currentJobsByUUID = v3->_currentJobsByUUID;
    v3->_currentJobsByUUID = v19;

    stagedSetLookupResults = v3->_stagedSetLookupResults;
    v3->_stagedSetLookupResults = 0;

    *&v3->_stagerResumed = 0;
    stagerCurrentJob = v3->_stagerCurrentJob;
    v3->_stagerCurrentJob = 0;

    stagerBondedToAutoJob = v3->_stagerBondedToAutoJob;
    v3->_stagerBondedToAutoJob = 0;

    stagerCurrentJobUUID = v3->_stagerCurrentJobUUID;
    v3->_stagerCurrentJobUUID = 0;

    stagerFormedSetConfiguration = v3->_stagerFormedSetConfiguration;
    v3->_stagerFormedSetConfiguration = 0;

    stagerDownloadingSelector = v3->_stagerDownloadingSelector;
    v3->_stagerDownloadingSelector = 0;

    v27 = objc_alloc_init(NSMutableDictionary);
    lookupGrantsByAssetType = v3->_lookupGrantsByAssetType;
    v3->_lookupGrantsByAssetType = v27;

    v29 = [[MAAutoAssetUpdatePolicy alloc] initUpdatePolicy:@"defaultUpdatePolicy" forAssetType:0];
    defaultUpdatePolicy = v3->_defaultUpdatePolicy;
    v3->_defaultUpdatePolicy = v29;

    v31 = objc_alloc_init(NSMutableDictionary);
    alreadyScheduledSelectors = v3->_alreadyScheduledSelectors;
    v3->_alreadyScheduledSelectors = v31;

    v33 = objc_alloc_init(NSMutableDictionary);
    timedOperations = v3->_timedOperations;
    v3->_timedOperations = v33;

    v35 = objc_alloc_init(NSMutableDictionary);
    clientRequestsBeingTracked = v3->_clientRequestsBeingTracked;
    v3->_clientRequestsBeingTracked = v35;

    v37 = objc_alloc_init(NSMutableArray);
    clientRequestsAwaitingSync = v3->_clientRequestsAwaitingSync;
    v3->_clientRequestsAwaitingSync = v37;

    v39 = objc_alloc_init(NSMutableArray);
    clientRequestsAwaitingFirstUnlock = v3->_clientRequestsAwaitingFirstUnlock;
    v3->_clientRequestsAwaitingFirstUnlock = v39;

    v41 = objc_alloc_init(NSMutableArray);
    downloadManagerEventsAwaitingResumed = v3->_downloadManagerEventsAwaitingResumed;
    v3->_downloadManagerEventsAwaitingResumed = v41;

    downloadManagerInFlightTasks = v3->_downloadManagerInFlightTasks;
    v3->_downloadManagerInFlightTasks = 0;

    beyondFirstUnlockPollTimer = v3->_beyondFirstUnlockPollTimer;
    v3->_beyondFirstUnlockPollTimer = 0;

    awaitDownloadManagerSyncTimer = v3->_awaitDownloadManagerSyncTimer;
    v3->_awaitDownloadManagerSyncTimer = 0;

    *&v3->_receivedDownloadManagerSync = 0;
    v46 = objc_alloc_init(NSMutableDictionary);
    activelyEliminatingSelectors = v3->_activelyEliminatingSelectors;
    v3->_activelyEliminatingSelectors = v46;

    v48 = objc_alloc_init(MANAutoAssetControlStatistics);
    statistics = v3->_statistics;
    v3->_statistics = v48;

    v3->_statisticsNextMaintenanceReport = 0.0;
    v50 = objc_alloc_init(NSMutableDictionary);
    filesystemFileExistAtPathCache = v3->_filesystemFileExistAtPathCache;
    v3->_filesystemFileExistAtPathCache = v50;

    locksPriorToSecureHealing = v3->_locksPriorToSecureHealing;
    v3->_filesystemStartupLookupCount = 0;
    v3->_locksPriorToSecureHealing = 0;

    v53 = objc_alloc_init(NSMutableArray);
    descriptorsRequiringPersonalization = v3->_descriptorsRequiringPersonalization;
    v3->_descriptorsRequiringPersonalization = v53;

    v55 = objc_alloc_init(NSMutableArray);
    descriptorsRequiringGrafting = v3->_descriptorsRequiringGrafting;
    v3->_descriptorsRequiringGrafting = v55;

    v57 = objc_alloc_init(NSMutableArray);
    prePersonalizedSelectors = v3->_prePersonalizedSelectors;
    v3->_prePersonalizedSelectors = v57;

    *&v3->_secureHealingPersonalizationAttempted = 0;
    [@"com.apple.MobileAsset.startupTransaction" UTF8String];
    v59 = os_transaction_create();
    startupTransaction = v3->_startupTransaction;
    v3->_startupTransaction = v59;

    v3->_startupSignpost = 0;
    v61 = objc_alloc_init(MAPerfResults);
    startupPerfResults = v3->_startupPerfResults;
    v3->_startupPerfResults = v61;

    v63 = objc_alloc_init(NSMutableDictionary);
    currentSetJobsByIdentifier = v3->_currentSetJobsByIdentifier;
    v3->_currentSetJobsByIdentifier = v63;

    v65 = objc_alloc_init(NSMutableDictionary);
    cancelingSetJobsByIdentifier = v3->_cancelingSetJobsByIdentifier;
    v3->_cancelingSetJobsByIdentifier = v65;

    v67 = objc_alloc_init(NSMutableDictionary);
    currentSetStatusByInstance = v3->_currentSetStatusByInstance;
    v3->_currentSetStatusByInstance = v67;

    v69 = objc_alloc_init(NSMutableDictionary);
    knownSetConfigurationsByIdentifier = v3->_knownSetConfigurationsByIdentifier;
    v3->_knownSetConfigurationsByIdentifier = v69;

    v71 = objc_alloc_init(NSMutableDictionary);
    knownSetAtomicInstancesByInstance = v3->_knownSetAtomicInstancesByInstance;
    v3->_knownSetAtomicInstancesByInstance = v71;

    v73 = objc_alloc_init(NSMutableDictionary);
    preinstalledAssetDescriptorsBySelector = v3->_preinstalledAssetDescriptorsBySelector;
    v3->_preinstalledAssetDescriptorsBySelector = v73;

    v75 = objc_alloc_init(NSMutableDictionary);
    activeSetDescriptorsByIdentifier = v3->_activeSetDescriptorsByIdentifier;
    v3->_activeSetDescriptorsByIdentifier = v75;

    v77 = objc_alloc_init(NSMutableDictionary);
    activeSetDescriptorsByInstance = v3->_activeSetDescriptorsByInstance;
    v3->_activeSetDescriptorsByInstance = v77;

    v79 = objc_alloc_init(NSMutableDictionary);
    shortTermLockedLatestByIdentifier = v3->_shortTermLockedLatestByIdentifier;
    v3->_shortTermLockedLatestByIdentifier = v79;

    v81 = objc_alloc_init(NSMutableDictionary);
    shortTermLockedByAtomicInstance = v3->_shortTermLockedByAtomicInstance;
    v3->_shortTermLockedByAtomicInstance = v81;

    v83 = objc_alloc_init(NSMutableArray);
    descriptorsDroppedOnStartup = v3->_descriptorsDroppedOnStartup;
    v3->_descriptorsDroppedOnStartup = v83;

    v3->_persistedActiveSetJobsLoaded = 0;
    persistedKnownSetConfigurations = v3->_persistedKnownSetConfigurations;
    v3->_persistedKnownSetConfigurations = 0;

    persistedKnownSetAtomicInstances = v3->_persistedKnownSetAtomicInstances;
    v3->_persistedKnownSetAtomicInstances = 0;

    persistedActiveJobSetDescriptors = v3->_persistedActiveJobSetDescriptors;
    v3->_persistedActiveJobSetDescriptors = 0;

    persistedDownloadedSetDescriptors = v3->_persistedDownloadedSetDescriptors;
    v3->_persistedDownloadedSetDescriptors = 0;

    persistedSetTargets = v3->_persistedSetTargets;
    v3->_persistedSetTargets = 0;

    persistedSetLookupResults = v3->_persistedSetLookupResults;
    v3->_persistedSetLookupResults = 0;

    setLockUsageMap = v3->_setLockUsageMap;
    v3->_setLockUsageMap = 0;

    v3->_simulateOperationRequested = 0;
    v92 = objc_alloc_init(NSMutableDictionary);
    simulateOperationsBySelector = v3->_simulateOperationsBySelector;
    v3->_simulateOperationsBySelector = v92;

    v94 = objc_alloc_init(NSMutableDictionary);
    simulateOperationsBySetJobKey = v3->_simulateOperationsBySetJobKey;
    v3->_simulateOperationsBySetJobKey = v94;

    v96 = +[MADAnalyticsManager getAnalyticsManager];
    analyticsManager = v3->_analyticsManager;
    v3->_analyticsManager = v96;

    [(MADAutoAssetControlManager *)v3 _initializeCachedPreferences];
    p_bootedOSVersion = &v3->_bootedOSVersion;
    objc_storeStrong(&v3->_bootedOSVersion, v3->_preferenceAsIfBootedOSIsOSVersion);
    p_bootedOSBuildVersion = &v3->_bootedOSBuildVersion;
    objc_storeStrong(&v3->_bootedOSBuildVersion, v3->_preferenceAsIfBootedOSIsBuildVersion);
    if (!v3->_bootedOSVersion)
    {
      v100 = +[SUCoreDevice sharedDevice];
      productVersion = [v100 productVersion];
      v102 = *p_bootedOSVersion;
      *p_bootedOSVersion = productVersion;
    }

    if (!*p_bootedOSBuildVersion)
    {
      v103 = deviceOSBuildVersion();
      v104 = *p_bootedOSBuildVersion;
      *p_bootedOSBuildVersion = v103;
    }

    if (runningInDeviceRecoveryEnvironment())
    {
      v105 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v105, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v105, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-MANAGER : Not initializing autoControl in DeviceRecovery mode", buf, 2u);
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)v3 _initializeAutoControl];
    }

    [(MADAutoAssetControlManager *)v3 _initializeServerConnectionPolicy];
    [(MADAutoAssetControlManager *)v3 _initializeConnectionServer];
    v106 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v106, OS_LOG_TYPE_DEFAULT))
    {
      v107 = *p_bootedOSVersion;
      v108 = *p_bootedOSBuildVersion;
      *buf = 138543874;
      v112 = @"3.0.4";
      v113 = 2114;
      v114 = v107;
      v115 = 2114;
      v116 = v108;
      _os_log_impl(&dword_0, v106, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-MANAGER [AutoAssetVersion:%{public}@] | Initialized | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
    }
  }

  return v3;
}

- (void)_initializeSUCore
{
  v2 = +[SUCore sharedCore];
  [v2 useDomain:@"com.apple.MAAuto"];
}

- (void)_initializeServerConnectionPolicy
{
  serverConnectionPolicy = self->_serverConnectionPolicy;
  v4 = _MADLog(@"AutoControl");
  v5 = v4;
  if (serverConnectionPolicy)
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "{_initializeServerConnectionPolicy} SUCoreConnectServerPolicy has already been initialized", buf, 2u);
    }
  }

  else
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Initializing SUCoreConnectServerPolicy", buf, 2u);
    }

    if (runningInDeviceRecoveryEnvironment())
    {
      v6 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v6, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v6, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} AutoControlManager no supported in DeviceRecovery mode. Setting policy to reject all incoming connections.", buf, 2u);
      }

      v7 = +[NSUUID UUID];
      uUIDString = [v7 UUIDString];
      v9 = [NSSet setWithObject:uUIDString];
    }

    else
    {
      v9 = [NSSet setWithObject:@"com.apple.private.assets.bypass-asset-types-check"];
    }

    v49 = v9;
    v10 = [[SUCoreConnectServerPolicy alloc] initWithServiceName:@"com.apple.mobileasset.autoasset" entitlements:v9 serverDelegate:self];
    v11 = self->_serverConnectionPolicy;
    self->_serverConnectionPolicy = v10;

    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      v13 = self->_serverConnectionPolicy;
      *buf = 138543362;
      v51 = v13;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Created the ServerConnectionPolicy:%{public}@", buf, 0xCu);
    }

    v48 = objc_alloc_init(NSSet);
    v47 = objc_opt_class();
    v46 = objc_opt_class();
    v45 = objc_opt_class();
    v44 = objc_opt_class();
    v43 = objc_opt_class();
    v14 = objc_opt_class();
    v15 = objc_opt_class();
    v16 = objc_opt_class();
    v17 = objc_opt_class();
    v18 = objc_opt_class();
    v19 = objc_opt_class();
    v20 = objc_opt_class();
    v21 = objc_opt_class();
    v22 = objc_opt_class();
    v23 = [NSSet setWithObjects:v47, v46, v45, v44, v43, v14, v15, v16, v17, v18, v19, v20, v21, v22, objc_opt_class(), 0];
    v24 = [v48 setByAddingObjectsFromSet:v23];

    v25 = [MASAutoAssetStatus newServerMessageClasses:v24];
    v26 = [MASAutoAssetSummary newServerMessageClasses:v25];

    v27 = [MASAutoAssetInfoControl newServerMessageClasses:v26];
    v28 = [MASAutoAssetControlStatistics newServerMessageClasses:v27];

    v29 = [MASAutoAssetSetInfoInstance newServerMessageClasses:v28];
    v30 = [MASAutoAssetSetInfoDesire newServerMessageClasses:v29];

    v31 = [MASAutoAssetSetInfoFound newServerMessageClasses:v30];
    v32 = [MASAutoAssetSetInfoEnd newServerMessageClasses:v31];

    v33 = [MASAutoAssetSetInfoControl newServerMessageClasses:v32];
    v34 = [MASAutoAssetSetAtomicEntry newServerMessageClasses:v33];

    v35 = [MASAutoAssetSetEntry newServerMessageClasses:v34];
    v36 = [MASAutoAssetSetPolicy newServerMessageClasses:v35];

    v37 = [MASAutoAssetSetStatus newServerMessageClasses:v36];
    v38 = [MASAutoAssetSetLockTracker newServerMessageClasses:v37];

    v39 = [MASAutoAssetSetNotifications newServerMessageClasses:v38];
    if (__isPlatformVersionAtLeast(2, 18, 4, 0) && objc_opt_class())
    {
      v40 = [MAAutoAssetSuspendResumeForSoftwareUpdateInfo newServerMessageClasses:v39];

      v39 = v40;
    }

    v5 = v49;
    v41 = [MASAutoAssetControlStagerInformation newServerMessageClasses:v39];

    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:INTEREST_IN_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CHECK_FOR_NEWER"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:DETERMINE_IF_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CURRENT_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:LOCK_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CONTINUE_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:DOWNLOAD_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:CANCEL_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:PURGE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE:ERASE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):INTEREST_IN_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CHECK_FOR_NEWER"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):DETERMINE_IF_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CURRENT_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):LOCK_CONTENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):MAP_LOCKED_CONTENT_TO_EXCLAVE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_LOCK_USAGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):END_ALL_PREVIOUS_LOCKS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):CANCEL_ACTIVITY_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_ASSET_TYPE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO(REPLY):ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DOWNLOAD_GROUPS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):DOWNLOAD_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):CANCEL_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):PURGE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-STAGE(REPLY):ERASE_ALL"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):EVICTABLE_BYTES"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):SUSPEND"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):RESUME"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SUSPEND-RESUME-SU(REPLY):STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):CONTROL_STATISTICS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):KNOWN_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):ACTIVE_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SCHEDULED_JOB_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):LOCKED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):STAGED_ASSET_SUMMARY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):STAGER_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_UNLOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_FORGET"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_PURGE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_ABANDON"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_RECLAIM_SPACE"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-CONTROL(REPLY):SIM_SET_JOB_OPERATION"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CHECK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:LOCK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:FORM_SUB_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:END_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:CURRENT_SET_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET:ELIMINATE_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS"];
    [SUCoreConnectServerPolicy setAllowlistedClasses:v41 forKey:@"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC"];
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "{_initializeServerConnectionPolicy} Set all the allowlisted classes for the server policy for all auto-asset[-set] commands and replies", buf, 2u);
    }
  }
}

- (void)_initializeConnectionServer
{
  connectionServer = self->_connectionServer;
  v4 = _MADLog(@"AutoControl");
  v5 = v4;
  if (connectionServer)
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_ERROR))
    {
      *v8 = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "{_initializeConnectionServer} SUCoreConnectServer has already been initialized", v8, 2u);
    }
  }

  else
  {
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "{_initializeConnectionServer} Initializing SUCoreConnectServer", buf, 2u);
    }

    v6 = [[SUCoreConnectServer alloc] initWithServerPolicy:self->_serverConnectionPolicy];
    v7 = self->_connectionServer;
    self->_connectionServer = v6;

    [(SUCoreConnectServer *)self->_connectionServer setupListenerAndResumeConnection];
  }
}

- (void)_initializeCachedPreferences
{
  v67 = 0;
  *&self->_preferenceScheduledAlwaysNonDiscretionary = 0;
  preferenceScheduledOnlyForAssetTypes = self->_preferenceScheduledOnlyForAssetTypes;
  self->_preferenceScheduledOnlyForAssetTypes = 0;

  preferenceSessionIDBase = self->_preferenceSessionIDBase;
  self->_preferenceSessionIDBase = 0;

  self->_preferenceConnectorInitialWaitSecs = -1;
  preferenceConnectorBackoffRetryTimes = self->_preferenceConnectorBackoffRetryTimes;
  self->_preferenceConnectorBackoffRetryTimes = 0;

  self->_preferenceConnectorWaitBeforeRetrySecs = -1;
  self->_preferenceMaxStagerDeterminingSecs = -1;
  self->_preferenceMaxStagerFilesystemMegabytes = -1;
  *&self->_preferenceAutoAssetObserverIgnoreNetworkStatus = 0;
  self->_preferenceStagerInjectAvailableOlderVersions = 0;
  self->_preferenceStagerDeterminePallasResponseFewer = -1;
  *&self->_preferenceStagerDownloadFirstNotInCatalog = 0;
  preferenceAsIfBootedOSIsOSVersion = self->_preferenceAsIfBootedOSIsOSVersion;
  self->_preferenceAsIfBootedOSIsOSVersion = 0;

  preferenceAsIfBootedOSIsBuildVersion = self->_preferenceAsIfBootedOSIsBuildVersion;
  self->_preferenceAsIfBootedOSIsBuildVersion = 0;

  *&self->_preferenceAlwaysPromoteStagedAssets = 0;
  *&self->_preferenceAsIfBackgroundSpecified = 0;
  *&v8 = -1;
  *(&v8 + 1) = -1;
  *&self->_preferenceActivityTickerSecs = v8;
  *&self->_preferencePushActivityIntervalSecs = v8;
  self->_preferenceActivityAggressiveIntervalSecs = -1;
  preferenceActivityHeightenedAssetType = self->_preferenceActivityHeightenedAssetType;
  self->_preferenceActivityHeightenedAssetType = 0;

  preferenceActivityAggressiveAssetType = self->_preferenceActivityAggressiveAssetType;
  self->_preferenceActivityAggressiveAssetType = 0;

  *&self->_preferencePersistedTableLoggingEnabled = 0;
  *&v11 = -1;
  *(&v11 + 1) = -1;
  *&self->_preferenceBeforeFirstPollSecs = v11;
  *&self->_preferenceLookupCacheAssetSelectorValidSecs = v11;
  *&self->_preferenceSecureSimulateRequireAll = 0;
  self->_preferenceSecureSimulateGraftFailure = 0;
  p_preferenceSimulatedDownloadFailureResult = &self->_preferenceSimulatedDownloadFailureResult;
  self->_preferenceSimulatedDownloadFailureResult = -1;
  self->_preferenceSimulatedStagingLookupFailureResult = -1;
  self->_preferenceForceStartupHealthReport = 0;
  preferenceHealthReportAdditionalSetNames = self->_preferenceHealthReportAdditionalSetNames;
  self->_preferenceHealthReportAdditionalSetNames = 0;

  self->_migratedFromPreinstalled = 0;
  AppBooleanValue = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledAlwaysNonDiscretionary", &v67);
  if (v67)
  {
    self->_preferenceScheduledAlwaysNonDiscretionary = AppBooleanValue != 0;
  }

  AppIntegerValue = _MAPreferencesGetAppIntegerValue(@"AutoAssetConnectorInitialWaitSecs", &v67);
  if (v67)
  {
    self->_preferenceConnectorInitialWaitSecs = AppIntegerValue;
  }

  v16 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityTickerSecs", &v67);
  if (v67)
  {
    self->_preferenceActivityTickerSecs = v16;
  }

  v17 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityIntervalSecs", &v67);
  if (v67)
  {
    self->_preferenceActivityIntervalSecs = v17;
  }

  if (_MAPreferencesIsInternalAllowed())
  {
    v18 = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledBackupTriggersDisabled", &v67);
    if (v67)
    {
      self->_preferenceScheduledBackupTriggersDisabled = v18 != 0;
    }

    v19 = _MAPreferencesCopyNSStringValue(@"AutoAssetScheduledOnlyForAssetTypes");
    if (v19)
    {
      objc_storeStrong(&self->_preferenceScheduledOnlyForAssetTypes, v19);
    }

    v20 = _MAPreferencesCopyNSStringValue(@"AutoAssetSessionIDBase");

    if (v20 && [v20 length] == &dword_0 + 3)
    {
      objc_storeStrong(&self->_preferenceSessionIDBase, v20);
    }

    v21 = _MAPreferencesCopyNSArrayOfNumbersValue(@"AutoAssetConnectorBackoffRetryTimes");
    if (v21)
    {
      v22 = +[MADAutoAssetConnector backoffRetryLevelDefaultTimes];
      v23 = objc_alloc_init(NSMutableArray);
      if (v23 && [v22 count] >= 8)
      {
        [v23 addObject:&off_4F7F70];
        for (i = 0; i != 8; ++i)
        {
          if ([v21 count] <= i)
          {
            v25 = v22;
          }

          else
          {
            v25 = v21;
          }

          v26 = [v25 objectAtIndex:i];
          [v23 addObject:v26];
        }

        objc_storeStrong(&self->_preferenceConnectorBackoffRetryTimes, v23);
        p_preferenceSimulatedDownloadFailureResult = &self->_preferenceSimulatedDownloadFailureResult;
      }
    }

    v27 = _MAPreferencesGetAppIntegerValue(@"AutoAssetConnectorWaitBeforeRetrySecs", &v67);
    if (v67)
    {
      self->_preferenceConnectorWaitBeforeRetrySecs = v27;
    }

    v28 = _MAPreferencesGetAppBooleanValue(@"AutoAssetObserverIgnoreNetworkStatus", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetObserverIgnoreNetworkStatus = v28 != 0;
    }

    v29 = _MAPreferencesGetAppBooleanValue(@"AutoAssetLogSetCompare", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetLogSetCompare = v29 != 0;
    }

    v30 = _MAPreferencesGetAppBooleanValue(@"AutoAssetNoPersistedOverflowLimit", &v67);
    if (v67)
    {
      self->_preferenceAutoAssetNoPersistedOverflowLimit = v30 != 0;
    }

    v31 = _MAPreferencesGetAppIntegerValue(@"AutoAssetMaxStagerDeterminingSecs", &v67);
    if (v67)
    {
      self->_preferenceMaxStagerDeterminingSecs = v31;
    }

    v32 = _MAPreferencesGetAppIntegerValue(@"AutoAssetStagerFilesystemMaxMegabytes", &v67);
    if (v67)
    {
      self->_preferenceMaxStagerFilesystemMegabytes = v32;
    }

    v33 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerInjectAvailableDups", &v67);
    if (v67)
    {
      self->_preferenceStagerInjectAvailableDups = v33 != 0;
    }

    v34 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerInjectAvailableOlderVersions", &v67);
    if (v67)
    {
      self->_preferenceStagerInjectAvailableOlderVersions = v34 != 0;
    }

    v35 = _MAPreferencesGetAppIntegerValue(@"AutoAssetStagerDeterminePallasResponseFewer", &v67);
    if (v67)
    {
      self->_preferenceStagerDeterminePallasResponseFewer = v35;
    }

    v36 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerDownloadFirstNotInCatalog", &v67);
    if (v67)
    {
      self->_preferenceStagerDownloadFirstNotInCatalog = v36 != 0;
    }

    v37 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagerDetermineLastRequiredTimesOut", &v67);
    if (v67)
    {
      self->_preferenceStagerDetermineLastRequiredTimesOut = v37 != 0;
    }

    v38 = _MAPreferencesCopyNSStringValue(@"AutoAssetAsIfBootedOSIsOSVersion");
    v39 = self->_preferenceAsIfBootedOSIsOSVersion;
    self->_preferenceAsIfBootedOSIsOSVersion = v38;

    v40 = _MAPreferencesCopyNSStringValue(@"AutoAssetAsIfBootedOSIsBuildVersion");
    v41 = self->_preferenceAsIfBootedOSIsBuildVersion;
    self->_preferenceAsIfBootedOSIsBuildVersion = v40;

    v42 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAsIfBackground", &v67);
    if (v67)
    {
      self->_preferenceAsIfBackground = v42 != 0;
      self->_preferenceAsIfBackgroundSpecified = 1;
    }

    v43 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAsIfRamp", &v67);
    if (v67)
    {
      self->_preferenceAsIfRamp = v43 != 0;
      self->_preferenceAsIfRampSpecified = 1;
    }

    v44 = _MAPreferencesGetAppBooleanValue(@"AutoAssetAlwaysPromoteStagedAssets", &v67);
    if (v67)
    {
      self->_preferenceAlwaysPromoteStagedAssets = v44 != 0;
    }

    v45 = _MAPreferencesGetAppBooleanValue(@"AutoAssetScheduledAsIfNotInternal", &v67);
    if (v67)
    {
      self->_preferenceScheduledAsIfNotInternal = v45 != 0;
    }

    v46 = _MAPreferencesGetAppBooleanValue(@"AutoAssetPersistedTableLoggingEnabled", &v67);
    if (v67)
    {
      self->_preferencePersistedTableLoggingEnabled = v46 != 0;
    }

    v47 = _MAPreferencesGetAppBooleanValue(@"AutoAssetPerformanceLoggingEnabled", &v67);
    if (v67)
    {
      self->_preferencePerformanceLoggingEnabled = v47 != 0;
    }

    v48 = _MAPreferencesGetAppIntegerValue(@"AutoAssetPushActivityIntervalSecs", &v67);
    if (v67)
    {
      self->_preferencePushActivityIntervalSecs = v48;
    }

    v49 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityHeightenedIntervalSecs", &v67);
    if (v67)
    {
      self->_preferenceActivityHeightenedIntervalSecs = v49;
    }

    v50 = _MAPreferencesGetAppIntegerValue(@"AutoAssetActivityAggressiveIntervalSecs", &v67);
    if (v67)
    {
      self->_preferenceActivityAggressiveIntervalSecs = v50;
    }

    v51 = _MAPreferencesCopyNSStringValue(@"AutoAssetActivityHeightenedAssetType");

    if (v51)
    {
      objc_storeStrong(&self->_preferenceActivityHeightenedAssetType, v51);
    }

    v52 = _MAPreferencesCopyNSStringValue(@"AutoAssetActivityAggressiveAssetType");

    if (v52)
    {
      objc_storeStrong(&self->_preferenceActivityAggressiveAssetType, v52);
    }

    v53 = _MAPreferencesGetAppIntegerValue(@"AutoAssetLookupCacheAssetSelectorValidSecs", &v67);
    if (v67)
    {
      self->_preferenceLookupCacheAssetSelectorValidSecs = v53;
    }

    v54 = _MAPreferencesGetAppIntegerValue(@"AutoAssetLookupCacheSetConfigurationValidSecs", &v67);
    if (v67)
    {
      self->_preferenceLookupCacheSetConfigurationValidSecs = v54;
    }

    v55 = _MAPreferencesGetAppIntegerValue(@"AutoAssetBeforeFirstPollSecs", &v67);
    if (v67)
    {
      self->_preferenceBeforeFirstPollSecs = v55;
    }

    v56 = _MAPreferencesGetAppIntegerValue(@"AutoAssetBeforeFirstDefaultTimeoutSecs", &v67);
    if (v67)
    {
      self->_preferenceBeforeFirstDefaultTimeoutSecs = v56;
    }

    v57 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateRequireAll", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateRequireAll = v57 != 0;
    }

    v58 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateFailureAll", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateFailureAll = v58 != 0;
    }

    v59 = _MAPreferencesGetAppBooleanValue(@"AutoAssetSecureSimulateGraftFailure", &v67);
    if (v67)
    {
      self->_preferenceSecureSimulateGraftFailure = v59 != 0;
    }

    v60 = _MAPreferencesGetAppIntegerValue(@"AutoAssetSimulatedDownloadFailureResult", &v67);
    if (v67)
    {
      *p_preferenceSimulatedDownloadFailureResult = v60;
    }

    v61 = _MAPreferencesGetAppIntegerValue(@"AutoAssetSimulatedStagingLookupFailureResult", &v67);
    if (v67)
    {
      self->_preferenceSimulatedStagingLookupFailureResult = v61;
    }

    v62 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStagingLookupFlipRequiredOptional", &v67);
    if (v67)
    {
      self->_preferenceStagingLookupFlipRequiredOptional = v62 != 0;
    }

    v63 = _MAPreferencesGetAppBooleanValue(@"AutoAssetStartupSimulateFirstBoot", &v67);
    if (v67)
    {
      self->_preferenceStartupSimulateFirstBoot = v63 != 0;
    }

    v64 = _MAPreferencesGetAppBooleanValue(@"AutoStartupHealthReport", &v67);
    if (v67)
    {
      self->_preferenceForceStartupHealthReport = v64 != 0;
    }

    v65 = _MAPreferencesCopyNSArrayOfStringsValue(@"AutoHealthReportSets");
    if (v65)
    {
      v66 = v65;
      objc_storeStrong(&self->_preferenceHealthReportAdditionalSetNames, v65);
    }
  }

  else
  {
    v52 = 0;
    v21 = 0;
  }

  *&self->_operatingBeforeFirstUnlock = 0;
  self->_initialHealthReportPerformedCrosscheck = 0;
}

- (void)_initializeAutoControl
{
  if (self->_autoControlManagerFSM)
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(&v2->super, OS_LOG_TYPE_ERROR))
    {
      *buf = 0;
      v3 = "{_initializeAutoControl} AutoControlManager FSM has already been initialized | MA_MILESTONE";
LABEL_4:
      _os_log_impl(&dword_0, &v2->super, OS_LOG_TYPE_ERROR, v3, buf, 2u);
    }
  }

  else
  {
    _getAutoControlManagerStateTable = [objc_opt_class() _getAutoControlManagerStateTable];
    stateTable = self->_stateTable;
    self->_stateTable = _getAutoControlManagerStateTable;

    latestSafeSummary = self->_latestSafeSummary;
    self->_latestSafeSummary = @"INIT";

    v8 = [SUCoreFSM alloc];
    v9 = [[NSString alloc] initWithFormat:@"[%@]AutoControlManager", @"3.0.4"];
    v10 = [v8 initMachine:v9 withTable:self->_stateTable startingIn:@"Startup" usingDelegate:self registeringAllInfoClass:objc_opt_class()];
    autoControlManagerFSM = self->_autoControlManagerFSM;
    self->_autoControlManagerFSM = v10;

    if (!self->_autoControlManagerFSM)
    {
      v2 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(&v2->super, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_21;
      }

      *buf = 0;
      v3 = "{_initializeAutoControl} failed to initialize AutoControlManager FSM | MA_MILESTONE";
      goto LABEL_4;
    }

    v2 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"_initializeAutoControl"];
    _startupActivationProcessIdentifier = [(MADAutoAssetControlManager *)self _startupActivationProcessIdentifier];
    v13 = [[MAAutoAssetSelector alloc] initForAssetType:_startupActivationProcessIdentifier withAssetSpecifier:@"RESOURCE_USAGE_NONE" matchingAssetVersion:@"3.0.4"];
    +[MADAutoAssetHistory loadPersistedState];
    [MADAutoAssetHistory recordOperation:621 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v13];
    v14 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
    v15 = _MADLog(@"AutoControl");
    v16 = v15;
    if (v14)
    {
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v23 = _startupActivationProcessIdentifier;
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_initializeAutoControl}%@ successfully initialized AutoControlManager FSM (device is before first-unlock) | MA_MILESTONE", buf, 0xCu);
      }

      v17 = @"StartupBefore1st";
    }

    else
    {
      [(MADAutoAssetControlManager *)self setStartupSignpost:os_signpost_id_generate(v15)];

      if ([(MADAutoAssetControlManager *)self startupSignpost])
      {
        startupPerfResults = [(MADAutoAssetControlManager *)self startupPerfResults];
        [startupPerfResults getPerfResults:1];

        v19 = _MADLog(@"AutoControl");
        startupSignpost = [(MADAutoAssetControlManager *)self startupSignpost];
        if (startupSignpost - 1 <= 0xFFFFFFFFFFFFFFFDLL)
        {
          v21 = startupSignpost;
          if (os_signpost_enabled(v19))
          {
            *buf = 134349056;
            v23 = mach_continuous_time();
            _os_signpost_emit_with_name_impl(&dword_0, v19, OS_SIGNPOST_INTERVAL_BEGIN, v21, "Startup", "%{public, signpost.description:begin_time}llu  enableTelemetry=YES ", buf, 0xCu);
          }
        }
      }

      v16 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138412290;
        v23 = _startupActivationProcessIdentifier;
        _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "{_initializeAutoControl}%@ successfully initialized AutoControlManager FSM (device is not before first-unlock) | MA_MILESTONE", buf, 0xCu);
      }

      v17 = @"StartupUnlocked";
    }

    [(SUCoreFSM *)self->_autoControlManagerFSM postEvent:v17 withInfo:v2];
  }

LABEL_21:
}

+ (void)daemonProcessStartupBegun
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  [v2 _trackPerformanceStartupBegin];
}

+ (void)lockerResumed
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:lockerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  v4 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"lockerResumed"];
  autoControlManagerFSM = [v3 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"LockerResumed" withInfo:v4];

  os_activity_scope_leave(&v6);
}

+ (void)stagerResumed:(id)resumed withSetLookupResults:(id)results performingNewOSPromotion:(BOOL)promotion requiringLoadPriorToUse:(BOOL)use
{
  useCopy = use;
  promotionCopy = promotion;
  resumedCopy = resumed;
  resultsCopy = results;
  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:stagerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &v15);

  v12 = [MADAutoAssetControlManager autoControlManager:v15.opaque[0]];
  v13 = [[MADAutoAssetControlManagerParam alloc] initWithPromoted:resumedCopy withSetLookupResults:resultsCopy withNewOSPromotion:promotionCopy withRequiringLoadPriorToUse:useCopy];
  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerResumed" withInfo:v13];

  os_activity_scope_leave(&v15);
}

+ (void)schedulerResumed:(id)resumed
{
  resumedCopy = resumed;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerResumed", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initWithScheduledJobs:resumedCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerResumed" withInfo:v6];

  os_activity_scope_leave(&v8);
}

- (void)connectionClosedForClientID:(id)d
{
  dCopy = d;
  v6 = [[MADAutoAssetControlManagerParam alloc] initWithClientID:dCopy];

  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"ClientClosed" withInfo:v6];
}

- (void)handleMessage:(id)message proxyObject:(id)object reply:(id)reply
{
  messageCopy = message;
  objectCopy = object;
  replyCopy = reply;
  v11 = replyCopy;
  if (messageCopy && replyCopy)
  {
    v12 = [[MADAutoAssetControlManagerParam alloc] initWithClientRequest:messageCopy reportingProgressThroughProxy:objectCopy withReplyCompletion:replyCopy];
    v13 = [MADAutoAssetClientRequest alloc];
    clientID = [messageCopy clientID];
    v15 = [(MADAutoAssetClientRequest *)v13 initForClientID:clientID withClientRequestMessage:messageCopy withClientProgressProxy:objectCopy withClientReplyCompletion:v11];

    [(MADAutoAssetControlManagerParam *)v12 setClientRequest:v15];
    [(MADAutoAssetControlManagerParam *)v12 updateSafeSummary];
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM postEvent:@"ClientRequest" withInfo:v12];
  }

  else
  {
    v17 = _MADLog(@"Auto");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      v18 = @"Y";
      if (messageCopy)
      {
        v19 = @"Y";
      }

      else
      {
        v19 = @"N";
      }

      if (!v11)
      {
        v18 = @"N";
      }

      v20 = 138543618;
      v21 = v19;
      v22 = 2114;
      v23 = v18;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "AUTO-CONTROL:{handleMessage} received message indication missing required fields | message:%{public}@, reply:%{public}@", &v20, 0x16u);
    }
  }
}

- (BOOL)isConnectionAuthorized:(id)authorized
{
  authorizedCopy = authorized;
  if (runningInDeviceRecoveryEnvironment())
  {
    v4 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
    {
      *v7 = 0;
      _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "{isConnectionAuthorized} AutoControlManager not supported here. Connection not authorized", v7, 2u);
    }

    v5 = 0;
  }

  else
  {
    v5 = [MADAutoAssetAuthorizationPolicy isConnectionAuthorized:authorizedCopy];
  }

  return v5;
}

+ (void)downloadManagerStateSyncSkipped
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v2 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"downloadManagerStateSyncSkipped"];
  autoControlManagerFSM = [v4 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"DownloadManagerSyncSkipped" withInfo:v2];
}

+ (void)downloadManagerStateSyncDetermined:(id)determined
{
  determinedCopy = determined;
  v6 = +[MADAutoAssetControlManager autoControlManager];
  v4 = [[MADAutoAssetControlManagerParam alloc] initWithDownloadsInFlight:determinedCopy];

  autoControlManagerFSM = [v6 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"DownloadManagerSynced" withInfo:v4];
}

+ (void)catalogDownloadJobFinished:(id)finished withCatalog:(id)catalog error:(id)error
{
  errorCopy = error;
  catalogCopy = catalog;
  finishedCopy = finished;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobID:finishedCopy withCatalog:catalogCopy withError:errorCopy];

  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"DownloadCatalogFinished" withInfo:v10];
}

+ (void)assetConfigJobFinished:(id)finished withDownloadInfo:(id)info error:(id)error
{
  errorCopy = error;
  infoCopy = info;
  finishedCopy = finished;
  v14 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [MADAutoAssetControlManagerParam alloc];
  options = [infoCopy options];

  v12 = [(MADAutoAssetControlManagerParam *)v10 initForConfigFinishedJobID:finishedCopy andDownloadOptions:options withError:errorCopy];
  autoControlManagerFSM = [v14 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"DownloadConfigFinished" withInfo:v12];
}

+ (void)assetDownloadJob:(id)job progressReport:(id)report
{
  jobCopy = job;
  reportCopy = report;
  v7 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v7 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v7 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __62__MADAutoAssetControlManager_assetDownloadJob_progressReport___block_invoke;
    block[3] = &unk_4B2AF0;
    v13 = v7;
    v14 = jobCopy;
    v15 = reportCopy;
    dispatch_async(extendedStateQueue, block);

    v11 = v13;
  }

  else
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v17 = jobCopy;
      v18 = 2112;
      v19 = reportCopy;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{assetDownloadJob} Not routing progress for job since FSM not initialized | jobID:%@ | progressReport:%@", buf, 0x16u);
    }
  }
}

void __62__MADAutoAssetControlManager_assetDownloadJob_progressReport___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v3 = *(a1 + 32);
  if (v2)
  {
    v12 = [v3 autoControlManagerFSM];
    v4 = [v12 diag];
    v5 = [NSString alloc];
    v6 = *(a1 + 40);
    v7 = [*(a1 + 48) summary];
    v8 = [v5 initWithFormat:@"{assetDownloadJob} DownloadManager indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v6, v7];
    [v4 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from DownloadManager):BEFORE-FIRST" forReason:v8 withResult:6101 withError:0];
  }

  else if (([v3 operatingBeforeResumed] & 1) == 0)
  {
    v9 = *(a1 + 32);
    v10 = *(a1 + 40);
    v11 = *(a1 + 48);

    [v9 _routeAssetProgress:@"assetDownloadJob" toCurrentJobByUUID:v10 withDownloadProgress:v11];
  }
}

+ (void)assetDownloadJobFinished:(id)finished error:(id)error
{
  errorCopy = error;
  finishedCopy = finished;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v7 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobID:finishedCopy withError:errorCopy];

  autoControlManagerFSM = [v9 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"DownloadAssetFinished" withInfo:v7];
}

+ (void)autoAssetJobObtainLookupGrant:(id)grant forAutoAssetUUID:(id)d fromAutoAssetJob:(id)job
{
  jobCopy = job;
  dCopy = d;
  grantCopy = grant;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:grantCopy withAutoAssetUUID:dCopy];

  [v10 setFromAutoAssetJob:jobCopy];
  [v10 setOriginalSelector:grantCopy];

  [v10 updateSafeSummary];
  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobObtainLookupGrant" withInfo:v10];
}

+ (void)autoAssetJobReleaseLookupGrant:(id)grant forAutoAssetUUID:(id)d fromAutoAssetJob:(id)job
{
  jobCopy = job;
  dCopy = d;
  grantCopy = grant;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:grantCopy withAutoAssetUUID:dCopy];

  [v10 setFromAutoAssetJob:jobCopy];
  [v10 setOriginalSelector:grantCopy];

  [v10 updateSafeSummary];
  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobReleaseLookupGrant" withInfo:v10];
}

+ (void)autoAssetJobReadyToDownload:(id)download withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withOriginalSelector:(id)selector downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor
{
  patchDescriptorCopy = patchDescriptor;
  descriptorCopy = descriptor;
  selectorCopy = selector;
  jobCopy = job;
  dCopy = d;
  downloadCopy = download;
  v21 = +[MADAutoAssetControlManager autoControlManager];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForJobFoundSelector:downloadCopy withAutoAssetUUID:dCopy];

  [v19 setFromAutoAssetJob:jobCopy];
  [v19 setOriginalSelector:selectorCopy];

  [v19 setDownloadingDescriptor:descriptorCopy];
  [v19 setBaseForPatchDescriptor:patchDescriptorCopy];

  [v19 updateSafeSummary];
  autoControlManagerFSM = [v21 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobAssignPersistedState" withInfo:v19];
}

+ (void)autoAssetJobSetLookupResponseReceived:(id)received forAssignedSetDescriptor:(id)descriptor withCatalogLookupResponse:(id)response
{
  responseCopy = response;
  descriptorCopy = descriptor;
  receivedCopy = received;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  v10 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:receivedCopy withSetDescriptor:descriptorCopy withCatalogLookupResponse:responseCopy];

  [v10 updateSafeSummary];
  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobSetLookupResponseReceived" withInfo:v10];
}

+ (void)autoAssetJobIssueProgress:(id)progress forAutoAssetSelector:(id)selector withAutoAssetUUID:(id)d withJobInformation:(id)information withResponseError:(id)error
{
  progressCopy = progress;
  selectorCopy = selector;
  dCopy = d;
  informationCopy = information;
  v14 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v14 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v14 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __132__MADAutoAssetControlManager_autoAssetJobIssueProgress_forAutoAssetSelector_withAutoAssetUUID_withJobInformation_withResponseError___block_invoke;
    block[3] = &unk_4B42C0;
    v20 = v14;
    v21 = dCopy;
    v22 = informationCopy;
    v23 = progressCopy;
    v24 = selectorCopy;
    dispatch_async(extendedStateQueue, block);

    v18 = v20;
  }

  else
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{autoAssetJobIssueProgress}: Not issuing auto-asset download progress indication since FSM not initialized", buf, 2u);
    }
  }
}

void __132__MADAutoAssetControlManager_autoAssetJobIssueProgress_forAutoAssetSelector_withAutoAssetUUID_withJobInformation_withResponseError___block_invoke(uint64_t a1)
{
  v2 = a1;
  v3 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v4 = *(v2 + 32);
  if (v3)
  {
    v42 = [v4 autoControlManagerFSM];
    v5 = [v42 diag];
    v6 = [NSString alloc];
    v7 = *(v2 + 40);
    v8 = [*(v2 + 48) currentStatus];
    v9 = [v8 downloadProgress];
    if (v9)
    {
      v2 = [*(v2 + 48) currentStatus];
      v1 = [v2 downloadProgress];
      v10 = [v1 summary];
    }

    else
    {
      v10 = @"N";
    }

    v24 = [v6 initWithFormat:@"{autoAssetJobIssueProgress} auto-asset-job indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v7, v10];
    [v5 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):BEFORE-FIRST" forReason:v24 withResult:6101 withError:0];

    if (v9)
    {
    }

    goto LABEL_17;
  }

  if (([v4 operatingBeforeResumed] & 1) != 0 || !*(v2 + 56))
  {
    return;
  }

  if (!*(v2 + 64))
  {
    v42 = [*(v2 + 32) autoControlManagerFSM];
    v25 = [v42 diag];
    v5 = v25;
    v26 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-AUTO-ASSET-SELECTOR";
    v27 = @"{autoAssetJobIssueProgress} auto-asset-job indication of download progress without autoAssetSelector";
LABEL_22:
    [v25 trackAnomaly:v26 forReason:v27 withResult:6102 withError:0];
LABEL_17:

    return;
  }

  v11 = *(v2 + 32);
  if (!*(v2 + 40))
  {
    v42 = [v11 autoControlManagerFSM];
    v25 = [v42 diag];
    v5 = v25;
    v26 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-AUTO-ASSET-UUID";
    v27 = @"{autoAssetJobIssueProgress} auto-asset-job indication of download progress without autoAssetUUID";
    goto LABEL_22;
  }

  v12 = [v11 _autoAssetJobProgressNewValidatedCurrentStatus:*(v2 + 48) requiringProgress:1];
  v13 = v12;
  if (v12)
  {
    v14 = [v12 downloadProgress];
    v15 = [*(v2 + 56) count];
    v16 = [*(v2 + 48) initialAssetSelector];

    if (v16)
    {
      v17 = [*(v2 + 48) initialAssetSelector];
      v16 = [v17 assetVersion];
    }

    v18 = [*(v2 + 48) fullAssetSelector];

    v19 = *(v2 + 32);
    v20 = *(v2 + 48);
    if (v18)
    {
      v21 = [v20 fullAssetSelector];
      v22 = *(v2 + 40);
      v23 = @"autoAssetJobIssueProgress(full-selector)";
    }

    else
    {
      v21 = [v20 initialAssetSelector];
      v22 = *(v2 + 40);
      v23 = @"autoAssetJobIssueProgress(initial-selector)";
    }

    [v19 updateAutoAssetStatus:v21 forActiveJobUUID:v22 withLatestJobStatus:v13 matchingAssetVersion:v16 fromLocation:v23];

    if (v15 >= 1 && [v14 totalExpectedBytes] >= 1)
    {
      v41 = v16;
      v43 = v14;
      v46 = 0u;
      v47 = 0u;
      v44 = 0u;
      v45 = 0u;
      v28 = *(v2 + 56);
      v29 = [v28 countByEnumeratingWithState:&v44 objects:v48 count:16];
      if (v29)
      {
        v30 = v29;
        v31 = *v45;
        do
        {
          for (i = 0; i != v30; i = i + 1)
          {
            if (*v45 != v31)
            {
              objc_enumerationMutation(v28);
            }

            v33 = *(*(&v44 + 1) + 8 * i);
            v34 = objc_autoreleasePoolPush();
            v35 = [v33 clientReplyCompletion];
            if (v35)
            {
              v36 = v35;
              v37 = [v33 clientProgressProxy];

              if (v37)
              {
                v38 = [v33 clientProgressProxy];
                v39 = objc_opt_respondsToSelector();

                if (v39)
                {
                  v40 = [v33 clientProgressProxy];
                  [v40 executeGenericBlock:v13];
                }
              }
            }

            objc_autoreleasePoolPop(v34);
          }

          v30 = [v28 countByEnumeratingWithState:&v44 objects:v48 count:16];
        }

        while (v30);
      }

      v16 = v41;
      v14 = v43;
    }
  }
}

- (id)_autoAssetJobProgressNewValidatedCurrentStatus:(id)status requiringProgress:(BOOL)progress
{
  progressCopy = progress;
  statusCopy = status;
  if (!statusCopy)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    [diag trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):NO-JOB-INFORMATION" forReason:@"{_autoAssetJobProgressNewValidatedCurrentStatus} required jobInformation not provided" withResult:6102 withError:0];
LABEL_20:

    goto LABEL_21;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v30 = [NSString alloc];
    v31 = objc_opt_class();
    initialAssetSelector3 = NSStringFromClass(v31);
    v33 = [v30 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation of class:%@", initialAssetSelector3];
    v34 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-WRONG-CLASS";
    v35 = diag;
    v36 = v33;
    v37 = 6103;
LABEL_14:
    [v35 trackAnomaly:v34 forReason:v36 withResult:v37 withError:0];

LABEL_19:
    goto LABEL_20;
  }

  initialAssetSelector = [statusCopy initialAssetSelector];

  if (!initialAssetSelector)
  {
LABEL_21:
    v46 = 0;
    goto LABEL_22;
  }

  initialAssetSelector2 = [statusCopy initialAssetSelector];
  objc_opt_class();
  isKindOfClass = objc_opt_isKindOfClass();

  if ((isKindOfClass & 1) == 0)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v38 = [NSString alloc];
    initialAssetSelector3 = [statusCopy initialAssetSelector];
    v39 = objc_opt_class();
    v40 = NSStringFromClass(v39);
    summary = [statusCopy summary];
    v42 = [v38 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.initialAssetSelector of class:%@ | jobInformation:%@", v40, summary];
    v43 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-INITIAL-ASSET-SELECTOR-WRONG-CLASS";
LABEL_17:
    [diag trackAnomaly:v43 forReason:v42 withResult:6103 withError:0];

LABEL_18:
    goto LABEL_19;
  }

  fullAssetSelector = [statusCopy fullAssetSelector];
  if (fullAssetSelector)
  {
    v11 = fullAssetSelector;
    fullAssetSelector2 = [statusCopy fullAssetSelector];
    objc_opt_class();
    v13 = objc_opt_isKindOfClass();

    if ((v13 & 1) == 0)
    {
      autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM diag];
      v44 = [NSString alloc];
      initialAssetSelector3 = [statusCopy fullAssetSelector];
      v45 = objc_opt_class();
      v40 = NSStringFromClass(v45);
      summary = [statusCopy summary];
      v42 = [v44 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} optional jobInformation.fullAssetSelector of class:%@ | jobInformation:%@", v40, summary];
      v43 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-FULL-ASSET-SELECTOR-WRONG-CLASS";
      goto LABEL_17;
    }
  }

  currentStatus = [statusCopy currentStatus];

  if (!currentStatus)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v48 = [NSString alloc];
    initialAssetSelector3 = [statusCopy summary];
    v33 = [v48 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} required jobInformation.currentStatus not provided | jobInformation:%@", initialAssetSelector3];
    v34 = @"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-NIL-CURRENT-STATUS";
    v35 = diag;
    v36 = v33;
    v37 = 6102;
    goto LABEL_14;
  }

  currentStatus2 = [statusCopy currentStatus];
  objc_opt_class();
  v16 = objc_opt_isKindOfClass();

  if ((v16 & 1) == 0)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v49 = [NSString alloc];
    initialAssetSelector3 = [statusCopy currentStatus];
    v50 = objc_opt_class();
    v40 = NSStringFromClass(v50);
    v51 = [v49 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.currentStatus of class:%@", v40];
    [diag trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-CURRENT-STATUS-WRONG-CLASS" forReason:v51 withResult:6103 withError:0];

    goto LABEL_18;
  }

  currentStatus3 = [statusCopy currentStatus];
  downloadProgress = [currentStatus3 downloadProgress];

  if (!downloadProgress)
  {
    if (progressCopy)
    {
      autoControlManagerFSM2 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_ERROR, "{_autoAssetJobProgressNewValidatedCurrentStatus} | no jobInformation.currentStatus.downloadProgress", buf, 2u);
      }

      goto LABEL_30;
    }

LABEL_31:
    if (objc_opt_respondsToSelector())
    {
      v52 = [currentStatus3 copy];
    }

    else
    {
      v52 = currentStatus3;
    }

    v46 = v52;
    goto LABEL_35;
  }

  downloadProgress2 = [currentStatus3 downloadProgress];
  objc_opt_class();
  v20 = objc_opt_isKindOfClass();

  if (v20)
  {
    goto LABEL_31;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag2 = [autoControlManagerFSM2 diag];
  v23 = [NSString alloc];
  downloadProgress3 = [currentStatus3 downloadProgress];
  v25 = objc_opt_class();
  v26 = NSStringFromClass(v25);
  v27 = [v23 initWithFormat:@"{_autoAssetJobProgressNewValidatedCurrentStatus} jobInformation.currentStatus.downloadProgress of class:%@", v26];
  [diag2 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from auto-asset-job):JOB-INFORMATION-CURRENT-STATUS-DOWNLOAD-PROGRESS-WRONG-CLASS" forReason:v27 withResult:6103 withError:0];

LABEL_30:
  v46 = 0;
LABEL_35:

LABEL_22:

  return v46;
}

+ (void)autoSetJobIssueProgress:(id)progress forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d withSetJobInformation:(id)information withResponseError:(id)error
{
  progressCopy = progress;
  dCopy = d;
  informationCopy = information;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v12 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v12 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __134__MADAutoAssetControlManager_autoSetJobIssueProgress_forAssetSetIdentifier_withAutoAssetUUID_withSetJobInformation_withResponseError___block_invoke;
    v17[3] = &unk_4B3350;
    v18 = v12;
    v19 = dCopy;
    v20 = informationCopy;
    v21 = progressCopy;
    dispatch_async(extendedStateQueue, v17);

    v16 = v18;
  }

  else
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL-PROGRESS:{autoSetJobIssueProgress}: Not issuing set-job download progress indication since FSM not initialized", buf, 2u);
    }
  }
}

void __134__MADAutoAssetControlManager_autoSetJobIssueProgress_forAssetSetIdentifier_withAutoAssetUUID_withSetJobInformation_withResponseError___block_invoke(uint64_t a1)
{
  v2 = a1;
  v3 = [*(a1 + 32) operatingBeforeFirstUnlock];
  v4 = *(v2 + 32);
  if (v3)
  {
    v35 = [v4 autoControlManagerFSM];
    v5 = [v35 diag];
    v6 = [NSString alloc];
    v7 = *(v2 + 40);
    v8 = [*(v2 + 48) currentSetStatus];
    v9 = [v8 downloadProgress];
    if (v9)
    {
      v2 = [*(v2 + 48) currentSetStatus];
      v1 = [v2 downloadProgress];
      v10 = [v1 summary];
    }

    else
    {
      v10 = @"N";
    }

    v34 = [v6 initWithFormat:@"{autoSetJobIssueProgress} set-job indication of download progress when device is before first-unlock | jobID:%@ | progressReport:%@", v7, v10];
    [v5 trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):BEFORE-FIRST" forReason:v34 withResult:6101 withError:0];

    if (v9)
    {
    }
  }

  else if (([v4 operatingBeforeResumed] & 1) == 0)
  {
    v11 = [*(v2 + 32) _autoAssetSetJobProgressNewValidatedCurrentStatus:*(v2 + 48)];
    v12 = [*(v2 + 56) count];
    if (v11)
    {
      v13 = v12;
      v14 = *(v2 + 32);
      v15 = [v11 clientDomainName];
      v16 = [v11 assetSetIdentifier];
      v17 = [v14 updateAutoAssetSetStatus:@"autoSetJobIssueProgress" forClientDomain:v15 forAssetSetIdentifier:v16 forJobResponse:0 withResponseError:0 clearingDownloadProgressReason:0 withAssetSetStatus:0];

      if (v13 >= 1)
      {
        v18 = [v11 downloadProgress];
        v19 = [v18 totalExpectedBytes];

        if (v19 >= 1)
        {
          v38 = 0u;
          v39 = 0u;
          v36 = 0u;
          v37 = 0u;
          v20 = *(v2 + 56);
          v21 = [v20 countByEnumeratingWithState:&v36 objects:v40 count:16];
          if (v21)
          {
            v22 = v21;
            v23 = *v37;
            do
            {
              for (i = 0; i != v22; i = i + 1)
              {
                if (*v37 != v23)
                {
                  objc_enumerationMutation(v20);
                }

                v25 = *(*(&v36 + 1) + 8 * i);
                v26 = objc_autoreleasePoolPush();
                v27 = [v25 clientReplyCompletion];
                if (v27)
                {
                  v28 = v27;
                  v29 = [v25 clientProgressProxy];

                  if (v29)
                  {
                    v30 = [v25 clientProgressProxy];
                    v31 = objc_opt_respondsToSelector();

                    if (v31)
                    {
                      v32 = [v25 clientProgressProxy];
                      v33 = [MASAutoAssetSetStatus newShimmedToFramework:v11];
                      [v32 executeGenericBlock:v33];
                    }
                  }
                }

                objc_autoreleasePoolPop(v26);
              }

              v22 = [v20 countByEnumeratingWithState:&v36 objects:v40 count:16];
            }

            while (v22);
          }
        }
      }
    }
  }
}

- (id)_autoAssetSetJobProgressNewValidatedCurrentStatus:(id)status
{
  statusCopy = status;
  if (!statusCopy)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    [diag trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):NO-SET-JOB-INFORMATION" forReason:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} required setJobInformation not provided" withResult:6102 withError:0];
LABEL_17:
    v32 = 0;
    goto LABEL_18;
  }

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v34 = [NSString alloc];
    v35 = objc_opt_class();
    summary = NSStringFromClass(v35);
    v37 = [v34 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation of class:%@", summary];
    v38 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-WRONG-CLASS";
    v39 = diag;
    v40 = v37;
    v41 = 6103;
LABEL_15:
    [v39 trackAnomaly:v38 forReason:v40 withResult:v41 withError:0];

LABEL_16:
    goto LABEL_17;
  }

  currentSetStatus = [statusCopy currentSetStatus];

  if (!currentSetStatus)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v42 = [NSString alloc];
    summary = [statusCopy summary];
    v37 = [v42 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} required setJobInformation.currentSetStatus not provided | setJobInformation:%@", summary];
    v38 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-NIL-CURRENT-STATUS";
    v39 = diag;
    v40 = v37;
    v41 = 6102;
    goto LABEL_15;
  }

  currentSetStatus2 = [statusCopy currentSetStatus];
  objc_opt_class();
  isKindOfClass = objc_opt_isKindOfClass();

  if ((isKindOfClass & 1) == 0)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v44 = [NSString alloc];
    summary = [statusCopy currentSetStatus];
    v45 = objc_opt_class();
    v46 = NSStringFromClass(v45);
    v47 = [v44 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.currentSetStatus of class:%@", v46];
    [diag trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CURRENT-STATUS-WRONG-CLASS" forReason:v47 withResult:6103 withError:0];

    goto LABEL_16;
  }

  currentSetStatus3 = [statusCopy currentSetStatus];
  clientDomainName = [currentSetStatus3 clientDomainName];

  if (clientDomainName)
  {
    currentSetStatus4 = [statusCopy currentSetStatus];
    clientDomainName2 = [currentSetStatus4 clientDomainName];
    objc_opt_class();
    v12 = objc_opt_isKindOfClass();

    if ((v12 & 1) == 0)
    {
      autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM diag];
      v48 = [NSString alloc];
      currentSetStatus5 = [statusCopy currentSetStatus];
      clientDomainName3 = [currentSetStatus5 clientDomainName];
      v51 = objc_opt_class();
      v52 = NSStringFromClass(v51);
      summary2 = [statusCopy summary];
      v54 = [v48 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.clientDomainName of class:%@ | setJobInformation:%@", v52, summary2];
      v55 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CLIENT-DOMAIN-NAME-WRONG-CLASS";
LABEL_27:
      [diag trackAnomaly:v55 forReason:v54 withResult:6103 withError:0];

      goto LABEL_17;
    }

    currentSetStatus6 = [statusCopy currentSetStatus];
    assetSetIdentifier = [currentSetStatus6 assetSetIdentifier];

    if (assetSetIdentifier)
    {
      currentSetStatus7 = [statusCopy currentSetStatus];
      assetSetIdentifier2 = [currentSetStatus7 assetSetIdentifier];
      objc_opt_class();
      v17 = objc_opt_isKindOfClass();

      if (v17)
      {
        autoControlManagerFSM = [statusCopy currentSetStatus];
        downloadProgress = [autoControlManagerFSM downloadProgress];

        if (!downloadProgress)
        {
          v32 = 0;
          goto LABEL_19;
        }

        downloadProgress2 = [autoControlManagerFSM downloadProgress];
        objc_opt_class();
        v21 = objc_opt_isKindOfClass();

        if (v21)
        {
          clientDomainName4 = [autoControlManagerFSM clientDomainName];
          assetSetIdentifier3 = [autoControlManagerFSM assetSetIdentifier];
          diag = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier3];

          v75 = [MANAutoAssetSetStatus alloc];
          clientDomainName5 = [autoControlManagerFSM clientDomainName];
          assetSetIdentifier4 = [autoControlManagerFSM assetSetIdentifier];
          configuredAssetEntries = [autoControlManagerFSM configuredAssetEntries];
          v74 = [configuredAssetEntries copy];
          atomicInstancesDownloaded = [autoControlManagerFSM atomicInstancesDownloaded];
          v97 = [atomicInstancesDownloaded copy];
          mostRecentlyReceivedCachedAssetSetID = [diag mostRecentlyReceivedCachedAssetSetID];
          mostRecentlyReceivedDownloadedFromLive = [diag mostRecentlyReceivedDownloadedFromLive];
          mostRecentlyReceivedLastTimeChecked = [diag mostRecentlyReceivedLastTimeChecked];
          mostRecentlyReceivedPostedDate = [diag mostRecentlyReceivedPostedDate];
          newerAtomicInstanceDiscovered = [autoControlManagerFSM newerAtomicInstanceDiscovered];
          newerDiscoveredAtomicEntries = [autoControlManagerFSM newerDiscoveredAtomicEntries];
          v91 = [newerDiscoveredAtomicEntries copy];
          latestDownloadedAtomicInstance = [autoControlManagerFSM latestDownloadedAtomicInstance];
          v90 = [latestDownloadedAtomicInstance copy];
          latestAtomicInstanceToVendFromPreSUStaging = [diag latestAtomicInstanceToVendFromPreSUStaging];
          latestDowloadedAtomicInstanceEntries = [autoControlManagerFSM latestDowloadedAtomicInstanceEntries];
          v89 = [latestDowloadedAtomicInstanceEntries copy];
          latestToVendCachedAssetSetID = [diag latestToVendCachedAssetSetID];
          latestToVendDownloadedFromLive = [diag latestToVendDownloadedFromLive];
          latestToVendLastTimeChecked = [diag latestToVendLastTimeChecked];
          latestToVendPostedDate = [diag latestToVendPostedDate];
          currentNotifications = [autoControlManagerFSM currentNotifications];
          v84 = [currentNotifications copy];
          currentNeedPolicy = [autoControlManagerFSM currentNeedPolicy];
          v83 = [currentNeedPolicy copy];
          clientDomainName6 = [autoControlManagerFSM clientDomainName];
          assetSetIdentifier5 = [autoControlManagerFSM assetSetIdentifier];
          v82 = [MADAutoAssetScheduler newSetPolicyForDomainName:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier5];
          v67 = +[MADAutoAssetControlManager stagerSetPolicy];
          haveReceivedLookupResponse = [diag haveReceivedLookupResponse];
          vendingAtomicInstanceForConfiguredEntries = [diag vendingAtomicInstanceForConfiguredEntries];
          downloadUserInitiated = [autoControlManagerFSM downloadUserInitiated];
          downloadProgress3 = [autoControlManagerFSM downloadProgress];
          v63 = [downloadProgress3 copy];
          downloadedNetworkBytes = [autoControlManagerFSM downloadedNetworkBytes];
          downloadedFilesystemBytes = [autoControlManagerFSM downloadedFilesystemBytes];
          currentLockUsage = [autoControlManagerFSM currentLockUsage];
          selectorsForStaging = [autoControlManagerFSM selectorsForStaging];
          availableForUseError = [diag availableForUseError];
          newerVersionError = [diag newerVersionError];
          BYTE2(v61) = downloadUserInitiated;
          BYTE1(v61) = vendingAtomicInstanceForConfiguredEntries;
          LOBYTE(v61) = haveReceivedLookupResponse;
          LOBYTE(v60) = latestAtomicInstanceToVendFromPreSUStaging;
          v24Diag = clientDomainName5;
          v31 = v74;
          v32 = [MANAutoAssetSetStatus initStatusForClientDomain:v75 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:clientDomainName5 withAtomicInstancesDownloaded:assetSetIdentifier4 withCatalogCachedAssetSetID:v74 withCatalogDownloadedFromLive:v97 withCatalogLastTimeChecked:mostRecentlyReceivedCachedAssetSetID withCatalogPostedDate:mostRecentlyReceivedDownloadedFromLive withNewerAtomicInstanceDiscovered:mostRecentlyReceivedLastTimeChecked withNewerDiscoveredAtomicEntries:mostRecentlyReceivedPostedDate withLatestDownloadedAtomicInstance:newerAtomicInstanceDiscovered withLatestDownloadedAtomicInstanceFromPreSUStaging:v91 withLatestDowloadedAtomicInstanceEntries:v90 withDownloadedCatalogCachedAssetSetID:v60 withDownloadedCatalogDownloadedFromLive:v89 withDownloadedCatalogLastTimeChecked:latestToVendCachedAssetSetID withDownloadedCatalogPostedDate:latestToVendDownloadedFromLive withCurrentNotifications:latestToVendLastTimeChecked withCurrentNeedPolicy:latestToVendPostedDate withSchedulerPolicy:v84 withStagerPolicy:v83 havingReceivedLookupResponse:v82 vendingAtomicInstanceForConfiguredEntries:v67 withDownloadUserInitiated:v61 withDownloadProgress:v63 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withCurrentLockUsage:currentLockUsage withSelectorsForStaging:selectorsForStaging withAvailableForUseError:availableForUseError withNewerVersionError:newerVersionError];

          v33 = configuredAssetEntries;
        }

        else
        {
          diag = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          v24Diag = [diag diag];
          v58 = [NSString alloc];
          assetSetIdentifier4 = [autoControlManagerFSM downloadProgress];
          v59 = objc_opt_class();
          v33 = NSStringFromClass(v59);
          v31 = [v58 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.currentSetStatus.downloadProgress of class:%@", v33];
          [v24Diag trackAnomaly:@"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-CURRENT-STATUS-DOWNLOAD-PROGRESS-WRONG-CLASS" forReason:v31 withResult:6103 withError:0];
          v32 = 0;
        }

LABEL_18:
LABEL_19:

        goto LABEL_20;
      }

      autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM diag];
      v56 = [NSString alloc];
      currentSetStatus5 = [statusCopy currentSetStatus];
      clientDomainName3 = [currentSetStatus5 assetSetIdentifier];
      v57 = objc_opt_class();
      v52 = NSStringFromClass(v57);
      summary2 = [statusCopy summary];
      v54 = [v56 initWithFormat:@"{_autoAssetSetJobProgressNewValidatedCurrentStatus} setJobInformation.assetSetIdentifier of class:%@ | setJobInformation:%@", v52, summary2];
      v55 = @"AUTO-CONTROL-PROGRESS(from set-job):SET-JOB-INFORMATION-ASSET-SET-IDENTIFIER-WRONG-CLASS";
      goto LABEL_27;
    }
  }

  v32 = 0;
LABEL_20:

  return v32;
}

+ (BOOL)autoSetJobAvailableAtomicInstanceForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  autoControlManagerFSM = [v4 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v4 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __80__MADAutoAssetControlManager_autoSetJobAvailableAtomicInstanceForSetDescriptor___block_invoke;
    block[3] = &unk_4B4478;
    v12 = v4;
    v13 = descriptorCopy;
    v14 = &v16;
    dispatch_sync(extendedStateQueue, block);

    v8 = *(v17 + 24);
  }

  else
  {
    v9 = _MADLog(@"AutoSet");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoSetJobAvailableAtomicInstanceForSetDescriptor}: Returning no for atomicInstanceAvailable since FSM is not initialized", buf, 2u);
    }

    v8 = *(v17 + 24);
  }

  _Block_object_dispose(&v16, 8);

  return v8 & 1;
}

void __80__MADAutoAssetControlManager_autoSetJobAvailableAtomicInstanceForSetDescriptor___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = [*(a1 + 40) clientDomainName];
  v4 = [*(a1 + 40) assetSetIdentifier];
  v7 = [v2 locateSetConfigurationByClientDomain:v3 forAssetSetIdentifier:v4];

  v5 = v7;
  if (v7)
  {
    v6 = [v7 latestAtomicInstanceToVend];
    *(*(*(a1 + 48) + 8) + 24) = v6 != 0;

    v5 = v7;
  }
}

+ (void)autoAssetJobIssueReply:(id)reply forAutoAssetSelector:(id)selector withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withOriginalSelector:(id)originalSelector withJobInformation:(id)information withResponseError:(id)error
{
  replyCopy = reply;
  informationCopy = information;
  errorCopy = error;
  originalSelectorCopy = originalSelector;
  jobCopy = job;
  dCopy = d;
  selectorCopy = selector;
  v36 = +[MADAutoAssetControlManager autoControlManager];
  v19 = objc_alloc_init(NSMutableDictionary);
  if (!errorCopy)
  {
    clientInstance = [informationCopy clientInstance];
    [v19 setSafeObject:clientInstance forKey:@"instance"];

    foundContent = [informationCopy foundContent];
    [v19 setSafeObject:foundContent forKey:@"found"];

    clientDesire = [informationCopy clientDesire];
    [v19 setSafeObject:clientDesire forKey:@"desire"];
  }

  v37 = informationCopy;
  v23 = [SUCoreConnectMessage alloc];
  clientRequestMessage = [replyCopy clientRequestMessage];
  v25 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientID = [replyCopy clientID];
  v27 = [v23 initWithType:2 messageName:v25 clientID:clientID version:0 message:v19];

  if (v27)
  {
    [replyCopy setResponseMessage:v27];
  }

  else
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
    {
      v29 = [MADAutoAssetClientRequest responseErrorSummary:errorCopy];
      *buf = 138543362;
      v39 = v29;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{autoAssetJobIssueReply} | unable to build response message | error:%{public}@", buf, 0xCu);
    }
  }

  v30 = [MADAutoAssetControlManagerParam alloc];
  clientReplyCompletion = [replyCopy clientReplyCompletion];
  v32 = [(MADAutoAssetControlManagerParam *)v30 initForJobIssueReply:clientReplyCompletion forAutoAssetSelector:selectorCopy withAutoAssetUUID:dCopy withResponseMessage:v27 withResponseError:errorCopy];

  [v32 setClientRequest:replyCopy];
  [v32 setFromAutoAssetJob:jobCopy];

  [v32 setOriginalSelector:originalSelectorCopy];
  [v32 setJobInformation:v37];
  [v32 updateSafeSummary];
  autoControlManagerFSM = [v36 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobIssueClientReply" withInfo:v32];
}

+ (void)autoSetJobIssueReply:(id)reply forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error
{
  replyCopy = reply;
  nameCopy = name;
  identifierCopy = identifier;
  dCopy = d;
  jobCopy = job;
  informationCopy = information;
  errorCopy = error;
  v27.opaque[0] = 0;
  v27.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobIssueReply", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v27);

  v22 = [MADAutoAssetControlManager autoControlManager:v27.opaque[0]];
  v23 = [MADAutoAssetControlManagerParam alloc];
  clientReplyCompletion = [replyCopy clientReplyCompletion];
  v25 = [(MADAutoAssetControlManagerParam *)v23 initForSetJobIssueReply:clientReplyCompletion forDomainName:nameCopy forAssetSetIdentifier:identifierCopy withAutoAssetUUID:dCopy withSetJobInformation:informationCopy withResponseError:errorCopy];

  [v25 setClientRequest:replyCopy];
  [v25 setFromAutoAssetJob:jobCopy];
  autoControlManagerFSM = [v22 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SetJobIssueClientReply" withInfo:v25];

  os_activity_scope_leave(&v27);
}

+ (void)autoSetJobSchedulerNoClientFoundSame:(id)same forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error
{
  sameCopy = same;
  nameCopy = name;
  identifierCopy = identifier;
  dCopy = d;
  jobCopy = job;
  informationCopy = information;
  errorCopy = error;
  v25.opaque[0] = 0;
  v25.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobSchedulerNoClientFoundSame", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v25);

  v22 = [MADAutoAssetControlManager autoControlManager:v25.opaque[0]];
  v23 = [[MADAutoAssetControlManagerParam alloc] initForSetJobSchedulerNoClientFoundSame:sameCopy forDomainName:nameCopy forAssetSetIdentifier:identifierCopy withAutoAssetUUID:dCopy withSetJobInformation:informationCopy withResponseError:errorCopy];
  [v23 setFromAutoAssetJob:jobCopy];
  autoControlManagerFSM = [v22 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SetJobSchedulerFoundSame" withInfo:v23];

  os_activity_scope_leave(&v25);
}

+ (void)autoSetJobSchedulerNoClientDownloaded:(id)downloaded forDomainName:(id)name forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information withResponseError:(id)error
{
  downloadedCopy = downloaded;
  nameCopy = name;
  identifierCopy = identifier;
  dCopy = d;
  jobCopy = job;
  informationCopy = information;
  errorCopy = error;
  v25.opaque[0] = 0;
  v25.opaque[1] = 0;
  v21 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobSchedulerNoClientDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v21, &v25);

  v22 = [MADAutoAssetControlManager autoControlManager:v25.opaque[0]];
  v23 = [[MADAutoAssetControlManagerParam alloc] initForSetJobSchedulerNoClientDownloaded:downloadedCopy forDomainName:nameCopy forAssetSetIdentifier:identifierCopy withAutoAssetUUID:dCopy withSetJobInformation:informationCopy withResponseError:errorCopy];
  [v23 setFromAutoAssetJob:jobCopy];
  autoControlManagerFSM = [v22 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SetJobSchedulerDownloaded" withInfo:v23];

  os_activity_scope_leave(&v25);
}

+ (void)autoJobAssetSetIDsForJob:(id)job mostRecentlyReceived:(id *)received latestToVend:(id *)vend
{
  jobCopy = job;
  v8 = +[MADAutoAssetControlManager autoControlManager];
  v22 = 0;
  v23 = &v22;
  v24 = 0x3032000000;
  v25 = __Block_byref_object_copy__12;
  v26 = __Block_byref_object_dispose__12;
  v27 = 0;
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  autoControlManagerFSM = [v8 autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __89__MADAutoAssetControlManager_autoJobAssetSetIDsForJob_mostRecentlyReceived_latestToVend___block_invoke;
  block[3] = &unk_4B44A0;
  v14 = &v22;
  v11 = jobCopy;
  v13 = v11;
  v15 = &v16;
  dispatch_sync(extendedStateQueue, block);

  if (received)
  {
    *received = v23[5];
  }

  if (vend)
  {
    *vend = v17[5];
  }

  _Block_object_dispose(&v16, 8);
  _Block_object_dispose(&v22, 8);
}

uint64_t __89__MADAutoAssetControlManager_autoJobAssetSetIDsForJob_mostRecentlyReceived_latestToVend___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) mostRecentlyReceivedCachedAssetSetID];
  v3 = *(*(a1 + 40) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;

  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) latestToVendCachedAssetSetID];

  return _objc_release_x1();
}

+ (void)autoAssetStagerSetJobDetermineDone:(id)done withBaseForStagingDescriptors:(id)descriptors withDetermineError:(id)error
{
  doneCopy = done;
  descriptorsCopy = descriptors;
  errorCopy = error;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetStagerSetJobDetermineDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobLookupResults:doneCopy withBaseForStagingDescriptors:descriptorsCopy withDetermineError:errorCopy];
  [v12 updateSafeSummary];
  autoControlManagerFSM = [v11 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerDetermineDone" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)autoAssetStagerJobDownloadDone:(id)done withDownloadedDescriptor:(id)descriptor withDownloadError:(id)error
{
  doneCopy = done;
  descriptorCopy = descriptor;
  errorCopy = error;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetStagerJobDownloadDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobInformation:errorCopy];
  [v12 setJobInformation:doneCopy];
  [v12 setDownloadingDescriptor:descriptorCopy];
  [v12 updateSafeSummary];
  autoControlManagerFSM = [v11 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerDownloadDone" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)autoAssetJobFinished:(id)finished withAutoAssetUUID:(id)d schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure
{
  failureCopy = failure;
  involvedCopy = involved;
  finishedCopy = finished;
  dCopy = d;
  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &v15);

  v12 = [MADAutoAssetControlManager autoControlManager:v15.opaque[0]];
  v13 = [[MADAutoAssetControlManagerParam alloc] initForFinishedJobSelector:finishedCopy withAutoAssetUUID:dCopy withSchedulerInvolved:involvedCopy withPotentialNetworkFailure:failureCopy];
  autoControlManagerFSM = [v12 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobFinished" withInfo:v13];

  os_activity_scope_leave(&v15);
}

+ (void)autoSetJobFinished:(id)finished forAssetSetIdentifier:(id)identifier withAutoAssetUUID:(id)d fromAutoAssetJob:(id)job withSetJobInformation:(id)information schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure
{
  involvedCopy = involved;
  finishedCopy = finished;
  identifierCopy = identifier;
  dCopy = d;
  jobCopy = job;
  informationCopy = information;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v19 = _os_activity_create(&dword_0, "MADAutoControl:autoSetJobFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v19, &state);

  v20 = +[MADAutoAssetControlManager autoControlManager];
  LOBYTE(v23) = failure;
  v21 = [[MADAutoAssetControlManagerParam alloc] initForFinishedSetJob:finishedCopy forAssetSetIdentifier:identifierCopy withSetAtomicInstance:dCopy withAutoAssetUUID:dCopy withSetJobInformation:informationCopy withSchedulerInvolved:involvedCopy withPotentialNetworkFailure:v23];
  [v21 setFromAutoAssetJob:jobCopy];
  autoControlManagerFSM = [v20 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobFinished" withInfo:v21];

  os_activity_scope_leave(&state);
}

+ (void)autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger:(id)trigger
{
  triggerCopy = trigger;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobCoalescePostedToFinishedSetSchedulerTrigger", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:triggerCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SetJobFinishedRerouteScheduled" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger:(id)trigger
{
  triggerCopy = trigger;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:autoAssetJobCoalescePostedToFinishedSingletonSchedulerTrigger", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:triggerCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"JobFinishedRerouteScheduled" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerRequestAlreadyDownloadedDescriptors
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:stagerRequestAlreadyDownloadedDescriptors", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  autoControlManagerFSM = [v3 autoControlManagerFSM];
  v5 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"stagerRequestAlreadyDownloadedDescriptors"];
  [autoControlManagerFSM postEvent:@"StagerAlreadyDownloaded" withInfo:v5];

  os_activity_scope_leave(&v6);
}

+ (void)stagerStartSetJobDetermineIfAvailable:(id)available withAssetTargetOSVersion:(id)version withAssetTargetBuildVersion:(id)buildVersion withAssetTargetTrainName:(id)name withAssetTargetRestoreVersion:(id)restoreVersion
{
  availableCopy = available;
  versionCopy = version;
  buildVersionCopy = buildVersion;
  nameCopy = name;
  restoreVersionCopy = restoreVersion;
  v20.opaque[0] = 0;
  v20.opaque[1] = 0;
  v16 = _os_activity_create(&dword_0, "MADAutoControl:stagerStartSetJobDetermineIfAvailable", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v16, &v20);

  v17 = [MADAutoAssetControlManager autoControlManager:v20.opaque[0]];
  v18 = [[MADAutoAssetControlManagerParam alloc] initForStagerSetJobStart:availableCopy withAssetTargetOSVersion:versionCopy withAssetTargetBuildVersion:buildVersionCopy withAssetTargetTrainName:nameCopy withAssetTargetRestoreVersion:restoreVersionCopy];
  autoControlManagerFSM = [v17 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerStartDetermine" withInfo:v18];

  os_activity_scope_leave(&v20);
}

+ (void)stagerStartJobDownloadForStaging:(id)staging withStagerSetConfiguration:(id)configuration usingCachedAutoAssetCatalog:(id)catalog usingBaseForPatching:(id)patching withAssetTargetOSVersion:(id)version withAssetTargetBuildVersion:(id)buildVersion
{
  stagingCopy = staging;
  configurationCopy = configuration;
  catalogCopy = catalog;
  patchingCopy = patching;
  versionCopy = version;
  buildVersionCopy = buildVersion;
  v23.opaque[0] = 0;
  v23.opaque[1] = 0;
  v19 = _os_activity_create(&dword_0, "MADAutoControl:stagerStartJobDownloadForStaging", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v19, &v23);

  v20 = [MADAutoAssetControlManager autoControlManager:v23.opaque[0]];
  v21 = [[MADAutoAssetControlManagerParam alloc] initForStagerJobStart:stagingCopy withStagerSetConfiguration:configurationCopy usingCachedAutoAssetCatalog:catalogCopy usingBaseForPatching:patchingCopy withAssetTargetOSVersion:versionCopy withAssetTargetBuildVersion:buildVersionCopy];
  autoControlManagerFSM = [v20 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerStartDownload" withInfo:v21];

  os_activity_scope_leave(&v23);
}

+ (void)stagerCancelCurrentJob
{
  v6.opaque[0] = 0;
  v6.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:stagerCancelCurrentJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v6);

  v3 = [MADAutoAssetControlManager autoControlManager:v6.opaque[0]];
  autoControlManagerFSM = [v3 autoControlManagerFSM];
  v5 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"stagerCancelCurrentJob"];
  [autoControlManagerFSM postEvent:@"StagerCancelCurrentJob" withInfo:v5];

  os_activity_scope_leave(&v6);
}

+ (void)stagerEliminatedSelector:(id)selector
{
  selectorCopy = selector;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerEliminatedSelector", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:selectorCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerEliminatedSelector" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerEliminatedSetConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerEliminatedSetConfiguration", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForSetConfiguration:configurationCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerEliminatedConfiguration" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)stagerPurgeStagedContent:(id)content
{
  contentCopy = content;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:stagerPurgeStagedContent", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAutoAssetDescriptors:contentCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"StagerPurgeStagedContent" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)schedulerTriggeredSelectors:(id)selectors
{
  selectorsCopy = selectors;
  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredSelectors", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v9);

  v5 = [MADAutoAssetControlManager autoControlManager:v9.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredSelectors" UTF8String];
  v6 = os_transaction_create();
  v7 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredSelectors:selectorsCopy withEventOSTransaction:v6];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerTriggered" withInfo:v7];

  os_activity_scope_leave(&v9);
}

+ (void)schedulerTriggeredSets:(id)sets
{
  setsCopy = sets;
  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredSets", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v9);

  v5 = [MADAutoAssetControlManager autoControlManager:v9.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredSets" UTF8String];
  v6 = os_transaction_create();
  v7 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredSets:setsCopy withEventOSTransaction:v6];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerSetsTriggered" withInfo:v7];

  os_activity_scope_leave(&v9);
}

+ (void)schedulerTriggeredNoActivity
{
  v7.opaque[0] = 0;
  v7.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTriggeredNoActivity", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v7);

  v3 = [MADAutoAssetControlManager autoControlManager:v7.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTriggeredNoActivity" UTF8String];
  v4 = os_transaction_create();
  v5 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredNoActivity:v4];
  autoControlManagerFSM = [v3 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerNoActivity" withInfo:v5];

  os_activity_scope_leave(&v7);
}

+ (void)schedulerTickOccurred
{
  v7.opaque[0] = 0;
  v7.opaque[1] = 0;
  v2 = _os_activity_create(&dword_0, "MADAutoControl:schedulerTickOccurred", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v2, &v7);

  v3 = [MADAutoAssetControlManager autoControlManager:v7.opaque[0]];
  [@"com.apple.MobileAsset.AutoControlManager.schedulerTickOccurred" UTF8String];
  v4 = os_transaction_create();
  v5 = [[MADAutoAssetControlManagerParam alloc] initForTriggeredNoActivity:v4];
  autoControlManagerFSM = [v3 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerTickOccurred" withInfo:v5];

  os_activity_scope_leave(&v7);
}

+ (void)schedulerEliminatedSelector:(id)selector
{
  selectorCopy = selector;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerEliminatedSelector", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:selectorCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerEliminatedSelector" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)schedulerEliminatedSetDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  nameCopy = name;
  identifierCopy = identifier;
  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:schedulerEliminatedSetDomainName", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v13);

  v8 = [MAAutoAssetSelector alloc];
  v9 = [v8 initForAssetType:nameCopy withAssetSpecifier:{identifierCopy, v13.opaque[0], v13.opaque[1]}];
  v10 = +[MADAutoAssetControlManager autoControlManager];
  v11 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v9];
  autoControlManagerFSM = [v10 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SchedulerEliminatedSelector" withInfo:v11];

  os_activity_scope_leave(&v13);
}

- (BOOL)schedulerReferencesDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:schedulerReferencesDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v20 = 0u;
  v21 = 0u;
  v18 = 0u;
  obj = v19 = 0u;
  v5 = [obj countByEnumeratingWithState:&v18 objects:v23 count:16];
  if (v5)
  {
    v17 = *v19;
    do
    {
      for (i = 0; i != v5; i = i + 1)
      {
        if (*v19 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v7 = *(*(&v18 + 1) + 8 * i);
        assetSelector = [v7 assetSelector];
        assetType = [assetSelector assetType];
        assetType2 = [descriptorCopy assetType];
        if (([SUCore stringIsEqual:assetType to:assetType2]& 1) != 0)
        {
          assetSelector2 = [v7 assetSelector];
          assetSpecifier = [assetSelector2 assetSpecifier];
          assetSpecifier2 = [descriptorCopy assetSpecifier];
          v14 = [SUCore stringIsEqual:assetSpecifier to:assetSpecifier2];

          if (v14)
          {
            LOBYTE(v5) = 1;
            goto LABEL_12;
          }
        }

        else
        {
        }
      }

      v5 = [obj countByEnumeratingWithState:&v18 objects:v23 count:16];
    }

    while (v5);
  }

LABEL_12:

  os_activity_scope_leave(&state);
  return v5;
}

+ (void)secureOperationsFinished:(id)finished forSetDescriptor:(id)descriptor forAutoAssetDescriptors:(id)descriptors
{
  finishedCopy = finished;
  descriptorCopy = descriptor;
  descriptorsCopy = descriptors;
  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureOperationsFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v14);

  v11 = [MADAutoAssetControlManager autoControlManager:v14.opaque[0]];
  v12 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:finishedCopy forSetDescriptor:descriptorCopy forAutoAssetDescriptors:descriptorsCopy];
  autoControlManagerFSM = [v11 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"SecureOperationsFinished" withInfo:v12];

  os_activity_scope_leave(&v14);
}

+ (void)handleReceivedPushNotifications:(id)notifications
{
  notificationsCopy = notifications;
  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:handleReceivedPushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &v8);

  v5 = [MADAutoAssetControlManager autoControlManager:v8.opaque[0]];
  v6 = [[MADAutoAssetControlManagerParam alloc] initForReceivedPushNotifications:notificationsCopy];
  autoControlManagerFSM = [v5 autoControlManagerFSM];
  [autoControlManagerFSM postEvent:@"PushNotificationReceived" withInfo:v6];

  os_activity_scope_leave(&v8);
}

+ (void)postNotificationName:(id)name forAssetType:(id)type forAssetSpecifier:(id)specifier fromModule:(id)module fromLocation:(id)location
{
  nameCopy = name;
  typeCopy = type;
  specifierCopy = specifier;
  moduleCopy = module;
  locationCopy = location;
  if (specifierCopy)
  {
    specifierCopy = [[NSString alloc] initWithFormat:@" | assetSpecifier:%@", specifierCopy];
  }

  else
  {
    specifierCopy = &stru_4BD3F0;
  }

  if (objc_opt_respondsToSelector() & 1) != 0 && (objc_opt_respondsToSelector())
  {
    v17 = [MAAutoAssetNotifications notifyRegistrationName:nameCopy forAssetType:typeCopy];
    v18 = notify_post([v17 UTF8String]);
    v19 = v18;
    if (specifierCopy)
    {
      v20 = [MAAutoAssetNotifications notifyRegistrationName:nameCopy forAssetType:typeCopy forAssetSpecifier:specifierCopy];

      v17 = v20;
      v21 = notify_post([v20 UTF8String]);
      if (v19 | v21)
      {
        v22 = v21;
        v23 = _MADLog(@"Auto");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          *buf = 138545666;
          v29 = @">----->";
          v30 = 2114;
          v31 = locationCopy;
          v32 = 2114;
          v33 = @"P_ERR";
          v34 = 2114;
          v35 = nameCopy;
          v36 = 2114;
          v37 = @"P_ERR";
          v38 = 2114;
          v39 = typeCopy;
          v40 = 2114;
          v41 = specifierCopy;
          v42 = 2048;
          v43 = v19;
          v44 = 2048;
          v45 = v22;
          v46 = 2114;
          v47 = @"<-----<";
          v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@%{public}@ | result:%lu specifierResult:%lu\n#_NOTIF:%{public}@";
          v25 = v23;
          v26 = OS_LOG_TYPE_ERROR;
          v27 = 102;
LABEL_18:
          _os_log_impl(&dword_0, v25, v26, v24, buf, v27);
        }

LABEL_19:

        goto LABEL_20;
      }
    }

    else if (v18)
    {
      v23 = _MADLog(@"Auto");
      if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_19;
      }

      *buf = 138545154;
      v29 = @">----->";
      v30 = 2114;
      v31 = locationCopy;
      v32 = 2114;
      v33 = @"P_ERR";
      v34 = 2114;
      v35 = nameCopy;
      v36 = 2114;
      v37 = @"P_ERR";
      v38 = 2114;
      v39 = typeCopy;
      v40 = 2048;
      v41 = v19;
      v42 = 2114;
      v43 = @"<-----<";
      v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@ | result:%lu\n#_NOTIF:%{public}@";
      v25 = v23;
      v26 = OS_LOG_TYPE_ERROR;
LABEL_17:
      v27 = 82;
      goto LABEL_18;
    }

    v23 = _MADLog(@"Auto");
    if (!os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_19;
    }

    *buf = 138545154;
    v29 = @">----->";
    v30 = 2114;
    v31 = locationCopy;
    v32 = 2114;
    v33 = @"EVENT";
    v34 = 2114;
    v35 = nameCopy;
    v36 = 2114;
    v37 = @"EVENT";
    v38 = 2114;
    v39 = typeCopy;
    v40 = 2114;
    v41 = specifierCopy;
    v42 = 2114;
    v43 = @"<-----<";
    v24 = "AUTO-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) assetType:%{public}@%{public}@\n#_NOTIF:%{public}@";
    v25 = v23;
    v26 = OS_LOG_TYPE_DEFAULT;
    goto LABEL_17;
  }

  v17 = _MADLog(@"Auto");
  if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545154;
    v29 = @">----->";
    v30 = 2114;
    v31 = locationCopy;
    v32 = 2114;
    v33 = @"EVENT";
    v34 = 2114;
    v35 = nameCopy;
    v36 = 2114;
    v37 = @"EVENT";
    v38 = 2114;
    v39 = typeCopy;
    v40 = 2114;
    v41 = specifierCopy;
    v42 = 2114;
    v43 = @"<-----<";
    _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL\n!_NOTIF:%{public}@ {%{public}@:postNotificationName}\n!_NOTIF:(%{public}@) un-posted notification:%{public}@\n!_NOTIF:(%{public}@) assetType:%{public}@%{public}@\n!_NOTIF:%{public}@", buf, 0x52u);
  }

LABEL_20:
}

+ (void)postSetNotificationName:(id)name forClientDomainName:(id)domainName forAssetSetIdentifier:(id)identifier forAtomicInstanceUUID:(id)d fromModule:(id)module fromLocation:(id)location
{
  nameCopy = name;
  domainNameCopy = domainName;
  identifierCopy = identifier;
  dCopy = d;
  locationCopy = location;
  v17 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v17 autoControlManagerFSM];

  if (!autoControlManagerFSM)
  {
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138412546;
      v30 = nameCopy;
      v31 = 2112;
      v32 = domainNameCopy;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "AUTO-SET-CONTROL: Not posting notification %@ for clientDomain %@ since FSM is not initialized", buf, 0x16u);
    }

    goto LABEL_6;
  }

  if (v17)
  {
    autoControlManagerFSM2 = [v17 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v22[0] = _NSConcreteStackBlock;
    v22[1] = 3221225472;
    v22[2] = __142__MADAutoAssetControlManager_postSetNotificationName_forClientDomainName_forAssetSetIdentifier_forAtomicInstanceUUID_fromModule_fromLocation___block_invoke;
    v22[3] = &unk_4B3818;
    v23 = nameCopy;
    v24 = v17;
    v25 = domainNameCopy;
    v26 = identifierCopy;
    v27 = dCopy;
    v28 = locationCopy;
    dispatch_async(extendedStateQueue, v22);

    v21 = v23;
LABEL_6:
  }
}

void __142__MADAutoAssetControlManager_postSetNotificationName_forClientDomainName_forAssetSetIdentifier_forAtomicInstanceUUID_fromModule_fromLocation___block_invoke(uint64_t a1)
{
  v2 = [MANAutoAssetSetNotifications notifyRegistrationName:*(a1 + 32)];
  v3 = [*(a1 + 40) locateSetConfigurationByClientDomain:*(a1 + 48) forAssetSetIdentifier:*(a1 + 56)];
  v4 = [NSString alloc];
  v5 = v4;
  if (v3)
  {
    if (*(a1 + 64))
    {
      v6 = *(a1 + 64);
    }

    else
    {
      v6 = @"N";
    }

    v7 = [v3 summary];
    v8 = [v5 initWithFormat:@" atomicInstanceUUID:%@ | setConfiguration:%@", v6, v7];
  }

  else
  {
    v9 = @"N";
    v10 = *(a1 + 48);
    if (!v10)
    {
      v10 = @"N";
    }

    if (*(a1 + 56))
    {
      v9 = *(a1 + 56);
    }

    v8 = [v4 initWithFormat:@" clientDomainName:%@ | assetSetIdentifier:%@", v10, v9];
  }

  v11 = notify_post([v2 UTF8String]);
  if (*(a1 + 56))
  {
    v12 = [MANAutoAssetSetNotifications notifyRegistrationName:*(a1 + 32) forAssetSetIdentifier:?];

    v13 = notify_post([v12 UTF8String]);
    v2 = v12;
  }

  else
  {
    v13 = 0;
  }

  if (v11 | v13)
  {
    v20 = *(a1 + 56);
    v14 = _MADLog(@"Auto");
    v21 = os_log_type_enabled(v14, OS_LOG_TYPE_ERROR);
    if (v20)
    {
      if (v21)
      {
        v22 = *(a1 + 72);
        v23 = *(a1 + 32);
        *buf = 138545410;
        v28 = @">----->";
        v29 = 2114;
        v30 = v22;
        v31 = 2114;
        v32 = @"P_ERR";
        v33 = 2114;
        v34 = v23;
        v35 = 2114;
        v36 = v8;
        v37 = 2114;
        v38 = @"P_ERR";
        v39 = 2048;
        v40 = v11;
        v41 = 2048;
        v42 = v13;
        v43 = 2114;
        v44 = @"<-----<";
        v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@)%{public}@ | result:%lu specifierResult:%lu\n#_NOTIF:%{public}@";
        v18 = v14;
        v19 = OS_LOG_TYPE_ERROR;
        v24 = 92;
LABEL_23:
        _os_log_impl(&dword_0, v18, v19, v17, buf, v24);
      }
    }

    else if (v21)
    {
      v25 = *(a1 + 72);
      v26 = *(a1 + 32);
      *buf = 138544898;
      v28 = @">----->";
      v29 = 2114;
      v30 = v25;
      v31 = 2114;
      v32 = @"P_ERR";
      v33 = 2114;
      v34 = v26;
      v35 = 2114;
      v36 = @"P_ERR";
      v37 = 2048;
      v38 = v11;
      v39 = 2114;
      v40 = @"<-----<";
      v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@) | result:%lu\n#_NOTIF:%{public}@";
      v18 = v14;
      v19 = OS_LOG_TYPE_ERROR;
      goto LABEL_22;
    }
  }

  else
  {
    v14 = _MADLog(@"Auto");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      v15 = *(a1 + 72);
      v16 = *(a1 + 32);
      *buf = 138544898;
      v28 = @">----->";
      v29 = 2114;
      v30 = v15;
      v31 = 2114;
      v32 = @"EVENT";
      v33 = 2114;
      v34 = v16;
      v35 = 2114;
      v36 = @"EVENT";
      v37 = 2114;
      v38 = v8;
      v39 = 2114;
      v40 = @"<-----<";
      v17 = "AUTO-SET-CONTROL\n#_NOTIF:%{public}@ {%{public}@:postNotificationName}\n#_NOTIF:(%{public}@) posting notification:%{public}@\n#_NOTIF:(%{public}@)%{public}@\n#_NOTIF:%{public}@";
      v18 = v14;
      v19 = OS_LOG_TYPE_DEFAULT;
LABEL_22:
      v24 = 72;
      goto LABEL_23;
    }
  }
}

+ (void)copyCurrentDownloadedDescriptors:(BOOL)descriptors unlockedUnreferencedDescriptors:(id *)unreferencedDescriptors unlockedReferencedDescriptors:(id *)referencedDescriptors lockedOverridableDescriptors:(id *)overridableDescriptors lockedNeverRemoveDescriptors:(id *)removeDescriptors stagedDescriptors:(id *)stagedDescriptors
{
  v13 = +[MADAutoAssetControlManager autoControlManager];
  v50 = 0;
  v51 = &v50;
  v52 = 0x3032000000;
  v53 = __Block_byref_object_copy__12;
  v54 = __Block_byref_object_dispose__12;
  v55 = objc_alloc_init(NSMutableDictionary);
  v44 = 0;
  v45 = &v44;
  v46 = 0x3032000000;
  v47 = __Block_byref_object_copy__12;
  v48 = __Block_byref_object_dispose__12;
  v49 = objc_alloc_init(NSMutableDictionary);
  v38 = 0;
  v39 = &v38;
  v40 = 0x3032000000;
  v41 = __Block_byref_object_copy__12;
  v42 = __Block_byref_object_dispose__12;
  v43 = objc_alloc_init(NSMutableDictionary);
  v32 = 0;
  v33 = &v32;
  v34 = 0x3032000000;
  v35 = __Block_byref_object_copy__12;
  v36 = __Block_byref_object_dispose__12;
  v37 = objc_alloc_init(NSMutableDictionary);
  v26 = 0;
  v27 = &v26;
  v28 = 0x3032000000;
  v29 = __Block_byref_object_copy__12;
  v30 = __Block_byref_object_dispose__12;
  v31 = objc_alloc_init(NSMutableDictionary);
  autoControlManagerFSM = [v13 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v13 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v18[0] = _NSConcreteStackBlock;
    v18[1] = 3221225472;
    v18[2] = __201__MADAutoAssetControlManager_copyCurrentDownloadedDescriptors_unlockedUnreferencedDescriptors_unlockedReferencedDescriptors_lockedOverridableDescriptors_lockedNeverRemoveDescriptors_stagedDescriptors___block_invoke;
    v18[3] = &unk_4B44C8;
    v19 = v13;
    v20 = &v44;
    v21 = &v50;
    v22 = &v32;
    v23 = &v38;
    v24 = &v26;
    dispatch_sync(extendedStateQueue, v18);

    if (unreferencedDescriptors)
    {
      *unreferencedDescriptors = v51[5];
    }

    if (referencedDescriptors)
    {
      *referencedDescriptors = v45[5];
    }

    if (overridableDescriptors)
    {
      *overridableDescriptors = v39[5];
    }

    if (removeDescriptors)
    {
      *removeDescriptors = v33[5];
    }

    if (stagedDescriptors)
    {
      *stagedDescriptors = v27[5];
    }

    v17 = v19;
  }

  else
  {
    v17 = _MADLog(@"Auto");
    if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{copyCurrentDownloadedDescriptors} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }

  _Block_object_dispose(&v26, 8);
  _Block_object_dispose(&v32, 8);

  _Block_object_dispose(&v38, 8);
  _Block_object_dispose(&v44, 8);

  _Block_object_dispose(&v50, 8);
}

void __201__MADAutoAssetControlManager_copyCurrentDownloadedDescriptors_unlockedUnreferencedDescriptors_unlockedReferencedDescriptors_lockedOverridableDescriptors_lockedNeverRemoveDescriptors_stagedDescriptors___block_invoke(uint64_t a1)
{
  v31 = +[MADAutoAssetLocker copyOfLocksBySelector];
  v2 = objc_alloc_init(NSMutableArray);
  [*(a1 + 32) ensureStagerFullyResumed];
  v28 = v2;
  [MADAutoAssetStager extendSummaryWithStagedAssets:v2 basedOnControl:0];
  v32 = a1;
  [*(a1 + 32) locateDownloadedNewAllBySelector];
  v33 = 0u;
  v34 = 0u;
  v35 = 0u;
  v3 = v36 = 0u;
  v4 = [v3 countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (v4)
  {
    v5 = v4;
    v29 = a1 + 48;
    v30 = a1 + 40;
    v6 = *v34;
    do
    {
      for (i = 0; i != v5; i = i + 1)
      {
        if (*v34 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v8 = *(*(&v33 + 1) + 8 * i);
        v9 = objc_autoreleasePoolPush();
        v10 = [v3 safeObjectForKey:v8 ofClass:objc_opt_class()];
        if (v10)
        {
          v11 = [MAAutoAssetSelector alloc];
          v12 = [v10 assetType];
          v13 = [v10 assetSpecifier];
          v14 = [v10 assetVersion];
          v15 = [v11 initForAssetType:v12 withAssetSpecifier:v13 matchingAssetVersion:v14];

          v16 = [v15 persistedEntryID];
          v17 = [v31 safeObjectForKey:v16 ofClass:objc_opt_class()];
          v18 = v17;
          if (v17)
          {
            v19 = [v17 inhibitedFromEmergencyRemoval];
            v20 = 64;
            if (v19)
            {
              v20 = 56;
            }

            v21 = v32 + v20;
          }

          else
          {
            v22 = [*(v32 + 32) setConfigurationReferencesDescriptor:v10];
            v21 = v30;
            if ((v22 & 1) == 0)
            {
              v23 = [*(v32 + 32) schedulerReferencesDescriptor:v10];
              v21 = v30;
              if ((v23 & 1) == 0)
              {
                v24 = [v10 foundByLookupWithoutAssetVersion];
                v21 = v29;
                if (!v24)
                {
                  v21 = v30;
                }
              }
            }
          }

          [*(*(*v21 + 8) + 40) setSafeObject:v10 forKey:v16];
        }

        objc_autoreleasePoolPop(v9);
      }

      v5 = [v3 countByEnumeratingWithState:&v33 objects:v37 count:16];
    }

    while (v5);
  }

  [*(v32 + 32) ensureStagerFullyResumed];
  v25 = +[MADAutoAssetStager controlCopyCurrentStagedDescriptors];
  v26 = *(*(v32 + 72) + 8);
  v27 = *(v26 + 40);
  *(v26 + 40) = v25;
}

+ (BOOL)assetBeingGarbageCollected:(id)collected atEmergencyUrgency:(BOOL)urgency
{
  collectedCopy = collected;
  v6 = +[MADAutoAssetControlManager autoControlManager];
  v36 = 0;
  v37 = &v36;
  v38 = 0x3032000000;
  v39 = __Block_byref_object_copy__12;
  v40 = __Block_byref_object_dispose__12;
  v41 = 0;
  v32 = 0;
  v33 = &v32;
  v34 = 0x2020000000;
  v35 = 0;
  v7 = [MAAutoAssetSelector alloc];
  assetType = [collectedCopy assetType];
  assetSpecifier = [collectedCopy assetSpecifier];
  assetVersion = [collectedCopy assetVersion];
  v11 = [v7 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  autoControlManagerFSM = [v6 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v6 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v21 = _NSConcreteStackBlock;
    v22 = 3221225472;
    v23 = __76__MADAutoAssetControlManager_assetBeingGarbageCollected_atEmergencyUrgency___block_invoke;
    v24 = &unk_4B44F0;
    v25 = v6;
    urgencyCopy = urgency;
    v26 = v11;
    v28 = &v36;
    v29 = &v32;
    v15 = collectedCopy;
    v27 = v15;
    dispatch_sync(extendedStateQueue, &v21);

    if (v37[5])
    {
      if (*(v33 + 24) != 1)
      {
LABEL_10:
        v19 = v37[5];

        goto LABEL_11;
      }

      assetType2 = [v15 assetType];
      assetSpecifier2 = [v15 assetSpecifier];
      [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_RECLAIM_DESIRED" forAssetType:assetType2 forAssetSpecifier:assetSpecifier2 fromModule:@"CACHE-DELETE" fromLocation:@"assetBeingGarbageCollected"];
    }

    else
    {
      assetType2 = [v15 assetType];
      assetSpecifier2 = [v15 assetSpecifier];
      [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_RECLAIMED" forAssetType:assetType2 forAssetSpecifier:assetSpecifier2 fromModule:@"CACHE-DELETE" fromLocation:@"assetBeingGarbageCollected"];
    }

    goto LABEL_10;
  }

  v18 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{assetBeingGarbageCollected} Skipping operation since FSM is not initialized", buf, 2u);
  }

  v19 = v37[5];
LABEL_11:

  _Block_object_dispose(&v32, 8);
  _Block_object_dispose(&v36, 8);

  return v19 == 0;
}

void __76__MADAutoAssetControlManager_assetBeingGarbageCollected_atEmergencyUrgency___block_invoke(uint64_t a1)
{
  v2 = +[MADAutoAssetLocker copyOfLocksBySelector];
  [*(a1 + 32) locateDownloadedNewForSelector:@"assetBeingGarbageCollected" assetSelector:*(a1 + 40) limitedToStaging:0];
  v3 = memset(v42, 0, sizeof(v42));
  if (![v3 countByEnumeratingWithState:v42 objects:v49 count:16])
  {

    v9 = 0;
    goto LABEL_12;
  }

  v4 = **(&v42[0] + 1);
  v5 = objc_autoreleasePoolPush();
  v6 = [v3 safeObjectForKey:v4 ofClass:{objc_opt_class(), *&v42[0]}];
  v7 = [*(a1 + 40) persistedEntryID];
  v8 = [v2 safeObjectForKey:v7 ofClass:objc_opt_class()];

  v9 = v8 != 0;
  if (v8)
  {
    v10 = @"locked(blocked unless emergency)";
    if (*(a1 + 72) != 1)
    {
LABEL_7:
      objc_storeStrong((*(*(a1 + 56) + 8) + 40), v10);
      v9 = 0;
      v11 = 0;
      *(*(*(a1 + 64) + 8) + 24) = 1;
      goto LABEL_10;
    }

    if ([v8 inhibitedFromEmergencyRemoval])
    {
      if (*(a1 + 72))
      {
        v10 = @"locked(inhibited from emergency removal)";
      }

      goto LABEL_7;
    }
  }

  v11 = v6;
LABEL_10:

  objc_autoreleasePoolPop(v5);
  if (v11)
  {
    v12 = 0;
    goto LABEL_28;
  }

LABEL_12:
  if (!*(*(*(a1 + 56) + 8) + 40))
  {
    v13 = [*(a1 + 32) stagerCurrentJob];
    if (v13 && (v14 = v13, v15 = *(a1 + 40), [*(a1 + 32) stagerCurrentJob], v16 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v16, "autoAssetSelector"), v17 = objc_claimAutoreleasedReturnValue(), LOBYTE(v15) = objc_msgSend(v15, "isEqual:", v17), v17, v16, v14, (v15 & 1) != 0))
    {
      v18 = @"stager-job(currently being staged)";
    }

    else
    {
      v19 = [*(a1 + 32) stagerBondedToAutoJob];
      if (!v19)
      {
        goto LABEL_20;
      }

      v20 = v19;
      v21 = *(a1 + 40);
      v22 = [*(a1 + 32) stagerBondedToAutoJob];
      v23 = [v22 autoAssetSelector];
      LODWORD(v21) = [v21 isEqual:v23];

      if (!v21)
      {
        goto LABEL_20;
      }

      v18 = @"stager-job(bonded to auto-job)";
    }

    v24 = *(*(a1 + 56) + 8);
    v25 = *(v24 + 40);
    *(v24 + 40) = v18;
  }

LABEL_20:
  v26 = *(a1 + 56);
  if (!*(*(v26 + 8) + 40))
  {
    v27 = [*(a1 + 32) isAutoAssetBeingEliminated:*(a1 + 40)];
    v26 = *(a1 + 56);
    if (v27)
    {
      v28 = *(v26 + 8);
      v29 = *(v28 + 40);
      *(v28 + 40) = @"eliminating(client-requested eliminate in progress)";

      v26 = *(a1 + 56);
    }
  }

  if (!*(*(v26 + 8) + 40))
  {
    v30 = [*(a1 + 32) currentJobBySelector:*(a1 + 40)];
    if (v30)
    {
      v31 = *(*(a1 + 56) + 8);
      v32 = *(v31 + 40);
      *(v31 + 40) = @"active(auto-asset-job in progress)";
    }
  }

  v11 = 0;
  v12 = 1;
LABEL_28:
  if (*(*(*(a1 + 56) + 8) + 40))
  {
    if (v12)
    {
      goto LABEL_45;
    }
  }

  else
  {
    [*(a1 + 32) ensureStagerFullyResumed];
    [MADAutoAssetStager garbageCollectEliminateSelector:*(a1 + 40)];
    if (v12)
    {
      goto LABEL_45;
    }
  }

  if (!*(*(*(a1 + 56) + 8) + 40))
  {
    if ([v11 secureOperationEliminating])
    {
      v33 = *(*(a1 + 56) + 8);
      v34 = *(v33 + 40);
      *(v33 + 40) = @"elimination triggered while ungrafting";

      [*(a1 + 32) eliminateUngraftDescriptor:*(*(*(a1 + 56) + 8) + 40) forAutoAssetDescriptor:v11 failingClientRequestForEventInfo:0];
    }

    else
    {
      if (v9)
      {
        v35 = 349;
      }

      else
      {
        v35 = 348;
      }

      if (v9)
      {
        v36 = 391;
      }

      else
      {
        v36 = 390;
      }

      if (v9)
      {
        v37 = 406;
      }

      else
      {
        v37 = 405;
      }

      [*(a1 + 32) forceGlobalUnlockFromLocation:@"assetBeingGarbageCollected" dueToError:0 fullAssetSelector:*(a1 + 40) historyOperationAI:v35 historyOperationSD:{v36, *&v42[0]}];
      [*(a1 + 32) _removeDescriptorFromFilesystem:@"assetBeingGarbageCollected" droppingDescriptor:v11 forHistoryOperation:v37 firstClientName:0];
    }
  }

LABEL_45:
  v38 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    v39 = @"N";
    if (v12)
    {
      v40 = @"N";
    }

    else
    {
      v40 = [v11 summary];
    }

    if (*(*(*(a1 + 56) + 8) + 40))
    {
      v39 = *(*(*(a1 + 56) + 8) + 40);
    }

    v41 = [*(a1 + 48) summary];
    *buf = 138543874;
    v44 = v40;
    v45 = 2114;
    v46 = v39;
    v47 = 2114;
    v48 = v41;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{assetBeingGarbageCollected} | downloadedDescriptor:%{public}@ | blockGarbageCollectionReason:%{public}@ | descriptorToBeRemoved:%{public}@", buf, 0x20u);
    if ((v12 & 1) == 0)
    {
    }
  }
}

+ (void)garbageCollectionOperationComplete:(BOOL)complete originalUnlockedUnreferencedDescriptors:(id)descriptors originalUnlockedReferencedDescriptors:(id)referencedDescriptors originalLockedOverridableDescriptors:(id)overridableDescriptors originalLockedNeverRemoveDescriptors:(id)removeDescriptors originalStagedDescriptors:(id)stagedDescriptors totalReclaimedSpace:(int64_t)space results:(id)self0
{
  resultsCopy = results;
  v12 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v12 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v12 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __271__MADAutoAssetControlManager_garbageCollectionOperationComplete_originalUnlockedUnreferencedDescriptors_originalUnlockedReferencedDescriptors_originalLockedOverridableDescriptors_originalLockedNeverRemoveDescriptors_originalStagedDescriptors_totalReclaimedSpace_results___block_invoke;
    v17[3] = &unk_4B4518;
    v18 = resultsCopy;
    completeCopy = complete;
    v19 = v12;
    spaceCopy = space;
    dispatch_sync(extendedStateQueue, v17);

    v16 = v18;
  }

  else
  {
    v16 = _MADLog(@"Auto");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{garbageCollectionOperationComplete} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }
}

id __271__MADAutoAssetControlManager_garbageCollectionOperationComplete_originalUnlockedUnreferencedDescriptors_originalUnlockedReferencedDescriptors_originalLockedOverridableDescriptors_originalLockedNeverRemoveDescriptors_originalStagedDescriptors_totalReclaimedSpace_results___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) reclaimUnlockedUnreferencedAutoAssetCount];
  v3 = [*(a1 + 32) reclaimUnlockedReferencedAutoAssetCount];
  v4 = [*(a1 + 32) reclaimUnlockedUnreferencedAutoAssetSpace];
  v5 = [*(a1 + 32) reclaimUnlockedReferencedAutoAssetSpace];
  v6 = [*(a1 + 40) statistics];
  [v6 setGarbageCollectionPerformed:1];

  v7 = *(a1 + 56);
  v8 = [*(a1 + 40) statistics];
  [v8 setGarbageCollectionReclaimSpace:v7];

  v9 = *(a1 + 48);
  v10 = [*(a1 + 40) statistics];
  [v10 setGarbageCollectionTotalReclaimedSpace:v9];

  v11 = [*(a1 + 32) reclaimV2AssetCount];
  v12 = [*(a1 + 40) statistics];
  [v12 setGarbageCollectionReclaimedV2AssetCount:v11];

  v13 = [*(a1 + 32) reclaimV2AssetSpace];
  v14 = [*(a1 + 40) statistics];
  [v14 setGarbageCollectionReclaimedV2AssetSpace:v13];

  v15 = [*(a1 + 40) statistics];
  [v15 setGarbageCollectionReclaimedUnlockedCount:&v2[v3]];

  v16 = [*(a1 + 40) statistics];
  [v16 setGarbageCollectionReclaimedUnlockedSpace:&v4[v5]];

  v17 = [*(a1 + 32) reclaimLockedOverridableAutoAssetCount];
  v18 = [*(a1 + 40) statistics];
  [v18 setGarbageCollectionReclaimedLockedOverridableCount:v17];

  v19 = [*(a1 + 32) reclaimLockedOverridableAutoAssetSpace];
  v20 = [*(a1 + 40) statistics];
  [v20 setGarbageCollectionReclaimedLockedOverridableSpace:v19];

  v21 = [*(a1 + 32) reclaimLockedNeverRemoveAutoAssetCount];
  v22 = [*(a1 + 40) statistics];
  [v22 setGarbageCollectionReclaimedLockedNeverRemoveCount:v21];

  v23 = [*(a1 + 32) reclaimLockedNeverRemoveAutoAssetSpace];
  v24 = [*(a1 + 40) statistics];
  [v24 setGarbageCollectionReclaimedLockedNeverRemoveSpace:v23];

  v25 = [*(a1 + 32) reclaimStagedAutoAssetCount];
  v26 = [*(a1 + 40) statistics];
  [v26 setGarbageCollectionReclaimedStagedCount:v25];

  v27 = [*(a1 + 32) reclaimStagedAutoAssetSpace];
  v28 = [*(a1 + 40) statistics];
  [v28 setGarbageCollectionReclaimedStagedSpace:v27];

  v29 = [*(a1 + 32) reclaimMetadataBlockedSpace];
  v30 = [*(a1 + 40) statistics];
  [v30 setGarbageCollectionReclaimedMetadataBlockedCount:v29];

  v31 = [*(a1 + 32) reclaimMetadataBlockedSpace];
  v32 = [*(a1 + 40) statistics];
  [v32 setGarbageCollectionReclaimedMetadataBlockedSpace:v31];

  v33 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
  {
    v34 = [*(a1 + 40) _updateLatestSummary];
    v35 = [*(a1 + 40) statistics];
    v36 = [v35 summary];
    v38 = 138543618;
    v39 = v34;
    v40 = 2114;
    v41 = v36;
    _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | garbage collection | statistics:%{public}@", &v38, 0x16u);
  }

  return [*(a1 + 40) _statsMaintainReporting];
}

- (BOOL)isAutoAssetBeingEliminated:(id)eliminated
{
  eliminatedCopy = eliminated;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:eliminatedCopy];

  return v7 != 0;
}

- (id)eliminateTrackerForSelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  persistedEntryID = [selectorCopy persistedEntryID];
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v10 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (!v10)
  {
    v11 = [MAAutoAssetSelector alloc];
    assetType = [selectorCopy assetType];
    assetSpecifier = [selectorCopy assetSpecifier];
    v14 = [v11 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

    activelyEliminatingSelectors2 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    persistedEntryID2 = [v14 persistedEntryID];
    v10 = [activelyEliminatingSelectors2 safeObjectForKey:persistedEntryID2 ofClass:objc_opt_class()];

    if (!v10)
    {
      v17 = [MAAutoAssetSelector alloc];
      assetType2 = [selectorCopy assetType];
      v19 = [v17 initForAssetType:assetType2];

      activelyEliminatingSelectors3 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      persistedEntryID3 = [v19 persistedEntryID];
      v10 = [activelyEliminatingSelectors3 safeObjectForKey:persistedEntryID3 ofClass:objc_opt_class()];

      if (!v10)
      {
        v40 = 0u;
        v41 = 0u;
        v38 = 0u;
        v39 = 0u;
        obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
        v22 = [obj countByEnumeratingWithState:&v38 objects:v42 count:16];
        if (v22)
        {
          v23 = v22;
          v34 = v19;
          v35 = v14;
          v36 = selectorCopy;
          v24 = *v39;
          while (2)
          {
            for (i = 0; i != v23; i = i + 1)
            {
              if (*v39 != v24)
              {
                objc_enumerationMutation(obj);
              }

              v26 = *(*(&v38 + 1) + 8 * i);
              v27 = objc_autoreleasePoolPush();
              activelyEliminatingSelectors4 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
              v10 = [activelyEliminatingSelectors4 safeObjectForKey:v26 ofClass:objc_opt_class()];

              if (v10 && [v10 eliminatingSet])
              {
                v29 = p_weak_ivar_lyt;
                clientDomainName = [v10 clientDomainName];
                assetSetIdentifier = [v10 assetSetIdentifier];
                v32 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

                if (v32 && ([v32 managesAssetSelector:v36] & 1) != 0)
                {

                  objc_autoreleasePoolPop(v27);
                  goto LABEL_18;
                }

                p_weak_ivar_lyt = v29;
              }

              objc_autoreleasePoolPop(v27);
            }

            v23 = [obj countByEnumeratingWithState:&v38 objects:v42 count:16];
            if (v23)
            {
              continue;
            }

            break;
          }

          v10 = 0;
LABEL_18:
          v14 = v35;
          selectorCopy = v36;
          v19 = v34;
        }

        else
        {
          v10 = 0;
        }
      }
    }
  }

  return v10;
}

- (BOOL)isSetIdentifierBeingEliminated:(id)eliminated forClientDomainName:(id)name ofSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  nameCopy = name;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = [[MAAutoAssetSelector alloc] initForAssetType:nameCopy withAssetSpecifier:identifierCopy];
  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  persistedEntryID = [v11 persistedEntryID];
  v14 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  return v14 != 0;
}

- (BOOL)isSetIdentifierCurrentlyLocked:(id)locked forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  lockedCopy = locked;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  lockedCopy = [[NSString alloc] initWithFormat:@"%@:isSetIdentifierCurrentlyLocked", lockedCopy];
  v14 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:nameCopy assetSetIdentifier:identifierCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:lockedCopy ofContainer:@"setDescriptorKeysForAssetSet"];
  v31 = 0u;
  v32 = 0u;
  v29 = 0u;
  v30 = 0u;
  v15 = v14;
  v16 = [v15 countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v16)
  {
    v17 = v16;
    v27 = nameCopy;
    v28 = lockedCopy;
    v18 = *v30;
    while (2)
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v30 != v18)
        {
          objc_enumerationMutation(v15);
        }

        v20 = *(*(&v29 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        v22 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:lockedCopy forKey:v20];
        if (v22)
        {
          v23 = v22;
          v24 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v22];

          if (v24)
          {
            objc_autoreleasePoolPop(v21);
            v25 = 1;
            goto LABEL_12;
          }
        }

        objc_autoreleasePoolPop(v21);
      }

      v17 = [v15 countByEnumeratingWithState:&v29 objects:v33 count:16];
      if (v17)
      {
        continue;
      }

      break;
    }

    v25 = 0;
LABEL_12:
    nameCopy = v27;
    lockedCopy = v28;
  }

  else
  {
    v25 = 0;
  }

  return v25;
}

- (BOOL)isSetDescriptorCurrentlyLocked:(id)locked forSetDescriptor:(id)descriptor
{
  lockedCopy = locked;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:descriptorCopy];
  if (v10)
  {
    v33 = lockedCopy;
    lockedCopy = [[NSString alloc] initWithFormat:@"%@:isSetDescriptorCurrentlyLocked", lockedCopy];
    [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v32 = v10;
    v11 = v10;
    v12 = [v11 countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v12)
    {
      v13 = v12;
      v34 = 0;
      v14 = *v45;
      v35 = *v45;
      v36 = v11;
      do
      {
        v15 = 0;
        v37 = v13;
        do
        {
          if (*v45 != v14)
          {
            objc_enumerationMutation(v11);
          }

          v16 = *(*(&v44 + 1) + 8 * v15);
          v17 = objc_autoreleasePoolPush();
          v18 = [v11 safeObjectForKey:v16 ofClass:objc_opt_class()];
          v19 = v18;
          if (v18)
          {
            v39 = v17;
            v42 = 0u;
            v43 = 0u;
            v40 = 0u;
            v41 = 0u;
            v20 = v18;
            v21 = [v20 countByEnumeratingWithState:&v40 objects:v48 count:16];
            if (v21)
            {
              v22 = v21;
              v38 = v19;
              v23 = *v41;
              while (2)
              {
                for (i = 0; i != v22; i = i + 1)
                {
                  if (*v41 != v23)
                  {
                    objc_enumerationMutation(v20);
                  }

                  v25 = *(*(&v40 + 1) + 8 * i);
                  v26 = objc_autoreleasePoolPush();
                  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
                  v28 = [SUCore stringIsEqual:v25 to:latestDownloadedAtomicInstance];

                  objc_autoreleasePoolPop(v26);
                  if (v28)
                  {
                    v34 = 1;
                    goto LABEL_18;
                  }
                }

                v22 = [v20 countByEnumeratingWithState:&v40 objects:v48 count:16];
                if (v22)
                {
                  continue;
                }

                break;
              }

LABEL_18:
              v14 = v35;
              v11 = v36;
              v13 = v37;
              v19 = v38;
            }

            v17 = v39;
          }

          objc_autoreleasePoolPop(v17);
          v15 = v15 + 1;
        }

        while (v15 != v13);
        v13 = [v11 countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v13);
    }

    else
    {
      v34 = 0;
    }

    v10 = v32;
    lockedCopy = v33;
    v29 = v34;
  }

  else
  {
    v29 = 0;
  }

  return v29 & 1;
}

- (void)validateShortTermLockURL:(id)l normalizedClientDomainNameURL:(id)rL normalizedAssetSetIdentifierURL:(id)uRL fileManager:(id)manager isLatestLocker:(BOOL *)locker isSpecificLocker:(BOOL *)specificLocker
{
  lCopy = l;
  rLCopy = rL;
  uRLCopy = uRL;
  managerCopy = manager;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v19 = lCopy;
  v20 = objc_autoreleasePoolPush();
  lastPathComponent = [(__CFString *)lCopy lastPathComponent];
  v22 = [NSString stringWithFormat:@"%@_", @"atomic_instance"];
  if (([lastPathComponent hasPrefix:v22]& 1) != 0)
  {
    v63 = v19;
    v23 = [v22 length];
    if (v23 > [lastPathComponent length])
    {
      v24 = _MADLog(@"AutoLocker");
      v19 = v63;
      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v25 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, prefix A | shortTermLockURL:%@";
LABEL_7:
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, v25, buf, 0xCu);
        goto LABEL_8;
      }

      goto LABEL_8;
    }

    v29 = [lastPathComponent substringFromIndex:v23];

    if (!v29)
    {
      lastPathComponent = _MADLog(@"AutoLocker");
      v19 = v63;
      if (os_log_type_enabled(lastPathComponent, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        _os_log_impl(&dword_0, lastPathComponent, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} unexpected error extracting atomic instance from path, prefix B | shortTermLockURL:%@", buf, 0xCu);
      }

      goto LABEL_9;
    }

    v30 = [NSString stringWithFormat:@".%@", @"locker"];
    if (([v29 hasSuffix:v30]& 1) != 0)
    {
      v31 = v29;
      v32 = [v29 length];
      if (v32 - [v30 length] > 0)
      {
        v33 = [v31 substringToIndex:?];

        v26 = rLCopy;
        if (v33)
        {
          v27 = uRLCopy;
          v62 = v33;
          if ([v33 isEqualToString:@"latest"])
          {
            v65 = v30;
            v34 = _MADLog(@"AutoLocker");
            v28 = managerCopy;
            if (os_log_type_enabled(v34, OS_LOG_TYPE_DEBUG))
            {
              lastPathComponent2 = [v26 lastPathComponent];
              lastPathComponent3 = [v27 lastPathComponent];
              *buf = 138543874;
              v68 = lastPathComponent2;
              v69 = 2114;
              v70 = lastPathComponent3;
              v71 = 2114;
              v72 = v62;
              _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEBUG, "{validateShortTermLockURL} latest | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x20u);
            }

            if (locker)
            {
              *locker = 1;
            }

            v19 = v63;
            v30 = v65;
            goto LABEL_30;
          }

          v28 = managerCopy;
          if ([v33 isEqualToString:@"specific"])
          {
            v40 = _MADLog(@"AutoLocker");
            if (os_log_type_enabled(v40, OS_LOG_TYPE_DEBUG))
            {
              lastPathComponent4 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              v43 = v42 = v30;
              *buf = 138543874;
              v68 = lastPathComponent4;
              v69 = 2114;
              v70 = v43;
              v71 = 2114;
              v72 = v62;
              _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEBUG, "{validateShortTermLockURL} specific | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x20u);

              v30 = v42;
            }

            if (specificLocker)
            {
              *specificLocker = 1;
            }

            v19 = v63;
            goto LABEL_30;
          }

          knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
          v45 = v33;
          v46 = knownSetAtomicInstancesByInstance;
          v47 = [knownSetAtomicInstancesByInstance objectForKeyedSubscript:v45];

          if (v47)
          {
            if ([(MADAutoAssetControlManager *)self atomicInstanceIsCurrentlyLocked:v47])
            {
              lockedSupportingShortTermLocking = [v47 lockedSupportingShortTermLocking];
              v49 = _MADLog(@"AutoLocker");
              path = v49;
              if (lockedSupportingShortTermLocking)
              {
                if (os_log_type_enabled(v49, OS_LOG_TYPE_DEBUG))
                {
                  lastPathComponent5 = [v26 lastPathComponent];
                  [v27 lastPathComponent];
                  v53 = v52 = v30;
                  *buf = 138543874;
                  v68 = lastPathComponent5;
                  v69 = 2114;
                  v70 = v53;
                  v71 = 2114;
                  v72 = v62;
                  v54 = "{validateShortTermLockURL} found atomic instance for short-term lock file | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@";
                  v55 = path;
                  v56 = OS_LOG_TYPE_DEBUG;
LABEL_53:
                  _os_log_impl(&dword_0, v55, v56, v54, buf, 0x20u);

                  v30 = v52;
                }
              }

              else if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR))
              {
                lastPathComponent5 = [v26 lastPathComponent];
                [v27 lastPathComponent];
                v53 = v52 = v30;
                *buf = 138543874;
                v68 = lastPathComponent5;
                v69 = 2114;
                v70 = v53;
                v71 = 2114;
                v72 = v62;
                v54 = "{validateShortTermLockURL} found atomic instance but not considered to support short-term locks | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@";
                v55 = path;
                v56 = OS_LOG_TYPE_ERROR;
                goto LABEL_53;
              }

              v19 = v63;
              goto LABEL_55;
            }

            v66 = v30;
            v57 = _MADLog(@"AutoLocker");
            v58 = @"found atomic instance but not considered locked";
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
            {
              lastPathComponent6 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              *buf = 138544130;
              v68 = @"found atomic instance but not considered locked";
              v69 = 2114;
              v70 = lastPathComponent6;
              v72 = v71 = 2114;
              v59 = v72;
              v73 = 2114;
              v74 = v62;
              goto LABEL_49;
            }
          }

          else
          {
            v66 = v30;
            v57 = _MADLog(@"AutoLocker");
            v58 = @"short-term lock file exists for an atomic instance that does not exist";
            if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
            {
              lastPathComponent6 = [v26 lastPathComponent];
              [v27 lastPathComponent];
              *buf = 138544130;
              v68 = @"short-term lock file exists for an atomic instance that does not exist";
              v69 = 2114;
              v70 = lastPathComponent6;
              v72 = v71 = 2114;
              v59 = v72;
              v73 = 2114;
              v74 = v62;
LABEL_49:
              _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} %{public}@ | clientDomainName:%{public}@ assetSetIdentifier:%{public}@ atomicInstanceUUID:%{public}@", buf, 0x2Au);
            }
          }

          v19 = v63;

          path = [(__CFString *)v63 path];
          v60 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:@"setDescriptorEliminateMatching" removingSharedLockFilename:path usingFileManager:v28 removingDescription:v58];
          v30 = v66;
LABEL_55:

          goto LABEL_30;
        }

        v39 = _MADLog(@"AutoLocker");
        v27 = uRLCopy;
        v19 = v63;
        if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
        {
          *buf = 138412290;
          v68 = v63;
          _os_log_impl(&dword_0, v39, OS_LOG_TYPE_ERROR, "{validateShortTermLockURL} unexpected error extracting atomic instance from path, suffix B | shortTermLockURL:%@", buf, 0xCu);
        }

        v62 = 0;
LABEL_29:
        v28 = managerCopy;
LABEL_30:

        lastPathComponent = v62;
        goto LABEL_10;
      }

      v62 = v31;
      v37 = _MADLog(@"AutoLocker");
      v26 = rLCopy;
      v19 = v63;
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v38 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, suffix A | shortTermLockURL:%@";
        goto LABEL_27;
      }
    }

    else
    {
      v62 = v29;
      v37 = _MADLog(@"AutoLocker");
      v26 = rLCopy;
      v19 = v63;
      if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412290;
        v68 = v63;
        v38 = "{validateShortTermLockURL} unexpected error extracting atomic instance from path, missing suffix | shortTermLockURL:%@";
LABEL_27:
        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, v38, buf, 0xCu);
      }
    }

    v27 = uRLCopy;
    goto LABEL_29;
  }

  v24 = _MADLog(@"AutoLocker");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
  {
    *buf = 138412290;
    v68 = v19;
    v25 = "{validateShortTermLockURL} error extracting atomic instance from path, missing prefix | shortTermLockURL:%@";
    goto LABEL_7;
  }

LABEL_8:

LABEL_9:
  v26 = rLCopy;
  v27 = uRLCopy;
  v28 = managerCopy;
LABEL_10:

  objc_autoreleasePoolPop(v20);
}

- (void)shortTermLockFilesHealthCheck
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v32 = objc_autoreleasePoolPush();
  v4 = [NSURL alloc];
  v5 = getRepositoryPath(@"/private/var/MobileAsset/AssetsV2/locks");
  v6 = [v4 initWithString:v5];

  +[NSFileManager defaultManager];
  v57 = 0u;
  v58 = 0u;
  v59 = 0u;
  v46 = v60 = 0u;
  v31 = v6;
  obj = [v46 enumeratorAtURL:v6 includingPropertiesForKeys:0 options:0 errorHandler:0];
  v35 = [obj countByEnumeratingWithState:&v57 objects:v67 count:16];
  if (v35)
  {
    v34 = *v58;
    do
    {
      v7 = 0;
      do
      {
        if (*v58 != v34)
        {
          objc_enumerationMutation(obj);
        }

        v37 = v7;
        v8 = *(*(&v57 + 1) + 8 * v7);
        context = objc_autoreleasePoolPush();
        v53 = 0u;
        v54 = 0u;
        v55 = 0u;
        v56 = 0u;
        v38 = [v46 enumeratorAtURL:v8 includingPropertiesForKeys:0 options:0 errorHandler:0];
        v40 = [v38 countByEnumeratingWithState:&v53 objects:v66 count:16];
        if (v40)
        {
          v39 = *v54;
          do
          {
            for (i = 0; i != v40; i = i + 1)
            {
              if (*v54 != v39)
              {
                objc_enumerationMutation(v38);
              }

              v10 = *(*(&v53 + 1) + 8 * i);
              v11 = objc_autoreleasePoolPush();
              v12 = [v10 URLByAppendingPathComponent:@"shared_locks"];
              v49 = 0u;
              v50 = 0u;
              v51 = 0u;
              v52 = 0u;
              v44 = [v46 enumeratorAtURL:v12 includingPropertiesForKeys:0 options:0 errorHandler:0];
              v13 = [v44 countByEnumeratingWithState:&v49 objects:v65 count:16];
              if (!v13)
              {
                v15 = 0;
                v16 = 0;
                goto LABEL_37;
              }

              v14 = v13;
              v41 = v12;
              v42 = v11;
              v43 = i;
              v15 = 0;
              v16 = 0;
              v17 = *v50;
              do
              {
                for (j = 0; j != v14; j = j + 1)
                {
                  if (*v50 != v17)
                  {
                    objc_enumerationMutation(v44);
                  }

                  v19 = *(*(&v49 + 1) + 8 * j);
                  buf[0] = 0;
                  v48 = 0;
                  [(MADAutoAssetControlManager *)self validateShortTermLockURL:v19 normalizedClientDomainNameURL:v8 normalizedAssetSetIdentifierURL:v10 fileManager:v46 isLatestLocker:buf isSpecificLocker:&v48];
                  if (buf[0])
                  {
                    v20 = v16;
                    v21 = v15;
                    v16 = v19;
                  }

                  else
                  {
                    v20 = v15;
                    v21 = v19;
                    if (v48 != 1)
                    {
                      continue;
                    }
                  }

                  v22 = v19;

                  v15 = v21;
                }

                v14 = [v44 countByEnumeratingWithState:&v49 objects:v65 count:16];
              }

              while (v14);

              v12 = v41;
              v11 = v42;
              if (v15)
              {
                v23 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                {
                  path = [v15 path];
                  *buf = 138543362;
                  v62 = path;
                  _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} %{public}@ is no longer used - will be removed", buf, 0xCu);
                }

                [v46 removeItemAtURL:v15 error:0];
              }

              i = v43;
              if (v16)
              {
                path2 = [v16 path];
                v26 = isValidSymlink(path2);

                v44 = _MADLog(@"AutoControl");
                v27 = os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT);
                if (v26)
                {
                  if (v27)
                  {
                    path3 = [v16 path];
                    *buf = 138543362;
                    v62 = path3;
                    _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} Latest symlink %{public}@ points to a valid target", buf, 0xCu);
                    goto LABEL_36;
                  }
                }

                else
                {
                  if (v27)
                  {
                    path4 = [v16 path];
                    *buf = 138543362;
                    v62 = path4;
                    _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{shortTermLockFilesHealthCheck} Latest symlink %{public}@ is not pointing to a valid target - will be removed", buf, 0xCu);
                  }

                  v47 = 0;
                  [v46 removeItemAtURL:v16 error:&v47];
                  v44 = v47;
                  if (v44)
                  {
                    path3 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(path3, OS_LOG_TYPE_ERROR))
                    {
                      path5 = [v16 path];
                      *buf = 138543618;
                      v62 = path5;
                      v63 = 2114;
                      v64 = v44;
                      _os_log_impl(&dword_0, path3, OS_LOG_TYPE_ERROR, "{shortTermLockFilesHealthCheck} Failed to remove invalid symlink %{public}@.  Error: %{public}@", buf, 0x16u);
                    }

LABEL_36:
                  }
                }

LABEL_37:
              }

              objc_autoreleasePoolPop(v11);
            }

            v40 = [v38 countByEnumeratingWithState:&v53 objects:v66 count:16];
          }

          while (v40);
        }

        objc_autoreleasePoolPop(context);
        v7 = v37 + 1;
      }

      while ((v37 + 1) != v35);
      v35 = [obj countByEnumeratingWithState:&v57 objects:v67 count:16];
    }

    while (v35);
  }

  objc_autoreleasePoolPop(v32);
}

+ (int64_t)previousOTASituation
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v11 = 0;
  v12 = &v11;
  v13 = 0x2020000000;
  v14 = 0;
  autoControlManagerFSM = [v2 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v2 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v8[0] = _NSConcreteStackBlock;
    v8[1] = 3221225472;
    v8[2] = __50__MADAutoAssetControlManager_previousOTASituation__block_invoke;
    v8[3] = &unk_4B2EA8;
    v9 = v2;
    v10 = &v11;
    dispatch_sync(extendedStateQueue, v8);
  }

  v6 = v12[3];
  _Block_object_dispose(&v11, 8);

  return v6;
}

int64_t __50__MADAutoAssetControlManager_previousOTASituation__block_invoke(uint64_t a1)
{
  [*(a1 + 32) ensureStagerFullyResumed];
  result = +[MADAutoAssetStager previousOTASituation];
  *(*(*(a1 + 40) + 8) + 24) = result;
  return result;
}

+ (void)considerPerfomingCrosscheckTrim
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v2 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v2 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __61__MADAutoAssetControlManager_considerPerfomingCrosscheckTrim__block_invoke;
    block[3] = &unk_4B2AA0;
    v7 = v2;
    dispatch_async(extendedStateQueue, block);
  }
}

id __61__MADAutoAssetControlManager_considerPerfomingCrosscheckTrim__block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) initialHealthReportPerformedCrosscheck];
  if ((result & 1) == 0)
  {
    [*(a1 + 32) setInitialHealthReportPerformedCrosscheck:1];
    v3 = *(a1 + 32);

    return [v3 firstSchedulerCrosscheckTrim];
  }

  return result;
}

- (void)_trackPerformanceStartupBegin
{
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v2 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      *v3 = 0;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE] {AUTO-SET-CONTROL:trackPerformanceStartupBegin} | STARTUP_BEGIN", v3, 2u);
    }
  }
}

- (void)trackPerformanceIteration:(id)iteration ofContainer:(id)container
{
  iterationCopy = iteration;
  containerCopy = container;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v8 = +[NSDate date];
    [v8 timeIntervalSince1970];
    v10 = v9;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v12 = v11;

    v13 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 134218498;
      v15 = (v10 - v12);
      v16 = 2114;
      v17 = iterationCopy;
      v18 = 2114;
      v19 = containerCopy;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceIteration} | containerName:%{public}@", &v14, 0x20u);
    }
  }
}

- (void)trackPerformanceFilesystemExistCheck:(id)check atPath:(id)path withFilesystemInfo:(int64_t)info justUpdatedCache:(BOOL)cache
{
  cacheCopy = cache;
  checkCopy = check;
  pathCopy = path;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled]|| cacheCopy)
  {
    v12 = +[NSDate date];
    [v12 timeIntervalSince1970];
    v14 = v13;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v16 = v15;

    v17 = @"INVALID";
    if (info > 199)
    {
      if (info == 200)
      {
        v17 = @"FileExists";
      }

      else if (info == 300)
      {
        v17 = @"DirectoryExists";
      }
    }

    else if (info)
    {
      if (info == 100)
      {
        v17 = @"DoesNotExist";
      }
    }

    else
    {
      v17 = @"Unknown";
    }

    v18 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      v19 = @"HIT";
      v20 = 134219010;
      v21 = (v14 - v16);
      v22 = 2114;
      if (cacheCopy)
      {
        v19 = @"MISS";
      }

      v23 = checkCopy;
      v24 = 2114;
      v25 = v19;
      v26 = 2114;
      v27 = v17;
      v28 = 2114;
      v29 = pathCopy;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] [FILESYSTEM-CACHE] {%{public}@:trackPerformanceFilesystemExistCheck} [%{public}@] | cachedInfo:%{public}@ | filePath:%{public}@", &v20, 0x34u);
    }
  }
}

- (void)trackPerformancePhaseBegin:(id)begin
{
  beginCopy = begin;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = beginCopy;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformancePhaseBegin} | PHASE_BEGIN", &v11, 0x16u);
    }
  }
}

- (void)trackPerformancePhaseEnd:(id)end
{
  endCopy = end;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = endCopy;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformancePhaseEnd} | PHASE_END", &v11, 0x16u);
    }
  }
}

- (void)trackPerformanceStartupStep:(id)step beginningStep:(id)beginningStep
{
  stepCopy = step;
  beginningStepCopy = beginningStep;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v8 = +[NSDate date];
    [v8 timeIntervalSince1970];
    v10 = v9;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v12 = v11;

    v13 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      v14 = 134218498;
      v15 = (v10 - v12);
      v16 = 2114;
      v17 = stepCopy;
      v18 = 2114;
      v19 = beginningStepCopy;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceStartupStep} | startupStepName:%{public}@", &v14, 0x20u);
    }
  }
}

- (void)trackPerformanceStartupEnd:(id)end
{
  endCopy = end;
  if (+[MADAutoAssetControlManager preferencePerformanceLoggingEnabled])
  {
    v5 = +[NSDate date];
    [v5 timeIntervalSince1970];
    v7 = v6;
    [(MADAutoAssetControlManager *)self startupTimeBeginSeconds];
    v9 = v8;

    v10 = _MADLog(@"AutoLocker");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      v11 = 134218242;
      v12 = (v7 - v9);
      v13 = 2114;
      v14 = endCopy;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[AUTO-PERFORMANCE][ELAPSED:%ldsecs] {AUTO-SET-CONTROL:%{public}@:trackPerformanceStartupEnd} | STARTUP_END", &v11, 0x16u);
    }
  }
}

+ (void)analyticsReportSecureOperationResults:(id)results clientName:(id)name secureReason:(id)reason operation:(int64_t)operation fromLocation:(id)location mountError:(id)error graftError:(id)graftError personalizeError:(id)self0 mapToExclaveError:(id)self1
{
  nameCopy = name;
  reasonCopy = reason;
  locationCopy = location;
  errorCopy = error;
  graftErrorCopy = graftError;
  personalizeErrorCopy = personalizeError;
  exclaveErrorCopy = exclaveError;
  resultsCopy = results;
  v22 = +[MADAutoAssetControlManager autoControlManager];
  analyticsManager = [v22 analyticsManager];

  assetSpecifier = [resultsCopy assetSpecifier];
  assetType = [resultsCopy assetType];
  assetVersion = [resultsCopy assetVersion];

  if (reasonCopy)
  {
    v23 = reasonCopy;
  }

  else
  {
    v23 = @"N/A";
  }

  if (personalizeErrorCopy)
  {
    checkedDescription = [personalizeErrorCopy checkedDescription];
    if (errorCopy)
    {
      goto LABEL_6;
    }

LABEL_9:
    checkedDescription2 = 0;
    if (graftErrorCopy)
    {
      goto LABEL_7;
    }

    goto LABEL_10;
  }

  checkedDescription = 0;
  if (!errorCopy)
  {
    goto LABEL_9;
  }

LABEL_6:
  checkedDescription2 = [errorCopy checkedDescription];
  if (graftErrorCopy)
  {
LABEL_7:
    checkedDescription3 = [graftErrorCopy checkedDescription];
    goto LABEL_11;
  }

LABEL_10:
  checkedDescription3 = 0;
LABEL_11:
  v47 = errorCopy;
  if (exclaveErrorCopy)
  {
    v25 = errorCopy == 0;
    v26 = locationCopy;
    v27 = v25;
    v28 = exclaveErrorCopy;
    checkedDescription4 = [exclaveErrorCopy checkedDescription];
    v30 = v23;
    v31 = reasonCopy;
    v32 = checkedDescription4;
    LOBYTE(v42) = 0;
    LOBYTE(v41) = graftErrorCopy == 0;
    LOBYTE(v40) = v27;
    locationCopy = v26;
    LOBYTE(v39) = personalizeErrorCopy == 0;
    v38 = v26;
    v34 = assetSpecifier;
    v33 = analyticsManager;
    v35 = assetType;
    v36 = [analyticsManager recordMobileAssetSecureAttempt:assetSpecifier assetType:assetType assetVersion:assetVersion clientName:nameCopy operation:operation secureReason:v30 fromLocation:v38 sucessfullyPersonalized:v39 personalizeFailureReason:checkedDescription sucessfullyMounted:v40 mountingFailureReason:checkedDescription2 successfullyGrafted:v41 graftingFailureReason:checkedDescription3 successfullyMappedToExclave:v42 mapToExclaveFailureReason:checkedDescription4];

    reasonCopy = v31;
    if (graftErrorCopy)
    {
      goto LABEL_16;
    }
  }

  else
  {
    v28 = 0;
    LOBYTE(v42) = 1;
    LOBYTE(v41) = graftErrorCopy == 0;
    LOBYTE(v40) = errorCopy == 0;
    LOBYTE(v39) = personalizeErrorCopy == 0;
    v34 = assetSpecifier;
    v33 = analyticsManager;
    v35 = assetType;
    v37 = [analyticsManager recordMobileAssetSecureAttempt:assetSpecifier assetType:assetType assetVersion:assetVersion clientName:nameCopy operation:operation secureReason:v23 fromLocation:locationCopy sucessfullyPersonalized:v39 personalizeFailureReason:checkedDescription sucessfullyMounted:v40 mountingFailureReason:checkedDescription2 successfullyGrafted:v41 graftingFailureReason:checkedDescription3 successfullyMappedToExclave:v42 mapToExclaveFailureReason:0];
    if (graftErrorCopy)
    {
LABEL_16:
    }
  }

  if (v47)
  {
  }

  if (personalizeErrorCopy)
  {
  }
}

+ (id)createSeverMessageWithName:(id)name sender:(id)sender clientID:(id)d response:(id)response error:(id)error
{
  dCopy = d;
  nameCopy = name;
  v10 = objc_alloc_init(NSMutableDictionary);
  v11 = [[SUCoreConnectMessage alloc] initWithType:2 messageName:nameCopy clientID:dCopy version:0 message:v10];

  return v11;
}

+ (void)installAutoAssetWithDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  if (_MAPreferencesIsInternalAllowed())
  {
    v3 = +[MADAutoAssetControlManager autoControlManager];
    initForTimerFired = [[MADAutoAssetControlManagerParam alloc] initForTimerFired];
    [initForTimerFired setDownloadingDescriptor:descriptorCopy];
    autoControlManagerFSM = [v3 autoControlManagerFSM];
    [autoControlManagerFSM postEvent:@"InstallAssetsEvent" withInfo:initForTimerFired];
  }
}

- (id)_summary
{
  v3 = [NSString alloc];
  clientRequestsBeingTracked = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  v5 = [clientRequestsBeingTracked count];
  currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
  v7 = [v3 initWithFormat:@"clientReqs:%ld|setJobs:%ld", v5, objc_msgSend(currentSetJobsByIdentifier, "count")];

  return v7;
}

- (id)_updateLatestSummary
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  _summary = [(MADAutoAssetControlManager *)self _summary];
  [(MADAutoAssetControlManager *)self setLatestSafeSummary:_summary];

  return [(MADAutoAssetControlManager *)self latestSafeSummary];
}

- (int64_t)action_StartUnlockPollingTimer:(id)timer error:(id *)error
{
  timerCopy = timer;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v19.opaque[0] = 0;
  v19.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StartUnlockPollingTimer", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v19);

  [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:1, v19.opaque[0], v19.opaque[1]];
  [(MADAutoAssetControlManager *)self setOperatingBeforeResumed:1];
  preferenceBeforeFirstPollSecs = [(MADAutoAssetControlManager *)self preferenceBeforeFirstPollSecs];
  v10 = 600;
  if (preferenceBeforeFirstPollSecs != -1)
  {
    v10 = preferenceBeforeFirstPollSecs;
  }

  v11 = [NSTimer timerWithTimeInterval:1 repeats:&__block_literal_global_2309 block:v10];
  [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:v11];

  beyondFirstUnlockPollTimer = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
  LODWORD(v11) = beyondFirstUnlockPollTimer == 0;

  if (v11)
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v21 = _updateLatestSummary;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@] {StartUnlockPollingTimer} | Unable to create first-unlock polling timer", buf, 0xCu);
    }
  }

  else
  {
    v13 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v21 = _updateLatestSummary2;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[%{public}@] {StartUnlockPollingTimer} | entered first-unlock polling period", buf, 0xCu);
    }

    v15 = +[NSRunLoop mainRunLoop];
    beyondFirstUnlockPollTimer2 = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [v15 addTimer:beyondFirstUnlockPollTimer2 forMode:NSDefaultRunLoopMode];
  }

  os_activity_scope_leave(&v19);
  return 0;
}

void __67__MADAutoAssetControlManager_action_StartUnlockPollingTimer_error___block_invoke(id a1, NSTimer *a2)
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v2 = [[MADAutoAssetControlManagerParam alloc] initForTimerFired];
  v3 = [v4 autoControlManagerFSM];
  [v3 postEvent:@"PollForDeviceUnlocked" withInfo:v2];
}

- (int64_t)action_PollDecideBefore1stUnlock:(id)unlock error:(id *)error
{
  unlockCopy = unlock;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PollDecideBefore1stUnlock", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v15);

  if (![MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock:v15.opaque[0]])
  {
    v9 = [MADAutoAssetControlManagerParam alloc];
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:_updateLatestSummary];

    beyondFirstUnlockPollTimer = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [beyondFirstUnlockPollTimer invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"PolledNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v15);

  return 0;
}

- (int64_t)action_SyncSkippedDecideBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v15.opaque[0] = 0;
  v15.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncSkippedDecideBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v15);

  v9 = [MADAutoAssetControlManagerParam alloc];
  v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary:v15.opaque[0]];
  v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:v10];

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"SyncedStillBefore1st" withInfo:v11];
  }

  else
  {
    beyondFirstUnlockPollTimer = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [beyondFirstUnlockPollTimer invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"SyncedNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v15);
  return 0;
}

- (int64_t)action_SyncDecideBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v17.opaque[0] = 0;
  v17.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncDecideBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v17);

  v9 = [MADAutoAssetControlManagerParam alloc];
  v10 = [(MADAutoAssetControlManager *)self _updateLatestSummary:v17.opaque[0]];
  v11 = [(MADAutoAssetControlManagerParam *)v9 initWithSafeSummary:v10];

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  downloadsInFlight = [before1stCopy downloadsInFlight];
  v13 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:downloadsInFlight];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v13];

  if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"SyncedStillBefore1st" withInfo:v11];
  }

  else
  {
    beyondFirstUnlockPollTimer = [(MADAutoAssetControlManager *)self beyondFirstUnlockPollTimer];
    [beyondFirstUnlockPollTimer invalidate];

    [(MADAutoAssetControlManager *)self setBeyondFirstUnlockPollTimer:0];
    [(MADAutoAssetControlManager *)self setOperatingBeforeFirstUnlock:0];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"SyncedNowUnlocked" withInfo:v11];
  }

  os_activity_scope_leave(&v17);
  return 0;
}

- (int64_t)action_LoadPersistedResumeLocker:(id)locker error:(id *)error
{
  lockerCopy = locker;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:LoadPersistedResumeLocker", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"LoadPersistedResumeLocker"];
  [(MADAutoAssetControlManager *)self setOperatingBeforeResumed:1];
  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  LODWORD(self) = persistedActiveJobs == 0;

  if (self)
  {
    v9 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
    v12 = [(MADAutoAssetPersisted *)v9 initForModule:@"AutoControlManager" ofModuleVersion:@"1.1" usingDispatchQueue:extendedStateQueue2 loggingByName:@"ACTIVE-JOBS" withVersionMigrator:&__block_literal_global_2320];
    [(MADAutoAssetControlManager *)selfCopy setPersistedActiveJobs:v12];

    v13 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue3 = [autoControlManagerFSM3 extendedStateQueue];
    v16 = [(MADAutoAssetPersisted *)v13 initForModule:@"AutoAssetDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue3 loggingByName:@"KNOWN-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2328];
    [(MADAutoAssetControlManager *)selfCopy setPersistedKnownDescriptors:v16];

    v17 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue4 = [autoControlManagerFSM4 extendedStateQueue];
    v20 = [(MADAutoAssetPersisted *)v17 initForModule:@"AutoSetConfigurations" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue4 loggingByName:@"KNOWN-SET-CONFIGURATIONS" withVersionMigrator:&__block_literal_global_2336];
    [(MADAutoAssetControlManager *)selfCopy setPersistedKnownSetConfigurations:v20];

    v21 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM5 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue5 = [autoControlManagerFSM5 extendedStateQueue];
    v24 = [(MADAutoAssetPersisted *)v21 initForModule:@"AutoSetAtomicInstances" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue5 loggingByName:@"KNOWN-SET-ATOMIC-INSTANCES" withVersionMigrator:&__block_literal_global_2344];
    [(MADAutoAssetControlManager *)selfCopy setPersistedKnownSetAtomicInstances:v24];

    v25 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM6 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue6 = [autoControlManagerFSM6 extendedStateQueue];
    v28 = [(MADAutoAssetPersisted *)v25 initForModule:@"AutoSetActiveJobDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue6 loggingByName:@"ACTIVE-JOB-SET-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2352];
    [(MADAutoAssetControlManager *)selfCopy setPersistedActiveJobSetDescriptors:v28];

    v29 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM7 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue7 = [autoControlManagerFSM7 extendedStateQueue];
    v32 = [(MADAutoAssetPersisted *)v29 initForModule:@"AutoSetDescriptors" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue7 loggingByName:@"DOWNLOADED-SET-DESCRIPTORS" withVersionMigrator:&__block_literal_global_2360];
    [(MADAutoAssetControlManager *)selfCopy setPersistedDownloadedSetDescriptors:v32];

    v33 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM8 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue8 = [autoControlManagerFSM8 extendedStateQueue];
    v36 = [(MADAutoAssetPersisted *)v33 initForModule:@"AutoSetTargets" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue8 loggingByName:@"KNOWN-SET-TARGETS" withVersionMigrator:&__block_literal_global_2368];
    [(MADAutoAssetControlManager *)selfCopy setPersistedSetTargets:v36];

    v37 = [MADAutoAssetPersisted alloc];
    autoControlManagerFSM9 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    extendedStateQueue9 = [autoControlManagerFSM9 extendedStateQueue];
    v40 = [(MADAutoAssetPersisted *)v37 initForModule:@"AutoSetLookupResults" ofModuleVersion:@"1.0" usingDispatchQueue:extendedStateQueue9 loggingByName:@"STAGED-SET-CONFIGURATIONS" withVersionMigrator:&__block_literal_global_2376];
    [(MADAutoAssetControlManager *)selfCopy setPersistedSetLookupResults:v40];
  }

  v41 = _MAPreferencesCopyValue(@"persistedStateLoadingInProgress");

  if (v41)
  {
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      summary = [(MADAutoAssetControlManager *)selfCopy summary];
      *buf = 138543362;
      v88 = summary;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | Not using in memory caching for persisted state objects", buf, 0xCu);
    }
  }

  else
  {
    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      summary2 = [(MADAutoAssetControlManager *)selfCopy summary];
      *buf = 138543362;
      v88 = summary2;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | Enabling in memory caching for persisted state objects", buf, 0xCu);
    }

    _MAPreferencesSetStringValue(@"persistedStateLoadingInProgress", @"YES", @"LoadPersistedResumeLocker", @"Indicating that loading of persisted state is starting");
  }

  persistedSetLookupResults = [(MADAutoAssetControlManager *)selfCopy persistedSetLookupResults];
  persistedConfig = [persistedSetLookupResults persistedConfig];
  [persistedConfig removePersistedState];

  persistedSetLookupResults2 = [(MADAutoAssetControlManager *)selfCopy persistedSetLookupResults];
  [persistedSetLookupResults2 removeAllPersistedEntries:@"removing any set-lookup-results stored when earlier pre-SU-staging new-OS promotion"];

  [(MADAutoAssetControlManager *)selfCopy removePreviouslyStagedSetDescriptors];
  persistedActiveJobs2 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobs];
  [persistedActiveJobs2 flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
  [persistedKnownDescriptors flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetConfigurations];
  [persistedKnownSetConfigurations flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
  [persistedKnownSetAtomicInstances flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
  [persistedActiveJobSetDescriptors flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  [persistedDownloadedSetDescriptors flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedSetTargets = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
  [persistedSetTargets flushPersistedStateCacheAndSetCachingBehaviour:v41 == 0];

  persistedSetLookupResults3 = [(MADAutoAssetControlManager *)selfCopy persistedSetLookupResults];
  [persistedSetLookupResults3 flushPersistedStateCacheAndSetCachingBehaviour:0];

  [MADAutoAssetLocker setPersistedStateCaching:0];
  [MADAutoAssetScheduler setPersistedStateCaching:v41 == 0];
  [MADAutoAssetStager setPersistedStateCaching:v41 == 0];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedDescriptors];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedActiveJobs];
  v79 = objc_alloc_init(NSMutableArray);
  locateDownloadedNewAllBySelector = [(MADAutoAssetControlManager *)selfCopy locateDownloadedNewAllBySelector];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"LoadPersistedResumeLocker" ofContainer:@"locateDownloadedNewAllBySelector"];
  v84 = 0u;
  v85 = 0u;
  v82 = 0u;
  v83 = 0u;
  v58 = locateDownloadedNewAllBySelector;
  v59 = [v58 countByEnumeratingWithState:&v82 objects:v91 count:16];
  if (v59)
  {
    v60 = *v83;
    do
    {
      v61 = 0;
      do
      {
        if (*v83 != v60)
        {
          objc_enumerationMutation(v58);
        }

        v62 = *(*(&v82 + 1) + 8 * v61);
        v63 = objc_autoreleasePoolPush();
        v64 = [v58 safeObjectForKey:v62 ofClass:objc_opt_class()];
        v65 = [MAAutoAssetSelector alloc];
        assetType = [v64 assetType];
        assetSpecifier = [v64 assetSpecifier];
        assetVersion = [v64 assetVersion];
        v69 = [v65 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

        if (v69)
        {
          [v79 addObject:v69];
        }

        objc_autoreleasePoolPop(v63);
        v61 = v61 + 1;
      }

      while (v59 != v61);
      v59 = [v58 countByEnumeratingWithState:&v82 objects:v91 count:16];
    }

    while (v59);
  }

  [MADAutoAssetLocker resumeFromPersistedWithDownloadedSelectors:v79];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedSetConfigurations];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedSetAtomicInstances];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedSetDownloadedDescriptors];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedCrosscheckStaleForceUnlock];
  [(MADAutoAssetControlManager *)selfCopy verifyLockerLatestSymlink];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedSetActiveJobDescriptors];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedSetTargets];
  [(MADAutoAssetControlManager *)selfCopy _removeSetDeterminedToBeIncomplete:@"LoadPersistedResumeLocker"];
  [(MADAutoAssetControlManager *)selfCopy loadPersistedAtomicInstancesSupportingShortTermLocking];
  +[MADAutoAssetSecure removeAllPersisted];
  v70 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v70, OS_LOG_TYPE_DEFAULT))
  {
    summary3 = [(MADAutoAssetControlManager *)selfCopy summary];
    *buf = 138543618;
    v88 = summary3;
    v89 = 1024;
    v90 = 600;
    _os_log_impl(&dword_0, v70, OS_LOG_TYPE_DEFAULT, "[%{public}@] {LoadPersistedResumeLocker} | creating timer for %d seconds for sync to complete", buf, 0x12u);
  }

  v80[0] = _NSConcreteStackBlock;
  v80[1] = 3221225472;
  v80[2] = __69__MADAutoAssetControlManager_action_LoadPersistedResumeLocker_error___block_invoke_2390;
  v80[3] = &unk_4B2B88;
  v80[4] = selfCopy;
  v72 = lockerCopy;
  v81 = v72;
  v73 = [NSTimer timerWithTimeInterval:0 repeats:v80 block:600.0];
  [(MADAutoAssetControlManager *)selfCopy setAwaitDownloadManagerSyncTimer:v73];

  v74 = +[NSRunLoop mainRunLoop];
  awaitDownloadManagerSyncTimer = [(MADAutoAssetControlManager *)selfCopy awaitDownloadManagerSyncTimer];
  [v74 addTimer:awaitDownloadManagerSyncTimer forMode:NSDefaultRunLoopMode];

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"LoadPersistedResumeLocker"];
  os_activity_scope_leave(&state);

  return 0;
}

void __69__MADAutoAssetControlManager_action_LoadPersistedResumeLocker_error___block_invoke_2390(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  [v2 postEvent:@"TimeoutAwaitingSynced" withInfo:*(a1 + 40)];
}

- (int64_t)action_ResumeStager:(id)stager error:(id *)error
{
  stagerCopy = stager;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeStager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeStager", v10.opaque[0], v10.opaque[1]];
  +[MADAutoAssetStager resumeFromPersisted];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SyncedResumeStager:(id)stager error:(id *)error
{
  stagerCopy = stager;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedResumeStager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"SyncedResumeStager", v12.opaque[0], v12.opaque[1]];
  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1];
  downloadsInFlight = [stagerCopy downloadsInFlight];
  v10 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:downloadsInFlight];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v10];

  +[MADAutoAssetStager resumeFromPersisted];
  os_activity_scope_leave(&v12);

  return 0;
}

- (int64_t)action_PromoteStagedMigrate:(id)migrate error:(id *)error
{
  migrateCopy = migrate;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16.opaque[0] = 0;
  v16.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PromoteStagedMigrate", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v16);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"ResumeStager", v16.opaque[0], v16.opaque[1]];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"PromoteStagedMigrate"];
  stagedSetLookupResults = [migrateCopy stagedSetLookupResults];
  [(MADAutoAssetControlManager *)self setStagedSetLookupResults:stagedSetLookupResults];

  [(MADAutoAssetControlManager *)self setStagerResumed:1];
  -[MADAutoAssetControlManager setStagerResumePostponed:](self, "setStagerResumePostponed:", [migrateCopy requiringLoadPriorToUse]);
  if ([migrateCopy newOSPromotion])
  {
    [(MADAutoAssetControlManager *)self _stagedNewOSPromoteAdoptSetTargets];
  }

  stagedToDownloaded = [migrateCopy stagedToDownloaded];
  [(MADAutoAssetControlManager *)self promoteAnyPreviouslyStagedNowDownloaded:stagedToDownloaded];

  [(MADAutoAssetControlManager *)self _preInstalledMigrateAssets];
  v11 = [MADAutoAssetControlManagerParam alloc];
  _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
  v13 = [(MADAutoAssetControlManagerParam *)v11 initWithSafeSummary:_updateLatestSummary];

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [autoControlManagerFSM2 postEvent:@"MigratedAssets" withInfo:v13];

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"PromoteStagedMigrate"];
  os_activity_scope_leave(&v16);

  return 0;
}

- (int64_t)action_ResumeScheduler:(id)scheduler error:(id *)error
{
  schedulerCopy = scheduler;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeScheduler", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeScheduler", v11.opaque[0], v11.opaque[1]];
  v9 = [(MADAutoAssetControlManager *)self setConfigurationCopy:@"ResumeScheduler"];
  [MADAutoAssetScheduler resumeFromPersisted:v9];

  os_activity_scope_leave(&v11);
  return 0;
}

- (int64_t)action_SyncInFlightDownloads:(id)downloads error:(id *)error
{
  downloadsCopy = downloads;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncInFlightDownloads", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _requestDownloadManagerSync:v10.opaque[0]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_Synced:(id)synced error:(id *)error
{
  syncedCopy = synced;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Synced", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  [(MADAutoAssetControlManager *)self setReceivedDownloadManagerSync:1, v12.opaque[0], v12.opaque[1]];
  downloadsInFlight = [syncedCopy downloadsInFlight];
  v10 = [(MADAutoAssetControlManager *)self _newTrimmedToAutoAssetsInFlight:downloadsInFlight];
  [(MADAutoAssetControlManager *)self setDownloadManagerInFlightTasks:v10];

  os_activity_scope_leave(&v12);
  return 0;
}

- (int64_t)action_AdditionalSynced:(id)synced error:(id *)error
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:synced];
  extendedStateQueue = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v8.opaque[0] = 0;
  v8.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:AdditionalSynced", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &v8);

  os_activity_scope_leave(&v8);
  return 0;
}

- (int64_t)action_ResumeJobsBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ResumeJobsBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"ResumeJobsBefore1st", v10.opaque[0], v10.opaque[1]];
  [(MADAutoAssetControlManager *)self resumeJobsWhenBeforeFirstUnlock:1];
  [(MADAutoAssetControlManager *)self resumeSetJobsWhenBeforeFirstUnlock:1];
  [(MADAutoAssetControlManager *)self clientRequestsAwaitingSyncToAwaitingFirstUnlock:@"ResumeJobsBefore1st"];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"ResumeJobsBefore1st"];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_ResumeJobs:(id)jobs error:(id *)error
{
  jobsCopy = jobs;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ResumeJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"ResumeScheduler"];
  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseBegin:@"ResumeJobs"];
  scheduledJobs = [jobsCopy scheduledJobs];
  [(MADAutoAssetControlManager *)selfCopy scheduledJobsResumed:scheduledJobs];

  v9 = selfCopy;
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"setConfigurationsRefreshStaleIndications"];
  [(MADAutoAssetControlManager *)selfCopy setConfigurationsRefreshStaleIndications];
  [(MADAutoAssetControlManager *)selfCopy setLocksPriorToSecureHealing:0];
  [(MADAutoAssetControlManager *)selfCopy setOperatingBeforeResumed:0];
  [(MADAutoAssetControlManager *)selfCopy setMaintainingActiveJobStatus:1];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"secureClearInsecureLatestAtomicInstances"];
  [(MADAutoAssetControlManager *)selfCopy secureClearInsecureLatestAtomicInstances];
  if ([(MADAutoAssetControlManager *)selfCopy migratedFromPreinstalled])
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      *buf = 138543362;
      v96 = _updateLatestSummary;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[DEVICE-BOOT] {ResumeJobs} migrated pre-installed assets", buf, 0xCu);
    }

    v9 = selfCopy;
  }

  [(MADAutoAssetControlManager *)v9 trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"persistedSetLookupResults-removeAllPersistedEntries"];
  persistedSetLookupResults = [(MADAutoAssetControlManager *)v9 persistedSetLookupResults];
  [persistedSetLookupResults removeAllPersistedEntries:@"removing any set-lookup-results just reported by pre-SU-staging new-OS promotion"];

  v82 = [NSString alloc];
  persistedActiveJobs = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobs];
  v80 = [persistedActiveJobs persistedEntryCount:@"ResumeJobs"];
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
  v78 = [persistedKnownDescriptors persistedEntryCount:@"ResumeJobs"];
  v76 = +[MADAutoAssetLocker persistedLocksCount];
  v74 = +[MADAutoAssetScheduler persistedScheduledCount];
  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetConfigurations];
  v72 = [persistedKnownSetConfigurations persistedEntryCount:@"ResumeJobs"];
  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
  v15 = [persistedKnownSetAtomicInstances persistedEntryCount:@"ResumeJobs"];
  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
  v17 = [persistedActiveJobSetDescriptors persistedEntryCount:@"ResumeJobs"];
  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  v19 = [persistedDownloadedSetDescriptors persistedEntryCount:@"ResumeJobs"];
  persistedSetTargets = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
  v21 = [persistedSetTargets persistedEntryCount:@"ResumeJobs"];
  persistedSetLookupResults2 = [(MADAutoAssetControlManager *)selfCopy persistedSetLookupResults];
  v81 = [v82 initWithFormat:@"ActiveJobs:%ld | KnownDescriptors:%ld | Locks:%ld | Scheduled:%ld | SetConfigurations:%ld | AtomicInstances:%ld | ActiveSetDescriptors:%ld | DownloadedSetDescriptors:%ld | SetTargets:%ld | SetLookupResults:%ld", v80, v78, v76, v74, v72, v15, v17, v19, v21, objc_msgSend(persistedSetLookupResults2, "persistedEntryCount:", @"ResumeJobs"];

  v23 = [NSString alloc];
  currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)selfCopy currentSetJobsByIdentifier];
  v25 = [currentSetJobsByIdentifier count];
  cancelingSetJobsByIdentifier = [(MADAutoAssetControlManager *)selfCopy cancelingSetJobsByIdentifier];
  v27 = [cancelingSetJobsByIdentifier count];
  currentSetStatusByInstance = [(MADAutoAssetControlManager *)selfCopy currentSetStatusByInstance];
  v79 = [v23 initWithFormat:@"SetJobsByIdentifier:%ld(canceling:%ld) | SetStatusByInstance:%ld", v25, v27, objc_msgSend(currentSetStatusByInstance, "count")];

  v29 = [NSString alloc];
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)selfCopy knownSetConfigurationsByIdentifier];
  v31 = [knownSetConfigurationsByIdentifier count];
  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
  v77 = [v29 initWithFormat:@"SetConfigurationsByIdentifier:%ld | SetAtomicInstancesByInstance:%ld", v31, objc_msgSend(knownSetAtomicInstancesByInstance, "count")];

  v33 = [NSString alloc];
  activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)selfCopy activeSetDescriptorsByIdentifier];
  v35 = [activeSetDescriptorsByIdentifier count];
  activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)selfCopy activeSetDescriptorsByInstance];
  v75 = [v33 initWithFormat:@"SetDescriptorsByIdentifier:%ld | SetDescriptorsByInstance:%ld", v35, objc_msgSend(activeSetDescriptorsByInstance, "count")];

  v37 = [NSString alloc];
  filesystemFileExistAtPathCache = [(MADAutoAssetControlManager *)selfCopy filesystemFileExistAtPathCache];
  v73 = [v37 initWithFormat:@"filesystemFileExistAtPathCache:%ld | filesystemStartupLookupCount:%ld", objc_msgSend(filesystemFileExistAtPathCache, "count"), -[MADAutoAssetControlManager filesystemStartupLookupCount](selfCopy, "filesystemStartupLookupCount")];

  v39 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138544130;
    v96 = v81;
    v97 = 2114;
    v98 = v79;
    v99 = 2114;
    v100 = v77;
    v101 = 2114;
    v102 = v75;
    _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [PERSISTED] %{public}@\n[STARTUP-STATE] [CURRENT] %{public}@\n[STARTUP-STATE] [KNOWN] %{public}@\n[STARTUP-STATE] [ACTIVE] %{public}@", buf, 0x2Au);
  }

  v40 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v96 = v73;
    _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [FILESYSTEM-CACHE] %{public}@", buf, 0xCu);
  }

  v41 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
  {
    v42 = +[MADAutoAssetControlManager buildDirectivesSummary];
    *buf = 138543618;
    v96 = @"3.0.4";
    v97 = 2114;
    v98 = v42;
    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-STATE] [AUTO-ASSET-VERSION:%{public}@] | build environment:%{public}@", buf, 0x16u);
  }

  knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
  v83 = [MADAutoAssetLocker currentSetLockUsageEliminatingOtherThanSetAtomicInstances:knownSetAtomicInstancesByInstance2];

  if (v83)
  {
    [(MADAutoAssetControlManager *)selfCopy setSetLockUsageMap:?];
    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      setLockUsageMap = [(MADAutoAssetControlManager *)selfCopy setLockUsageMap];
      *buf = 138543362;
      v96 = setLockUsageMap;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} | Set LockUsageMap | initialUsageMapFromLocker:\n%{public}@", buf, 0xCu);
    }
  }

  else
  {
    v46 = objc_alloc_init(NSMutableDictionary);
    [(MADAutoAssetControlManager *)selfCopy setSetLockUsageMap:v46];

    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} | Set LockUsageMap | no current set-locks reported by auto-asset-locker", buf, 2u);
    }
  }

  if ([(MADAutoAssetControlManager *)selfCopy startupActivationIsFirstExecutionSinceBoot:@"action_ResumeJobs"])
  {
    [(MADAutoAssetControlManager *)selfCopy shortTermLockFilesHealthCheck];
  }

  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    [(MADAutoAssetControlManager *)selfCopy handleSuspendResumeForSoftwareUpdateDaemonStartup];
  }

  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"resumeJobsWhenBeforeFirstUnlock:NO"];
  [(MADAutoAssetControlManager *)selfCopy resumeJobsWhenBeforeFirstUnlock:0];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"clientRequestsAwaitingDispatchAll"];
  [(MADAutoAssetControlManager *)selfCopy clientRequestsAwaitingDispatchAll:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"downloadManagerInFlightTasks-cancel"];
  v87 = getDownloadManager();
  v91 = 0u;
  v92 = 0u;
  v89 = 0u;
  v90 = 0u;
  downloadManagerInFlightTasks = [(MADAutoAssetControlManager *)selfCopy downloadManagerInFlightTasks];
  v48 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v89 objects:v94 count:16];
  if (v48)
  {
    v49 = *v90;
    do
    {
      for (i = 0; i != v48; i = i + 1)
      {
        if (*v90 != v49)
        {
          objc_enumerationMutation(downloadManagerInFlightTasks);
        }

        v51 = *(*(&v89 + 1) + 8 * i);
        v52 = objc_autoreleasePoolPush();
        if (v51)
        {
          [v87 cancelAssetDownloadTask:v51];
          autoControlManagerFSM2 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            *buf = 138543618;
            v96 = _updateLatestSummary2;
            v97 = 2114;
            v98 = v51;
            _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ResumeJobs} canceled stale auto-asset taskDescriptor:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v56 = [NSString alloc];
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v58 = [v56 initWithFormat:@"{ResumeJobs} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", _updateLatestSummary3];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v58 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v52);
      }

      v48 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v89 objects:v94 count:16];
    }

    while (v48);
  }

  [(MADAutoAssetControlManager *)selfCopy setDescriptorsRequiringPersonalization:0];
  [(MADAutoAssetControlManager *)selfCopy setDescriptorsRequiringGrafting:0];
  [(MADAutoAssetControlManager *)selfCopy setPrePersonalizedSelectors:0];
  [(MADAutoAssetControlManager *)selfCopy setFilesystemFileExistAtPathCache:0];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"flushPersistedStateCacheAndSetCachingBehaviour:NO"];
  persistedActiveJobs2 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobs];
  [persistedActiveJobs2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
  [persistedKnownDescriptors2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedSetTargets2 = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
  [persistedSetTargets2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedSetLookupResults3 = [(MADAutoAssetControlManager *)selfCopy persistedSetLookupResults];
  [persistedSetLookupResults3 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetConfigurations];
  [persistedKnownSetConfigurations2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  [persistedDownloadedSetDescriptors2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
  [persistedActiveJobSetDescriptors2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
  [persistedKnownSetAtomicInstances2 flushPersistedStateCacheAndSetCachingBehaviour:0];

  [MADAutoAssetLocker setPersistedStateCaching:0];
  [MADAutoAssetScheduler setPersistedStateCaching:0];
  [MADAutoAssetStager setPersistedStateCaching:0];
  [(MADAutoAssetControlManager *)selfCopy setStagedSetLookupResults:0];
  v67 = +[NSDate date];
  [v67 timeIntervalSince1970];
  v69 = v68;
  [(MADAutoAssetControlManager *)selfCopy startupTimeBeginSeconds];
  [(MADAutoAssetControlManager *)selfCopy setStartupTimeDurationSeconds:v69 - v70];

  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupStep:@"ResumeJobs" beginningStep:@"startupActivationCompleted"];
  [(MADAutoAssetControlManager *)selfCopy startupActivationCompleted:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"ResumeJobs"];
  [(MADAutoAssetControlManager *)selfCopy trackPerformanceStartupEnd:@"ResumeJobs"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_FailClientTimedOut:(id)out error:(id *)error
{
  outCopy = out;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12.opaque[0] = 0;
  v12.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:FailClientTimedOut", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v12);

  v9 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:v12.opaque[0]];
  diag = [v9 diag];
  [diag trackAnomaly:@"AUTO-CONTROL" forReason:@"action not yet implemented" withResult:6801 withError:0];

  os_activity_scope_leave(&v12);
  return 0;
}

- (int64_t)action_QueueClientRequest:(id)request error:(id *)error
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"QueueClientRequest"];
  if (!requestCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v20 = [NSString alloc];
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    clientRequest4 = [v20 initWithFormat:@"{QueueClientRequest} nil eventInfo provided | %@", _updateLatestSummary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:clientRequest4 withResult:6102 withError:0];
LABEL_9:

    goto LABEL_10;
  }

  clientRequest = [requestCopy clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:clientRequest];

  clientRequest2 = [requestCopy clientRequest];
  v10 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest2];

  if (!v10)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
    if (!autoControlManagerFSM2)
    {
      v41 = [NSString alloc];
      summary = [requestCopy summary];
      v40 = [v41 initWithFormat:@"invalid eventInfo (instance:MISSING) | eventInfo:%@", summary];
      goto LABEL_27;
    }

    if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:requestCopy])
    {
      clientAssetSelector = [autoControlManagerFSM2 clientAssetSelector];
      v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:clientAssetSelector fromLocation:@"QueueClientRequest"];

      if (v22)
      {
        v23 = [NSString alloc];
        clientRequest3 = [requestCopy clientRequest];
        summary2 = [clientRequest3 summary];
        v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", summary2];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6114 fromAction:@"QueueClientRequest" withDescription:v26];

        diag = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(diag, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_10;
        }

        clientRequest4 = [requestCopy clientRequest];
        _updateLatestSummary = [clientRequest4 summary];
        *buf = 138543362;
        v56 = _updateLatestSummary;
        v19 = "\n[ELIMINATE]{QueueClientRequest} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
        goto LABEL_16;
      }
    }

    clientRequest5 = [requestCopy clientRequest];
    v31 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest5];
    v32 = [(MADAutoAssetControlManager *)self _messageBlockedUntilDownloadManagerSync:v31];

    if ((v32 & 1) == 0)
    {

      goto LABEL_31;
    }

    clientRequest6 = [requestCopy clientRequest];
    diag = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest6];

    if (([SUCore stringIsEqual:diag to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) == 0 && ![SUCore stringIsEqual:diag to:@"MA-AUTO:LOCK_CONTENT"])
    {
      if ([SUCore stringIsEqual:diag to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"])
      {
        [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:requestCopy fromLocation:@"QueueClientRequest"];
        goto LABEL_10;
      }

      goto LABEL_37;
    }

    if ([(MADAutoAssetControlManager *)self isNoWaitRequestInvolvingSecureAsset:requestCopy])
    {
      clientRequest9 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(clientRequest9, OS_LOG_TYPE_DEFAULT))
      {
LABEL_36:

LABEL_37:
LABEL_38:
        clientRequest7 = [requestCopy clientRequest];
        v47 = [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest7 fromLocation:@"QueueClientRequest"];

        if (!v47)
        {
          v49 = [NSString alloc];
          clientRequest8 = [requestCopy clientRequest];
          summary3 = [clientRequest8 summary];
          v52 = [v49 initWithFormat:@"immediate timeout (unable to start timer) | clientRequest:%@", summary3];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6105 fromAction:@"QueueClientRequest" withDescription:v52];

          goto LABEL_29;
        }

        clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
        [clientRequestsAwaitingSync addObject:requestCopy];

        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self statistics];
        diag = [autoControlManagerFSM2 totalQueuedClientRequests];
        clientRequest9 = [requestCopy clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:diag forClientRequest:clientRequest9];
        goto LABEL_40;
      }

      clientRequest10 = [requestCopy clientRequest];
      summary4 = [clientRequest10 summary];
      *buf = 138543362;
      v56 = summary4;
      v37 = "\n{QueueClientRequest} queueing singleton check|lock client-request involving secure content until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    else
    {
      v44 = [(MADAutoAssetControlManager *)self handleClientPotentialJob:requestCopy alreadyScheduledSelector:0 forAutoJob:0 fromLocation:@"QueueClientRequest"];
      clientRequest9 = _MADLog(@"AutoControl");
      v45 = os_log_type_enabled(clientRequest9, OS_LOG_TYPE_DEFAULT);
      if (!v44)
      {
        if (v45)
        {
          clientRequest11 = [requestCopy clientRequest];
          summary5 = [clientRequest11 summary];
          *buf = 138543362;
          v56 = summary5;
          _os_log_impl(&dword_0, clientRequest9, OS_LOG_TYPE_DEFAULT, "\n{QueueClientRequest} responded to singleton check|lock client-request (NOT involving secure content) | clientRequest:%{public}@", buf, 0xCu);
        }

LABEL_40:

        goto LABEL_10;
      }

      if (!v45)
      {
        goto LABEL_36;
      }

      clientRequest10 = [requestCopy clientRequest];
      summary4 = [clientRequest10 summary];
      *buf = 138543362;
      v56 = summary4;
      v37 = "\n{QueueClientRequest} queueing singleton check|lock client-request (NOT involving secure content) until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    _os_log_impl(&dword_0, clientRequest9, OS_LOG_TYPE_DEFAULT, v37, buf, 0xCu);

    goto LABEL_36;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"QueueClientRequest" withEventInfo:requestCopy];
  if (!autoControlManagerFSM2)
  {
    v38 = [NSString alloc];
    summary = [requestCopy summary];
    v40 = [v38 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
LABEL_27:
    v42 = v40;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"QueueClientRequest" withDescription:v40];

    goto LABEL_28;
  }

  if (![(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:requestCopy]|| ![(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:autoControlManagerFSM2 fromLocation:@"QueueClientRequest"])
  {
    clientRequest12 = [requestCopy clientRequest];
    v28 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest12];
    v29 = [(MADAutoAssetControlManager *)self _messageBlockedUntilDownloadManagerSync:v28];

    if (v29)
    {
      goto LABEL_38;
    }

LABEL_31:
    [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:requestCopy fromLocation:@"QueueClientRequest"];
    goto LABEL_29;
  }

  v12 = [NSString alloc];
  clientRequest13 = [requestCopy clientRequest];
  summary6 = [clientRequest13 summary];
  v15 = [v12 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", summary6];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6114 fromAction:@"QueueClientRequest" withDescription:v15];

  diag = _MADLog(@"AutoControl");
  if (os_log_type_enabled(diag, OS_LOG_TYPE_ERROR))
  {
    clientRequest4 = [requestCopy clientRequest];
    _updateLatestSummary = [clientRequest4 summary];
    *buf = 138543362;
    v56 = _updateLatestSummary;
    v19 = "\n[SET-ELIMINATE]{QueueClientRequest} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
LABEL_16:
    _os_log_impl(&dword_0, diag, OS_LOG_TYPE_ERROR, v19, buf, 0xCu);
    goto LABEL_9;
  }

LABEL_10:

LABEL_28:
LABEL_29:
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"QueueClientRequest"];

  return 0;
}

- (int64_t)action_QueueClientRequestBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"QueueClientRequestBefore1st"];
  if (!before1stCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v20 = [NSString alloc];
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    clientRequest4 = [v20 initWithFormat:@"{QueueClientRequestBefore1st} nil eventInfo provided | %@", _updateLatestSummary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:clientRequest4 withResult:6102 withError:0];
LABEL_9:

LABEL_10:
    goto LABEL_11;
  }

  clientRequest = [before1stCopy clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:clientRequest];

  clientRequest2 = [before1stCopy clientRequest];
  v10 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest2];

  if (!v10)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:before1stCopy];
    if (!autoControlManagerFSM2)
    {
      v45 = [NSString alloc];
      summary = [before1stCopy summary];
      v44 = [v45 initWithFormat:@"invalid eventInfo (instance:MISSING)| eventInfo:%@", summary];
      goto LABEL_32;
    }

    if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:before1stCopy])
    {
      clientAssetSelector = [autoControlManagerFSM2 clientAssetSelector];
      v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:clientAssetSelector fromLocation:@"QueueClientRequestBefore1st"];

      if (v22)
      {
        v23 = [NSString alloc];
        clientRequest3 = [before1stCopy clientRequest];
        summary2 = [clientRequest3 summary];
        v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", summary2];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:before1stCopy withErrorCode:6114 fromAction:@"QueueClientRequestBefore1st" withDescription:v26];

        diag = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(diag, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_11;
        }

        clientRequest4 = [before1stCopy clientRequest];
        _updateLatestSummary = [clientRequest4 summary];
        *buf = 138543362;
        v62 = _updateLatestSummary;
        v19 = "\n[ELIMINATE]{QueueClientRequestBefore1st} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
LABEL_17:
        _os_log_impl(&dword_0, diag, OS_LOG_TYPE_ERROR, v19, buf, 0xCu);
        goto LABEL_9;
      }
    }

    clientRequest5 = [before1stCopy clientRequest];
    v34 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest5];
    clientAssetSelector2 = [autoControlManagerFSM2 clientAssetSelector];
    v36 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v34 forAssetSelector:clientAssetSelector2];

    if (!v36)
    {
      goto LABEL_29;
    }

    clientRequest6 = [before1stCopy clientRequest];
    diag = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest6];

    if (([SUCore stringIsEqual:diag to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) == 0 && ![SUCore stringIsEqual:diag to:@"MA-AUTO:LOCK_CONTENT"])
    {
      goto LABEL_40;
    }

    if ([(MADAutoAssetControlManager *)self isNoWaitRequestInvolvingSecureAsset:before1stCopy])
    {
      clientRequest14 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(clientRequest14, OS_LOG_TYPE_DEFAULT))
      {
LABEL_39:

        goto LABEL_40;
      }

      clientRequest7 = [before1stCopy clientRequest];
      summary3 = [clientRequest7 summary];
      *buf = 138543362;
      v62 = summary3;
      v41 = "\n{QueueClientRequestBefore1st} queueing singleton check|lock client-request involving secure content until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    else
    {
      v48 = [(MADAutoAssetControlManager *)self handleClientPotentialJob:before1stCopy alreadyScheduledSelector:0 forAutoJob:0 fromLocation:@"QueueClientRequest"];
      clientRequest14 = _MADLog(@"AutoControl");
      v49 = os_log_type_enabled(clientRequest14, OS_LOG_TYPE_DEFAULT);
      if (!v48)
      {
        if (v49)
        {
          clientRequest8 = [before1stCopy clientRequest];
          summary4 = [clientRequest8 summary];
          *buf = 138543362;
          v62 = summary4;
          _os_log_impl(&dword_0, clientRequest14, OS_LOG_TYPE_DEFAULT, "\n{QueueClientRequestBefore1st} responded to singleton check|lock client-request (NOT involving secure content) | clientRequest:%{public}@", buf, 0xCu);
        }

LABEL_43:

        goto LABEL_11;
      }

      if (!v49)
      {
        goto LABEL_39;
      }

      clientRequest7 = [before1stCopy clientRequest];
      summary3 = [clientRequest7 summary];
      *buf = 138543362;
      v62 = summary3;
      v41 = "\n{QueueClientRequestBefore1st} queueing singleton check|lock client-request (NOT involving secure content) until STARTUP_ACTIVATED | clientRequest:%{public}@";
    }

    _os_log_impl(&dword_0, clientRequest14, OS_LOG_TYPE_DEFAULT, v41, buf, 0xCu);

    goto LABEL_39;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"QueueClientRequestBefore1st" withEventInfo:before1stCopy];
  if (!autoControlManagerFSM2)
  {
    v42 = [NSString alloc];
    summary = [before1stCopy summary];
    v44 = [v42 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
LABEL_32:
    v46 = v44;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:before1stCopy withErrorCode:6102 fromAction:@"QueueClientRequestBefore1st" withDescription:v44];

    goto LABEL_33;
  }

  if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:before1stCopy]&& [(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:autoControlManagerFSM2 fromLocation:@"QueueClientRequestBefore1st"])
  {
    v12 = [NSString alloc];
    clientRequest9 = [before1stCopy clientRequest];
    summary5 = [clientRequest9 summary];
    v15 = [v12 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", summary5];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:before1stCopy withErrorCode:6114 fromAction:@"QueueClientRequestBefore1st" withDescription:v15];

    diag = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(diag, OS_LOG_TYPE_ERROR))
    {
LABEL_11:

LABEL_33:
      goto LABEL_34;
    }

    clientRequest4 = [before1stCopy clientRequest];
    _updateLatestSummary = [clientRequest4 summary];
    *buf = 138543362;
    v62 = _updateLatestSummary;
    v19 = "\n[SET-ELIMINATE]{QueueClientRequestBefore1st} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
    goto LABEL_17;
  }

  clientRequest10 = [before1stCopy clientRequest];
  v28 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest10];
  v29 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v28 forSetInstance:autoControlManagerFSM2];

  if (v29)
  {
    clientRequest11 = [before1stCopy clientRequest];
    diag = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest11];

    if (([SUCore stringIsEqual:diag to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:diag to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      v60 = 0;
      v31 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:autoControlManagerFSM2 dueToMessageName:diag selectedConfig:&v60];
      if (v31)
      {
        v32 = v31;
        _updateLatestSummary = [[NSString alloc] initWithFormat:@"unable to determine valid set-configuration when REQUIRED for operation [%@]", diag];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:before1stCopy withErrorCode:v32 fromAction:@"QueueClientRequestBefore1st" withDescription:_updateLatestSummary];
        goto LABEL_10;
      }

      v57 = [(MADAutoAssetControlManager *)self handleClientPotentialSetJob:before1stCopy forAutoJob:0 fromLocation:@"QueueClientRequestBefore1st"];

      if ((v57 & 1) == 0)
      {
        goto LABEL_34;
      }

      goto LABEL_41;
    }

    if (([SUCore stringIsEqual:diag to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0)
    {
      [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:before1stCopy fromLocation:@"QueueClientRequestBefore1st"];
      goto LABEL_11;
    }

LABEL_40:

LABEL_41:
    clientRequest12 = [before1stCopy clientRequest];
    v51 = [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest12 fromLocation:@"QueueClientRequestBefore1st"];

    if (!v51)
    {
      v53 = [NSString alloc];
      clientRequest13 = [before1stCopy clientRequest];
      summary6 = [clientRequest13 summary];
      v56 = [v53 initWithFormat:@"immediate timeout (unable to start timer) | clientRequest:%@", summary6];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:before1stCopy withErrorCode:6105 fromAction:@"QueueClientRequestBefore1st" withDescription:v56];

      goto LABEL_34;
    }

    clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
    [clientRequestsAwaitingSync addObject:before1stCopy];

    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self statistics];
    diag = [autoControlManagerFSM2 totalQueuedClientRequests];
    clientRequest14 = [before1stCopy clientRequest];
    [(MADAutoAssetControlManager *)self _statsIncrement:diag forClientRequest:clientRequest14];
    goto LABEL_43;
  }

LABEL_29:

  [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:before1stCopy fromLocation:@"QueueClientRequestBefore1st"];
LABEL_34:
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"QueueClientRequestBefore1st"];

  return 0;
}

- (int64_t)action_RemoveQueuedClient:(id)client error:(id *)error
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:client];
  extendedStateQueue = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  return 0;
}

- (int64_t)action_RouteClientRequest:(id)request error:(id *)error
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequest = [requestCopy clientRequest];
  [(MADAutoAssetControlManager *)self trackClientRequest:clientRequest];

  clientRequest2 = [requestCopy clientRequest];
  LODWORD(extendedStateQueue) = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest2];

  if (extendedStateQueue)
  {
    v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"RouteClientRequest" withEventInfo:requestCopy];
    if (v10)
    {
      if ([(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:requestCopy]&& [(MADAutoAssetControlManager *)self _setInstanceBeingEliminated:v10 fromLocation:@"RouteClientRequest"])
      {
        v11 = [NSString alloc];
        clientRequest3 = [requestCopy clientRequest];
        summary = [clientRequest3 summary];
        v14 = [v11 initWithFormat:@"in-progress elimination blocking new set-request | clientRequest:%@", summary];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6114 fromAction:@"RouteClientRequest" withDescription:v14];

        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          clientRequest4 = [requestCopy clientRequest];
          summary2 = [clientRequest4 summary];
          *buf = 138543362;
          v34 = summary2;
          v18 = "\n[SET-ELIMINATE]{RouteClientRequest} [EliminationInProgress] in-progress elimination blocking new set-request | clientRequest:%{public}@";
LABEL_13:
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, v18, buf, 0xCu);

          goto LABEL_14;
        }

        goto LABEL_14;
      }

      goto LABEL_16;
    }

    v27 = [NSString alloc];
    summary3 = [requestCopy summary];
    v29 = [v27 initWithFormat:@"{RouteClientRequest} invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary3];
LABEL_19:
    v31 = v29;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v29];

    goto LABEL_20;
  }

  v19 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
  v10 = v19;
  if (!v19)
  {
    v30 = [NSString alloc];
    summary3 = [requestCopy summary];
    v29 = [v30 initWithFormat:@"{RouteClientRequest} invalid eventInfo (instance:MISSING) | eventInfo:%@", summary3];
    goto LABEL_19;
  }

  clientAssetSelector = [v19 clientAssetSelector];
  if (!clientAssetSelector || ![(MADAutoAssetControlManager *)self _isClientRequestSubjectToElimination:requestCopy])
  {

    goto LABEL_16;
  }

  clientAssetSelector2 = [v10 clientAssetSelector];
  v22 = [(MADAutoAssetControlManager *)self _selectorBeingEliminated:clientAssetSelector2 fromLocation:@"RouteClientRequest"];

  if (!v22)
  {
LABEL_16:
    [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:requestCopy fromLocation:@"RouteClientRequest"];
    goto LABEL_20;
  }

  v23 = [NSString alloc];
  clientRequest5 = [requestCopy clientRequest];
  summary4 = [clientRequest5 summary];
  v26 = [v23 initWithFormat:@"in-progress elimination blocking new request | clientRequest:%@", summary4];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6114 fromAction:@"RouteClientRequest" withDescription:v26];

  v15 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
  {
    clientRequest4 = [requestCopy clientRequest];
    summary2 = [clientRequest4 summary];
    *buf = 138543362;
    v34 = summary2;
    v18 = "\n[ELIMINATE]{RouteClientRequest} [EliminationInProgress] in-progress elimination blocking new request | clientRequest:%{public}@";
    goto LABEL_13;
  }

LABEL_14:

LABEL_20:
  return 0;
}

- (int64_t)action_RouteClientClosed:(id)closed error:(id *)error
{
  v4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:closed];
  extendedStateQueue = [v4 extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  return 0;
}

- (int64_t)action_QueueDownloadManager:(id)manager error:(id *)error
{
  managerCopy = manager;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:QueueDownloadManager", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  if (!managerCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v23 = [NSString alloc];
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v25 = [v23 initWithFormat:@"{QueueDownloadManager} nil eventInfo provided | %@", _updateLatestSummary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6111 withError:0];

LABEL_12:
    goto LABEL_13;
  }

  downloadManagerEventsAwaitingResumed = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  [downloadManagerEventsAwaitingResumed addObject:managerCopy];

  downloadManagerEventsAwaitingResumed2 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v11 = [downloadManagerEventsAwaitingResumed2 count] > 0x400;

  if (v11)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeRemoveType:8];
  }

  downloadManagerEventsAwaitingResumed3 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v13 = [downloadManagerEventsAwaitingResumed3 count] > 0x400;

  if (v13)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeRemoveType:8];
  }

  downloadManagerEventsAwaitingResumed4 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v15 = [downloadManagerEventsAwaitingResumed4 count] > 0x400;

  if (v15)
  {
    [(MADAutoAssetControlManager *)self _awaitingResumeReduceToLatest];
  }

  downloadManagerEventsAwaitingResumed5 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v17 = [downloadManagerEventsAwaitingResumed5 count] > 0x400;

  if (v17)
  {
    autoControlManagerFSM2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      downloadManagerEventsAwaitingResumed6 = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
      v21 = [downloadManagerEventsAwaitingResumed6 count];
      *buf = 138543618;
      v29 = _updateLatestSummary2;
      v30 = 2048;
      v31 = v21;
      _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_ERROR, "[%{public}@] {QueueDownloadManager} | unable to reduce downloadManagerEventsAwaitingResumed (excessive auto-asset-jobs in-flight) | awaitingCount:%ld", buf, 0x16u);
    }

    goto LABEL_12;
  }

LABEL_13:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_RouteCatalogFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteCatalogFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeCatalogFinished:@"RouteCatalogFinished" withEventInfo:finishedCopy, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RouteConfigFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteConfigFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeConfigFinished:@"RouteConfigFinished" withEventInfo:finishedCopy, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RouteAssetFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:RouteAssetFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _routeAssetFinished:@"RouteAssetFinished" withEventInfo:finishedCopy, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_Before1stCatalogFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stCatalogFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  v11 = [NSString alloc];
  summary = [finishedCopy summary];
  v13 = [v11 initWithFormat:@"{Before1stCatalogFinished} DownloadManager indication of catalog lookup finished when device is before first-unlock | eventInfo:%@", summary];
  [diag trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_Before1stConfigFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stConfigFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  v11 = [NSString alloc];
  summary = [finishedCopy summary];
  v13 = [v11 initWithFormat:@"{Before1stConfigFinished} DownloadManager indication of download configuration change finished when device is before first-unlock | eventInfo:%@", summary];
  [diag trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_Before1stAssetFinished:(id)finished error:(id *)error
{
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:Before1stAssetFinished", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  v11 = [NSString alloc];
  summary = [finishedCopy summary];
  v13 = [v11 initWithFormat:@"{Before1stAssetFinished} DownloadManager indication of asset download finished when device is before first-unlock | eventInfo:%@", summary];
  [diag trackAnomaly:@"AUTO-CONTROL:BEFORE-FIRST" forReason:v13 withResult:6101 withError:0];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_SyncedReviewUnlocked:(id)unlocked error:(id *)error
{
  unlockedCopy = unlocked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedReviewUnlocked", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self clientRequestsAwaitingDispatchAll:@"SyncedReviewUnlocked", v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SyncedReviewBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SyncedReviewBefore1st", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self clientRequestsAwaitingSyncToAwaitingFirstUnlock:@"SyncedReviewBefore1st", v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_ObtainLookupGrant:(id)grant error:(id *)error
{
  grantCopy = grant;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ObtainLookupGrant", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoAssetSelector = [grantCopy autoAssetSelector];
  LODWORD(v8) = autoAssetSelector == 0;

  if (v8)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [grantCopy summary];
      *buf = 138543618;
      v63 = _updateLatestSummary;
      v64 = 2114;
      v65 = summary;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ObtainLookupGrant} | job obtain-lookup-grant without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    autoAssetSelector2 = [grantCopy autoAssetSelector];
    assetType = [autoAssetSelector2 assetType];
    v12 = assetType == 0;

    if (!v12)
    {
      autoAssetUUID = [grantCopy autoAssetUUID];
      fromAutoAssetJob = [grantCopy fromAutoAssetJob];
      originalSelector = [grantCopy originalSelector];
      v16 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID potentiallyResumingJob:fromAutoAssetJob withOriginalSelector:originalSelector fromLocation:@"ObtainLookupGrant" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job obtain-lookup-grant" downloadingDescriptor:0 baseForPatchDescriptor:0, state.opaque[0], state.opaque[1]];

      if (v16)
      {
        lookupGrantsByAssetType = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
        autoAssetSelector3 = [grantCopy autoAssetSelector];
        assetType2 = [autoAssetSelector3 assetType];
        autoControlManagerFSM3 = [lookupGrantsByAssetType safeObjectForKey:assetType2 ofClass:objc_opt_class()];

        if (!autoControlManagerFSM3)
        {
          v35 = [MADAutoAssetLookupGrant alloc];
          autoAssetSelector4 = [grantCopy autoAssetSelector];
          assetType3 = [autoAssetSelector4 assetType];
          autoControlManagerFSM3 = [(MADAutoAssetLookupGrant *)v35 initForAssetType:assetType3];

          autoAssetUUID2 = [grantCopy autoAssetUUID];
          [autoControlManagerFSM3 setHolderJobUUID:autoAssetUUID2];

          lookupGrantsByAssetType2 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
          autoAssetSelector5 = [grantCopy autoAssetSelector];
          assetType4 = [autoAssetSelector5 assetType];
          [lookupGrantsByAssetType2 setSafeObject:autoControlManagerFSM3 forKey:assetType4];

          [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:autoControlManagerFSM3 message:@"first job requesting exclusive lookup grant for asset-type"];
          holderJobUUID = [autoControlManagerFSM3 holderJobUUID];
          [v16 exclusiveLookupForAssetTypeGranted:holderJobUUID];
LABEL_25:

          goto LABEL_26;
        }

        holderJobUUID2 = [autoControlManagerFSM3 holderJobUUID];
        v22 = holderJobUUID2 == 0;

        if (v22)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v44 = [NSString alloc];
          summary2 = [autoControlManagerFSM3 summary];
          v46 = [v44 initWithFormat:@"{ObtainLookupGrant} pre-existing lookup-grant with no current holder of the grant | lookupGrant:%@", summary2];
          [diag trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v46 withResult:6111 withError:0];

          do
          {
            awaitingExclusiveGrant = [autoControlManagerFSM3 awaitingExclusiveGrant];
            v48 = [awaitingExclusiveGrant count] == 0;

            if (v48)
            {
              autoAssetUUID3 = [grantCopy autoAssetUUID];
              [autoControlManagerFSM3 setHolderJobUUID:autoAssetUUID3];

              v57 = objc_alloc_init(NSMutableArray);
              [autoControlManagerFSM3 setAwaitingExclusiveGrant:v57];

              [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:autoControlManagerFSM3 message:@"one-and-only job that has just requested the grant"];
              holderJobUUID = [autoControlManagerFSM3 holderJobUUID];
              [v16 exclusiveLookupForAssetTypeGranted:holderJobUUID];
              goto LABEL_25;
            }

            holderJobUUID = [(MADAutoAssetControlManager *)self jobToBeGivenGrant:autoControlManagerFSM3];
          }

          while (!holderJobUUID);
          autoAssetUUID4 = [grantCopy autoAssetUUID];
          v50 = autoAssetUUID4 == 0;

          if (!v50)
          {
            awaitingExclusiveGrant2 = [autoControlManagerFSM3 awaitingExclusiveGrant];
            autoAssetUUID5 = [grantCopy autoAssetUUID];
            [awaitingExclusiveGrant2 addObject:autoAssetUUID5];

            [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ObtainLookupGrant" ofLookupGrant:autoControlManagerFSM3 message:@"grant given to the next in line (after detection of pre-existing lookup-grant with no current holder)"];
            holderJobUUID3 = [autoControlManagerFSM3 holderJobUUID];
            [holderJobUUID exclusiveLookupForAssetTypeGranted:holderJobUUID3];
            goto LABEL_24;
          }

          holderJobUUID3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag2 = [holderJobUUID3 diag];
          v58 = [NSString alloc];
          summary3 = [autoControlManagerFSM3 summary];
          summary4 = [grantCopy summary];
          v59 = [v58 initWithFormat:@"{ObtainLookupGrant} about to give grant yet nil eventInfo.autoAssetUUID | lookupGrant:%@ | eventInfo:%@", summary3, summary4];
          [diag2 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v59 withResult:6111 withError:0];
        }

        else
        {
          autoAssetUUID6 = [grantCopy autoAssetUUID];
          v24 = autoAssetUUID6 == 0;

          if (!v24)
          {
            awaitingExclusiveGrant3 = [autoControlManagerFSM3 awaitingExclusiveGrant];
            autoAssetUUID7 = [grantCopy autoAssetUUID];
            [awaitingExclusiveGrant3 addObject:autoAssetUUID7];

            [(MADAutoAssetControlManager *)self _logLookupGrantAwaiting:@"ObtainLookupGrant" ofLookupGrant:autoControlManagerFSM3 message:@"job awaiting obtain-lookup-grant"];
LABEL_26:

            goto LABEL_27;
          }

          holderJobUUID = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          holderJobUUID3 = [holderJobUUID diag];
          v53 = [NSString alloc];
          diag2 = [autoControlManagerFSM3 summary];
          summary3 = [grantCopy summary];
          summary4 = [v53 initWithFormat:@"{ObtainLookupGrant} about to put at back of the line yet nil eventInfo.autoAssetUUID | lookupGrant:%@ | eventInfo:%@", diag2, summary3];
          [holderJobUUID3 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:summary4 withResult:6111 withError:0];
        }
      }

      else
      {
        autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        holderJobUUID = [autoControlManagerFSM3 diag];
        v32 = [NSString alloc];
        holderJobUUID3 = [grantCopy summary];
        diag2 = [v32 initWithFormat:@"{ObtainLookupGrant} job requesting lookup-grant not a current job | eventInfo:%@", holderJobUUID3];
        [holderJobUUID trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:diag2 withResult:6111 withError:0];
      }

LABEL_24:
      goto LABEL_25;
    }

    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary5 = [grantCopy summary];
      *buf = 138543618;
      v63 = _updateLatestSummary2;
      v64 = 2114;
      v65 = summary5;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ObtainLookupGrant} | job obtain-lookup-grant without asset-type | event:%{public}@", buf, 0x16u);
    }
  }

LABEL_27:

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ReleaseLookupGrant:(id)grant error:(id *)error
{
  grantCopy = grant;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ReleaseLookupGrant", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoAssetSelector = [grantCopy autoAssetSelector];
  LODWORD(v8) = autoAssetSelector == 0;

  if (v8)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [grantCopy summary];
      *buf = 138543618;
      v58 = _updateLatestSummary;
      v59 = 2114;
      v60 = summary;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ReleaseLookupGrant} | job release-lookup-grant without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    autoAssetSelector2 = [grantCopy autoAssetSelector];
    assetType = [autoAssetSelector2 assetType];
    v12 = assetType == 0;

    if (!v12)
    {
      autoAssetUUID = [grantCopy autoAssetUUID];
      fromAutoAssetJob = [grantCopy fromAutoAssetJob];
      originalSelector = [grantCopy originalSelector];
      v16 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID potentiallyResumingJob:fromAutoAssetJob withOriginalSelector:originalSelector fromLocation:@"ReleaseLookupGrant" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job release-lookup-grant" downloadingDescriptor:0 baseForPatchDescriptor:0, state.opaque[0], state.opaque[1]];

      lookupGrantsByAssetType = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
      autoAssetSelector3 = [grantCopy autoAssetSelector];
      assetType2 = [autoAssetSelector3 assetType];
      v20 = [lookupGrantsByAssetType safeObjectForKey:assetType2 ofClass:objc_opt_class()];

      if (v20)
      {
        assetType3 = [v20 assetType];
        v22 = assetType3 == 0;

        if (!v22)
        {
          if (!v16)
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            v25 = [NSString alloc];
            summary2 = [v20 summary];
            v27 = [v25 initWithFormat:@"{ReleaseLookupGrant} failed job lookup for lookupGrant:%@", summary2];
            [diag trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v27 withResult:6111 withError:0];
          }

          holderJobUUID = [v20 holderJobUUID];
          v29 = holderJobUUID == 0;

          if (v29)
          {
            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag2 = [autoControlManagerFSM3 diag];
            v50 = [NSString alloc];
            summary3 = [v20 summary];
            summary4 = [v50 initWithFormat:@"{ReleaseLookupGrant} pre-existing lookup-grant with no current holder of the grant | lookupGrant:%@", summary3];
            [diag2 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:summary4 withResult:6111 withError:0];
          }

          else
          {
            autoAssetUUID2 = [grantCopy autoAssetUUID];
            holderJobUUID2 = [v20 holderJobUUID];
            v32 = [SUCore stringIsEqual:autoAssetUUID2 to:holderJobUUID2];

            if (v32)
            {
              goto LABEL_19;
            }

            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag2 = [autoControlManagerFSM3 diag];
            v35 = [NSString alloc];
            summary3 = [grantCopy autoAssetUUID];
            summary4 = [v20 summary];
            v38 = [v35 initWithFormat:@"{ReleaseLookupGrant} pre-existing lookup-grant with different grant holder | releasingJobUUID:%@, lookupGrant:%@", summary3, summary4];
            [diag2 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v38 withResult:6111 withError:0];
          }

LABEL_19:
          while (1)
          {
            awaitingExclusiveGrant = [v20 awaitingExclusiveGrant];
            v52 = [awaitingExclusiveGrant count] == 0;

            if (v52)
            {
              break;
            }

            autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self jobToBeGivenGrant:v20];
            if (autoControlManagerFSM4)
            {
              [(MADAutoAssetControlManager *)self _logLookupGrantObtained:@"ReleaseLookupGrant" ofLookupGrant:v20 message:@"post-release when other job awaiting obtain-lookup-grant"];
              holderJobUUID3 = [v20 holderJobUUID];
              [autoControlManagerFSM4 exclusiveLookupForAssetTypeGranted:holderJobUUID3];
              goto LABEL_22;
            }
          }

          lookupGrantsByAssetType2 = [(MADAutoAssetControlManager *)self lookupGrantsByAssetType];
          assetType4 = [v20 assetType];
          [lookupGrantsByAssetType2 removeObjectForKey:assetType4];

          [(MADAutoAssetControlManager *)self _logLookupGrantReleased:@"ReleaseLookupGrant" ofLookupGrant:v20 message:@"no jobs awaiting obtain-lookup-grant"];
LABEL_23:

          goto LABEL_24;
        }

        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        holderJobUUID3 = [autoControlManagerFSM4 diag];
        v49 = [NSString alloc];
        summary5 = [v20 summary];
        assetType5 = [v49 initWithFormat:@"{ReleaseLookupGrant} lookup-grant without assetType:%@", summary5];
        [holderJobUUID3 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:assetType5 withResult:6111 withError:0];
      }

      else
      {
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        holderJobUUID3 = [autoControlManagerFSM4 diag];
        v45 = [NSString alloc];
        summary5 = [grantCopy autoAssetSelector];
        assetType5 = [summary5 assetType];
        v48 = [v45 initWithFormat:@"{ReleaseLookupGrant} no lookup-grant for assetType:%@", assetType5];
        [holderJobUUID3 trackAnomaly:@"AUTO-CONTROL:LOOKUP-GRANT" forReason:v48 withResult:6111 withError:0];
      }

LABEL_22:
      goto LABEL_23;
    }

    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary6 = [grantCopy summary];
      *buf = 138543618;
      v58 = _updateLatestSummary2;
      v59 = 2114;
      v60 = summary6;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@:LOOKUP-GRANT] {ReleaseLookupGrant} | job release-lookup-grant without asset-type | event:%{public}@", buf, 0x16u);
    }
  }

LABEL_24:

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ProvidePersistedForJob:(id)job error:(id *)error
{
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ProvidePersistedForJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoAssetSelector = [jobCopy autoAssetSelector];
  LODWORD(v8) = autoAssetSelector == 0;

  if (v8)
  {
    v20 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [jobCopy summary];
      *buf = 138543618;
      v31 = _updateLatestSummary;
      v32 = 2114;
      v33 = summary;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without asset-selector | event:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    autoAssetSelector2 = [jobCopy autoAssetSelector];
    assetVersion = [autoAssetSelector2 assetVersion];
    v12 = assetVersion == 0;

    if (v12)
    {
      v20 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary2 = [jobCopy summary];
        *buf = 138543618;
        v31 = _updateLatestSummary2;
        v32 = 2114;
        v33 = summary2;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without asset-version | event:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      downloadingDescriptor = [jobCopy downloadingDescriptor];
      v14 = downloadingDescriptor == 0;

      if (v14)
      {
        v20 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary3 = [jobCopy summary];
          *buf = 138543618;
          v31 = _updateLatestSummary3;
          v32 = 2114;
          v33 = summary3;
          _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "[%{public}@] {ProvidePersistedForJob} | job requesting persist without downloading-descriptor | event:%{public}@", buf, 0x16u);
        }
      }

      else
      {
        autoAssetUUID = [jobCopy autoAssetUUID];
        fromAutoAssetJob = [jobCopy fromAutoAssetJob];
        originalSelector = [jobCopy originalSelector];
        downloadingDescriptor2 = [jobCopy downloadingDescriptor];
        baseForPatchDescriptor = [jobCopy baseForPatchDescriptor];
        v20 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID potentiallyResumingJob:fromAutoAssetJob withOriginalSelector:originalSelector fromLocation:@"ProvidePersistedForJob" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job requesting persisted-state" downloadingDescriptor:downloadingDescriptor2 baseForPatchDescriptor:baseForPatchDescriptor, state.opaque[0], state.opaque[1]];

        if (v20)
        {
          autoAssetJobID = [jobCopy autoAssetJobID];
          [v20 persistedStateForDownloadJob:autoAssetJobID];
        }
      }
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_SetJobLookupResponseRcvd:(id)rcvd error:(id *)error
{
  rcvdCopy = rcvd;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v31.opaque[0] = 0;
  v31.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SetJobLookupResponseRcvd", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v31);

  setConfiguration = [rcvdCopy setConfiguration];
  LODWORD(v8) = setConfiguration == 0;

  if (!v8)
  {
    setConfiguration2 = [rcvdCopy setConfiguration];
    clientDomainName = [setConfiguration2 clientDomainName];
    setConfiguration3 = [rcvdCopy setConfiguration];
    assetSetIdentifier = [setConfiguration3 assetSetIdentifier];
    v14 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    v15 = [[NSMutableString alloc] initWithString:@"lookup-response"];
    if (v14)
    {
      autoAssetCatalog = [rcvdCopy autoAssetCatalog];
      v17 = autoAssetCatalog == 0;

      if (!v17)
      {
        autoAssetCatalog2 = [rcvdCopy autoAssetCatalog];
        v19 = [autoAssetCatalog2 safeStringForKey:@"CachedAssetSetId"];

        if (v19)
        {
          autoAssetCatalog3 = [rcvdCopy autoAssetCatalog];
          autoControlManagerFSM2 = [autoAssetCatalog3 safeStringForKey:@"DownloadedFromLive"];

          if (autoControlManagerFSM2)
          {
            v22 = [[NSURL alloc] initWithString:autoControlManagerFSM2];
          }

          else
          {
            v22 = objc_opt_new();
          }

          diag = v22;
          [v14 setMostRecentlyReceivedCachedAssetSetID:v19];
          [v14 setMostRecentlyReceivedDownloadedFromLive:diag];
          autoAssetCatalog4 = [rcvdCopy autoAssetCatalog];
          v27 = [autoAssetCatalog4 safeDateForKey:@"lastTimeChecked"];
          [v14 setMostRecentlyReceivedLastTimeChecked:v27];

          autoAssetCatalog5 = [rcvdCopy autoAssetCatalog];
          v29 = [autoAssetCatalog5 safeDateForKey:@"postedDate"];
          [v14 setMostRecentlyReceivedPostedDate:v29];

          [v15 appendString:{@", refreshed most-recently-received"}];
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{SetJobLookupResponseRcvd} auto-asset-catalog provided by set-job MISSING MA_CACHED_ASSET_ID_KEY" withResult:6103 withError:0];
        }

        if (([v14 haveReceivedLookupResponse]& 1) != 0)
        {

          if (!v19)
          {
            goto LABEL_19;
          }
        }

        else
        {
          [v14 setHaveReceivedLookupResponse:1];
          [v15 appendString:{@", set have-received-lookup-response"}];
        }

        goto LABEL_18;
      }

      if (([v14 haveReceivedLookupResponse]& 1) == 0)
      {
        [v14 setHaveReceivedLookupResponse:1];
        [v15 appendString:{@", set have-received-lookup-response"}];
LABEL_18:
        [(MADAutoAssetControlManager *)self setConfigurationPersist:v14 fromLocation:@"SetJobLookupResponseRcvd" forReason:v15 dueToAlter:0 forHistoryOperation:448];
      }
    }

LABEL_19:

    goto LABEL_20;
  }

  v14 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [rcvdCopy summary];
    *buf = 138543618;
    v33 = _updateLatestSummary;
    v34 = 2114;
    v35 = summary;
    _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "[%{public}@] {SetJobLookupResponseRcvd} | job indicating lookup response received yet no set-configuation | event:%{public}@", buf, 0x16u);
  }

LABEL_20:

  os_activity_scope_leave(&v31);
  return 0;
}

- (int64_t)action_IssueClientReplyJobResponse:(id)response error:(id *)error
{
  responseCopy = response;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:IssueClientReplyJobResponse", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  autoAssetUUID = [responseCopy autoAssetUUID];
  v11 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID fromLocation:@"IssueClientReplyJobResponse" notFoundCode:0 notFoundReason:0];

  fromAutoAssetJob = [responseCopy fromAutoAssetJob];
  if (fromAutoAssetJob)
  {
    fromAutoAssetJob2 = [responseCopy fromAutoAssetJob];
    if ([fromAutoAssetJob2 autoAssetSetJob])
    {

LABEL_11:
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:@"{IssueClientReplyJobRespons} should never be called for set-job" withResult:6103 withError:0];
      goto LABEL_48;
    }

    if (!v11)
    {

      goto LABEL_13;
    }
  }

  else if (!v11)
  {
    goto LABEL_13;
  }

  autoAssetSetJob = [v11 autoAssetSetJob];
  v14 = autoAssetSetJob;
  if (fromAutoAssetJob)
  {

    if (v14)
    {
      goto LABEL_11;
    }
  }

  else if (autoAssetSetJob)
  {
    goto LABEL_11;
  }

LABEL_13:
  autoAssetUUID2 = [responseCopy autoAssetUUID];
  fromAutoAssetJob3 = [responseCopy fromAutoAssetJob];
  originalSelector = [responseCopy originalSelector];
  v20 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID2 potentiallyResumingJob:fromAutoAssetJob3 withOriginalSelector:originalSelector fromLocation:@"IssueClientReplyJobResponse" notFoundCode:6111 notFoundReason:@"unknown auto-asset-job requesting reply with job response (and unable to resume)" downloadingDescriptor:0 baseForPatchDescriptor:0];

  autoControlManagerFSM2 = [responseCopy jobInformation];
  diag = [autoControlManagerFSM2 initialAssetSelector];
  fullAssetSelector = [autoControlManagerFSM2 fullAssetSelector];
  currentStatus = [autoControlManagerFSM2 currentStatus];
  responseError = [responseCopy responseError];
  clientRequest = [responseCopy clientRequest];
  clientRequestMessage = [clientRequest clientRequestMessage];
  v56 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

  if (!responseError)
  {
    if (diag)
    {
      assetVersion = [diag assetVersion];
    }

    else
    {
      assetVersion = 0;
    }

    autoAssetUUID3 = [responseCopy autoAssetUUID];
    if (fullAssetSelector)
    {
      [(MADAutoAssetControlManager *)self updateAutoAssetStatus:fullAssetSelector forActiveJobUUID:autoAssetUUID3 withLatestJobStatus:currentStatus matchingAssetVersion:assetVersion fromLocation:@"IssueClientReplyJobResponse(full-selector)"];
    }

    else
    {
      [(MADAutoAssetControlManager *)self updateAutoAssetStatus:diag forActiveJobUUID:autoAssetUUID3 withLatestJobStatus:currentStatus matchingAssetVersion:assetVersion fromLocation:@"IssueClientReplyJobResponse(initial-selector)"];
    }

    clientRequest2 = [responseCopy clientRequest];
    clientReplyCompletion = [clientRequest2 clientReplyCompletion];
    if (clientReplyCompletion)
    {
      v28 = [SUCore stringIsEqual:v56 to:@"MA-AUTO(REPLY):LOCK_CONTENT"];

      if (v28)
      {
        assetType = [fullAssetSelector assetType];
        assetSpecifier = [fullAssetSelector assetSpecifier];
        assetVersion2 = [fullAssetSelector assetVersion];
        v57 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"IssueClientReplyJobResponse" forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion2];

        if (v57)
        {
          v32 = [MAAutoAssetSelector alloc];
          assetType2 = [v57 assetType];
          assetSpecifier2 = [v57 assetSpecifier];
          assetVersion3 = [v57 assetVersion];
          clientRequest2 = [v32 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion3];

          if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"IssueClientReplyJobResponse" forDescriptor:v57]&& [MADAutoAssetSecure isPersonalizationRequired:@"IssueClientReplyJobResponse" forDescriptor:v57])
          {
            [v57 setSecureOperationInProgress:1];
            v36 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v57];
            v37 = v60;
            v60[0] = _NSConcreteStackBlock;
            v60[1] = 3221225472;
            v60[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke;
            v60[3] = &unk_4B4680;
            v60[4] = self;
            v38 = v57;
            v60[5] = v38;
            v60[6] = clientRequest2;
            v60[7] = responseCopy;
            [MADAutoAssetSecure personalizeGraftDownloaded:@"IssueClientReplyJobResponse" forDescriptor:v38 setDescriptor:v36 allowingNetwork:1 completion:v60];
LABEL_34:

            goto LABEL_40;
          }

          if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:@"IssueClientReplyJobResponse" forDescriptor:v57]&& ![MADAutoAssetSecure isGraftedOrMounted:@"IssueClientReplyJobResponse" forDescriptor:v57])
          {
            v39 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
            {
              summary = [v57 summary];
              *buf = 138543362;
              v63 = summary;
              _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | triggering graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
            }

            [v57 setSecureOperationInProgress:1];
            v36 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v57];
            v37 = v59;
            v59[0] = _NSConcreteStackBlock;
            v59[1] = 3221225472;
            v59[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2589;
            v59[3] = &unk_4B4680;
            v59[4] = self;
            v41 = v57;
            v59[5] = v41;
            v59[6] = clientRequest2;
            v59[7] = responseCopy;
            [MADAutoAssetSecure graftDownloaded:@"IssueClientReplyJobResponse" graftingDescriptor:v41 setDescriptor:v36 completion:v59];
            goto LABEL_34;
          }

          goto LABEL_28;
        }

        responseError = [MAAutoAssetError buildError:6504 fromOperation:@"IssueClientReplyJobResponse" underlyingError:0 withDescription:@"job successfully downloaded asset yet asset not present on the filesystem"];
        if (responseError)
        {
          goto LABEL_14;
        }
      }

      v57 = 0;
      goto LABEL_37;
    }

    v57 = 0;
LABEL_28:

LABEL_37:
    if ([SUCore stringIsEqual:v56 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
      [(MADAutoAssetControlManager *)self lockAutoAssetReplyJobResponse:@"not awaiting personalization/grafting [or mounting]" forEventInfo:responseCopy lockingChosenDescriptor:v57];
LABEL_41:
      responseError = 0;
      goto LABEL_42;
    }

    autoAssetSelector = [responseCopy autoAssetSelector];
    autoAssetUUID4 = [responseCopy autoAssetUUID];
    clientRequest3 = [responseCopy clientRequest];
    responseMessage = [clientRequest3 responseMessage];
    clientRequest2 = [(MADAutoAssetControlManager *)self updateAutoAssetStatus:autoAssetSelector forActiveJobUUID:autoAssetUUID4 forJobResponse:responseMessage withResponseError:0];

    [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:responseCopy issuingResponseMessage:clientRequest2 withResponseError:0 fromLocation:@"IssueClientReplyJobResponse"];
LABEL_40:

    goto LABEL_41;
  }

LABEL_14:
  [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:@"IssueClientReplyJobResponse" forEventInfo:responseCopy withResponseError:responseError forAttemptedDescriptor:0];
  v57 = 0;
LABEL_42:
  fromAutoAssetJob4 = [responseCopy fromAutoAssetJob];
  v47 = fromAutoAssetJob4 == 0;

  if (!v47)
  {
    fromAutoAssetJob5 = [responseCopy fromAutoAssetJob];
    if ([fromAutoAssetJob5 clientRequestCount] < 1)
    {
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag2 = [autoControlManagerFSM3 diag];
      v51 = [NSString alloc];
      summary2 = [responseCopy summary];
      v53 = [v51 initWithFormat:@"auto-job indicating issue-reply when no tracked client-requests | eventInfo:%@", summary2];
      [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v53 withResult:6110 withError:0];
    }

    else
    {
      [fromAutoAssetJob5 setClientRequestCount:{objc_msgSend(fromAutoAssetJob5, "clientRequestCount") - 1}];
    }
  }

LABEL_48:
  os_activity_scope_leave(&state);

  return 0;
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = [*(a1 + 32) summary];
      *buf = 138543362;
      v9 = v3;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-GRAFT][SINGLETON-CONTROL][ELIMINATE] {IssueClientReplyJobResponse} | eliminate triggered while performing personalize+graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:@"IssueClientReplyJobResponse" forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v7 = [[NSString alloc] initWithFormat:@"%@[PERSONALIZING/GRAFTING]", @"IssueClientReplyJobResponse"];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:? forEventInfo:? withResponseError:? forAttemptedDescriptor:?];
  }

  else
  {
    v4 = *(a1 + 56);
    v6 = *(a1 + 32);
    v5 = *(a1 + 40);

    [v5 lockAutoAssetReplyJobResponse:@"any personalization/grafting [or mounting] successful" forEventInfo:v4 lockingChosenDescriptor:v6];
  }
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2589(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2_2590;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __71__MADAutoAssetControlManager_action_IssueClientReplyJobResponse_error___block_invoke_2_2590(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = [*(a1 + 32) summary];
      *buf = 138543362;
      v11 = v3;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL][ELIMINATE] {IssueClientReplyJobResponse} | eliminate triggered while grafting|mounting | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:@"IssueClientReplyJobResponse" forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v4 = [[NSString alloc] initWithFormat:@"%@[GRAFTING]", @"IssueClientReplyJobResponse"];
    v5 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_ERROR))
    {
      v6 = [*(a1 + 64) checkedDescription];
      v7 = [*(a1 + 32) summary];
      *buf = 138543618;
      v11 = v6;
      v12 = 2114;
      v13 = v7;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | graft|mount ERROR | error: %{public}@ | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:v4 forEventInfo:*(a1 + 56) withResponseError:*(a1 + 64) forAttemptedDescriptor:*(a1 + 32)];
  }

  else
  {
    v8 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      v9 = [*(a1 + 32) summary];
      *buf = 138543362;
      v11 = v9;
      _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL] {IssueClientReplyJobResponse} | graft|mount SUCCESS | chosenDownloadedDescriptor:%{public}@", buf, 0xCu);
    }

    [*(a1 + 40) lockAutoAssetReplyJobResponse:@"grafting [or mounting] successful" forEventInfo:*(a1 + 56) lockingChosenDescriptor:*(a1 + 32)];
  }
}

- (void)lockAutoAssetReplyJobResponse:(id)response forEventInfo:(id)info lockingChosenDescriptor:(id)descriptor
{
  responseCopy = response;
  infoCopy = info;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v12 = _os_activity_create(&dword_0, "MADAutoControl:lockAutoAssetReplyJobResponse", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v12, &state);

  jobInformation = [infoCopy jobInformation];
  assetType = [descriptorCopy assetType];
  if (assetType)
  {
    v14 = [MAAutoAssetSelector alloc];
    assetType2 = [descriptorCopy assetType];
    assetSpecifier = [descriptorCopy assetSpecifier];
    assetVersion = [descriptorCopy assetVersion];
    v36 = [v14 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];
  }

  else
  {
    v36 = 0;
  }

  clientInstance = [jobInformation clientInstance];
  clientDesire = [jobInformation clientDesire];
  v20 = clientDesire;
  if (clientInstance)
  {
    if (clientDesire)
    {
      goto LABEL_9;
    }
  }

  else
  {
    clientInstance = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:infoCopy];
    if (v20)
    {
      goto LABEL_9;
    }
  }

  clientRequestMessage = [infoCopy clientRequestMessage];
  v20 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage];

LABEL_9:
  v37 = v20;
  clientRequest = [infoCopy clientRequest];
  clientReplyCompletion = [infoCopy clientReplyCompletion];
  v24 = [(MADAutoAssetControlManager *)self notifyLockerJustLockedDescriptor:descriptorCopy forClientInstance:clientInstance withClientDesire:v37 respondingToClientRequest:clientRequest withClientCompletion:clientReplyCompletion];

  if (v24)
  {
    autoAssetSelector = [infoCopy autoAssetSelector];
    autoAssetUUID = [infoCopy autoAssetUUID];
    clientRequest2 = [infoCopy clientRequest];
    responseMessage = [clientRequest2 responseMessage];
    v29 = [(MADAutoAssetControlManager *)self updateAutoAssetStatus:autoAssetSelector forActiveJobUUID:autoAssetUUID forJobResponse:responseMessage withResponseError:v24];
  }

  else
  {
    if ([descriptorCopy neverBeenLocked])
    {
      [descriptorCopy setNeverBeenLocked:0];
      autoAssetClientName = [clientInstance autoAssetClientName];
      if (autoAssetClientName)
      {
        [clientInstance autoAssetClientName];
      }

      else
      {
        [clientInstance clientProcessName];
      }
      v31 = ;

      LOBYTE(v34) = 0;
      [(MADAutoAssetControlManager *)self trackDescriptor:descriptorCopy persisting:1 fromLocation:responseCopy changedWhileTerminated:0 changedNeverBeenLocked:1 historyOperation:0 firstClientName:v31 isPromoted:v34];
    }

    autoAssetSelector = [infoCopy clientRequest];
    v39 = 0;
    v29 = [(MADAutoAssetControlManager *)self buildFoundResponseMessage:@"lockContent(job complete)" forClientRequest:autoAssetSelector withFoundDescriptor:descriptorCopy withInstance:clientInstance withDesire:v37 fromLocation:responseCopy error:&v39];
    v24 = v39;
  }

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:infoCopy issuingResponseMessage:v29 withResponseError:v24 fromLocation:responseCopy];
  if (v24)
  {
    if (v36)
    {
      autoAssetClientName2 = [clientInstance autoAssetClientName];
      if (autoAssetClientName2)
      {
        [clientInstance autoAssetClientName];
      }

      else
      {
        [clientInstance clientProcessName];
      }
      v33 = ;
      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v33 forAssetID:@"UNKNOWN" withSelector:v36 failingWithError:v24];
    }

    else
    {
      autoAssetClientName2 = [clientInstance autoAssetClientName];
      if (autoAssetClientName2)
      {
        [clientInstance clientProcessName];
      }

      else
      {
        [clientInstance autoAssetClientName];
      }
      v33 = ;
      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v33 forAssetID:@"UNKNOWN" failingWithError:v24];
    }
  }

  os_activity_scope_leave(&state);
}

- (int64_t)action_IssueClientReplySetJob:(id)job error:(id *)error
{
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:IssueClientReplySetJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"IssueClientReplySetJob" forEventInfo:jobCopy issuingClientReply:1, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SchedulerJobFoundSame:(id)same error:(id *)error
{
  sameCopy = same;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SchedulerJobFoundSame", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"SchedulerJobFoundSame" forEventInfo:sameCopy issuingClientReply:0, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_SchedulerJobDownloaded:(id)downloaded error:(id *)error
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:SchedulerJobDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self setJobIndicationOfPotentialLatestToVend:@"SchedulerJobDownloaded" forEventInfo:downloadedCopy issuingClientReply:0, v10.opaque[0], v10.opaque[1]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_RemoveFinishedJob:(id)job error:(id *)error
{
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:RemoveFinishedJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v53 = objc_alloc_init(NSMutableDictionary);
  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    summary = [jobCopy summary];
    *buf = 138543362;
    v68 = summary;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "{RemoveFinishedJob} job has FINISHED | eventInfo:%{public}@", buf, 0xCu);
  }

  v62 = 0u;
  v63 = 0u;
  v60 = 0u;
  v61 = 0u;
  clientRequestsBeingTracked = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  v11 = [clientRequestsBeingTracked countByEnumeratingWithState:&v60 objects:v66 count:16];
  obj = clientRequestsBeingTracked;
  if (v11)
  {
    v12 = *v61;
    do
    {
      v13 = 0;
      do
      {
        if (*v61 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v60 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        clientRequestsBeingTracked2 = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
        v17 = [clientRequestsBeingTracked2 safeObjectForKey:v14 ofClass:objc_opt_class()];

        clientReplyCompletion = [v17 clientReplyCompletion];
        v19 = clientReplyCompletion == 0;

        if (v19)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v30 = [NSString alloc];
          summary2 = [v17 summary];
          v32 = [v30 initWithFormat:@"encountered client-request being tracked without reply completion | clientRequest:%@", summary2];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v32 withResult:6101 withError:0];

          clientRequestUUID = [v17 clientRequestUUID];
          [v53 setSafeObject:v17 forKey:clientRequestUUID];
        }

        else
        {
          autoAssetJobUUID = [v17 autoAssetJobUUID];
          autoAssetUUID = [jobCopy autoAssetUUID];
          v22 = [SUCore stringIsEqual:autoAssetJobUUID to:autoAssetUUID];

          if (!v22)
          {
            goto LABEL_17;
          }

          currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
          autoAssetUUID2 = [jobCopy autoAssetUUID];
          clientRequestUUID = [currentJobsByUUID safeObjectForKey:autoAssetUUID2 ofClass:objc_opt_class()];

          if (clientRequestUUID && [clientRequestUUID clientRequestCount] <= 0)
          {
            clientRequestUUID2 = [v17 clientRequestUUID];
            [v53 setSafeObject:v17 forKey:clientRequestUUID2];

            [clientRequestUUID setClientRequestCount:{objc_msgSend(clientRequestUUID, "clientRequestCount") - 1}];
          }

          else
          {
            v26 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
            {
              summary3 = [jobCopy summary];
              *buf = 138543362;
              v68 = summary3;
              _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {RemoveFinishedJob} auto-asset-job indicated removal but has more to do | eventInfo:%{public}@", buf, 0xCu);
            }
          }
        }

LABEL_17:
        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v11 != v13);
      v34 = [obj countByEnumeratingWithState:&v60 objects:v66 count:16];
      v11 = v34;
    }

    while (v34);
  }

  v58 = 0u;
  v59 = 0u;
  v56 = 0u;
  v57 = 0u;
  v35 = v53;
  v36 = [v35 countByEnumeratingWithState:&v56 objects:v65 count:16];
  if (v36)
  {
    v37 = *v57;
    do
    {
      for (i = 0; i != v36; i = i + 1)
      {
        if (*v57 != v37)
        {
          objc_enumerationMutation(v35);
        }

        v39 = *(*(&v56 + 1) + 8 * i);
        v40 = objc_autoreleasePoolPush();
        v41 = [v35 safeObjectForKey:v39 ofClass:objc_opt_class()];
        [(MADAutoAssetControlManager *)self removeClientRequest:v41 fromLocation:@"RemoveFinishedJob"];

        objc_autoreleasePoolPop(v40);
      }

      v36 = [v35 countByEnumeratingWithState:&v56 objects:v65 count:16];
    }

    while (v36);
  }

  autoAssetUUID3 = [jobCopy autoAssetUUID];
  v43 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID3 fromLocation:@"RemoveFinishedJob" notFoundCode:0 notFoundReason:0];

  if (v43)
  {
    lifetimeOSTransaction = [v43 lifetimeOSTransaction];
    v45 = lifetimeOSTransaction == 0;

    if (!v45)
    {
      [v43 setLifetimeOSTransaction:0];
      v46 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[OS-TRANSACTION-JOB] [END]", buf, 2u);
      }
    }

    [v43 finishedAcknowledgeAutoAssetJob];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v49 = [NSString alloc];
    summary4 = [jobCopy summary];
    v51 = [v49 initWithFormat:@"encountered job indicating finished when not a current job | eventInfo:%@", summary4];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v51 withResult:6103 withError:0];
  }

  [(MADAutoAssetControlManager *)self _statsIncrementAutoJobsFinished];
  -[MADAutoAssetControlManager removeCurrentJob:schedulerInvolved:potentialNetworkFailure:fromLocation:](self, "removeCurrentJob:schedulerInvolved:potentialNetworkFailure:fromLocation:", jobCopy, [jobCopy schedulerInvolved], objc_msgSend(jobCopy, "potentialNetworkFailure"), @"RemoveFinishedJob");

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_CoalesceLateJobScheduled:(id)scheduled error:(id *)error
{
  scheduledCopy = scheduled;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CoalesceLateJobScheduled", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  autoAssetSelector = [scheduledCopy autoAssetSelector];
  [MADAutoAssetScheduler jobFinishedForSelector:autoAssetSelector withPotentialNetworkFailure:0];

  os_activity_scope_leave(&v11);
  return 0;
}

- (int64_t)action_CoalesceLateJobSetScheduled:(id)scheduled error:(id *)error
{
  scheduledCopy = scheduled;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CoalesceLateJobSetScheduled", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  setConfiguration = [scheduledCopy setConfiguration];
  v10 = setConfiguration;
  if (setConfiguration)
  {
    clientDomainName = [setConfiguration clientDomainName];
    assetSetIdentifier = [v10 assetSetIdentifier];
    [MADAutoAssetScheduler jobFinishedForSetDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier withPotentialNetworkFailure:0];
  }

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_ScheduleJobsBefore1st:(id)before1st error:(id *)error
{
  before1stCopy = before1st;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleJobsBefore1s", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
  {
    *v11 = 0;
    _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "{ScheduleJobsBefore1st}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no operations performed since device is before first-unlock", v11, 2u);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ScheduleJobs:(id)jobs error:(id *)error
{
  jobsCopy = jobs;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  setOfAutoAssetSelectors = [jobsCopy setOfAutoAssetSelectors];
  v9 = [setOfAutoAssetSelectors countByEnumeratingWithState:&v35 objects:v44 count:16];
  if (v9)
  {
    v31 = 0;
    v33 = *v36;
    obj = setOfAutoAssetSelectors;
    do
    {
      v34 = v9;
      for (i = 0; i != v34; i = i + 1)
      {
        if (*v36 != v33)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v35 + 1) + 8 * i);
        if ([(MADAutoAssetControlManager *)self isAutoAssetBeingEliminated:v11])
        {
          v12 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            summary = [v11 summary];
            *buf = 138543362;
            v41 = summary;
            _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{ScheduleJobs} [IGNORED] auto-asset being eliminated - scheduler trigger ignored | selector:%{public}@", buf, 0xCu);
          }
        }

        else
        {
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self currentJobBySelector:v11];
          if (v15)
          {
            uUIDString = _MADLog(@"AutoControl");
            if (os_log_type_enabled(uUIDString, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary2 = [v11 summary];
              *buf = 138543618;
              v41 = _updateLatestSummary;
              v42 = 2114;
              v43 = summary2;
              _os_log_impl(&dword_0, uUIDString, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleJobs} auto-asset-job already running | selector:%{public}@", buf, 0x16u);
            }
          }

          else
          {
            v19 = +[NSUUID UUID];
            uUIDString = [v19 UUIDString];

            [(MADAutoAssetControlManager *)self osTransactionNameScheduledSingletonJob:uUIDString];
            v20 = os_transaction_create();
            v15 = [[MADAutoAssetJob alloc] initForSelector:v11 withLifetimeOSTransaction:v20 withAutoAssetUUID:uUIDString];
            if (v15)
            {
              [(MADAutoAssetControlManager *)self addToCurrentJobs:v15 usingSelector:v11 withJobUUID:uUIDString triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:0 fromLocation:@"kMA_A_ScheduleJobs"];
              [(MADAutoAssetControlManager *)self _trackActiveDescriptor:@"ScheduleJobs" operation:@"ENTRY_ADD" usingSelector:v11 withJobUUID:uUIDString triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 message:@"scheduled auto-asset-job started"];
              [(MADAutoAssetControlManager *)self _statsIncrementSchedulerTriggeredJobs];
              v21 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v11];
              [v15 startScheduleTriggeredSelector:v11 withControlInformation:v21];

              ++v31;
            }

            else
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v24 = [NSString alloc];
              summary3 = [v11 summary];
              v26 = [v24 initWithFormat:@"unable to allocate scheduler-triggered autoAssetJob for selector:%@", summary3];
              [diag trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6101 withError:0];

              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            }
          }

          objc_autoreleasePoolPop(v14);
        }
      }

      v9 = [obj countByEnumeratingWithState:&v35 objects:v44 count:16];
    }

    while (v9);

    if (v31 > 0)
    {
      v27 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 134217984;
        v41 = v31;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "{ScheduleJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] singleton job(s) started | singletonScheduledJobsTriggered:%ld", buf, 0xCu);
      }

      [MADAutoAssetHistory recordOperation:1400 toHistoryType:5 fromLayer:1 usageCount:v31];
      goto LABEL_28;
    }
  }

  else
  {
  }

  v28 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "{ScheduleJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no singleton jobs started", buf, 2u);
  }

LABEL_28:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_ScheduleSetJobs:(id)jobs error:(id *)error
{
  jobsCopy = jobs;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ScheduleSetJobs", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v93 = +[NSMutableArray array];
  v105 = 0u;
  v106 = 0u;
  v103 = 0u;
  v104 = 0u;
  triggeredSets = [jobsCopy triggeredSets];
  v9 = [triggeredSets countByEnumeratingWithState:&v103 objects:v112 count:16];
  if (!v9)
  {

    goto LABEL_46;
  }

  v94 = 0;
  v102 = *v104;
  obj = triggeredSets;
  do
  {
    for (i = 0; i != v9; i = i + 1)
    {
      if (*v104 != v102)
      {
        objc_enumerationMutation(obj);
      }

      v11 = *(*(&v103 + 1) + 8 * i);
      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        clientDomainName = [v11 clientDomainName];
        assetSetIdentifier = [v11 assetSetIdentifier];
        v14 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

        if (v14)
        {
          v15 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary = [v11 summary];
            *buf = 138543618;
            v109 = _updateLatestSummary;
            v110 = 2114;
            v111 = summary;
            _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} suspended for software update (so not scheduling set-job) | schedulerTriggered:%{public}@", buf, 0x16u);
          }

LABEL_13:

          continue;
        }
      }

      clientDomainName2 = [v11 clientDomainName];
      assetSetIdentifier2 = [v11 assetSetIdentifier];
      v20 = [(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:@"ScheduleSetJobs" forClientDomainName:clientDomainName2 ofSetIdentifier:assetSetIdentifier2];

      if (v20)
      {
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
        {
          summary2 = [v11 summary];
          *buf = 138543362;
          v109 = summary2;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{ScheduleSetJobs} [IGNORED] set-identifier being eliminated - scheduler trigger ignored | schedulerTriggered:%{public}@", buf, 0xCu);
        }

        goto LABEL_13;
      }

      v22 = objc_autoreleasePoolPush();
      clientDomainName3 = [v11 clientDomainName];
      if (!clientDomainName3 || ([v11 assetSetIdentifier], v24 = objc_claimAutoreleasedReturnValue(), v25 = v24 == 0, v24, clientDomainName3, v25))
      {
        v28 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary3 = [v11 summary];
          *buf = 138543618;
          v109 = _updateLatestSummary2;
          v110 = 2114;
          v111 = summary3;
          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "[%{public}@] {ScheduleSetJobs} MISSING required field(s) | schedulerTriggered:%{public}@", buf, 0x16u);
        }
      }

      else if ([(MADAutoAssetControlManager *)self _haveSetAssetEntriesForSchedulerTriggered:v11])
      {
        clientDomainName4 = [v11 clientDomainName];
        assetSetIdentifier3 = [v11 assetSetIdentifier];
        v28 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName4 byIdentifier:assetSetIdentifier3];

        clientDomainName5 = [v11 clientDomainName];
        assetSetIdentifier4 = [v11 assetSetIdentifier];
        v100 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:clientDomainName5 byIdentifier:assetSetIdentifier4];

        if (v100)
        {
          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
          {
            summary4 = [v11 summary];
            *buf = 138543362;
            v109 = summary4;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | scheduled job triggered for set-job that is being canceled - not scheduling | schedulerTriggered:%{public}@", buf, 0xCu);
          }
        }

        else if (v28)
        {
          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary5 = [v11 summary];
            *buf = 138543618;
            v109 = _updateLatestSummary3;
            v110 = 2114;
            v111 = summary5;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} set-job already running | schedulerTriggered:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          clientDomainName6 = [v11 clientDomainName];
          assetSetIdentifier5 = [v11 assetSetIdentifier];
          v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier5];

          if (v31)
          {
            v41 = [MANAutoAssetSetInfoInstance alloc];
            clientDomainName7 = [v11 clientDomainName];
            assetSetIdentifier6 = [v11 assetSetIdentifier];
            autoAssetEntries = [v31 autoAssetEntries];
            v98 = [(MANAutoAssetSetInfoInstance *)v41 initUsingClientDomain:clientDomainName7 forClientName:@"com.apple.MobileAsset.daemon.internal" withProcessName:@"ScheduleSetJobs" withProcessID:0 forAssetSetIdentifier:assetSetIdentifier6 forAtomicInstance:0 comprisedOfEntries:autoAssetEntries asEntriesWhenTargeting:0 associatingFrameworkUUID:0];

            v97 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:@"ScheduleSetJobs" forCreationReason:@"SCHEDULED_IN_FLIGHT" recordingHistoryOperation:221 forSetInfoInstance:v98 asSubAtomicFrom:0];
            atomicInstanceUUID = [v97 atomicInstanceUUID];
            [v31 setDiscoveredInFlightAtomicInstance:atomicInstanceUUID];

            [(MADAutoAssetControlManager *)self setConfigurationPersist:v31 fromLocation:@"ScheduleSetJobs" forReason:@"set discoveredInFlight" dueToAlter:0 forHistoryOperation:9999];
            atomicInstanceUUID2 = [v97 atomicInstanceUUID];
            [v98 setAtomicInstance:atomicInstanceUUID2];

            v47 = [MADAutoSetDescriptor alloc];
            clientDomainName8 = [v11 clientDomainName];
            assetSetIdentifier7 = [v11 assetSetIdentifier];
            atomicInstance = [v98 atomicInstance];
            v96 = [(MADAutoSetDescriptor *)v47 initForClientDomainName:clientDomainName8 forAssetSetIdentifier:assetSetIdentifier7 withDiscoveredAtomicInstance:atomicInstance withDiscoveredAtomicEntries:0];

            autoAssetEntries2 = [v31 autoAssetEntries];
            [v96 setRequestedAutoAssetEntries:autoAssetEntries2];

            atomicInstanceUUID3 = [v97 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self osTransactionNameScheduledSetJob:atomicInstanceUUID3];
            v95 = os_transaction_create();

            schedulerPolicy = [v11 schedulerPolicy];
            LOBYTE(atomicInstanceUUID3) = schedulerPolicy == 0;

            if (atomicInstanceUUID3)
            {
              v99 = 0;
            }

            else
            {
              v99 = objc_alloc_init(MANAutoAssetSetPolicy);
              schedulerPolicy2 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setUserInitiated:](v99, "setUserInitiated:", [schedulerPolicy2 userInitiated]);

              schedulerPolicy3 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setLockInhibitsEmergencyRemoval:](v99, "setLockInhibitsEmergencyRemoval:", [schedulerPolicy3 lockInhibitsEmergencyRemoval]);

              schedulerPolicy4 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOnBattery:](v99, "setAllowCheckDownloadOnBattery:", [schedulerPolicy4 allowCheckDownloadOnBattery]);

              schedulerPolicy5 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadWhenBatteryLow:](v99, "setAllowCheckDownloadWhenBatteryLow:", [schedulerPolicy5 allowCheckDownloadWhenBatteryLow]);

              schedulerPolicy6 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadWhenCPUHigh:](v99, "setAllowCheckDownloadWhenCPUHigh:", [schedulerPolicy6 allowCheckDownloadWhenCPUHigh]);

              schedulerPolicy7 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOverExpensive:](v99, "setAllowCheckDownloadOverExpensive:", [schedulerPolicy7 allowCheckDownloadOverExpensive]);

              schedulerPolicy8 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setAllowCheckDownloadOverCellular:](v99, "setAllowCheckDownloadOverCellular:", [schedulerPolicy8 allowCheckDownloadOverCellular]);

              schedulerPolicy9 = [v11 schedulerPolicy];
              -[MANAutoAssetSetPolicy setBlockCheckDownload:](v99, "setBlockCheckDownload:", [schedulerPolicy9 blockCheckDownload]);
            }

            v67 = [MADAutoAssetJob alloc];
            v68 = [v31 copy];
            atomicInstance2 = [v98 atomicInstance];
            v28 = [(MADAutoAssetJob *)v67 initForSetInstance:v98 withLifetimeOSTransaction:v95 withSchedulerSetPolicy:v99 usingSetConfiguration:v68 usingSetDescriptor:v96 withAutoAssetUUID:atomicInstance2];

            if (v28)
            {
              clientDomainName9 = [v31 clientDomainName];
              assetSetIdentifier8 = [v31 assetSetIdentifier];
              v72 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName9 forAssetSetIdentifier:assetSetIdentifier8];

              atomicInstanceUUID4 = [v97 atomicInstanceUUID];
              [(MADAutoAssetControlManager *)self addToCurrentJobs:v28 usingSelector:0 withJobUUID:atomicInstanceUUID4 triggeredByClientMessage:0 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:v96 fromLocation:@"action_ScheduleSetJobs"];

              atomicInstanceUUID5 = [v97 atomicInstanceUUID];
              LOBYTE(v90) = 0;
              BYTE2(v89) = 0;
              LOWORD(v89) = 0;
              [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v96 forLatestDownloaded:@"ScheduleSetJobs" forSpecificAtomicInstance:0 withCurrentSetStatus:atomicInstanceUUID5 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v89 latestToVend:353 historyOperation:@"com.apple.MobileAsset.daemon.internal" firstClientName:v90 fromPreSUStaging:?];

              [(MADAutoAssetControlManager *)self _statsIncrementSchedulerTriggeredJobs];
              v75 = [(MADAutoAssetControlManager *)self jobControlInformationForSetJobKey:v72];
              [v28 startScheduleTriggeredSetJob:v75];

              assetSetIdentifier9 = [v96 assetSetIdentifier];
              [v93 addObject:assetSetIdentifier9];

              ++v94;
            }

            else
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v78 = [NSString alloc];
              summary6 = [v11 summary];
              v80 = [v78 initWithFormat:@"unable to allocate scheduler-triggered autoAssetJob | schedulerTriggered:%@", summary6];
              [diag trackAnomaly:@"AUTO-CONTROL" forReason:v80 withResult:6101 withError:0];

              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            }
          }

          else
          {
            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag2 = [autoControlManagerFSM3 diag];
            v64 = [NSString alloc];
            summary7 = [v11 summary];
            v66 = [v64 initWithFormat:@"unable to locate set-configuration for scheduler-triggered autoAssetJob | schedulerTriggered:%@", summary7];
            [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v66 withResult:6101 withError:0];

            [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
            v28 = 0;
          }
        }
      }

      else
      {
        v28 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary8 = [v11 summary];
          *buf = 138543618;
          v109 = _updateLatestSummary4;
          v110 = 2114;
          v111 = summary8;
          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ScheduleSetJobs} no auto-asset-entries (so not scheuling set-job) | schedulerTriggered:%{public}@", buf, 0x16u);
        }
      }

      objc_autoreleasePoolPop(v22);
    }

    v9 = [obj countByEnumeratingWithState:&v103 objects:v112 count:16];
  }

  while (v9);

  if (v94 > 0)
  {
    v81 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v81, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 134217984;
      v109 = v94;
      _os_log_impl(&dword_0, v81, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] set job(s) started | setScheduledJobsTriggered:%ld", buf, 0xCu);
    }

    [MADAutoAssetHistory recordOperation:1401 toHistoryType:5 fromLayer:1 usageCount:v94];
    if (+[MAAIRBEventReporter isAvailable])
    {
      v82 = [MAAIRBMobileAssetOperationMetadata alloc];
      v83 = [MADAutoAssetHistoryTracker operationName:1401];
      v84 = [(MAAIRBMobileAssetOperationMetadata *)v82 initWithCode:1401 name:v83];

      v85 = [MAAIRBUtilities createMAAIRBAssetSets:v93];
      v86 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeScheduler:v84 numJobsTriggered:v94 assetSets:v85];
      v87 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v86];
      [MAAIRBEventReporter emitAppleIntelligenceEvent:v87];

      goto LABEL_48;
    }

    goto LABEL_49;
  }

LABEL_46:
  v84 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v84, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, "{ScheduleSetJobs}\n[AUTO-CONTROL-SCHEDULER-TRIGGER] no set jobs started", buf, 2u);
  }

LABEL_48:

LABEL_49:
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_DecrementTickDriven:(id)driven error:(id *)error
{
  drivenCopy = driven;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecrementTickDriven", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v10);

  [(MADAutoAssetControlManager *)self _schedulerTickOccurred:v10.opaque[0]];
  os_activity_scope_leave(&v10);

  return 0;
}

- (int64_t)action_IgnorePushNotifications:(id)notifications error:(id *)error
{
  notificationsCopy = notifications;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:IgnorePushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  pushNotifications = [notificationsCopy pushNotifications];
  v9 = [pushNotifications countByEnumeratingWithState:&v35 objects:v46 count:16];
  if (v9)
  {
    v10 = *v36;
    obj = pushNotifications;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v36 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v35 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        assetType = [v12 assetType];
        if (!assetType || ([v12 assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = v15 == 0, v15, assetType, v16))
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            summary = [v12 summary];
            *buf = 138543618;
            v41 = _updateLatestSummary;
            v42 = 2114;
            v43 = summary;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} missing required asset-selector information (ignored) | pushNotification:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          assetVersion = [v12 assetVersion];
          v18 = assetVersion == 0;

          if (v18)
          {
            v24 = [MAAutoAssetSelector alloc];
            assetType2 = [v12 assetType];
            assetSpecifier = [v12 assetSpecifier];
            v19 = [v24 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier];

            v27 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary2 = [v19 summary];
              summary3 = [v12 summary];
              *buf = 138543874;
              v41 = _updateLatestSummary2;
              v42 = 2114;
              v43 = summary2;
              v44 = 2114;
              v45 = summary3;
              _os_log_impl(&dword_0, v27, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} ignoring too-early push | autoAssetSelector:%{public}@ | pushNotification:%{public}@", buf, 0x20u);
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary4 = [v12 summary];
              *buf = 138543618;
              v41 = _updateLatestSummary3;
              v42 = 2114;
              v43 = summary4;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:IgnorePushNotifications} asset-version specified (not applicable to scheduling - ignored) | pushNotification:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v13);
      }

      pushNotifications = obj;
      v9 = [obj countByEnumeratingWithState:&v35 objects:v46 count:16];
    }

    while (v9);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_HandlePushNotifications:(id)notifications error:(id *)error
{
  notificationsCopy = notifications;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:HandlePushNotifications", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v42 = objc_alloc_init(NSMutableDictionary);
  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  pushNotifications = [notificationsCopy pushNotifications];
  v9 = [pushNotifications countByEnumeratingWithState:&v46 objects:v57 count:16];
  if (v9)
  {
    v45 = *v47;
    obj = pushNotifications;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v47 != v45)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v46 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        autoUpdatePolicy = [v11 autoUpdatePolicy];
        assetType = [v11 assetType];
        if (!assetType || ([v11 assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = v15 == 0, v15, assetType, v16))
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            summary = [v11 summary];
            *buf = 138543618;
            v52 = _updateLatestSummary;
            v53 = 2114;
            v54 = summary;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} missing required asset-selector information (ignored) | pushNotification:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          assetVersion = [v11 assetVersion];
          v18 = assetVersion == 0;

          if (v18)
          {
            v24 = [MAAutoAssetSelector alloc];
            assetType2 = [v11 assetType];
            assetSpecifier = [v11 assetSpecifier];
            v19 = [v24 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier];

            persistedEntryID = [v19 persistedEntryID];
            v28 = [v42 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];
            LOBYTE(assetType2) = v28 == 0;

            if (assetType2)
            {
              [v42 setSafeObject:autoUpdatePolicy forKey:persistedEntryID];
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                summary2 = [v19 summary];
                summary3 = [v11 summary];
                *buf = 138543874;
                v52 = _updateLatestSummary2;
                v53 = 2114;
                v54 = summary2;
                v55 = 2114;
                v56 = summary3;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} requesting push | autoAssetSelector:%{public}@ | pushNotification:%{public}@", buf, 0x20u);
              }
            }

            else
            {
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                summary4 = [v11 summary];
                *buf = 138543618;
                v52 = _updateLatestSummary3;
                v53 = 2114;
                v54 = summary4;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} asset-selector repeated (ignoring additional entry) | pushNotification:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary4 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary5 = [v11 summary];
              *buf = 138543618;
              v52 = _updateLatestSummary4;
              v53 = 2114;
              v54 = summary5;
              _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} asset-version specified (not applicable to scheduling - ignored) | pushNotification:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v12);
      }

      pushNotifications = obj;
      v9 = [obj countByEnumeratingWithState:&v46 objects:v57 count:16];
    }

    while (v9);
  }

  if ([v42 count])
  {
    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary5 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      v37 = [v42 count];
      *buf = 138543618;
      v52 = _updateLatestSummary5;
      v53 = 2048;
      v54 = v37;
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} scheduling push jobs | pushNotificationsBySelector:%ld", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)selfCopy _schedulePushNotifications:v42];
  }

  else
  {
    v38 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      *buf = 138543362;
      v52 = _updateLatestSummary6;
      _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:handlePushNotifications} push-notification resulted in 0 push jobs", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_ClearInProgressSecure:(id)secure error:(id *)error
{
  secureCopy = secure;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:ClearInProgressSecure", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  setDescriptor = [secureCopy setDescriptor];
  autoAssetDescriptors = [secureCopy autoAssetDescriptors];
  if (autoAssetDescriptors)
  {
    v41 = 0u;
    v42 = 0u;
    v39 = 0u;
    v40 = 0u;
    v8 = autoAssetDescriptors;
    v9 = [v8 countByEnumeratingWithState:&v39 objects:v44 count:16];
    if (v9)
    {
      v10 = *v40;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v40 != v10)
          {
            objc_enumerationMutation(v8);
          }

          v12 = *(*(&v39 + 1) + 8 * i);
          if ([v12 secureOperationInProgress])
          {
            [v12 setSecureOperationInProgress:0];
            if ([v12 secureOperationEliminating])
            {
              v13 = [MAAutoAssetSelector alloc];
              assetType = [v12 assetType];
              assetSpecifier = [v12 assetSpecifier];
              assetVersion = [v12 assetVersion];
              v17 = [v13 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

              v18 = [(MADAutoAssetControlManager *)selfCopy eliminateTrackerForSelector:v17];
              if (v18)
              {
                [(MADAutoAssetControlManager *)selfCopy _eliminateSecureOperationFinished:v18 forEliminateDescriptor:v12];
              }

              else
              {
                autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
                diag = [autoControlManagerFSM2 diag];
                v21 = [NSString alloc];
                summary = [v12 summary];
                v23 = [v21 initWithFormat:@"{ClearInProgressSecure} no eliminateTracker | nextAssetDescriptor:%@", summary];
                [diag trackAnomaly:@"ELIMINATE|AUTO-SECURE" forReason:v23 withResult:6111 withError:0];
              }
            }
          }
        }

        v9 = [v8 countByEnumeratingWithState:&v39 objects:v44 count:16];
      }

      while (v9);
    }
  }

  if (setDescriptor)
  {
    if ([setDescriptor secureOperationInProgress])
    {
      [setDescriptor setSecureOperationInProgress:0];
      if ([setDescriptor secureOperationEliminating])
      {
        v24 = [MAAutoAssetSelector alloc];
        clientDomainName = [setDescriptor clientDomainName];
        assetSetIdentifier = [setDescriptor assetSetIdentifier];
        v27 = [v24 initForAssetType:clientDomainName withAssetSpecifier:assetSetIdentifier];

        v28 = [(MADAutoAssetControlManager *)selfCopy eliminateTrackerForSelector:v27];
        if (v28)
        {
          [(MADAutoAssetControlManager *)selfCopy _eliminateSecureOperationFinished:v28 forEliminateSetDescriptor:setDescriptor];
        }

        else
        {
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
          diag2 = [autoControlManagerFSM3 diag];
          v31 = [NSString alloc];
          summary2 = [setDescriptor summary];
          v33 = [v31 initWithFormat:@"{ClearInProgressSecure} no eliminateTracker | setDescriptor:%@", summary2];
          [diag2 trackAnomaly:@"SET-ELIMINATE|AUTO-SECURE" forReason:v33 withResult:6111 withError:0];
        }
      }
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_DecideNeedPersonalize:(id)personalize error:(id *)error
{
  personalizeCopy = personalize;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecideNeedPersonalize", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseBegin:@"DecideNeedPersonalize"];
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
  v96 = [persistedKnownDescriptors persistedEntryIDs:@"DecideNeedPersonalize"];

  v98 = objc_alloc_init(NSMutableDictionary);
  v100 = objc_alloc_init(NSMutableDictionary);
  v111 = objc_alloc_init(NSMutableDictionary);
  v97 = objc_alloc_init(NSMutableDictionary);
  if ([v96 count])
  {
    v10 = +[MADAutoAssetLocker copyOfLockCountsBySelector];
    [(MADAutoAssetControlManager *)selfCopy setLocksPriorToSecureHealing:v10];

    [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"DecideNeedPersonalize" ofContainer:@"copyOfLockCountsBySelector"];
    v127 = 0u;
    v128 = 0u;
    v125 = 0u;
    v126 = 0u;
    obj = v96;
    v11 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
    if (v11)
    {
      v104 = *v126;
      do
      {
        v12 = 0;
        v107 = v11;
        do
        {
          if (*v126 != v104)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v125 + 1) + 8 * v12);
          v14 = objc_autoreleasePoolPush();
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
          v16 = [persistedKnownDescriptors2 persistedEntry:v13 fromLocation:@"DecideNeedPersonalize"];

          if (v16)
          {
            persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
            v18 = [persistedKnownDescriptors3 decodeFromLocation:@"DecideNeedPersonalize" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              if ([v18 foundAsPreInstalled])
              {
                [(MADAutoAssetControlManager *)selfCopy _preinstalledTrackBySelector:v18];
              }

              if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"DecideNeedPersonalize" forDescriptor:v18])
              {
                v19 = [(MADAutoAssetControlManager *)selfCopy setConfigurationForDescriptorIfManagedAsSet:v18];

                checkedDescription2 = [MADAutoAssetSecure isPersonalizationRequired:@"DecideNeedPersonalize" forDescriptor:v18];
                v20 = [MAAutoAssetSelector alloc];
                assetType = [v18 assetType];
                assetSpecifier = [v18 assetSpecifier];
                assetVersion = [v18 assetVersion];
                v24 = [v20 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

                persistedEntryID = [v24 persistedEntryID];
                if (checkedDescription2)
                {
                  if (v19)
                  {
                    [v100 setSafeObject:v18 forKey:persistedEntryID];
                    v26 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                    {
                      summary = [v18 summary];
                      *buf = 138543362;
                      v133 = summary;
                      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} candidate for personalization [managed as set] | downloadedDescriptor:%{public}@", buf, 0xCu);
                    }
                  }

                  else
                  {
                    [v98 setSafeObject:v18 forKey:persistedEntryID];
                    v26 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                    {
                      summary2 = [v18 summary];
                      *buf = 138543362;
                      v133 = summary2;
                      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} candidate for personalization [singleton] | downloadedDescriptor:%{public}@", buf, 0xCu);
                    }
                  }

                  goto LABEL_24;
                }

                if ([(MADAutoAssetControlManager *)selfCopy isDescriptorCurrentlyLocked:@"DecideNeedPersonalize" forDescriptor:v18]&& ![MADAutoAssetSecure isGraftedOrMounted:@"DecideNeedPersonalize" forDescriptor:v18])
                {
                  [v97 setSafeObject:v18 forKey:persistedEntryID];
                  v26 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                  {
                    summary3 = [v18 summary];
                    *buf = 138543362;
                    v133 = summary3;
                    _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-GRAFT][STARTUP] {DecideNeedPersonalize} will graft|mount (once startup personalization completes) | downloadedDescriptor:%{public}@", buf, 0xCu);
                  }

LABEL_24:
                }
              }
            }
          }

          else
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v133 = v13;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} unable to determine previous status | entryID:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v14);
          v12 = v12 + 1;
        }

        while (v107 != v12);
        v11 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
      }

      while (v11);
    }

    if (![v98 count] && !objc_msgSend(v100, "count"))
    {
      goto LABEL_75;
    }

    v123 = 0u;
    v124 = 0u;
    v121 = 0u;
    v122 = 0u;
    v108 = v98;
    v30 = [v108 countByEnumeratingWithState:&v121 objects:v136 count:16];
    if (!v30)
    {
      goto LABEL_50;
    }

    obja = *v122;
LABEL_32:
    v105 = v30;
    v31 = 0;
    while (1)
    {
      if (*v122 != obja)
      {
        objc_enumerationMutation(v108);
      }

      v32 = [v108 safeObjectForKey:*(*(&v121 + 1) + 8 * v31) ofClass:objc_opt_class()];
      if (!v32)
      {
        goto LABEL_48;
      }

      v33 = [MAAutoAssetSelector alloc];
      assetType2 = [v32 assetType];
      assetSpecifier2 = [v32 assetSpecifier];
      v36 = [v33 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2];

      persistedEntryID2 = [v36 persistedEntryID];
      checkedDescription2 = [v111 safeObjectForKey:persistedEntryID2 ofClass:objc_opt_class()];
      if (!checkedDescription2)
      {
        [v111 setSafeObject:v32 forKey:persistedEntryID2];
        v40 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
        {
          summary4 = [v32 summary];
          *buf = 138543362;
          v133 = summary4;
          _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] first candidate for selector | nextAssetDescriptor:%{public}@", buf, 0xCu);
        }

        goto LABEL_47;
      }

      v38 = [SUCoreRestoreVersion alloc];
      assetVersion2 = [v32 assetVersion];
      v40 = [v38 initWithRestoreVersion:assetVersion2];

      v41 = [SUCoreRestoreVersion alloc];
      assetVersion3 = [checkedDescription2 assetVersion];
      v43 = [v41 initWithRestoreVersion:assetVersion3];

      if (![v40 isComparable:v43])
      {
        break;
      }

      if ([v40 compare:v43]== &dword_0 + 1)
      {
        [v111 setSafeObject:v32 forKey:persistedEntryID2];
        v44 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
        {
          summary5 = [v32 summary];
          *buf = 138543362;
          v133 = summary5;
          _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] better candidate for selector | nextAssetDescriptor:%{public}@", buf, 0xCu);
        }

LABEL_45:
      }

LABEL_47:
LABEL_48:

      if (v105 == ++v31)
      {
        v30 = [v108 countByEnumeratingWithState:&v121 objects:v136 count:16];
        if (!v30)
        {
LABEL_50:

          if ([v100 count])
          {
            v119 = 0u;
            v120 = 0u;
            v117 = 0u;
            v118 = 0u;
            knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)selfCopy knownSetConfigurationsByIdentifier];
            allKeys = [knownSetConfigurationsByIdentifier allKeys];
            v109 = [allKeys copy];

            v51 = [v109 countByEnumeratingWithState:&v117 objects:v131 count:16];
            if (v51)
            {
              v52 = *v118;
              do
              {
                for (i = 0; i != v51; i = i + 1)
                {
                  if (*v118 != v52)
                  {
                    objc_enumerationMutation(v109);
                  }

                  v54 = *(*(&v117 + 1) + 8 * i);
                  v55 = objc_autoreleasePoolPush();
                  knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)selfCopy knownSetConfigurationsByIdentifier];
                  v57 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v54 ofClass:objc_opt_class()];

                  if (v57)
                  {
                    if ([(MADAutoAssetControlManager *)selfCopy _acceptPersonalizationFromPSUSToBecomeLatestToVend:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      checkedDescription2 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(checkedDescription2, OS_LOG_TYPE_DEFAULT))
                      {
                        summary6 = [v57 summary];
                        *buf = 138543362;
                        v133 = summary6;
                        _os_log_impl(&dword_0, checkedDescription2, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide newer set atomic-instance | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else if ([(MADAutoAssetControlManager *)selfCopy _acceptPersonalizationToProvideLatestToVend:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      checkedDescription2 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(checkedDescription2, OS_LOG_TYPE_DEFAULT))
                      {
                        summary7 = [v57 summary];
                        *buf = 138543362;
                        v133 = summary7;
                        _os_log_impl(&dword_0, checkedDescription2, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide latest-to-vend | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else if ([(MADAutoAssetControlManager *)selfCopy _acceptPersonalizationToProvidePreinstalled:@"DecideNeedPersonalize" forSetConfiguration:v57 withCandidates:v100 extendingToBePersonalized:v111])
                    {
                      checkedDescription2 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(checkedDescription2, OS_LOG_TYPE_DEFAULT))
                      {
                        summary8 = [v57 summary];
                        *buf = 138543362;
                        v133 = summary8;
                        _os_log_impl(&dword_0, checkedDescription2, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] personalizing to provide pre-installed | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }

                    else
                    {
                      checkedDescription2 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(checkedDescription2, OS_LOG_TYPE_DEFAULT))
                      {
                        summary9 = [v57 summary];
                        *buf = 138543362;
                        v133 = summary9;
                        _os_log_impl(&dword_0, checkedDescription2, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [set] no startup personalization to be performed | nextSetConfiguration:%{public}@", buf, 0xCu);
                      }
                    }
                  }

                  objc_autoreleasePoolPop(v55);
                }

                v51 = [v109 countByEnumeratingWithState:&v117 objects:v131 count:16];
              }

              while (v51);
            }

            goto LABEL_74;
          }

          goto LABEL_75;
        }

        goto LABEL_32;
      }
    }

    v44 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
    {
      summary10 = [v32 summary];
      summary11 = [checkedDescription2 summary];
      *buf = 138543618;
      v133 = summary10;
      v134 = 2114;
      v135 = summary11;
      _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} [singleton] asset-versions not comparable | left(nextAssetDescriptor):%{public}@ | right(latestAssetDesctiptor):%{public}@", buf, 0x16u);
    }

    goto LABEL_45;
  }

  v62 = _MADLog(@"AutoControl");
  v109 = v62;
  if (os_log_type_enabled(v62, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v62, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {DecideNeedPersonalize} no persisted known-descriptors", buf, 2u);
  }

LABEL_74:

LABEL_75:
  if ([v111 count] || objc_msgSend(v97, "count"))
  {
    [(MADAutoAssetControlManager *)selfCopy secureStartupEstablishOperationSequence:@"DecideNeedPersonalize" forRequiringPersonalization:v111 forRequiringGrafting:v97];
    if ([v111 count])
    {
      [(MADAutoAssetControlManager *)selfCopy setSecureHealingPersonalizationAttempted:1];
      v63 = @"HaveNeedingPersonalize";
    }

    else
    {
      prePersonalizedSelectors = [(MADAutoAssetControlManager *)selfCopy prePersonalizedSelectors];
      v65 = [prePersonalizedSelectors count] == 0;

      if (!v65)
      {
        prePersonalizedSelectors2 = [(MADAutoAssetControlManager *)selfCopy prePersonalizedSelectors];
        v67 = [MADAutoAssetSecure commitPrePersonalizedSync:@"DecideNeedPersonalize" committingSelectors:prePersonalizedSelectors2];

        if (v67)
        {
          v68 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v68, OS_LOG_TYPE_ERROR))
          {
            checkedDescription = [v67 checkedDescription];
            prePersonalizedSelectors3 = [(MADAutoAssetControlManager *)selfCopy prePersonalizedSelectors];
            v71 = [prePersonalizedSelectors3 count];
            *buf = 138543618;
            v133 = checkedDescription;
            v134 = 2048;
            v135 = v71;
            _os_log_impl(&dword_0, v68, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedPersonalize} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x16u);
          }
        }

        else
        {
          v68 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
          {
            prePersonalizedSelectors4 = [(MADAutoAssetControlManager *)selfCopy prePersonalizedSelectors];
            v73 = [prePersonalizedSelectors4 count];
            *buf = 134217984;
            v133 = v73;
            _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedPersonalize} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0xCu);
          }
        }

        v74 = objc_alloc_init(NSMutableArray);
        [(MADAutoAssetControlManager *)selfCopy setPrePersonalizedSelectors:v74];

        v115 = 0u;
        v116 = 0u;
        v113 = 0u;
        v114 = 0u;
        prePersonalizedSelectors5 = [(MADAutoAssetControlManager *)selfCopy prePersonalizedSelectors];
        v76 = [prePersonalizedSelectors5 countByEnumeratingWithState:&v113 objects:v130 count:16];
        if (v76)
        {
          objb = prePersonalizedSelectors5;
          v106 = *v114;
          do
          {
            v110 = v76;
            for (j = 0; j != v110; j = j + 1)
            {
              if (*v114 != v106)
              {
                objc_enumerationMutation(objb);
              }

              v78 = *(*(&v113 + 1) + 8 * j);
              v79 = getControlManager();
              analytics = [v79 analytics];
              assetSpecifier3 = [v78 assetSpecifier];
              assetType3 = [v78 assetType];
              assetVersion4 = [v78 assetVersion];
              clientID = [personalizeCopy clientID];
              if (v67)
              {
                checkedDescription2 = [v67 checkedDescription];
                v85 = checkedDescription2;
              }

              else
              {
                v85 = 0;
              }

              LOBYTE(v95) = 0;
              LOBYTE(v94) = 0;
              LOBYTE(v93) = 0;
              LOBYTE(v92) = v67 == 0;
              v86 = [analytics recordMobileAssetSecureAttempt:assetSpecifier3 assetType:assetType3 assetVersion:assetVersion4 clientName:clientID operation:9 secureReason:@"attempting to commit pre personalized descriptors" fromLocation:@"DecideNeedPersonalize" sucessfullyPersonalized:v92 personalizeFailureReason:v85 sucessfullyMounted:v93 mountingFailureReason:0 successfullyGrafted:v94 graftingFailureReason:0 successfullyMappedToExclave:v95 mapToExclaveFailureReason:0];
              if (v67)
              {
              }
            }

            prePersonalizedSelectors5 = objb;
            v76 = [objb countByEnumeratingWithState:&v113 objects:v130 count:16];
          }

          while (v76);
        }
      }

      [(MADAutoAssetControlManager *)selfCopy considerDownloadedWithPSUSLookupResultsForLatestToVend];
      descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)selfCopy descriptorsRequiringGrafting];
      v88 = [descriptorsRequiringGrafting count] == 0;

      if (v88)
      {
        v63 = @"NoneNeedingPersonalize";
      }

      else
      {
        v63 = @"HaveNeedingGraft";
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)selfCopy considerDownloadedWithPSUSLookupResultsForLatestToVend];
    v63 = @"NoneNeedingPersonalize";
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
  v90 = [[MADAutoAssetControlManagerParam alloc] initWithSafeSummary:@"DecideNeedPersonalize"];
  [autoControlManagerFSM2 followupEvent:v63 withInfo:v90];

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"DecideNeedPersonalize"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_DecideNeedGraft:(id)graft error:(id *)error
{
  graftCopy = graft;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v26.opaque[0] = 0;
  v26.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:DecideNeedGraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v26);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"DecideNeedGraft", v26.opaque[0], v26.opaque[1]];
  v9 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"DecideNeedGraft" forSetDescriptor:0 forAutoAssetDescriptors:0];
  prePersonalizedSelectors = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v11 = [prePersonalizedSelectors count] == 0;

  if (!v11)
  {
    prePersonalizedSelectors2 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
    v13 = [MADAutoAssetSecure commitPrePersonalizedSync:@"DecideNeedGraft" committingSelectors:prePersonalizedSelectors2];

    if (v13)
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        checkedDescription = [v13 checkedDescription];
        prePersonalizedSelectors3 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
        v17 = [prePersonalizedSelectors3 count];
        *buf = 138543618;
        v28 = checkedDescription;
        v29 = 2048;
        v30 = v17;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedGraft} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x16u);
      }
    }

    else
    {
      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        prePersonalizedSelectors4 = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
        v20 = [prePersonalizedSelectors4 count];
        *buf = 134217984;
        v28 = v20;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {DecideNeedGraft} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0xCu);
      }

      [(MADAutoAssetControlManager *)self setConfigurationsPrePersonalizedJustCommitted:@"DecideNeedGraft"];
    }

    v21 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self setPrePersonalizedSelectors:v21];
  }

  [(MADAutoAssetControlManager *)self considerDownloadedWithPSUSLookupResultsForLatestToVend];
  descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v23 = [descriptorsRequiringGrafting count] == 0;

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  if (v23)
  {
    [autoControlManagerFSM2 followupEvent:@"NoneNeedingGraft" withInfo:v9];
  }

  else
  {
    [autoControlManagerFSM2 followupEvent:@"HaveNeedingGraft" withInfo:v9];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"DecideNeedGraft"];
  os_activity_scope_leave(&v26);

  return 0;
}

- (int64_t)action_AttemptNextPersonalize:(id)personalize error:(id *)error
{
  personalizeCopy = personalize;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:AttemptNextPersonalize", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"AttemptNextPersonalize"];
  descriptorsRequiringPersonalization = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v10 = [descriptorsRequiringPersonalization count];

  if (v10)
  {
    descriptorsRequiringPersonalization2 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    v12 = [descriptorsRequiringPersonalization2 objectAtIndex:0];

    descriptorsRequiringPersonalization3 = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    [descriptorsRequiringPersonalization3 removeObjectAtIndex:0];

    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __66__MADAutoAssetControlManager_action_AttemptNextPersonalize_error___block_invoke;
    v17[3] = &unk_4B46A8;
    v14 = v12;
    v18 = v14;
    selfCopy = self;
    [MADAutoAssetSecure personalizeDownloaded:@"AttemptNextPersonalize" personalizingDescriptor:v14 allowingNetwork:1 committingPersonalization:0 completion:v17];
    autoControlManagerFSM2 = v18;
  }

  else
  {
    v14 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:0];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"NoneNeedingPersonalize" withInfo:v14];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"AttemptNextPersonalize"];
  os_activity_scope_leave(&state);

  return 0;
}

void __66__MADAutoAssetControlManager_action_AttemptNextPersonalize_error___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v9 = objc_alloc_init(NSMutableArray);
  if (*(a1 + 32))
  {
    [v9 addObject:?];
  }

  v5 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:v9 withError:v4];

  v6 = [*(a1 + 40) autoControlManagerFSM];
  v7 = v6;
  if (v4)
  {
    v8 = @"StartupPersonalizeFailed";
  }

  else
  {
    v8 = @"StartupPersonalizeSuccess";
  }

  [v6 postEvent:v8 withInfo:v5];
}

- (int64_t)action_AttemptNextGraft:(id)graft error:(id *)error
{
  graftCopy = graft;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:AttemptNextGraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"AttemptNextGraft"];
  descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v10 = [descriptorsRequiringGrafting count];

  if (v10)
  {
    descriptorsRequiringGrafting2 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v12 = [descriptorsRequiringGrafting2 objectAtIndex:0];

    descriptorsRequiringGrafting3 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    [descriptorsRequiringGrafting3 removeObjectAtIndex:0];

    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v12];
    v17[0] = _NSConcreteStackBlock;
    v17[1] = 3221225472;
    v17[2] = __60__MADAutoAssetControlManager_action_AttemptNextGraft_error___block_invoke;
    v17[3] = &unk_4B46A8;
    v15 = v12;
    v18 = v15;
    selfCopy = self;
    [MADAutoAssetSecure graftDownloaded:@"AttemptNextGraft" graftingDescriptor:v15 setDescriptor:autoControlManagerFSM2 completion:v17];
  }

  else
  {
    v15 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextPersonalize" forSetDescriptor:0 forAutoAssetDescriptors:0];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"NoneNeedingGraft" withInfo:v15];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"AttemptNextGraft"];
  os_activity_scope_leave(&state);

  return 0;
}

void __60__MADAutoAssetControlManager_action_AttemptNextGraft_error___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v9 = objc_alloc_init(NSMutableArray);
  if (*(a1 + 32))
  {
    [v9 addObject:?];
  }

  v5 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"AttemptNextGraft" forSetDescriptor:0 forAutoAssetDescriptors:v9 withError:v4];

  v6 = [*(a1 + 40) autoControlManagerFSM];
  v7 = v6;
  if (v4)
  {
    v8 = @"StartupGraftFailed";
  }

  else
  {
    v8 = @"StartupGraftSuccess";
  }

  [v6 postEvent:v8 withInfo:v5];
}

- (int64_t)action_PersonalizeSuccessDecideMore:(id)more error:(id *)error
{
  moreCopy = more;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:PersonalizeSuccessDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"PersonalizeSuccessDecideMore"];
  v29 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"PersonalizeSuccessDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  autoAssetDescriptors = [moreCopy autoAssetDescriptors];
  v9 = [autoAssetDescriptors countByEnumeratingWithState:&v32 objects:v39 count:16];
  if (v9)
  {
    v10 = *v33;
    obj = autoAssetDescriptors;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v33 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v32 + 1) + 8 * i);
        if (v12)
        {
          v13 = [MAAutoAssetSelector alloc];
          assetType = [v12 assetType];
          assetSpecifier = [v12 assetSpecifier];
          assetVersion = [v12 assetVersion];
          v17 = [v13 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

          if (v17)
          {
            persistedEntryID = [v17 persistedEntryID];
            locksPriorToSecureHealing = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
            diag = [locksPriorToSecureHealing safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

            prePersonalizedSelectors = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
            [prePersonalizedSelectors addObject:v17];

            if (diag && [diag longValue] > 0)
            {
              descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
              [descriptorsRequiringGrafting addObject:v12];

              summary3 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(summary3, OS_LOG_TYPE_DEFAULT))
              {
                summary = [v12 summary];
                *buf = 138543362;
                v38 = summary;
                _os_log_impl(&dword_0, summary3, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeSuccessDecideMore} pre-personalization SUCCESS (will graft|mount) | nextPrePersonalizedDescriptor:%{public}@", buf, 0xCu);
              }
            }

            else
            {
              summary3 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(summary3, OS_LOG_TYPE_DEFAULT))
              {
                summary2 = [v12 summary];
                *buf = 138543362;
                v38 = summary2;
                _os_log_impl(&dword_0, summary3, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeSuccessDecideMore} pre-personalization SUCCESS (not locked) | nextPrePersonalizedDescriptor:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            persistedEntryID = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [persistedEntryID diag];
            v26 = [NSString alloc];
            summary3 = [v12 summary];
            v27 = [v26 initWithFormat:@"{PersonalizeSuccessDecideMore} | unable to initialize asset-selector | nextPrePersonalizedDescriptor:%@", summary3];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];
          }
        }
      }

      autoAssetDescriptors = obj;
      v9 = [obj countByEnumeratingWithState:&v32 objects:v39 count:16];
    }

    while (v9);
  }

  [(MADAutoAssetControlManager *)self assetPersonalizatonAttemptCompletePostEvent:@"PersonalizeSuccessDecideMore" withControlParam:v29];
  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"PersonalizeSuccessDecideMore"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_PersonalizeFailureDecideMore:(id)more error:(id *)error
{
  moreCopy = more;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:PersonalizeFailureDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseBegin:@"PersonalizeFailureDecideMore"];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"PersonalizeFailureDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  autoAssetDescriptors = [moreCopy autoAssetDescriptors];
  v10 = [autoAssetDescriptors countByEnumeratingWithState:&v21 objects:v30 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(autoAssetDescriptors);
        }

        v13 = *(*(&v21 + 1) + 8 * i);
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          finishedError = [moreCopy finishedError];
          checkedDescription = [finishedError checkedDescription];
          summary = [v13 summary];
          *buf = 138543618;
          v27 = checkedDescription;
          v28 = 2114;
          v29 = summary;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION][STARTUP] {PersonalizeFailureDecideMore} pre-personalization ERROR | error:%{public}@ | failedPrePersonalizeDescriptor:%{public}@", buf, 0x16u);
        }
      }

      v10 = [autoAssetDescriptors countByEnumeratingWithState:&v21 objects:v30 count:16];
    }

    while (v10);
  }

  [(MADAutoAssetControlManager *)selfCopy assetPersonalizatonAttemptCompletePostEvent:@"PersonalizeSuccessDecideMore" withControlParam:v19];
  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"PersonalizeFailureDecideMore"];

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_GraftSuccessDecideMore:(id)more error:(id *)error
{
  moreCopy = more;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:GraftSuccessDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"GraftSuccessDecideMore"];
  v19 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"GraftSuccessDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  autoAssetDescriptors = [moreCopy autoAssetDescriptors];
  v9 = [autoAssetDescriptors countByEnumeratingWithState:&v21 objects:v28 count:16];
  if (v9)
  {
    v10 = *v22;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v22 != v10)
        {
          objc_enumerationMutation(autoAssetDescriptors);
        }

        v12 = *(*(&v21 + 1) + 8 * i);
        v13 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
        {
          summary = [v12 summary];
          *buf = 138543362;
          v27 = summary;
          _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][STARTUP] {GraftSuccessDecideMore} graft|mount SUCCESS | nextGraftedDescriptor:%{public}@", buf, 0xCu);
        }
      }

      v9 = [autoAssetDescriptors countByEnumeratingWithState:&v21 objects:v28 count:16];
    }

    while (v9);
  }

  descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
  v16 = [descriptorsRequiringGrafting count] == 0;

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  if (v16)
  {
    [autoControlManagerFSM2 postEvent:@"NoneNeedingGraft" withInfo:v19];
  }

  else
  {
    [autoControlManagerFSM2 postEvent:@"HaveNeedingGraft" withInfo:v19];
  }

  [(MADAutoAssetControlManager *)self trackPerformancePhaseEnd:@"GraftSuccessDecideMore"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_GraftFailureDecideMore:(id)more error:(id *)error
{
  moreCopy = more;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:GraftFailureDecideMore", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  [(MADAutoAssetControlManager *)self trackPerformancePhaseBegin:@"GraftFailureDecideMore"];
  v28 = [[MADAutoAssetControlManagerParam alloc] initForSecureOperationsFinished:@"GraftFailureDecideMore" forSetDescriptor:0 forAutoAssetDescriptors:0];
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  autoAssetDescriptors = [moreCopy autoAssetDescriptors];
  v10 = [autoAssetDescriptors countByEnumeratingWithState:&v30 objects:v39 count:16];
  if (v10)
  {
    v11 = *v31;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v31 != v11)
        {
          objc_enumerationMutation(autoAssetDescriptors);
        }

        v13 = *(*(&v30 + 1) + 8 * i);
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          finishedError = [moreCopy finishedError];
          checkedDescription = [finishedError checkedDescription];
          summary = [v13 summary];
          *buf = 138543618;
          v36 = checkedDescription;
          v37 = 2114;
          v38 = summary;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT][STARTUP] {GraftFailureDecideMore} graft|mount ERROR | error:%{public}@ | failedGraftDescriptor:%{public}@", buf, 0x16u);
        }

        v18 = [MAAutoAssetSelector alloc];
        assetType = [v13 assetType];
        assetSpecifier = [v13 assetSpecifier];
        assetVersion = [v13 assetVersion];
        v22 = [v18 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

        finishedError2 = [moreCopy finishedError];
        [(MADAutoAssetControlManager *)selfCopy forceGlobalUnlockFromLocation:@"GraftFailureDecideMore" dueToError:finishedError2 fullAssetSelector:v22 historyOperationAI:1503 historyOperationSD:394];
      }

      v10 = [autoAssetDescriptors countByEnumeratingWithState:&v30 objects:v39 count:16];
    }

    while (v10);
  }

  descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)selfCopy descriptorsRequiringGrafting];
  v25 = [descriptorsRequiringGrafting count] == 0;

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
  if (v25)
  {
    [autoControlManagerFSM2 postEvent:@"NoneNeedingGraft" withInfo:v28];
  }

  else
  {
    [autoControlManagerFSM2 postEvent:@"HaveNeedingGraft" withInfo:v28];
  }

  [(MADAutoAssetControlManager *)selfCopy trackPerformancePhaseEnd:@"GraftFailureDecideMore"];
  os_activity_scope_leave(&state);

  return 0;
}

- (int64_t)action_StagerAlreadyDownloaded:(id)downloaded error:(id *)error
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerAlreadyDownloaded", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  v9 = [(MADAutoAssetControlManager *)self _alreadyDownloadedDescriptorsArray:@"StagerAlreadyDownloaded" limitingToSupportingStaging:1, v14.opaque[0], v14.opaque[1]];
  locateNewAllSetConfigurations = [(MADAutoAssetControlManager *)self locateNewAllSetConfigurations];
  locateNewAllSetTargets = [(MADAutoAssetControlManager *)self locateNewAllSetTargets];
  v12 = +[MADAutoAssetScheduler jobsAwaitingTrigger];
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  [MADAutoAssetStager controlAlreadyDownloadedDescriptors:v9 withSetConfigurations:locateNewAllSetConfigurations withSetTargets:locateNewAllSetTargets withScheduledJobs:v12];

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_StagerJobStartDetermine:(id)determine error:(id *)error
{
  determineCopy = determine;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobStartDetermine", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  stagerCurrentJob = [(MADAutoAssetControlManager *)self stagerCurrentJob];

  if (stagerCurrentJob)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v12 = [NSString alloc];
    stagerCurrentJobUUID = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    if (stagerCurrentJobUUID)
    {
      stagerCurrentJobUUID2 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    }

    else
    {
      stagerCurrentJobUUID2 = @"N";
    }

    v15 = [v12 initWithFormat:@"{StagerStartJobDetermine} stager-job when already have a current stager-job - abandoning older stager-job with jobUUID:%@", stagerCurrentJobUUID2];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v15 withResult:6109 withError:0];

    if (stagerCurrentJobUUID)
    {
    }

    [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
    [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
    [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  }

  v16 = +[NSUUID UUID];
  uUIDString = [v16 UUIDString];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:uUIDString];

  stagerCurrentJobUUID3 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  [(MADAutoAssetControlManager *)self osTransactionNameStagerDetermineJob:stagerCurrentJobUUID3];
  v19 = os_transaction_create();

  v20 = [MADAutoAssetJob alloc];
  setConfiguration = [determineCopy setConfiguration];
  stagerCurrentJobUUID4 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  v23 = +[MADAutoAssetControlManager stagerSetPolicy];
  v24 = [(MADAutoAssetJob *)v20 initForSetConfiguration:setConfiguration withLifetimeOSTransaction:v19 withAutoAssetUUID:stagerCurrentJobUUID4 asStagerJob:1 withStagerSetPolicy:v23];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:v24];

  stagerCurrentJob2 = [(MADAutoAssetControlManager *)self stagerCurrentJob];

  if (stagerCurrentJob2)
  {
    [(MADAutoAssetControlManager *)self _statsIncrementStagerDetermineJobsStarted];
    stagerCurrentJob3 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    assetTargetOSVersion = [determineCopy assetTargetOSVersion];
    assetTargetBuildVersion = [determineCopy assetTargetBuildVersion];
    assetTargetTrainName = [determineCopy assetTargetTrainName];
    assetTargetRestoreVersion = [determineCopy assetTargetRestoreVersion];
    setConfiguration2 = [determineCopy setConfiguration];
    v32 = [(MADAutoAssetControlManager *)self jobControlInformationForSetConfiguration:setConfiguration2];
    [stagerCurrentJob3 startStagerDetermineIfAvailable:assetTargetOSVersion withAssetTargetBuildVersion:assetTargetBuildVersion withAssetTargetTrainName:assetTargetTrainName withAssetTargetRestoreVersion:assetTargetRestoreVersion withControlInformation:v32];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v35 = [NSString alloc];
    autoAssetSelector = [determineCopy autoAssetSelector];
    summary = [autoAssetSelector summary];
    v38 = [v35 initWithFormat:@"{StagerStartJobDetermine} unable to allocate stager-job for selector:%@", summary];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6101 withError:0];

    stagerCurrentJob3 = [MAAutoAssetError buildError:6101 fromOperation:@"StagerJobStartDetermine" underlyingError:0 withDescription:@"unable to allocate stager-job"];
    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:stagerCurrentJob3];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_StagerJobStartDownload:(id)download error:(id *)error
{
  downloadCopy = download;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobStartDownload", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoAssetSelector = [downloadCopy autoAssetSelector];
  LODWORD(extendedStateQueue) = [(MADAutoAssetControlManager *)self isAutoAssetBeingEliminated:autoAssetSelector];

  if (extendedStateQueue)
  {
    v10 = [MAAutoAssetError buildError:6114 fromOperation:@"StagerJobStartDownload" underlyingError:0 withDescription:@"stager-job for auto-asset being eliminated"];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      autoAssetSelector2 = [downloadCopy autoAssetSelector];
      summary = [autoAssetSelector2 summary];
      *buf = 138543362;
      v50 = summary;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{StagerJobStartDownload} [EliminationInProgress] stager-job for auto-asset being eliminated | selector:%{public}@", buf, 0xCu);
    }

    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:v10];
  }

  stagerCurrentJob = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  v15 = stagerCurrentJob == 0;

  if (!v15)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v18 = [NSString alloc];
    stagerCurrentJobUUID = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    if (stagerCurrentJobUUID)
    {
      stagerCurrentJobUUID2 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
    }

    else
    {
      stagerCurrentJobUUID2 = @"N";
    }

    v21 = [v18 initWithFormat:@"{StagerStartJobDownload} stager-job when already have a current stager-job - abandoning older stager-job with jobUUID:%@", stagerCurrentJobUUID2];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v21 withResult:6109 withError:0];

    if (stagerCurrentJobUUID)
    {
    }

    [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
    [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
    [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  }

  v22 = +[NSUUID UUID];
  uUIDString = [v22 UUIDString];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:uUIDString];

  stagerCurrentJobUUID3 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  [(MADAutoAssetControlManager *)self osTransactionNameStagerDownloadJob:stagerCurrentJobUUID3];
  v25 = os_transaction_create();

  v26 = [MADAutoAssetJob alloc];
  autoAssetSelector3 = [downloadCopy autoAssetSelector];
  stagerCurrentJobUUID4 = [(MADAutoAssetControlManager *)self stagerCurrentJobUUID];
  v29 = +[MADAutoAssetControlManager stagerSetPolicy];
  autoAssetCatalog = [downloadCopy autoAssetCatalog];
  baseForPatchDescriptor = [downloadCopy baseForPatchDescriptor];
  v32 = [(MADAutoAssetJob *)v26 initForSelector:autoAssetSelector3 withLifetimeOSTransaction:v25 withAutoAssetUUID:stagerCurrentJobUUID4 asStagerJob:1 withStagerSetPolicy:v29 usingCachedAutoAssetCatalog:autoAssetCatalog usingBaseForPatching:baseForPatchDescriptor];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:v32];

  stagerCurrentJob2 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  LODWORD(autoAssetSelector3) = stagerCurrentJob2 == 0;

  if (autoAssetSelector3)
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v43 = [NSString alloc];
    autoAssetSelector4 = [downloadCopy autoAssetSelector];
    summary2 = [autoAssetSelector4 summary];
    v46 = [v43 initWithFormat:@"{StagerStartJobDownload} unable to allocate stager-job for selector:%@", summary2];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v46 withResult:6101 withError:0];

    stagerCurrentJob3 = [MAAutoAssetError buildError:6101 fromOperation:@"StagerJobStartDownload" underlyingError:0 withDescription:@"unable to allocate stager-job"];
    [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    [MADAutoAssetStager autoAssetStagerJobFailedToStart:stagerCurrentJob3];
  }

  else
  {
    autoAssetSelector5 = [downloadCopy autoAssetSelector];
    [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:autoAssetSelector5];

    [(MADAutoAssetControlManager *)self _statsIncrementStagerDownloadJobsStarted];
    stagerCurrentJob3 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    assetTargetOSVersion = [downloadCopy assetTargetOSVersion];
    assetTargetBuildVersion = [downloadCopy assetTargetBuildVersion];
    autoAssetCatalog2 = [downloadCopy autoAssetCatalog];
    autoAssetSelector6 = [downloadCopy autoAssetSelector];
    v40 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:autoAssetSelector6];
    [stagerCurrentJob3 startStagerDownloadForStaging:assetTargetOSVersion withAssetTargetBuildVersion:assetTargetBuildVersion usingCachedAutoAssetCatalog:autoAssetCatalog2 withControlInformation:v40];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_StagerJobDoneDetermine:(id)determine error:(id *)error
{
  determineCopy = determine;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobDoneDetermine", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v13);

  [(MADAutoAssetControlManager *)self _statsIncrementStagerDetermineJobsFinished:v13.opaque[0]];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:0];
  [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
  [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
  [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  autoAssetCatalog = [determineCopy autoAssetCatalog];
  baseForStagingDescriptors = [determineCopy baseForStagingDescriptors];
  finishedError = [determineCopy finishedError];
  [MADAutoAssetStager autoAssetStagerJobDetermineDone:autoAssetCatalog withBaseForStagingDescriptors:baseForStagingDescriptors withDetermineError:finishedError];

  os_activity_scope_leave(&v13);
  return 0;
}

- (int64_t)action_StagerJobDoneDownload:(id)download error:(id *)error
{
  downloadCopy = download;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13.opaque[0] = 0;
  v13.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobDoneDownload", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v13);

  [(MADAutoAssetControlManager *)self _statsIncrementStagerDownloadJobsFinished:v13.opaque[0]];
  [(MADAutoAssetControlManager *)self setStagerCurrentJob:0];
  [(MADAutoAssetControlManager *)self setStagerCurrentJobUUID:0];
  [(MADAutoAssetControlManager *)self setStagerFormedSetConfiguration:0];
  [(MADAutoAssetControlManager *)self setStagerDownloadingSelector:0];
  [(MADAutoAssetControlManager *)self setStagerBondedToAutoJob:0];
  jobInformation = [downloadCopy jobInformation];
  downloadingDescriptor = [downloadCopy downloadingDescriptor];
  finishedError = [downloadCopy finishedError];
  [MADAutoAssetStager autoAssetStagerJobDownloadDone:jobInformation withDownloadedDescriptor:downloadingDescriptor withDownloadError:finishedError];

  os_activity_scope_leave(&v13);
  return 0;
}

- (int64_t)action_StagerJobCancel:(id)cancel error:(id *)error
{
  cancelCopy = cancel;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:StagerJobCancel", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v14);

  v9 = [(MADAutoAssetControlManager *)self stagerCurrentJob:v14.opaque[0]];
  LODWORD(v8) = v9 == 0;

  if (v8)
  {
    stagerCurrentJob2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(stagerCurrentJob2, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v16 = _updateLatestSummary;
      _os_log_impl(&dword_0, stagerCurrentJob2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {StagerJobCancel} no stager-job - stale trigger to cancel from auto-asset-stager", buf, 0xCu);
    }
  }

  else
  {
    stagerCurrentJob = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    [stagerCurrentJob setBeingCanceled:1];

    stagerCurrentJob2 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
    [stagerCurrentJob2 cancelAutoAssetJob];
  }

  os_activity_scope_leave(&v14);
  return 0;
}

- (int64_t)action_StagerRemoveAllNotPromoted:(id)promoted error:(id *)error
{
  promotedCopy = promoted;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:StagerRemoveAllNotPromoted", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  autoAssetDescriptors = [promotedCopy autoAssetDescriptors];
  v9 = [autoAssetDescriptors countByEnumeratingWithState:&v20 objects:v25 count:16];
  if (v9)
  {
    v10 = *v21;
    obj = autoAssetDescriptors;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v21 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v20 + 1) + 8 * i);
        assetType = [v12 assetType];
        assetSpecifier = [v12 assetSpecifier];
        assetVersion = [v12 assetVersion];
        v16 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"StagerRemoveAllNotPromoted" forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

        if (!v16)
        {
          [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"StagerRemoveAllNotPromoted" droppingDescriptor:v12 forHistoryOperation:407 firstClientName:0];
        }
      }

      autoAssetDescriptors = obj;
      v9 = [obj countByEnumeratingWithState:&v20 objects:v25 count:16];
    }

    while (v9);
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateSchedulerDone:(id)done error:(id *)error
{
  doneCopy = done;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateSchedulerDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  autoAssetSelector = [doneCopy autoAssetSelector];
  persistedEntryID = [autoAssetSelector persistedEntryID];
  v12 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingSchedulerAck])
    {
      [v12 setAwaitingSchedulerAck:0];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v21 = [NSString alloc];
      summary = [v12 summary];
      v23 = [v21 initWithFormat:@"{EliminateSchedulerDone} duplicate scheduler indication for eliminateTracker:%@", summary];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v15 = [NSString alloc];
    autoAssetSelector2 = [doneCopy autoAssetSelector];
    summary2 = [autoAssetSelector2 summary];
    v18 = [v15 initWithFormat:@"{EliminateSchedulerDone} not tracking eliminate for autoAssetSelector:%@", summary2];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateStagerDone:(id)done error:(id *)error
{
  doneCopy = done;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateStagerDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  autoAssetSelector = [doneCopy autoAssetSelector];
  persistedEntryID = [autoAssetSelector persistedEntryID];
  v12 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingStagerAck])
    {
      [v12 setAwaitingStagerAck:0];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v21 = [NSString alloc];
      summary = [v12 summary];
      v23 = [v21 initWithFormat:@"{EliminateStagerDone} duplicate stager indication for eliminateTracker:%@", summary];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v15 = [NSString alloc];
    autoAssetSelector2 = [doneCopy autoAssetSelector];
    summary2 = [autoAssetSelector2 summary];
    v18 = [v15 initWithFormat:@"{EliminateStagerDone} not tracking eliminate for autoAssetSelector:%@", summary2];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_EliminateStagerSetDone:(id)done error:(id *)error
{
  doneCopy = done;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:EliminateStagerSetDone", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [MAAutoAssetSelector alloc];
  setConfiguration = [doneCopy setConfiguration];
  clientDomainName = [setConfiguration clientDomainName];
  setConfiguration2 = [doneCopy setConfiguration];
  assetSetIdentifier = [setConfiguration2 assetSetIdentifier];
  v14 = [v9 initForAssetType:clientDomainName withAssetSpecifier:assetSetIdentifier];

  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  persistedEntryID = [v14 persistedEntryID];
  v17 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v17)
  {
    if ([v17 awaitingStagerAck])
    {
      [v17 setAwaitingStagerAck:0];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v29 = [NSString alloc];
      summary = [v17 summary];
      v31 = [v29 initWithFormat:@"{EliminateStagerSetDone} duplicate stager indication for eliminateTracker:%@", summary];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v31 withResult:6109 withError:0];

      v32 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
      {
        summary2 = [v17 summary];
        *buf = 138543362;
        v37 = summary2;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{EliminateStagerSetDone} [TooManyEntries] duplicate stager indication for eliminateTracker:%{public}@", buf, 0xCu);
      }
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v17];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v20 = [NSString alloc];
    setConfiguration3 = [doneCopy setConfiguration];
    summary3 = [setConfiguration3 summary];
    v23 = [v20 initWithFormat:@"{EliminateStagerSetDone} not tracking eliminate for setConfiguration:%@", summary3];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6103 withError:0];

    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      setConfiguration4 = [doneCopy setConfiguration];
      summary4 = [setConfiguration4 summary];
      *buf = 138543362;
      v37 = summary4;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{EliminateStagerSetDone} [InvalidInstance] not tracking eliminate for setConfiguration:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)action_CancelActivityAck:(id)ack error:(id *)error
{
  ackCopy = ack;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:CancelActivityAck", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  autoAssetSelector = [ackCopy autoAssetSelector];
  persistedEntryID = [autoAssetSelector persistedEntryID];
  v12 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v12)
  {
    if ([v12 awaitingCancelActivityAck])
    {
      [v12 setAwaitingCancelActivityAck:0];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v21 = [NSString alloc];
      summary = [v12 summary];
      v23 = [v21 initWithFormat:@"{CancelActivityAck} duplicate cancel-activity-ack indication for eliminateTracker:%@", summary];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6109 withError:0];
    }

    [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v12];
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v15 = [NSString alloc];
    autoAssetSelector2 = [ackCopy autoAssetSelector];
    summary2 = [autoAssetSelector2 summary];
    v18 = [v15 initWithFormat:@"{CancelActivityAck} not tracking eliminate for autoAssetSelector:%@", summary2];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];
  }

  os_activity_scope_leave(&state);
  return 0;
}

- (int64_t)actionUnknownAction:(id)action error:(id *)error
{
  actionCopy = action;
  actionCopy = [[NSString alloc] initWithFormat:@"unknown action(%@)", actionCopy];

  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM diag];
  [diag dumpTracked:actionCopy dumpingTo:5 usingFilename:0 clearingStatistics:0 clearingHistory:0];

  return 0;
}

- (int64_t)action_InstallAssets:(id)assets error:(id *)error
{
  assetsCopy = assets;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11.opaque[0] = 0;
  v11.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:InstallAssets", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v11);

  if (_MAPreferencesIsInternalAllowed())
  {
    downloadingDescriptor = [assetsCopy downloadingDescriptor];
    [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:downloadingDescriptor fromLocation:@"InstallAssets"];
  }

  os_activity_scope_leave(&v11);

  return 0;
}

- (BOOL)startupActivationIsFirstExecutionSinceBoot:(id)boot
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = +[NSFileManager defaultManager];
  if ([v5 fileExistsAtPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"])
  {
    v6 = +[MADAutoAssetControlManager preferenceStartupSimulateFirstBoot];
  }

  else
  {
    v6 = 1;
  }

  return v6;
}

- (void)startupActivationCompleted:(id)completed
{
  completedCopy = completed;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:startupActivationCompleted", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  _startupActivationProcessIdentifier = [(MADAutoAssetControlManager *)self _startupActivationProcessIdentifier];
  startupActivationResourceSummary = [(MADAutoAssetControlManager *)self startupActivationResourceSummary];
  v42 = [[NSString alloc] initWithFormat:@"{%@}%@%@", completedCopy, _startupActivationProcessIdentifier, startupActivationResourceSummary];
  v43 = [[MAAutoAssetSelector alloc] initForAssetType:_startupActivationProcessIdentifier withAssetSpecifier:startupActivationResourceSummary matchingAssetVersion:@"3.0.4"];
  _MAPreferencesSetStringValue(@"persistedStateLoadingInProgress", 0, completedCopy, @"Indicating that loading of persisted state is done");
  v41 = +[NSFileManager defaultManager];
  if ([(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:completedCopy])
  {
    v10 = objc_alloc_init(NSMutableDictionary);
    [v10 setObject:&__kCFBooleanTrue forKeyedSubscript:@"ActivationStatus"];
    [(MADAutoAssetControlManager *)self setFirstDaemonStartupSinceDeviceBoot:1];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543618;
      v47 = v42;
      v48 = 2114;
      v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] Writing STARTUP_ACTIVATED cookie file [%{public}@]", buf, 0x16u);
    }

    v12 = [NSURL fileURLWithPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"];
    v44 = 0;
    [v10 writeToURL:v12 error:&v44];
    v13 = v44;

    if (v13)
    {
      [MADAutoAssetHistory recordFailedOperation:623 fromLayer:1 failingWithError:v13];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        checkedDescription = [v13 checkedDescription];
        *buf = 138543874;
        v47 = v42;
        v48 = 2114;
        v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
        v50 = 2112;
        v51 = checkedDescription;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "%{public}@\n[STARTUP-COMPLETED] Failed to write STARTUP_ACTIVATED cookie file [%{public}@] | stashError:%@", buf, 0x20u);
      }
    }

    else
    {
      if ([v41 fileExistsAtPath:@"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot"])
      {
        [MADAutoAssetHistory recordOperation:622 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
        v13 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          v47 = v42;
          _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] Successfully wrote STARTUP_ACTIVATED cookie file", buf, 0xCu);
        }

        goto LABEL_16;
      }

      v13 = [MAAutoAssetError buildError:6101 fromOperation:completedCopy underlyingError:0 withDescription:@"failed post-write existence check after writing STARTUP_ACTIVATED cookie file (even though call to writeToURL was successful)"];
      [MADAutoAssetHistory recordFailedOperation:623 fromLayer:1 failingWithError:v13];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        checkedDescription2 = [v13 checkedDescription];
        *buf = 138543874;
        v47 = v42;
        v48 = 2114;
        v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
        v50 = 2112;
        v51 = checkedDescription2;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "%{public}@\n[STARTUP-COMPLETED] Failed post-write existence check after writing STARTUP_ACTIVATED cookie file [%{public}@] | stashError:%@", buf, 0x20u);
      }
    }

LABEL_16:
    goto LABEL_17;
  }

  [MADAutoAssetHistory recordOperation:624 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v47 = v42;
    v48 = 2114;
    v49 = @"/.nofollow/private/var/run/MobileAssetStartupActivation.doneThisBoot";
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "%{public}@\n[STARTUP-COMPLETED] STARTUP_ACTIVATED cookie file exists [%{public}@]", buf, 0x16u);
  }

LABEL_17:

  [MADAutoAssetHistory recordOperation:620 toHistoryType:0 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:v43];
  [MADAutoAssetControlManager postNotificationName:@"STARTUP_ACTIVATED" forAssetType:@"com.apple.MobileAsset.MAAutoAsset" forAssetSpecifier:0 fromModule:@"AUTO-CONTROL" fromLocation:completedCopy];
  if ([(MADAutoAssetControlManager *)self bootedSoftwareUpdate])
  {
    v17 = @"Psus";
  }

  else
  {
    v18 = isReboot();
    v17 = @"Restart";
    if (v18)
    {
      v17 = @"Reboot";
    }
  }

  v19 = v17;
  startupPerfResults = [(MADAutoAssetControlManager *)self startupPerfResults];
  v21 = startupPerfResults == 0;

  if (!v21)
  {
    startupPerfResults2 = [(MADAutoAssetControlManager *)self startupPerfResults];
    v23 = [startupPerfResults2 getPerfResults:0];

    if (v23)
    {
      v24 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        v25 = *__error();
        *buf = 67109120;
        LODWORD(v47) = v25;
        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "{ResumeJobs} startup libproc method failed for perf analysis, errno:%d", buf, 8u);
      }

      v26 = _MADLog(@"AutoControl");
      startupSignpost = [(MADAutoAssetControlManager *)self startupSignpost];
      if (startupSignpost - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v26))
      {
        v28 = mach_continuous_time();
        *buf = 134349056;
        v47 = v28;
        _os_signpost_emit_with_name_impl(&dword_0, v26, OS_SIGNPOST_INTERVAL_END, startupSignpost, "Startup", "%{public, signpost.description:end_time}llu  enableTelemetry=YES ", buf, 0xCu);
      }
    }

    else
    {
      v26 = _MADLog(@"AutoControl");
      startupSignpost2 = [(MADAutoAssetControlManager *)self startupSignpost];
      if (startupSignpost2 - 1 <= 0xFFFFFFFFFFFFFFFDLL && os_signpost_enabled(v26))
      {
        v40 = mach_continuous_time();
        startupPerfResults3 = [(MADAutoAssetControlManager *)self startupPerfResults];
        instructionsCount = [startupPerfResults3 instructionsCount];
        startupPerfResults4 = [(MADAutoAssetControlManager *)self startupPerfResults];
        cyclesCount = [startupPerfResults4 cyclesCount];
        v33 = v19;
        uTF8String = [(__CFString *)v19 UTF8String];
        *buf = 134349826;
        v47 = v40;
        v48 = 2050;
        v49 = instructionsCount;
        v50 = 2050;
        v51 = cyclesCount;
        v52 = 2082;
        v53 = uTF8String;
        _os_signpost_emit_with_name_impl(&dword_0, v26, OS_SIGNPOST_INTERVAL_END, startupSignpost2, "Startup", "%{public, signpost.description:end_time}llu instructions=%{public, signpost.telemetry:number1,name=instructions}lld cycles=%{public, signpost.telemetry:number2,name=cycles}lldstate=%{public, signpost.telemetry:string1,name=state}s enableTelemetry=YES ", buf, 0x2Au);
      }
    }

    [(MADAutoAssetControlManager *)self setStartupSignpost:0];
  }

  startupTransaction = [(MADAutoAssetControlManager *)self startupTransaction];

  if (startupTransaction)
  {
    v36 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v47 = _updateLatestSummary;
      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {ResumeJobs} ending startup transaction.", buf, 0xCu);
    }

    [(MADAutoAssetControlManager *)self setStartupTransaction:0];
  }

  v38 = +[MobileAssetHealthReport sharedInstance];
  [v38 scheduleReport];

  os_activity_scope_leave(&state);
}

- (id)_startupActivationProcessIdentifier
{
  v2 = [[NSString alloc] initWithFormat:@"(OS:%@[%@], pid:%ld)", self->_bootedOSVersion, self->_bootedOSBuildVersion, getpid()];
  if (!v2)
  {
    v2 = @"MA-PROCESS-IDENTIFIER";
  }

  return v2;
}

- (id)startupActivationResourceSummary
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v24 = [NSString alloc];
  [(MADAutoAssetControlManager *)self startupTimeDurationSeconds];
  v23 = v5;
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v21 = [persistedKnownDescriptors persistedEntryCount:@"startupActivationResourceSummary"];
  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v20 = [persistedKnownSetConfigurations persistedEntryCount:@"startupActivationResourceSummary"];
  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v19 = [persistedKnownSetAtomicInstances persistedEntryCount:@"startupActivationResourceSummary"];
  setLockUsageMapLockCount = [(MADAutoAssetControlManager *)self setLockUsageMapLockCount];
  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v7 = [persistedDownloadedSetDescriptors persistedEntryCount:@"startupActivationResourceSummary"];
  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v9 = [persistedSetTargets persistedEntryCount:@"startupActivationResourceSummary"];
  persistedSetLookupResults = [(MADAutoAssetControlManager *)self persistedSetLookupResults];
  v11 = [persistedSetLookupResults persistedEntryCount:@"startupActivationResourceSummary"];
  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v13 = [persistedActiveJobs persistedEntryCount:@"startupActivationResourceSummary"];
  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v15 = [v24 initWithFormat:@"[STARTUP][DURATION:%ldsecs](assets:%ld, configs:%ld, atomic:%ld[locks:%ld], sdesc:%ld, targets:%ld, lookups:%ld, jobs:[single:%ld, set:%ld])", v23, v21, v20, v19, setLockUsageMapLockCount, v7, v9, v11, v13, objc_msgSend(persistedActiveJobSetDescriptors, "persistedEntryCount:", @"startupActivationResourceSummary"];

  if (v15)
  {
    v16 = v15;
  }

  else
  {
    v16 = @"MA-RESOURCE-SUMMARY";
  }

  return v16;
}

- (void)trackClientRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestsBeingTracked = [(MADAutoAssetControlManager *)self clientRequestsBeingTracked];
  clientRequestUUID = [requestCopy clientRequestUUID];
  [clientRequestsBeingTracked setSafeObject:requestCopy forKey:clientRequestUUID];

  statistics = [(MADAutoAssetControlManager *)self statistics];
  totalClientRequests = [statistics totalClientRequests];
  [(MADAutoAssetControlManager *)self _statsIncrement:totalClientRequests forClientRequest:requestCopy];
}

- (void)removeClientRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v80 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:removeClientRequest", locationCopy];
  if (requestCopy)
  {
    clientReplyCompletion = [requestCopy clientReplyCompletion];

    if (clientReplyCompletion)
    {
      v13 = [NSString alloc];
      summary = [requestCopy summary];
      v15 = [v13 initWithFormat:@"{%@:removeClientRequest} | removing client request that has not been replied to - replying with error | clientRequest:%@", locationCopy, summary];

      v16 = [MAAutoAssetError buildError:6103 fromOperation:locationCopy underlyingError:0 withDescription:v15];
      clientRequestMessage = [requestCopy clientRequestMessage];
      v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
      clientID = [requestCopy clientID];
      v20 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:v16];

      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v15 withResult:6103 withError:v16];

      statistics = [(MADAutoAssetControlManager *)self statistics];
      totalClientRepliesFailure = [statistics totalClientRepliesFailure];
      [(MADAutoAssetControlManager *)self _statsIncrement:totalClientRepliesFailure forClientRequest:requestCopy];

      clientReplyCompletion2 = [requestCopy clientReplyCompletion];
      (clientReplyCompletion2)[2](clientReplyCompletion2, v20, v16);

      [requestCopy setClientReplyCompletion:0];
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    }

    [(MADAutoAssetControlManager *)self timerStopForClientRequest:requestCopy fromLocation:locationCopy];
    v26 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v81 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"clientRequestsAwaitingSync"];
    v95 = 0u;
    v96 = 0u;
    v93 = 0u;
    v94 = 0u;
    clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
    v28 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v93 objects:v104 count:16];
    selfCopy = self;
    v85 = locationCopy;
    if (v28)
    {
      v29 = v28;
      obj = requestCopy;
      v83 = 0;
      v30 = *v94;
      do
      {
        for (i = 0; i != v29; i = i + 1)
        {
          if (*v94 != v30)
          {
            objc_enumerationMutation(clientRequestsAwaitingSync);
          }

          v32 = clientRequestsAwaitingSync;
          v33 = *(*(&v93 + 1) + 8 * i);
          v34 = objc_autoreleasePoolPush();
          clientRequest = [v33 clientRequest];
          clientRequestUUID = [clientRequest clientRequestUUID];
          clientRequestUUID2 = [obj clientRequestUUID];
          v38 = [SUCore stringIsEqual:clientRequestUUID to:clientRequestUUID2];

          if (v38)
          {
            v39 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v39, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary2 = [v33 summary];
              *buf = 138543874;
              v99 = _updateLatestSummary;
              v100 = 2114;
              v101 = v85;
              v102 = 2114;
              v103 = summary2;
              _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:removeClientRequest} [CLIENT_REQUESTS_AWAITING_SYNC] | trimmed client-request | jobParam:%{public}@", buf, 0x20u);
            }

            statistics2 = [(MADAutoAssetControlManager *)selfCopy statistics];
            totalDequeuedClientRequests = [statistics2 totalDequeuedClientRequests];
            clientRequest2 = [v33 clientRequest];
            [(MADAutoAssetControlManager *)selfCopy _statsIncrement:totalDequeuedClientRequests forClientRequest:clientRequest2];

            v83 = 1;
          }

          else if (v33)
          {
            [v81 addObject:v33];
          }

          else
          {
            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag2 = [autoControlManagerFSM3 diag];
            v47 = [NSString alloc];
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            v49 = [v47 initWithFormat:@"{%@:removeClientRequest} | nil jobParam on clientRequestsAwaitingSync | %@", v85, _updateLatestSummary2];
            [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v49 withResult:6102 withError:0];
          }

          objc_autoreleasePoolPop(v34);
          clientRequestsAwaitingSync = v32;
        }

        v29 = [v32 countByEnumeratingWithState:&v93 objects:v104 count:16];
      }

      while (v29);

      requestCopy = obj;
      self = selfCopy;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      v26 = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      locationCopy = v85;
      if (v83)
      {
        [(MADAutoAssetControlManager *)selfCopy setClientRequestsAwaitingSync:v81];
      }
    }

    else
    {
    }

    v82 = objc_alloc_init(v26[228]);

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"clientRequestsAwaitingFirstUnlock"];
    v91 = 0u;
    v92 = 0u;
    v89 = 0u;
    v90 = 0u;
    clientRequestsAwaitingFirstUnlock = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
    v55 = [clientRequestsAwaitingFirstUnlock countByEnumeratingWithState:&v89 objects:v97 count:16];
    if (v55)
    {
      v56 = v55;
      v57 = requestCopy;
      v84 = 0;
      v58 = *v90;
      obja = clientRequestsAwaitingFirstUnlock;
      do
      {
        for (j = 0; j != v56; j = j + 1)
        {
          if (*v90 != v58)
          {
            objc_enumerationMutation(obja);
          }

          v60 = *(*(&v89 + 1) + 8 * j);
          v61 = objc_autoreleasePoolPush();
          clientRequest3 = [v60 clientRequest];
          clientRequestUUID3 = [clientRequest3 clientRequestUUID];
          clientRequestUUID4 = [v57 clientRequestUUID];
          v65 = [SUCore stringIsEqual:clientRequestUUID3 to:clientRequestUUID4];

          if (v65)
          {
            statistics3 = [(MADAutoAssetControlManager *)selfCopy statistics];
            totalDequeuedClientRequests2 = [statistics3 totalDequeuedClientRequests];
            clientRequest4 = [v60 clientRequest];
            [(MADAutoAssetControlManager *)selfCopy _statsIncrement:totalDequeuedClientRequests2 forClientRequest:clientRequest4];

            v84 = 1;
          }

          else if (v60)
          {
            [v82 addObject:v60];
          }

          else
          {
            autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag3 = [autoControlManagerFSM4 diag];
            v71 = [NSString alloc];
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            v73 = [v71 initWithFormat:@"{%@:removeClientRequest} | nil jobParam on clientRequestsAwaitingFirstUnlock | %@", v85, _updateLatestSummary3];
            [diag3 trackAnomaly:@"AUTO-CONTROL" forReason:v73 withResult:6102 withError:0];
          }

          objc_autoreleasePoolPop(v61);
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        }

        v56 = [obja countByEnumeratingWithState:&v89 objects:v97 count:16];
      }

      while (v56);

      requestCopy = v57;
      if (v84)
      {
        [(MADAutoAssetControlManager *)selfCopy setClientRequestsAwaitingFirstUnlock:v82];
      }
    }

    else
    {
    }

    clientRequestUUID5 = [requestCopy clientRequestUUID];

    if (clientRequestUUID5)
    {
      clientRequestsBeingTracked = [(MADAutoAssetControlManager *)selfCopy clientRequestsBeingTracked];
      clientRequestUUID6 = [requestCopy clientRequestUUID];
      [clientRequestsBeingTracked removeObjectForKey:clientRequestUUID6];
    }

    else
    {
      clientRequestsBeingTracked = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      clientRequestUUID6 = [clientRequestsBeingTracked diag];
      v77 = objc_alloc(p_weak_ivar_lyt[226]);
      summary3 = [requestCopy summary];
      v79 = [v77 initWithFormat:@"{removeClientRequest} client-request without clientRequestUUID | clientRequest:%@", summary3];
      [clientRequestUUID6 trackAnomaly:@"AUTO-CONTROL" forReason:v79 withResult:6109 withError:0];
    }

    v51 = v85;
  }

  else
  {
    autoControlManagerFSM5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM5 diag];
    v52 = v51 = locationCopy;
    v53 = [[NSString alloc] initWithFormat:@"{%@:removeClientRequest} | nil clientRequest provided", v51];
    [v52 trackAnomaly:@"AUTO-CONTROL" forReason:v53 withResult:6102 withError:0];
  }
}

- (void)clientRequestsAwaitingSyncToAwaitingFirstUnlock:(id)unlock
{
  unlockCopy = unlock;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v42 = unlockCopy;
  unlockCopy = [[NSString alloc] initWithFormat:@"%@:clientRequestsAwaitingSyncToAwaitingFirstUnlock", unlockCopy];
  v44 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:unlockCopy ofContainer:@"clientRequestsAwaitingSync"];
  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
  v47 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v54 objects:v65 count:16];
  if (v47)
  {
    obj = *v55;
    v43 = clientRequestsAwaitingSync;
    do
    {
      for (i = 0; i != v47; i = i + 1)
      {
        if (*v55 != obj)
        {
          objc_enumerationMutation(clientRequestsAwaitingSync);
        }

        v10 = *(*(&v54 + 1) + 8 * i);
        v11 = objc_autoreleasePoolPush();
        if (!v10)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v18 = [[NSString alloc] initWithFormat:@"{%@} | nil jobParam on clientRequestsAwaitingSync", unlockCopy];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6102 withError:0];

          goto LABEL_21;
        }

        clientRequest = [v10 clientRequest];
        v13 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest];

        if (v13)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:unlockCopy withEventInfo:v10];
          if (autoControlManagerFSM2)
          {
            [v44 addObject:v10];
            diag = [(MADAutoAssetControlManager *)self statistics];
            totalDequeuedClientRequests = [diag totalDequeuedClientRequests];
            clientRequest2 = [v10 clientRequest];
            [(MADAutoAssetControlManager *)self _statsIncrement:totalDequeuedClientRequests forClientRequest:clientRequest2];
          }

          else
          {
            v26 = [NSString alloc];
            diag = [v10 summary];
            totalDequeuedClientRequests = [v26 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", unlockCopy, diag];
            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:unlockCopy withDescription:totalDequeuedClientRequests];
          }

          goto LABEL_17;
        }

        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:v10];
        if (!autoControlManagerFSM2)
        {
          v27 = [NSString alloc];
          diag = [v10 summary];
          totalDequeuedClientRequests = [v27 initWithFormat:@"{%@} | invalid eventInfo (instance:MISSING) | eventInfo:%@", unlockCopy, diag];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v10 withErrorCode:6102 fromAction:unlockCopy withDescription:totalDequeuedClientRequests];
LABEL_17:

          goto LABEL_21;
        }

        clientRequest3 = [v10 clientRequest];
        v20 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest3];
        clientAssetSelector = [autoControlManagerFSM2 clientAssetSelector];
        v22 = [(MADAutoAssetControlManager *)self _messageBlockedUntilFirstUnlock:v20 forAssetSelector:clientAssetSelector];

        if (!v22)
        {
          [v44 addObject:v10];
          diag = [(MADAutoAssetControlManager *)self statistics];
          totalDequeuedClientRequests2 = [diag totalDequeuedClientRequests];
          clientRequest4 = [v10 clientRequest];
          [(MADAutoAssetControlManager *)self _statsIncrement:totalDequeuedClientRequests2 forClientRequest:clientRequest4];
          goto LABEL_19;
        }

        clientRequestsAwaitingFirstUnlock = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
        [clientRequestsAwaitingFirstUnlock addObject:v10];

        diag = _MADLog(@"AutoControl");
        if (os_log_type_enabled(diag, OS_LOG_TYPE_DEFAULT))
        {
          totalDequeuedClientRequests2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          clientRequest4 = [v10 summary];
          *buf = 138543874;
          v60 = totalDequeuedClientRequests2;
          v61 = 2114;
          v62 = unlockCopy;
          v63 = 2114;
          v64 = clientRequest4;
          _os_log_impl(&dword_0, diag, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | moved client-request to awaiting first-unlock | jobParam:%{public}@", buf, 0x20u);
LABEL_19:
        }

        clientRequestsAwaitingSync = v43;
LABEL_21:

        objc_autoreleasePoolPop(v11);
      }

      v47 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v54 objects:v65 count:16];
    }

    while (v47);
  }

  v49 = unlockCopy;

  v28 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingSync:v28];

  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  obja = v44;
  v29 = [obja countByEnumeratingWithState:&v50 objects:v58 count:16];
  if (v29)
  {
    v30 = v29;
    v31 = *v51;
    v32 = @"AutoControl";
    do
    {
      for (j = 0; j != v30; j = j + 1)
      {
        if (*v51 != v31)
        {
          objc_enumerationMutation(obja);
        }

        v34 = *(*(&v50 + 1) + 8 * j);
        v35 = objc_autoreleasePoolPush();
        [v34 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v36 = _MADLog(v32);
        if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
        {
          [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v37 = v48 = v35;
          [v34 summary];
          v38 = v32;
          selfCopy = self;
          v41 = v40 = v31;
          *buf = 138543874;
          v60 = v37;
          v61 = 2114;
          v62 = v49;
          v63 = 2114;
          v64 = v41;
          _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request | jobParam:%{public}@", buf, 0x20u);

          v31 = v40;
          self = selfCopy;
          v32 = v38;

          v35 = v48;
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v34 fromLocation:v49];
        objc_autoreleasePoolPop(v35);
      }

      v30 = [obja countByEnumeratingWithState:&v50 objects:v58 count:16];
    }

    while (v30);
  }
}

- (void)clientRequestsAwaitingDispatchAll:(id)all
{
  allCopy = all;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:clientRequestsAwaitingDispatchAll", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &state);

  allCopy = [[NSString alloc] initWithFormat:@"%@:clientRequestsAwaitingDispatchAll", allCopy];
  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    buf = 138543618;
    v54 = _updateLatestSummary;
    v55 = 2114;
    v56 = allCopy;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | scheduling all queued client requests", &buf, 0x16u);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:allCopy ofContainer:@"clientRequestsAwaitingSync"];
  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
  v11 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v47 objects:v59 count:16];
  if (v11)
  {
    v40 = *v48;
    obj = clientRequestsAwaitingSync;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v48 != v40)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v47 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        [v13 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary = [v13 summary];
          buf = 138543874;
          v54 = _updateLatestSummary2;
          v55 = 2114;
          v56 = allCopy;
          v57 = 2114;
          v58 = summary;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request | jobParam:%{public}@", &buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v13 fromLocation:allCopy];
        statistics = [(MADAutoAssetControlManager *)self statistics];
        totalDequeuedClientRequests = [statistics totalDequeuedClientRequests];
        clientRequest = [v13 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:totalDequeuedClientRequests forClientRequest:clientRequest];

        objc_autoreleasePoolPop(v14);
      }

      clientRequestsAwaitingSync = obj;
      v11 = [obj countByEnumeratingWithState:&v47 objects:v59 count:16];
    }

    while (v11);
  }

  v21 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingSync:v21];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:allCopy ofContainer:@"clientRequestsAwaitingFirstUnlock"];
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  clientRequestsAwaitingFirstUnlock = [(MADAutoAssetControlManager *)self clientRequestsAwaitingFirstUnlock];
  v23 = [clientRequestsAwaitingFirstUnlock countByEnumeratingWithState:&v43 objects:v52 count:16];
  if (v23)
  {
    v41 = *v44;
    obja = clientRequestsAwaitingFirstUnlock;
    do
    {
      for (j = 0; j != v23; j = j + 1)
      {
        if (*v44 != v41)
        {
          objc_enumerationMutation(obja);
        }

        v25 = *(*(&v43 + 1) + 8 * j);
        v26 = objc_autoreleasePoolPush();
        [v25 clientVoucher];
        objc_claimAutoreleasedReturnValue();
        voucher_adopt();
        v42 = 0;
        clientRequest2 = [v25 clientRequest];
        v28 = [(MADAutoAssetControlManager *)self clientRequestTimeoutSecs:clientRequest2 timeoutWasSpecified:&v42];

        if (v28 == -2 || (v42 & 1) == 0)
        {
          clientRequest3 = [v25 clientRequest];
          [(MADAutoAssetControlManager *)self timerStopForClientRequest:clientRequest3 fromLocation:allCopy];
        }

        v30 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary2 = [v25 summary];
          buf = 138543874;
          v54 = _updateLatestSummary3;
          v55 = 2114;
          v56 = allCopy;
          v57 = 2114;
          v58 = summary2;
          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [PREVIOUSLY_QUEUED] | [schedule and] route client-request that had been awaiting first-unlock | jobParam:%{public}@", &buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)self _scheduledAndRouteClientRequest:v25 fromLocation:allCopy];
        statistics2 = [(MADAutoAssetControlManager *)self statistics];
        totalDequeuedClientRequests2 = [statistics2 totalDequeuedClientRequests];
        clientRequest4 = [v25 clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:totalDequeuedClientRequests2 forClientRequest:clientRequest4];

        objc_autoreleasePoolPop(v26);
      }

      clientRequestsAwaitingFirstUnlock = obja;
      v23 = [obja countByEnumeratingWithState:&v43 objects:v52 count:16];
    }

    while (v23);
  }

  v36 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setClientRequestsAwaitingFirstUnlock:v36];

  os_activity_scope_leave(&state);
}

- (const)osTransactionNameAutoJob:(id)job forJobUUID:(id)d
{
  dCopy = d;
  jobCopy = job;
  dCopy = [[NSString alloc] initWithFormat:@"%@-%@", jobCopy, dCopy];

  v8 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v12 = dCopy;
    _os_log_impl(&dword_0, v8, OS_LOG_TYPE_DEFAULT, "[OS-TRANSACTION-JOB] [BEGIN] %{public}@", buf, 0xCu);
  }

  uTF8String = [dCopy UTF8String];
  return uTF8String;
}

- (void)addToCurrentJobs:(id)jobs usingSelector:(id)selector withJobUUID:(id)d triggeredByClientMessage:(id)message downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor usingSetDescriptor:(id)setDescriptor fromLocation:(id)self0
{
  jobsCopy = jobs;
  selectorCopy = selector;
  dCopy = d;
  messageCopy = message;
  descriptorCopy = descriptor;
  patchDescriptorCopy = patchDescriptor;
  setDescriptorCopy = setDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (![jobsCopy autoAssetSetJob])
  {
    v32 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:messageCopy];
    clientAssetPolicy = [v32 clientAssetPolicy];
    [(MADAutoAssetControlManager *)self initialStatusForJob:jobsCopy usingSelector:selectorCopy withJobUUID:dCopy downloadingDescriptor:descriptorCopy baseForPatchDescriptor:patchDescriptorCopy withClientAssetPolicy:clientAssetPolicy];

    currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
    v49 = selectorCopy;
    v35 = [(MADAutoAssetControlManager *)self jobSelectorKey:selectorCopy];
    [currentJobsBySelector setSafeObject:jobsCopy forKey:v35];

    currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    [currentJobsByUUID setSafeObject:jobsCopy forKey:dCopy];

    v37 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
LABEL_25:

      selectorCopy = v49;
LABEL_37:
      v42 = setDescriptorCopy;
      goto LABEL_38;
    }

    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [v49 summary];
    summary2 = [jobsCopy summary];
    if (messageCopy)
    {
      messageName = [messageCopy messageName];
      if (descriptorCopy)
      {
        goto LABEL_12;
      }
    }

    else
    {
      messageName = @"SCHEDULED | RESUMED";
      if (descriptorCopy)
      {
LABEL_12:
        summary3 = [descriptorCopy summary];
        if (patchDescriptorCopy)
        {
LABEL_13:
          summary4 = [patchDescriptorCopy summary];
LABEL_18:
          *buf = 138544898;
          v52 = _updateLatestSummary;
          v53 = 2114;
          v54 = summary;
          v55 = 2114;
          v56 = summary2;
          v57 = 2114;
          v58 = dCopy;
          v59 = 2114;
          v60 = messageName;
          v61 = 2114;
          v62 = summary3;
          v63 = 2114;
          v64 = summary4;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@] {addToCurrentJobs} currentJobsBySelector[%{public}@] | autoJob:%{public}@ | JobUUID:%{public}@ | message:%{public}@ | downloadingDescriptor:%{public}@ | baseForPatchDescriptor:%{public}@", buf, 0x48u);
          if (patchDescriptorCopy)
          {
          }

          if (descriptorCopy)
          {
          }

          if (messageCopy)
          {
          }

          goto LABEL_25;
        }

LABEL_17:
        summary4 = @"N";
        goto LABEL_18;
      }
    }

    summary3 = @"N";
    if (patchDescriptorCopy)
    {
      goto LABEL_13;
    }

    goto LABEL_17;
  }

  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    clientDomainName = [jobsCopy clientDomainName];
    autoAssetSetIdentifier = [jobsCopy autoAssetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:clientDomainName forAssetSetIdentifier:autoAssetSetIdentifier];

    if (v26)
    {
      v27 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
LABEL_36:

        goto LABEL_37;
      }

      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v48 = selectorCopy;
      summary5 = [selectorCopy summary];
      summary6 = [jobsCopy summary];
      if (messageCopy)
      {
        messageName2 = [messageCopy messageName];
        if (descriptorCopy)
        {
          goto LABEL_7;
        }
      }

      else
      {
        messageName2 = @"SCHEDULED | RESUMED";
        if (descriptorCopy)
        {
LABEL_7:
          summary7 = [descriptorCopy summary];
          if (patchDescriptorCopy)
          {
LABEL_8:
            summary8 = [patchDescriptorCopy summary];
LABEL_29:
            *buf = 138544898;
            v52 = _updateLatestSummary2;
            v53 = 2114;
            v54 = summary5;
            v55 = 2114;
            v56 = summary6;
            v57 = 2114;
            v58 = dCopy;
            v59 = 2114;
            v60 = messageName2;
            v61 = 2114;
            v62 = summary7;
            v63 = 2114;
            v64 = summary8;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {addToCurrentJobs} Invariant violation, suspended sets should be handled before this point | selector:%{public}@ | autoJob:%{public}@ | JobUUID:%{public}@ | message:%{public}@ | downloadingDescriptor:%{public}@ | baseForPatchDescriptor:%{public}@", buf, 0x48u);
            if (patchDescriptorCopy)
            {
            }

            if (descriptorCopy)
            {
            }

            if (messageCopy)
            {
            }

            selectorCopy = v48;
            goto LABEL_36;
          }

LABEL_28:
          summary8 = @"N";
          goto LABEL_29;
        }
      }

      summary7 = @"N";
      if (patchDescriptorCopy)
      {
        goto LABEL_8;
      }

      goto LABEL_28;
    }
  }

  v41 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:messageCopy];
  v42 = setDescriptorCopy;
  [(MADAutoAssetControlManager *)self initialStatusForSetJob:jobsCopy withJobUUID:dCopy usingSetDescriptor:setDescriptorCopy usingSetPolicy:v41];

LABEL_38:
}

- (void)removeCurrentJob:(id)job schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure fromLocation:(id)location
{
  failureCopy = failure;
  involvedCopy = involved;
  jobCopy = job;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:removeCurrentJob", locationCopy];
  autoAssetJobID = [jobCopy autoAssetJobID];
  autoAssetSelector = [jobCopy autoAssetSelector];
  assetVersion = [autoAssetSelector assetVersion];
  if (assetVersion)
  {
    autoAssetSelector2 = [jobCopy autoAssetSelector];
  }

  else
  {
    autoAssetSelector2 = 0;
  }

  autoAssetSelector3 = [jobCopy autoAssetSelector];
  assetVersion2 = [autoAssetSelector3 assetVersion];
  v188 = locationCopy;
  v186 = involvedCopy;
  if (assetVersion2)
  {
    autoAssetSelector4 = 0;
  }

  else
  {
    autoAssetSelector4 = [jobCopy autoAssetSelector];
  }

  autoAssetUUID = [jobCopy autoAssetUUID];
  fromAutoAssetJob = [jobCopy fromAutoAssetJob];
  clientDomainName = [fromAutoAssetJob clientDomainName];

  fromAutoAssetJob2 = [jobCopy fromAutoAssetJob];
  autoAssetSetIdentifier = [fromAutoAssetJob2 autoAssetSetIdentifier];

  if (!autoAssetSelector4 && autoAssetSelector2)
  {
    v24 = [MAAutoAssetSelector alloc];
    assetType = [autoAssetSelector2 assetType];
    assetSpecifier = [autoAssetSelector2 assetSpecifier];
    autoAssetSelector4 = [v24 initForAssetType:assetType withAssetSpecifier:assetSpecifier];
  }

  fromAutoAssetJob3 = [jobCopy fromAutoAssetJob];
  selfCopy = self;
  v187 = jobCopy;
  if (fromAutoAssetJob3)
  {
    v28 = fromAutoAssetJob3;
    fromAutoAssetJob4 = [jobCopy fromAutoAssetJob];
    autoAssetSetJob = [fromAutoAssetJob4 autoAssetSetJob];

    if (autoAssetSetJob)
    {
      [(MADAutoAssetControlManager *)self removeCurrentSetJob:jobCopy schedulerInvolved:v186 potentialNetworkFailure:failureCopy fromLocation:locationCopy historyOperation:332];
      goto LABEL_50;
    }
  }

  if (!autoAssetJobID)
  {
    autoAssetJobID = [jobCopy autoAssetUUID];
  }

  v184 = locationCopy;
  v31 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:locationCopy notFoundCode:0 notFoundReason:0];
  v32 = [(MADAutoAssetControlManager *)self currentJobBySelector:autoAssetSelector2];
  if (v32)
  {
    v33 = autoAssetUUID;
LABEL_18:
    v35 = autoAssetJobID;
    v36 = v32;
    autoAssetSelector5 = [jobCopy autoAssetSelector];
    assetVersion3 = [autoAssetSelector5 assetVersion];

    autoAssetSelector6 = [jobCopy autoAssetSelector];
    if (assetVersion3)
    {
      v40 = autoAssetSelector2;
    }

    else
    {
      v40 = autoAssetSelector4;
    }

    if (!assetVersion3)
    {
      autoAssetSelector4 = autoAssetSelector6;
    }

    v189 = autoAssetSelector4;
    if (assetVersion3)
    {
      autoAssetSelector2 = autoAssetSelector6;
    }

    v41 = 0;
    v42 = v31;
    v43 = v31 == 0;
    v44 = v36;
    autoAssetJobID = v35;
    goto LABEL_26;
  }

  selfCopy2 = self;
  v33 = autoAssetUUID;
  v32 = [(MADAutoAssetControlManager *)selfCopy2 currentJobBySelector:autoAssetSelector4];
  if (v32)
  {
    goto LABEL_18;
  }

  v189 = autoAssetSelector4;
  v42 = v31;
  if (!v31)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v95 = [NSString alloc];
    summary = [jobCopy summary];
    v97 = [v95 initWithFormat:@"{%@} | job finished that was not tracked by UUID or by selector from eventInfo:%@", v184, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v97 withResult:6110 withError:0];

    v45 = 0;
    autoAssetUUID = v33;
    self = selfCopy;
    locationCopy = v184;

    goto LABEL_48;
  }

  v43 = 0;
  v44 = 0;
  v41 = 1;
LABEL_26:
  if ([v42 clientRequestCount] > 0 || objc_msgSend(v44, "clientRequestCount") >= 1)
  {
    autoAssetUUID = v33;
    v45 = v31;
    self = selfCopy;
    locationCopy = v184;
    if (v186)
    {
      if (v43)
      {
        if (v41)
        {
          goto LABEL_44;
        }

        [v44 setEarlierSchedulerInvolved:1];
        if (!failureCopy)
        {
          goto LABEL_44;
        }

        goto LABEL_36;
      }

      [v45 setEarlierSchedulerInvolved:1];
      if (!failureCopy)
      {
        if ((v41 & 1) == 0)
        {
          [v44 setEarlierSchedulerInvolved:1];
        }

        goto LABEL_44;
      }

      [v45 setEarlierPotentialNetworkFailure:1];
      if ((v41 & 1) == 0)
      {
        [v44 setEarlierSchedulerInvolved:1];
LABEL_36:
        [v44 setEarlierPotentialNetworkFailure:1];
      }
    }

LABEL_44:
    v46 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
    {
      [jobCopy summary];
      v48 = v47 = v44;
      *buf = 138543618;
      v201 = v184;
      v202 = 2114;
      v203 = v48;
      _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {%{public}@} auto-asset-job indicated removal but has more to do | eventInfo:%{public}@", buf, 0x16u);

      v44 = v47;
    }

    goto LABEL_47;
  }

  autoAssetUUID = v33;
  v45 = v31;
  if (!v31 || ![v31 autoAssetSetJob])
  {
    autoAssetSelector7 = [jobCopy autoAssetSelector];
    v177 = objc_alloc_init(NSMutableString);
    self = selfCopy;
    if (autoAssetSelector7)
    {
      v175 = autoAssetSelector7;
    }

    else
    {
      autoAssetSelector8 = [v31 autoAssetSelector];
      v99 = [(MADAutoAssetControlManager *)selfCopy currentJobBySelector:autoAssetSelector8];

      if (v99)
      {
        assetVersion4 = [autoAssetSelector8 assetVersion];

        v101 = autoAssetSelector8;
        v102 = v189;
        if (assetVersion4)
        {
          v103 = autoAssetSelector2;
        }

        else
        {
          v103 = v189;
        }

        if (!assetVersion4)
        {
          v102 = v101;
        }

        v189 = v102;
        v175 = v101;
        if (assetVersion4)
        {
          autoAssetSelector2 = v101;
        }

        v44 = v99;
      }

      else
      {
        v175 = autoAssetSelector8;
        v44 = 0;
      }

      v45 = v31;
    }

    autoAssetStatus = [jobCopy autoAssetStatus];

    v178 = v44;
    v105 = v184;
    v176 = v45;
    if (autoAssetStatus)
    {
      autoAssetStatus2 = [jobCopy autoAssetStatus];
      if (autoAssetSelector2)
      {
        assetVersion5 = [autoAssetSelector2 assetVersion];
        v184 = [[NSString alloc] initWithFormat:@"%@(with-version)", v184];
        [(MADAutoAssetControlManager *)selfCopy updateAutoAssetStatus:autoAssetSelector2 forActiveJobUUID:autoAssetJobID withLatestJobStatus:autoAssetStatus2 matchingAssetVersion:assetVersion5 fromLocation:v184];

        v44 = v178;
      }

      else
      {
        assetVersion5 = [[NSString alloc] initWithFormat:@"%@(without-version)", v184];
        [(MADAutoAssetControlManager *)selfCopy updateAutoAssetStatus:v189 forActiveJobUUID:autoAssetJobID withLatestJobStatus:autoAssetStatus2 matchingAssetVersion:0 fromLocation:assetVersion5];
      }

      v45 = v176;
    }

    if (v43)
    {
      [v177 appendString:@" | bySelector"];
    }

    else
    {
      stagerCurrentJob = [(MADAutoAssetControlManager *)selfCopy stagerCurrentJob];
      if (stagerCurrentJob && (v110 = stagerCurrentJob, [(MADAutoAssetControlManager *)selfCopy stagerCurrentJobUUID], v111 = objc_claimAutoreleasedReturnValue(), v112 = [SUCore stringIsEqual:autoAssetJobID to:v111], v111, v45 = v176, v110, v112))
      {
        [v177 appendString:@" | stager-current-job"];
      }

      else
      {
        currentJobsByUUID = [(MADAutoAssetControlManager *)selfCopy currentJobsByUUID];
        [currentJobsByUUID removeObjectForKey:autoAssetJobID];

        [v177 appendFormat:@" | autoAssetJobUUID:%@", autoAssetJobID];
      }

      v44 = v178;
    }

    if (v44)
    {
      v114 = [(MADAutoAssetControlManager *)selfCopy jobSelectorKey:v175];
      if (v114)
      {
        currentJobsBySelector = [(MADAutoAssetControlManager *)selfCopy currentJobsBySelector];
        [currentJobsBySelector removeObjectForKey:v114];

        if (v43)
        {
          summary2 = [v178 summary];
          [v177 appendFormat:@" | autoJobBySelector:%@ | job:%@", v114, summary2];
        }

        else
        {
          [v177 appendFormat:@" | autoJobBySelector:%@", v114];
        }

        v44 = v178;
      }

      else
      {
        [v177 appendString:@" | nil-jobSelectorKey"];
      }

      autoAssetSelector13 = v189;
      if (v45)
      {
        summary3 = [v44 summary];
        [v177 appendFormat:@"job:%@", summary3];
      }
    }

    else
    {
      [v177 appendString:@" | byUUID"];
      autoAssetSelector13 = v189;
    }

    if (!autoAssetSelector2)
    {
      autoAssetSelector9 = [v45 autoAssetSelector];
      assetVersion6 = [autoAssetSelector9 assetVersion];

      if (assetVersion6)
      {
        autoAssetSelector2 = [v45 autoAssetSelector];
      }

      else
      {
        autoAssetSelector2 = 0;
      }

      v44 = v178;
    }

    if (!autoAssetSelector13)
    {
      autoAssetSelector10 = [v45 autoAssetSelector];

      if (autoAssetSelector10)
      {
        autoAssetSelector11 = [v45 autoAssetSelector];
        assetVersion7 = [autoAssetSelector11 assetVersion];

        if (assetVersion7)
        {
          v124 = [MAAutoAssetSelector alloc];
          autoAssetSelector12 = [v45 autoAssetSelector];
          [autoAssetSelector12 assetType];
          v126 = v125 = v45;
          [v125 autoAssetSelector];
          v128 = v127 = autoAssetUUID;
          [v128 assetSpecifier];
          v130 = v129 = autoAssetJobID;
          autoAssetSelector13 = [v124 initForAssetType:v126 withAssetSpecifier:v130];

          autoAssetJobID = v129;
          autoAssetUUID = v127;
          v105 = v184;
          self = selfCopy;

          v45 = v125;
        }

        else
        {
          autoAssetSelector13 = [v45 autoAssetSelector];
        }

        v44 = v178;
      }

      else
      {
        autoAssetSelector13 = 0;
      }
    }

    v192 = autoAssetSelector13;
    [(MADAutoAssetControlManager *)self removeActiveJobForFullSelector:v105 removingFullSelector:autoAssetSelector2 alsoRemovingNoVersionSelector:autoAssetSelector13];
    if (autoAssetSelector2)
    {
      activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      persistedEntryID = [autoAssetSelector2 persistedEntryID];
      v133 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

      v134 = 0;
      if (autoAssetJobID && v133)
      {
        activeJobsByUUID = [v133 activeJobsByUUID];
        v136 = [activeJobsByUUID safeObjectForKey:autoAssetJobID ofClass:objc_opt_class()];

        v44 = v178;
        if (v136)
        {
          if ([SUCore stringIsEqual:v136 to:autoAssetJobID])
          {
            activeJobsByUUID2 = [v133 activeJobsByUUID];
            [activeJobsByUUID2 removeObjectForKey:v136];

            v134 = 1;
LABEL_144:

            v45 = v176;
            goto LABEL_145;
          }
        }

        else
        {
          v138 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v138, OS_LOG_TYPE_DEFAULT))
          {
            [autoAssetSelector2 summary];
            v140 = v139 = autoAssetUUID;
            summary4 = [v133 summary];
            *buf = 138544130;
            v201 = v184;
            v202 = 2114;
            v203 = v140;
            v204 = 2114;
            v205 = autoAssetJobID;
            v206 = 2114;
            v207 = summary4;
            _os_log_impl(&dword_0, v138, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{%{public}@} no active job withVersionSelector:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x2Au);

            v44 = v178;
            autoAssetUUID = v139;
            self = selfCopy;
          }
        }

        v134 = 0;
        goto LABEL_144;
      }

      v44 = v178;
    }

    else
    {
      v133 = 0;
      v134 = 0;
    }

LABEL_145:
    if (!v192 || v134)
    {
LABEL_159:
      if (!autoAssetJobID || v134)
      {
        if (v134)
        {
LABEL_178:
          [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:v133];
          autoAssetSelector4 = v192;
          goto LABEL_187;
        }

LABEL_172:
        v162 = failureCopy;
        v163 = v186;
        if (v45)
        {
          v163 = [v45 earlierSchedulerInvolved] | v186;
          v162 = [v45 earlierPotentialNetworkFailure] | failureCopy;
        }

        v44 = v178;
        if (v178)
        {
          obja = v162;
          v164 = v163 | [v178 earlierSchedulerInvolved];
          earlierPotentialNetworkFailure = [v178 earlierPotentialNetworkFailure];
          autoAssetSelector4 = v192;
          if (v164)
          {
            v162 = obja | earlierPotentialNetworkFailure;
            v44 = v178;
LABEL_180:
            if (v162)
            {
              v167 = v162;
              v168 = [MAAutoAssetError buildError:6401 fromOperation:v184 underlyingError:0 withDescription:@"auto-asset-scheduler involved job finished with potential network-connectivity failure"];
              autoAssetSelector14 = [jobCopy autoAssetSelector];
              autoAssetSelector4 = v192;
              [MADAutoAssetHistory recordFailedOperation:504 fromLayer:1 forAssetID:@"UNKNOWN" withSelector:autoAssetSelector14 failingWithError:v168];

              v45 = v176;
              v162 = v167;
              v44 = v178;
            }

            if (autoAssetSelector4)
            {
              v170 = autoAssetSelector4;
            }

            else
            {
              v170 = autoAssetSelector2;
            }

            [MADAutoAssetScheduler jobFinishedForSelector:v170 withPotentialNetworkFailure:v162];
            goto LABEL_187;
          }

          v44 = v178;
        }

        else
        {
          autoAssetSelector4 = v192;
          if (v163)
          {
            goto LABEL_180;
          }
        }

LABEL_187:
        statistics = [(MADAutoAssetControlManager *)self statistics];
        v172 = statistics;
        if (v186)
        {
          if (failureCopy)
          {
            [statistics setFinishedJobSchedulerNetworkFailure:{objc_msgSend(statistics, "finishedJobSchedulerNetworkFailure") + 1}];
          }

          else
          {
            [statistics setFinishedJobSchedulerNotNetworkRelated:{objc_msgSend(statistics, "finishedJobSchedulerNotNetworkRelated") + 1}];
          }
        }

        else if (failureCopy)
        {
          [statistics setFinishedJobClientNetworkFailure:{objc_msgSend(statistics, "finishedJobClientNetworkFailure") + 1}];
        }

        else
        {
          [statistics setFinishedJobClientNotNetworkRelated:{objc_msgSend(statistics, "finishedJobClientNotNetworkRelated") + 1}];
        }

        v173 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v173, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543874;
          v201 = _updateLatestSummary;
          v202 = 2114;
          v203 = v184;
          v204 = 2114;
          v205 = v177;
          _os_log_impl(&dword_0, v173, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} removed auto-asset-job from tracking | removals:%{public}@", buf, 0x20u);

          v44 = v178;
        }

        locationCopy = v184;
        goto LABEL_49;
      }

LABEL_161:
      v180 = autoAssetUUID;
      v183 = autoAssetJobID;
      v198 = 0u;
      v199 = 0u;
      v196 = 0u;
      v197 = 0u;
      obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
      v152 = [obj countByEnumeratingWithState:&v196 objects:v210 count:16];
      if (v152)
      {
        v153 = v152;
        v154 = *v197;
        while (2)
        {
          v155 = 0;
          v156 = v133;
          do
          {
            if (*v197 != v154)
            {
              objc_enumerationMutation(obj);
            }

            v157 = *(*(&v196 + 1) + 8 * v155);
            v158 = objc_autoreleasePoolPush();
            activelyEliminatingSelectors2 = [(MADAutoAssetControlManager *)selfCopy activelyEliminatingSelectors];
            v133 = [activelyEliminatingSelectors2 safeObjectForKey:v157 ofClass:objc_opt_class()];

            if (v133)
            {
              activeJobsByUUID3 = [v133 activeJobsByUUID];
              v161 = [activeJobsByUUID3 safeObjectForKey:v183 ofClass:objc_opt_class()];

              if (v161)
              {
                activeJobsByUUID4 = [v133 activeJobsByUUID];
                [activeJobsByUUID4 removeObjectForKey:v161];

                objc_autoreleasePoolPop(v158);
                autoAssetJobID = v183;
                autoAssetUUID = v180;
                v45 = v176;
                v44 = v178;
                self = selfCopy;
                goto LABEL_178;
              }
            }

            objc_autoreleasePoolPop(v158);
            v155 = v155 + 1;
            v156 = v133;
          }

          while (v153 != v155);
          v153 = [obj countByEnumeratingWithState:&v196 objects:v210 count:16];
          if (v153)
          {
            continue;
          }

          break;
        }
      }

      autoAssetJobID = v183;
      autoAssetUUID = v180;
      v45 = v176;
      self = selfCopy;
      goto LABEL_172;
    }

    v142 = v133;
    activelyEliminatingSelectors3 = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    persistedEntryID2 = [v192 persistedEntryID];
    v133 = [activelyEliminatingSelectors3 safeObjectForKey:persistedEntryID2 ofClass:objc_opt_class()];

    if (!autoAssetJobID || !v133)
    {
      if (!autoAssetJobID)
      {
        goto LABEL_172;
      }

      goto LABEL_161;
    }

    activeJobsByUUID5 = [v133 activeJobsByUUID];
    v146 = [activeJobsByUUID5 safeObjectForKey:autoAssetJobID ofClass:objc_opt_class()];

    v134 = v146 != 0;
    v44 = v178;
    if (v146)
    {
      if (![SUCore stringIsEqual:v146 to:autoAssetJobID])
      {
        v134 = 0;
        goto LABEL_158;
      }

      activeJobsByUUID6 = [v133 activeJobsByUUID];
      [activeJobsByUUID6 removeObjectForKey:v146];
    }

    else
    {
      activeJobsByUUID6 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(activeJobsByUUID6, OS_LOG_TYPE_DEFAULT))
      {
        [v192 summary];
        v148 = autoAssetUUID;
        v150 = v149 = autoAssetJobID;
        summary5 = [v133 summary];
        *buf = 138544130;
        v201 = v184;
        v202 = 2114;
        v203 = v150;
        v204 = 2114;
        v205 = v149;
        v206 = 2114;
        v207 = summary5;
        _os_log_impl(&dword_0, activeJobsByUUID6, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE]{%{public}@} no active job withoutVersionSelector:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x2Au);

        v44 = v178;
        autoAssetJobID = v149;
        autoAssetUUID = v148;
        self = selfCopy;
      }
    }

LABEL_158:
    v45 = v176;
    goto LABEL_159;
  }

  self = selfCopy;
  locationCopy = v184;
  [(MADAutoAssetControlManager *)selfCopy removeCurrentSetJob:jobCopy schedulerInvolved:v186 potentialNetworkFailure:failureCopy fromLocation:v184 historyOperation:333];
LABEL_47:

LABEL_48:
  autoAssetSelector4 = v189;
LABEL_49:

LABEL_50:
  v49 = locationCopy;
  if (autoAssetJobID)
  {
    v50 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:locationCopy notFoundCode:0 notFoundReason:0];
    if (v50)
    {
      currentJobsByUUID2 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
      [currentJobsByUUID2 removeObjectForKey:autoAssetJobID];

      v52 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v53 = autoAssetSelector4;
        v55 = v54 = autoAssetUUID;
        summary6 = [v50 summary];
        *buf = 138544130;
        v201 = v55;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = autoAssetJobID;
        v206 = 2114;
        v207 = summary6;
        _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsByUUID | autoAssetJobUUID:%{public}@ | autoJobByUUID:%{public}@", buf, 0x2Au);

        autoAssetUUID = v54;
        autoAssetSelector4 = v53;
        locationCopy = v49;
        self = selfCopy;
      }
    }
  }

  if (autoAssetUUID)
  {
    v57 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID fromLocation:locationCopy notFoundCode:0 notFoundReason:0];
    if (v57)
    {
      currentJobsByUUID3 = [(MADAutoAssetControlManager *)self currentJobsByUUID];
      [currentJobsByUUID3 removeObjectForKey:autoAssetUUID];

      v59 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v60 = autoAssetSelector4;
        v62 = v61 = autoAssetUUID;
        summary7 = [v57 summary];
        *buf = 138544130;
        v201 = v62;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v61;
        v206 = 2114;
        v207 = summary7;
        _os_log_impl(&dword_0, v59, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsByUUID | secondaryAutoAssetUUID:%{public}@ | autoJobByUUID:%{public}@", buf, 0x2Au);

        autoAssetUUID = v61;
        autoAssetSelector4 = v60;
        locationCopy = v49;
        self = selfCopy;
      }
    }
  }

  if (autoAssetSelector2)
  {
    v64 = [(MADAutoAssetControlManager *)self currentJobBySelector:autoAssetSelector2];
    if (v64)
    {
      v65 = autoAssetSelector4;
      currentJobsBySelector2 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      v67 = [(MADAutoAssetControlManager *)self jobSelectorKey:autoAssetSelector2];
      [currentJobsBySelector2 removeObjectForKey:v67];

      v68 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v69 = v179 = autoAssetUUID;
        [autoAssetSelector2 summary];
        v71 = v70 = autoAssetJobID;
        summary8 = [v64 summary];
        *buf = 138544130;
        v201 = v69;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v71;
        v206 = 2114;
        v207 = summary8;
        _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsBySelector | withVersionSelector:%{public}@ | autoJobBySelector:%{public}@", buf, 0x2Au);

        autoAssetJobID = v70;
        autoAssetUUID = v179;
        self = selfCopy;
      }

      autoAssetSelector4 = v65;
      locationCopy = v49;
    }
  }

  if (autoAssetSelector4)
  {
    v73 = [(MADAutoAssetControlManager *)self currentJobBySelector:autoAssetSelector4];
    if (v73)
    {
      currentJobsBySelector3 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      v75 = autoAssetSelector4;
      v76 = [(MADAutoAssetControlManager *)self jobSelectorKey:autoAssetSelector4];
      [currentJobsBySelector3 removeObjectForKey:v76];

      v77 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v77, OS_LOG_TYPE_DEFAULT))
      {
        [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v79 = v78 = autoAssetUUID;
        [v75 summary];
        v81 = v80 = autoAssetJobID;
        summary9 = [v73 summary];
        *buf = 138544130;
        v201 = v79;
        v202 = 2114;
        v203 = v49;
        v204 = 2114;
        v205 = v81;
        v206 = 2114;
        v207 = summary9;
        _os_log_impl(&dword_0, v77, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentJobsBySelector | withoutVersionSelector:%{public}@ | autoJobBySelector:%{public}@", buf, 0x2Au);

        autoAssetJobID = v80;
        autoAssetUUID = v78;
        self = selfCopy;
      }

      autoAssetSelector4 = v75;
      locationCopy = v49;
    }
  }

  v83 = clientDomainName;
  if (clientDomainName && autoAssetSetIdentifier)
  {
    v84 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName byIdentifier:autoAssetSetIdentifier];
    if (v84)
    {
      v85 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:autoAssetSetIdentifier];
      if (v85)
      {
        v190 = autoAssetSelector4;
        v86 = autoAssetUUID;
        v87 = autoAssetSelector2;
        currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
        [currentSetJobsByIdentifier removeObjectForKey:v85];

        v89 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v89, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary10 = [v84 summary];
          *buf = 138544386;
          v201 = _updateLatestSummary2;
          v202 = 2114;
          v203 = v49;
          v204 = 2114;
          v205 = clientDomainName;
          v206 = 2114;
          v207 = autoAssetSetIdentifier;
          v208 = 2114;
          v209 = summary10;
          _os_log_impl(&dword_0, v89, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[ROUTING-TABLE-REMOVE] removed from currentSetJobsByIdentifier | clientDomainName:%{public}@ | setJobIdentifier:%{public}@ | autoSetJob:%{public}@", buf, 0x34u);
        }

        autoAssetSelector2 = v87;
        autoAssetUUID = v86;
        autoAssetSelector4 = v190;
        locationCopy = v49;
      }
    }

    v83 = clientDomainName;
  }
}

- (void)removeCurrentSetJob:(id)job schedulerInvolved:(BOOL)involved potentialNetworkFailure:(BOOL)failure fromLocation:(id)location historyOperation:(int64_t)operation
{
  failureCopy = failure;
  involvedCopy = involved;
  jobCopy = job;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetJobID = [jobCopy autoAssetJobID];
  locationCopy = [[NSString alloc] initWithFormat:@"%@:removeCurrentSetJob", locationCopy];
  v16 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if (!autoAssetJobID)
  {
    autoAssetJobID = [jobCopy autoAssetUUID];
    if (autoAssetJobID)
    {
      autoAssetUUID = [jobCopy autoAssetUUID];
      [v16 appendFormat:@"alternate eventInfo.autoAssetUUID:%@|", autoAssetUUID];
    }

    else
    {
      [v16 appendString:@"eventInfo.autoAssetUUID:N|"];
    }
  }

  v136 = involvedCopy;
  fromAutoAssetJob = [jobCopy fromAutoAssetJob];
  clientDomainName = [fromAutoAssetJob clientDomainName];

  fromAutoAssetJob2 = [jobCopy fromAutoAssetJob];
  autoAssetSetIdentifier = [fromAutoAssetJob2 autoAssetSetIdentifier];

  setJobInformation = [jobCopy setJobInformation];
  setDescriptor = [setJobInformation setDescriptor];
  v22 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:locationCopy notFoundCode:0 notFoundReason:0];
  v23 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName byIdentifier:autoAssetSetIdentifier];
  v138 = clientDomainName;
  v24 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:clientDomainName byIdentifier:autoAssetSetIdentifier];
  v141 = v22;
  if (v22)
  {
    summary = [v22 summary];
    [v16 appendFormat:@"autoJobByUUID:%@|", summary];

    if (v23)
    {
LABEL_7:
      summary2 = [v23 summary];
      [v16 appendFormat:@"autoJobByIdentifier:%@|", summary2];

      goto LABEL_10;
    }
  }

  else
  {
    [v16 appendFormat:@"autoJobByUUID:%@|", @"N"];
    if (v23)
    {
      goto LABEL_7;
    }
  }

  [v16 appendFormat:@"autoJobByIdentifier:%@|", @"N"];
LABEL_10:
  if (v24)
  {
    summary3 = [v24 summary];
    [v16 appendFormat:@"cancelingSetJob:%@|", summary3];
  }

  else
  {
    [v16 appendFormat:@"cancelingSetJob:%@|", @"N"];
    if (!(v141 | v23))
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v30 = autoAssetSetIdentifier;
      v31 = [NSString alloc];
      [jobCopy summary];
      v33 = v32 = v16;
      v34 = [v31 initWithFormat:@"{%@} | job finished that was not tracked by UUID or by set-identifier | removalFlow:%@ | eventInfo:%@", locationCopy, v32, v33];
      [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v34 withResult:6110 withError:0];

      autoAssetSetIdentifier = v30;
      v16 = v32;

      v35 = v138;
      goto LABEL_30;
    }
  }

  v36 = v141;
  if ([v141 clientRequestCount] > 0 || objc_msgSend(v23, "clientRequestCount") > 0 || objc_msgSend(v24, "clientRequestCount") >= 1)
  {
    v37 = autoAssetSetIdentifier;
    [v16 appendFormat:@"clientRequestCount(autoJobByUUID:%ld, autoJobByIdentifier:%ld, cancelingSetJob:%ld)|", objc_msgSend(v141, "clientRequestCount"), objc_msgSend(v23, "clientRequestCount"), objc_msgSend(v24, "clientRequestCount")];
    if (v136)
    {
      [v16 appendString:@"schedulerInvolved|"];
      if (!v141)
      {
        if (!v23)
        {
          goto LABEL_27;
        }

        [v23 setEarlierSchedulerInvolved:1];
        if (!failureCopy)
        {
          goto LABEL_27;
        }

        goto LABEL_24;
      }

      [v141 setEarlierSchedulerInvolved:1];
      if (!failureCopy)
      {
        if (v23)
        {
          [v23 setEarlierSchedulerInvolved:1];
        }

        goto LABEL_27;
      }

      [v141 setEarlierPotentialNetworkFailure:1];
      if (v23)
      {
        [v23 setEarlierSchedulerInvolved:1];
LABEL_24:
        [v23 setEarlierPotentialNetworkFailure:1];
      }
    }

LABEL_27:
    v38 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
    {
      summary4 = [jobCopy summary];
      *buf = 138543874;
      v148 = locationCopy;
      v149 = 2114;
      v150 = v16;
      v151 = 2114;
      v152 = summary4;
      _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[MORE_CLIENT_REQUESTS] {%{public}@:removeCurrentSetJob} set-job indicated removal but has more to do | removalFlow:%{public}@ | eventInfo:%{public}@", buf, 0x20u);
    }

    v35 = v138;
    autoAssetSetIdentifier = v37;
    goto LABEL_30;
  }

  selfCopy = self;
  if (autoAssetSetIdentifier)
  {
    *&v131 = v24;
    *(&v131 + 1) = v23;
    v35 = v138;
LABEL_43:
    v44 = v36;
    if (v36)
    {
LABEL_44:
      v45 = @"byUUID autoSetJob(%@)|";
LABEL_51:
      v130 = v44;
      summary5 = [v44 summary];
      [v16 appendFormat:v45, summary5];

      if (autoAssetSetIdentifier)
      {
        setJobInformation2 = [jobCopy setJobInformation];
        currentSetStatus = [setJobInformation2 currentSetStatus];

        if (currentSetStatus)
        {
          clientRequest = [jobCopy clientRequest];
          responseMessage = [clientRequest responseMessage];
          v51 = [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:locationCopy forClientDomain:v35 forAssetSetIdentifier:autoAssetSetIdentifier forJobResponse:responseMessage withResponseError:0 clearingDownloadProgressReason:@"removing current set-job" withAssetSetStatus:0];

          [v16 appendString:@"updateAutoAssetSetStatus|"];
        }
      }

      [(MADAutoAssetControlManager *)self atomicInstanceRemovedSetJob:v130 removingForReason:locationCopy historyOperation:operation];
      if (autoAssetJobID && v141)
      {
        currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
        [currentJobsByUUID removeObjectForKey:autoAssetJobID];

        [v16 appendFormat:@"removed from currentJobsByUUID(%@)|", autoAssetJobID];
      }

      v53 = setDescriptor;
      v129 = autoAssetSetIdentifier;
      if (autoAssetSetIdentifier && v131 != 0)
      {
        v54 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:v35 forAssetSetIdentifier:autoAssetSetIdentifier];
        if (v54)
        {
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            [(MADAutoAssetControlManager *)self notifyCompletionCallbacksForSetJobKey:v54];
            [v16 appendFormat:@"SUSPEND_RESUME callbacks(%@)|", v54];
          }

          v125 = v54;
          if (*(&v131 + 1))
          {
            currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
            [currentSetJobsByIdentifier removeObjectForKey:v125];

            v54 = v125;
            [v16 appendFormat:@"removed from currentSetJobsByIdentifier(%@)|", v125];
          }

          if (v131)
          {
            v122 = jobCopy;
            v56 = locationCopy;
            v120 = autoAssetJobID;
            v121 = locationCopy;
            cancelingSetJobsByIdentifier = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
            v58 = v54;
            v59 = cancelingSetJobsByIdentifier;
            [cancelingSetJobsByIdentifier removeObjectForKey:v58];

            v144 = 0u;
            v145 = 0u;
            v142 = 0u;
            v143 = 0u;
            queuedRequestsForNewJobOnceCanceled = [v131 queuedRequestsForNewJobOnceCanceled];
            v61 = [queuedRequestsForNewJobOnceCanceled countByEnumeratingWithState:&v142 objects:v157 count:16];
            if (v61)
            {
              v62 = v61;
              v63 = *v143;
              do
              {
                for (i = 0; i != v62; i = i + 1)
                {
                  if (*v143 != v63)
                  {
                    objc_enumerationMutation(queuedRequestsForNewJobOnceCanceled);
                  }

                  v65 = *(*(&v142 + 1) + 8 * i);
                  v66 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v66, OS_LOG_TYPE_DEFAULT))
                  {
                    summary6 = [v65 summary];
                    *buf = 138543618;
                    v148 = v56;
                    v149 = 2114;
                    v150 = summary6;
                    _os_log_impl(&dword_0, v66, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] triggering client-request that had been waiting for set-job canceled | nextHadBeenQueued:%{public}@", buf, 0x16u);
                  }

                  autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
                  [autoControlManagerFSM3 postEvent:@"ClientRequest" withInfo:v65];
                }

                v62 = [queuedRequestsForNewJobOnceCanceled countByEnumeratingWithState:&v142 objects:v157 count:16];
              }

              while (v62);
            }

            [v131 setQueuedRequestsForNewJobOnceCanceled:0];
            v54 = v125;
            [v16 appendFormat:@"removed from cancelingSetJobsByIdentifier(%@)|", v125];
            locationCopy = v121;
            jobCopy = v122;
            autoAssetJobID = v120;
            locationCopy = v56;
            v35 = v138;
            v53 = setDescriptor;
            autoAssetSetIdentifier = v129;
            self = selfCopy;
          }
        }

        else
        {
          [v16 appendString:@"nil setJobKey|"];
        }
      }

      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByClientDomain:v35 forAssetSetIdentifier:autoAssetSetIdentifier fromLocation:locationCopy];
      discoveredAtomicInstance = [v53 discoveredAtomicInstance];

      if (discoveredAtomicInstance)
      {
        discoveredAtomicInstance2 = [v53 discoveredAtomicInstance];
        [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:discoveredAtomicInstance2];

        discoveredAtomicInstance3 = [v53 discoveredAtomicInstance];
        [v16 appendFormat:@"removed discovered(%@)|", discoveredAtomicInstance3];
      }

      latestDownloadedAtomicInstance = [v53 latestDownloadedAtomicInstance];
      if (latestDownloadedAtomicInstance)
      {
        v73 = latestDownloadedAtomicInstance;
        latestDownloadedAtomicInstance2 = [v53 latestDownloadedAtomicInstance];
        [v53 discoveredAtomicInstance];
        v76 = v75 = v16;
        v134 = [SUCore stringIsEqual:latestDownloadedAtomicInstance2 to:v76];

        v16 = v75;
        autoAssetSetIdentifier = v129;

        if ((v134 & 1) == 0)
        {
          latestDownloadedAtomicInstance3 = [v53 latestDownloadedAtomicInstance];
          [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorActiveJobByAtomicInstanceUUID:latestDownloadedAtomicInstance3];

          latestDownloadedAtomicInstance4 = [v53 latestDownloadedAtomicInstance];
          [v75 appendFormat:@"removed latest(%@)|", latestDownloadedAtomicInstance4];
        }
      }

      v135 = 0;
      if (autoAssetSetIdentifier && v35)
      {
        v79 = [[MAAutoAssetSelector alloc] initForAssetType:v35 withAssetSpecifier:autoAssetSetIdentifier];
        if (!v79)
        {
          v135 = 0;
          goto LABEL_100;
        }

        v80 = v79;
        v81 = autoAssetSetIdentifier;
        activelyEliminatingSelectors = [(MADAutoAssetControlManager *)selfCopy activelyEliminatingSelectors];
        v135 = v80;
        persistedEntryID = [v80 persistedEntryID];
        v84 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

        if (autoAssetJobID && v84)
        {
          activeJobsByUUID = [v84 activeJobsByUUID];
          v86 = [activeJobsByUUID safeObjectForKey:autoAssetJobID ofClass:objc_opt_class()];

          if (v86)
          {
            autoAssetSetIdentifier = v81;
            if ([SUCore stringIsEqual:v86 to:autoAssetJobID])
            {
              activeJobsByUUID2 = [v84 activeJobsByUUID];
              [activeJobsByUUID2 removeObjectForKey:v86];

              [v16 appendFormat:@"removed eliminatorTrackedJobUUID(%@)|", v86, v119];
            }

            else
            {
              [v16 appendFormat:@"eliminatorTrackedJobUUID(%@) != autoAssetJobUUID(%@)|", v86, autoAssetJobID];
            }
          }

          else
          {
            v89 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v89, OS_LOG_TYPE_DEFAULT))
            {
              summary7 = [v84 summary];
              *buf = 138544386;
              v148 = locationCopy;
              v149 = 2114;
              v150 = v138;
              v151 = 2114;
              v152 = v81;
              v153 = 2114;
              v154 = autoAssetJobID;
              v155 = 2114;
              v156 = summary7;
              _os_log_impl(&dword_0, v89, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@:removeCurrentSetJob} no active job for clientDomainName:%{public}@ | setJobIdentifier:%{public}@ | autoAssetJobUUID:%{public}@ | eliminateTracker:%{public}@", buf, 0x34u);
            }

            [v16 appendString:@"nil eliminatorTrackedJobUUID|"];
            autoAssetSetIdentifier = v81;
          }

          v88 = selfCopy;

          v35 = v138;
          goto LABEL_99;
        }

        autoAssetSetIdentifier = v81;
        v88 = selfCopy;
        if (v84)
        {
LABEL_99:
          [(MADAutoAssetControlManager *)v88 _eliminateCompleteIfAllDone:v84];
          summary8 = [v84 summary];
          [v16 appendFormat:@"eliminateTracker(%@)|", summary8];
        }
      }

LABEL_100:
      v92 = v136;
      v93 = failureCopy;
      if (v141)
      {
        v92 = [v141 earlierSchedulerInvolved] | v136;
        v93 = [v141 earlierPotentialNetworkFailure] | failureCopy;
      }

      if (*(&v131 + 1))
      {
        v126 = v93;
        v94 = v92 | [*(&v131 + 1) earlierSchedulerInvolved];
        earlierPotentialNetworkFailure = [*(&v131 + 1) earlierPotentialNetworkFailure];
        self = selfCopy;
        if (v94)
        {
          v93 = v126 | earlierPotentialNetworkFailure;
LABEL_106:
          v127 = v93;
          [v16 appendString:@"overallInvolvedScheduler|"];
          if (v127)
          {
            v124 = v16;
            v96 = [MAAutoAssetError buildError:6401 fromOperation:locationCopy underlyingError:0 withDescription:@"auto-asset-scheduler involved set-job finished with potential network-connectivity failure"];
            clientDomainName2 = [setDescriptor clientDomainName];
            assetSetIdentifier = [setDescriptor assetSetIdentifier];
            discoveredAtomicInstance4 = [setDescriptor discoveredAtomicInstance];
            v123 = v96;
            [MADAutoAssetHistory recordFailedOperation:504 fromLayer:1 forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:discoveredAtomicInstance4 failingWithError:v96];

            if (+[MAAIRBEventReporter isAvailable])
            {
              v100 = [MAAIRBMobileAssetOperationMetadata alloc];
              v101 = [MADAutoAssetHistoryTracker operationName:504];
              v102 = [(MAAIRBMobileAssetOperationMetadata *)v100 initWithCode:504 name:v101];

              v103 = [MAAIRBMobileAssetAtomicInstance alloc];
              v104 = [MAAIRBMobileAssetAssetSet alloc];
              assetSetIdentifier2 = [setDescriptor assetSetIdentifier];
              v106 = [(MAAIRBMobileAssetAssetSet *)v104 initWithAssetSetIdentifier:assetSetIdentifier2];
              [setDescriptor discoveredAtomicInstance];
              v107 = locationCopy;
              v109 = v108 = autoAssetJobID;
              v110 = [(MAAIRBMobileAssetAtomicInstance *)v103 initWithAssetSet:v106 atomicInstanceId:v109];

              autoAssetJobID = v108;
              locationCopy = v107;
              v35 = v138;

              v111 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v102 atomicInstance:v110 assetCount:0];
              v112 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
              v146 = v123;
              v113 = [NSArray arrayWithObjects:&v146 count:1];
              v114 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v112 initWithErrors:v113 type:v111];

              [MAAIRBEventReporter emitAppleIntelligenceEvent:v114];
            }

            v16 = v124;
            [v124 appendString:@"overallPotentialNetworkFailure|"];

            autoAssetSetIdentifier = v129;
            self = selfCopy;
          }

          if (v35 && autoAssetSetIdentifier)
          {
            [MADAutoAssetScheduler jobFinishedForSetDomainName:v35 forAssetSetIdentifier:autoAssetSetIdentifier withPotentialNetworkFailure:?];
            [v16 appendString:@"jobFinished|"];
          }
        }
      }

      else
      {
        self = selfCopy;
        if (v92)
        {
          goto LABEL_106;
        }
      }

      statistics = [(MADAutoAssetControlManager *)self statistics];
      v116 = statistics;
      if (v136)
      {
        if (failureCopy)
        {
          [statistics setFinishedJobSchedulerNetworkFailure:{objc_msgSend(statistics, "finishedJobSchedulerNetworkFailure") + 1}];
        }

        else
        {
          [statistics setFinishedJobSchedulerNotNetworkRelated:{objc_msgSend(statistics, "finishedJobSchedulerNotNetworkRelated") + 1}];
        }
      }

      else if (failureCopy)
      {
        [statistics setFinishedJobClientNetworkFailure:{objc_msgSend(statistics, "finishedJobClientNetworkFailure") + 1}];
      }

      else
      {
        [statistics setFinishedJobClientNotNetworkRelated:{objc_msgSend(statistics, "finishedJobClientNotNetworkRelated") + 1}];
      }

      goto LABEL_121;
    }

    if (*(&v131 + 1))
    {
      v44 = *(&v131 + 1);
      v45 = @"byIdentifier autoSetJob from autoJobByIdentifier(%@)|";
      *(&v131 + 1) = v44;
      goto LABEL_51;
    }

    goto LABEL_49;
  }

  autoAssetSetIdentifier2 = [v141 autoAssetSetIdentifier];
  *(&v131 + 1) = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:v138 byIdentifier:autoAssetSetIdentifier2];

  v35 = v138;
  *&v131 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:v138 byIdentifier:autoAssetSetIdentifier2];

  v128 = autoAssetSetIdentifier2;
  if (!autoAssetSetIdentifier2)
  {
    autoAssetSetIdentifier2 = @"N";
  }

  if (*(&v131 + 1))
  {
    v41 = *(&v131 + 1);
    summary9 = [*(&v131 + 1) summary];
  }

  else
  {
    v41 = 0;
    summary9 = @"N";
  }

  if (v131)
  {
    summary10 = [v131 summary];
    [v16 appendFormat:@"from autoJobByUUID(setJobIdentifier:%@, autoJobByIdentifier:%@, cancelingSetJob:%@)|", autoAssetSetIdentifier2, summary9, summary10];
  }

  else
  {
    [v16 appendFormat:@"from autoJobByUUID(setJobIdentifier:%@, autoJobByIdentifier:%@, cancelingSetJob:%@)|", autoAssetSetIdentifier2, summary9, @"N"];
  }

  autoAssetSetIdentifier = v128;
  if (v41)
  {

    self = selfCopy;
    v36 = v141;
    goto LABEL_43;
  }

  v44 = v141;
  self = selfCopy;
  if (v141)
  {
    *(&v131 + 1) = 0;
    goto LABEL_44;
  }

LABEL_49:
  v44 = v131;
  if (v44)
  {
    v131 = v44;
    v45 = @"byIdentifier autoSetJob from cancelingSetJob(%@)|";
    goto LABEL_51;
  }

  [v16 appendFormat:@"byIdentifier autoSetJob from cancelingSetJob(%@)|", @"N"];
  [v16 appendString:@"NO_JOB_FOUND|"];
LABEL_121:
  v117 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v117, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543618;
    v148 = _updateLatestSummary;
    v149 = 2114;
    v150 = v16;
    _os_log_impl(&dword_0, v117, OS_LOG_TYPE_DEFAULT, "[%{public}@] {removeCurrentSetJob} | removalFlow:%{public}@", buf, 0x16u);
  }

LABEL_30:
}

- (void)decrementClientRequestCount:(id)count forEventInfo:(id)info
{
  infoCopy = info;
  countCopy = count;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  countCopy = [[NSString alloc] initWithFormat:@"%@:decrementClientRequestCount", countCopy];
  fromAutoAssetJob = [infoCopy fromAutoAssetJob];

  if (fromAutoAssetJob)
  {
    fromAutoAssetJob2 = [infoCopy fromAutoAssetJob];
    if ([fromAutoAssetJob2 clientRequestCount] < 1)
    {
      goto LABEL_18;
    }

    [fromAutoAssetJob2 setClientRequestCount:{objc_msgSend(fromAutoAssetJob2, "clientRequestCount") - 1}];
    if ([fromAutoAssetJob2 clientRequestCount] > 0)
    {
      goto LABEL_18;
    }

    currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    autoAssetUUID = [infoCopy autoAssetUUID];
    v15 = [currentJobsByUUID safeObjectForKey:autoAssetUUID ofClass:objc_opt_class()];

    if (v15)
    {
      clientDomainName = [v15 clientDomainName];
      [v15 autoAssetSetIdentifier];
    }

    else
    {
      clientDomainName = [infoCopy clientDomainName];
      [infoCopy assetSetIdentifier];
    }
    v17 = ;
    v18 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:v17];
    if (!v18)
    {
LABEL_17:

LABEL_18:
      goto LABEL_19;
    }

    v19 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName byIdentifier:v17];
    v20 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:clientDomainName byIdentifier:v17];
    if (v19)
    {
      currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
      [currentSetJobsByIdentifier removeObjectForKey:v18];
LABEL_16:

      goto LABEL_17;
    }

    currentSetJobsByIdentifier = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(currentSetJobsByIdentifier, OS_LOG_TYPE_DEFAULT);
    if (v20)
    {
      if (!v22)
      {
        goto LABEL_16;
      }

      summary = [v20 summary];
      *buf = 138543618;
      v26 = countCopy;
      v27 = 2114;
      v28 = summary;
      v23 = "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | last client-request has completed for set-job that is being canceled - still awaiting job finished | cancelingSetJob:%{public}@";
    }

    else
    {
      if (!v22)
      {
        goto LABEL_16;
      }

      summary = [infoCopy summary];
      *buf = 138543618;
      v26 = countCopy;
      v27 = 2114;
      v28 = summary;
      v23 = "{%{public}@}\n[SET_CLIENT_REQUESTS_LATE_COALESCE] | last client-request has completed for set-job that is not active and not being canceled - late-coalesce | eventInfo:%{public}@";
    }

    _os_log_impl(&dword_0, currentSetJobsByIdentifier, OS_LOG_TYPE_DEFAULT, v23, buf, 0x16u);

    goto LABEL_16;
  }

LABEL_19:
}

- (id)currentJobBySelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v8 = [(MADAutoAssetControlManager *)self jobSelectorKey:selectorCopy];

  v9 = [currentJobsBySelector safeObjectForKey:v8 ofClass:objc_opt_class()];

  return v9;
}

- (id)currentJobByUUID:(id)d fromLocation:(id)location notFoundCode:(int64_t)code notFoundReason:(id)reason
{
  dCopy = d;
  locationCopy = location;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  stagerCurrentJob = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  if (stagerCurrentJob && (v16 = stagerCurrentJob, [(MADAutoAssetControlManager *)self stagerCurrentJobUUID], v17 = objc_claimAutoreleasedReturnValue(), v18 = [SUCore stringIsEqual:dCopy to:v17], v17, v16, v18))
  {
    stagerCurrentJob2 = [(MADAutoAssetControlManager *)self stagerCurrentJob];
  }

  else
  {
    currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    stagerCurrentJob2 = [currentJobsByUUID safeObjectForKey:dCopy ofClass:objc_opt_class()];

    if (code && !stagerCurrentJob2)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      reasonCopy = [[NSString alloc] initWithFormat:@"AUTO-CONTROL{%@} | %@", locationCopy, reasonCopy];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:reasonCopy withResult:code withError:0];

      stagerCurrentJob2 = 0;
    }
  }

  return stagerCurrentJob2;
}

- (id)currentJobByUUID:(id)d potentiallyResumingJob:(id)job withOriginalSelector:(id)selector fromLocation:(id)location notFoundCode:(int64_t)code notFoundReason:(id)reason downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)self0
{
  dCopy = d;
  jobCopy = job;
  v16 = dCopy;
  v17 = jobCopy;
  selectorCopy = selector;
  locationCopy = location;
  descriptorCopy = descriptor;
  patchDescriptorCopy = patchDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v24 = [(MADAutoAssetControlManager *)self currentJobByUUID:v16 fromLocation:locationCopy notFoundCode:0 notFoundReason:0];
  if (v24)
  {
    v25 = v24;
    if ([v24 autoAssetSetJob])
    {
      goto LABEL_50;
    }

    v66 = patchDescriptorCopy;
    v26 = v17 != 0;
    if (selectorCopy)
    {
LABEL_27:
      v65 = v17;
      assetType3 = 0;
      v36 = 1;
      goto LABEL_28;
    }

    selectorCopy = [v25 autoAssetSelector];
    if (!v17)
    {
LABEL_26:
      if (!selectorCopy)
      {
        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag = [autoControlManagerFSM2 diag];
        v57 = [NSString alloc];
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v59 = [v57 initWithFormat:@"{%@:currentJobByUUID} unable to determine originalSelector | %@", locationCopy, _updateLatestSummary];
        [diag trackAnomaly:@"AUTO-CONTROL" forReason:v59 withResult:6101 withError:0];

        selectorCopy = 0;
        assetType3 = 0;
        patchDescriptorCopy = v66;
LABEL_49:

        goto LABEL_50;
      }

      goto LABEL_27;
    }

LABEL_24:
    if (!selectorCopy)
    {
      selectorCopy = [v17 autoAssetSelector];
    }

    goto LABEL_26;
  }

  v66 = patchDescriptorCopy;
  v26 = v17 != 0;
  if (!v17 || ![v17 autoAssetSetJob])
  {
    if (!selectorCopy)
    {
      v25 = 0;
      if (!v17)
      {
        goto LABEL_26;
      }

      goto LABEL_24;
    }

    v34 = [(MADAutoAssetControlManager *)self currentJobBySelector:selectorCopy];
    v25 = v34;
    assetType3 = 0;
    v36 = 1;
    v65 = v17;
    if (!v17 || !v34)
    {
LABEL_28:
      assetVersion = [selectorCopy assetVersion];
      assetType2 = assetVersion;
      if (descriptorCopy && !assetVersion)
      {
        assetType = [descriptorCopy assetType];
        if (!assetType)
        {
LABEL_36:
          v53 = !v26;
          if (v25)
          {
            v53 = 1;
          }

          v17 = v65;
          if (v53)
          {
            if (v25)
            {
              v54 = v36;
            }

            else
            {
              v54 = 0;
            }

            patchDescriptorCopy = v66;
            if (descriptorCopy)
            {
              if (v54)
              {
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:@"currentJobByUUID"];
                [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_MODIFY" usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"originalSelector for auto-asset-job refreshed"];
                if (assetType3)
                {
                  [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_MODIFY" usingSelector:assetType3 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"fullAssetSelector for auto-asset-job refreshed"];
                }
              }
            }
          }

          else
          {
            v25 = v65;
            patchDescriptorCopy = v66;
            [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:locationCopy];
            [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_ADD" usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"originalSelector for auto-asset-job resumed"];
            if (assetType3)
            {
              [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_ADD" usingSelector:assetType3 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"fullAssetSelector for auto-asset-job resumed"];
            }
          }

          goto LABEL_49;
        }

        assetType2 = assetType;
        v64 = v36;
        assetSpecifier = [descriptorCopy assetSpecifier];
        if (assetSpecifier)
        {
          v49 = assetSpecifier;
          v63 = v16;
          assetVersion2 = [descriptorCopy assetVersion];

          if (!assetVersion2)
          {
            v16 = v63;
            v36 = v64;
            goto LABEL_36;
          }

          v61 = [MAAutoAssetSelector alloc];
          assetType2 = [descriptorCopy assetType];
          assetSpecifier2 = [descriptorCopy assetSpecifier];
          assetVersion3 = [descriptorCopy assetVersion];
          v62 = [v61 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion3];

          assetType3 = v62;
          v16 = v63;
        }

        v36 = v64;
      }

      goto LABEL_36;
    }

    assetVersion4 = [selectorCopy assetVersion];
    if (!descriptorCopy || assetVersion4)
    {
    }

    else
    {
      assetType3 = [descriptorCopy assetType];
      if (!assetType3)
      {
LABEL_55:
        [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:locationCopy];
        [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_MODIFY" usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"originalSelector reachable by UUID as well as by selector"];
        [(MADAutoAssetControlManager *)self _refreshEliminate:selectorCopy withJobUUID:v16];
        v36 = 0;
        v26 = 1;
        goto LABEL_28;
      }

      assetSpecifier3 = [descriptorCopy assetSpecifier];
      if (assetSpecifier3)
      {
        v39 = assetSpecifier3;
        assetVersion5 = [descriptorCopy assetVersion];

        if (assetVersion5)
        {
          v41 = [MAAutoAssetSelector alloc];
          assetType4 = [descriptorCopy assetType];
          assetSpecifier4 = [descriptorCopy assetSpecifier];
          assetVersion6 = [descriptorCopy assetVersion];
          assetType3 = [v41 initForAssetType:assetType4 withAssetSpecifier:assetSpecifier4 matchingAssetVersion:assetVersion6];

          [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_MODIFY" usingSelector:assetType3 withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 message:@"fullAssetSelector reachable by UUID as well as by selector"];
          goto LABEL_55;
        }
      }

      else
      {
      }
    }

    assetType3 = 0;
    goto LABEL_55;
  }

  v27 = v17;
  v25 = v17;
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    clientDomainName = [v25 clientDomainName];
    autoAssetSetIdentifier = [v25 autoAssetSetIdentifier];
    v30 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:clientDomainName forAssetSetIdentifier:autoAssetSetIdentifier];

    if (v30)
    {
      v31 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
      {
        clientDomainName2 = [v25 clientDomainName];
        autoAssetSetIdentifier2 = [v25 autoAssetSetIdentifier];
        *buf = 138543618;
        v68 = clientDomainName2;
        v69 = 2114;
        v70 = autoAssetSetIdentifier2;
        _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "{currentJobByUUID} unexpected resume of suspended set. | clientDomainName:%{public}@ forAssetSetIdentifier:%{public}@", buf, 0x16u);
      }
    }
  }

  [(MADAutoAssetControlManager *)self addToCurrentJobs:v25 usingSelector:selectorCopy withJobUUID:v16 triggeredByClientMessage:0 downloadingDescriptor:descriptorCopy baseForPatchDescriptor:v66 usingSetDescriptor:0 fromLocation:locationCopy];
  v17 = v27;
  patchDescriptorCopy = v66;
LABEL_50:

  return v25;
}

- (void)setJobIndicationOfPotentialLatestToVend:(id)vend forEventInfo:(id)info issuingClientReply:(BOOL)reply
{
  replyCopy = reply;
  vendCopy = vend;
  infoCopy = info;
  v232 = vendCopy;
  vendCopy = [[NSString alloc] initWithFormat:@"%@:setJobIndicationOfPotentialLatestToVend", vendCopy];
  setJobInformation = [infoCopy setJobInformation];
  clientInstance = [setJobInformation clientInstance];
  clientDesire = [setJobInformation clientDesire];
  v251 = infoCopy;
  responseError = [infoCopy responseError];
  v247 = vendCopy;
  v230 = replyCopy;
  if (replyCopy)
  {
    clientRequest = [infoCopy clientRequest];
    clientRequestMessage = [clientRequest clientRequestMessage];
    v243 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

    vendCopy = v247;
    v244 = objc_alloc_init(NSMutableDictionary);
  }

  else
  {
    v243 = 0;
    v244 = 0;
  }

  assignedAutoAssetUUID = [setJobInformation assignedAutoAssetUUID];
  setDescriptor = [setJobInformation setDescriptor];
  clientDomainName = [infoCopy clientDomainName];
  assetSetIdentifier = [v251 assetSetIdentifier];
  v242 = [[NSMutableString alloc] initWithString:@"modified"];
  v253 = 9999;
  v252 = 0;
  if (!responseError)
  {
LABEL_8:
    v246 = [(MADAutoAssetControlManager *)self currentSetStatusFromJobInformation:setJobInformation];
    goto LABEL_10;
  }

  v20 = setDescriptor;
  v21 = setJobInformation;
  selfCopy = self;
  v23 = assignedAutoAssetUUID;
  v24 = assetSetIdentifier;
  v25 = clientDomainName;
  domain = [responseError domain];
  if (([SUCore stringIsEqual:domain to:@"com.apple.MobileAssetError.AutoAsset"]& 1) != 0)
  {
    code = [responseError code];

    v28 = code == "ateCoreConnect.framework/SoftwareUpdateCoreConnect";
    clientDomainName = v25;
    assetSetIdentifier = v24;
    assignedAutoAssetUUID = v23;
    vendCopy = v247;
    self = selfCopy;
    setJobInformation = v21;
    setDescriptor = v20;
    if (!v28)
    {
      v246 = 0;
      goto LABEL_10;
    }

    goto LABEL_8;
  }

  v246 = 0;
  clientDomainName = v25;
  assetSetIdentifier = v24;
  assignedAutoAssetUUID = v23;
  vendCopy = v247;
  self = selfCopy;
  setJobInformation = v21;
  setDescriptor = v20;
LABEL_10:
  v29 = [(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:vendCopy forSetDescriptor:setDescriptor];
  if (!clientDomainName)
  {
    v30 = clientInstance;
    if (clientInstance || (v30 = v246) != 0)
    {
      clientDomainName = [v30 clientDomainName];
    }

    else
    {
      clientDomainName = @"Unknown";
    }
  }

  v235 = clientInstance;
  selfCopy2 = self;
  v240 = setDescriptor;
  v245 = clientDomainName;
  if (!assetSetIdentifier)
  {
    v31 = clientInstance;
    if (!clientInstance)
    {
      v31 = v246;
      if (!v246)
      {
        assetSetIdentifier = 0;
        v32 = 0;
        v238 = clientDomainName != 0;
        if (!responseError)
        {
          goto LABEL_30;
        }

LABEL_27:
        domain2 = [responseError domain];
        if (([SUCore stringIsEqual:domain2 to:@"com.apple.MobileAssetError.AutoAsset"]& 1) == 0)
        {
          v250 = responseError;

          v224 = 0;
          LOBYTE(v229) = 0;
          v51 = 0;
          v52 = 1;
          vendCopy = v247;
LABEL_44:
          p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
          if (!assignedAutoAssetUUID)
          {
            goto LABEL_47;
          }

          goto LABEL_45;
        }

        code2 = [responseError code];

        v28 = code2 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect";
        vendCopy = v247;
        if (!v28)
        {
          v250 = responseError;
          v224 = 0;
          LOBYTE(v229) = 0;
          v51 = 0;
          v52 = 1;
          goto LABEL_44;
        }

LABEL_30:
        v39 = [MAAutoAssetError buildError:6103 fromOperation:vendCopy underlyingError:0 withDescription:@"set-configuration has been eliminated"];

        v224 = 0;
        LOBYTE(v229) = 0;
        v51 = 0;
        v52 = 1;
        v250 = v39;
        goto LABEL_44;
      }
    }

    assetSetIdentifier = [v31 assetSetIdentifier];
  }

  v228 = v29;
  v238 = clientDomainName != 0;
  v32 = assetSetIdentifier != 0;
  if (!clientDomainName || !assetSetIdentifier)
  {
LABEL_26:
    if (!responseError)
    {
      goto LABEL_30;
    }

    goto LABEL_27;
  }

  v33 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];
  if (!v33)
  {
    v238 = 1;
    v32 = 1;
    goto LABEL_26;
  }

  v233 = assetSetIdentifier;
  v236 = v33;
  if (responseError)
  {
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    clientDomainName = [responseError domain];
    if (!+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", clientDomainName, @"com.apple.MobileAssetError.AutoAsset") || [responseError code] != "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
    {

      goto LABEL_37;
    }

    v35 = vendCopy;
    v36 = assignedAutoAssetUUID;
  }

  else
  {
    v35 = vendCopy;
    v36 = assignedAutoAssetUUID;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  }

  v40 = setJobInformation;
  foundContent = [setJobInformation foundContent];
  currentSetStatus = [foundContent currentSetStatus];
  latestDowloadedAtomicInstanceEntries = [currentSetStatus latestDowloadedAtomicInstanceEntries];
  v44 = [latestDowloadedAtomicInstanceEntries count];

  if (responseError)
  {
  }

  setJobInformation = v40;
  assignedAutoAssetUUID = v36;
  vendCopy = v35;
  v51 = v236;
  if (!v44)
  {
    v93 = [MAAutoAssetError buildError:6110 fromOperation:v35 underlyingError:0 withDescription:@"set-job completed with 0 entries"];

    v224 = 0;
    LOBYTE(v229) = 0;
    v52 = 0;
    v32 = 1;
    v250 = v93;
    v238 = 1;
    assetSetIdentifier = v233;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_47;
    }

    goto LABEL_45;
  }

LABEL_37:
  domain3 = [responseError domain];
  v249 = responseError;
  if (![SUCore stringIsEqual:domain3 to:@"com.apple.MobileAssetError.AutoAsset"])
  {
    v47 = setJobInformation;

    goto LABEL_76;
  }

  code3 = [responseError code];

  if (code3 != "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
  {
    v47 = setJobInformation;
LABEL_76:
    v48 = 0;
    v49 = 0;
    v50 = 0;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_120;
    }

    goto LABEL_77;
  }

  if (!v243)
  {
    v47 = setJobInformation;
LABEL_119:
    v48 = 0;
    v49 = 1;
    v50 = 1;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_120;
    }

LABEL_77:
    assetSetIdentifier = v233;
    goto LABEL_125;
  }

  v47 = setJobInformation;
  if (([SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"]& 1) != 0)
  {
    goto LABEL_119;
  }

  v48 = [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
  v49 = 0;
  v50 = v48;
  if (assignedAutoAssetUUID)
  {
    goto LABEL_77;
  }

LABEL_120:
  autoAssetUUID = [v251 autoAssetUUID];

  assetSetIdentifier = v233;
  if (autoAssetUUID)
  {
    assignedAutoAssetUUID = [v251 autoAssetUUID];
    v123 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v123, OS_LOG_TYPE_DEFAULT))
    {
      summary = [v251 summary];
      *buf = 138543618;
      v256 = vendCopy;
      v257 = 2114;
      v258 = summary;
      _os_log_impl(&dword_0, v123, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with no assigned UUID - using event information | eventInfo:%{public}@", buf, 0x16u);
    }
  }

  else
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v127 = [NSString alloc];
    summary2 = [v251 summary];
    v128 = [v127 initWithFormat:@"{%@} set-job with no assigned UUID and no eventInfo.autoAssetUUID | eventInfo:%@", vendCopy, summary2];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v128 withResult:6108 withError:0];

    assetSetIdentifier = v233;
    v130 = [MAAutoAssetError buildError:6103 fromOperation:vendCopy underlyingError:0 withDescription:@"unable to service finished set-job [set-job with no assigned UUID and no eventInfo.autoAssetUUID]"];

    v50 = 0;
    assignedAutoAssetUUID = 0;
    v249 = v130;
  }

LABEL_125:
  if (v249)
  {
    LOBYTE(v131) = v48 | v49;
  }

  else
  {
    v131 = v48 | v49 | [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];
  }

  if (v228 & 1 | ((v131 & 1) == 0))
  {
    v229 = 0;
  }

  else
  {
    v229 = [(MADAutoAssetControlManager *)selfCopy2 setJobFoundAllContent:vendCopy forJobAtomicInstance:assignedAutoAssetUUID withCurrentSetStatus:v246];
  }

  setJobInformation = v47;
  v132 = [SUCore stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"];
  v133 = 0;
  v51 = v236;
  if (v132 && clientDesire)
  {
    if ([clientDesire awaitDownloadingOfDiscovered])
    {
      v133 = @"replying to check-atomic awaiting download of discovered";
    }

    else
    {
      v133 = 0;
    }
  }

  v224 = v133;
  v223 = v49;
  if (!v249)
  {
    v239 = 0;
    v144 = 0;
    v249 = 0;
LABEL_148:
    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    goto LABEL_189;
  }

  if (!v50)
  {
    v239 = 0;
    v144 = 0;
    goto LABEL_148;
  }

  v134 = [(MADAutoAssetControlManager *)selfCopy2 locateSetDescriptor:vendCopy forAtomicInstanceUUID:assignedAutoAssetUUID requireExists:0];
  [v236 setDiscoveredInFlightAtomicInstance:0];
  [v242 appendString:{@", cleared discovered-in-flight"}];
  autoAssetEntries = [v236 autoAssetEntries];
  v136 = [(MADAutoAssetControlManager *)selfCopy2 doesSetDescriptor:v240 coverRequestedAutoAssetEntries:autoAssetEntries];

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  if (!v136)
  {
    v239 = 0;
    v144 = 1;
    goto LABEL_150;
  }

  latestAtomicInstanceToVend = [v236 latestAtomicInstanceToVend];
  v138 = [(MADAutoAssetControlManager *)selfCopy2 locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend];

  v220 = v138;
  if (!v138)
  {
    if (!v134)
    {
      if (((v240 != 0) & v229) != 0)
      {
        v226 = assignedAutoAssetUUID;
        v159 = v240;

        [(MADAutoAssetControlManager *)selfCopy2 setConfigurationPersist:v236 fromLocation:vendCopy forReason:v242 dueToAlter:0 forHistoryOperation:v253];
        v160 = vendCopy;
        v161 = [[NSMutableString alloc] initWithString:@"modified"];

        v253 = 9999;
        isDiscoveredFullyDownloaded = [v159 isDiscoveredFullyDownloaded];
        discoveredAtomicInstance = [v159 discoveredAtomicInstance];
        isDiscoveredFullyDownloaded2 = [v159 isDiscoveredFullyDownloaded];
        LOBYTE(v218) = 0;
        BYTE2(v217) = [v159 isDiscoveredFullyDownloaded];
        BYTE1(v217) = isDiscoveredFullyDownloaded2;
        LOBYTE(v217) = 0;
        v221 = v159;
        v165 = v160;
        LODWORD(isDiscoveredFullyDownloaded) = [MADAutoAssetControlManager trackSetDescriptor:selfCopy2 fromLocation:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" forLatestDownloaded:v159 forSpecificAtomicInstance:v160 withCurrentSetStatus:isDiscoveredFullyDownloaded changedWhileTerminated:discoveredAtomicInstance changedNeverBeenLocked:v246 notifyingIfJustDownloaded:0 latestToVend:v217 historyOperation:357 firstClientName:@"com.apple.MobileAsset.daemon.internal" fromPreSUStaging:v218];

        if (isDiscoveredFullyDownloaded)
        {
          v166 = v161;
          v167 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v167, OS_LOG_TYPE_DEFAULT))
          {
            summary3 = [v236 summary];
            *buf = 138543618;
            v256 = v165;
            v257 = 2114;
            v258 = summary3;
            _os_log_impl(&dword_0, v167, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[FROM-TRACKED-LATEST-TO-VEND] same version found first-tracked as downloaded set-descriptor | setConfiguration:%{public}@", buf, 0x16u);
          }

          v249 = 0;
          v144 = 1;
          v158 = v159;
          v239 = 1;
          v242 = v166;
          assetSetIdentifier = v233;
          assignedAutoAssetUUID = v226;
          goto LABEL_188;
        }

        v239 = 1;
        v242 = v161;
        v144 = 1;
        assignedAutoAssetUUID = v226;
        v147 = v221;
        goto LABEL_178;
      }

      v239 = 0;
      v144 = 1;
LABEL_166:
      v158 = v220;
LABEL_188:

      goto LABEL_189;
    }

    v147 = v134;
    if (!v240)
    {
      v151 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v151, OS_LOG_TYPE_DEFAULT))
      {
        summary4 = [v134 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary4;
        _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with no set-job descriptor yet jobAtomicInstance is already downloaded set-descriptor | setDescriptor:%{public}@", buf, 0x16u);
      }

      goto LABEL_177;
    }

    latestDownloadedAtomicInstance = [v240 latestDownloadedAtomicInstance];
    latestDownloadedAtomicInstance2 = [v134 latestDownloadedAtomicInstance];
    v150 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestDownloadedAtomicInstance2];

    v151 = _MADLog(@"AutoControl");
    v152 = os_log_type_enabled(v151, OS_LOG_TYPE_DEFAULT);
    if (v150)
    {
      if (v152)
      {
        v147 = v134;
        summary5 = [v134 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary5;
        _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with set-job descriptor that is already a downloaded set-descriptor | setDescriptor:%{public}@", buf, 0x16u);

LABEL_177:
        v239 = 0;
        v144 = 1;
        goto LABEL_178;
      }
    }

    else if (v152)
    {
      summary6 = [v240 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = summary6;
      _os_log_impl(&dword_0, v151, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job with set-job descriptor that is different from already downloaded set-descriptor (using already downloaded) | setJobDescriptor:%{public}@", buf, 0x16u);
    }

    v147 = v134;
    goto LABEL_177;
  }

  [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDMostRecentlyReceived:vendCopy fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
  [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDLatestToVend:vendCopy fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
  latestDownloadedAtomicInstance3 = [v240 latestDownloadedAtomicInstance];
  latestAtomicInstanceToVend2 = [v236 latestAtomicInstanceToVend];
  v141 = [SUCore stringIsEqual:latestDownloadedAtomicInstance3 to:latestAtomicInstanceToVend2];

  if (!v141)
  {
    if ([v236 vendingAtomicInstanceForConfiguredEntries])
    {
      [v236 setNewerVersionError:0];
      v144 = [(MADAutoAssetControlManager *)selfCopy2 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (already latest-to-vend)" maintainingHistoryOperation:&v253];
      v154 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v154, OS_LOG_TYPE_DEFAULT))
      {
        summary7 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary7;
        _os_log_impl(&dword_0, v154, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (already latest-to-vend) | setConfiguration:%{public}@", buf, 0x16u);
      }

      v156 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v156, OS_LOG_TYPE_DEFAULT))
      {
        summary8 = [v240 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary8;
        _os_log_impl(&dword_0, v156, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job found same content already latest-to-vend | setJobDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v144 = 1;
      [v236 setVendingAtomicInstanceForConfiguredEntries:1];
      [v242 appendString:{@", set vending-configured-entries"}];
      v253 = 455;
    }

    v239 = 0;
    goto LABEL_166;
  }

  v142 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v142, OS_LOG_TYPE_DEFAULT))
  {
    summary9 = [v240 summary];
    *buf = 138543618;
    v256 = v247;
    v257 = 2114;
    v258 = summary9;
    _os_log_impl(&dword_0, v142, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-job matches latest-to-vend | setJobDescriptor:%{public}@", buf, 0x16u);
  }

  [v236 setNewerVersionError:0];
  v144 = [(MADAutoAssetControlManager *)selfCopy2 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (matches latest-to-vend)" maintainingHistoryOperation:&v253];
  v145 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v145, OS_LOG_TYPE_DEFAULT))
  {
    summary10 = [v236 summary];
    *buf = 138543618;
    v256 = v247;
    v257 = 2114;
    v258 = summary10;
    _os_log_impl(&dword_0, v145, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (matches latest-to-vend) | setConfiguration:%{public}@", buf, 0x16u);
  }

  v239 = 0;
  v249 = 0;
LABEL_150:
  v147 = v134;
  if (v134)
  {
LABEL_178:
    latestDownloadedAtomicInstance4 = [v147 latestDownloadedAtomicInstance];
    latestAtomicInstanceToVend3 = [v236 latestAtomicInstanceToVend];
    v173 = [SUCore stringIsEqual:latestDownloadedAtomicInstance4 to:latestAtomicInstanceToVend3];

    if (v173)
    {
      v158 = v147;
      v174 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v174, OS_LOG_TYPE_DEFAULT))
      {
        summary11 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary11;
        _os_log_impl(&dword_0, v174, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] same version found already tracked as latest-to-vend | setConfiguration:%{public}@", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDMostRecentlyReceived:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
      [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDLatestToVend:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
    }

    else if ([(MADAutoAssetControlManager *)selfCopy2 setConfigurationAdoptLatestToVend:v247 fromSetDescriptor:v147 toSetConfiguration:v236 fromPreSUStaging:0 allowEmpty:0])
    {
      v176 = [[NSMutableString alloc] initWithString:@"modified"];

      v253 = 9999;
      v177 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v177, OS_LOG_TYPE_DEFAULT))
      {
        summary12 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary12;
        _os_log_impl(&dword_0, v177, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] same version found is always latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x16u);
      }

      v249 = 0;
      v239 = 1;
      v158 = v147;
      v242 = v176;
    }

    else
    {
      [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDMostRecentlyReceived:v247 fromSetDescriptor:v240 forSetConfiguration:v236 buildingPersistReason:v242];
      v158 = v147;
    }

    assetSetIdentifier = v233;
    goto LABEL_188;
  }

LABEL_189:
  availableForUseError = [v236 availableForUseError];
  newerVersionError = [v236 newerVersionError];
  if (v249)
  {
    v181 = setJobInformation;
    v182 = [(MADAutoAssetControlManager *)selfCopy2 _errorUnlessSameVersionFound:v249 changedReportedError:&v252];

    latestAtomicInstanceToVend4 = [v236 latestAtomicInstanceToVend];

    if (!latestAtomicInstanceToVend4)
    {
      [v236 setNewerVersionError:0];
      v190 = [NSError buildCheckedError:v182];
      [v236 setAvailableForUseError:v190];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        summary13 = [v236 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary13;
        v192 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job and no latest-to-vend | setConfiguration:%{public}@";
LABEL_215:
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, v192, buf, 0x16u);
      }

LABEL_216:
      v196 = v223;
LABEL_217:

      v144 = 1;
      v250 = v182;
      setJobInformation = v181;
      v51 = v236;
      goto LABEL_218;
    }

    if (v182)
    {
      if (availableForUseError)
      {
        if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:availableForUseError])
        {
          v184 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v184, OS_LOG_TYPE_DEFAULT))
          {
            summary14 = [v236 summary];
            *buf = 138543618;
            v256 = v247;
            v257 = 2114;
            v258 = summary14;
            _os_log_impl(&dword_0, v184, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS] latest-to-vend not accessible due to secure SMAC requiring grafting yet device locked | setConfiguration:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
          diag2 = [autoControlManagerFSM2 diag];
          v199 = [NSString alloc];
          checkedDescription = [availableForUseError checkedDescription];
          v200 = [v199 initWithFormat:@"set-job completed with error yet have latest-to-vend when availableForUseError | beforeAvailableForUseError:%@", checkedDescription];
          [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v200 withResult:6108 withError:availableForUseError];

          assetSetIdentifier = v233;
          [v236 setAvailableForUseError:0];
        }
      }

      v202 = [NSError buildCheckedError:v182];
      [v236 setNewerVersionError:v202];

      v187 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_216;
      }

      summary13 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = summary13;
      v192 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job but have latest-to-vend | setConfiguration:%{public}@";
      goto LABEL_215;
    }

    [(MADAutoAssetControlManager *)selfCopy2 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"failed set-job that was converted to success (have latest-to-vend)" maintainingHistoryOperation:&v253];
    [v236 setNewerVersionError:0];
    v187 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v187, OS_LOG_TYPE_DEFAULT))
    {
      summary15 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = summary15;
      v189 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] failed set-job that was converted to success (have latest-to-vend) | setConfiguration:%{public}@";
      goto LABEL_205;
    }

    goto LABEL_206;
  }

  latestAtomicInstanceToVend5 = [v236 latestAtomicInstanceToVend];

  if (!latestAtomicInstanceToVend5)
  {
    [v236 setNewerVersionError:0];
    newerAtomicInstanceOncePersonalized = [v236 newerAtomicInstanceOncePersonalized];

    if (newerAtomicInstanceOncePersonalized)
    {
      v181 = setJobInformation;
      v194 = [MAAutoAssetError buildError:6560 fromOperation:v247 underlyingError:0 withDescription:@"set-job completed successfully yet did not result in latest-to-vend (newer-once-personalized)"];
      [v236 setAvailableForUseError:v194];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        summary16 = [v236 summary];
        *buf = 138543874;
        v256 = v247;
        v257 = 2114;
        v258 = @"set-job completed successfully yet did not result in latest-to-vend (newer-once-personalized)";
        v259 = 2114;
        v260 = summary16;
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] %{public}@ | setConfiguration:%{public}@", buf, 0x20u);
      }

      v182 = 0;
    }

    else
    {
      v227 = assignedAutoAssetUUID;
      v181 = setJobInformation;
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
      diag3 = [autoControlManagerFSM3 diag];
      v212 = [NSString alloc];
      summary17 = [v251 summary];
      v213 = [v212 initWithFormat:@"%@ | eventInfo:%@", @"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized", summary17];
      [diag3 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v213 withResult:6559 withError:0];

      v215 = [MAAutoAssetError buildError:6559 fromOperation:v247 underlyingError:0 withDescription:@"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized"];
      [v236 setAvailableForUseError:v215];

      v187 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v187, OS_LOG_TYPE_ERROR))
      {
        summary18 = [v236 summary];
        *buf = 138543874;
        v256 = v247;
        v257 = 2114;
        v258 = @"set-job completed successfully yet did not result in latest-to-vend nor in newer-once-personalized";
        v259 = 2114;
        v260 = summary18;
        _os_log_impl(&dword_0, v187, OS_LOG_TYPE_ERROR, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] %{public}@ | setConfiguration:%{public}@", buf, 0x20u);
      }

      v182 = 0;
      assetSetIdentifier = v233;
      assignedAutoAssetUUID = v227;
    }

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    v196 = v223;
    goto LABEL_217;
  }

  if (availableForUseError | newerVersionError)
  {
    v181 = setJobInformation;
    [(MADAutoAssetControlManager *)selfCopy2 setConfigurationClearAvailableForUseError:v247 forSetConfiguration:v236 appendingToPersistReason:v242 withReason:@"successful set-job and have latest-to-vend" maintainingHistoryOperation:&v253];
    [v236 setNewerVersionError:0];
    v187 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v187, OS_LOG_TYPE_DEFAULT))
    {
      summary15 = [v236 summary];
      *buf = 138543618;
      v256 = v247;
      v257 = 2114;
      v258 = summary15;
      v189 = "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] successful set-job and have latest-to-vend | setConfiguration:%{public}@";
LABEL_205:
      _os_log_impl(&dword_0, v187, OS_LOG_TYPE_DEFAULT, v189, buf, 0x16u);
    }

LABEL_206:
    v182 = 0;
    goto LABEL_216;
  }

  v250 = 0;
  v196 = v223;
LABEL_218:
  if ((v196 & v229) == 1)
  {
    latestAtomicInstanceToVend6 = [v51 latestAtomicInstanceToVend];

    if (latestAtomicInstanceToVend6)
    {
      if (([v51 vendingAtomicInstanceForConfiguredEntries] & 1) == 0)
      {
        v144 = 1;
        [v51 setVendingAtomicInstanceForConfiguredEntries:1];
        [v242 appendString:{@", fixed vending-configured-entries"}];
        v253 = 456;
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
        diag4 = [autoControlManagerFSM4 diag];
        v206 = [NSString alloc];
        [v251 summary];
        v208 = v207 = assignedAutoAssetUUID;
        v208 = [v206 initWithFormat:@"set-job indicating same-version-found when set-configuration required fix to vendingAtomicInstanceForConfiguredEntries | eventInfo:%@", v208];
        [diag4 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v208 withResult:6108 withError:0];

        assetSetIdentifier = v233;
        assignedAutoAssetUUID = v207;
        v51 = v236;
      }
    }
  }

  if ((v239 | v144 ^ 1))
  {
    v52 = 0;
    v32 = 1;
    v238 = 1;
    vendCopy = v247;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_47;
    }
  }

  else
  {
    vendCopy = v247;
    [(MADAutoAssetControlManager *)selfCopy2 setConfigurationPersist:v51 fromLocation:v247 forReason:v242 dueToAlter:0 forHistoryOperation:v253];
    v52 = 0;
    v32 = 1;
    v238 = 1;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_47;
    }
  }

LABEL_45:
  currentJobsByUUID = [(MADAutoAssetControlManager *)selfCopy2 currentJobsByUUID];
  v54 = [currentJobsByUUID safeObjectForKey:assignedAutoAssetUUID ofClass:objc_opt_class()];

  if (v54)
  {
    mostRecentlyReceivedCachedAssetSetID = [v51 mostRecentlyReceivedCachedAssetSetID];
    [v54 setMostRecentlyReceivedCachedAssetSetID:mostRecentlyReceivedCachedAssetSetID];

    latestToVendCachedAssetSetID = [v51 latestToVendCachedAssetSetID];
    [v54 setLatestToVendCachedAssetSetID:latestToVendCachedAssetSetID];
  }

LABEL_47:
  if (v230)
  {
    v225 = assignedAutoAssetUUID;
    v234 = assetSetIdentifier;
    if (!v250)
    {
      foundContent2 = [setJobInformation foundContent];
      if (v252 == 1)
      {
        v58 = [(MADAutoAssetControlManager *)selfCopy2 _constructSetInfoSameFoundFrom:foundContent2 forSetConfiguration:v51 fromSetStatus:v246];

        foundContent2 = v58;
      }

      clientRequest2 = [v251 clientRequest];
      v65 = [(MADAutoAssetControlManager *)selfCopy2 clientRequestMessageName:clientRequest2];

      if (([p_weak_ivar_lyt[223] stringIsEqual:v65 to:@"MA-AUTO-SET:LOCK_ATOMIC"] & 1) == 0)
      {
        clientDomainName2 = [v251 clientDomainName];
        assetSetIdentifier2 = [v251 assetSetIdentifier];
        v68 = [(MADAutoAssetControlManager *)selfCopy2 newSetInfoLimitedToCheckInformation:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 fromSetInfoFound:foundContent2];

        foundContent2 = v68;
      }

      clientInstance2 = [setJobInformation clientInstance];
      v70 = [MASAutoAssetSetInfoInstance newShimmedToFramework:clientInstance2];
      [v244 setSafeObject:v70 forKey:@"setInstance"];

      v71 = [MASAutoAssetSetInfoFound newShimmedToFramework:foundContent2];
      [v244 setSafeObject:v71 forKey:@"setFound"];

      clientDesire2 = [setJobInformation clientDesire];
      v73 = [MASAutoAssetSetInfoDesire newShimmedToFramework:clientDesire2];
      [v244 setSafeObject:v73 forKey:@"setDesire"];
    }

    v237 = v51;
    v231 = setJobInformation;
    v74 = [SUCoreConnectMessage alloc];
    clientRequest3 = [v251 clientRequest];
    clientRequestMessage2 = [clientRequest3 clientRequestMessage];
    v77 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
    clientRequest4 = [v251 clientRequest];
    clientID = [clientRequest4 clientID];
    v80 = [v74 initWithType:2 messageName:v77 clientID:clientID version:0 message:v244];

    v222 = v32;
    v219 = v80;
    if (v80)
    {
      clientRequest5 = [v251 clientRequest];
      [clientRequest5 setResponseMessage:v80];
      vendCopy = v247;
    }

    else
    {
      clientRequest5 = _MADLog(@"AutoControl");
      vendCopy = v247;
      if (os_log_type_enabled(clientRequest5, OS_LOG_TYPE_ERROR))
      {
        clientRequest6 = [v251 clientRequest];
        summary19 = [clientRequest6 summary];
        *buf = 138543618;
        v256 = v247;
        v257 = 2114;
        v258 = summary19;
        _os_log_impl(&dword_0, clientRequest5, OS_LOG_TYPE_ERROR, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] unable to allocate basis for response message | clientRequest:%{public}@", buf, 0x16u);
      }
    }

    assetSetIdentifier = v234;
    assignedAutoAssetUUID = v225;

    v84 = v238;
    if (v250)
    {
      v84 = 0;
    }

    if (v84 && v32)
    {
      if ([(MADAutoAssetControlManager *)selfCopy2 isSetIdentifierBeingEliminated:vendCopy forClientDomainName:v245 ofSetIdentifier:v234])
      {
        v85 = v52;
        v250 = [MAAutoAssetError buildError:6114 fromOperation:vendCopy underlyingError:0 withDescription:@"set-identifier is being eliminated"];
        clientRequest8 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(clientRequest8, OS_LOG_TYPE_ERROR))
        {
          clientRequest7 = [v251 clientRequest];
          summary20 = [clientRequest7 summary];
          *buf = 138543618;
          v256 = vendCopy;
          v257 = 2114;
          v258 = summary20;
          _os_log_impl(&dword_0, clientRequest8, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [EliminationInProgress] set-identifier is being eliminated | clientRequest:%{public}@", buf, 0x16u);
        }

        v224 = @"set-identifier being eliminated";
        goto LABEL_91;
      }
    }

    else if (v250)
    {
      v85 = v52;
      goto LABEL_92;
    }

    clientRequest8 = [v251 clientRequest];
    clientReplyCompletion = [clientRequest8 clientReplyCompletion];
    if (!clientReplyCompletion)
    {
      v85 = v52;
      v250 = 0;
LABEL_91:

      goto LABEL_92;
    }

    v90 = clientReplyCompletion;
    v91 = [p_weak_ivar_lyt[223] stringIsEqual:v243 to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"];

    if (v91)
    {
      v61 = v235;
      atomicInstance = [v235 atomicInstance];
      if (atomicInstance)
      {
        [v235 atomicInstance];
      }

      else
      {
        [v237 latestAtomicInstanceToVend];
      }
      v94 = ;
      clientRequest8 = [(MADAutoAssetControlManager *)selfCopy2 locateSetDescriptor:vendCopy forAtomicInstanceUUID:v94 requireExists:1];

      if (clientRequest8)
      {
        assetSetIdentifier = v234;
        if (![clientRequest8 secureOperationInProgress])
        {
          [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetSetIDMostRecentlyReceived:vendCopy fromSetDescriptor:clientRequest8 forSetConfiguration:v237 buildingPersistReason:v242];
          v59 = v237;
          [(MADAutoAssetControlManager *)selfCopy2 setConfigurationPersist:v237 fromLocation:vendCopy forReason:v242 dueToAlter:0 forHistoryOperation:458];
          [(MADAutoAssetControlManager *)selfCopy2 securePersonalizeGraftLockSet:vendCopy lockingSetDescriptor:clientRequest8 forEventInfo:v251 fallingBackToSetDescriptor:0 fromPreSUStaging:0];
          v250 = 0;
          v60 = 0;
          v63 = v240;
          goto LABEL_112;
        }

        v95 = [MAAutoAssetError buildError:6532 fromOperation:vendCopy underlyingError:0 withDescription:@"set-identifier already performing a secure-operation"];

        v96 = _MADLog(@"AutoControl");
        v250 = v96;
        v85 = v52;
        if (os_log_type_enabled(v96, OS_LOG_TYPE_ERROR))
        {
          clientRequest9 = [v251 clientRequest];
          summary21 = [clientRequest9 summary];
          *buf = 138543618;
          v256 = vendCopy;
          v257 = 2114;
          v258 = summary21;
          _os_log_impl(&dword_0, v96, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [SecureOperationInProgress] set-identifier already performing a secure-operation | clientRequest:%{public}@", buf, 0x16u);
        }

        v224 = @"downloaded when secure operation in progress";
      }

      else
      {
        v85 = v52;
        v95 = [MAAutoAssetError buildError:6504 fromOperation:vendCopy underlyingError:0 withDescription:@"set-job successfully downloaded atomic-instance yet atomic-instance not present on the filesystem"];
        v224 = @"downloaded yet atomic-instance not present on the filesystem";
        assetSetIdentifier = v234;
      }

      v250 = v95;
      vendCopy = v247;
      assignedAutoAssetUUID = v225;
      goto LABEL_91;
    }

    v85 = v52;
    v250 = 0;
LABEL_92:
    v59 = v237;
    clientRequest10 = [v251 clientRequest];
    clientRequest8 = [clientRequest10 responseMessage];

    if (v85)
    {
      v61 = v235;
      v63 = v240;
      v100 = selfCopy2;
      v101 = v250;
    }

    else
    {
      clientRequest11 = [v251 clientRequest];
      responseMessage = [clientRequest11 responseMessage];
      v100 = selfCopy2;
      v101 = v250;
      v104 = [(MADAutoAssetControlManager *)selfCopy2 updateAutoAssetSetStatus:vendCopy forClientDomain:v245 forAssetSetIdentifier:assetSetIdentifier forJobResponse:responseMessage withResponseError:v250 clearingDownloadProgressReason:v224 withAssetSetStatus:v246];

      clientRequest8 = v104;
      assetSetIdentifier = v234;
      v61 = v235;
      v63 = v240;
    }

    [(MADAutoAssetControlManager *)v100 issueBuiltResponseForEventInfo:v251 issuingResponseMessage:clientRequest8 withResponseError:v101 fromLocation:vendCopy];
    v105 = (v101 == 0) | v229;
    if ((v105 & 1) == 0)
    {
      autoAssetSetClientName = [v61 autoAssetSetClientName];
      if (autoAssetSetClientName)
      {
        [v61 autoAssetSetClientName];
      }

      else
      {
        [v61 clientProcessName];
      }
      v107 = ;

      if (v107)
      {
        v108 = v107;
      }

      else
      {
        v108 = @"Unknown Client";
      }

      if (v238)
      {
        v109 = v245;
      }

      else
      {
        v109 = @"Unknown Client Domain Name";
      }

      if (v222)
      {
        v110 = assetSetIdentifier;
      }

      else
      {
        v110 = @"Unknown Asset Set Identifier";
      }

      [MADAutoAssetHistory recordFailedOperation:504 fromClient:v108 forClientDomainName:v109 forAssetSetIdentifier:v110 forAtomicInstance:v225 failingWithError:v250];
      if (+[MAAIRBEventReporter isAvailable])
      {
        v111 = [MAAIRBMobileAssetOperationMetadata alloc];
        v112 = [MADAutoAssetHistoryTracker operationName:504];
        v113 = [(MAAIRBMobileAssetOperationMetadata *)v111 initWithCode:504 name:v112];

        v114 = [MAAIRBMobileAssetAtomicInstance alloc];
        v115 = [[MAAIRBMobileAssetAssetSet alloc] initWithAssetSetIdentifier:assetSetIdentifier];
        v116 = [(MAAIRBMobileAssetAtomicInstance *)v114 initWithAssetSet:v115 atomicInstanceId:v225];

        v117 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v113 atomicInstance:v116 assetCount:0];
        v118 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
        v254 = v250;
        v119 = [NSArray arrayWithObjects:&v254 count:1];
        v120 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v118 initWithErrors:v119 type:v117];

        [MAAIRBEventReporter emitAppleIntelligenceEvent:v120];
        v59 = v237;

        v61 = v235;
        assetSetIdentifier = v234;
        v63 = v240;
      }

      vendCopy = v247;
      assignedAutoAssetUUID = v225;
    }

    v60 = v105 ^ 1;
    [(MADAutoAssetControlManager *)selfCopy2 decrementClientRequestCount:vendCopy forEventInfo:v251];
LABEL_112:

    setJobInformation = v231;
    v62 = v243;
    if (!assignedAutoAssetUUID)
    {
      goto LABEL_117;
    }

    goto LABEL_113;
  }

  v59 = v51;
  v60 = 1;
  v61 = v235;
  v62 = v243;
  v63 = v240;
  if (!assignedAutoAssetUUID)
  {
    goto LABEL_117;
  }

LABEL_113:
  if (v60)
  {
    v121 = [(MADAutoAssetControlManager *)selfCopy2 locateSetDescriptor:vendCopy forAtomicInstanceUUID:assignedAutoAssetUUID requireExists:0];
    if (!v121)
    {
      [(MADAutoAssetControlManager *)selfCopy2 atomicInstanceRemove:vendCopy setAtomicInstanceUUID:assignedAutoAssetUUID removingForReason:@"failure where atomic-instance never reached downloaded stage" historyOperation:321];
    }
  }

LABEL_117:
}

- (BOOL)setConfigurationClearAvailableForUseError:(id)error forSetConfiguration:(id)configuration appendingToPersistReason:(id)reason withReason:(id)withReason maintainingHistoryOperation:(int64_t *)operation
{
  configurationCopy = configuration;
  reasonCopy = reason;
  withReasonCopy = withReason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  availableForUseError = [configurationCopy availableForUseError];

  if (availableForUseError)
  {
    availableForUseError2 = [configurationCopy availableForUseError];
    v18 = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:availableForUseError2];

    if (v18)
    {
      withReasonCopy = [[NSString alloc] initWithFormat:@", (%@) had been unavailable due to device being locked", withReasonCopy];
      [reasonCopy appendString:withReasonCopy];

      if (operation)
      {
        *operation = 461;
      }
    }

    else
    {
      [reasonCopy appendString:withReasonCopy];
    }

    [configurationCopy setAvailableForUseError:0];
  }

  return 0;
}

- (void)scheduledJobsResumed:(id)resumed
{
  resumedCopy = resumed;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self setAlreadyScheduledSelectors:v7];

  v21 = 0u;
  v22 = 0u;
  v19 = 0u;
  v20 = 0u;
  v8 = resumedCopy;
  v9 = [v8 countByEnumeratingWithState:&v19 objects:v23 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v20;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v20 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v19 + 1) + 8 * i);
        if (([v13 setJob] & 1) == 0)
        {
          assetSelector = [v13 assetSelector];
          persistedEntryID = [assetSelector persistedEntryID];

          alreadyScheduledSelectors = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
          assetSelector2 = [v13 assetSelector];
          v18 = [assetSelector2 copy];
          [alreadyScheduledSelectors setSafeObject:v18 forKey:persistedEntryID];
        }
      }

      v10 = [v8 countByEnumeratingWithState:&v19 objects:v23 count:16];
    }

    while (v10);
  }
}

- (id)locateSetJobForClientDomain:(id)domain byIdentifier:(id)identifier
{
  domainCopy = domain;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (domainCopy && identifierCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
    currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
    v12 = [currentSetJobsByIdentifier safeObjectForKey:autoControlManagerFSM2 ofClass:objc_opt_class()];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    currentSetJobsByIdentifier = [autoControlManagerFSM2 diag];
    v13 = [NSString alloc];
    v14 = @"N";
    if (domainCopy)
    {
      v15 = domainCopy;
    }

    else
    {
      v15 = @"N";
    }

    if (identifierCopy)
    {
      v14 = identifierCopy;
    }

    v16 = [v13 initWithFormat:@"{locateSetJobForClientDomain} missing required | clientDomainName:%@ | assetSetIdentifier:%@", v15, v14];
    [currentSetJobsByIdentifier trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6102 withError:0];

    v12 = 0;
  }

  return v12;
}

- (id)locateCancelingSetJobForClientDomain:(id)domain byIdentifier:(id)identifier
{
  domainCopy = domain;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (domainCopy && identifierCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
    cancelingSetJobsByIdentifier = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
    v12 = [cancelingSetJobsByIdentifier safeObjectForKey:autoControlManagerFSM2 ofClass:objc_opt_class()];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    cancelingSetJobsByIdentifier = [autoControlManagerFSM2 diag];
    v13 = [NSString alloc];
    v14 = @"N";
    if (domainCopy)
    {
      v15 = domainCopy;
    }

    else
    {
      v15 = @"N";
    }

    if (identifierCopy)
    {
      v14 = identifierCopy;
    }

    v16 = [v13 initWithFormat:@"{locateCancelingSetJobForClientDomain} missing required | clientDomainName:%@ | assetSetIdentifier:%@", v15, v14];
    [cancelingSetJobsByIdentifier trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6102 withError:0];

    v12 = 0;
  }

  return v12;
}

- (id)locateSetStatusByInstance:(id)instance
{
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  currentSetStatusByInstance = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v8 = [currentSetStatusByInstance safeObjectForKey:instanceCopy ofClass:objc_opt_class()];

  if (v8)
  {
    clientDomainName = [v8 clientDomainName];
    assetSetIdentifier = [v8 assetSetIdentifier];
    v11 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    if (v11)
    {
      newerVersionError = [v11 newerVersionError];
      [v8 setNewerVersionError:newerVersionError];

      availableForUseError = [v11 availableForUseError];
      [v8 setAvailableForUseError:availableForUseError];
    }

    else
    {
      availableForUseError = v8;
      v8 = 0;
    }
  }

  return v8;
}

- (id)locateSetStatusForDomainName:(id)name byIdentifier:(id)identifier
{
  nameCopy = name;
  identifierCopy = identifier;
  v8 = nameCopy;
  v9 = identifierCopy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v33 = v9;
  v12 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v8 forAssetSetIdentifier:v9];
  v13 = v12;
  if (v12)
  {
    latestAtomicInstanceToVend = [v12 latestAtomicInstanceToVend];

    v32 = v8;
    if (latestAtomicInstanceToVend)
    {
      latestAtomicInstanceToVend2 = [v13 latestAtomicInstanceToVend];
      v31 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:latestAtomicInstanceToVend2];

      v8 = v32;
    }

    else
    {
      v30 = v13;
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetStatusForDomainName" ofContainer:@"currentSetStatusByInstance"];
      v37 = 0u;
      v38 = 0u;
      v35 = 0u;
      v36 = 0u;
      obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      v16 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
      if (v16)
      {
        v17 = v16;
        v31 = 0;
        v18 = *v36;
        do
        {
          for (i = 0; i != v17; i = i + 1)
          {
            if (*v36 != v18)
            {
              objc_enumerationMutation(obj);
            }

            v20 = *(*(&v35 + 1) + 8 * i);
            v21 = objc_autoreleasePoolPush();
            v22 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v20];
            clientDomainName = [v22 clientDomainName];
            if (([SUCore stringIsEqual:clientDomainName to:v8]& 1) != 0)
            {
              assetSetIdentifier = [v22 assetSetIdentifier];
              v25 = [SUCore stringIsEqual:assetSetIdentifier to:v33];

              if (v25)
              {
                if (v31)
                {
                  latestDownloadedAtomicInstance = [v31 latestDownloadedAtomicInstance];

                  if (!latestDownloadedAtomicInstance)
                  {
                    latestDownloadedAtomicInstance2 = [v22 latestDownloadedAtomicInstance];

                    if (latestDownloadedAtomicInstance2)
                    {
                      v28 = v22;

                      v31 = v28;
                    }
                  }
                }

                else
                {
                  v31 = v22;
                }
              }

              v8 = v32;
            }

            else
            {
            }

            objc_autoreleasePoolPop(v21);
          }

          v17 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
        }

        while (v17);
      }

      else
      {
        v31 = 0;
      }

      v13 = v30;
    }
  }

  else
  {
    v31 = 0;
  }

  return v31;
}

- (id)locateSetStatusPreferringByInstance:(id)instance elseByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier fromLocation:(id)location
{
  instanceCopy = instance;
  domainCopy = domain;
  identifierCopy = identifier;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:locateSetStatusPreferringByInstance", locationCopy];
  v17 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:instanceCopy];
  v18 = v17;
  if (identifierCopy && domainCopy && !v17)
  {
    v18 = [(MADAutoAssetControlManager *)self locateSetStatusForDomainName:domainCopy byIdentifier:identifierCopy];
  }

  if (!v18)
  {
    if (instanceCopy)
    {
      v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:instanceCopy requireExists:0];
      goto LABEL_29;
    }

    v20 = 0;
    v19 = 0;
    if (domainCopy && identifierCopy)
    {
      v21 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
      v20 = v21;
      if (v21)
      {
        latestAtomicInstanceToVend = [v21 latestAtomicInstanceToVend];

        if (latestAtomicInstanceToVend)
        {
          latestAtomicInstanceToVend2 = [v20 latestAtomicInstanceToVend];
          v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

          goto LABEL_28;
        }

        previouslyVendedLockedAtomicInstances = [v20 previouslyVendedLockedAtomicInstances];

        if (previouslyVendedLockedAtomicInstances)
        {
          v86 = 0u;
          v87 = 0u;
          v84 = 0u;
          v85 = 0u;
          previouslyVendedLockedAtomicInstances2 = [v20 previouslyVendedLockedAtomicInstances];
          v26 = [previouslyVendedLockedAtomicInstances2 copy];

          v27 = [v26 countByEnumeratingWithState:&v84 objects:v88 count:16];
          if (v27)
          {
            v28 = v27;
            v68 = locationCopy;
            v29 = domainCopy;
            v30 = *v85;
            while (2)
            {
              for (i = 0; i != v28; i = i + 1)
              {
                if (*v85 != v30)
                {
                  objc_enumerationMutation(v26);
                }

                v32 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:*(*(&v84 + 1) + 8 * i) requireExists:1];
                if (v32)
                {
                  v19 = v32;
                  goto LABEL_25;
                }
              }

              v28 = [v26 countByEnumeratingWithState:&v84 objects:v88 count:16];
              if (v28)
              {
                continue;
              }

              break;
            }

            v19 = 0;
LABEL_25:
            instanceCopy = 0;
            domainCopy = v29;
            locationCopy = v68;
          }

          else
          {
            v19 = 0;
          }

          goto LABEL_28;
        }
      }

      v19 = 0;
    }

LABEL_28:

LABEL_29:
    v18 = 0;
    if (identifierCopy && domainCopy && v19)
    {
      v73 = locationCopy;
      clientDomainName = [v19 clientDomainName];
      assetSetIdentifier = [v19 assetSetIdentifier];
      v35 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

      v36 = objc_alloc_init(MANAutoAssetSetNotifications);
      [(MANAutoAssetSetNotifications *)v36 setAtomicInstanceDiscovered:1];
      v83 = v36;
      [(MANAutoAssetSetNotifications *)v36 setAtomicInstanceAvailableForUse:1];
      latestAtomicInstanceToVend3 = [v35 latestAtomicInstanceToVend];

      v69 = locationCopy;
      if (latestAtomicInstanceToVend3)
      {
        latestAtomicInstanceToVend4 = [v35 latestAtomicInstanceToVend];
        v39 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v73 forAtomicInstanceUUID:latestAtomicInstanceToVend4 requireExists:1];

        if (v39)
        {
          latestDownloadedAtomicInstance = [v19 latestDownloadedAtomicInstance];
          latestDownloadedAtomicInstance2 = [v39 latestDownloadedAtomicInstance];
          v42 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestDownloadedAtomicInstance2];

          v43 = v42;
        }

        else
        {
          v43 = 0;
        }
      }

      else
      {
        v43 = 0;
      }

      v64 = [MANAutoAssetSetStatus alloc];
      clientDomainName2 = [v19 clientDomainName];
      assetSetIdentifier2 = [v19 assetSetIdentifier];
      v80 = [(MADAutoAssetControlManager *)self newAtomicInstancesDownloadedForDescriptor:v19];
      mostRecentlyReceivedCachedAssetSetID = [v35 mostRecentlyReceivedCachedAssetSetID];
      mostRecentlyReceivedDownloadedFromLive = [v35 mostRecentlyReceivedDownloadedFromLive];
      mostRecentlyReceivedLastTimeChecked = [v35 mostRecentlyReceivedLastTimeChecked];
      mostRecentlyReceivedPostedDate = [v35 mostRecentlyReceivedPostedDate];
      discoveredAtomicInstance = [v19 discoveredAtomicInstance];
      discoveredAtomicEntries = [v19 discoveredAtomicEntries];
      v67 = instanceCopy;
      v81 = assetSetIdentifier2;
      v82 = clientDomainName2;
      v65 = v43;
      if (v43)
      {
        latestDownloadedAtomicInstance3 = [v19 latestDownloadedAtomicInstance];
        latestAtomicInstanceToVendFromPreSUStaging = [v35 latestAtomicInstanceToVendFromPreSUStaging];
        latestDowloadedAtomicInstanceEntries = [v19 latestDowloadedAtomicInstanceEntries];
      }

      else
      {
        latestAtomicInstanceToVendFromPreSUStaging = [v35 latestAtomicInstanceToVendFromPreSUStaging];
        latestDowloadedAtomicInstanceEntries = 0;
        latestDownloadedAtomicInstance3 = 0;
      }

      latestToVendCachedAssetSetID = [v35 latestToVendCachedAssetSetID];
      latestToVendDownloadedFromLive = [v35 latestToVendDownloadedFromLive];
      latestToVendLastTimeChecked = [v35 latestToVendLastTimeChecked];
      latestToVendPostedDate = [v35 latestToVendPostedDate];
      v66 = domainCopy;
      v70 = identifierCopy;
      v58 = [MADAutoAssetScheduler newSetPolicyForDomainName:domainCopy forAssetSetIdentifier:identifierCopy];
      v55 = +[MADAutoAssetControlManager stagerSetPolicy];
      haveReceivedLookupResponse = [v35 haveReceivedLookupResponse];
      vendingAtomicInstanceForConfiguredEntries = [v35 vendingAtomicInstanceForConfiguredEntries];
      downloadUserInitiated = [v19 downloadUserInitiated];
      downloadedNetworkBytes = [v19 downloadedNetworkBytes];
      downloadedFilesystemBytes = [v19 downloadedFilesystemBytes];
      v56 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v19];
      availableForUseError = [v35 availableForUseError];
      newerVersionError = [v35 newerVersionError];
      BYTE2(v54) = downloadUserInitiated;
      BYTE1(v54) = vendingAtomicInstanceForConfiguredEntries;
      LOBYTE(v54) = haveReceivedLookupResponse;
      LOBYTE(v53) = latestAtomicInstanceToVendFromPreSUStaging;
      v18 = [MANAutoAssetSetStatus initStatusForClientDomain:v64 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v82 withAtomicInstancesDownloaded:v81 withCatalogCachedAssetSetID:0 withCatalogDownloadedFromLive:v80 withCatalogLastTimeChecked:mostRecentlyReceivedCachedAssetSetID withCatalogPostedDate:mostRecentlyReceivedDownloadedFromLive withNewerAtomicInstanceDiscovered:mostRecentlyReceivedLastTimeChecked withNewerDiscoveredAtomicEntries:mostRecentlyReceivedPostedDate withLatestDownloadedAtomicInstance:discoveredAtomicInstance withLatestDownloadedAtomicInstanceFromPreSUStaging:discoveredAtomicEntries withLatestDowloadedAtomicInstanceEntries:latestDownloadedAtomicInstance3 withDownloadedCatalogCachedAssetSetID:v53 withDownloadedCatalogDownloadedFromLive:latestDowloadedAtomicInstanceEntries withDownloadedCatalogLastTimeChecked:latestToVendCachedAssetSetID withDownloadedCatalogPostedDate:latestToVendDownloadedFromLive withCurrentNotifications:latestToVendLastTimeChecked withCurrentNeedPolicy:latestToVendPostedDate withSchedulerPolicy:v83 withStagerPolicy:0 havingReceivedLookupResponse:v58 vendingAtomicInstanceForConfiguredEntries:v55 withDownloadUserInitiated:v54 withDownloadProgress:0 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withCurrentLockUsage:v56 withSelectorsForStaging:0 withAvailableForUseError:availableForUseError withNewerVersionError:newerVersionError];

      if (v65)
      {
      }

      domainCopy = v66;
      instanceCopy = v67;
      locationCopy = v69;
      identifierCopy = v70;
      locationCopy = v73;
    }
  }

  return v18;
}

- (void)clearDownloadedFromSetStatus:(id)status forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  statusCopy = status;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v22 = statusCopy;
  statusCopy = [[NSString alloc] initWithFormat:@"%@:clearDownloadedFromSetStatus", statusCopy];
  [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v11 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v27;
    do
    {
      v14 = 0;
      do
      {
        if (*v27 != v13)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v26 + 1) + 8 * v14);
        v16 = objc_autoreleasePoolPush();
        v17 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v15];
        clientDomainName = [v17 clientDomainName];
        if (([SUCore stringIsEqual:clientDomainName to:nameCopy]& 1) != 0)
        {
          assetSetIdentifier = [v17 assetSetIdentifier];
          v20 = [SUCore stringIsEqual:assetSetIdentifier to:identifierCopy];

          if (v20)
          {
            [v17 setAtomicInstancesDownloaded:0];
            [v17 setLatestDownloadedAtomicInstance:0];
            [v17 setLatestDowloadedAtomicInstanceEntries:0];
            [v17 setCurrentLockUsage:0];
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v16);
        v14 = v14 + 1;
      }

      while (v12 != v14);
      v12 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v12);
  }
}

- (id)newAtomicInstancesDownloadedForDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance)
  {
    latestDownloadedAtomicInstance = objc_alloc_init(NSMutableArray);
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    [latestDownloadedAtomicInstance addObject:latestDownloadedAtomicInstance2];
  }

  return latestDownloadedAtomicInstance;
}

- (id)locateSetConfigurationByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [knownSetConfigurationsByIdentifier safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)locateSetLookupResultSatisfying:(id)satisfying
{
  satisfyingCopy = satisfying;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetLookupResultSatisfying" ofContainer:@"stagedSetLookupResults"];
  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  obj = [(MADAutoAssetControlManager *)self stagedSetLookupResults];
  v30 = [obj countByEnumeratingWithState:&v50 objects:v56 count:16];
  if (!v30)
  {
LABEL_30:
    v25 = 0;
    goto LABEL_32;
  }

  v29 = *v51;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
LABEL_3:
  v7 = 0;
  while (1)
  {
    if (*v51 != v29)
    {
      objc_enumerationMutation(obj);
    }

    v8 = *(*(&v50 + 1) + 8 * v7);
    v9 = objc_autoreleasePoolPush();
    v36 = v8;
    if (!v8)
    {
      goto LABEL_28;
    }

    v31 = v7;
    context = v9;
    v48 = 0u;
    v49 = 0u;
    v46 = 0u;
    v47 = 0u;
    v33 = satisfyingCopy;
    v34 = [v33 countByEnumeratingWithState:&v46 objects:v55 count:16];
    if (!v34)
    {
      goto LABEL_31;
    }

    v35 = *v47;
LABEL_9:
    v10 = 0;
LABEL_10:
    if (*v47 != v35)
    {
      objc_enumerationMutation(v33);
    }

    v37 = v10;
    v11 = *(*(&v46 + 1) + 8 * v10);
    v42 = 0u;
    v43 = 0u;
    v44 = 0u;
    v45 = 0u;
    requestedAutoAssetEntries = [v36 requestedAutoAssetEntries];
    v41 = [requestedAutoAssetEntries countByEnumeratingWithState:&v42 objects:v54 count:16];
    if (v41)
    {
      break;
    }

LABEL_27:

    v7 = v31;
    v9 = context;
LABEL_28:
    objc_autoreleasePoolPop(v9);
    if (++v7 == v30)
    {
      v30 = [obj countByEnumeratingWithState:&v50 objects:v56 count:16];
      if (!v30)
      {
        goto LABEL_30;
      }

      goto LABEL_3;
    }
  }

  v12 = *v43;
  v38 = v11;
LABEL_14:
  v13 = 0;
  while (1)
  {
    if (*v43 != v12)
    {
      objc_enumerationMutation(requestedAutoAssetEntries);
    }

    v14 = *(*(&v42 + 1) + 8 * v13);
    v15 = p_weak_ivar_lyt[223];
    assetSelector = [v14 assetSelector];
    assetType = [assetSelector assetType];
    assetSelector2 = [v11 assetSelector];
    assetType2 = [assetSelector2 assetType];
    if (![v15 stringIsEqual:assetType to:assetType2])
    {

      goto LABEL_21;
    }

    v40 = p_weak_ivar_lyt[223];
    assetSelector3 = [v14 assetSelector];
    assetSpecifier = [assetSelector3 assetSpecifier];
    assetSelector4 = [v11 assetSelector];
    [assetSelector4 assetSpecifier];
    v24 = v23 = v12;
    LOBYTE(v40) = [v40 stringIsEqual:assetSpecifier to:v24];

    v12 = v23;
    v11 = v38;

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    if (v40)
    {
      break;
    }

LABEL_21:
    if (v41 == ++v13)
    {
      v41 = [requestedAutoAssetEntries countByEnumeratingWithState:&v42 objects:v54 count:16];
      if (v41)
      {
        goto LABEL_14;
      }

      goto LABEL_27;
    }
  }

  v10 = v37 + 1;
  if ((v37 + 1) != v34)
  {
    goto LABEL_10;
  }

  v34 = [v33 countByEnumeratingWithState:&v46 objects:v55 count:16];
  if (v34)
  {
    goto LABEL_9;
  }

LABEL_31:

  v25 = v36;
  objc_autoreleasePoolPop(context);
LABEL_32:

  return v25;
}

- (id)locateNewAllSetConfigurations
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v6 = [persistedKnownSetConfigurations persistedEntryIDs:@"locateNewAllSetConfigurations"];

  v7 = objc_alloc_init(NSMutableArray);
  if ([v6 count])
  {
    v21 = v7;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateNewAllSetConfigurations" ofContainer:@"persistedKnownSetConfigurations"];
    v25 = 0u;
    v26 = 0u;
    v23 = 0u;
    v24 = 0u;
    v20 = v6;
    obj = v6;
    v8 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v24;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v24 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v23 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v15 = [persistedKnownSetConfigurations2 persistedEntry:v12 fromLocation:@"locateNewAllSetConfigurations"];

          if (v15)
          {
            persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            v17 = [persistedKnownSetConfigurations3 decodeFromLocation:@"locateNewAllSetConfigurations" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              [v21 addObject:v17];
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v28 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateNewAllSetConfigurations} | no set-configuration entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v28 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateNewAllSetConfigurations} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
      }

      while (v9);
    }

    v6 = v20;
    v7 = v21;
  }

  if (![v7 count])
  {

    v7 = 0;
  }

  return v7;
}

- (BOOL)isAtomicEntry:(id)entry desiredForAutoAssetSetEntries:(id)entries
{
  entryCopy = entry;
  entriesCopy = entries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!entryCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = diag;
    v26 = @"{isAtomicEntry:desiredForAutoAssetSetEntries} nil atomic-entry provided";
LABEL_18:
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6102 withError:0];

    v27 = 0;
    goto LABEL_22;
  }

  if (!entriesCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = diag;
    v26 = @"{isAtomicEntry:desiredForAutoAssetSetEntries} nil auto-asset-set-entries provided";
    goto LABEL_18;
  }

  v37 = 0u;
  v38 = 0u;
  v35 = 0u;
  v36 = 0u;
  obj = entriesCopy;
  v10 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
  if (v10)
  {
    v11 = v10;
    v29 = entriesCopy;
    v12 = *v36;
    v30 = *v36;
    do
    {
      v13 = 0;
      v31 = v11;
      do
      {
        if (*v36 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v35 + 1) + 8 * v13);
        if (v14)
        {
          assetSelector = [*(*(&v35 + 1) + 8 * v13) assetSelector];
          assetType = [assetSelector assetType];
          fullAssetSelector = [entryCopy fullAssetSelector];
          assetType2 = [fullAssetSelector assetType];
          if ([SUCore stringIsEqual:assetType to:assetType2])
          {
            assetSelector2 = [v14 assetSelector];
            assetSpecifier = [assetSelector2 assetSpecifier];
            fullAssetSelector2 = [entryCopy fullAssetSelector];
            [fullAssetSelector2 assetSpecifier];
            v22 = v21 = entryCopy;
            v33 = [SUCore stringIsEqual:assetSpecifier to:v22];

            entryCopy = v21;
            v11 = v31;

            v12 = v30;
            if (v33)
            {
              v27 = 1;
              goto LABEL_19;
            }
          }

          else
          {
          }
        }

        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v35 objects:v39 count:16];
    }

    while (v11);
    v27 = 0;
LABEL_19:
    entriesCopy = v29;
  }

  else
  {
    v27 = 0;
  }

LABEL_22:
  return v27;
}

- (id)newSetTargetFromClientProvidedSetTarget:(id)target forClientDomainName:(id)name forSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  nameCopy = name;
  targetCopy = target;
  v10 = [MADAutoSetTarget alloc];
  minTargetOSVersion = [targetCopy minTargetOSVersion];
  maxTargetOSVersion = [targetCopy maxTargetOSVersion];
  autoAssetEntries = [targetCopy autoAssetEntries];

  v14 = [(MADAutoSetTarget *)v10 initForClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy fromMinTargetOSVersion:minTargetOSVersion toMaxTargetOSVersion:maxTargetOSVersion asEntriesWhenTargeting:autoAssetEntries];
  return v14;
}

- (id)locateNewAllSetTargets
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v6 = [persistedSetTargets persistedEntryIDs:@"locateNewAllSetTargets"];

  v7 = objc_alloc_init(NSMutableArray);
  if ([v6 count])
  {
    v21 = v7;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateNewAllSetTargets" ofContainer:@"persistedSetTargets"];
    v25 = 0u;
    v26 = 0u;
    v23 = 0u;
    v24 = 0u;
    v20 = v6;
    obj = v6;
    v8 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v24;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v24 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v23 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v15 = [persistedSetTargets2 persistedEntry:v12 fromLocation:@"locateNewAllSetTargets"];

          if (v15)
          {
            persistedSetTargets3 = [(MADAutoAssetControlManager *)self persistedSetTargets];
            v17 = [persistedSetTargets3 decodeFromLocation:@"locateNewAllSetTargets" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              [v21 addObject:v17];
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v28 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateNewAllSetTargets} | no set-target entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v28 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateNewAllSetTargets} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v23 objects:v29 count:16];
      }

      while (v9);
    }

    v6 = v20;
    v7 = v21;
  }

  if (![v7 count])
  {

    v7 = 0;
  }

  return v7;
}

- (BOOL)setTargetEntries:(id)entries matchSetConfiguration:(id)configuration
{
  entriesCopy = entries;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetEntries = [entriesCopy autoAssetEntries];
  v11 = [autoAssetEntries count];
  v40 = configurationCopy;
  autoAssetEntries2 = [configurationCopy autoAssetEntries];
  v13 = [autoAssetEntries2 count];

  if (v11 == v13)
  {
    v38 = objc_alloc_init(NSMutableDictionary);
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v54 = 0u;
    v36 = entriesCopy;
    obj = [entriesCopy autoAssetEntries];
    v41 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
    if (v41)
    {
      v39 = *v52;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      do
      {
        v15 = 0;
        do
        {
          if (*v52 != v39)
          {
            objc_enumerationMutation(obj);
          }

          v42 = v15;
          v16 = *(*(&v51 + 1) + 8 * v15);
          v47 = 0u;
          v48 = 0u;
          v49 = 0u;
          v50 = 0u;
          autoAssetEntries3 = [v40 autoAssetEntries];
          v46 = [autoAssetEntries3 countByEnumeratingWithState:&v47 objects:v55 count:16];
          if (v46)
          {
            v17 = *v48;
            v43 = v16;
            do
            {
              for (i = 0; i != v46; i = i + 1)
              {
                if (*v48 != v17)
                {
                  objc_enumerationMutation(autoAssetEntries3);
                }

                v19 = *(*(&v47 + 1) + 8 * i);
                v20 = p_weak_ivar_lyt[223];
                assetSelector = [v19 assetSelector];
                assetType = [assetSelector assetType];
                assetSelector2 = [v16 assetSelector];
                assetType2 = [assetSelector2 assetType];
                if ([v20 stringIsEqual:assetType to:assetType2])
                {
                  v45 = p_weak_ivar_lyt[223];
                  assetSelector3 = [v19 assetSelector];
                  assetSpecifier = [assetSelector3 assetSpecifier];
                  assetSelector4 = [v16 assetSelector];
                  [assetSelector4 assetSpecifier];
                  v29 = v28 = v17;
                  LODWORD(v45) = [v45 stringIsEqual:assetSpecifier to:v29];

                  v17 = v28;
                  v16 = v43;

                  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                  if (v45)
                  {
                    assetSelector5 = [v43 assetSelector];
                    persistedEntryID = [assetSelector5 persistedEntryID];
                    [v38 setSafeObject:v43 forKey:persistedEntryID];

                    goto LABEL_18;
                  }
                }

                else
                {
                }
              }

              v46 = [autoAssetEntries3 countByEnumeratingWithState:&v47 objects:v55 count:16];
            }

            while (v46);
          }

LABEL_18:

          v15 = v42 + 1;
        }

        while ((v42 + 1) != v41);
        v41 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
      }

      while (v41);
    }

    v32 = [v38 count];
    entriesCopy = v36;
    autoAssetEntries4 = [v36 autoAssetEntries];
    v34 = v32 == [autoAssetEntries4 count];
  }

  else
  {
    v34 = 0;
  }

  return v34;
}

- (void)removeSetTargetsForClientDomain:(id)domain forSetIdentifier:(id)identifier fromLocation:(id)location
{
  domainCopy = domain;
  identifierCopy = identifier;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v48 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:removeSetTargetsForClientDomain", locationCopy];
  selfCopy = self;
  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v55 = locationCopy;
  v13 = [persistedSetTargets persistedEntryIDs:locationCopy];

  if ([v13 count])
  {
    v46 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:v55 ofContainer:@"persistedSetTargets"];
    v62 = 0u;
    v63 = 0u;
    v60 = 0u;
    v61 = 0u;
    v45 = v13;
    obj = v13;
    v14 = [obj countByEnumeratingWithState:&v60 objects:v69 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = *v61;
      v49 = *v61;
      do
      {
        v17 = 0;
        v51 = v15;
        do
        {
          if (*v61 != v16)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v60 + 1) + 8 * v17);
          v19 = objc_autoreleasePoolPush();
          persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v21 = [persistedSetTargets2 persistedEntry:v18 fromLocation:v55];

          if (v18)
          {
            v22 = v21 == 0;
          }

          else
          {
            v22 = 1;
          }

          if (v22)
          {
            v25 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              v23 = @"N";
              if (v18)
              {
                v23 = v18;
              }

              v66 = v55;
              v67 = 2114;
              v68 = v23;
              _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to determine previous set-target for entry:%{public}@", buf, 0x16u);
            }
          }

          else
          {
            persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v25 = [persistedKnownDescriptors decodeFromLocation:v55 ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v25)
            {
              clientDomainName = [v25 clientDomainName];
              if (([SUCore stringIsEqual:domainCopy to:clientDomainName]& 1) != 0)
              {
                assetSetIdentifier = [v25 assetSetIdentifier];
                v28 = [SUCore stringIsEqual:identifierCopy to:assetSetIdentifier];

                if (v28)
                {
                  [v46 addObject:v18];
                }

                v15 = v51;
                v16 = v49;
              }

              else
              {

                v15 = v51;
                v16 = v49;
              }
            }

            else
            {
              v29 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v66 = v55;
                v67 = 2114;
                v68 = v18;
                _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "{%{public}@} | no set-target entry found for entry:%{public}@", buf, 0x16u);
              }
            }
          }

          objc_autoreleasePoolPop(v19);
          v17 = v17 + 1;
        }

        while (v15 != v17);
        v15 = [obj countByEnumeratingWithState:&v60 objects:v69 count:16];
      }

      while (v15);
    }

    v58 = 0u;
    v59 = 0u;
    v56 = 0u;
    v57 = 0u;
    v30 = v46;
    v31 = [v30 countByEnumeratingWithState:&v56 objects:v64 count:16];
    if (v31)
    {
      v32 = v31;
      v33 = *v57;
      do
      {
        v34 = 0;
        obja = v32;
        do
        {
          if (*v57 != v33)
          {
            objc_enumerationMutation(v30);
          }

          v35 = *(*(&v56 + 1) + 8 * v34);
          v36 = objc_autoreleasePoolPush();
          if (v35)
          {
            persistedSetTargets3 = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
            v38 = [persistedSetTargets3 persistedEntry:v35 fromLocation:v55];

            if (v38)
            {
              persistedSetTargets4 = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
              v40 = [persistedSetTargets4 decodeFromLocation:v55 ofEntryName:v35 fromPersistedEntry:v38 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

              if (v40)
              {
                persistedSetTargets5 = [(MADAutoAssetControlManager *)selfCopy persistedSetTargets];
                [persistedSetTargets5 removePersistedEntry:v35 fromLocation:v55];

                v42 = [NSString alloc];
                summary = [v40 summary];
                v44 = [v42 initWithFormat:@"removed previously defined set-target | setTarget:%@", summary];
                v32 = obja;
                [(MADAutoAssetControlManager *)selfCopy _logPersistedSetTargetRemoved:v48 removedPersistedEntryID:v35 removedSetTarget:v40 message:v44];
              }
            }

            else
            {
              v40 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v66 = v55;
                v67 = 2114;
                v68 = v35;
                _os_log_impl(&dword_0, v40, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to re-load set-target for entry:%{public}@", buf, 0x16u);
              }
            }
          }

          objc_autoreleasePoolPop(v36);
          v34 = v34 + 1;
        }

        while (v32 != v34);
        v32 = [v30 countByEnumeratingWithState:&v56 objects:v64 count:16];
      }

      while (v32);
    }

    v13 = v45;
  }
}

- (id)locateSetAtomicInstanceByInstanceUUID:(id)d
{
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    v8 = [knownSetAtomicInstancesByInstance safeObjectForKey:dCopy ofClass:objc_opt_class()];
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)isAtomicInstanceForCurrentSetJob:(id)job
{
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [jobCopy clientDomainName];
  assetSetIdentifier = [jobCopy assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  discoveredInFlightAtomicInstance = [v9 discoveredInFlightAtomicInstance];
  atomicInstanceUUID = [jobCopy atomicInstanceUUID];

  LOBYTE(jobCopy) = [SUCore stringIsEqual:discoveredInFlightAtomicInstance to:atomicInstanceUUID];
  return jobCopy;
}

- (BOOL)isAtomicInstanceLatestToVendForSet:(id)set
{
  setCopy = set;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [setCopy clientDomainName];
  assetSetIdentifier = [setCopy assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  latestAtomicInstanceToVend = [v9 latestAtomicInstanceToVend];
  atomicInstanceUUID = [setCopy atomicInstanceUUID];

  LOBYTE(setCopy) = [SUCore stringIsEqual:latestAtomicInstanceToVend to:atomicInstanceUUID];
  return setCopy;
}

- (id)setDescriptorWalkKeys
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  allKeys = [knownSetAtomicInstancesByInstance allKeys];
  v7 = [allKeys copy];

  return v7;
}

- (id)setDescriptorWalkKeysForClientDomainName:(id)name assetSetIdentifier:(id)identifier
{
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v26 = objc_alloc_init(NSMutableArray);
  v31 = 0u;
  v32 = 0u;
  v33 = 0u;
  v34 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v8 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v32;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v12 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v13 = 0;
      v28 = v9;
      do
      {
        if (*v32 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v31 + 1) + 8 * v13);
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v16 = [knownSetAtomicInstancesByInstance safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v16)
        {
          v17 = v12[223];
          clientDomainName = [v16 clientDomainName];
          if ([v17 stringIsEqual:clientDomainName to:nameCopy])
          {
            v19 = v12[223];
            [v16 assetSetIdentifier];
            v20 = v10;
            selfCopy = self;
            v22 = p_weak_ivar_lyt;
            v24 = v23 = v12;
            LODWORD(v19) = [v19 stringIsEqual:v24 to:identifierCopy];

            v12 = v23;
            p_weak_ivar_lyt = v22;
            self = selfCopy;
            v10 = v20;
            v9 = v28;

            if (v19)
            {
              [v26 addObject:v14];
            }
          }

          else
          {
          }
        }

        v13 = v13 + 1;
      }

      while (v9 != v13);
      v9 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    }

    while (v9);
  }

  return v26;
}

- (id)setDescriptorWalkLocate:(id)locate forKey:(id)key
{
  locateCopy = locate;
  keyCopy = key;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v11 = [knownSetAtomicInstancesByInstance safeObjectForKey:keyCopy ofClass:objc_opt_class()];

  if (!v11)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    keyCopy = [[NSString alloc] initWithFormat:@"{%@} corrupted known-set-atomic-instances container - unable to load key | setDescriptorWalkKey:%@", locateCopy, keyCopy];
    [diag trackAnomaly:@"KNOWN-ATOMIC-INSTANCES" forReason:keyCopy withResult:6103 withError:0];
    goto LABEL_6;
  }

  atomicInstanceUUID = [v11 atomicInstanceUUID];
  v13 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locateCopy forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

  if (v13)
  {
    goto LABEL_8;
  }

  usageStatus = [v11 usageStatus];
  v15 = [SUCore stringIsEqual:usageStatus to:@"UNTRACKED"];

  if ((v15 & 1) == 0)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v18 = [NSString alloc];
    keyCopy = [v11 summary];
    v20 = [v18 initWithFormat:@"{%@} set-atomic-instance without set-descriptor | setAtomicInstance:%@", locateCopy, keyCopy];
    [diag trackAnomaly:@"KNOWN-ATOMIC-INSTANCES" forReason:v20 withResult:6111 withError:0];

LABEL_6:
  }

  v13 = 0;
LABEL_8:

  return v13;
}

- (void)persistSetDescriptorActiveJob:(id)job fromLocation:(id)location
{
  jobCopy = job;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [jobCopy clientDomainName];
  assetSetIdentifier = [jobCopy assetSetIdentifier];
  v11 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  LODWORD(assetSetIdentifier) = [persistedActiveJobSetDescriptors persistedEntryAlreadyExists:v11 fromLocation:locationCopy];

  persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v14 = [persistedActiveJobSetDescriptors2 persistedEntry:v11 fromLocation:locationCopy];

  if (assetSetIdentifier)
  {
    v15 = @"ENTRY_MODIFY";
  }

  else
  {
    v15 = @"ENTRY_ADD";
  }

  [v14 persistSecureCodedObject:jobCopy forKey:@"assetSetDescriptor"];
  persistedActiveJobSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  summary = [jobCopy summary];
  [persistedActiveJobSetDescriptors3 storePersistedEntry:v11 withEntrySummary:summary fromLocation:locationCopy];

  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:locationCopy forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" operation:v15 forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withSetDescriptor:jobCopy message:@"maintaining active set-job status"];
}

- (void)persistSetDescriptorDownloadedJob:(id)job fromLocation:(id)location
{
  jobCopy = job;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:persistSetDescriptorDownloadedJob", locationCopy];
  v10 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:jobCopy];
  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v12 = [persistedDownloadedSetDescriptors persistedEntryAlreadyExists:v10 fromLocation:locationCopy];

  persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v14 = [persistedDownloadedSetDescriptors2 persistedEntry:v10 fromLocation:locationCopy];

  if (v12)
  {
    v15 = @"ENTRY_MODIFY";
  }

  else
  {
    v15 = @"ENTRY_ADD";
  }

  [v14 persistSecureCodedObject:jobCopy forKey:@"assetSetDescriptor"];
  persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  summary = [jobCopy summary];
  [persistedDownloadedSetDescriptors3 storePersistedEntry:v10 withEntrySummary:summary fromLocation:locationCopy];

  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:locationCopy forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:v15 forPersistedEntryID:v10 forClientRequest:0 withJobUUID:0 withSetDescriptor:jobCopy message:@"maintaining downloaded set-descriptors"];
}

- (id)newSetDescriptorFromAlreadyDownloaded:(id)downloaded forSetInfoInstance:(id)instance fromDownloadedSetDescriptor:(id)descriptor forAtomicInstance:(id)atomicInstance
{
  downloadedCopy = downloaded;
  instanceCopy = instance;
  descriptorCopy = descriptor;
  atomicInstanceCopy = atomicInstance;
  autoAssetEntries = [instanceCopy autoAssetEntries];
  v14 = objc_alloc_init(NSMutableDictionary);
  v67 = objc_alloc_init(NSMutableArray);
  v68 = v14;
  if (autoAssetEntries && [autoAssetEntries count])
  {
    v65 = atomicInstanceCopy;
    v66 = instanceCopy;
    v71 = downloadedCopy;
    v77 = 0u;
    v78 = 0u;
    v75 = 0u;
    v76 = 0u;
    v64 = autoAssetEntries;
    obj = autoAssetEntries;
    selfCopy2 = self;
    v74 = [obj countByEnumeratingWithState:&v75 objects:v85 count:16];
    if (v74)
    {
      v73 = *v76;
      do
      {
        for (i = 0; i != v74; i = i + 1)
        {
          if (*v76 != v73)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v75 + 1) + 8 * i);
          assetSelector = [v17 assetSelector];
          assetType = [assetSelector assetType];
          assetSelector2 = [v17 assetSelector];
          assetSpecifier = [assetSelector2 assetSpecifier];
          v22 = [(MADAutoAssetControlManager *)selfCopy2 findAtomicEntryForAssetType:assetType forAssetSpecifier:assetSpecifier representedByDescriptor:descriptorCopy];

          if (v22)
          {
            fullAssetSelector = [v22 fullAssetSelector];
            persistedEntryID = [fullAssetSelector persistedEntryID];

            diag2 = [v14 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];
            if (diag2)
            {
              autoControlManagerFSM = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
              diag = [autoControlManagerFSM diag];
              v27 = [NSString alloc];
              summary = [v22 summary];
              summary2 = [v17 summary];
              [descriptorCopy summary];
              v31 = v30 = descriptorCopy;
              v32 = [v27 initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} duplicate nextAtomicEntry ignored | nextAtomicEntry:%@ | setInfoInstance:%@, newSetDescriptor:%@", v71, summary, summary2, v31];
              [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v32 withResult:6109 withError:0];

              selfCopy2 = self;
              descriptorCopy = v30;

              v14 = v68;
            }

            else
            {
              [v14 setSafeObject:v22 forKey:persistedEntryID];
              [v67 addObject:v22];
            }
          }

          else
          {
            persistedEntryID = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
            diag2 = [persistedEntryID diag];
            v33 = [NSString alloc];
            summary3 = [v17 summary];
            summary4 = [descriptorCopy summary];
            v36 = [v33 initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} no nextAtomicEntry | nextSetEntry:%@ | alreadyDownloadedSetDescriptor:%@", v71, summary3, summary4];
            [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v36 withResult:6101 withError:0];
          }
        }

        v74 = [obj countByEnumeratingWithState:&v75 objects:v85 count:16];
      }

      while (v74);
    }

    v37 = [MADAutoSetDescriptor alloc];
    instanceCopy = v66;
    clientDomainName = [v66 clientDomainName];
    assetSetIdentifier = [v66 assetSetIdentifier];
    atomicInstanceCopy = v65;
    atomicInstanceUUID = [v65 atomicInstanceUUID];
    v41 = [(MADAutoSetDescriptor *)v37 initForClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier withDiscoveredAtomicInstance:atomicInstanceUUID withDiscoveredAtomicEntries:v67];

    catalogCachedAssetSetID = [descriptorCopy catalogCachedAssetSetID];
    [v41 setCatalogCachedAssetSetID:catalogCachedAssetSetID];

    catalogDownloadedFromLive = [descriptorCopy catalogDownloadedFromLive];
    [v41 setCatalogDownloadedFromLive:catalogDownloadedFromLive];

    catalogLastTimeChecked = [descriptorCopy catalogLastTimeChecked];
    [v41 setCatalogLastTimeChecked:catalogLastTimeChecked];

    catalogPostedDate = [descriptorCopy catalogPostedDate];
    [v41 setCatalogPostedDate:catalogPostedDate];

    downloadedCatalogCachedAssetSetID = [descriptorCopy downloadedCatalogCachedAssetSetID];
    [v41 setDownloadedCatalogCachedAssetSetID:downloadedCatalogCachedAssetSetID];

    downloadedCatalogDownloadedFromLive = [descriptorCopy downloadedCatalogDownloadedFromLive];
    [v41 setDownloadedCatalogDownloadedFromLive:downloadedCatalogDownloadedFromLive];

    downloadedCatalogLastTimeChecked = [descriptorCopy downloadedCatalogLastTimeChecked];
    [v41 setDownloadedCatalogLastTimeChecked:downloadedCatalogLastTimeChecked];

    downloadedCatalogPostedDate = [descriptorCopy downloadedCatalogPostedDate];
    [v41 setDownloadedCatalogPostedDate:downloadedCatalogPostedDate];

    [v41 setRequestedAutoAssetEntries:obj];
    atomicInstanceUUID2 = [v65 atomicInstanceUUID];
    [v41 setLatestDownloadedAtomicInstance:atomicInstanceUUID2];

    [v41 setLatestDowloadedAtomicInstanceEntries:v67];
    [v41 setIsOnFilesystem:1];
    [v41 setIsDiscoveredFullyDownloaded:1];
    [v41 setAtomicInstanceDownloadedNotified:1];
    [v41 setNeverBeenLocked:1];
    latestDownloadedAtomicInstance = [v41 latestDownloadedAtomicInstance];
    autoAssetSetClientName = [v66 autoAssetSetClientName];
    LOBYTE(v63) = 0;
    BYTE2(v62) = 1;
    LOWORD(v62) = 0;
    downloadedCopy = v71;
    [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v41 forLatestDownloaded:v71 forSpecificAtomicInstance:1 withCurrentSetStatus:latestDownloadedAtomicInstance changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v62 latestToVend:355 historyOperation:autoAssetSetClientName firstClientName:v63 fromPreSUStaging:?];

    [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:v71 forSetDescriptor:v41];
    v53 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary5 = [v66 summary];
      summary6 = [v41 summary];
      *buf = 138543874;
      v80 = _updateLatestSummary;
      v81 = 2114;
      v82 = summary5;
      v83 = 2114;
      v84 = summary6;
      _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {newSetDescriptorFromAlreadyDownloaded}\n[VEND] new set-descriptor from already downloaded | setInfoInstance:%{public}@, newSetDescriptor:%{public}@", buf, 0x20u);
    }

    v57 = v64;
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    [autoControlManagerFSM2 diag];
    v59 = v57 = autoAssetEntries;
    instanceCopy = [[NSString alloc] initWithFormat:@"{%@:newSetDescriptorFromAlreadyDownloaded} no autoAssetEntries provided by client when required | setInfoInstance:%@", downloadedCopy, instanceCopy];
    [v59 trackAnomaly:@"AUTO-SET-CONTROL" forReason:instanceCopy withResult:6102 withError:0];

    v41 = 0;
  }

  return v41;
}

- (BOOL)doesSetDescriptor:(id)descriptor coverRequestedAutoAssetEntries:(id)entries
{
  descriptorCopy = descriptor;
  entriesCopy = entries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  firstAssetType = [descriptorCopy firstAssetType];
  selfCopy = self;
  v11 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:entriesCopy];
  LODWORD(autoControlManagerFSM) = [SUCore stringIsEqual:firstAssetType to:v11];

  if (!autoControlManagerFSM)
  {
    goto LABEL_27;
  }

  v44 = objc_alloc_init(NSMutableDictionary);
  requestedAutoAssetEntries = [descriptorCopy requestedAutoAssetEntries];

  if (!requestedAutoAssetEntries)
  {
    goto LABEL_26;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v37 = entriesCopy;
  obj = entriesCopy;
  v42 = [obj countByEnumeratingWithState:&v54 objects:v59 count:16];
  if (!v42)
  {
    goto LABEL_25;
  }

  v40 = *v55;
  v41 = descriptorCopy;
  do
  {
    v14 = 0;
    do
    {
      if (*v55 != v40)
      {
        objc_enumerationMutation(obj);
      }

      v43 = v14;
      v15 = *(*(&v54 + 1) + 8 * v14);
      v50 = 0u;
      v51 = 0u;
      v52 = 0u;
      v53 = 0u;
      requestedAutoAssetEntries2 = [descriptorCopy requestedAutoAssetEntries];
      v49 = [requestedAutoAssetEntries2 countByEnumeratingWithState:&v50 objects:v58 count:16];
      if (!v49)
      {
        goto LABEL_23;
      }

      v16 = *v51;
      v45 = *v51;
      while (2)
      {
        for (i = 0; i != v49; i = i + 1)
        {
          if (*v51 != v16)
          {
            objc_enumerationMutation(requestedAutoAssetEntries2);
          }

          v18 = *(*(&v50 + 1) + 8 * i);
          v19 = p_weak_ivar_lyt[223];
          assetSelector = [v15 assetSelector];
          assetType = [assetSelector assetType];
          assetSelector2 = [v18 assetSelector];
          assetType2 = [assetSelector2 assetType];
          if ([v19 stringIsEqual:assetType to:assetType2])
          {
            v48 = p_weak_ivar_lyt[223];
            assetSelector3 = [v15 assetSelector];
            assetSpecifier = [assetSelector3 assetSpecifier];
            v47 = v18;
            [v18 assetSelector];
            v27 = v26 = v15;
            assetSpecifier2 = [v27 assetSpecifier];
            LODWORD(v48) = [v48 stringIsEqual:assetSpecifier to:assetSpecifier2];

            v15 = v26;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

            v16 = v45;
            if (!v48)
            {
              continue;
            }

            assetSelector4 = [v47 assetSelector];
            assetSelector = [assetSelector4 persistedEntryID];

            if (!assetSelector)
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v32 = [NSString alloc];
              assetSelector5 = [v47 assetSelector];
              summary = [assetSelector5 summary];
              v35 = [v32 initWithFormat:@"{doesSetDescriptor:coverRequestedAutoAssetEntries:} unable to form foundSelectorKey | fullAssetSelector:%@", summary];
              [diag trackAnomaly:@"AUTO-CONTROL" forReason:v35 withResult:6101 withError:0];

              goto LABEL_23;
            }

            [v44 setSafeObject:assetSelector forKey:assetSelector];
          }

          else
          {
          }
        }

        v49 = [requestedAutoAssetEntries2 countByEnumeratingWithState:&v50 objects:v58 count:16];
        if (v49)
        {
          continue;
        }

        break;
      }

LABEL_23:

      v14 = v43 + 1;
      descriptorCopy = v41;
    }

    while ((v43 + 1) != v42);
    v42 = [obj countByEnumeratingWithState:&v54 objects:v59 count:16];
  }

  while (v42);
LABEL_25:

  entriesCopy = v37;
LABEL_26:
  autoControlManagerFSM = [v44 count];
  LOBYTE(autoControlManagerFSM) = autoControlManagerFSM == [entriesCopy count];

LABEL_27:
  return autoControlManagerFSM;
}

- (BOOL)doesSetDescriptor:(id)descriptor referenceAssetDescriptor:(id)assetDescriptor
{
  descriptorCopy = descriptor;
  assetDescriptorCopy = assetDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptor:referenceAssetDescriptor:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  v26 = descriptorCopy;
  obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v9 = [obj countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (!v9)
  {
    v24 = 0;
    v12 = assetDescriptorCopy;
    goto LABEL_16;
  }

  v10 = v9;
  v11 = *v34;
  v12 = assetDescriptorCopy;
  v28 = *v34;
  do
  {
    v13 = 0;
    v29 = v10;
    do
    {
      if (*v34 != v11)
      {
        objc_enumerationMutation(obj);
      }

      v14 = *(*(&v33 + 1) + 8 * v13);
      assetType = [v12 assetType];
      fullAssetSelector = [v14 fullAssetSelector];
      assetType2 = [fullAssetSelector assetType];
      if (![SUCore stringIsEqual:assetType to:assetType2])
      {
        goto LABEL_11;
      }

      assetSpecifier = [v12 assetSpecifier];
      fullAssetSelector2 = [v14 fullAssetSelector];
      assetSpecifier2 = [fullAssetSelector2 assetSpecifier];
      v32 = assetSpecifier;
      if (![SUCore stringIsEqual:assetSpecifier to:assetSpecifier2])
      {

        v11 = v28;
        v10 = v29;
        v12 = assetDescriptorCopy;
LABEL_11:

        goto LABEL_12;
      }

      assetVersion = [assetDescriptorCopy assetVersion];
      fullAssetSelector3 = [v14 fullAssetSelector];
      assetVersion2 = [fullAssetSelector3 assetVersion];
      v27 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

      v12 = assetDescriptorCopy;
      v11 = v28;
      v10 = v29;
      if (v27)
      {
        v24 = 1;
        goto LABEL_16;
      }

LABEL_12:
      v13 = v13 + 1;
    }

    while (v10 != v13);
    v10 = [obj countByEnumeratingWithState:&v33 objects:v37 count:16];
  }

  while (v10);
  v24 = 0;
LABEL_16:

  return v24;
}

- (BOOL)doesSetDescriptorWithoutVersion:(id)version referenceAssetDescriptor:(id)descriptor
{
  versionCopy = version;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorWithoutVersion:referenceAssetDescriptor:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  obj = [versionCopy latestDowloadedAtomicInstanceEntries];
  v10 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = versionCopy;
    v12 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v14 = 0;
      v29 = v11;
      do
      {
        if (*v33 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        assetType = [descriptorCopy assetType];
        fullAssetSelector = [v15 fullAssetSelector];
        assetType2 = [fullAssetSelector assetType];
        if ([v16 stringIsEqual:assetType to:assetType2])
        {
          v31 = p_weak_ivar_lyt[223];
          assetSpecifier = [descriptorCopy assetSpecifier];
          fullAssetSelector2 = [v15 fullAssetSelector];
          [fullAssetSelector2 assetSpecifier];
          v22 = p_weak_ivar_lyt;
          v23 = descriptorCopy;
          v25 = v24 = v12;
          LOBYTE(v31) = [v31 stringIsEqual:assetSpecifier to:v25];

          v12 = v24;
          descriptorCopy = v23;
          p_weak_ivar_lyt = v22;

          v11 = v29;
          if (v31)
          {
            v26 = 1;
            goto LABEL_13;
          }
        }

        else
        {
        }

        v14 = v14 + 1;
      }

      while (v11 != v14);
      v11 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v11);
    v26 = 0;
LABEL_13:
    versionCopy = v28;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (BOOL)doesSetDescriptor:(id)descriptor referenceSetConfiguration:(id)configuration
{
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptor:referenceSetConfiguration:" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v10 = [obj countByEnumeratingWithState:&v23 objects:v27 count:16];
  if (v10)
  {
    v11 = v10;
    v21 = descriptorCopy;
    v12 = *v24;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v24 != v12)
        {
          objc_enumerationMutation(obj);
        }

        fullAssetSelector = [*(*(&v23 + 1) + 8 * i) fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        autoAssetEntries = [configurationCopy autoAssetEntries];
        v17 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:autoAssetEntries];
        v18 = [SUCore stringIsEqual:assetType to:v17];

        if (v18)
        {
          v19 = 1;
          goto LABEL_11;
        }
      }

      v11 = [obj countByEnumeratingWithState:&v23 objects:v27 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }

    v19 = 0;
LABEL_11:
    descriptorCopy = v21;
  }

  else
  {
    v19 = 0;
  }

  return v19;
}

- (BOOL)doesSetDescriptorReferenceDropped:(id)dropped forSetDescriptor:(id)descriptor
{
  droppedCopy = dropped;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorsDroppedOnStartup = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
  v10 = [descriptorsDroppedOnStartup count];

  if (v10)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorReferenceDropped" ofContainer:@"descriptorsDroppedOnStartup"];
    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    v30 = descriptorCopy;
    obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v11 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    if (v11)
    {
      v12 = v11;
      v32 = 0;
      v13 = *v39;
      do
      {
        for (i = 0; i != v12; i = i + 1)
        {
          if (*v39 != v13)
          {
            objc_enumerationMutation(obj);
          }

          v15 = *(*(&v38 + 1) + 8 * i);
          fullAssetSelector = [v15 fullAssetSelector];
          v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

          if (v17)
          {
            v36 = 0u;
            v37 = 0u;
            v34 = 0u;
            v35 = 0u;
            descriptorsDroppedOnStartup2 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            v19 = [descriptorsDroppedOnStartup2 countByEnumeratingWithState:&v34 objects:v42 count:16];
            if (v19)
            {
              v20 = v19;
              v21 = *v35;
              while (2)
              {
                for (j = 0; j != v20; j = j + 1)
                {
                  if (*v35 != v21)
                  {
                    objc_enumerationMutation(descriptorsDroppedOnStartup2);
                  }

                  if ([v17 isEqualSelector:*(*(&v34 + 1) + 8 * j)])
                  {
                    v32 = 1;
                    goto LABEL_19;
                  }
                }

                v20 = [descriptorsDroppedOnStartup2 countByEnumeratingWithState:&v34 objects:v42 count:16];
                if (v20)
                {
                  continue;
                }

                break;
              }
            }
          }

          else
          {
            descriptorsDroppedOnStartup2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [descriptorsDroppedOnStartup2 diag];
            v24 = [NSString alloc];
            summary = [v30 summary];
            summary2 = [v15 summary];
            v27 = [v24 initWithFormat:@"{%@:doesSetDescriptorReferenceDropped:} downloaded set-descriptor missing asset-descriptor | setDescriptor:%@ | nextDownloadedEntry:%@", droppedCopy, summary, summary2];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6101 withError:0];
          }

LABEL_19:
        }

        v12 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
      }

      while (v12);
    }

    else
    {
      v32 = 0;
    }

    descriptorCopy = v30;
    v28 = v32;
  }

  else
  {
    v28 = 0;
  }

  return v28 & 1;
}

- (BOOL)doesSetDescriptorReferenceAllPreInstalledContent:(id)content
{
  contentCopy = content;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDowloadedAtomicInstanceEntries = [contentCopy latestDowloadedAtomicInstanceEntries];
  v8 = [latestDowloadedAtomicInstanceEntries count];

  if (v8)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"doesSetDescriptorReferenceAllPreInstalledContent" ofContainer:@"latestDowloadedAtomicInstanceEntries"];
    v30 = 0u;
    v31 = 0u;
    v28 = 0u;
    v29 = 0u;
    obj = [contentCopy latestDowloadedAtomicInstanceEntries];
    v9 = [obj countByEnumeratingWithState:&v28 objects:v32 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v29;
      selfCopy = self;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v29 != v11)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v28 + 1) + 8 * i);
          fullAssetSelector = [v13 fullAssetSelector];
          v15 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

          if (v15)
          {
            if (([v15 foundAsPreInstalled] & 1) == 0)
            {

              v24 = 0;
              goto LABEL_15;
            }
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            v18 = [NSString alloc];
            [contentCopy summary];
            v19 = v11;
            v21 = v20 = contentCopy;
            summary = [v13 summary];
            v23 = [v18 initWithFormat:@"{doesSetDescriptor:doesSetDescriptorReferenceAllPreInstalledContent:} downloaded set-descriptor missing asset-descriptor | setDescriptor:%@ | nextDownloadedEntry:%@", v21, summary];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v23 withResult:6101 withError:0];

            contentCopy = v20;
            v11 = v19;
            self = selfCopy;
          }
        }

        v10 = [obj countByEnumeratingWithState:&v28 objects:v32 count:16];
      }

      while (v10);
    }

    v24 = 1;
LABEL_15:
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (BOOL)isAnyAssetEntryOnFilesystemForSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor
{
  descriptorCopy = descriptor;
  setDescriptorCopy = setDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:isAnyAssetEntryOnFilesystemForSetDescriptor:forSetDescriptor:", descriptorCopy];
  v41 = 0;
  latestDowloadedAtomicInstanceEntries = [setDescriptorCopy latestDowloadedAtomicInstanceEntries];
  v12 = [latestDowloadedAtomicInstanceEntries count];

  v36 = descriptorCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorCopy ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  obj = [setDescriptorCopy latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v37 objects:v54 count:16];
  if (!v13)
  {
    v17 = 0;
    goto LABEL_21;
  }

  v14 = v13;
  v31 = v12;
  v32 = descriptorCopy;
  v34 = setDescriptorCopy;
  v15 = 0;
  path = 0;
  v17 = 0;
  v18 = *v38;
  while (2)
  {
    v19 = 0;
    v20 = v15 + 1;
    v33 = &v14[v15];
    v21 = path;
    do
    {
      if (*v38 != v18)
      {
        objc_enumerationMutation(obj);
      }

      v22 = *(*(&v37 + 1) + 8 * v19);
      localContentURL = [v22 localContentURL];

      if (!localContentURL)
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          summary = [v22 summary];
          summary2 = [v34 summary];
          *buf = 138544386;
          v43 = v36;
          v44 = 2048;
          v45 = v20;
          v46 = 2048;
          v47 = v31;
          v48 = 2114;
          v49 = summary;
          v50 = 2114;
          v51 = summary2;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);
        }

        goto LABEL_19;
      }

      localContentURL2 = [v22 localContentURL];
      path = [localContentURL2 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:v36 atPath:path isDirectory:&v41])
      {
        goto LABEL_10;
      }

      if ((v41 & 1) == 0)
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          summary3 = [v22 summary];
          summary4 = [v34 summary];
          *buf = 138544642;
          v43 = v36;
          v44 = 2048;
          v45 = v20;
          v46 = 2048;
          v47 = v31;
          v48 = 2114;
          v49 = summary3;
          v50 = 2114;
          v51 = path;
          v52 = 2114;
          v53 = summary4;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@", buf, 0x3Eu);
        }

        v21 = path;
LABEL_19:

        v17 = 0;
        path = v21;
        goto LABEL_20;
      }

      v17 = 1;
LABEL_10:
      ++v19;
      ++v20;
      v21 = path;
    }

    while (v14 != v19);
    v14 = [obj countByEnumeratingWithState:&v37 objects:v54 count:16];
    v15 = v33;
    if (v14)
    {
      continue;
    }

    break;
  }

LABEL_20:

  descriptorCopy = v32;
  setDescriptorCopy = v34;
LABEL_21:

  return v17 & 1;
}

- (BOOL)isEveryAssetEntryOnFilesystemForSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor
{
  descriptorCopy = descriptor;
  setDescriptorCopy = setDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:isEveryAssetEntryOnFilesystemForSetDescriptor:forSetDescriptor:", descriptorCopy];
  v40 = 0;
  latestDowloadedAtomicInstanceEntries = [setDescriptorCopy latestDowloadedAtomicInstanceEntries];
  v12 = [latestDowloadedAtomicInstanceEntries count];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorCopy ofContainer:@"latestDowloadedAtomicInstanceEntries"];
  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [setDescriptorCopy latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v36 objects:v53 count:16];
  if (v13)
  {
    v14 = v13;
    v31 = v12;
    v32 = setDescriptorCopy;
    v33 = descriptorCopy;
    v15 = 0;
    path = 0;
    v17 = *v37;
    while (2)
    {
      v18 = 0;
      v19 = v15 + 1;
      v34 = &v14[v15];
      v20 = path;
      do
      {
        if (*v37 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v21 = *(*(&v36 + 1) + 8 * v18);
        localContentURL = [v21 localContentURL];

        if (!localContentURL)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            summary = [v21 summary];
            setDescriptorCopy = v32;
            summary2 = [v32 summary];
            *buf = 138544386;
            v42 = descriptorCopy;
            v43 = 2048;
            v44 = v19;
            v45 = 2048;
            v46 = v31;
            v47 = 2114;
            v48 = summary;
            v49 = 2114;
            v50 = summary2;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);

            goto LABEL_17;
          }

          goto LABEL_19;
        }

        localContentURL2 = [v21 localContentURL];
        path = [localContentURL2 path];

        if ([(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:descriptorCopy atPath:path isDirectory:&v40]&& (v40 & 1) == 0)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            summary3 = [v21 summary];
            setDescriptorCopy = v32;
            summary4 = [v32 summary];
            *buf = 138544642;
            v42 = descriptorCopy;
            v43 = 2048;
            v44 = v19;
            v45 = 2048;
            v46 = v31;
            v47 = 2114;
            v48 = summary3;
            v49 = 2114;
            v50 = path;
            v51 = 2114;
            v52 = summary4;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@", buf, 0x3Eu);

            v20 = path;
LABEL_17:
            descriptorCopy = v33;
LABEL_20:

            v24 = 0;
            path = v20;
            goto LABEL_21;
          }

          v20 = path;
LABEL_19:
          setDescriptorCopy = v32;
          descriptorCopy = v33;
          goto LABEL_20;
        }

        ++v18;
        ++v19;
        v20 = path;
      }

      while (v14 != v18);
      v14 = [obj countByEnumeratingWithState:&v36 objects:v53 count:16];
      v15 = v34;
      if (v14)
      {
        continue;
      }

      break;
    }

    v24 = 1;
    setDescriptorCopy = v32;
    descriptorCopy = v33;
LABEL_21:
  }

  else
  {
    v24 = 1;
  }

  return v24;
}

- (BOOL)doesSetDescriptor:(id)descriptor coverAllForAutoAssetEntries:(id)entries
{
  descriptorCopy = descriptor;
  entriesCopy = entries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v40 = descriptorCopy;
  firstAssetType = [descriptorCopy firstAssetType];
  selfCopy = self;
  v12 = [(MADAutoAssetControlManager *)self firstAssetTypeForSetEntries:entriesCopy];
  v13 = [SUCore stringIsEqual:firstAssetType to:v12];

  if (!v13)
  {
    goto LABEL_27;
  }

  v53 = 0u;
  v54 = 0u;
  v51 = 0u;
  v52 = 0u;
  obj = entriesCopy;
  v37 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
  if (!v37)
  {
    LOBYTE(v13) = 1;
    goto LABEL_26;
  }

  v38 = *v52;
  v35 = entriesCopy;
LABEL_4:
  v14 = 0;
LABEL_5:
  if (*v52 != v38)
  {
    objc_enumerationMutation(obj);
  }

  v41 = v14;
  v15 = *(*(&v51 + 1) + 8 * v14);
  v47 = 0u;
  v48 = 0u;
  v49 = 0u;
  v50 = 0u;
  latestDowloadedAtomicInstanceEntries = [v40 latestDowloadedAtomicInstanceEntries];
  v16 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v47 objects:v55 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v48;
    v42 = v15;
LABEL_9:
    v19 = 0;
    v43 = v17;
    while (1)
    {
      if (*v48 != v18)
      {
        objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
      }

      v20 = *(*(&v47 + 1) + 8 * v19);
      v21 = p_weak_ivar_lyt[223];
      assetSelector = [v15 assetSelector];
      assetType = [assetSelector assetType];
      v46 = v20;
      fullAssetSelector = [v20 fullAssetSelector];
      assetType2 = [fullAssetSelector assetType];
      if ([v21 stringIsEqual:assetType to:assetType2])
      {
        v45 = p_weak_ivar_lyt[223];
        assetSelector2 = [v15 assetSelector];
        assetSpecifier = [assetSelector2 assetSpecifier];
        fullAssetSelector2 = [v46 fullAssetSelector];
        [fullAssetSelector2 assetSpecifier];
        v30 = v29 = v18;
        LOBYTE(v45) = [v45 stringIsEqual:assetSpecifier to:v30];

        v18 = v29;
        v17 = v43;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v15 = v42;

        if (v45)
        {
          fullAssetSelector3 = [v46 fullAssetSelector];
          v32 = [(MADAutoAssetControlManager *)selfCopy locateDownloadedByFullSelector:fullAssetSelector3];

          isOnFilesystem = [v32 isOnFilesystem];
          if (!isOnFilesystem)
          {
            goto LABEL_24;
          }

          v14 = v41 + 1;
          if ((v41 + 1) != v37)
          {
            goto LABEL_5;
          }

          LOBYTE(v13) = 1;
          entriesCopy = v35;
          v37 = [obj countByEnumeratingWithState:&v51 objects:v56 count:16];
          if (!v37)
          {
            goto LABEL_26;
          }

          goto LABEL_4;
        }
      }

      else
      {
      }

      if (v17 == ++v19)
      {
        v17 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v47 objects:v55 count:16];
        if (v17)
        {
          goto LABEL_9;
        }

        break;
      }
    }
  }

LABEL_24:
  LOBYTE(v13) = 0;
  entriesCopy = v35;
LABEL_26:

LABEL_27:
  return v13;
}

- (BOOL)doesSetJobDescriptor:(id)descriptor representSameContentAs:(id)as
{
  descriptorCopy = descriptor;
  asCopy = as;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v11 = [latestDowloadedAtomicInstanceEntries count];
  v32 = asCopy;
  latestDowloadedAtomicInstanceEntries2 = [asCopy latestDowloadedAtomicInstanceEntries];
  v13 = [latestDowloadedAtomicInstanceEntries2 count];

  if (v11 == v13)
  {
    v39 = 0u;
    v40 = 0u;
    v37 = 0u;
    v38 = 0u;
    obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v14 = [obj countByEnumeratingWithState:&v37 objects:v42 count:16];
    if (v14)
    {
      v15 = v14;
      v31 = *v38;
      v29 = descriptorCopy;
      while (1)
      {
        v16 = 0;
LABEL_5:
        if (*v38 != v31)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v37 + 1) + 8 * v16);
        v33 = 0u;
        v34 = 0u;
        v35 = 0u;
        v36 = 0u;
        latestDowloadedAtomicInstanceEntries3 = [v32 latestDowloadedAtomicInstanceEntries];
        v19 = [latestDowloadedAtomicInstanceEntries3 countByEnumeratingWithState:&v33 objects:v41 count:16];
        if (!v19)
        {
          break;
        }

        v20 = v19;
        v21 = *v34;
LABEL_9:
        v22 = 0;
        while (1)
        {
          if (*v34 != v21)
          {
            objc_enumerationMutation(latestDowloadedAtomicInstanceEntries3);
          }

          v23 = *(*(&v33 + 1) + 8 * v22);
          fullAssetSelector = [v17 fullAssetSelector];
          fullAssetSelector2 = [v23 fullAssetSelector];
          v26 = [fullAssetSelector isEqual:fullAssetSelector2];

          if (v26)
          {
            break;
          }

          if (v20 == ++v22)
          {
            v20 = [latestDowloadedAtomicInstanceEntries3 countByEnumeratingWithState:&v33 objects:v41 count:16];
            if (v20)
            {
              goto LABEL_9;
            }

            goto LABEL_20;
          }
        }

        if (++v16 != v15)
        {
          goto LABEL_5;
        }

        v15 = [obj countByEnumeratingWithState:&v37 objects:v42 count:16];
        v27 = 1;
        descriptorCopy = v29;
        if (!v15)
        {
          goto LABEL_22;
        }
      }

LABEL_20:

      v27 = 0;
      descriptorCopy = v29;
    }

    else
    {
      v27 = 1;
    }

LABEL_22:
  }

  else
  {
    v27 = 0;
  }

  return v27;
}

- (BOOL)doesSetDescriptor:(id)descriptor coverAllForAtomicInstanceEntries:(id)entries
{
  descriptorCopy = descriptor;
  entriesCopy = entries;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  obj = entriesCopy;
  v28 = [obj countByEnumeratingWithState:&v46 objects:v51 count:16];
  if (!v28)
  {
    LOBYTE(isOnFilesystem) = 1;
    goto LABEL_26;
  }

  v30 = *v47;
  do
  {
    v9 = 0;
LABEL_4:
    if (*v47 != v30)
    {
      objc_enumerationMutation(obj);
    }

    v32 = v9;
    v10 = *(*(&v46 + 1) + 8 * v9);
    v42 = 0u;
    v43 = 0u;
    v44 = 0u;
    v45 = 0u;
    latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v41 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v42 objects:v50 count:16];
    if (!v41)
    {
LABEL_24:

      LOBYTE(isOnFilesystem) = 0;
      break;
    }

    v11 = *v43;
    v36 = *v43;
    v33 = v10;
LABEL_8:
    v12 = 0;
    while (1)
    {
      if (*v43 != v11)
      {
        objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
      }

      v13 = *(*(&v42 + 1) + 8 * v12);
      fullAssetSelector = [v10 fullAssetSelector];
      assetType = [fullAssetSelector assetType];
      fullAssetSelector2 = [v13 fullAssetSelector];
      assetType2 = [fullAssetSelector2 assetType];
      if (![SUCore stringIsEqual:assetType to:assetType2])
      {
        goto LABEL_16;
      }

      fullAssetSelector3 = [v10 fullAssetSelector];
      assetSpecifier = [fullAssetSelector3 assetSpecifier];
      fullAssetSelector4 = [v13 fullAssetSelector];
      assetSpecifier2 = [fullAssetSelector4 assetSpecifier];
      v39 = assetSpecifier;
      if (![SUCore stringIsEqual:assetSpecifier to:assetSpecifier2])
      {

        v11 = v36;
LABEL_16:

        goto LABEL_17;
      }

      fullAssetSelector5 = [v10 fullAssetSelector];
      assetVersion = [fullAssetSelector5 assetVersion];
      fullAssetSelector6 = [v13 fullAssetSelector];
      assetVersion2 = [fullAssetSelector6 assetVersion];
      v35 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

      v10 = v33;
      v11 = v36;
      if (v35)
      {
        break;
      }

LABEL_17:
      if (v41 == ++v12)
      {
        v41 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v42 objects:v50 count:16];
        if (v41)
        {
          goto LABEL_8;
        }

        goto LABEL_24;
      }
    }

    fullAssetSelector7 = [v13 fullAssetSelector];
    v24 = [(MADAutoAssetControlManager *)selfCopy locateDownloadedByFullSelector:fullAssetSelector7];

    isOnFilesystem = [v24 isOnFilesystem];
    if (!isOnFilesystem)
    {
      break;
    }

    v9 = v32 + 1;
    if ((v32 + 1) != v28)
    {
      goto LABEL_4;
    }

    LOBYTE(isOnFilesystem) = 1;
    v28 = [obj countByEnumeratingWithState:&v46 objects:v51 count:16];
  }

  while (v28);
LABEL_26:

  return isOnFilesystem;
}

- (id)locateSetDescriptor:(id)descriptor forAtomicInstanceUUID:(id)d requireExists:(BOOL)exists
{
  existsCopy = exists;
  descriptorCopy = descriptor;
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12 = dCopy;
  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:locateSetDescriptor", descriptorCopy];
  if (!dCopy)
  {
    v26 = 0;
    goto LABEL_33;
  }

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v14 = [persistedDownloadedSetDescriptors persistedEntryIDs:descriptorCopy];

  if (![v14 count])
  {
    v26 = 0;
    goto LABEL_32;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorCopy ofContainer:@"persistedDownloadedSetDescriptors"];
  v44 = 0u;
  v45 = 0u;
  v42 = 0u;
  v43 = 0u;
  obj = v14;
  v41 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
  if (!v41)
  {
    v26 = 0;
    goto LABEL_31;
  }

  v36 = v14;
  v37 = existsCopy;
  v15 = *v43;
  v16 = obj;
  v39 = *v43;
  while (2)
  {
    for (i = 0; i != v41; i = i + 1)
    {
      if (*v43 != v15)
      {
        objc_enumerationMutation(v16);
      }

      v18 = *(*(&v42 + 1) + 8 * i);
      v19 = objc_autoreleasePoolPush();
      if (!v18)
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v47 = descriptorCopy;
          v48 = 2114;
          v49 = v12;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[KNOWN-SET-DESCRIPTORS]{%{public}@} no entryID | atomicInstanceUUID:%{public}@", buf, 0x16u);
        }

        goto LABEL_21;
      }

      if (![v18 containsString:v12])
      {
        goto LABEL_22;
      }

      persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v21 = [persistedDownloadedSetDescriptors2 persistedEntry:v18 fromLocation:descriptorCopy];

      if (v21)
      {
        persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        v23 = [persistedDownloadedSetDescriptors3 decodeFromLocation:descriptorCopy ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v23)
        {
          v24 = descriptorCopy;
          latestDownloadedAtomicInstance = [v23 latestDownloadedAtomicInstance];
          if ([SUCore stringIsEqual:latestDownloadedAtomicInstance to:v12])
          {
            v26 = v23;

LABEL_29:
            objc_autoreleasePoolPop(v19);
            descriptorCopy = v24;
            goto LABEL_30;
          }

          v26 = v23;
          [v23 discoveredAtomicInstance];
          selfCopy = self;
          v29 = v28 = v12;
          v30 = [SUCore stringIsEqual:v29 to:v28];

          v12 = v28;
          self = selfCopy;

          if (v30)
          {
            goto LABEL_29;
          }

          descriptorCopy = v24;
          v16 = obj;
          v15 = v39;
          v23 = v26;
          goto LABEL_20;
        }
      }

      else
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v47 = descriptorCopy;
          v48 = 2114;
          v49 = v12;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "\n[KNOWN-SET-DESCRIPTORS]{%{public}@} unable to load persisted entry | atomicInstanceUUID:%{public}@", buf, 0x16u);
        }
      }

      v15 = v39;
LABEL_20:

LABEL_21:
LABEL_22:
      objc_autoreleasePoolPop(v19);
    }

    v41 = [v16 countByEnumeratingWithState:&v42 objects:v50 count:16];
    if (v41)
    {
      continue;
    }

    break;
  }

  v26 = 0;
LABEL_30:
  existsCopy = v37;
  v14 = v36;
LABEL_31:

LABEL_32:
  if (!v26)
  {
LABEL_33:
    if (existsCopy)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v33 = v12;
      v34 = [[NSString alloc] initWithFormat:@"{%@} unable to locate atomic-instance UUID | atomicInstanceUUID:%@", descriptorCopy, v12];
      [diag trackAnomaly:@"KNOWN-SET-DESCRIPTORS" forReason:v34 withResult:6103 withError:0];

      v12 = v33;
    }
  }

  return v26;
}

- (BOOL)wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:(id)instance
{
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetEntries = [instanceCopy autoAssetEntries];
  v8 = [(MADAutoAssetControlManager *)self locateSetLookupResultSatisfying:autoAssetEntries];

  if (!v8)
  {
    v31 = 0;
    goto LABEL_32;
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  discoveredAtomicEntries = [v8 discoveredAtomicEntries];
  v38 = [discoveredAtomicEntries countByEnumeratingWithState:&v46 objects:v51 count:16];
  if (!v38)
  {
    v31 = 1;
    goto LABEL_31;
  }

  v10 = *v47;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v33 = v8;
  v34 = instanceCopy;
  selfCopy = self;
  v37 = discoveredAtomicEntries;
  v35 = *v47;
LABEL_4:
  v12 = 0;
  v13 = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  while (1)
  {
    if (*v47 != v10)
    {
      objc_enumerationMutation(discoveredAtomicEntries);
    }

    v39 = v12;
    fullAssetSelector = [*(*(&v46 + 1) + 8 * v12) fullAssetSelector];
    v15 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

    if (!v15)
    {
      break;
    }

    if ([p_weak_ivar_lyt[287] doesDescriptorInvolvePersonalization:@"wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance" forDescriptor:v15] && objc_msgSend(p_weak_ivar_lyt[287], "isPersonalizationRequired:forDescriptor:", @"wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance", v15))
    {
      v44 = 0u;
      v45 = 0u;
      v42 = 0u;
      v43 = 0u;
      obj = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
      v16 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
      if (!v16)
      {
        goto LABEL_29;
      }

      v17 = v16;
      v18 = *v43;
      while (1)
      {
        v19 = 0;
        v40 = v17;
        do
        {
          if (*v43 != v18)
          {
            objc_enumerationMutation(obj);
          }

          v20 = *(*(&v42 + 1) + 8 * v19);
          v21 = v13[223];
          assetType = [v20 assetType];
          assetType2 = [v15 assetType];
          if (![v21 stringIsEqual:assetType to:assetType2])
          {
            goto LABEL_20;
          }

          v24 = v18;
          v25 = v13[223];
          assetSpecifier = [v20 assetSpecifier];
          assetSpecifier2 = [v15 assetSpecifier];
          if (![v25 stringIsEqual:assetSpecifier to:assetSpecifier2])
          {

            v18 = v24;
            v17 = v40;
LABEL_20:

            goto LABEL_21;
          }

          v28 = v13[223];
          assetVersion = [v20 assetVersion];
          assetVersion2 = [v15 assetVersion];
          LOBYTE(v28) = [v28 stringIsEqual:assetVersion to:assetVersion2];

          v13 = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v18 = v24;
          v17 = v40;
          if (v28)
          {

            self = selfCopy;
            discoveredAtomicEntries = v37;
            v10 = v35;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            goto LABEL_24;
          }

LABEL_21:
          v19 = v19 + 1;
        }

        while (v17 != v19);
        v17 = [obj countByEnumeratingWithState:&v42 objects:v50 count:16];
        if (!v17)
        {
LABEL_29:

          discoveredAtomicEntries = v37;
          goto LABEL_30;
        }
      }
    }

LABEL_24:

    v12 = v39 + 1;
    if ((v39 + 1) == v38)
    {
      v31 = 1;
      v8 = v33;
      instanceCopy = v34;
      v38 = [discoveredAtomicEntries countByEnumeratingWithState:&v46 objects:v51 count:16];
      if (!v38)
      {
        goto LABEL_31;
      }

      goto LABEL_4;
    }
  }

LABEL_30:

  v31 = 0;
  v8 = v33;
  instanceCopy = v34;
LABEL_31:

LABEL_32:
  return v31;
}

- (id)preInstalledSetDescriptor:(id)descriptor forClientDomainName:(id)name forSetClientName:(id)clientName forAssetSetIdentifier:(id)identifier forAssetType:(id)type
{
  descriptorCopy = descriptor;
  nameCopy = name;
  clientNameCopy = clientName;
  identifierCopy = identifier;
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  selfCopy = self;
  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:preInstalledSetDescriptor", descriptorCopy];
  v62 = typeCopy;
  v16 = [MADAutoAssetControlManager _allPreInstalledDescriptor:"_allPreInstalledDescriptor:forAssetType:" forAssetType:?];
  v17 = objc_opt_new();
  v63 = descriptorCopy;
  if ([v16 count])
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v79 = descriptorCopy;
      v80 = 2048;
      v81 = [v16 count];
      v82 = 2114;
      v83 = typeCopy;
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "{%{public}@} Found %lu preinstalled asset descriptor(s) matching assetType: %{public}@", buf, 0x20u);
    }

    v74 = 0u;
    v75 = 0u;
    v72 = 0u;
    v73 = 0u;
    v19 = v16;
    v20 = v16;
    v21 = [v20 countByEnumeratingWithState:&v72 objects:v77 count:16];
    if (v21)
    {
      v22 = v21;
      v23 = *v73;
      do
      {
        for (i = 0; i != v22; i = i + 1)
        {
          if (*v73 != v23)
          {
            objc_enumerationMutation(v20);
          }

          v25 = *(*(&v72 + 1) + 8 * i);
          v26 = [MANAutoAssetSetEntry alloc];
          assetType = [v25 assetType];
          assetSpecifier = [v25 assetSpecifier];
          v29 = [(MANAutoAssetSetEntry *)v26 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

          [v17 addObject:v29];
        }

        v22 = [v20 countByEnumeratingWithState:&v72 objects:v77 count:16];
      }

      while (v22);
    }

    v16 = v19;
    descriptorCopy = v63;
  }

  v70 = 0u;
  v71 = 0u;
  v68 = 0u;
  v69 = 0u;
  v30 = v17;
  v31 = [v30 countByEnumeratingWithState:&v68 objects:v76 count:16];
  obj = v30;
  if (v31)
  {
    v32 = v31;
    v58 = v16;
    v33 = 0;
    v65 = *v69;
    v34 = 1;
    do
    {
      for (j = 0; j != v32; j = j + 1)
      {
        if (*v69 != v65)
        {
          objc_enumerationMutation(obj);
        }

        v36 = *(*(&v68 + 1) + 8 * j);
        v37 = objc_autoreleasePoolPush();
        assetSelector = [v36 assetSelector];
        assetType2 = [assetSelector assetType];
        assetSelector2 = [v36 assetSelector];
        assetSpecifier2 = [assetSelector2 assetSpecifier];
        v42 = [(MADAutoAssetControlManager *)selfCopy _preInstalledDescriptor:descriptorCopy forAssetType:assetType2 withAssetSpecifier:assetSpecifier2];

        v43 = v42 != 0;
        v34 &= v43;
        v33 |= v43;

        objc_autoreleasePoolPop(v37);
      }

      v30 = obj;
      v32 = [obj countByEnumeratingWithState:&v68 objects:v76 count:16];
    }

    while (v32);

    descriptorCopy = v63;
    v16 = v58;
    if (!(v34 & 1 | ((v33 & 1) == 0)))
    {
      v44 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543874;
        v79 = descriptorCopy;
        v80 = 2114;
        v81 = nameCopy;
        v82 = 2114;
        v83 = identifierCopy;
        _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {%{public}@} found some asset-specifiers as pre-installed - returning found subset | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
      }
    }

    if (((v34 | v33) & 1) == 0)
    {
      v45 = 0;
      v47 = identifierCopy;
      v46 = nameCopy;
      v48 = clientNameCopy;
      goto LABEL_38;
    }
  }

  else
  {
  }

  v49 = [(MADAutoAssetControlManager *)selfCopy _preInstalledSetAtomicEntriesFromInstanceEntries:v30];
  v47 = identifierCopy;
  v46 = nameCopy;
  v48 = clientNameCopy;
  if (v49)
  {
    v50 = [(MADAutoAssetControlManager *)selfCopy atomicInstanceNewSetAtomicInstance:descriptorCopy forCreationReason:@"FROM_PREINSTALLED" recordingHistoryOperation:224 forClientDomainName:nameCopy forSetClientName:clientNameCopy forAssetSetIdentifier:identifierCopy representingInstanceEntries:v30 recoveringAtomicInstanceUUID:0 asSubAtomicFrom:0];
    v51 = v50;
    if (v50)
    {
      atomicInstanceUUID = [v50 atomicInstanceUUID];
      v53 = [[MADAutoSetDescriptor alloc] initForClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy withDiscoveredAtomicInstance:atomicInstanceUUID withDiscoveredAtomicEntries:v49];
      v45 = v53;
      if (v53)
      {
        [v53 setRequestedAutoAssetEntries:obj];
        [v45 setLatestDownloadedAtomicInstance:atomicInstanceUUID];
        [v45 setLatestDowloadedAtomicInstanceEntries:v49];
        [v45 setIsOnFilesystem:1];
        [v45 setIsDiscoveredFullyDownloaded:1];
        [v45 setAtomicInstanceDownloadedNotified:1];
        [v45 setNeverBeenLocked:1];
        [(MADAutoAssetControlManager *)selfCopy setDescriptorAddedPreInstalled:v45];
        v54 = v45;
      }

      else
      {
        v55 = v16;
        v56 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543874;
          v79 = descriptorCopy;
          v80 = 2114;
          v81 = nameCopy;
          v82 = 2114;
          v83 = identifierCopy;
          _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {%{public}@} unable to allocate set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
        }

        [(MADAutoAssetControlManager *)selfCopy atomicInstanceRemove:descriptorCopy setAtomicInstanceUUID:atomicInstanceUUID removingForReason:@"unable to allocate set-descriptor" historyOperation:337];
        v16 = v55;
        descriptorCopy = v63;
      }
    }

    else
    {
      v45 = 0;
    }
  }

  else
  {
    v45 = 0;
  }

LABEL_38:

  return v45;
}

- (id)locateSetDescriptorsDownloaded
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = objc_alloc_init(NSMutableArray);
  setDescriptorWalkKeys = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetDescriptorsDownloaded" ofContainer:@"setDescriptorWalkKeys"];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v7 = setDescriptorWalkKeys;
  v8 = [v7 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v18;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v18 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v17 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        v14 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"locateSetDescriptorsDownloaded" forKey:v12, v17];
        if (v14)
        {
          [v5 addObject:v14];
        }

        objc_autoreleasePoolPop(v13);
      }

      v9 = [v7 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v9);
  }

  if ([v5 count])
  {
    v15 = v5;
  }

  else
  {
    v15 = 0;
  }

  return v15;
}

- (id)locateSetDescriptorActiveJobByAtomicInstanceUUID:(id)d
{
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v8 = [activeSetDescriptorsByInstance safeObjectForKey:dCopy ofClass:objc_opt_class()];

  return v8;
}

- (id)locateSetDescriptorActiveJobByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
  if (v10)
  {
    activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    v12 = [activeSetDescriptorsByIdentifier safeObjectForKey:v10 ofClass:objc_opt_class()];
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (id)locateSetDescriptorActiveJobPreferringByAtomicInstance:(id)instance elseByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  instanceCopy = instance;
  domainCopy = domain;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (instanceCopy)
  {
    [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:instanceCopy];
  }

  else
  {
    [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
  }
  v13 = ;

  return v13;
}

- (id)locateSetDescriptorForSelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:selectorCopy];

  v8 = [(MADAutoAssetControlManager *)self locateSetDescriptorForAssetDescriptor:v7];

  return v8;
}

- (id)locateSetDescriptorForAssetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (descriptorCopy)
  {
    setDescriptorWalkKeys = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateSetDescriptorForAssetDescriptor" ofContainer:@"setDescriptorWalkKeys"];
    v19 = 0u;
    v20 = 0u;
    v17 = 0u;
    v18 = 0u;
    v8 = setDescriptorWalkKeys;
    v9 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
    if (v9)
    {
      v10 = v9;
      v11 = *v18;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v18 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v13 = *(*(&v17 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          v15 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"locateSetDescriptorForAssetDescriptor" forKey:v13, v17];
          if (v15 && [(MADAutoAssetControlManager *)self doesSetDescriptor:v15 referenceAssetDescriptor:descriptorCopy])
          {
            objc_autoreleasePoolPop(v14);
            goto LABEL_14;
          }

          objc_autoreleasePoolPop(v14);
        }

        v10 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

    v15 = 0;
LABEL_14:
  }

  else
  {
    v15 = 0;
  }

  return v15;
}

- (id)locateActiveAutoJobForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  obj = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v6 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v27;
    v9 = descriptorCopy;
    v22 = *v27;
    do
    {
      v10 = 0;
      v24 = v7;
      do
      {
        if (*v27 != v8)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v26 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
        v14 = [currentJobsBySelector safeObjectForKey:v11 ofClass:objc_opt_class()];

        if ([v14 autoAssetSetJob])
        {
          clientDomainName = [v14 clientDomainName];
          clientDomainName2 = [v9 clientDomainName];
          if (([SUCore stringIsEqual:clientDomainName to:clientDomainName2]& 1) != 0)
          {
            [v14 autoAssetSetIdentifier];
            v18 = v17 = self;
            assetSetIdentifier = [v9 assetSetIdentifier];
            v20 = [SUCore stringIsEqual:v18 to:assetSetIdentifier];

            v9 = descriptorCopy;
            self = v17;
            v8 = v22;

            v7 = v24;
            if (v20)
            {
              objc_autoreleasePoolPop(v12);
              goto LABEL_15;
            }
          }

          else
          {

            v7 = v24;
          }
        }

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v7 != v10);
      v7 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v7);
    v14 = 0;
  }

  else
  {
    v14 = 0;
    v9 = descriptorCopy;
  }

LABEL_15:

  return v14;
}

- (BOOL)verifySetDescriptorIsLockable:(id)lockable fromLocation:(id)location notLocakableError:(id *)error corruptedAtomicEntries:(id *)entries
{
  lockableCopy = lockable;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v73 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:verifySetDescriptorIsLockable", locationCopy];
  v13 = objc_alloc_init(NSMutableArray);
  latestDowloadedAtomicInstanceEntries = [lockableCopy latestDowloadedAtomicInstanceEntries];
  v15 = [latestDowloadedAtomicInstanceEntries count];

  if (!v15)
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEBUG))
    {
      summary = [lockableCopy summary];
      *buf = 138412546;
      v87 = v73;
      v88 = 2112;
      v89 = summary;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEBUG, "{%@:verifySetDescriptorIsLockable} zero atomic-instance entries | setJobDescriptor:%@", buf, 0x16u);
    }
  }

  v69 = v13;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"setDescriptor.latestDowloadedAtomicInstanceEntries"];
  v82 = 0u;
  v83 = 0u;
  v80 = 0u;
  v81 = 0u;
  obj = [lockableCopy latestDowloadedAtomicInstanceEntries];
  v70 = lockableCopy;
  v71 = locationCopy;
  v75 = [obj countByEnumeratingWithState:&v80 objects:v85 count:16];
  v18 = 0;
  if (v75)
  {
    v74 = *v81;
    do
    {
      v19 = 0;
      do
      {
        if (*v81 != v74)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v80 + 1) + 8 * v19);
        fullAssetSelector = [v20 fullAssetSelector];
        v22 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

        if (!v22)
        {
          v33 = [NSString alloc];
          summary2 = [lockableCopy summary];
          summary3 = [v20 summary];
          v36 = [v33 initWithFormat:@"{%@:verifySetDescriptorIsLockable} no downloaded descriptor | setJobDescriptor:%@ | nextDownloadedAtomicEntry:%@", v73, summary2, summary3];
          v37 = 6108;
LABEL_22:
          v39 = [MAAutoAssetError buildError:v37 fromOperation:locationCopy underlyingError:0 withDescription:v36];

          v18 = v39;
          goto LABEL_28;
        }

        if (([v22 isMAAutoAsset] & 1) == 0)
        {
          v38 = [NSString alloc];
          summary2 = [lockableCopy summary];
          summary3 = [v22 summary];
          v36 = [v38 initWithFormat:@"{%@:verifySetDescriptorIsLockable} not MAAutoAsset | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, summary2, summary3];
          v37 = 6103;
          goto LABEL_22;
        }

        selfCopy = self;
        assetType = [v22 assetType];
        if (!assetType)
        {
          goto LABEL_26;
        }

        v25 = assetType;
        assetSpecifier = [v22 assetSpecifier];
        if (!assetSpecifier)
        {
          goto LABEL_25;
        }

        v27 = assetSpecifier;
        assetVersion = [v22 assetVersion];
        if (!assetVersion)
        {
          goto LABEL_24;
        }

        v29 = assetVersion;
        assetId = [v22 assetId];
        if (!assetId)
        {

          lockableCopy = v70;
LABEL_24:

LABEL_25:
LABEL_26:
          v40 = [NSString alloc];
          summary4 = [lockableCopy summary];
          summary5 = [v22 summary];
          v43 = [v40 initWithFormat:@"{%@:verifySetDescriptorIsLockable} MISSING required | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, summary4, summary5];
          v44 = 6111;
LABEL_27:
          v45 = [MAAutoAssetError buildError:v44 fromOperation:v71 underlyingError:0 withDescription:v43];

          v18 = v45;
          self = selfCopy;
          locationCopy = v71;
          goto LABEL_28;
        }

        metadata = [v22 metadata];

        lockableCopy = v70;
        if (!metadata)
        {
          goto LABEL_26;
        }

        if (([v22 isOnFilesystem] & 1) == 0)
        {
          v46 = [NSString alloc];
          summary4 = [v70 summary];
          summary5 = [v22 summary];
          v43 = [v46 initWithFormat:@"{%@:verifySetDescriptorIsLockable} not on filesystem | setJobDescriptor:%@ | downloadedDescriptor:%@", v73, summary4, summary5];
          v44 = 6113;
          goto LABEL_27;
        }

        self = selfCopy;
        v32 = selfCopy;
        locationCopy = v71;
        if (![(MADAutoAssetControlManager *)v32 isLocalContentValidForSetAtomicEntry:v20 fromLocation:v71])
        {
          [v69 addObject:v20];
        }

LABEL_28:

        v19 = v19 + 1;
      }

      while (v75 != v19);
      v47 = [obj countByEnumeratingWithState:&v80 objects:v85 count:16];
      v75 = v47;
    }

    while (v47);
  }

  v48 = v69;
  if ([v69 count])
  {
    selfCopy2 = self;
    v50 = [[NSString alloc] initWithFormat:@"{%@:verifySetDescriptorIsLockable} corrupted assets: ", locationCopy];
    v76 = 0u;
    v77 = 0u;
    v78 = 0u;
    v79 = 0u;
    v51 = v69;
    v52 = [v51 countByEnumeratingWithState:&v76 objects:v84 count:16];
    if (v52)
    {
      v53 = v52;
      v54 = 0;
      v55 = *v77;
      do
      {
        v56 = 0;
        v57 = v50;
        do
        {
          if (*v77 != v55)
          {
            objc_enumerationMutation(v51);
          }

          v58 = [(MADAutoAssetControlManager *)selfCopy2 getCorruptedEntryInfo:*(*(&v76 + 1) + 8 * v56)];
          v59 = v58;
          if (v54)
          {
            [v57 stringByAppendingFormat:@", %@", v58];
          }

          else
          {
            [v57 stringByAppendingString:v58];
          }
          v50 = ;

          v56 = v56 + 1;
          v54 = 1;
          v57 = v50;
        }

        while (v53 != v56);
        v53 = [v51 countByEnumeratingWithState:&v76 objects:v84 count:16];
      }

      while (v53);
    }

    lockableCopy = v70;
    locationCopy = v71;
    self = selfCopy2;
    if (v18)
    {
      v60 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
      {
        *buf = 138412546;
        v87 = v73;
        v88 = 2112;
        v89 = v18;
        _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "{%@:verifySetDescriptorIsLockable} Set is not lockable because corrupted asset as well as other not lockable reason is found. Asset corruption error will be returned. The other error is: %@", buf, 0x16u);
      }
    }

    v61 = [MAAutoAssetError buildError:6116 fromOperation:v71 underlyingError:0 withDescription:v50];

    if (entries)
    {
      v62 = v51;
      *entries = v51;
    }

    v18 = v61;
    v48 = v69;
  }

  if (v18)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"set-descriptor not lockable" withResult:objc_msgSend(v18 withError:{"code"), v18}];
  }

  if (error)
  {
    v65 = v18;
    *error = v18;
  }

  return v18 == 0;
}

- (void)removeSetDescriptorActiveJobByAtomicInstanceUUID:(id)d
{
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v7 = [activeSetDescriptorsByInstance safeObjectForKey:dCopy ofClass:objc_opt_class()];

  if (v7)
  {
    activeSetDescriptorsByInstance2 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
    [activeSetDescriptorsByInstance2 removeObjectForKey:dCopy];
  }
}

- (void)removeSetDescriptorActiveJobByClientDomain:(id)domain forAssetSetIdentifier:(id)identifier fromLocation:(id)location
{
  locationCopy = location;
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
  if (v13)
  {
    activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    v15 = [activeSetDescriptorsByIdentifier safeObjectForKey:v13 ofClass:objc_opt_class()];

    if (v15)
    {
      v16 = v13;
      persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
      v18 = [persistedActiveJobSetDescriptors persistedEntry:v16 fromLocation:locationCopy];

      activeSetDescriptorsByIdentifier2 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
      [activeSetDescriptorsByIdentifier2 removeObjectForKey:v16];

      if (v18)
      {
        persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        [persistedActiveJobSetDescriptors2 removePersistedEntry:v16 fromLocation:locationCopy];

        v21 = [NSString alloc];
        summary = [v15 summary];
        v23 = [v21 initWithFormat:@"removed previously active set-descriptor | setDescriptor:%@", summary];
        [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:locationCopy forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v16 removedSetDescriptor:v15 message:v23];
      }

      else
      {
        v24 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary2 = [v15 summary];
          *buf = 138543874;
          v28 = _updateLatestSummary;
          v29 = 2114;
          v30 = locationCopy;
          v31 = 2114;
          v32 = summary2;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:removeSetDescriptorActiveJobByClientDomain} unable to load persisted-set-descriptor file | locatedActiveJobSetDescriptor:%{public}@", buf, 0x20u);
        }
      }
    }
  }
}

- (void)removeSetDescriptorDownloaded:(id)downloaded fromLocation:(id)location checkingByInstance:(BOOL)instance regardlessOfLatest:(BOOL)latest historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d
{
  instanceCopy = instance;
  downloadedCopy = downloaded;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v63 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:removeSetDescriptorDownloaded", locationCopy];
  v17 = objc_alloc_init(NSMutableArray);
  v18 = v17;
  v64 = downloadedCopy;
  v65 = locationCopy;
  iCopy = i;
  if (instanceCopy)
  {
    v61 = v17;
    clientDomainName = [downloadedCopy clientDomainName];
    assetSetIdentifier = [downloadedCopy assetSetIdentifier];
    v21 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:clientDomainName assetSetIdentifier:assetSetIdentifier];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"setDescriptorKeysForAssetSet"];
    v76 = 0u;
    v77 = 0u;
    v74 = 0u;
    v75 = 0u;
    obj = v21;
    v22 = [obj countByEnumeratingWithState:&v74 objects:v85 count:16];
    if (v22)
    {
      v23 = v22;
      v24 = *v75;
      do
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v75 != v24)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v74 + 1) + 8 * i);
          v27 = objc_autoreleasePoolPush();
          v28 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:locationCopy forKey:v26];
          v29 = v28;
          if (v28)
          {
            latestDownloadedAtomicInstance = [v28 latestDownloadedAtomicInstance];
            latestDownloadedAtomicInstance2 = [v64 latestDownloadedAtomicInstance];
            v32 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestDownloadedAtomicInstance2];

            if (v32)
            {
              if (latest || ([v64 latestDownloadedAtomicInstance], (v33 = objc_claimAutoreleasedReturnValue()) == 0) || (v34 = v33, objc_msgSend(v29, "latestDownloadedAtomicInstance"), v35 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v64, "latestDownloadedAtomicInstance"), v36 = objc_claimAutoreleasedReturnValue(), v37 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v35, v36), v36, locationCopy = v65, v35, v34, v37))
              {
                [v61 addObject:v29];
              }
            }
          }

          objc_autoreleasePoolPop(v27);
        }

        v23 = [obj countByEnumeratingWithState:&v74 objects:v85 count:16];
      }

      while (v23);
    }

    downloadedCopy = v64;
    i = iCopy;
    v18 = v61;
  }

  else
  {
    [v17 addObject:downloadedCopy];
  }

  v72 = 0u;
  v73 = 0u;
  v70 = 0u;
  v71 = 0u;
  v62 = v18;
  v38 = v63;
  obja = [v62 countByEnumeratingWithState:&v70 objects:v84 count:16];
  if (obja)
  {
    v67 = *v71;
    do
    {
      for (j = 0; j != obja; j = j + 1)
      {
        if (*v71 != v67)
        {
          objc_enumerationMutation(v62);
        }

        v40 = *(*(&v70 + 1) + 8 * j);
        if (v40)
        {
          [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:*(*(&v70 + 1) + 8 * j)];
          [(MADAutoAssetControlManager *)self secureCheckUngraftAll:locationCopy forSetDescriptorNoLongerLocked:v40];
          v41 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:v40];
          persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          v43 = [persistedDownloadedSetDescriptors persistedEntryAlreadyExists:v41 fromLocation:v38];

          if (v43)
          {
            persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v45 = [persistedDownloadedSetDescriptors2 persistedEntry:v41 fromLocation:v38];

            if (v45)
            {
              persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
              [persistedDownloadedSetDescriptors3 removePersistedEntry:v41 fromLocation:v38];

              latestDowloadedAtomicInstanceEntries = [v40 latestDowloadedAtomicInstanceEntries];
              v48 = [latestDowloadedAtomicInstanceEntries count];
              [v40 clientDomainName];
              v49 = v60 = v45;
              assetSetIdentifier2 = [v40 assetSetIdentifier];
              discoveredAtomicInstance = [v40 discoveredAtomicInstance];
              [MADAutoAssetHistory recordOperation:d toHistoryType:2 fromLayer:1 usageCount:v48 forClientDomainName:v49 forAssetSetIdentifier:assetSetIdentifier2 forAtomicInstance:discoveredAtomicInstance];

              i = iCopy;
              downloadedCopy = v64;

              v52 = [NSString alloc];
              summary = [v40 summary];
              v54 = [v52 initWithFormat:@"removed previously downloaded set-descriptor | toBeRemovedSeteDescriptor:%@", summary];
              [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:v63 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v41 removedSetDescriptor:v40 message:v54];

              v45 = v60;
            }

            else
            {
              summary = _MADLog(@"AutoControl");
              if (os_log_type_enabled(summary, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                summary2 = [v40 summary];
                *buf = 138543874;
                v79 = _updateLatestSummary;
                v80 = 2114;
                v81 = v63;
                v82 = 2114;
                v83 = summary2;
                _os_log_impl(&dword_0, summary, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:removeSetDescriptorDownloaded} unable to load persisted-set-descriptor file | toBeRemovedSeteDescriptor:%{public}@", buf, 0x20u);
              }
            }

            v38 = v63;
          }

          locationCopy = v65;
        }

        latestDownloadedAtomicInstance3 = [downloadedCopy latestDownloadedAtomicInstance];
        [(MADAutoAssetControlManager *)self atomicInstanceRemove:v38 setAtomicInstanceUUID:latestDownloadedAtomicInstance3 removingForReason:v38 historyOperation:i];
      }

      obja = [v62 countByEnumeratingWithState:&v70 objects:v84 count:16];
    }

    while (obja);
  }
}

- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByDescriptor:(id)descriptor
{
  typeCopy = type;
  specifierCopy = specifier;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [descriptor latestDowloadedAtomicInstanceEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        fullAssetSelector = [v12 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        if ([v13 stringIsEqual:assetType to:typeCopy])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = typeCopy;
          assetSpecifier = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:assetSpecifier to:specifierCopy];

          typeCopy = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByLookupResult:(id)result
{
  typeCopy = type;
  specifierCopy = specifier;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [result discoveredAtomicEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        fullAssetSelector = [v12 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        if ([v13 stringIsEqual:assetType to:typeCopy])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = typeCopy;
          assetSpecifier = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:assetSpecifier to:specifierCopy];

          typeCopy = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findSetEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByConfiguration:(id)configuration
{
  typeCopy = type;
  specifierCopy = specifier;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [configuration autoAssetEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        assetSelector = [v12 assetSelector];
        assetType = [assetSelector assetType];
        if ([v13 stringIsEqual:assetType to:typeCopy])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 assetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = typeCopy;
          assetSpecifier = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:assetSpecifier to:specifierCopy];

          typeCopy = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (id)findAtomicEntryForAssetType:(id)type forAssetSpecifier:(id)specifier representedByStatus:(id)status
{
  typeCopy = type;
  specifierCopy = specifier;
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = [status latestDowloadedAtomicInstanceEntries];
  v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = *v27;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v11 = 0;
      v23 = v8;
      do
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * v11);
        v13 = p_weak_ivar_lyt[223];
        fullAssetSelector = [v12 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        if ([v13 stringIsEqual:assetType to:typeCopy])
        {
          v16 = p_weak_ivar_lyt[223];
          [v12 fullAssetSelector];
          v17 = v9;
          v18 = p_weak_ivar_lyt;
          v20 = v19 = typeCopy;
          assetSpecifier = [v20 assetSpecifier];
          LODWORD(v16) = [v16 stringIsEqual:assetSpecifier to:specifierCopy];

          typeCopy = v19;
          p_weak_ivar_lyt = v18;
          v9 = v17;
          v8 = v23;

          if (v16)
          {
            v8 = v12;
            goto LABEL_12;
          }
        }

        else
        {
        }

        v11 = v11 + 1;
      }

      while (v8 != v11);
      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

LABEL_12:

  return v8;
}

- (void)initialStatusForJob:(id)job usingSelector:(id)selector withJobUUID:(id)d downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor withClientAssetPolicy:(id)policy
{
  selectorCopy = selector;
  descriptorCopy = descriptor;
  policyCopy = policy;
  patchDescriptorCopy = patchDescriptor;
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (descriptorCopy)
  {
    downloadUserInitiated = [descriptorCopy downloadUserInitiated];
    if (!policyCopy)
    {
      goto LABEL_4;
    }

    goto LABEL_3;
  }

  downloadUserInitiated = 0;
  if (policyCopy)
  {
LABEL_3:
    downloadUserInitiated |= [policyCopy userInitiated];
  }

LABEL_4:
  currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  v19 = [(MADAutoAssetControlManager *)self jobSelectorKey:selectorCopy];
  v20 = [currentStatusBySelector safeObjectForKey:v19 ofClass:objc_opt_class()];

  v21 = objc_alloc_init(MAAutoAssetNotifications);
  metadata = [descriptorCopy metadata];
  if (descriptorCopy)
  {
    neverBeenLocked = [descriptorCopy neverBeenLocked];
    patchingAttempted = [descriptorCopy patchingAttempted];
    stagedPriorToAvailable = [descriptorCopy stagedPriorToAvailable];
    [descriptorCopy stagedFromOSVersion];
    v25 = v36 = policyCopy;
    [descriptorCopy stagedFromBuildVersion];
    v26 = v35 = v20;
    patchingAttemptError = [descriptorCopy patchingAttemptError];
    LOBYTE(v33) = 0;
    BYTE1(v32) = stagedPriorToAvailable;
    LOBYTE(v32) = patchingAttempted;
    LOBYTE(v31) = 0;
    v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:selectorCopy withNotifications:v21 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated & 1 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v31 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v32 withStagedPriorToAvailable:v25 withStagedFromOSVersion:v26 withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:0 withAvailableForUseError:patchingAttemptError withPatchingAttemptError:0 withNewerVersionError:?];

    v20 = v35;
    policyCopy = v36;
  }

  else
  {
    LOBYTE(v33) = 0;
    LOWORD(v32) = 0;
    LOBYTE(v31) = 0;
    v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:selectorCopy withNotifications:v21 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:downloadUserInitiated & 1 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v31 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v32 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];
  }

  if (v20)
  {
    v29 = @"INITIAL(again)";
  }

  else
  {
    v29 = @"INITIAL(first)";
  }

  assetVersion = [selectorCopy assetVersion];
  [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:v29 currentStatus:v28 forAssetSelector:selectorCopy forActiveJobUUID:dCopy matchingAssetVersion:assetVersion downloadingDescriptor:descriptorCopy baseForPatchDescriptor:patchDescriptorCopy];
}

- (void)initialStatusForSetJob:(id)job withJobUUID:(id)d usingSetDescriptor:(id)descriptor usingSetPolicy:(id)policy
{
  jobCopy = job;
  dCopy = d;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (descriptorCopy)
  {
    clientDomainName = [descriptorCopy clientDomainName];
    assetSetIdentifier = [descriptorCopy assetSetIdentifier];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
    [currentSetJobsByIdentifier setSafeObject:jobCopy forKey:autoControlManagerFSM2];

    currentJobsByUUID = [(MADAutoAssetControlManager *)self currentJobsByUUID];
    [currentJobsByUUID setSafeObject:jobCopy forKey:dCopy];

    activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
    [activeSetDescriptorsByIdentifier setSafeObject:descriptorCopy forKey:autoControlManagerFSM2];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    activeSetDescriptorsByIdentifier = [autoControlManagerFSM2 diag];
    [activeSetDescriptorsByIdentifier trackAnomaly:@"{initialStatusForSetJob}" forReason:@"Unable to generate initial set status due to nil assignedSetDescriptor" withResult:6108 withError:0];
  }

  discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];

  if (discoveredAtomicInstance)
  {
    activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
    discoveredAtomicInstance2 = [descriptorCopy discoveredAtomicInstance];
    [activeSetDescriptorsByInstance setSafeObject:descriptorCopy forKey:discoveredAtomicInstance2];
  }
}

- (void)updateAutoAssetStatus:(id)status forActiveJobUUID:(id)d withLatestJobStatus:(id)jobStatus matchingAssetVersion:(id)version fromLocation:(id)location
{
  statusCopy = status;
  dCopy = d;
  jobStatusCopy = jobStatus;
  versionCopy = version;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:updateAutoAssetStatus", locationCopy];
  if (jobStatusCopy)
  {
    v49 = versionCopy;
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) == 0)
    {
      v20 = _MADLog(@"Auto");
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{MADAutoAssetControlManager-updateAutoAssetStatus} WARNING: wrong class provided as autoAssetStatus", buf, 2u);
      }
    }

    currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
    v22 = [(MADAutoAssetControlManager *)self jobSelectorKey:statusCopy];
    v23 = [currentStatusBySelector safeObjectForKey:v22 ofClass:objc_opt_class()];

    versionCopy = v49;
    [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:@"UPDATE" currentStatus:jobStatusCopy forAssetSelector:statusCopy forActiveJobUUID:dCopy matchingAssetVersion:v49 downloadingDescriptor:0 baseForPatchDescriptor:0];
    if (!dCopy)
    {
      goto LABEL_24;
    }

    if (!v23)
    {
      goto LABEL_24;
    }

    assetVersion = [statusCopy assetVersion];

    if (!assetVersion)
    {
      goto LABEL_24;
    }

    persistedEntryID = [statusCopy persistedEntryID];
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v27 = [persistedActiveJobs persistedEntryAlreadyExists:persistedEntryID fromLocation:locationCopy];

    if (!v27)
    {
      v29 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [jobStatusCopy summary];
        *buf = 138544130;
        v51 = _updateLatestSummary;
        v52 = 2114;
        v53 = locationCopy;
        v54 = 2114;
        v55 = summary;
        v56 = 2114;
        v57 = dCopy;
        _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] UPDATE_STATUS | %{public}@ | currentStatus:%{public}@ | jobUUID:%{public}@ | no currently persisted active-job descriptor (presumed stale)", buf, 0x2Au);
      }

      goto LABEL_23;
    }

    persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v29 = [persistedActiveJobs2 persistedEntry:persistedEntryID fromLocation:locationCopy];

    if (v29)
    {
      downloadUserInitiated = [jobStatusCopy downloadUserInitiated];
      if (downloadUserInitiated == [v23 downloadUserInitiated])
      {
        patchingAttempted = [jobStatusCopy patchingAttempted];
        if (patchingAttempted == [v23 patchingAttempted])
        {
          goto LABEL_23;
        }
      }

      persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v33 = [persistedActiveJobs3 decodeFromLocation:locationCopy ofEntryName:persistedEntryID fromPersistedEntry:v29 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v33)
      {
LABEL_22:

LABEL_23:
        versionCopy = v49;
LABEL_24:

        goto LABEL_25;
      }

      patchedFromBaseSelector = [v33 patchedFromBaseSelector];

      if (patchedFromBaseSelector)
      {
        patchedFromBaseSelector2 = [v33 patchedFromBaseSelector];
        assetType = [patchedFromBaseSelector2 assetType];
        patchedFromBaseSelector3 = [v33 patchedFromBaseSelector];
        assetSpecifier = [patchedFromBaseSelector3 assetSpecifier];
        patchedFromBaseSelector4 = [v33 patchedFromBaseSelector];
        assetVersion2 = [patchedFromBaseSelector4 assetVersion];
        v43 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:locationCopy forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion2];

        patchedFromBaseSelector = v43;
      }

      [(MADAutoAssetControlManager *)self _trackActiveDescriptor:locationCopy operation:@"ENTRY_MODIFY" usingSelector:statusCopy withJobUUID:dCopy triggeredByClientMessage:0 downloadingDescriptor:v33 baseForPatchDescriptor:patchedFromBaseSelector message:@"update the current status of the auto-asset-job"];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      patchedFromBaseSelector = [autoControlManagerFSM2 diag];
      v33 = autoControlManagerFSM2;
      v42 = [[NSString alloc] initWithFormat:@"{%@} no jobPersistedState | persistedEntryID:%@", locationCopy, persistedEntryID];
      [patchedFromBaseSelector trackAnomaly:@"AUTO-CONTROL" forReason:v42 withResult:6101 withError:0];
    }

    goto LABEL_22;
  }

  autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM3 diag];
  v38 = [[NSString alloc] initWithFormat:@"{%@} no progress status", locationCopy];
  [diag trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6101 withError:0];

LABEL_25:
}

- (void)updateAutoAssetStatusForChosenDownloadedDescriptor:(id)descriptor matchingAssetVersion:(id)version fromLocation:(id)location
{
  selfCopy = self;
  locationCopy = location;
  versionCopy = version;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];
  v35 = [v11 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  v15 = objc_alloc_init(MAAutoAssetNotifications);
  [v15 setContentAvailableForUse:1];
  metadata = [descriptorCopy metadata];
  neverBeenLocked = [descriptorCopy neverBeenLocked];
  downloadUserInitiated = [descriptorCopy downloadUserInitiated];
  downloadedNetworkBytes = [descriptorCopy downloadedNetworkBytes];
  downloadedFilesystemBytes = [descriptorCopy downloadedFilesystemBytes];
  LOBYTE(selfCopy) = [descriptorCopy isPatch];
  patchedFromBaseSelector = [descriptorCopy patchedFromBaseSelector];
  patchedFromBaseFilesystemBytes = [descriptorCopy patchedFromBaseFilesystemBytes];
  patchingAttempted = [descriptorCopy patchingAttempted];
  stagedPriorToAvailable = [descriptorCopy stagedPriorToAvailable];
  stagedFromOSVersion = [descriptorCopy stagedFromOSVersion];
  stagedFromBuildVersion = [descriptorCopy stagedFromBuildVersion];
  patchingAttemptError = [descriptorCopy patchingAttemptError];

  LOBYTE(v26) = 0;
  BYTE1(v25) = stagedPriorToAvailable;
  LOBYTE(v25) = patchingAttempted;
  LOBYTE(v24) = selfCopy;
  v23 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v35 withNotifications:v15 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:0 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v24 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v25 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:stagedFromBuildVersion withStagedFromBuildVersion:v26 extendingWithCurrentLockUsage:0 withAvailableForUseError:patchingAttemptError withPatchingAttemptError:0 withNewerVersionError:?];

  [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v35 forActiveJobUUID:0 withLatestJobStatus:v23 matchingAssetVersion:versionCopy fromLocation:locationCopy];
}

- (id)updateAutoAssetStatus:(id)status forActiveJobUUID:(id)d forJobResponse:(id)response withResponseError:(id)error
{
  statusCopy = status;
  dCopy = d;
  responseCopy = response;
  errorCopy = error;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  message = [responseCopy message];
  v15 = [message safeObjectForKey:@"found" ofClass:objc_opt_class()];

  currentStatus = [v15 currentStatus];
  v80 = responseCopy;
  if (currentStatus || ((v17 = objc_alloc_init(MAAutoAssetNotifications), !errorCopy) ? (v53 = 0, v52 = 0u, LOBYTE(v51) = 0, v50 = 0u) : (v50 = 0uLL, v53 = errorCopy, v52 = errorCopy, LOBYTE(v51) = 0), LOWORD(v49) = 0, LOBYTE(v48) = 0, currentStatus = [MADAutoAssetControlManager newAssetStatusForSelector:"newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:" withNotifications:statusCopy withAvailableForUseAttributes:v17 withNewerVersionAttributes:0 withNeverBeenLocked:0 withDownloadUserInitiated:1 withDownloadProgress:0 withDownloadedNetworkBytes:0 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:-1 withPatchedFromBaseSelector:v48 withPatchedFromBaseFilesystemBytes:0 withPatchingAttempted:-1 withStagedPriorToAvailable:v49 withStagedFromOSVersion:v50 withStagedFromBuildVersion:v51 extendingWithCurrentLockUsage:v52 withAvailableForUseError:v53 withPatchingAttemptError:? withNewerVersionError:?], v17, currentStatus))
  {
    assetVersion = [statusCopy assetVersion];
    selfCopy = self;
    [(MADAutoAssetControlManager *)self updateCurrentAssetStatus:@"FINAL" currentStatus:currentStatus forAssetSelector:statusCopy forActiveJobUUID:dCopy matchingAssetVersion:assetVersion downloadingDescriptor:0 baseForPatchDescriptor:0];

    message2 = [v80 message];
    v20 = [message2 safeObjectForKey:@"instance" ofClass:objc_opt_class()];
    v21 = [message2 safeObjectForKey:@"found" ofClass:objc_opt_class()];
    v71 = [message2 safeObjectForKey:@"desire" ofClass:objc_opt_class()];
    v73 = [message2 safeObjectForKey:@"end" ofClass:objc_opt_class()];
    v70 = message2;
    v72 = [message2 safeObjectForKey:@"listen" ofClass:objc_opt_class()];
    v22 = objc_alloc_init(NSMutableDictionary);
    v23 = currentStatus;
    if (v20)
    {
      [v22 setSafeObject:v20 forKey:@"instance"];
    }

    v75 = v20;
    v76 = v23;
    v79 = v22;
    v68 = v21;
    if (v80)
    {
      assetSelector = [v23 assetSelector];
      notifications = [v23 notifications];
      availableForUseAttributes = [v23 availableForUseAttributes];
      newerVersionAttributes = [v23 newerVersionAttributes];
      neverBeenLocked = [v23 neverBeenLocked];
      downloadUserInitiated = [v23 downloadUserInitiated];
      downloadProgress = [v23 downloadProgress];
      downloadedNetworkBytes = [v23 downloadedNetworkBytes];
      downloadedFilesystemBytes = [v23 downloadedFilesystemBytes];
      downloadedAsPatch = [v23 downloadedAsPatch];
      patchedFromBaseSelector = [v23 patchedFromBaseSelector];
      patchedFromBaseFilesystemBytes = [v23 patchedFromBaseFilesystemBytes];
      patchingAttempted = [v23 patchingAttempted];
      stagedPriorToAvailable = [v23 stagedPriorToAvailable];
      stagedFromOSVersion = [v23 stagedFromOSVersion];
      [v23 stagedFromBuildVersion];
      v26 = v66 = v15;
      [v23 availableForUseError];
      v27 = v67 = statusCopy;
      patchingAttemptError = [v23 patchingAttemptError];
      newerVersionError = [v23 newerVersionError];
      LOBYTE(v51) = 1;
      BYTE1(v49) = stagedPriorToAvailable;
      LOBYTE(v49) = patchingAttempted;
      LOBYTE(v48) = downloadedAsPatch;
      v76 = [(MADAutoAssetControlManager *)selfCopy newAssetStatusForSelector:assetSelector withNotifications:notifications withAvailableForUseAttributes:availableForUseAttributes withNewerVersionAttributes:newerVersionAttributes withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:downloadProgress withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v48 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v49 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:v26 withStagedFromBuildVersion:v51 extendingWithCurrentLockUsage:v27 withAvailableForUseError:patchingAttemptError withPatchingAttemptError:newerVersionError withNewerVersionError:?];

      statusCopy = v67;
      v15 = v66;

      v22 = v79;
    }

    if (!v20)
    {
      goto LABEL_18;
    }

    v30 = [MAAutoAssetInfoFound alloc];
    clientAssetSelector = [v20 clientAssetSelector];
    if (v21)
    {
      localContentURL = [v21 localContentURL];
      assetAttributes = [v21 assetAttributes];
    }

    else
    {
      localContentURL = 0;
      assetAttributes = 0;
    }

    v34 = [v30 initForSelector:clientAssetSelector withLocalContentURL:localContentURL withAssetAttributes:assetAttributes reportingStatus:v76];
    if (v21)
    {
    }

    v20 = v75;
    v22 = v79;
    if (v34)
    {
      [v79 setSafeObject:v34 forKey:@"found"];
    }

    else
    {
LABEL_18:
      v34 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
        summary = [statusCopy summary];
        if (v20)
        {
          [v20 summary];
          v38 = v37 = v20;
        }

        else
        {
          v37 = 0;
          v38 = @"N";
        }

        *buf = 138543874;
        v82 = _updateLatestSummary;
        v83 = 2114;
        v84 = summary;
        v85 = 2114;
        v86 = v38;
        _os_log_impl(&dword_0, v34, OS_LOG_TYPE_ERROR, "[%{public}@] {updateAutoAssetStatus[%{public}@]} final status reported without found information | instance:%{public}@", buf, 0x20u);
        if (v37)
        {
        }

        v20 = v75;
        v21 = v68;
        v22 = v79;
      }
    }

    v42 = v71;
    if (v71)
    {
      [v22 setSafeObject:v71 forKey:@"desire"];
    }

    if (v73)
    {
      [v22 setSafeObject:v73 forKey:@"end"];
    }

    if (v72)
    {
      [v22 setSafeObject:v72 forKey:@"listen"];
    }

    if (v80)
    {
      v43 = [SUCoreConnectMessage alloc];
      messageName = [v80 messageName];
      clientID = [v80 clientID];
      v46 = v43;
      v42 = v71;
      v41 = [v46 initWithType:2 messageName:messageName clientID:clientID version:0 message:v79];

      v20 = v75;
      v22 = v79;
    }

    else
    {
      v41 = 0;
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:@"{updateAutoAssetStatus} no final status" withResult:6101 withError:0];

    v41 = v80;
  }

  return v41;
}

- (id)updateAutoAssetSetStatus:(id)status forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier forJobResponse:(id)response withResponseError:(id)error clearingDownloadProgressReason:(id)reason withAssetSetStatus:(id)setStatus
{
  statusCopy = status;
  domainCopy = domain;
  identifierCopy = identifier;
  responseCopy = response;
  reasonCopy = reason;
  selfCopy = self;
  setStatusCopy = setStatus;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v24 = responseCopy;
  v25 = reasonCopy;
  v26 = v25;
  v106 = setStatusCopy;
  if (v24)
  {
    v107 = statusCopy;
    message = [v24 message];
    v28 = domainCopy;
    v29 = [MASAutoAssetSetInfoFound newShimmedFromFrameworkMessage:message forKey:@"setFound"];

    v96 = v28;
    v105 = identifierCopy;
    v108 = [(MADAutoAssetControlManager *)selfCopy setConfigurationForClientDomain:v28 forAssetSetIdentifier:identifierCopy];
    currentSetStatus = [v29 currentSetStatus];
    v31 = currentSetStatus;
    v104 = selfCopy;
    v94 = v26;
    v95 = v24;
    if (!setStatusCopy || currentSetStatus)
    {
      v32 = v26;
      if (!currentSetStatus)
      {
        v36 = objc_alloc_init(MANAutoAssetSetNotifications);
        v37 = [MADAutoAssetScheduler newSetPolicyForDomainName:v96 forAssetSetIdentifier:v105];
        v38 = +[MADAutoAssetControlManager stagerSetPolicy];
        availableForUseError = [v108 availableForUseError];
        newerVersionError = [v108 newerVersionError];
        v41 = newerVersionError;
        if (error)
        {
          v42 = @"set-job failed (generating current-status)";
        }

        else
        {
          v42 = @"set-job success (generating current-status)";
        }

        v43 = @"set-job failed";
        if (!error)
        {
          v43 = @"generic final successful set-job status";
        }

        v109 = v43;
        LOBYTE(v80) = 0;
        LOBYTE(v79) = 0;
        LOBYTE(v78) = 0;
        v31 = [(MADAutoAssetControlManager *)selfCopy newAssetSetStatus:statusCopy forReason:v42 forClientDomain:v96 forAssetSetIdentifier:v105 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v78 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:v36 withCurrentNeedPolicy:0 withSchedulerPolicy:v37 withStagerPolicy:v38 withDownloadUserInitiated:v79 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v80 withSelectorsForStaging:0 withAvailableForUseError:availableForUseError withNewerVersionError:newerVersionError];

        v26 = v94;
        if (!v31)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{updateAutoAssetSetStatus} no final status" withResult:6101 withError:0];
          v33 = 0;
          v34 = 0;
          v24 = v95;
          v35 = v95;
          identifierCopy = v105;
LABEL_35:

          domainCopy = v96;
          statusCopy = v107;
          selfCopy = v104;
          goto LABEL_36;
        }

        v24 = v95;
        v32 = v109;
      }
    }

    else
    {
      v31 = setStatusCopy;
      v32 = v26;
    }

    atomicInstancesDownloaded = [v31 atomicInstancesDownloaded];
    if (!atomicInstancesDownloaded)
    {
      latestDownloadedAtomicInstance = [v31 latestDownloadedAtomicInstance];

      if (!latestDownloadedAtomicInstance)
      {
LABEL_18:
        if (v26)
        {
          v47 = [(MADAutoAssetControlManager *)selfCopy _currentSetStatusClearDownloadProgress:statusCopy clearingSetStatus:v31 forClearingReason:v26];

          v31 = v47;
        }

        v93 = v29;
        [(MADAutoAssetControlManager *)selfCopy _updateCurrentSetStatus:@"FINAL_SET_STATUS" forSetIdentifier:v105 withSetStatus:v31];
        message2 = [v24 message];
        v49 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:message2 forKey:@"setInstance"];
        v98 = [MASAutoAssetSetInfoFound newShimmedFromFrameworkMessage:message2 forKey:@"setFound"];
        v103 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:message2 forKey:@"setDesire"];
        v92 = message2;
        v90 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:message2 forKey:@"setEnd"];
        v50 = objc_alloc_init(NSMutableDictionary);
        v51 = v31;
        if (v49)
        {
          v52 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v49];
          [v50 setSafeObject:v52 forKey:@"setInstance"];
        }

        v89 = v50;
        clientDomainName = [v51 clientDomainName];
        assetSetIdentifier = [v51 assetSetIdentifier];
        atomicInstancesDownloaded2 = [v51 atomicInstancesDownloaded];
        newerAtomicInstanceDiscovered = [v51 newerAtomicInstanceDiscovered];
        newerDiscoveredAtomicEntries = [v51 newerDiscoveredAtomicEntries];
        latestDownloadedAtomicInstance2 = [v51 latestDownloadedAtomicInstance];
        latestAtomicInstanceToVendFromPreSUStaging = [v108 latestAtomicInstanceToVendFromPreSUStaging];
        latestDowloadedAtomicInstanceEntries = [v51 latestDowloadedAtomicInstanceEntries];
        currentNotifications = [v51 currentNotifications];
        currentNeedPolicy = [v51 currentNeedPolicy];
        clientDomainName2 = [v51 clientDomainName];
        assetSetIdentifier2 = [v51 assetSetIdentifier];
        v84 = clientDomainName2;
        v56 = [MADAutoAssetScheduler newSetPolicyForDomainName:clientDomainName2 forAssetSetIdentifier:?];
        v57 = +[MADAutoAssetControlManager stagerSetPolicy];
        downloadUserInitiated = [v51 downloadUserInitiated];
        v109 = v32;
        v91 = v49;
        v85 = newerAtomicInstanceDiscovered;
        if (v32)
        {
          v59 = assetSetIdentifier;
          downloadProgress = 0;
        }

        else
        {
          v59 = assetSetIdentifier;
          downloadProgress = [v51 downloadProgress];
        }

        downloadedNetworkBytes = [v51 downloadedNetworkBytes];
        downloadedFilesystemBytes = [v51 downloadedFilesystemBytes];
        selectorsForStaging = [v51 selectorsForStaging];
        availableForUseError2 = [v108 availableForUseError];
        newerVersionError2 = [v108 newerVersionError];
        LOBYTE(v80) = 1;
        LOBYTE(v79) = downloadUserInitiated;
        LOBYTE(v78) = latestAtomicInstanceToVendFromPreSUStaging;
        v82 = [(MADAutoAssetControlManager *)v104 newAssetSetStatus:v107 forReason:@"issuing response to client" forClientDomain:clientDomainName forAssetSetIdentifier:v59 withAtomicInstancesDownloaded:atomicInstancesDownloaded2 withNewerAtomicInstanceDiscovered:v85 withNewerDiscoveredAtomicEntries:newerDiscoveredAtomicEntries withLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance2 withLatestDownloadedAtomicInstanceFromPreSUStaging:v78 withLatestDowloadedAtomicInstanceEntries:latestDowloadedAtomicInstanceEntries withCurrentNotifications:currentNotifications withCurrentNeedPolicy:currentNeedPolicy withSchedulerPolicy:v56 withStagerPolicy:v57 withDownloadUserInitiated:v79 withDownloadProgress:downloadProgress withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes extendingWithCurrentLockUsage:v80 withSelectorsForStaging:selectorsForStaging withAvailableForUseError:availableForUseError2 withNewerVersionError:newerVersionError2];

        if (!v109)
        {
        }

        v34 = v82;
        identifierCopy = v105;
        v65 = [[MANAutoAssetSetInfoFound alloc] initForAssetSetIdentifier:v105 reportingStatus:v34];
        if (v65)
        {
          v66 = v65;
        }

        else
        {
          v66 = v98;
        }

        v67 = [MASAutoAssetSetInfoFound newShimmedToFramework:v66];
        v24 = v95;
        [v89 setSafeObject:v67 forKey:@"setFound"];

        if (v103)
        {
          v68 = [MASAutoAssetSetInfoDesire newShimmedToFramework:v103];
          [v89 setSafeObject:v68 forKey:@"setDesire"];
        }

        if (v90)
        {
          v69 = [MASAutoAssetSetInfoEnd newShimmedToFramework:v90];
          [v89 setSafeObject:v69 forKey:@"setEnd"];
        }

        v70 = [SUCoreConnectMessage alloc];
        messageName = [v95 messageName];
        clientID = [v95 clientID];
        v35 = [v70 initWithType:2 messageName:messageName clientID:clientID version:0 message:v89];

        v33 = 1;
        autoControlManagerFSM2 = v92;
        diag = v91;
        v29 = v93;
        v26 = v94;
        goto LABEL_35;
      }

      atomicInstancesDownloaded = objc_alloc_init(NSMutableArray);
      latestDownloadedAtomicInstance3 = [v31 latestDownloadedAtomicInstance];
      [atomicInstancesDownloaded addObject:latestDownloadedAtomicInstance3];

      [v31 setAtomicInstancesDownloaded:atomicInstancesDownloaded];
    }

    goto LABEL_18;
  }

  v33 = 0;
  v34 = 0;
  v35 = 0;
  v109 = v25;
LABEL_36:
  v75 = v34;
  if ((v33 & 1) == 0)
  {
    v75 = v34;
    if (v109)
    {
      v76 = v34;
      if (identifierCopy)
      {
        v76 = v34;
        if (domainCopy)
        {
          v76 = v34;
          if (!v34)
          {
            v76 = [(MADAutoAssetControlManager *)selfCopy locateSetStatusForDomainName:domainCopy byIdentifier:identifierCopy];
          }
        }
      }

      v75 = [(MADAutoAssetControlManager *)selfCopy _currentSetStatusClearDownloadProgress:statusCopy clearingSetStatus:v76 forClearingReason:v109];

      if (v75)
      {
        [(MADAutoAssetControlManager *)selfCopy _updateCurrentSetStatus:v109 forSetIdentifier:identifierCopy withSetStatus:v75];
      }
    }
  }

  return v35;
}

- (void)updateAutoAssetSetStatus:(id)status forSetDescriptor:(id)descriptor
{
  statusCopy = status;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  v10 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:latestDownloadedAtomicInstance];

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  selfCopy = self;
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  v91 = v13;
  v86 = descriptorCopy;
  if (v10 || ([descriptorCopy discoveredAtomicInstance], v14 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusByInstance:](self, "locateSetStatusByInstance:", v14), v10 = objc_claimAutoreleasedReturnValue(), v14, v10))
  {
    currentNotifications = [(MANAutoAssetSetNotifications *)v10 currentNotifications];
    discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];
    [currentNotifications setAtomicInstanceDiscovered:discoveredAtomicInstance != 0];

    if ([descriptorCopy isOnFilesystem])
    {
      v17 = [descriptorCopy onFilesystemIncomplete] ^ 1;
    }

    else
    {
      v17 = 0;
    }

    [currentNotifications setAtomicInstanceAvailableForUse:v17];
    [currentNotifications setDownloadedBecameIncomplete:{objc_msgSend(descriptorCopy, "onFilesystemIncomplete")}];
    clientDomainName2 = [descriptorCopy clientDomainName];
    assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
    v76 = [(MADAutoAssetControlManager *)self _newAtomicInstancesDownloadedForSetIdentifier:descriptorCopy];
    discoveredAtomicInstance2 = [descriptorCopy discoveredAtomicInstance];
    discoveredAtomicEntries = [descriptorCopy discoveredAtomicEntries];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    latestAtomicInstanceToVendFromPreSUStaging = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    currentNeedPolicy = [(MANAutoAssetSetNotifications *)v10 currentNeedPolicy];
    clientDomainName3 = [descriptorCopy clientDomainName];
    assetSetIdentifier3 = [descriptorCopy assetSetIdentifier];
    v89 = clientDomainName3;
    v19 = [MADAutoAssetScheduler newSetPolicyForDomainName:clientDomainName3 forAssetSetIdentifier:?];
    v20 = +[MADAutoAssetControlManager stagerSetPolicy];
    v85 = v10;
    v21 = v13;
    downloadUserInitiated = [descriptorCopy downloadUserInitiated];
    downloadedNetworkBytes = [descriptorCopy downloadedNetworkBytes];
    downloadedFilesystemBytes = [descriptorCopy downloadedFilesystemBytes];
    availableForUseError = [v21 availableForUseError];
    newerVersionError = [v21 newerVersionError];
    LOBYTE(v71) = 0;
    v68 = downloadedNetworkBytes;
    v70 = downloadedFilesystemBytes;
    LOBYTE(v67) = downloadUserInitiated;
    newerVersionError2 = v20;
    v64 = v19;
    v65 = v20;
    v82 = v19;
    clientDomainName4 = currentNotifications;
    LOBYTE(v62) = latestAtomicInstanceToVendFromPreSUStaging;
    v28 = discoveredAtomicEntries;
    v29 = latestDownloadedAtomicInstance2;
    v30 = clientDomainName2;
    v31 = assetSetIdentifier2;
    v32 = discoveredAtomicInstance2;
    v33 = v76;
    v34 = [MADAutoAssetControlManager newAssetSetStatus:selfCopy forReason:"newAssetSetStatus:forReason:forClientDomain:forAssetSetIdentifier:withAtomicInstancesDownloaded:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:extendingWithCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" forClientDomain:statusCopy forAssetSetIdentifier:@"previous set-status found" withAtomicInstancesDownloaded:discoveredAtomicEntries withNewerAtomicInstanceDiscovered:latestDownloadedAtomicInstance2 withNewerDiscoveredAtomicEntries:v62 withLatestDownloadedAtomicInstance:latestDowloadedAtomicInstanceEntries withLatestDownloadedAtomicInstanceFromPreSUStaging:currentNotifications withLatestDowloadedAtomicInstanceEntries:currentNeedPolicy withCurrentNotifications:v64 withCurrentNeedPolicy:v65 withSchedulerPolicy:v67 withStagerPolicy:0 withDownloadUserInitiated:v68 withDownloadProgress:v70 withDownloadedNetworkBytes:v71 withDownloadedFilesystemBytes:0 extendingWithCurrentLockUsage:availableForUseError withSelectorsForStaging:newerVersionError withAvailableForUseError:? withNewerVersionError:?];
  }

  else
  {
    v48 = objc_alloc_init(MANAutoAssetSetNotifications);
    discoveredAtomicInstance3 = [descriptorCopy discoveredAtomicInstance];
    [(MANAutoAssetSetNotifications *)v48 setAtomicInstanceDiscovered:discoveredAtomicInstance3 != 0];

    if ([descriptorCopy isOnFilesystem])
    {
      v50 = [descriptorCopy onFilesystemIncomplete] ^ 1;
    }

    else
    {
      v50 = 0;
    }

    [(MANAutoAssetSetNotifications *)v48 setAtomicInstanceAvailableForUse:v50];
    -[MANAutoAssetSetNotifications setDownloadedBecameIncomplete:](v48, "setDownloadedBecameIncomplete:", [descriptorCopy onFilesystemIncomplete]);
    clientDomainName4 = [descriptorCopy clientDomainName];
    assetSetIdentifier4 = [descriptorCopy assetSetIdentifier];
    v51 = [(MADAutoAssetControlManager *)self _newAtomicInstancesDownloadedForSetIdentifier:descriptorCopy];
    [descriptorCopy discoveredAtomicInstance];
    v33 = v52 = descriptorCopy;
    discoveredAtomicEntries2 = [v52 discoveredAtomicEntries];
    latestDownloadedAtomicInstance3 = [v52 latestDownloadedAtomicInstance];
    latestAtomicInstanceToVendFromPreSUStaging2 = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    latestDowloadedAtomicInstanceEntries2 = [v52 latestDowloadedAtomicInstanceEntries];
    clientDomainName5 = [v52 clientDomainName];
    [v52 assetSetIdentifier];
    currentNeedPolicy = v55 = v51;
    latestDowloadedAtomicInstanceEntries = clientDomainName5;
    v56 = [MADAutoAssetScheduler newSetPolicyForDomainName:clientDomainName5 forAssetSetIdentifier:?];
    v57 = +[MADAutoAssetControlManager stagerSetPolicy];
    downloadUserInitiated2 = [v52 downloadUserInitiated];
    downloadedNetworkBytes2 = [v52 downloadedNetworkBytes];
    downloadedFilesystemBytes2 = [v52 downloadedFilesystemBytes];
    [v13 availableForUseError];
    v59 = v48;
    v60 = v85 = v48;
    v61 = v13;
    v28 = latestDownloadedAtomicInstance3;
    v32 = discoveredAtomicEntries2;
    newerVersionError2 = [v61 newerVersionError];
    v72 = v60;
    v82 = v60;
    LOBYTE(v71) = 0;
    v69 = downloadedNetworkBytes2;
    LOBYTE(v67) = downloadUserInitiated2;
    assetSetIdentifier3 = v57;
    v66 = v57;
    v89 = v56;
    v29 = latestDowloadedAtomicInstanceEntries2;
    v63 = v59;
    LOBYTE(v62) = latestAtomicInstanceToVendFromPreSUStaging2;
    v30 = assetSetIdentifier4;
    v31 = v55;
    v34 = [MADAutoAssetControlManager newAssetSetStatus:selfCopy forReason:"newAssetSetStatus:forReason:forClientDomain:forAssetSetIdentifier:withAtomicInstancesDownloaded:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:extendingWithCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" forClientDomain:statusCopy forAssetSetIdentifier:@"no previous set-status" withAtomicInstancesDownloaded:clientDomainName4 withNewerAtomicInstanceDiscovered:v32 withNewerDiscoveredAtomicEntries:latestDownloadedAtomicInstance3 withLatestDownloadedAtomicInstance:v62 withLatestDownloadedAtomicInstanceFromPreSUStaging:latestDowloadedAtomicInstanceEntries2 withLatestDowloadedAtomicInstanceEntries:v63 withCurrentNotifications:0 withCurrentNeedPolicy:v56 withSchedulerPolicy:v66 withStagerPolicy:v67 withDownloadUserInitiated:0 withDownloadProgress:v69 withDownloadedNetworkBytes:downloadedFilesystemBytes2 withDownloadedFilesystemBytes:v71 extendingWithCurrentLockUsage:0 withSelectorsForStaging:v72 withAvailableForUseError:newerVersionError2 withNewerVersionError:?];
  }

  if (!v34)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:@"{updateAutoAssetSetStatus:forSetDescriptor:} no update status" withResult:6101 withError:0];

    v36 = v91;
    v37 = v86;
    goto LABEL_18;
  }

  atomicInstancesDownloaded = [v34 atomicInstancesDownloaded];
  v36 = v91;
  v37 = v86;
  if (atomicInstancesDownloaded)
  {
    goto LABEL_11;
  }

  latestDownloadedAtomicInstance4 = [v86 latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance4)
  {
    atomicInstancesDownloaded = objc_alloc_init(NSMutableArray);
    latestDownloadedAtomicInstance5 = [v86 latestDownloadedAtomicInstance];
    [atomicInstancesDownloaded addObject:latestDownloadedAtomicInstance5];

    [v34 setAtomicInstancesDownloaded:atomicInstancesDownloaded];
LABEL_11:
  }

  newerAtomicInstanceDiscovered = [v34 newerAtomicInstanceDiscovered];

  if (!newerAtomicInstanceDiscovered)
  {
    discoveredAtomicInstance4 = [v86 discoveredAtomicInstance];
    [v34 setNewerAtomicInstanceDiscovered:discoveredAtomicInstance4];

    discoveredAtomicEntries3 = [v86 discoveredAtomicEntries];
    [v34 setNewerDiscoveredAtomicEntries:discoveredAtomicEntries3];
  }

  latestDownloadedAtomicInstance6 = [v34 latestDownloadedAtomicInstance];

  if (!latestDownloadedAtomicInstance6)
  {
    latestDownloadedAtomicInstance7 = [v86 latestDownloadedAtomicInstance];
    [v34 setLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance7];

    latestDowloadedAtomicInstanceEntries3 = [v86 latestDowloadedAtomicInstanceEntries];
    [v34 setLatestDowloadedAtomicInstanceEntries:latestDowloadedAtomicInstanceEntries3];
  }

  autoControlManagerFSM2 = [v86 assetSetIdentifier];
  [(MADAutoAssetControlManager *)selfCopy _updateCurrentSetStatus:statusCopy forSetIdentifier:autoControlManagerFSM2 withSetStatus:v34];
LABEL_18:
}

- (void)updateCurrentAssetStatus:(id)status currentStatus:(id)currentStatus forAssetSelector:(id)selector forActiveJobUUID:(id)d matchingAssetVersion:(id)version downloadingDescriptor:(id)descriptor baseForPatchDescriptor:(id)patchDescriptor
{
  statusCopy = status;
  currentStatusCopy = currentStatus;
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v18 = [(MADAutoAssetControlManager *)self jobSelectorKey:selectorCopy];
  currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  [currentStatusBySelector setSafeObject:currentStatusCopy forKey:v18];

  objc_opt_class();
  if ((objc_opt_isKindOfClass() & 1) == 0)
  {
    v20 = _MADLog(@"Auto");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      *v22 = 0;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{MADAutoAssetControlManager-updateCurrentAssetStatus} WARNING: wrong class provided as jobStatus", v22, 2u);
    }
  }

  assetVersion = [selectorCopy assetVersion];

  if (!version && assetVersion)
  {
    [(MADAutoAssetControlManager *)self updateAssociatedNoVersionStatus:statusCopy currentStatus:currentStatusCopy forAssetSelector:selectorCopy];
  }
}

- (void)updateAssociatedNoVersionStatus:(id)status currentStatus:(id)currentStatus forAssetSelector:(id)selector
{
  selectorCopy = selector;
  currentStatusCopy = currentStatus;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = [MAAutoAssetSelector alloc];
  assetType = [selectorCopy assetType];
  assetSpecifier = [selectorCopy assetSpecifier];

  v44 = [v11 initForAssetType:assetType withAssetSpecifier:assetSpecifier];
  v14 = objc_alloc_init(MAAutoAssetNotifications);
  newerVersionAttributes = [currentStatusCopy newerVersionAttributes];
  [v14 setNewerVersionDiscovered:newerVersionAttributes != 0];

  newerVersionError = [currentStatusCopy newerVersionError];
  [v14 setCheckForNewerFailure:newerVersionError != 0];

  availableForUseAttributes = [currentStatusCopy availableForUseAttributes];
  [v14 setContentAvailableForUse:availableForUseAttributes != 0];

  downloadProgress = [currentStatusCopy downloadProgress];
  v43 = v14;
  [v14 setDownloadPending:downloadProgress != 0];

  downloadProgress2 = [currentStatusCopy downloadProgress];
  [v14 setDownloadProgress:downloadProgress2 != 0];

  availableForUseAttributes2 = [currentStatusCopy availableForUseAttributes];
  newerVersionAttributes2 = [currentStatusCopy newerVersionAttributes];
  downloadUserInitiated = [currentStatusCopy downloadUserInitiated];
  downloadProgress3 = [currentStatusCopy downloadProgress];
  downloadedNetworkBytes = [currentStatusCopy downloadedNetworkBytes];
  downloadedFilesystemBytes = [currentStatusCopy downloadedFilesystemBytes];
  downloadedAsPatch = [currentStatusCopy downloadedAsPatch];
  patchedFromBaseSelector = [currentStatusCopy patchedFromBaseSelector];
  patchedFromBaseFilesystemBytes = [currentStatusCopy patchedFromBaseFilesystemBytes];
  patchingAttempted = [currentStatusCopy patchingAttempted];
  stagedPriorToAvailable = [currentStatusCopy stagedPriorToAvailable];
  stagedFromOSVersion = [currentStatusCopy stagedFromOSVersion];
  stagedFromBuildVersion = [currentStatusCopy stagedFromBuildVersion];
  availableForUseError = [currentStatusCopy availableForUseError];
  patchingAttemptError = [currentStatusCopy patchingAttemptError];
  newerVersionError2 = [currentStatusCopy newerVersionError];

  LOBYTE(v33) = 0;
  BYTE1(v32) = stagedPriorToAvailable;
  LOBYTE(v32) = patchingAttempted;
  LOBYTE(v31) = downloadedAsPatch;
  v28 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v44 withNotifications:v43 withAvailableForUseAttributes:availableForUseAttributes2 withNewerVersionAttributes:newerVersionAttributes2 withNeverBeenLocked:1 withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:downloadProgress3 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v31 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v32 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:stagedFromBuildVersion withStagedFromBuildVersion:v33 extendingWithCurrentLockUsage:availableForUseError withAvailableForUseError:patchingAttemptError withPatchingAttemptError:newerVersionError2 withNewerVersionError:?];

  v29 = [(MADAutoAssetControlManager *)self jobSelectorKey:v44];
  currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  [currentStatusBySelector setSafeObject:v28 forKey:v29];
}

- (id)_currentSetStatusClearDownloadProgress:(id)progress clearingSetStatus:(id)status forClearingReason:(id)reason
{
  progressCopy = progress;
  statusCopy = status;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = statusCopy;
  v12 = v11;
  if (v11)
  {
    clientDomainName = [v11 clientDomainName];
    assetSetIdentifier = [v12 assetSetIdentifier];
    v15 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    downloadProgress = [v12 downloadProgress];

    v17 = v12;
    if (downloadProgress)
    {
      clientDomainName2 = [v12 clientDomainName];
      assetSetIdentifier2 = [v12 assetSetIdentifier];
      atomicInstancesDownloaded = [v12 atomicInstancesDownloaded];
      newerAtomicInstanceDiscovered = [v12 newerAtomicInstanceDiscovered];
      newerDiscoveredAtomicEntries = [v12 newerDiscoveredAtomicEntries];
      latestDownloadedAtomicInstance = [v12 latestDownloadedAtomicInstance];
      latestAtomicInstanceToVendFromPreSUStaging = [v15 latestAtomicInstanceToVendFromPreSUStaging];
      latestDowloadedAtomicInstanceEntries = [v12 latestDowloadedAtomicInstanceEntries];
      currentNotifications = [v12 currentNotifications];
      currentNeedPolicy = [v12 currentNeedPolicy];
      schedulerPolicy = [v12 schedulerPolicy];
      stagerPolicy = [v12 stagerPolicy];
      downloadUserInitiated = [v12 downloadUserInitiated];
      downloadedNetworkBytes = [v12 downloadedNetworkBytes];
      downloadedFilesystemBytes = [v12 downloadedFilesystemBytes];
      selectorsForStaging = [v12 selectorsForStaging];
      availableForUseError = [v15 availableForUseError];
      [v15 newerVersionError];
      v23 = v37 = v15;
      LOBYTE(v27) = 1;
      LOBYTE(v26) = downloadUserInitiated;
      LOBYTE(v25) = latestAtomicInstanceToVendFromPreSUStaging;
      v17 = [(MADAutoAssetControlManager *)self newAssetSetStatus:progressCopy forReason:reasonCopy forClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 withAtomicInstancesDownloaded:atomicInstancesDownloaded withNewerAtomicInstanceDiscovered:newerAtomicInstanceDiscovered withNewerDiscoveredAtomicEntries:newerDiscoveredAtomicEntries withLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance withLatestDownloadedAtomicInstanceFromPreSUStaging:v25 withLatestDowloadedAtomicInstanceEntries:latestDowloadedAtomicInstanceEntries withCurrentNotifications:currentNotifications withCurrentNeedPolicy:currentNeedPolicy withSchedulerPolicy:schedulerPolicy withStagerPolicy:stagerPolicy withDownloadUserInitiated:v26 withDownloadProgress:0 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes extendingWithCurrentLockUsage:v27 withSelectorsForStaging:selectorsForStaging withAvailableForUseError:availableForUseError withNewerVersionError:v23];

      v15 = v37;
    }
  }

  else
  {
    v17 = 0;
  }

  return v17;
}

- (void)_updateCurrentSetStatus:(id)status forSetIdentifier:(id)identifier withSetStatus:(id)setStatus
{
  identifierCopy = identifier;
  setStatusCopy = setStatus;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (identifierCopy && setStatusCopy)
  {
    currentSetStatusByInstance = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
    [currentSetStatusByInstance setSafeObject:setStatusCopy forKey:identifierCopy];

    newerAtomicInstanceDiscovered = [setStatusCopy newerAtomicInstanceDiscovered];

    if (newerAtomicInstanceDiscovered)
    {
      currentSetStatusByInstance2 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      newerAtomicInstanceDiscovered2 = [setStatusCopy newerAtomicInstanceDiscovered];
      [currentSetStatusByInstance2 setSafeObject:setStatusCopy forKey:newerAtomicInstanceDiscovered2];
    }

    latestDownloadedAtomicInstance = [setStatusCopy latestDownloadedAtomicInstance];

    if (latestDownloadedAtomicInstance)
    {
      latestDownloadedAtomicInstance2 = [setStatusCopy latestDownloadedAtomicInstance];
      newerAtomicInstanceDiscovered3 = [setStatusCopy newerAtomicInstanceDiscovered];
      v17 = [SUCore stringIsEqual:latestDownloadedAtomicInstance2 to:newerAtomicInstanceDiscovered3];

      if ((v17 & 1) == 0)
      {
        currentSetStatusByInstance3 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
        latestDownloadedAtomicInstance3 = [setStatusCopy latestDownloadedAtomicInstance];
        [currentSetStatusByInstance3 setSafeObject:setStatusCopy forKey:latestDownloadedAtomicInstance3];
      }
    }
  }
}

- (BOOL)statusErrorConsideredMatch:(id)match to:(id)to
{
  matchCopy = match;
  toCopy = to;
  v7 = toCopy;
  if (matchCopy | toCopy)
  {
    v8 = 0;
    if (matchCopy && toCopy)
    {
      domain = [matchCopy domain];
      domain2 = [v7 domain];
      if ([SUCore stringIsEqual:domain to:domain2])
      {
        code = [matchCopy code];
        code2 = [v7 code];

        if (code != code2)
        {
          v8 = 0;
          goto LABEL_12;
        }

        userInfo = [matchCopy userInfo];
        domain = [userInfo objectForKeyedSubscript:NSUnderlyingErrorKey];

        userInfo2 = [v7 userInfo];
        domain2 = [userInfo2 objectForKeyedSubscript:NSUnderlyingErrorKey];

        if (domain | domain2)
        {
          v8 = 0;
          if (domain && domain2)
          {
            v9Domain = [domain domain];
            v10Domain = [domain2 domain];
            if ([SUCore stringIsEqual:v9Domain to:v10Domain])
            {
              code3 = [domain code];
              v8 = code3 == [domain2 code];
            }

            else
            {
              v8 = 0;
            }
          }
        }

        else
        {
          v8 = 1;
        }
      }

      else
      {
        v8 = 0;
      }
    }
  }

  else
  {
    v8 = 1;
  }

LABEL_12:

  return v8;
}

- (id)notifyLockerJustLockedDescriptor:(id)descriptor forClientInstance:(id)instance withClientDesire:(id)desire respondingToClientRequest:(id)request withClientCompletion:(id)completion
{
  descriptorCopy = descriptor;
  instanceCopy = instance;
  desireCopy = desire;
  requestCopy = request;
  v15 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];
  v19 = [v15 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  clientRequestMessage = [requestCopy clientRequestMessage];
  v21 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

  assetType2 = [descriptorCopy assetType];
  assetId = [descriptorCopy assetId];
  v24 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType2, assetId, 2, @"auto");

  if (v24)
  {
    if (![SUCore stringIsEqual:v21 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
LABEL_7:
      v28 = 0;
      goto LABEL_14;
    }

    if (desireCopy)
    {
      if (completion)
      {
        clientRequestMessage2 = [requestCopy clientRequestMessage];
        v26 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage2];

        v45 = v26;
        if (v26)
        {
          autoControlManagerFSM = desireCopy;
          desireCopy = v26;
        }

        else
        {
          autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM diag];
          v34 = [NSString alloc];
          summary = [requestCopy summary];
          v36 = [v34 initWithFormat:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] client lock request without desire for clientRequest:%@", summary];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6111 withError:0];
        }

        autoAssetClientName = [instanceCopy autoAssetClientName];
        clientProcessName = [instanceCopy clientProcessName];
        clientProcessID = [instanceCopy clientProcessID];
        desireReason = [desireCopy desireReason];
        clientAssetPolicy = [desireCopy clientAssetPolicy];
        metadata = [descriptorCopy metadata];
        v47 = 0;
        v39 = clientAssetPolicy;
        [MADAutoAssetLocker lockedByClient:autoAssetClientName forClientProcessName:clientProcessName withClientProcessID:clientProcessID forAssetSelector:v19 forLockReason:desireReason withUsagePolicy:clientAssetPolicy withLocalContentURL:v24 withAssetAttributes:metadata lockError:&v47];
        v28 = v47;

        goto LABEL_14;
      }

      goto LABEL_7;
    }

    v28 = [MAAutoAssetError buildError:6102 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:@"[NOTIFY-LOCKER] no auto-asset-desire provided in client request"];
  }

  else
  {
    v29 = [NSString alloc];
    summary2 = [descriptorCopy summary];
    v31 = [v29 initWithFormat:@"unable to get local content URL | lockingDescriptor:%@", summary2];

    v28 = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:v31];
    v32 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v49 = v31;
      _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {notifyLockerJustLockedDescriptor} %{public}@", buf, 0xCu);
    }
  }

LABEL_14:

  return v28;
}

- (id)notifyLockerAsIndicatedByJob:(id)job
{
  jobCopy = job;
  responseError = [jobCopy responseError];
  setJobInformation = [jobCopy setJobInformation];

  if (setJobInformation)
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] should never be called for set-job" withResult:6103 withError:0];

    v9 = [MAAutoAssetError buildError:6103 fromOperation:@"IssueClientReplyJobResponse" underlyingError:0 withDescription:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] should never be called for set-job"];

    responseError = v9;
    goto LABEL_18;
  }

  jobInformation = [jobCopy jobInformation];
  clientRequest = [jobCopy clientRequest];
  clientRequestMessage = [clientRequest clientRequestMessage];
  v13 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

  clientInstance = [jobInformation clientInstance];
  clientDesire = [jobInformation clientDesire];
  foundContent = [jobInformation foundContent];
  fullAssetSelector = [jobInformation fullAssetSelector];
  if (!responseError)
  {
    if ([SUCore stringIsEqual:v13 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
    {
      if (clientDesire)
      {
        if (foundContent)
        {
          localContentURL = [foundContent localContentURL];
          if (localContentURL)
          {
            v19 = localContentURL;
            assetAttributes = [foundContent assetAttributes];

            if (assetAttributes)
            {
              clientReplyCompletion = [jobCopy clientReplyCompletion];

              if (clientReplyCompletion)
              {
                clientRequest2 = [jobCopy clientRequest];
                clientRequestMessage2 = [clientRequest2 clientRequestMessage];
                v43 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage2];

                if (v43)
                {
                  autoControlManagerFSM2 = clientDesire;
                  clientDesire = v43;
                }

                else
                {
                  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                  diag2 = [autoControlManagerFSM2 diag];
                  v28 = [NSString alloc];
                  summary = [jobCopy summary];
                  v29 = [v28 initWithFormat:@"{notifyLockerAsIndicatedByJob} [NOTIFY-LOCKER] client lock request without desire for eventInfo:%@", summary];
                  [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v29 withResult:6111 withError:0];
                }

                localContentURL2 = [foundContent localContentURL];

                if (localContentURL2)
                {
                  autoAssetClientName = [clientInstance autoAssetClientName];
                  clientProcessName = [clientInstance clientProcessName];
                  clientProcessID = [clientInstance clientProcessID];
                  desireReason = [clientDesire desireReason];
                  clientAssetPolicy = [clientDesire clientAssetPolicy];
                  localContentURL3 = [foundContent localContentURL];
                  assetAttributes2 = [foundContent assetAttributes];
                  v44 = 0;
                  [MADAutoAssetLocker lockedByClient:autoAssetClientName forClientProcessName:clientProcessName withClientProcessID:clientProcessID forAssetSelector:fullAssetSelector forLockReason:desireReason withUsagePolicy:clientAssetPolicy withLocalContentURL:localContentURL3 withAssetAttributes:assetAttributes2 lockError:&v44];
                  responseError = v44;

                  v32 = clientProcessName;
                }

                else
                {
                  v33 = [NSString alloc];
                  summary2 = [foundContent summary];
                  v35 = [v33 initWithFormat:@"found by job yet no local content URL | found:%@", summary2];

                  autoAssetClientName = v35;
                  responseError = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerAsIndicatedByJob" underlyingError:0 withDescription:v35];
                  v32 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
                  {
                    *buf = 138543362;
                    v46 = autoAssetClientName;
                    _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {notifyLockerAsIndicatedByJob} %{public}@", buf, 0xCu);
                  }
                }

                goto LABEL_17;
              }

              goto LABEL_12;
            }
          }

          v25 = @"[NOTIFY-LOCKER] found auto-asset without localContentURL and/or assetAttributes in response message";
        }

        else
        {
          v25 = @"[NOTIFY-LOCKER] no indication of found auto-asset in response message";
        }
      }

      else
      {
        v25 = @"[NOTIFY-LOCKER] no auto-asset-desire provided in client request";
      }

      responseError = [MAAutoAssetError buildError:6102 fromOperation:@"notifyLockerAsIndicatedByJob" underlyingError:0 withDescription:v25];
      goto LABEL_17;
    }

LABEL_12:
    responseError = 0;
  }

LABEL_17:

LABEL_18:

  return responseError;
}

- (id)notifyLockerAsIndicatedBySetJob:(id)job withSetInstance:(id)instance withSetDesire:(id)desire forSetDescriptor:(id)descriptor withClientReplyCompletion:(id)completion
{
  instanceCopy = instance;
  desireCopy = desire;
  descriptorCopy = descriptor;
  jobCopy = job;
  jobCopy = [[NSString alloc] initWithFormat:@"%@:notifyLockerAsIndicatedBySetJob", jobCopy];

  if (!desireCopy)
  {
    v28 = @"[SET-NOTIFY-LOCKER] no auto-asset-set-desire provided in client request";
LABEL_10:
    completion = [MAAutoAssetError buildError:6102 fromOperation:jobCopy underlyingError:0 withDescription:v28];
    goto LABEL_11;
  }

  if (!descriptorCopy)
  {
    v28 = @"[SET-NOTIFY-LOCKER] no indication of set-descriptor from set-job";
    goto LABEL_10;
  }

  if (!completion)
  {
    goto LABEL_15;
  }

  v38 = 0;
  v17 = [(MADAutoAssetControlManager *)self verifySetDescriptorIsLockable:descriptorCopy fromLocation:@"notifyLockerAsIndicatedBySetJob" notLocakableError:&v38 corruptedAtomicEntries:0];
  v18 = v38;
  v19 = v18;
  if (v17)
  {
    v33 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"notifyLockerAsIndicatedBySetJob" forSetDescriptor:descriptorCopy];
    autoAssetSetClientName = [instanceCopy autoAssetSetClientName];
    clientProcessName = [instanceCopy clientProcessName];
    clientProcessID = [instanceCopy clientProcessID];
    desireReason = [desireCopy desireReason];
    clientAssetSetPolicy = [desireCopy clientAssetSetPolicy];
    v37 = v19;
    v22 = [MADAutoAssetLocker lockedSetByClient:autoAssetSetClientName forClientProcessName:clientProcessName withClientProcessID:clientProcessID lockingSetDescriptor:descriptorCopy forLockReason:desireReason withSetUsagePolicy:clientAssetSetPolicy lockError:&v37];
    completion = v37;

    if (v22)
    {
      desireReason2 = [desireCopy desireReason];
      [(MADAutoAssetControlManager *)self setLockUsageMapLockedSetDescriptor:descriptorCopy forLockReason:desireReason2];

      clientAssetSetPolicy2 = [desireCopy clientAssetSetPolicy];
      supportingShortTermLocks = [clientAssetSetPolicy2 supportingShortTermLocks];

      if (supportingShortTermLocks)
      {
        atomicInstance = [instanceCopy atomicInstance];
        v27 = [(MADAutoAssetControlManager *)self shortTermLockSetDescriptor:@"notifyLockerAsIndicatedBySetJob" forSetDescriptor:descriptorCopy forSpecificAtomicInstance:atomicInstance];
      }
    }

    else if ((v33 & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraftAll:jobCopy forSetDescriptorNoLongerLocked:descriptorCopy];
    }
  }

  else
  {
    completion = v18;
  }

LABEL_11:
  if (completion)
  {
    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      checkedDescription = [completion checkedDescription];
      *buf = 138543618;
      v40 = _updateLatestSummary;
      v41 = 2114;
      v42 = checkedDescription;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {notifyLockerAsIndicatedBySetJob} [SET-NOTIFY-LOCKER] final response error:%{public}@", buf, 0x16u);
    }
  }

LABEL_15:

  return completion;
}

- (void)_statsIncrement:(id)increment forClientRequest:(id)request
{
  requestCopy = request;
  incrementCopy = increment;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [requestCopy clientRequestMessage];

  messageName = [clientRequestMessage messageName];

  [incrementCopy incrementForClientRequestMessage:messageName];
  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementAutoAssetJobsStarted
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalAutoAssetJobsStarted:{objc_msgSend(statistics, "totalAutoAssetJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementAutoJobsFinished
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalAutoJobsFinished:{objc_msgSend(statistics, "totalAutoJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDetermineJobsStarted
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalStagerDetermineJobsStarted:{objc_msgSend(statistics, "totalStagerDetermineJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDetermineJobsFinished
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalStagerDetermineJobsFinished:{objc_msgSend(statistics, "totalStagerDetermineJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDownloadJobsStarted
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalStagerDownloadJobsStarted:{objc_msgSend(statistics, "totalStagerDownloadJobsStarted") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementStagerDownloadJobsFinished
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalStagerDownloadJobsFinished:{objc_msgSend(statistics, "totalStagerDownloadJobsFinished") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementResumedInFlightJobs
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalResumedInFlightJobs:{objc_msgSend(statistics, "totalResumedInFlightJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementSchedulerTriggeredJobs
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalSchedulerTriggeredJobs:{objc_msgSend(statistics, "totalSchedulerTriggeredJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementFailuresToStartJobs
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  statistics = [(MADAutoAssetControlManager *)self statistics];
  [statistics setTotalFailuresToStartJobs:{objc_msgSend(statistics, "totalFailuresToStartJobs") + 1}];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementPreviouslyDownloadedForDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  isPatch = [descriptorCopy isPatch];
  statistics = [(MADAutoAssetControlManager *)self statistics];
  previouslyDownloaded = [statistics previouslyDownloaded];
  v9 = previouslyDownloaded;
  if (isPatch)
  {
    [previouslyDownloaded setPatchedAssets:{objc_msgSend(previouslyDownloaded, "patchedAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    previouslyDownloaded2 = [statistics2 previouslyDownloaded];
    [previouslyDownloaded2 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(previouslyDownloaded2, "patchedBytes")}];
  }

  else
  {
    [previouslyDownloaded setFullAssets:{objc_msgSend(previouslyDownloaded, "fullAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    previouslyDownloaded2 = [statistics2 previouslyDownloaded];
    [previouslyDownloaded2 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(previouslyDownloaded2, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementDownloadedForDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  isPatch = [descriptorCopy isPatch];
  statistics = [(MADAutoAssetControlManager *)self statistics];
  totalDownloaded = [statistics totalDownloaded];
  v9 = totalDownloaded;
  if (isPatch)
  {
    [totalDownloaded setPatchedAssets:{objc_msgSend(totalDownloaded, "patchedAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalDownloaded2 = [statistics2 totalDownloaded];
    [totalDownloaded2 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalDownloaded2, "patchedBytes")}];
  }

  else
  {
    [totalDownloaded setFullAssets:{objc_msgSend(totalDownloaded, "fullAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalDownloaded2 = [statistics2 totalDownloaded];
    [totalDownloaded2 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalDownloaded2, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementPromotedForDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  isPatch = [descriptorCopy isPatch];
  statistics = [(MADAutoAssetControlManager *)self statistics];
  totalPromoted = [statistics totalPromoted];
  v9 = totalPromoted;
  if (isPatch)
  {
    [totalPromoted setPatchedAssets:{objc_msgSend(totalPromoted, "patchedAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalPromoted2 = [statistics2 totalPromoted];
    [totalPromoted2 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalPromoted2, "patchedBytes")}];
  }

  else
  {
    [totalPromoted setFullAssets:{objc_msgSend(totalPromoted, "fullAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalPromoted2 = [statistics2 totalPromoted];
    [totalPromoted2 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalPromoted2, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (void)_statsIncrementRemovedForDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  isPatch = [descriptorCopy isPatch];
  statistics = [(MADAutoAssetControlManager *)self statistics];
  totalRemoved = [statistics totalRemoved];
  v9 = totalRemoved;
  if (isPatch)
  {
    [totalRemoved setPatchedAssets:{objc_msgSend(totalRemoved, "patchedAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalRemoved2 = [statistics2 totalRemoved];
    [totalRemoved2 setPatchedBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalRemoved2, "patchedBytes")}];
  }

  else
  {
    [totalRemoved setFullAssets:{objc_msgSend(totalRemoved, "fullAssets") + 1}];

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalRemoved2 = [statistics2 totalRemoved];
    [totalRemoved2 setFullBytes:{-[MADAutoAssetControlManager _bytesDownloadedForDescriptor:](self, "_bytesDownloadedForDescriptor:", descriptorCopy) + objc_msgSend(totalRemoved2, "fullBytes")}];
  }

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

- (id)_statsCombinedCopy:(BOOL)copy
{
  copyCopy = copy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self stagerResumed]&& ![(MADAutoAssetControlManager *)self stagerResumePostponed])
  {
    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
    v16 = 0;
    v17 = 0;
    v14 = 0;
    v15 = 0;
    [MADAutoAssetStager controlStatisticsClientRepliesSuccess:&v17 clientRepliesFailure:&v16 totalStaged:&v15 totalUnstaged:&v14 clearingAfter:copyCopy];
    statistics = v17;
    v9 = v16;
    v10 = v15;
    v11 = v14;
    v8 = [(MADAutoAssetControlManager *)self _combinedStatisticsWithStagerClientRepliesSuccess:statistics withStagerClientRepliesFailure:v9 withStagerTotalStaged:v10 withStagerTotalUnstaged:v11];
  }

  else
  {
    statistics = [(MADAutoAssetControlManager *)self statistics];
    v8 = [statistics copy];
  }

  if (copyCopy)
  {
    [(MADAutoAssetControlManager *)self _statsClearingAfterReporting];
    v12 = objc_alloc_init(MANAutoAssetControlStatistics);
    [(MADAutoAssetControlManager *)self setStatistics:v12];
  }

  return v8;
}

- (void)_statsMaintainReporting
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self statisticsNextMaintenanceReport];
  if (v5 == 0.0)
  {

    [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
  }

  else
  {
    v6 = +[NSDate date];
    [v6 timeIntervalSince1970];
    v8 = v7;

    [(MADAutoAssetControlManager *)self statisticsNextMaintenanceReport];
    if (v8 >= v9)
    {
      v10 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        statistics = [(MADAutoAssetControlManager *)self statistics];
        summary = [statistics summary];
        v14 = 138543618;
        v15 = _updateLatestSummary;
        v16 = 2114;
        v17 = summary;
        _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | maintenance report | statistics:%{public}@", &v14, 0x16u);
      }

      [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
    }
  }
}

- (void)_statsClearingAfterReporting
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    statistics = [(MADAutoAssetControlManager *)self statistics];
    summary = [statistics summary];
    v9 = 138543618;
    v10 = _updateLatestSummary;
    v11 = 2114;
    v12 = summary;
    _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "[%{public}@] AUTO-STATISTICS | clearing after | statistics:%{public}@", &v9, 0x16u);
  }

  [(MADAutoAssetControlManager *)self _statsRestartNextMaintentanceReport];
}

- (void)_statsRestartNextMaintentanceReport
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = +[NSDate date];
  [v5 timeIntervalSince1970];
  v7 = v6;

  [(MADAutoAssetControlManager *)self setStatisticsNextMaintenanceReport:v7 + 900.0];
}

- (void)_scheduledAndRouteClientRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_scheduledAndRouteClientRequest", locationCopy];
  clientRequestMessage = [requestCopy clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  clientRequestMessage2 = [requestCopy clientRequestMessage];
  message = [clientRequestMessage2 message];

  clientRequest = [requestCopy clientRequest];
  v16 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest];

  if (!v16)
  {
    v24 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
    v17 = v24;
    if (messageName && message && v24)
    {
      v37 = message;
      alreadyScheduledSelectors = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
      clientAssetSelector = [v17 clientAssetSelector];
      persistedEntryID = [clientAssetSelector persistedEntryID];
      v20 = [alreadyScheduledSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

      clientAssetSelector2 = [v17 clientAssetSelector];
      LODWORD(alreadyScheduledSelectors) = [(MADAutoAssetControlManager *)self _messageShouldBeScheduled:messageName forAssetSelector:clientAssetSelector2];

      if (alreadyScheduledSelectors)
      {
        clientAssetSelector3 = [v17 clientAssetSelector];
        [(MADAutoAssetControlManager *)self _scheduleSelector:clientAssetSelector3];
      }

      [(MADAutoAssetControlManager *)self _routeClientRequest:requestCopy alreadyScheduledSelector:v20 != 0 fromLocation:locationCopy];
      message = v37;
      goto LABEL_31;
    }

    v30 = [NSString alloc];
    v31 = @"MISSING";
    if (messageName)
    {
      v32 = messageName;
    }

    else
    {
      v32 = @"MISSING";
    }

    if (message)
    {
      v33 = @"provided";
    }

    else
    {
      v33 = @"MISSING";
    }

    if (v17)
    {
      v31 = @"provided";
    }

    v20 = [v30 initWithFormat:@"{%@} | invalid eventInfo |messageName:%@|message:%@|instance:%@", locationCopy, v32, v33, v31];
    selfCopy2 = self;
    v22 = requestCopy;
    v23 = 6102;
LABEL_30:
    [(MADAutoAssetControlManager *)selfCopy2 issueResponseForEventInfo:v22 withErrorCode:v23 fromAction:locationCopy withDescription:v20];
LABEL_31:

    goto LABEL_33;
  }

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:requestCopy];
  if (!v17)
  {
    v34 = [NSString alloc];
    summary = [requestCopy summary];
    v36 = [v34 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", locationCopy, summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:v36];

    goto LABEL_33;
  }

  if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) == 0)
  {
    v38 = 0;
    v18 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:requestCopy fromLocation:locationCopy errorString:&v38];
    v19 = v38;
    if (v19)
    {
      v20 = v19;
      selfCopy2 = self;
      v22 = requestCopy;
      v23 = v18;
      goto LABEL_30;
    }
  }

  [(MADAutoAssetControlManager *)self _routeClientRequest:requestCopy alreadyScheduledSelector:0 fromLocation:locationCopy];
LABEL_33:
}

- (int64_t)_scheduleAndCreateSetConfiguration:(id)configuration fromLocation:(id)location errorString:(id *)string
{
  configurationCopy = configuration;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_scheduleAndCreateSetConfiguration", locationCopy];
  clientRequestMessage = [configurationCopy clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:configurationCopy];
  v39 = 0;
  v16 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:v15 dueToMessageName:messageName selectedConfig:&v39];
  v17 = v39;
  v18 = v17;
  v19 = 6555;
  if (v16 == 6555)
  {
    v20 = @"An empty configuration for a set is not allowed";
    goto LABEL_13;
  }

  if (v17)
  {
    v20 = 0;
LABEL_12:
    v19 = v16;
    goto LABEL_13;
  }

  autoAssetEntries = [v15 autoAssetEntries];

  if (!autoAssetEntries)
  {
    goto LABEL_11;
  }

  if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
  {
    v38 = 0;
    v19 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:locationCopy forSetInfoInstance:v15 dueToMessageName:messageName selectedConfig:&v38];
    v18 = v38;
    if (v19)
    {
      v20 = @"Failed to modify asset configuration with the provided asset configuration";
    }

    else
    {
      v20 = 0;
    }

    goto LABEL_13;
  }

  if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0)
  {
LABEL_11:
    v20 = 0;
    v18 = 0;
    goto LABEL_12;
  }

  autoAssetEntries2 = [v15 autoAssetEntries];
  stringCopy = string;
  v35 = [autoAssetEntries2 count];

  v18 = 0;
  v36 = v35 == 0;
  string = stringCopy;
  if (v36)
  {
    v20 = 0;
  }

  else
  {
    v20 = @"A set configuration different than the currently defined set configuration is provided";
  }

  if (v36)
  {
    v19 = v16;
  }

  else
  {
    v19 = 6554;
  }

LABEL_13:
  if ([(MADAutoAssetControlManager *)self _setMessageInvolvesSchedulerPolicy:messageName])
  {
    clientRequest = [configurationCopy clientRequest];
    [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];
    v37 = v19;
    selfCopy = self;
    v24 = messageName;
    v25 = configurationCopy;
    v26 = v20;
    v27 = v15;
    v28 = locationCopy;
    v30 = v29 = string;

    clientAssetSetPolicy = [v30 clientAssetSetPolicy];

    string = v29;
    locationCopy = v28;
    v15 = v27;
    v20 = v26;
    configurationCopy = v25;
    messageName = v24;
    self = selfCopy;
    v19 = v37;
    if (!v18)
    {
      goto LABEL_19;
    }
  }

  else
  {
    clientAssetSetPolicy = 0;
    if (!v18)
    {
      goto LABEL_19;
    }
  }

  if ([(MADAutoAssetControlManager *)self _setMessageShouldBeScheduled:messageName forSetConfiguration:v18 forLatestEventInfo:configurationCopy])
  {
    [(MADAutoAssetControlManager *)self _scheduleSetConfiguration:v18 withClientSetPolicy:clientAssetSetPolicy];
  }

LABEL_19:
  if (string)
  {
    *string = v20;
  }

  return v19;
}

- (BOOL)_messageShouldBeScheduled:(id)scheduled forAssetSelector:(id)selector
{
  scheduledCopy = scheduled;
  selectorCopy = selector;
  v7 = selectorCopy;
  if (!selectorCopy)
  {
    goto LABEL_58;
  }

  assetType = [selectorCopy assetType];
  if (assetType)
  {
    assetSpecifier = [v7 assetSpecifier];
    if (assetSpecifier)
    {
      v10 = assetSpecifier;
      assetVersion = [v7 assetVersion];

      if (!assetVersion
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:CURRENT_STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:END_LOCK_USAGE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:CANCEL_OPERATION"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:PURGE_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-STAGE:ERASE_ALL"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& 1) == 0
        && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& 1) == 0
        && ![SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"])
      {
        LOBYTE(assetType) = 1;
        goto LABEL_59;
      }
    }

    else
    {
    }

LABEL_58:
    LOBYTE(assetType) = 0;
  }

LABEL_59:

  return assetType;
}

- (BOOL)_setMessageShouldBeScheduled:(id)scheduled forSetConfiguration:(id)configuration forLatestEventInfo:(id)info
{
  scheduledCopy = scheduled;
  configurationCopy = configuration;
  infoCopy = info;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0 && ![SUCore stringIsEqual:scheduledCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"])
  {
    goto LABEL_12;
  }

  if (![(MADAutoAssetControlManager *)self _setMessageInvolvesSchedulerPolicy:scheduledCopy])
  {
    goto LABEL_14;
  }

  v13 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"_setMessageShouldBeScheduled" withEventInfo:infoCopy];
  clientRequest = [infoCopy clientRequest];
  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (![configurationCopy inhibitImpliedScheduling] || (objc_msgSend(v15, "clientAssetSetPolicy"), v16 = objc_claimAutoreleasedReturnValue(), v17 = objc_msgSend(v16, "blockCheckDownload"), v16, !v17))
  {
    if (([configurationCopy inhibitImpliedScheduling] & 1) != 0 && (objc_msgSend(v13, "autoAssetEntries"), (v18 = objc_claimAutoreleasedReturnValue()) != 0))
    {
      v19 = v18;
      autoAssetEntries = [v13 autoAssetEntries];
      v21 = [autoAssetEntries count];

      if (!v21)
      {
        goto LABEL_12;
      }
    }

    else
    {
    }

LABEL_14:
    v22 = 1;
    goto LABEL_15;
  }

LABEL_12:
  v22 = 0;
LABEL_15:

  return v22;
}

- (BOOL)_setMessageInvolvesSchedulerPolicy:(id)policy
{
  policyCopy = policy;
  v4 = ([SUCore stringIsEqual:policyCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:policyCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];

  return v4;
}

- (BOOL)_setMessageCanCreateSetConfiguration:(id)configuration
{
  configurationCopy = configuration;
  v4 = ([SUCore stringIsEqual:configurationCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:configurationCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:configurationCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:configurationCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];

  return v4;
}

- (BOOL)_messageBlockedUntilDownloadManagerSync:(id)sync
{
  syncCopy = sync;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:LOCK_CONTENT"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:END_LOCK_USAGE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:CANCEL_OPERATION"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:PURGE_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-STAGE:ERASE_ALL"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& 1) != 0
    || ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& 1) != 0)
  {
    v7 = 1;
  }

  else
  {
    if (([SUCore stringIsEqual:syncCopy to:@"MA-AUTO:CURRENT_STATUS"]& 1) == 0 && ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"]& 1) == 0 && ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& 1) == 0 && ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& 1) == 0 && ([SUCore stringIsEqual:syncCopy to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"]& 1) == 0)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      syncCopy = [[NSString alloc] initWithFormat:@"{_messageBlockedUntilDownloadManagerSync} unknown messageName:%@", syncCopy];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:syncCopy withResult:6106 withError:0];
    }

    v7 = 0;
  }

  return v7;
}

- (BOOL)_messageBlockedUntilFirstUnlock:(id)unlock forAssetSelector:(id)selector
{
  unlockCopy = unlock;
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (selectorCopy)
  {
    if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
    {
      v10 = 1;
    }

    else
    {
      v11 = [(MADAutoAssetControlManager *)self _updatePolicyForSelector:selectorCopy];
      v10 = [v11 blockIfBeforeFirstUnlock] && ((+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", unlockCopy, @"MA-AUTO:INTEREST_IN_CONTENT") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", unlockCopy, @"MA-AUTO:CHECK_FOR_NEWER") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", unlockCopy, @"MA-AUTO:DETERMINE_IF_AVAILABLE") & 1) != 0 || +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", unlockCopy, @"MA-AUTO:LOCK_CONTENT"));
    }
  }

  else
  {
    v10 = 0;
  }

  return v10;
}

- (BOOL)_messageBlockedUntilFirstUnlock:(id)unlock forSetInstance:(id)instance
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!instance)
  {
    return 0;
  }

  return +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
}

- (BOOL)_messageAssetPolicyDownloadUserInitiated:(id)initiated forClientRequest:(id)request
{
  initiatedCopy = initiated;
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (([SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || [SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO:LOCK_CONTENT"])
  {
    clientRequestMessage = [requestCopy clientRequestMessage];
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage];

    clientAssetPolicy = [v11 clientAssetPolicy];
  }

  else
  {
    if (([SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) == 0 && ([SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) == 0 && ![SUCore stringIsEqual:initiatedCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      userInitiated = 0;
      goto LABEL_6;
    }

    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:requestCopy];
    clientAssetPolicy = [v11 clientAssetSetPolicy];
  }

  v13 = clientAssetPolicy;
  userInitiated = [clientAssetPolicy userInitiated];

LABEL_6:
  return userInitiated;
}

- (void)_routeClientRequest:(id)request alreadyScheduledSelector:(BOOL)selector fromLocation:(id)location
{
  selectorCopy = selector;
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_routeClientReuest", locationCopy];
  clientRequestMessage = [requestCopy clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  IsInternalAllowed = _MAPreferencesIsInternalAllowed();
  clientRequest = [requestCopy clientRequest];
  v17 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest];

  v119 = messageName;
  v120 = locationCopy;
  if (!v17)
  {
    v28 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
    v27 = v28;
    if (!v28)
    {
      v33 = [NSString alloc];
      summary = [requestCopy summary];
      v35 = [v33 initWithFormat:@"{%@} | invalid eventInfo (instance:MISSING) | eventInfo:%@", locationCopy, summary];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:v35];

      v18 = 0;
      goto LABEL_15;
    }

    v115 = IsInternalAllowed;
    v117 = requestCopy;
    clientAssetSelector = [v28 clientAssetSelector];
    v26 = [(MADAutoAssetControlManager *)self currentJobBySelector:clientAssetSelector];

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CURRENT_STATUS"])
    {
      requestCopy = v117;
      [(MADAutoAssetControlManager *)self handleClientCurrentStatusRequest:v117 forAutoJob:v26];
LABEL_76:
      v18 = 0;
      v23 = 0;
      v20 = 0;
      goto LABEL_77;
    }

    v113 = v26;
    requestCopy = v117;
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientControlStatisticsRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientKnownAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientAvailableForStagingSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientActiveJobSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientScheduledJobSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientLockedAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientStagedAssetSummaryRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"])
    {
      [(MADAutoAssetControlManager *)self handleControlClientStagerOverviewRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalUnlockRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalForgetRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"]& IsInternalAllowed) == 1)
    {
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalPurgeRequest:v117 forAutoJob:v26];
      goto LABEL_76;
    }

    v112 = locationCopy;
    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"]& IsInternalAllowed) == 1)
    {
      requestCopy = v117;
      [(MADAutoAssetControlManager *)self handleControlClientForceGlobalAbandonRequest:v117 forAutoJob:v26];
LABEL_90:
      v18 = 0;
      v23 = 0;
      v20 = 0;
      goto LABEL_77;
    }

    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO:LOCK_CONTENT"])
    {
      if (![(MADAutoAssetControlManager *)self handleClientPotentialJob:v117 alreadyScheduledSelector:selectorCopy forAutoJob:v26 fromLocation:locationCopy])
      {
        v18 = 0;
        v23 = 0;
        v20 = 0;
        requestCopy = v117;
        goto LABEL_77;
      }

      if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
      {
        v18 = 0;
        v111 = 0;
        requestCopy = v117;
        if (!v26)
        {
          goto LABEL_84;
        }

        goto LABEL_81;
      }

      clientRequest2 = [v117 clientRequest];
      [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest2 fromLocation:locationCopy];

      clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
      [clientRequestsAwaitingSync addObject:v117];

      v75 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v75, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary2 = [v117 summary];
        *buf = 138543874;
        *&buf[4] = _updateLatestSummary;
        v124 = 2114;
        v125 = v112;
        v126 = 2114;
        v127 = summary2;
        _os_log_impl(&dword_0, v75, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} [CLIENT_REQUESTS_AWAITING_SYNC] | job queued since device before first-unlock | eventInfo:%{public}@", buf, 0x20u);
      }

      statistics = [(MADAutoAssetControlManager *)self statistics];
      totalQueuedClientRequests = [statistics totalQueuedClientRequests];
      requestCopy = v117;
      clientRequest3 = [v117 clientRequest];
      [(MADAutoAssetControlManager *)self _statsIncrement:totalQueuedClientRequests forClientRequest:clientRequest3];
    }

    else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"])
    {
      requestCopy = v117;
      [(MADAutoAssetControlManager *)self handleClientMapLockedToExclaveRequest:v117 fromLocation:locationCopy];
    }

    else
    {
      if (([SUCore stringIsEqual:messageName to:@"MA-AUTO:CONTINUE_LOCK_USAGE"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:END_LOCK_USAGE"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:END_PREVIOUS_LOCKS"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleClientAlterLockOperation:v117 forAutoJob:v26];
        goto LABEL_90;
      }

      if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleClientCancelActivityForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminateAllForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminateAllForAssetTypeRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleClientEliminatePromotedNeverLockedForSelectorRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineGroupsAvailableForUpdateRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineAllAvailableForUpdateRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDetermineAllAvailableRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDownloadGroupsRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientDownloadAllRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:CANCEL_OPERATION"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientCancelOperation:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:PURGE_ALL"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientPurgeAllRequest:v117];
      }

      else if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-STAGE:ERASE_ALL"])
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleStagingClientEraseAllRequest:v117];
      }

      else if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"]& IsInternalAllowed) == 1)
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:v117];
      }

      else if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"]& IsInternalAllowed) == 1)
      {
        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:v117];
      }

      else
      {
        if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"]& IsInternalAllowed) != 1)
        {
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"])
            {
              requestCopy = v117;
              [(MADAutoAssetControlManager *)self handleEstimateEvictableBytesForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"])
            {
              requestCopy = v117;
              [(MADAutoAssetControlManager *)self handleSuspendForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"])
            {
              requestCopy = v117;
              [(MADAutoAssetControlManager *)self handleResumeFromSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }

            if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"])
            {
              requestCopy = v117;
              [(MADAutoAssetControlManager *)self handleStatusForSoftwareUpdateRequest:v117];
              goto LABEL_105;
            }
          }

          v18 = 0;
          v23 = 0;
          v111 = 0;
          goto LABEL_133;
        }

        requestCopy = v117;
        [(MADAutoAssetControlManager *)self handleControlClientSimulateSetJobOperation:v117];
      }
    }

LABEL_105:
    v18 = 0;
    v23 = 0;
    v20 = 0;
    locationCopy = v112;
    goto LABEL_77;
  }

  v18 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:requestCopy];
  if (!v18)
  {
    v30 = [NSString alloc];
    summary3 = [requestCopy summary];
    v32 = [v30 initWithFormat:@"{%@} | invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", locationCopy, summary3];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:v32];

    v27 = 0;
LABEL_15:
    v23 = 0;
    v20 = 0;
    goto LABEL_24;
  }

  v115 = IsInternalAllowed;
  *buf = 0;
  v19 = 0;
  v20 = 0;
  if ([(MADAutoAssetControlManager *)self _doesClientRequestInvolveSetConfiguration:requestCopy]&& (v122 = 0, [(MADAutoAssetControlManager *)self setConfigurationFromMessageName:messageName withInfoInstance:v18 errorCode:buf errorDescription:&v122], v20 = objc_claimAutoreleasedReturnValue(), v19 = v122, !v20))
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:*buf fromAction:locationCopy withDescription:v19];
  }

  else if (![(MADAutoAssetControlManager *)self setPolicyValidate:requestCopy fromLocation:locationCopy])
  {
    v111 = v20;
    v112 = locationCopy;
    v117 = requestCopy;
    clientDomainName = [v18 clientDomainName];
    assetSetIdentifier = [v18 assetSetIdentifier];
    v23 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:clientDomainName byIdentifier:assetSetIdentifier];

    clientDomainName2 = [v18 clientDomainName];
    assetSetIdentifier2 = [v18 assetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName2 byIdentifier:assetSetIdentifier2];

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CURRENT_SET_STATUS"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientCurrentStatusRequest:requestCopy forAutoJob:v26];
LABEL_8:
      v27 = 0;
LABEL_9:
      locationCopy = v112;
LABEL_30:
      v20 = v111;
      goto LABEL_77;
    }

    v113 = v26;
    locationCopy = v112;
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"])
    {
      [(MADAutoAssetControlManager *)self handleSetControlClientAssetSetsOverviewRequest:requestCopy forAutoJob:v26];
LABEL_29:
      v27 = 0;
      goto LABEL_30;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"])
    {
      [(MADAutoAssetControlManager *)self handleSetControlClientInstanceInfoRequest:requestCopy forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientNeedForAtomicRequest:requestCopy fromLocation:v120];
      v27 = 0;
LABEL_35:
      v26 = v113;
      goto LABEL_30;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
    {
      v20 = v111;
      [(MADAutoAssetControlManager *)self handleSetClientAlterEntriesRepresentingAtomicRequest:requestCopy forAutoJob:v26 whenCancelingSetJob:v23 alteringFromSetConfiguration:v111];
      v27 = 0;
      goto LABEL_77;
    }

    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:LOCK_ATOMIC"])
    {
      if (![(MADAutoAssetControlManager *)self handleClientPotentialSetJob:requestCopy forAutoJob:v26 fromLocation:v120])
      {
        goto LABEL_29;
      }

      if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
      {
        clientRequest4 = [requestCopy clientRequest];
        [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest4 fromLocation:v112];

        clientRequestsAwaitingSync2 = [(MADAutoAssetControlManager *)self clientRequestsAwaitingSync];
        [clientRequestsAwaitingSync2 addObject:requestCopy];

        v38 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary4 = [requestCopy summary];
          *buf = 138543874;
          *&buf[4] = _updateLatestSummary2;
          v124 = 2114;
          v125 = v112;
          v126 = 2114;
          v127 = summary4;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_SYNC] | job queued since device before first-unlock | eventInfo:%{public}@", buf, 0x20u);
        }

        statistics2 = [(MADAutoAssetControlManager *)self statistics];
        totalQueuedClientRequests2 = [statistics2 totalQueuedClientRequests];
        clientRequest5 = [requestCopy clientRequest];
        [(MADAutoAssetControlManager *)self _statsIncrement:totalQueuedClientRequests2 forClientRequest:clientRequest5];

        goto LABEL_8;
      }

      if (v23)
      {
        queuedRequestsForNewJobOnceCanceled = [v23 queuedRequestsForNewJobOnceCanceled];

        if (!queuedRequestsForNewJobOnceCanceled)
        {
          v45 = objc_alloc_init(NSMutableArray);
          [v23 setQueuedRequestsForNewJobOnceCanceled:v45];
        }

        queuedRequestsForNewJobOnceCanceled2 = [v23 queuedRequestsForNewJobOnceCanceled];

        if (queuedRequestsForNewJobOnceCanceled2)
        {
          queuedRequestsForNewJobOnceCanceled3 = [v23 queuedRequestsForNewJobOnceCanceled];
          [queuedRequestsForNewJobOnceCanceled3 addObject:requestCopy];

          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
          {
            queuedRequestsForNewJobOnceCanceled4 = [v23 queuedRequestsForNewJobOnceCanceled];
            v50 = [queuedRequestsForNewJobOnceCanceled4 count];
            summary5 = [requestCopy summary];
            *buf = 138543874;
            *&buf[4] = v112;
            v124 = 2048;
            v125 = v50;
            v126 = 2114;
            v127 = summary5;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET_CLIENT_REQUESTS_AWAITING_CANCEL] | job queued since set-job is being canceled | queued-count:%ld | eventInfo:%{public}@", buf, 0x20u);

            locationCopy = v112;
          }
        }

        else
        {
          v55 = [NSString alloc];
          summary6 = [requestCopy summary];
          v57 = [v55 initWithFormat:@"{%@} | unable to create canceling-set-job queue | eventInfo:%@", v112, summary6];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6101 fromAction:v112 withDescription:v57];

          locationCopy = v112;
        }

        goto LABEL_29;
      }

      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        clientDomainName3 = [v18 clientDomainName];
        assetSetIdentifier3 = [v18 assetSetIdentifier];
        v54 = [(MADAutoAssetControlManager *)self isSuspendedForSoftwareUpdate:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

        if (v54)
        {
          locationCopy = v112;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6703 fromAction:v112 withDescription:@"suspended for software update"];
          v27 = 0;
LABEL_93:
          v23 = 0;
          goto LABEL_30;
        }

        v27 = 0;
        locationCopy = v112;
        if (!v26)
        {
LABEL_84:
          v112 = locationCopy;
          v60 = +[NSUUID UUID];
          uUIDString = [v60 UUIDString];

          v118 = requestCopy;
          if (v17)
          {
            clientRequest6 = [requestCopy clientRequest];
            v62 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest6];

            v121 = 0;
            v110 = [(MADAutoAssetControlManager *)self setConfigurationSelectUsingInfoInstance:v18 dueToMessageName:messageName selectedConfig:&v121];
            v111 = v121;
            if (v111)
            {
              v63 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDForNewSetJob:v18 forReason:messageName];

              v64 = [MADAutoSetDescriptor alloc];
              clientDomainName4 = [v18 clientDomainName];
              assetSetIdentifier4 = [v18 assetSetIdentifier];
              uUIDString = v63;
              v114 = [(MADAutoSetDescriptor *)v64 initForClientDomainName:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4 withDiscoveredAtomicInstance:v63 withDiscoveredAtomicEntries:0];

              autoAssetEntries = [v18 autoAssetEntries];

              if (autoAssetEntries)
              {
                v68 = v18;
              }

              else
              {
                v68 = v111;
              }

              autoAssetEntries2 = [v68 autoAssetEntries];
              [v114 setRequestedAutoAssetEntries:autoAssetEntries2];

              [(MADAutoAssetControlManager *)self osTransactionNameClientRequestedSetJob:v63];
              v88 = os_transaction_create();
              v89 = [MADAutoAssetJob alloc];
              v90 = [v111 copy];
              v84 = [(MADAutoAssetJob *)v89 initForSetInstance:v18 withLifetimeOSTransaction:v88 withSetDesire:v62 usingSetConfiguration:v90 usingSetDescriptor:v114 withAutoAssetUUID:v63];

              if (v84)
              {
                goto LABEL_122;
              }

              if (v110)
              {
                v85 = v110;
              }

              else
              {
                v85 = 6101;
              }
            }

            else
            {
              clientRequest11 = [[NSString alloc] initWithFormat:@"unable to determine valid set-configuration when REQUIRED for operation [%@]", messageName];

              v111 = 0;
              v114 = 0;
              if (v110)
              {
                v85 = v110;
              }

              else
              {
                v85 = 6101;
              }

              if (clientRequest11)
              {
                goto LABEL_130;
              }
            }
          }

          else
          {
            [(MADAutoAssetControlManager *)self osTransactionNameClientRequestedSingletonJob:uUIDString];
            v81 = os_transaction_create();
            v82 = [MADAutoAssetJob alloc];
            clientRequest7 = [requestCopy clientRequest];
            v84 = [(MADAutoAssetJob *)v82 initForInstance:v27 withLifetimeOSTransaction:v81 withAutoAssetUUID:uUIDString downloadingUserInitiated:[(MADAutoAssetControlManager *)self _messageAssetPolicyDownloadUserInitiated:messageName forClientRequest:clientRequest7]];

            v114 = 0;
            if (v84)
            {
LABEL_122:
              v26 = v84;
              [v84 setClientRequestCount:{objc_msgSend(v84, "clientRequestCount") + 1}];
              if (v17)
              {
                requestCopy = v118;
                clientRequestMessage2 = [v118 clientRequestMessage];
                v92 = uUIDString;
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v84 usingSelector:0 withJobUUID:uUIDString triggeredByClientMessage:clientRequestMessage2 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:v114 fromLocation:v112];

                clientDomainName5 = [v114 clientDomainName];
                assetSetIdentifier5 = [v114 assetSetIdentifier];
                clientRequest11 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName5 forAssetSetIdentifier:assetSetIdentifier5];

                activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
                [activeSetDescriptorsByIdentifier setSafeObject:v114 forKey:clientRequest11];

                activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
                discoveredAtomicInstance = [v114 discoveredAtomicInstance];
                [activeSetDescriptorsByInstance setSafeObject:v114 forKey:discoveredAtomicInstance];

                clientRequest8 = [v118 clientRequest];
                [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest8 fromLocation:v112];

                [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                clientRequest9 = [v118 clientRequest];
                v100 = [(MADAutoAssetControlManager *)self jobControlInformationForSetJobKey:clientRequest11];
                v101 = v84;
                v102 = clientRequest9;
              }

              else
              {
                clientAssetSelector2 = [v27 clientAssetSelector];
                requestCopy = v118;
                clientRequestMessage3 = [v118 clientRequestMessage];
                v92 = uUIDString;
                [(MADAutoAssetControlManager *)self addToCurrentJobs:v84 usingSelector:clientAssetSelector2 withJobUUID:uUIDString triggeredByClientMessage:clientRequestMessage3 downloadingDescriptor:0 baseForPatchDescriptor:0 usingSetDescriptor:0 fromLocation:v112];

                clientAssetSelector3 = [v27 clientAssetSelector];
                clientRequestMessage4 = [v118 clientRequestMessage];
                [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v120 operation:@"ENTRY_ADD" usingSelector:clientAssetSelector3 withJobUUID:uUIDString triggeredByClientMessage:clientRequestMessage4 downloadingDescriptor:0 baseForPatchDescriptor:0 message:@"auto-asset-job started"];

                clientRequest10 = [v118 clientRequest];
                [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest10 fromLocation:v112];

                [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                clientRequest11 = [v118 clientRequest];
                clientRequest9 = [v27 clientAssetSelector];
                v100 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:clientRequest9];
                v101 = v84;
                v102 = clientRequest11;
              }

              [v101 startHandlingClientRequest:v102 withControlInformation:v100];

              goto LABEL_131;
            }

            v85 = 6101;
          }

          clientRequest11 = @"unable to allocate auto-asset-job";
LABEL_130:
          requestCopy = v118;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v118 withErrorCode:v85 fromAction:v112 withDescription:clientRequest11];
          [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
          v26 = 0;
          v92 = uUIDString;
LABEL_131:

          v23 = 0;
          goto LABEL_9;
        }
      }

      else
      {
        v27 = 0;
        if (!v26)
        {
          goto LABEL_84;
        }
      }

LABEL_81:
      [v26 setClientRequestCount:{objc_msgSend(v26, "clientRequestCount") + 1}];
      clientRequest12 = [requestCopy clientRequest];
      [(MADAutoAssetControlManager *)self timerStartForRequest:clientRequest12 fromLocation:locationCopy];

      clientRequest13 = [requestCopy clientRequest];
      if (v17)
      {
        [v26 startHandlingClientRequest:clientRequest13 withControlInformation:0];
      }

      else
      {
        [v27 clientAssetSelector];
        v69 = v26;
        v71 = v70 = locationCopy;
        v72 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v71];
        [v69 startHandlingClientRequest:clientRequest13 withControlInformation:v72];

        locationCopy = v70;
        v26 = v69;
      }

      goto LABEL_93;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientMapLockedAtomicEntryRequest:requestCopy forAutoJob:v26 fromLocation:v120];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientFormSubAtomicRequest:requestCopy forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientContinueAtomicLockRequest:requestCopy forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:END_ATOMIC_LOCK"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEndAtomicLockRequest:requestCopy forAutoJob:v26];
      goto LABEL_29;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEndAtomicLocksForClientRequest:requestCopy forAutoJob:v26];
      goto LABEL_8;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientEliminateAtomicRequest:requestCopy whenCancelingSetJob:v23 forAutoJob:v26];
      goto LABEL_8;
    }

    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"])
    {
      [(MADAutoAssetControlManager *)self handleSetClientAssetSetForStagingRequest:requestCopy forAutoJob:v26];
      goto LABEL_8;
    }

    __isPlatformVersionAtLeast(2, 18, 4, 0);
    v27 = 0;
LABEL_133:
    v108 = @"customer";
    if (v115)
    {
      v108 = @"internal";
    }

    v108 = [NSString stringWithFormat:@"unknown auto-asset command request received (%@)", v108];
    requestCopy = v117;
    locationCopy = v112;
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v117 withErrorCode:6106 fromAction:v112 withDescription:v108];

    goto LABEL_35;
  }

  v27 = 0;
  v23 = 0;
LABEL_24:
  v26 = 0;
LABEL_77:
}

- (BOOL)handleClientPotentialJob:(id)job alreadyScheduledSelector:(BOOL)selector forAutoJob:(id)autoJob fromLocation:(id)location
{
  selectorCopy = selector;
  jobCopy = job;
  autoJobCopy = autoJob;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleClientPotentialJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  clientRequest = [jobCopy clientRequest];
  clientRequestMessage = [clientRequest clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:jobCopy];
  if (v17)
  {
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:INTEREST_IN_CONTENT"])
    {
      if (selectorCopy)
      {
        clientRequest2 = [jobCopy clientRequest];
        clientRequestMessage2 = [clientRequest2 clientRequestMessage];
        v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
        clientRequest3 = [jobCopy clientRequest];
        clientRequestMessage3 = [clientRequest3 clientRequestMessage];
        clientID = [clientRequestMessage3 clientID];
        v22 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:0];

        clientRequest4 = [jobCopy clientRequest];
        [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest4 issuingResponseMessage:v22 withResponseError:0];
LABEL_5:

LABEL_14:
        v24 = 0;
LABEL_18:

        goto LABEL_19;
      }
    }

    else if (([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO:LOCK_CONTENT"])
    {
      clientRequestMessage4 = [clientRequest clientRequestMessage];
      v22 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage4];

      if (!v22)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6102 fromAction:@"handleClientPotentialJob" withDescription:@"no auto-asset-desire provided in client request"];
        goto LABEL_14;
      }

      if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"])
      {
        v26 = [(MADAutoAssetControlManager *)self handleClientCheckForNewer:jobCopy forAutoJob:autoJobCopy instance:v17 desire:v22 fromLocation:locationCopy];
      }

      else
      {
        if (![SUCore stringIsEqual:messageName to:@"MA-AUTO:LOCK_CONTENT"])
        {
          clientRequest4 = [[NSString alloc] initWithFormat:@"unexpected messageName:%@", messageName];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6108 fromAction:@"handleClientPotentialJob" withDescription:clientRequest4];
          goto LABEL_5;
        }

        v26 = [(MADAutoAssetControlManager *)self handleClientLockContent:jobCopy forAutoJob:autoJobCopy instance:v17 desire:v22 fromLocation:locationCopy];
      }

      v24 = v26;
      goto LABEL_18;
    }

    v24 = 1;
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6102 fromAction:locationCopy withDescription:@"no auto-asset-instance provided in client request"];
    v24 = 0;
  }

LABEL_19:

  os_activity_scope_leave(&state);
  return v24;
}

- (BOOL)handleClientCheckForNewer:(id)newer forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location
{
  newerCopy = newer;
  instanceCopy = instance;
  desireCopy = desire;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequest = [newerCopy clientRequest];
  v18 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  checkWaitTimeoutSecs = [desireCopy checkWaitTimeoutSecs];
  if (!checkWaitTimeoutSecs)
  {
    if (v18)
    {
      v20 = @"check (NO_WAIT) requested when device before first-unlock";
LABEL_11:
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:newerCopy withErrorCode:6206 fromAction:locationCopy withDescription:v20];
      goto LABEL_12;
    }

    clientAssetSelector = [instanceCopy clientAssetSelector];
    assetVersion = [clientAssetSelector assetVersion];

    clientAssetSelector2 = [instanceCopy clientAssetSelector];
    assetType = [clientAssetSelector2 assetType];
    clientAssetSelector3 = [instanceCopy clientAssetSelector];
    assetSpecifier = [clientAssetSelector3 assetSpecifier];
    if (assetVersion)
    {
      clientAssetSelector4 = [instanceCopy clientAssetSelector];
      assetVersion2 = [clientAssetSelector4 assetVersion];
      [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:locationCopy forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion2];
      v26 = v25 = clientAssetSelector2;

      v27 = v26;
      clientAssetSelector2 = v25;

      v20 = @"check (NO_WAIT) requested when specific asset-version not already downloaded";
    }

    else
    {
      v27 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:locationCopy forAssetType:assetType withAssetSpecifier:assetSpecifier];
      v20 = @"check (NO_WAIT) requested when no already downloaded asset-version available";
    }

    if (!v27)
    {
      goto LABEL_11;
    }

    v37 = v27;
    v38 = 0;
    v28 = [(MADAutoAssetControlManager *)self buildFoundResponseMessage:@"checkForNewer" forClientRequest:clientRequest withFoundDescriptor:v27 withInstance:instanceCopy withDesire:desireCopy fromLocation:locationCopy error:&v38];
    v29 = v38;
    if (!v29)
    {
      clientAssetSelector5 = [instanceCopy clientAssetSelector];
      assetVersion3 = [clientAssetSelector5 assetVersion];
      [(MADAutoAssetControlManager *)self updateAutoAssetStatusForChosenDownloadedDescriptor:v37 matchingAssetVersion:assetVersion3 fromLocation:locationCopy];
    }

    [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest issuingResponseMessage:v28 withResponseError:v29];
  }

LABEL_12:

  return checkWaitTimeoutSecs != 0;
}

- (BOOL)doesSetDescriptor:(id)descriptor satisfySetConfiguration:(id)configuration allowingMoreDownloaded:(BOOL)downloaded
{
  descriptorCopy = descriptor;
  autoAssetEntries = [configuration autoAssetEntries];
  requestedAutoAssetEntries = [descriptorCopy requestedAutoAssetEntries];
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  v48 = 0u;
  v9 = autoAssetEntries;
  v32 = [v9 countByEnumeratingWithState:&v45 objects:v50 count:16];
  if (!v32)
  {
    goto LABEL_20;
  }

  v33 = *v46;
  v34 = v9;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v31 = descriptorCopy;
  downloadedCopy = downloaded;
  while (2)
  {
    v11 = 0;
    while (2)
    {
      if (*v46 != v33)
      {
        objc_enumerationMutation(v9);
      }

      v36 = v11;
      v12 = *(*(&v45 + 1) + 8 * v11);
      v41 = 0u;
      v42 = 0u;
      v43 = 0u;
      v44 = 0u;
      obj = requestedAutoAssetEntries;
      v40 = [obj countByEnumeratingWithState:&v41 objects:v49 count:16];
      if (!v40)
      {
LABEL_22:

        v26 = 0;
        v9 = v34;
        latestDowloadedAtomicInstanceEntries = v34;
        descriptorCopy = v31;
LABEL_24:

        goto LABEL_25;
      }

      v13 = *v42;
      v37 = v12;
LABEL_8:
      v14 = 0;
      while (1)
      {
        if (*v42 != v13)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v41 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        assetSelector = [v12 assetSelector];
        assetType = [assetSelector assetType];
        assetSelector2 = [v15 assetSelector];
        assetType2 = [assetSelector2 assetType];
        if (![v16 stringIsEqual:assetType to:assetType2])
        {

          goto LABEL_15;
        }

        v39 = p_weak_ivar_lyt[223];
        assetSelector3 = [v12 assetSelector];
        assetSpecifier = [assetSelector3 assetSpecifier];
        assetSelector4 = [v15 assetSelector];
        [assetSelector4 assetSpecifier];
        v25 = v24 = v13;
        LOBYTE(v39) = [v39 stringIsEqual:assetSpecifier to:v25];

        v13 = v24;
        v12 = v37;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v39)
        {
          break;
        }

LABEL_15:
        if (v40 == ++v14)
        {
          v40 = [obj countByEnumeratingWithState:&v41 objects:v49 count:16];
          if (v40)
          {
            goto LABEL_8;
          }

          goto LABEL_22;
        }
      }

      v11 = v36 + 1;
      v9 = v34;
      if ((v36 + 1) != v32)
      {
        continue;
      }

      break;
    }

    descriptorCopy = v31;
    downloaded = downloadedCopy;
    v32 = [v34 countByEnumeratingWithState:&v45 objects:v50 count:16];
    if (v32)
    {
      continue;
    }

    break;
  }

LABEL_20:

  if (!downloaded)
  {
    latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v28 = [latestDowloadedAtomicInstanceEntries count];
    v26 = v28 <= [v9 count];
    goto LABEL_24;
  }

  v26 = 1;
LABEL_25:

  return v26;
}

- (BOOL)handleClientLockContent:(id)content forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location
{
  contentCopy = content;
  instanceCopy = instance;
  desireCopy = desire;
  locationCopy = location;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:handleClientLockContent", locationCopy];

  clientRequest = [contentCopy clientRequest];
  v20 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  if ((v20 & 1) == 0)
  {
    v78 = clientRequest;
    v79 = desireCopy;
    v80 = contentCopy;
    clientAssetSelector = [instanceCopy clientAssetSelector];
    assetVersion = [clientAssetSelector assetVersion];

    clientAssetSelector2 = [instanceCopy clientAssetSelector];
    assetType = [clientAssetSelector2 assetType];
    clientAssetSelector3 = [instanceCopy clientAssetSelector];
    assetSpecifier = [clientAssetSelector3 assetSpecifier];
    if (assetVersion)
    {
      [instanceCopy clientAssetSelector];
      v28 = v27 = locationCopy;
      [v28 assetVersion];
      v30 = v29 = instanceCopy;
      v31 = [(MADAutoAssetControlManager *)selfCopy _latestDownloadedDescriptor:v27 forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:v30];

      instanceCopy = v29;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

      locationCopy = v27;
    }

    else
    {
      v31 = [(MADAutoAssetControlManager *)selfCopy _latestDownloadedDescriptor:locationCopy forAssetType:assetType withAssetSpecifier:assetSpecifier];
    }

    desireCopy = v79;
    contentCopy = v80;
    clientRequest = v78;
    if (v31)
    {
      v77 = instanceCopy;
      assetType2 = [v31 assetType];
      if (assetType2)
      {
        v33 = assetType2;
        assetId = [v31 assetId];
        if (assetId)
        {
          v35 = assetId;
          metadata = [v31 metadata];

          if (metadata)
          {
            v37 = p_weak_ivar_lyt;
            v38 = [MAAutoAssetSelector alloc];
            assetType3 = [v31 assetType];
            [v31 assetSpecifier];
            v40 = v76 = locationCopy;
            assetVersion2 = [v31 assetVersion];
            v42 = [v38 initForAssetType:assetType3 withAssetSpecifier:v40 matchingAssetVersion:assetVersion2];

            v75 = v31;
            if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v76 forDescriptor:v31]&& [MADAutoAssetSecure isPersonalizationOrGraftingRequired:v76 forDescriptor:v31])
            {
              if ([MADAutoAssetSecure isPersonalizationRequired:v76 forDescriptor:v31])
              {
                [v31 setSecureOperationInProgress:1];
                v43 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptorForAssetDescriptor:v31];
                v88[0] = _NSConcreteStackBlock;
                v88[1] = 3221225472;
                v88[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke;
                v88[3] = &unk_4B46D0;
                v88[4] = selfCopy;
                v89 = v31;
                v90 = v42;
                v91 = v76;
                v92 = v80;
                [MADAutoAssetSecure personalizeGraftDownloaded:v91 forDescriptor:v89 setDescriptor:v43 allowingNetwork:1 completion:v88];

                v44 = v89;
LABEL_23:

                v45 = 0;
LABEL_42:

                locationCopy = v76;
                goto LABEL_43;
              }

              if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:v76 forDescriptor:v31])
              {
                [v31 setSecureOperationInProgress:1];
                v43 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptorForAssetDescriptor:v31];
                v84[0] = _NSConcreteStackBlock;
                v84[1] = 3221225472;
                v84[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_3484;
                v84[3] = &unk_4B4680;
                v84[4] = selfCopy;
                v85 = v31;
                v86 = v76;
                v87 = v80;
                [MADAutoAssetSecure graftDownloaded:v86 graftingDescriptor:v85 setDescriptor:v43 completion:v84];

                v44 = v85;
                goto LABEL_23;
              }
            }

            assetType4 = [v31 assetType];
            assetId2 = [v31 assetId];
            v52 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType4, assetId2, 2, @"auto");

            if (v52)
            {
              v74 = v42;
              autoAssetClientName = [v77 autoAssetClientName];
              clientProcessName = [v77 clientProcessName];
              clientProcessID = [v77 clientProcessID];
              desireReason = [v79 desireReason];
              clientAssetPolicy = [v79 clientAssetPolicy];
              metadata2 = [v31 metadata];
              v83 = 0;
              v73 = v52;
              LODWORD(clientProcessID) = [MADAutoAssetLocker lockedByClient:autoAssetClientName forClientProcessName:clientProcessName withClientProcessID:clientProcessID forAssetSelector:v42 forLockReason:desireReason withUsagePolicy:clientAssetPolicy withLocalContentURL:v52 withAssetAttributes:metadata2 lockError:&v83];
              v59 = v83;

              if (clientProcessID)
              {
                contentCopy = v80;
                if (usingCentralizedCachedelete())
                {
                  path = [v52 path];
                  markLockedAssetPurgeable(path);
                }

                desireCopy = v79;
                v43 = v59;
                if ([v31 neverBeenLocked])
                {
                  autoAssetClientName2 = [v77 autoAssetClientName];
                  if (autoAssetClientName2)
                  {
                    [v77 autoAssetClientName];
                  }

                  else
                  {
                    [v77 clientProcessName];
                  }
                  v66 = ;

                  [v31 setNeverBeenLocked:0];
                  LOBYTE(v72) = 0;
                  [(MADAutoAssetControlManager *)selfCopy trackDescriptor:v31 persisting:1 fromLocation:v76 changedWhileTerminated:0 changedNeverBeenLocked:1 historyOperation:0 firstClientName:v66 isPromoted:v72];
                }

                clientAssetSelector4 = [v77 clientAssetSelector];
                assetVersion3 = [clientAssetSelector4 assetVersion];
                [(MADAutoAssetControlManager *)selfCopy updateAutoAssetStatusForChosenDownloadedDescriptor:v31 matchingAssetVersion:assetVersion3 fromLocation:v76];

                v82 = 0;
                v69 = [(MADAutoAssetControlManager *)selfCopy buildFoundResponseMessage:@"lockContent" forClientRequest:v78 withFoundDescriptor:v31 withInstance:v77 withDesire:v79 fromLocation:v76 error:&v82];
                v70 = v82;
                [(MADAutoAssetControlManager *)selfCopy issueResponseToClientRequest:v78 issuingResponseMessage:v69 withResponseError:v70];

                v45 = 0;
                v52 = v73;
                v42 = v74;
              }

              else
              {
                desireCopy = v79;
                contentCopy = v80;
                if ([v79 lockWaitTimeoutSecs])
                {
                  v45 = 1;
                  v43 = v59;
                }

                else
                {
                  v43 = v59;
                  [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:v80 withAutoAssetError:v59 fromAction:v76 withDescription:@"unable to lock auto-asset"];
                  v45 = 0;
                }

                v42 = v74;
              }
            }

            else
            {
              v62 = objc_alloc(v37[226]);
              summary = [v31 summary];
              v64 = [v62 initWithFormat:@"unable to get local content URL | chosenDownloadedDescriptor:%@", summary];

              v43 = [MAAutoAssetError buildError:6101 fromOperation:v76 underlyingError:0 withDescription:v64];
              v65 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v65, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v94 = v76;
                v95 = 2114;
                v96 = v64;
                _os_log_impl(&dword_0, v65, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {%{public}@} failure to lock content - %{public}@", buf, 0x16u);
              }

              [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:v80 withAutoAssetError:v43 fromAction:v76 withDescription:@"failure to lock content"];
              v45 = 0;
            }

            goto LABEL_42;
          }
        }

        else
        {
        }
      }

      v47 = objc_alloc(p_weak_ivar_lyt[226]);
      summary2 = [v31 summary];
      v49 = [v47 initWithFormat:@"lock found descriptor MISSING required element(s) | chosenDownloadedDescriptor:%@", summary2];
      [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:v80 withErrorCode:6111 fromAction:locationCopy withDescription:v49];

      v45 = 0;
LABEL_43:
      instanceCopy = v77;
      goto LABEL_44;
    }
  }

  if ([desireCopy lockWaitTimeoutSecs])
  {
    v45 = 1;
  }

  else
  {
    if (v20)
    {
      v46 = @"lock (NO_WAIT) requested when device before first-unlock";
    }

    else
    {
      v46 = @"lock (NO_WAIT) requested when specific asset-version not already downloaded";
    }

    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:contentCopy withErrorCode:6503 fromAction:locationCopy withDescription:v46];
    v45 = 0;
  }

LABEL_44:

  return v45;
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2;
  block[3] = &unk_4B3818;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      *buf = 138543618;
      v10 = v3;
      v11 = 2114;
      v12 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-GRAFT][SINGLETON-CONTROL][ELIMINATE] {%{public}@} | eliminate triggered while performing personalize+graft|mount | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else if (*(a1 + 72))
  {
    v8 = [[NSString alloc] initWithFormat:@"%@[PERSONALIZING/GRAFTING]", *(a1 + 56)];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:? forEventInfo:? withResponseError:? forAttemptedDescriptor:?];
  }

  else
  {
    v5 = *(a1 + 64);
    v7 = *(a1 + 32);
    v6 = *(a1 + 40);

    [v6 lockAutoAssetReplyJobResponse:@"any personalization/grafting [or mounting] successful" forEventInfo:v5 lockingChosenDescriptor:v7];
  }
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_3484(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2_3485;
  block[3] = &unk_4B42C0;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

void __94__MADAutoAssetControlManager_handleClientLockContent_forAutoJob_instance_desire_fromLocation___block_invoke_2_3485(uint64_t a1)
{
  v2 = [MAAutoAssetSelector alloc];
  v3 = [*(a1 + 32) assetType];
  v4 = [*(a1 + 32) assetSpecifier];
  v5 = [*(a1 + 32) assetVersion];
  v6 = [v2 initForAssetType:v3 withAssetSpecifier:v4 matchingAssetVersion:v5];

  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:v6])
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = *(a1 + 48);
      v9 = [*(a1 + 32) summary];
      *buf = 138543618;
      v12 = v8;
      v13 = 2114;
      v14 = v9;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT][SINGLETON-CONTROL][ELIMINATE] {%{public}@} | eliminate triggered while grafting|mounting | chosenDownloadedDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 48) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 56)];
  }

  else if (*(a1 + 64))
  {
    v10 = [[NSString alloc] initWithFormat:@"%@[GRAFTING]", *(a1 + 48)];
    [*(a1 + 40) issueResponseToFailedAutoAssetLockRequest:v10 forEventInfo:*(a1 + 56) withResponseError:*(a1 + 64) forAttemptedDescriptor:*(a1 + 32)];
  }

  else
  {
    [*(a1 + 40) lockAutoAssetReplyJobResponse:@"grafting [or mounting] successful" forEventInfo:*(a1 + 56) lockingChosenDescriptor:*(a1 + 32)];
  }
}

- (id)buildFoundResponseMessage:(id)message forClientRequest:(id)request withFoundDescriptor:(id)descriptor withInstance:(id)instance withDesire:(id)desire fromLocation:(id)location error:(id *)error
{
  messageCopy = message;
  requestCopy = request;
  descriptorCopy = descriptor;
  instanceCopy = instance;
  desireCopy = desire;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v85 = requestCopy;
  clientRequestMessage = [requestCopy clientRequestMessage];
  v97 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];

  v93 = objc_alloc_init(NSMutableDictionary);
  v20 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];
  v95 = [v20 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
  v25 = [(MADAutoAssetControlManager *)self jobSelectorKey:v95];
  v26 = [currentStatusBySelector safeObjectForKey:v25 ofClass:objc_opt_class()];

  v88 = descriptorCopy;
  if (v26 || (v27 = objc_alloc_init(MAAutoAssetNotifications), [v27 setContentAvailableForUse:1], objc_msgSend(descriptorCopy, "metadata"), v90 = objc_claimAutoreleasedReturnValue(), v83 = objc_msgSend(descriptorCopy, "neverBeenLocked"), v81 = objc_msgSend(descriptorCopy, "downloadUserInitiated"), v79 = objc_msgSend(descriptorCopy, "downloadedNetworkBytes"), v28 = objc_msgSend(descriptorCopy, "downloadedFilesystemBytes"), v29 = objc_msgSend(descriptorCopy, "isPatch"), objc_msgSend(descriptorCopy, "patchedFromBaseSelector"), v30 = descriptorCopy, v31 = objc_claimAutoreleasedReturnValue(), v32 = objc_msgSend(v30, "patchedFromBaseFilesystemBytes"), v33 = objc_msgSend(v30, "patchingAttempted"), v34 = objc_msgSend(v30, "stagedPriorToAvailable"), objc_msgSend(v30, "stagedFromOSVersion"), v35 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v30, "stagedFromBuildVersion"), v36 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v30, "patchingAttemptError"), v37 = objc_claimAutoreleasedReturnValue(), LOBYTE(v70) = 0, BYTE1(v69) = v34, LOBYTE(v69) = v33, LOBYTE(v68) = v29, v26 = -[MADAutoAssetControlManager newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:](self, "newAssetStatusForSelector:withNotifications:withAvailableForUseAttributes:withNewerVersionAttributes:withNeverBeenLocked:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withDownloadedAsPatch:withPatchedFromBaseSelector:withPatchedFromBaseFilesystemBytes:withPatchingAttempted:withStagedPriorToAvailable:withStagedFromOSVersion:withStagedFromBuildVersion:extendingWithCurrentLockUsage:withAvailableForUseError:withPatchingAttemptError:withNewerVersionError:", v95, v27, v90, 0, v83, v81, 0, v79, v28, v68, v31, v32, v69, v35, v36, v70, 0, v37, 0), v37, v36, v35, v31, v90, v27, v26))
  {
    assetSelector = [v26 assetSelector];
    notifications = [v26 notifications];
    availableForUseAttributes = [v26 availableForUseAttributes];
    newerVersionAttributes = [v26 newerVersionAttributes];
    neverBeenLocked = [v26 neverBeenLocked];
    downloadUserInitiated = [v26 downloadUserInitiated];
    downloadProgress = [v26 downloadProgress];
    downloadedNetworkBytes = [v26 downloadedNetworkBytes];
    downloadedFilesystemBytes = [v26 downloadedFilesystemBytes];
    downloadedAsPatch = [v26 downloadedAsPatch];
    patchedFromBaseSelector = [v26 patchedFromBaseSelector];
    patchedFromBaseFilesystemBytes = [v26 patchedFromBaseFilesystemBytes];
    patchingAttempted = [v26 patchingAttempted];
    stagedPriorToAvailable = [v26 stagedPriorToAvailable];
    stagedFromOSVersion = [v26 stagedFromOSVersion];
    stagedFromBuildVersion = [v26 stagedFromBuildVersion];
    availableForUseError = [v26 availableForUseError];
    patchingAttemptError = [v26 patchingAttemptError];
    newerVersionError = [v26 newerVersionError];
    LOBYTE(v70) = 1;
    BYTE1(v69) = stagedPriorToAvailable;
    LOBYTE(v69) = patchingAttempted;
    LOBYTE(v68) = downloadedAsPatch;
    v92 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:assetSelector withNotifications:notifications withAvailableForUseAttributes:availableForUseAttributes withNewerVersionAttributes:newerVersionAttributes withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:downloadProgress withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v68 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v69 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:stagedFromBuildVersion withStagedFromBuildVersion:v70 extendingWithCurrentLockUsage:availableForUseError withAvailableForUseError:patchingAttemptError withPatchingAttemptError:newerVersionError withNewerVersionError:?];
  }

  else
  {
    v92 = 0;
  }

  v45 = v88;
  if (![SUCore stringIsEqual:v97 to:@"MA-AUTO(REPLY):LOCK_CONTENT"])
  {
    v46 = 0;
    v48 = v85;
    v47 = messageCopy;
    v49 = instanceCopy;
LABEL_11:
    v56 = v92;
    if (v92)
    {
      v57 = [MAAutoAssetInfoFound alloc];
      metadata = [v88 metadata];
      v56 = [v57 initForSelector:v95 withLocalContentURL:v46 withAssetAttributes:metadata reportingStatus:v92];
    }

    if (v49)
    {
      [v93 setSafeObject:v49 forKey:@"instance"];
    }

    if (v56)
    {
      [v93 setSafeObject:v56 forKey:@"found"];
    }

    if (desireCopy)
    {
      [v93 setSafeObject:desireCopy forKey:@"desire"];
    }

    v59 = [SUCoreConnectMessage alloc];
    clientID = [v48 clientID];
    v55 = [v59 initWithType:2 messageName:v97 clientID:clientID version:0 message:v93];

    if (v55)
    {
      v53 = 0;
    }

    else
    {
      v61 = [[NSString alloc] initWithFormat:@"unable to build response for %@ request", v47];
      v62 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [v48 summary];
        summary2 = [v56 summary];
        *buf = 138544386;
        v99 = _updateLatestSummary;
        v100 = 2114;
        v101 = locationCopy;
        v102 = 2114;
        v103 = v61;
        v104 = 2114;
        v105 = summary;
        v106 = 2114;
        v107 = summary2;
        _os_log_impl(&dword_0, v62, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:buildFoundResponseMessage} failed to create response message - %{public}@ | clientRequest:%{public}@ | found:%{public}@", buf, 0x34u);

        v49 = instanceCopy;
        v45 = v88;
      }

      v53 = [MAAutoAssetError buildError:6101 fromOperation:locationCopy underlyingError:0 withDescription:v61];

      v55 = 0;
    }

    goto LABEL_24;
  }

  v46 = [MADAutoAssetSecure localContentURL:locationCopy forDescriptor:v88];
  v48 = v85;
  v47 = messageCopy;
  v49 = instanceCopy;
  if (v46)
  {
    goto LABEL_11;
  }

  v50 = [NSString alloc];
  summary3 = [v88 summary];
  v52 = [v50 initWithFormat:@"unable to get local content URL | foundDescriptor:%@", summary3];

  v53 = [MAAutoAssetError buildError:6101 fromOperation:@"notifyLockerJustLockedDescriptor" underlyingError:0 withDescription:v52];
  v54 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
  {
    *buf = 138543618;
    v99 = locationCopy;
    v100 = 2114;
    v101 = v52;
    _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {%{public}@} failure to build found response - %{public}@", buf, 0x16u);
  }

  v46 = 0;
  v55 = 0;
  v56 = 0;
  if (!v53)
  {
    goto LABEL_11;
  }

LABEL_24:
  if (error)
  {
    v66 = v53;
    *error = v53;
  }

  return v55;
}

- (void)handleClientAlterLockOperation:(id)operation forAutoJob:(id)job
{
  operationCopy = operation;
  jobCopy = job;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientAlterLockOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  clientRequestMessage = [operationCopy clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v10 = [(MADAutoAssetControlManager *)selfCopy clientRequestMessageInstance:operationCopy];
  v56 = v10;
  if (!v10)
  {
    v13 = @"no auto-asset-instance provided in client request related to pre-existing lock";
    goto LABEL_7;
  }

  clientAssetSelector = [v10 clientAssetSelector];
  assetVersion = [clientAssetSelector assetVersion];
  if (!assetVersion)
  {
    v14 = [SUCore stringIsEqual:messageName to:@"MA-AUTO:CONTINUE_LOCK_USAGE"];

    if (!v14)
    {
      goto LABEL_8;
    }

    v13 = @"asset-selector missing indication of asset-version when required to identify pre-existing lock";
LABEL_7:
    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:operationCopy withErrorCode:6102 fromAction:@"handleClientAlterLockOperation" withDescription:v13];
    goto LABEL_45;
  }

LABEL_8:
  clientAssetSelector2 = [v56 clientAssetSelector];
  assetVersion2 = [clientAssetSelector2 assetVersion];
  v17 = assetVersion2 == 0;

  if (!v17)
  {
    clientAssetSelector3 = [v56 clientAssetSelector];
    assetType = [clientAssetSelector3 assetType];
    clientAssetSelector4 = [v56 clientAssetSelector];
    assetSpecifier = [clientAssetSelector4 assetSpecifier];
    clientAssetSelector5 = [v56 clientAssetSelector];
    assetVersion3 = [clientAssetSelector5 assetVersion];
    v24 = [(MADAutoAssetControlManager *)selfCopy _latestDownloadedDescriptor:@"handleClientAlterLockOperation" forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion3];

    if (v24)
    {
      v61 = 0;
      v50 = [(MADAutoAssetControlManager *)selfCopy _handleClientAlterLockOperationForDescriptor:v24 forEventInfo:operationCopy error:&v61];
      v25 = v61;
    }

    else
    {
      v25 = [MAAutoAssetError buildError:6110 fromOperation:@"handleClientAlterLockOperation" underlyingError:0 withDescription:@"auto-asset-descriptor (for provided full-asset-selector) is not currently downloaded"];
      v50 = @"auto-asset-descriptor (for provided full-asset-selector) is not currently downloaded";
      v24 = 0;
    }

    v44 = v25;
    if (!v25)
    {
      goto LABEL_43;
    }

    goto LABEL_38;
  }

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
  clientAssetSelector6 = [v56 clientAssetSelector];
  v47 = [persistedKnownDescriptors persistedEntryIDs:@"handleClientAlterLockOperation" assetSelector:clientAssetSelector6];

  if (![v47 count])
  {
    v50 = @"no auto-asset-descriptors currently downloaded";
    v51 = [MAAutoAssetError buildError:6110 fromOperation:@"_handleClientAlterLockOperation" underlyingError:0 withDescription:?];
    goto LABEL_42;
  }

  v65 = 0u;
  v66 = 0u;
  v63 = 0u;
  v64 = 0u;
  obj = v47;
  v28 = [obj countByEnumeratingWithState:&v63 objects:v70 count:16];
  if (!v28)
  {
    v51 = 0;
    v52 = 0;
    v54 = 0;
    v50 = 0;
    goto LABEL_41;
  }

  v51 = 0;
  v52 = 0;
  v54 = 0;
  v50 = 0;
  v58 = *v64;
  do
  {
    v29 = 0;
    v59 = v28;
    do
    {
      if (*v64 != v58)
      {
        objc_enumerationMutation(obj);
      }

      v30 = *(*(&v63 + 1) + 8 * v29);
      v31 = objc_autoreleasePoolPush();
      persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
      v33 = [persistedKnownDescriptors2 persistedEntry:v30 fromLocation:@"handleClientAlterLockOperation"];

      if (v33)
      {
        v34 = [v33 secureCodedObjectForKey:@"assetDescriptor" ofClass:objc_opt_class()];
        v35 = v34;
        if (!v34)
        {
          assetType2 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(assetType2, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v69 = v30;
            _os_log_impl(&dword_0, assetType2, OS_LOG_TYPE_ERROR, "{handleClientAlterLockOperation} unable to secure-decode persistedKnownDescriptors entry | entryID:%{public}@", buf, 0xCu);
          }

          goto LABEL_30;
        }

        if (![v34 isOnFilesystem])
        {
          goto LABEL_31;
        }

        assetType2 = [v35 assetType];
        clientAssetSelector7 = [v56 clientAssetSelector];
        assetType3 = [clientAssetSelector7 assetType];
        if (([SUCore stringIsEqual:assetType2 to:assetType3]& 1) == 0)
        {

          goto LABEL_30;
        }

        assetSpecifier2 = [v35 assetSpecifier];
        clientAssetSelector8 = [v56 clientAssetSelector];
        assetSpecifier3 = [clientAssetSelector8 assetSpecifier];
        v41 = [SUCore stringIsEqual:assetSpecifier2 to:assetSpecifier3];

        if (!v41)
        {
          goto LABEL_31;
        }

        v62 = v54;
        v42 = [(MADAutoAssetControlManager *)selfCopy _handleClientAlterLockOperationForDescriptor:v35 forEventInfo:operationCopy error:&v62];
        v43 = v62;

        if (v43 && !v51)
        {
          assetType2 = v50;
          v51 = v43;
          v52 = v42;
          v50 = v52;
          v54 = v51;
LABEL_30:

          goto LABEL_31;
        }

        v52 = v42;
        v54 = v43;
      }

      else
      {
        v35 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v69 = v30;
          _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "{handleClientAlterLockOperation} unable to load persistedKnownDescriptors entry | entryID:%{public}@", buf, 0xCu);
        }
      }

LABEL_31:

      objc_autoreleasePoolPop(v31);
      v29 = v29 + 1;
    }

    while (v59 != v29);
    v28 = [obj countByEnumeratingWithState:&v63 objects:v70 count:16];
  }

  while (v28);
LABEL_41:

LABEL_42:
  v24 = 0;
  v44 = v51;
  if (v51)
  {
LABEL_38:
    v45 = v44;
    v46 = v50;
    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:operationCopy withAutoAssetError:v44 fromAction:@"handleClientAlterLockOperation" withDescription:v50];
    goto LABEL_44;
  }

LABEL_43:
  v45 = v44;
  v46 = v50;
  [MADAutoAssetControlManager issueResponseForEventInfo:selfCopy withErrorCode:"issueResponseForEventInfo:withErrorCode:fromAction:withDescription:" fromAction:operationCopy withDescription:?];
LABEL_44:

LABEL_45:
  os_activity_scope_leave(&state);
}

- (id)_handleClientAlterLockOperationForDescriptor:(id)descriptor forEventInfo:(id)info error:(id *)error
{
  descriptorCopy = descriptor;
  infoCopy = info;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [infoCopy clientRequestMessage];
  message = [clientRequestMessage message];

  clientRequestMessage2 = [infoCopy clientRequestMessage];
  messageName = [clientRequestMessage2 messageName];

  v68 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:infoCopy];

  v16 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];
  v20 = [v16 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  assetType2 = [descriptorCopy assetType];
  assetId = [descriptorCopy assetId];
  v23 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType2, assetId, 2, @"auto");

  if (!v23)
  {
    v35 = [NSString alloc];
    summary = [descriptorCopy summary];
    v34 = [v35 initWithFormat:@"unable to get local content URL | descriptor:%@", summary];

    v32 = [MAAutoAssetError buildError:6101 fromOperation:@"_handleClientAlterLockOperation" underlyingError:0 withDescription:v34];
    v27 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v74 = v34;
      _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[AUTO-ASSET] [LOCAL-CONTENT-URL] {_handleClientAlterLockOperation} failure to perform alter lock operation - %{public}@", buf, 0xCu);
    }

    goto LABEL_44;
  }

  if (![SUCore stringIsEqual:messageName to:@"MA-AUTO:CONTINUE_LOCK_USAGE"])
  {
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:END_LOCK_USAGE"])
    {
      errorCopy = error;
      v66 = message;
      v27 = [message safeObjectForKey:@"end" ofClass:objc_opt_class()];
      autoAssetClientName = [v68 autoAssetClientName];
      endLockReason = [v27 endLockReason];
      v71 = 0;
      v39 = [MADAutoAssetLocker endedLockByClient:autoAssetClientName forAssetSelector:v20 forLockReason:endLockReason endError:&v71];
      v32 = v71;

      if (!v39)
      {
        v44 = [NSString alloc];
        summary2 = [descriptorCopy summary];
        v34 = [v44 initWithFormat:@"unable to end lock | descriptor:%@", summary2];
        message = v66;
        error = errorCopy;
LABEL_29:

        goto LABEL_44;
      }

      error = errorCopy;
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:descriptorCopy])
      {
        v34 = 0;
        message = v66;
        goto LABEL_44;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_LOCK_USAGE)" forDescriptorNoLongerLocked:descriptorCopy];
      if ([descriptorCopy secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation" forAutoAssetDescriptor:descriptorCopy failingClientRequestForEventInfo:0];
      }

      message = v66;
      if (usingCentralizedCachedelete())
      {
LABEL_27:
        summary2 = [v23 path];
        markAssetPurgeable(summary2);
        v34 = 0;
        goto LABEL_29;
      }

LABEL_34:
      v34 = 0;
      goto LABEL_44;
    }

    v64 = v23;
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:END_PREVIOUS_LOCKS"])
    {
      errorCopy2 = error;
      v67 = message;
      v27 = [message safeObjectForKey:@"end" ofClass:objc_opt_class()];
      autoAssetClientName2 = [v68 autoAssetClientName];
      endLockReason2 = [v27 endLockReason];
      v70 = 0;
      v43 = [MADAutoAssetLocker endedPreviousLocksByClient:autoAssetClientName2 forAssetSelector:v20 forLockReason:endLockReason2 removingLockCount:[v27 endLockCount] endError:&v70];
      v32 = v70;

      if (!v43)
      {
        v51 = [NSString alloc];
        summary2 = [descriptorCopy summary];
        v34 = [v51 initWithFormat:@"unable to end previous locks | descriptor:%@", summary2];
        error = errorCopy2;
        message = v67;
        goto LABEL_29;
      }

      error = errorCopy2;
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:descriptorCopy])
      {
        v34 = 0;
        message = v67;
        goto LABEL_44;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_PREVIOUS_LOCKS)" forDescriptorNoLongerLocked:descriptorCopy];
      if ([descriptorCopy secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation(END_PREVIOUS_LOCKS)" forAutoAssetDescriptor:descriptorCopy failingClientRequestForEventInfo:0];
      }

      message = v67;
      if (usingCentralizedCachedelete())
      {
        goto LABEL_27;
      }

      goto LABEL_34;
    }

    v46 = v20;
    if (![SUCore stringIsEqual:messageName to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"])
    {
      v52 = [NSString alloc];
      [descriptorCopy summary];
      v53 = messageName;
      v55 = v54 = message;
      v34 = [v52 initWithFormat:@"unknown auto-asset lock manipulation command request received | descriptor:%@", v55];

      message = v54;
      messageName = v53;
      v32 = [MAAutoAssetError buildError:6106 fromOperation:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" underlyingError:0 withDescription:v34];
      v20 = v46;
      v23 = v64;
      goto LABEL_45;
    }

    errorCopy3 = error;
    v47 = message;
    v27 = [message safeObjectForKey:@"end" ofClass:objc_opt_class()];
    autoAssetClientName3 = [v68 autoAssetClientName];
    endLockReason3 = [v27 endLockReason];
    v69 = 0;
    v50 = [MADAutoAssetLocker endedAllPreviousLocksByClient:autoAssetClientName3 forAssetSelector:v46 forLockReason:endLockReason3 endError:&v69];
    v32 = v69;

    if (v50)
    {
      if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:@"_handleClientAlterLockOperation" forDescriptor:descriptorCopy])
      {
        v34 = 0;
        error = errorCopy3;
        message = v47;
LABEL_42:
        v20 = v46;
        goto LABEL_43;
      }

      [(MADAutoAssetControlManager *)self secureCheckUngraft:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" forDescriptorNoLongerLocked:descriptorCopy];
      if ([descriptorCopy secureOperationEliminating])
      {
        [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:@"_handleClientAlterLockOperation(END_ALL_PREVIOUS_LOCKS)" forAutoAssetDescriptor:descriptorCopy failingClientRequestForEventInfo:0];
      }

      error = errorCopy3;
      message = v47;
      if (!usingCentralizedCachedelete())
      {
        v34 = 0;
        goto LABEL_42;
      }

      path = [v64 path];
      markAssetPurgeable(path);
      v34 = 0;
    }

    else
    {
      v56 = [NSString alloc];
      path = [descriptorCopy summary];
      v34 = [v56 initWithFormat:@"unable to end all previous locks | descriptor:%@", path];
      error = errorCopy3;
      message = v47;
    }

    v20 = v46;

LABEL_43:
    v23 = v64;
    goto LABEL_44;
  }

  v24 = messageName;
  v25 = v23;
  v63 = v24;
  errorCopy4 = error;
  v65 = message;
  v27 = [message safeObjectForKey:@"desire" ofClass:objc_opt_class()];
  autoAssetClientName4 = [v68 autoAssetClientName];
  desireReason = [v27 desireReason];
  clientAssetPolicy = [v27 clientAssetPolicy];
  v72 = 0;
  v31 = [MADAutoAssetLocker continuedLockByClient:autoAssetClientName4 forAssetSelector:v20 forLockReason:desireReason withUsagePolicy:clientAssetPolicy continueError:&v72];
  v32 = v72;

  if (v31)
  {
    error = errorCopy4;
    if (!usingCentralizedCachedelete())
    {
      v34 = 0;
      message = v65;
      v23 = v25;
      messageName = v63;
      goto LABEL_44;
    }

    v23 = v25;
    path2 = [v25 path];
    markLockedAssetPurgeable(path2);
    v34 = 0;
    message = v65;
  }

  else
  {
    v40 = [NSString alloc];
    path2 = [descriptorCopy summary];
    v34 = [v40 initWithFormat:@"unable to continue lock | descriptor:%@", path2];
    error = errorCopy4;
    message = v65;
    v23 = v25;
  }

  messageName = v63;
LABEL_44:

LABEL_45:
  if (error)
  {
    v58 = v32;
    *error = v32;
  }

  return v34;
}

- (void)handleClientCurrentStatusRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientCurrentStatusRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __74__MADAutoAssetControlManager_handleClientCurrentStatusRequest_forAutoJob___block_invoke;
  block[3] = &unk_4B2AF0;
  block[4] = self;
  v14 = requestCopy;
  v15 = jobCopy;
  v11 = jobCopy;
  v12 = requestCopy;
  dispatch_async(extendedStateQueue, block);

  os_activity_scope_leave(&state);
}

void __74__MADAutoAssetControlManager_handleClientCurrentStatusRequest_forAutoJob___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) clientRequestMessageInstance:*(a1 + 40)];
  v3 = [*(a1 + 32) currentStatusBySelector];
  v4 = *(a1 + 32);
  v5 = [v2 clientAssetSelector];
  v6 = [v4 jobSelectorKey:v5];
  v7 = [v3 safeObjectForKey:v6 ofClass:objc_opt_class()];

  v137 = v2;
  v138 = a1;
  v136 = *(a1 + 48);
  if (v7)
  {
    v139 = *(a1 + 32);
    v132 = [v2 clientAssetSelector];
    v128 = [v7 notifications];
    v124 = [v7 availableForUseAttributes];
    v121 = [v7 newerVersionAttributes];
    v118 = [v7 neverBeenLocked];
    v115 = [v7 downloadUserInitiated];
    v109 = [v7 downloadProgress];
    v114 = [v7 downloadedNetworkBytes];
    v112 = [v7 downloadedFilesystemBytes];
    v111 = [v7 downloadedAsPatch];
    v108 = [v7 patchedFromBaseSelector];
    v110 = [v7 patchedFromBaseFilesystemBytes];
    v8 = [v7 patchingAttempted];
    v9 = [v7 stagedPriorToAvailable];
    v10 = [v7 stagedFromOSVersion];
    v11 = [v7 stagedFromBuildVersion];
    v12 = [v7 availableForUseError];
    v13 = [v7 patchingAttemptError];
    v14 = [v7 newerVersionError];
    LOBYTE(v107) = 1;
    BYTE1(v106) = v9;
    LOBYTE(v106) = v8;
    LOBYTE(v105) = v111;
    v15 = v132;
    v140 = [v139 newAssetStatusForSelector:v132 withNotifications:v128 withAvailableForUseAttributes:v124 withNewerVersionAttributes:v121 withNeverBeenLocked:v118 withDownloadUserInitiated:v115 withDownloadProgress:v109 withDownloadedNetworkBytes:v114 withDownloadedFilesystemBytes:v112 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:v108 withPatchedFromBaseFilesystemBytes:v110 withPatchingAttempted:v106 withStagedPriorToAvailable:v10 withStagedFromOSVersion:v11 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:v12 withAvailableForUseError:v13 withPatchingAttemptError:v14 withNewerVersionError:?];

LABEL_7:
    goto LABEL_8;
  }

  v16 = [v2 clientAssetSelector];
  v17 = [v16 assetVersion];

  v18 = *(a1 + 32);
  if (v17)
  {
    v19 = [v2 clientAssetSelector];
    v15 = [v18 locateDownloadedByFullSelector:v19];

    v20 = *(a1 + 32);
    if (v15)
    {
      v133 = [v2 clientAssetSelector];
      v129 = objc_alloc_init(MAAutoAssetNotifications);
      v125 = [v15 metadata];
      v141 = [v15 neverBeenLocked];
      v122 = [v15 downloadUserInitiated];
      v119 = [v15 downloadedNetworkBytes];
      v116 = [v15 downloadedFilesystemBytes];
      v21 = [v15 isPatch];
      v22 = [v15 patchedFromBaseSelector];
      v23 = [v15 patchedFromBaseFilesystemBytes];
      v24 = [v15 patchingAttempted];
      v25 = [v15 stagedPriorToAvailable];
      v26 = [v15 stagedFromOSVersion];
      v27 = [v15 stagedFromBuildVersion];
      v28 = [v15 patchingAttemptError];
      LOBYTE(v107) = 1;
      BYTE1(v106) = v25;
      LOBYTE(v106) = v24;
      v29 = v133;
      LOBYTE(v105) = v21;
      v140 = [v20 newAssetStatusForSelector:v133 withNotifications:v129 withAvailableForUseAttributes:v125 withNewerVersionAttributes:0 withNeverBeenLocked:v141 withDownloadUserInitiated:v122 withDownloadProgress:0 withDownloadedNetworkBytes:v119 withDownloadedFilesystemBytes:v116 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:v22 withPatchedFromBaseFilesystemBytes:v23 withPatchingAttempted:v106 withStagedPriorToAvailable:v26 withStagedFromOSVersion:v27 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:v28 withPatchingAttemptError:0 withNewerVersionError:?];

LABEL_6:
      goto LABEL_7;
    }

    v61 = [*(a1 + 32) stagerCurrentJob];
    if (v61)
    {
      v29 = v61;
      v62 = [v2 clientAssetSelector];
      v63 = [v62 assetType];
      v64 = [*(a1 + 32) stagerCurrentJob];
      v65 = [v64 autoAssetSelector];
      [v65 assetType];
      v67 = v66 = v2;
      if (![SUCore stringIsEqual:v63 to:v67])
      {

LABEL_53:
        v140 = 0;
        goto LABEL_6;
      }

      v142 = v62;
      v134 = v29;
      v68 = [v66 clientAssetSelector];
      v69 = [v68 assetSpecifier];
      v126 = [*(a1 + 32) stagerCurrentJob];
      v123 = [v126 autoAssetSelector];
      v70 = [v123 assetSpecifier];
      v130 = v69;
      v71 = v69;
      v72 = v70;
      if ([SUCore stringIsEqual:v71 to:v70])
      {
        v117 = [v66 clientAssetSelector];
        v113 = [v117 assetVersion];
        v73 = [*(a1 + 32) stagerCurrentJob];
        [v73 autoAssetSelector];
        v74 = v120 = v68;
        [v74 assetVersion];
        v76 = v75 = v63;
        v77 = [SUCore stringIsEqual:v113 to:v76];

        v63 = v75;
        v68 = v120;
      }

      else
      {
        v77 = 0;
      }

      if (v77)
      {
        v100 = *(v138 + 32);
        if (!*(v138 + 48))
        {
          v102 = [v137 clientAssetSelector];
          v103 = objc_alloc_init(MAAutoAssetNotifications);
          LOBYTE(v107) = 1;
          LOWORD(v106) = 0;
          LOBYTE(v105) = 0;
          v140 = [v100 newAssetStatusForSelector:v102 withNotifications:v103 withAvailableForUseAttributes:0 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v106 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

          [*(v138 + 32) stagerCurrentJob];
          v136 = v29 = v136;
          goto LABEL_6;
        }

        v29 = [*(v138 + 32) autoControlManagerFSM];
        v101 = [v29 diag];
        [v101 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleClientCurrentStatusRequest} downloading-stager-job matching provided auto-job" withResult:6101 withError:0];

        goto LABEL_53;
      }
    }

    v140 = 0;
    goto LABEL_7;
  }

  v56 = [*(a1 + 32) stagerCurrentJob];
  if (v56)
  {
    v57 = v56;
    v58 = [*(a1 + 32) stagerCurrentJob];
    v59 = [v58 autoAssetSelector];
    v60 = [v59 assetVersion];
    if (v60)
    {
    }

    else
    {
      v143 = [v2 clientAssetSelector];
      v78 = [v143 assetType];
      v79 = [*(a1 + 32) stagerCurrentJob];
      v80 = [v79 autoAssetSelector];
      v81 = [v80 assetType];
      v135 = v78;
      if ([SUCore stringIsEqual:v78 to:v81])
      {
        v127 = [v2 clientAssetSelector];
        v82 = [v127 assetSpecifier];
        v83 = [*(a1 + 32) stagerCurrentJob];
        v84 = [v83 autoAssetSelector];
        v85 = [v84 assetSpecifier];
        v131 = [SUCore stringIsEqual:v82 to:v85];

        v86 = v138;
        v2 = v137;

        if (!v131)
        {
          goto LABEL_34;
        }

        v87 = *(v138 + 32);
        if (!*(v138 + 48))
        {
          v104 = [v87 stagerCurrentJob];

          v97 = 0;
          v136 = v104;
LABEL_46:
          v98 = *(v86 + 32);
          v88 = [v2 clientAssetSelector];
          v99 = objc_alloc_init(MAAutoAssetNotifications);
          LOBYTE(v107) = 1;
          LOWORD(v106) = 0;
          LOBYTE(v105) = 0;
          v140 = [v98 newAssetStatusForSelector:v88 withNotifications:v99 withAvailableForUseAttributes:0 withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v105 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v106 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v107 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

          goto LABEL_47;
        }

        v57 = [v87 autoControlManagerFSM];
        v58 = [v57 diag];
        [v58 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleClientCurrentStatusRequest} determining-stager-job matching provided auto-job" withResult:6101 withError:0];
        goto LABEL_33;
      }
    }

LABEL_33:
  }

LABEL_34:
  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v144 = 0u;
  v145 = 0u;
  v146 = 0u;
  v88 = v147 = 0u;
  v89 = [v88 countByEnumeratingWithState:&v144 objects:v156 count:16];
  if (!v89)
  {
LABEL_43:
    v140 = 0;
    v97 = v88;
LABEL_47:

    goto LABEL_8;
  }

  v90 = v89;
  v91 = *v145;
LABEL_36:
  v92 = 0;
  while (1)
  {
    if (*v145 != v91)
    {
      objc_enumerationMutation(v88);
    }

    v93 = *(*(&v144 + 1) + 8 * v92);
    if (([v93 setJob] & 1) == 0)
    {
      v94 = [v93 assetSelector];
      v95 = [v2 clientAssetSelector];
      v96 = [MADAutoAssetScheduler isSelector:v94 consideredEqualTo:v95];

      if (v96)
      {
        break;
      }
    }

    if (v90 == ++v92)
    {
      v90 = [v88 countByEnumeratingWithState:&v144 objects:v156 count:16];
      if (v90)
      {
        goto LABEL_36;
      }

      goto LABEL_43;
    }
  }

  v97 = v93;

  if (v97)
  {
    v86 = v138;
    goto LABEL_46;
  }

  v140 = 0;
LABEL_8:
  if (v140)
  {
    v30 = objc_alloc_init(NSMutableDictionary);
    v31 = [MAAutoAssetInfoFound alloc];
    v32 = v137;
    v33 = [v137 clientAssetSelector];
    v34 = [v31 initForSelector:v33 withLocalContentURL:0 withAssetAttributes:0 reportingStatus:v140];

    [v30 setSafeObject:v137 forKey:@"instance"];
    [v30 setSafeObject:v34 forKey:@"found"];
    v35 = [SUCoreConnectMessage alloc];
    v36 = v138;
    v37 = [*(v138 + 40) clientRequestMessage];
    v38 = [MADAutoAssetControlManager replyMessageNameForRequest:v37];
    v39 = [*(v138 + 40) clientRequestMessage];
    v40 = [v39 clientID];
    v41 = [v35 initWithType:2 messageName:v38 clientID:v40 version:0 message:v30];

    [*(v36 + 32) issueBuiltResponseForEventInfo:*(v36 + 40) issuingResponseMessage:v41 withResponseError:0 fromLocation:@"handleClientCurrentStatusRequest"];
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
    {
      v43 = [*(v138 + 32) _updateLatestSummary];
      v44 = [v137 clientAssetSelector];
      v45 = [v140 summary];
      v46 = [*(v138 + 40) summary];
      *buf = 138544130;
      v149 = v43;
      v150 = 2114;
      v151 = v44;
      v152 = 2114;
      v153 = v45;
      v154 = 2114;
      v155 = v46;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleClientCurrentStatusRequest} current status request | selector:%{public}@, lastJobStatus:%{public}@, event:%{public}@", buf, 0x2Au);

      v36 = v138;
    }

    if ([*(v36 + 32) simulateOperationRequested])
    {
      v47 = v136;
      if (v136 || (v48 = *(v36 + 32), [v137 clientAssetSelector], v49 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v48, "currentJobBySelector:", v49), v47 = objc_claimAutoreleasedReturnValue(), v49, v47))
      {
        v50 = *(v36 + 32);
        v51 = [v137 clientAssetSelector];
        v52 = [v50 jobControlInformationForSelector:v51];
        [v47 clientRequestedStatus:v52];
      }
    }

    else
    {
      v47 = v136;
    }
  }

  else
  {
    v53 = *(v138 + 32);
    v54 = *(v138 + 40);
    v55 = [NSString alloc];
    v32 = v137;
    v30 = [v137 summary];
    v34 = [v55 initWithFormat:@"current status requested for unknown asset-selector (no status available for instance:%@)", v30];
    [v53 issueResponseForEventInfo:v54 withErrorCode:6301 fromAction:@"RouteClientRequest" withDescription:v34];
    v47 = v136;
  }
}

- (void)handleClientMapLockedToExclaveRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleClientMapLockedToExclaveRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:handleClientMapLockedToExclaveRequest", locationCopy];
  v9 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
  v31 = v9;
  if (!v9)
  {
    v27 = @"no auto-asset-instance provided in client map-locked-to-exclave request";
LABEL_19:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:v27];
    goto LABEL_23;
  }

  clientAssetSelector = [v9 clientAssetSelector];
  assetSpecifier = [clientAssetSelector assetSpecifier];
  v12 = assetSpecifier == 0;

  if (v12)
  {
    v27 = @"asset-selector missing asset-specifier to be mapped";
    goto LABEL_19;
  }

  clientAssetSelector2 = [v31 clientAssetSelector];
  assetVersion = [clientAssetSelector2 assetVersion];
  v15 = assetVersion == 0;

  if (v15)
  {
    v27 = @"asset-selector missing asset-version to be mapped";
    goto LABEL_19;
  }

  clientAssetSelector3 = [v31 clientAssetSelector];
  v28 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:clientAssetSelector3];
  v17 = +[MADAutoAssetLocker copyOfLocksBySelector];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"copyOfLocksBySelector"];
  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  v18 = v17;
  v19 = [v18 countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (v19)
  {
    v20 = *v39;
LABEL_6:
    v21 = 0;
    while (1)
    {
      if (*v39 != v20)
      {
        objc_enumerationMutation(v18);
      }

      v22 = [v18 safeObjectForKey:*(*(&v38 + 1) + 8 * v21) ofClass:objc_opt_class()];
      fullAssetSelector = [v22 fullAssetSelector];
      v24 = [fullAssetSelector isEqual:clientAssetSelector3];

      if (v24)
      {
        break;
      }

      if (v19 == ++v21)
      {
        v19 = [v18 countByEnumeratingWithState:&v38 objects:v43 count:16];
        if (v19)
        {
          goto LABEL_6;
        }

        goto LABEL_12;
      }
    }

    if (![MADAutoAssetSecure doesDescriptorInvolveGrafting:locationCopy forDescriptor:v28])
    {
      v25 = @"asset-selector is not a cyptex file (must be a cryptex to map to exclave environment)";
      v26 = 6531;
      goto LABEL_21;
    }

    if ([v28 secureOperationInProgress])
    {
      v25 = @"secure operation already in-progress for set-descriptor - mapping blocked until current secure operation has completed";
      v26 = 6532;
      goto LABEL_21;
    }

    [v28 setSecureOperationInProgress:1];
    v33[0] = _NSConcreteStackBlock;
    v33[1] = 3221225472;
    v33[2] = __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke;
    v33[3] = &unk_4B46D0;
    v33[4] = self;
    v34 = v28;
    v35 = clientAssetSelector3;
    v36 = locationCopy;
    v37 = requestCopy;
    [MADAutoAssetSecure mapToExclave:v36 forDescriptor:v34 completion:v33];
  }

  else
  {
LABEL_12:

    v25 = @"asset-selector is not currently locked (must be locked to map to exclave environment)";
    v26 = 6501;
LABEL_21:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:v26 fromAction:locationCopy withDescription:v25];
  }

LABEL_23:
  os_activity_scope_leave(&state);
}

void __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke_2;
  block[3] = &unk_4B3818;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v11 = v4;
  dispatch_async(v6, block);
}

id __81__MADAutoAssetControlManager_handleClientMapLockedToExclaveRequest_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      v10 = 138543618;
      v11 = v3;
      v12 = 2114;
      v13 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-MAP][ELIMINATE] {%{public}@} | eliminate triggered while mapping-to-exclave | mapDescriptor:%{public}@", &v10, 0x16u);
    }

    return [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else
  {
    v6 = *(a1 + 40);
    if (*(a1 + 72))
    {
      v7 = *(a1 + 64);

      return [v6 issueResponseForEventInfo:v7 withAutoAssetError:? fromAction:? withDescription:?];
    }

    else
    {
      v8 = *(a1 + 32);
      v9 = *(a1 + 64);

      return [v6 lockAutoAssetReplyJobResponse:@"mapping successful" forEventInfo:v9 lockingChosenDescriptor:v8];
    }
  }
}

- (void)handleClientCancelActivityForSelectorRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientCancelActivityForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v14);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v14.opaque[0], v14.opaque[1]];
  v9 = v8;
  if (!v8)
  {
    v13 = @"no auto-asset-instance provided in client cancel-activity request";
LABEL_6:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientCancelActivityForSelectorRequest" withDescription:v13];
    goto LABEL_7;
  }

  clientAssetSelector = [v8 clientAssetSelector];
  assetSpecifier = [clientAssetSelector assetSpecifier];

  if (!assetSpecifier)
  {
    v13 = @"asset-selector missing asset-specifier when required for cancel-activity request";
    goto LABEL_6;
  }

  clientAssetSelector2 = [v9 clientAssetSelector];
  [(MADAutoAssetControlManager *)self _eliminateBegin:requestCopy forAssetSelector:clientAssetSelector2 limitingToActivity:1 fromLocation:@"handleClientCancelActivityForSelectorRequest"];

LABEL_7:
  os_activity_scope_leave(&v14);
}

- (void)handleClientEliminateAllForSelectorRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16.opaque[0] = 0;
  v16.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminateAllForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v16);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v16.opaque[0], v16.opaque[1]];
  v9 = v8;
  if (v8)
  {
    clientAssetSelector = [v8 clientAssetSelector];
    assetSpecifier = [clientAssetSelector assetSpecifier];
    v12 = assetSpecifier == 0;

    if (v12)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminateAllForSelectorRequest" withDescription:@"asset-selector missing asset-specifier when required for eliminate request"];
      clientAssetSelector2 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(clientAssetSelector2, OS_LOG_TYPE_ERROR))
      {
        summary = [requestCopy summary];
        *buf = 138543362;
        v18 = summary;
        _os_log_impl(&dword_0, clientAssetSelector2, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForSelectorRequest} asset-selector missing asset-specifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      clientAssetSelector2 = [v9 clientAssetSelector];
      [(MADAutoAssetControlManager *)self _eliminateBegin:requestCopy forAssetSelector:clientAssetSelector2 limitingToActivity:0 fromLocation:@"handleClientEliminateAllForSelectorRequest"];
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminateAllForSelectorRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    clientAssetSelector2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(clientAssetSelector2, OS_LOG_TYPE_ERROR))
    {
      summary2 = [requestCopy summary];
      *buf = 138543362;
      v18 = summary2;
      _os_log_impl(&dword_0, clientAssetSelector2, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForSelectorRequest} no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v16);
}

- (void)handleClientEliminateAllForAssetTypeRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14.opaque[0] = 0;
  v14.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminateAllForAssetTypeRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v14);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v14.opaque[0], v14.opaque[1]];
  if (v8)
  {
    v9 = [MAAutoAssetSelector alloc];
    clientAssetSelector = [v8 clientAssetSelector];
    assetType = [clientAssetSelector assetType];
    v12 = [v9 initForAssetType:assetType];

    [(MADAutoAssetControlManager *)self _eliminateBegin:requestCopy forAssetSelector:v12 limitingToActivity:0 fromLocation:@"handleClientEliminateAllForAssetTypeRequest"];
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminateAllForAssetTypeRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      summary = [requestCopy summary];
      *buf = 138543362;
      v16 = summary;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminateAllForAssetTypeRequest} no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v14);
}

- (void)handleClientEliminatePromotedNeverLockedForSelectorRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v20.opaque[0] = 0;
  v20.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleClientEliminatePromotedNeverLockedForSelectorRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v20);

  v8 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v20.opaque[0], v20.opaque[1]];
  v9 = v8;
  if (v8)
  {
    clientAssetSelector = [v8 clientAssetSelector];
    assetSpecifier = [clientAssetSelector assetSpecifier];
    v12 = assetSpecifier == 0;

    if (v12)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"asset-selector missing asset-specifier when required for eliminate request"];
      clientAssetSelector3 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(clientAssetSelector3, OS_LOG_TYPE_ERROR))
      {
        summary = [requestCopy summary];
        *buf = 138543362;
        v22 = summary;
        _os_log_impl(&dword_0, clientAssetSelector3, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] asset-selector missing asset-specifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      clientAssetSelector2 = [v9 clientAssetSelector];
      assetVersion = [clientAssetSelector2 assetVersion];
      v15 = assetVersion == 0;

      if (v15)
      {
        clientAssetSelector3 = [v9 clientAssetSelector];
        [(MADAutoAssetControlManager *)self _eliminatePromotedNeverLocked:requestCopy forAssetSelector:clientAssetSelector3];
      }

      else
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"asset-selector with asset-version not supported for eliminate request"];
        clientAssetSelector3 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(clientAssetSelector3, OS_LOG_TYPE_ERROR))
        {
          summary2 = [requestCopy summary];
          *buf = 138543362;
          v22 = summary2;
          _os_log_impl(&dword_0, clientAssetSelector3, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] asset-selector with asset-version not supported for eliminate request | eventInfo:%{public}@", buf, 0xCu);
        }
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleClientEliminatePromotedNeverLockedForSelectorRequest" withDescription:@"no auto-asset-instance provided in client eliminate request"];
    clientAssetSelector3 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(clientAssetSelector3, OS_LOG_TYPE_ERROR))
    {
      summary3 = [requestCopy summary];
      *buf = 138543362;
      v22 = summary3;
      _os_log_impl(&dword_0, clientAssetSelector3, OS_LOG_TYPE_ERROR, "\n[ELIMINATE]{handleClientEliminatePromotedNeverLockedForSelectorRequest} [MissingParameter] no auto-asset-instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&v20);
}

- (void)handleControlClientControlStatisticsRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientControlStatisticsRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v14 = -[MADAutoAssetControlManager _statsCombinedCopy:](self, "_statsCombinedCopy:", [v13 clearingAfter]);
  v23 = message;
  v24 = jobCopy;
  v15 = objc_alloc_init(NSMutableDictionary);
  v16 = [MASAutoAssetControlStatistics newShimmedToFramework:v14];
  [v15 setSafeObject:v16 forKey:@"controlStatistics"];

  v17 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v19 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v22 = [v17 initWithType:2 messageName:v19 clientID:clientID version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v22 withResponseError:0 fromLocation:@"handleControlClientControlStatisticsRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientAvailableForStagingSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  v17.opaque[0] = 0;
  v17.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientAvailableForStagingSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &v17);

  v9 = objc_alloc_init(NSMutableArray);
  v10 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v17.opaque[0]];
  [MADAutoAssetStager extendSummaryWithAvailableForStagingAssets:v9];
  [v10 setSafeObject:v9 forKey:@"jobSummary"];
  v11 = [SUCoreConnectMessage alloc];
  clientRequestMessage = [requestCopy clientRequestMessage];
  v13 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v16 = [v11 initWithType:2 messageName:v13 clientID:clientID version:0 message:v10];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v16 withResponseError:0 fromLocation:@"handleControlClientAvailableForStagingSummaryRequest"];
  os_activity_scope_leave(&v17);
}

- (void)handleControlClientKnownAssetSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientKnownAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v11 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)selfCopy addActiveJobs:v11 basedOnControl:v10];
  [(MADAutoAssetControlManager *)selfCopy addSuccessfullyDownloadedJobs:v11 basedOnControl:v10];
  [(MADAutoAssetControlManager *)selfCopy ensureStagerFullyResumed];
  [MADAutoAssetStager extendSummaryWithDeterminedAssets:v11 basedOnControl:v10];
  [MADAutoAssetStager extendSummaryWithStagingAssets:v11 basedOnControl:v10];
  [MADAutoAssetStager extendSummaryWithStagedAssets:v11 basedOnControl:v10];
  [MADAutoAssetScheduler addScheduledJobs:v11 basedOnControl:v10];
  v53 = v11;
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  clientRequestsAwaitingSync = [(MADAutoAssetControlManager *)selfCopy clientRequestsAwaitingSync];
  v13 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v58 objects:v64 count:16];
  if (v13)
  {
    v14 = *v59;
    do
    {
      v15 = 0;
      do
      {
        if (*v59 != v14)
        {
          objc_enumerationMutation(clientRequestsAwaitingSync);
        }

        v16 = *(*(&v58 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        autoAssetSelector = [v16 autoAssetSelector];
        v19 = [MADAutoAssetControlManager selectorToBeIncluded:autoAssetSelector basedOnControl:v10];

        if (v19)
        {
          autoAssetStatus = [v16 autoAssetStatus];
          v21 = [autoAssetStatus copy];

          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v21 setCurrentLockUsage:0];
          }

          v22 = [MAAutoAssetSummary alloc];
          autoAssetSelector2 = [v16 autoAssetSelector];
          v24 = [v22 initWithAssetSelector:autoAssetSelector2 withAssetRepresentation:200 withAssetWasPatched:0 withAssetIsStaged:0 withJobStatus:v21 withScheduledIntervalSecs:0 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

          if (v24)
          {
            [v53 addObject:v24];
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleControlClientKnownAssetSummaryRequest} unable to allocate summaryEntry for clientRequestsAwaitingSync" withResult:6101 withError:0];
          }
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v13 != v15);
      v13 = [clientRequestsAwaitingSync countByEnumeratingWithState:&v58 objects:v64 count:16];
    }

    while (v13);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  clientRequestsAwaitingFirstUnlock = [(MADAutoAssetControlManager *)selfCopy clientRequestsAwaitingFirstUnlock];
  v28 = [clientRequestsAwaitingFirstUnlock countByEnumeratingWithState:&v54 objects:v63 count:16];
  if (v28)
  {
    v29 = *v55;
    do
    {
      v30 = 0;
      do
      {
        if (*v55 != v29)
        {
          objc_enumerationMutation(clientRequestsAwaitingFirstUnlock);
        }

        v31 = *(*(&v54 + 1) + 8 * v30);
        v32 = objc_autoreleasePoolPush();
        autoAssetSelector3 = [v31 autoAssetSelector];
        v34 = [MADAutoAssetControlManager selectorToBeIncluded:autoAssetSelector3 basedOnControl:v10];

        if (v34)
        {
          autoAssetStatus2 = [v31 autoAssetStatus];
          v36 = [autoAssetStatus2 copy];

          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v36 setCurrentLockUsage:0];
          }

          v37 = [MAAutoAssetSummary alloc];
          autoAssetSelector4 = [v31 autoAssetSelector];
          v39 = [v37 initWithAssetSelector:autoAssetSelector4 withAssetRepresentation:201 withAssetWasPatched:0 withAssetIsStaged:0 withJobStatus:v36 withScheduledIntervalSecs:0 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

          if (v39)
          {
            [v53 addObject:v39];
          }

          else
          {
            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag2 = [autoControlManagerFSM3 diag];
            [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:@"{handleControlClientKnownAssetSummaryRequest} unable to allocate summaryEntry for clientRequestsAwaitingFirstUnlock" withResult:6101 withError:0];
          }
        }

        objc_autoreleasePoolPop(v32);
        v30 = v30 + 1;
      }

      while (v28 != v30);
      v28 = [clientRequestsAwaitingFirstUnlock countByEnumeratingWithState:&v54 objects:v63 count:16];
    }

    while (v28);
  }

  v42 = objc_alloc_init(NSMutableDictionary);
  [v42 setSafeObject:v53 forKey:@"jobSummary"];
  v43 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v45 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v48 = [v43 initWithType:2 messageName:v45 clientID:clientID version:0 message:v42];

  [(MADAutoAssetControlManager *)selfCopy issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v48 withResponseError:0 fromLocation:@"handleControlClientKnownAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientLockedAssetSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientLockedAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [MADAutoAssetLocker addClientLockReasons:v14 basedOnControl:v13];
  v22 = message;
  v23 = jobCopy;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"lockSummary"];
  v16 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:clientID version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientKnownAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientStagedAssetSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientStagedAssetSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  [MADAutoAssetStager extendSummaryWithStagedAssets:v14 basedOnControl:v13];
  v22 = message;
  v23 = jobCopy;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:clientID version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientStagedAssetSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientActiveJobSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientActiveJobSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self addActiveJobs:v14 basedOnControl:v13];
  v22 = message;
  v23 = jobCopy;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:clientID version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientActiveJobSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientScheduledJobSummaryRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientScheduledJobSummaryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v13 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v14 = objc_alloc_init(NSMutableArray);
  [MADAutoAssetScheduler addScheduledJobs:v14 basedOnControl:v13];
  v22 = message;
  v23 = jobCopy;
  v15 = objc_alloc_init(NSMutableDictionary);
  [v15 setSafeObject:v14 forKey:@"jobSummary"];
  v16 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:clientID version:0 message:v15];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientScheduledJobSummaryRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleControlClientStagerOverviewRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v22.opaque[0] = 0;
  v22.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientStagerOverviewRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v22);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v22.opaque[0]];
  v11 = +[MADAutoAssetStager collectOverviewInformation];
  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    summary = [v11 summary];
    *buf = 138543362;
    v24 = summary;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "{handleControlClientStagerOverviewRequest} stagerInformation:%{public}@", buf, 0xCu);
  }

  v14 = objc_alloc_init(NSMutableDictionary);
  v15 = [MASAutoAssetControlStagerInformation newShimmedToFramework:v11];
  [v14 setSafeObject:v15 forKey:@"stagerInformation"];

  v16 = [SUCoreConnectMessage alloc];
  clientRequestMessage = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v21 = [v16 initWithType:2 messageName:v18 clientID:clientID version:0 message:v14];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientStagerOverviewRequest"];
  os_activity_scope_leave(&v22);
}

- (void)forceGlobalUnlockFromLocation:(id)location dueToError:(id)error fullAssetSelector:(id)selector historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d
{
  locationCopy = location;
  errorCopy = error;
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:forceGlobalUnlockFromLocation", locationCopy];
  v48 = 0;
  [MADAutoAssetLocker forceGlobalUnlock:selectorCopy atomicInstancesHandle:&v48];
  v16 = v48;
  v17 = v16;
  if (v16)
  {
    v37 = selectorCopy;
    v38 = locationCopy;
    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v36 = v16;
    v18 = v16;
    v43 = [v18 countByEnumeratingWithState:&v44 objects:v49 count:16];
    if (v43)
    {
      v19 = *v45;
      selfCopy = self;
      do
      {
        for (i = 0; i != v43; i = i + 1)
        {
          if (*v45 != v19)
          {
            objc_enumerationMutation(v18);
          }

          v21 = *(*(&v44 + 1) + 8 * i);
          v22 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:v21 requireExists:1];
          if (v22)
          {
            v23 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:v22];
            if (v23)
            {
              autoControlManagerFSM2 = v23;
              [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:locationCopy dueToError:errorCopy forgettingAtomicInstance:v23 historyOperationAI:i historyOperationSD:d];
            }

            else
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v28 = objc_alloc(p_weak_ivar_lyt[226]);
              [v22 summary];
              v29 = v19;
              v30 = v18;
              v32 = v31 = p_weak_ivar_lyt;
              v33 = [v28 initWithFormat:@"{%@} unable to locate atomic-instance for set-descriptor | downloadedSetDescriptor:%@", locationCopy, v32];
              [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v33 withResult:6101 withError:0];

              p_weak_ivar_lyt = v31;
              v18 = v30;
              v19 = v29;
              self = selfCopy;
            }
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag2 = [autoControlManagerFSM2 diag];
            v26 = [objc_alloc(p_weak_ivar_lyt[226]) initWithFormat:@"{%@} unable to locate set-descriptor for locked atomic-instance | setAtomicInstanceUUID:%@", locationCopy, v21];
            [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6101 withError:0];
          }
        }

        v43 = [v18 countByEnumeratingWithState:&v44 objects:v49 count:16];
      }

      while (v43);
    }

    selectorCopy = v37;
    locationCopy = v38;
    v17 = v36;
  }

  assetVersion = [selectorCopy assetVersion];

  if (assetVersion)
  {
    v35 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:selectorCopy];
    if (v35)
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraft:locationCopy forDescriptorNoLongerLocked:v35];
    }
  }
}

- (void)forceGlobalSetUnlock:(id)unlock dueToError:(id)error ofSetDescriptor:(id)descriptor historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d
{
  unlockCopy = unlock;
  errorCopy = error;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v37 = unlockCopy;
  unlockCopy = [[NSString alloc] initWithFormat:@"%@:forceGlobalSetUnlock", unlockCopy];
  v38 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:descriptorCopy];
  v43 = 0u;
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v16 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v43 objects:v48 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v44;
    do
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v44 != v18)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        fullAssetSelector = [*(*(&v43 + 1) + 8 * i) fullAssetSelector];
        [MADAutoAssetLocker forceGlobalUnlock:fullAssetSelector atomicInstancesHandle:0];
      }

      v17 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v43 objects:v48 count:16];
    }

    while (v17);
  }

  if (v38)
  {
    v21 = errorCopy;
    [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:unlockCopy dueToError:errorCopy forgettingAtomicInstance:v38 historyOperationAI:i historyOperationSD:d];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v24 = [NSString alloc];
    summary = [descriptorCopy summary];
    v26 = [v24 initWithFormat:@"{%@} unable to locate atomic-instance for set-descriptor | setDescriptor:%@", unlockCopy, summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v26 withResult:6101 withError:0];

    v21 = errorCopy;
  }

  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  latestDowloadedAtomicInstanceEntries2 = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v28 = [latestDowloadedAtomicInstanceEntries2 countByEnumeratingWithState:&v39 objects:v47 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v40;
    do
    {
      for (j = 0; j != v29; j = j + 1)
      {
        if (*v40 != v30)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries2);
        }

        fullAssetSelector2 = [*(*(&v39 + 1) + 8 * j) fullAssetSelector];
        v33 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector2];

        [(MADAutoAssetControlManager *)self secureCheckUngraft:unlockCopy forDescriptorNoLongerLocked:v33];
      }

      v29 = [latestDowloadedAtomicInstanceEntries2 countByEnumeratingWithState:&v39 objects:v47 count:16];
    }

    while (v29);
  }
}

- (void)handleControlClientForceGlobalUnlockRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v21.opaque[0] = 0;
  v21.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalUnlockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v21);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v21.opaque[0], v21.opaque[1]];
  clientAssetSelector = [v11 clientAssetSelector];
  v13 = clientAssetSelector;
  if (!clientAssetSelector)
  {
    v20 = @"no clientAssetSelector in request";
LABEL_6:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v20];
    goto LABEL_7;
  }

  assetType = [clientAssetSelector assetType];

  if (!assetType)
  {
    v20 = @"clientAssetSelector is missing assetType";
    goto LABEL_6;
  }

  [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:@"handleControlClientForceGlobalUnlockRequest" dueToError:0 fullAssetSelector:v13 historyOperationAI:342 historyOperationSD:386];
  clientRequestMessage = [requestCopy clientRequestMessage];
  v16 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v19 = [MADAutoAssetControlManager createSeverMessageWithName:v16 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleControlClientForceGlobalUnlockRequest"];
LABEL_7:

  os_activity_scope_leave(&v21);
}

- (void)handleControlClientForceGlobalForgetRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalForgetRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
  clientAssetSelector = [v11 clientAssetSelector];
  v13 = clientAssetSelector;
  if (!clientAssetSelector)
  {
    v22 = @"no clientAssetSelector in request";
LABEL_8:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v22];
    goto LABEL_9;
  }

  assetType = [clientAssetSelector assetType];

  if (!assetType)
  {
    v22 = @"clientAssetSelector is missing assetType";
    goto LABEL_8;
  }

  persistedEntryID = [v13 persistedEntryID];
  [MADAutoAssetScheduler forceGlobalForget:v13];
  if (persistedEntryID)
  {
    alreadyScheduledSelectors = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
    [alreadyScheduledSelectors removeObjectForKey:persistedEntryID];
  }

  v23 = jobCopy;
  clientRequestMessage = [requestCopy clientRequestMessage];
  v18 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v21 = [MADAutoAssetControlManager createSeverMessageWithName:v18 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v21 withResponseError:0 fromLocation:@"handleControlClientForceGlobalForgetRequest"];
  jobCopy = v23;
LABEL_9:

  os_activity_scope_leave(&state);
}

- (void)handleControlClientForceGlobalPurgeRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalPurgeRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy];
  clientAssetSelector = [v10 clientAssetSelector];
  v12 = clientAssetSelector;
  if (clientAssetSelector)
  {
    assetType = [clientAssetSelector assetType];

    if (assetType)
    {
      assetType2 = [v12 assetType];
      v15 = getAutoLocalUrlFromTypeWithPurpose(assetType2, 2, @"auto");

      v37 = v15;
      path = [v15 path];
      v38 = +[NSFileManager defaultManager];
      if (!path)
      {
        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag = [autoControlManagerFSM2 diag];
        v26 = [NSString alloc];
        summary = [v12 summary];
        v28 = [v26 initWithFormat:@"{handleControlClientForceGlobalPurgeRequest} unable to determine local repository path for selector:%@", summary];
        [diag trackAnomaly:@"AUTO-CONTROL" forReason:v28 withResult:6101 withError:0];

        v29 = [NSString alloc];
        summary2 = [v12 summary];
        v18 = [v29 initWithFormat:@"unable to determine local repository path for selector:%@", summary2];
        v22 = [MAAutoAssetError buildError:6107 fromOperation:@"handleControlClientForceGlobalPurgeRequest" underlyingError:0 withDescription:v18];
LABEL_17:

        clientRequestMessage = [requestCopy clientRequestMessage];
        v33 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
        clientRequestMessage2 = [requestCopy clientRequestMessage];
        clientID = [clientRequestMessage2 clientID];
        v36 = [MADAutoAssetControlManager createSeverMessageWithName:v33 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:v22];

        [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v36 withResponseError:v22 fromLocation:@"handleControlClientForceGlobalPurgeRequest"];
        goto LABEL_18;
      }

      summary2 = [[NSURL alloc] initFileURLWithPath:path];
      if ([v38 fileExistsAtPath:path])
      {
        v17 = getControlManager();
        v18 = [v17 getSAFRegistrationBundleID:summary2];

        v41 = 0;
        renameWithExtThenRemoveExposeError(path, @".purged", &v41);
        v19 = v41;
        if (v19)
        {
          assetType3 = v19;
          v21 = [[NSString alloc] initWithFormat:@"error while attempting to remove auto-asset repository directory:%@", path];
          v22 = [MAAutoAssetError buildError:6107 fromOperation:@"handleControlClientForceGlobalPurgeRequest" underlyingError:assetType3 withDescription:v21];
LABEL_16:

          goto LABEL_17;
        }
      }

      else
      {
        v18 = 0;
      }

      v30 = getControlManager();
      [v30 updateSpaceAttributionForBundleID:v18 assetPath:summary2 doRegistration:0];

      autoAssetClientName = [v10 autoAssetClientName];
      if (autoAssetClientName)
      {
        [v10 autoAssetClientName];
      }

      else
      {
        [v10 clientProcessName];
      }
      v21 = ;

      assetType3 = [v12 assetType];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:assetType3 firstClientName:v21];
      v22 = 0;
      goto LABEL_16;
    }

    v23 = @"clientAssetSelector is missing assetType";
  }

  else
  {
    v23 = @"no clientAssetSelector in request";
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"RouteClientRequest" withDescription:v23];
LABEL_18:

  os_activity_scope_leave(&state);
}

- (void)handleControlClientForceGlobalAbandonRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v18.opaque[0] = 0;
  v18.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientForceGlobalAbandonRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &v18);

  v11 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:requestCopy, v18.opaque[0], v18.opaque[1]];
  clientAssetSelector = [v11 clientAssetSelector];
  v13 = clientAssetSelector;
  if (!clientAssetSelector)
  {
    v17 = @"no clientAssetSelector in request";
LABEL_6:
    v16 = 6102;
    goto LABEL_7;
  }

  assetType = [clientAssetSelector assetType];

  if (!assetType)
  {
    v17 = @"clientAssetSelector is missing assetType";
    goto LABEL_6;
  }

  assetType2 = [v13 assetType];
  [(MADAutoAssetControlManager *)self _removeFromPersistedActiveJobs:assetType2];

  v16 = 0;
  v17 = @"active jobs for provided asset-type have been removed from tracking (auto-asset-jobs may remain)";
LABEL_7:
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:v16 fromAction:@"RouteClientRequest" withDescription:v17];

  os_activity_scope_leave(&v18);
}

- (void)handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v11 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    cacheDeleteUrgency = [v10 cacheDeleteUrgency];
    volumeToReclaim = [v10 volumeToReclaim];
    if (volumeToReclaim)
    {
      volumeToReclaim2 = [v10 volumeToReclaim];
    }

    else
    {
      volumeToReclaim2 = @"N";
    }

    *buf = 138543874;
    v25 = _updateLatestSummary;
    v26 = 1024;
    v27 = cacheDeleteUrgency;
    v28 = 2114;
    v29 = volumeToReclaim2;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest} simulating trigger from cache-delete to determine reclaimable space | urgency:%d, volume:%{public}@ | respondToCacheDelete...", buf, 0x1Cu);
    if (volumeToReclaim)
    {
    }
  }

  sharedDispatchQueue = [(MADAutoAssetControlManager *)self sharedDispatchQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke;
  block[3] = &unk_4B2AF0;
  v20 = v10;
  selfCopy = self;
  v22 = requestCopy;
  v17 = requestCopy;
  v18 = v10;
  dispatch_async(sharedDispatchQueue, block);

  os_activity_scope_leave(&state);
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke(uint64_t a1)
{
  v2 = getControlManager();
  v3 = objc_alloc_init(MADAnalyticsCacheDeleteResults);
  v4 = [*(a1 + 32) cacheDeleteUrgency];
  v5 = [*(a1 + 32) volumeToReclaim];
  v8[0] = _NSConcreteStackBlock;
  v8[1] = 3221225472;
  v8[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_2;
  v8[3] = &unk_4B4720;
  v7 = *(a1 + 32);
  v6 = v7.i64[0];
  v9 = vextq_s8(v7, v7, 8uLL);
  v10 = *(a1 + 48);
  [v2 respondToCacheDelete:0 targetingPurgeAmount:0 cacheDeleteResults:v3 withUrgency:v4 forVolume:v5 then:v8];
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_2(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  v7[0] = _NSConcreteStackBlock;
  v7[1] = 3221225472;
  v7[2] = __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_3;
  v7[3] = &unk_4B46F8;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  dispatch_async(v5, v7);
}

void __97__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest___block_invoke_3(uint64_t a1)
{
  v2 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [*(a1 + 32) _updateLatestSummary];
    v4 = [*(a1 + 40) cacheDeleteUrgency];
    v5 = [*(a1 + 40) volumeToReclaim];
    if (v5)
    {
      v6 = [*(a1 + 40) volumeToReclaim];
    }

    else
    {
      v6 = @"N";
    }

    v7 = allocStringForBytes(*(a1 + 56));
    v19 = 138544130;
    v20 = v3;
    v21 = 1024;
    v22 = v4;
    v23 = 2114;
    v24 = v6;
    v25 = 2114;
    v26 = v7;
    _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest} simulating trigger from cache-delete to determine reclaimable space | urgency:%d, volume:%{public}@ | reclaimableSpace:%{public}@ | ...respondToCacheDelete", &v19, 0x26u);
    if (v5)
    {
    }
  }

  v8 = objc_alloc_init(NSMutableDictionary);
  v9 = [MANAutoAssetInfoControl alloc];
  v10 = [*(a1 + 40) volumeToReclaim];
  v11 = -[MANAutoAssetInfoControl initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:](v9, "initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:", v10, [*(a1 + 40) cacheDeleteUrgency], *(a1 + 56));

  v12 = [MASAutoAssetInfoControl newShimmedToFramework:v11];
  [v8 setSafeObject:v12 forKey:@"control"];

  v13 = [SUCoreConnectMessage alloc];
  v14 = [*(a1 + 48) clientRequestMessage];
  v15 = [MADAutoAssetControlManager replyMessageNameForRequest:v14];
  v16 = [*(a1 + 48) clientRequestMessage];
  v17 = [v16 clientID];
  v18 = [v13 initWithType:2 messageName:v15 clientID:v17 version:0 message:v8];

  [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 48) issuingResponseMessage:v18 withResponseError:0 fromLocation:@"handleControlClientSimulatedCacheDeleteDetermineReclaimableRequest"];
}

- (void)handleControlClientSimulatedCacheDeleteReclaimSpaceRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulatedCacheDeleteReclaimSpaceRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v10 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v11 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    cacheDeleteUrgency = [v10 cacheDeleteUrgency];
    volumeToReclaim = [v10 volumeToReclaim];
    if (volumeToReclaim)
    {
      volumeToReclaim2 = [v10 volumeToReclaim];
    }

    else
    {
      volumeToReclaim2 = @"N";
    }

    v16 = allocStringForBytes([v10 targetingPurgeAmount]);
    *buf = 138544130;
    v26 = _updateLatestSummary;
    v27 = 1024;
    v28 = cacheDeleteUrgency;
    v29 = 2114;
    v30 = volumeToReclaim2;
    v31 = 2114;
    v32 = v16;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteReclaimSpaceRequest} simulating trigger from cache-delete to reclaim space | urgency:%d, volume:%{public}@, targetingPurgeAmount:%{public}@ | respondToCacheDelete...", buf, 0x26u);
    if (volumeToReclaim)
    {
    }
  }

  sharedDispatchQueue = [(MADAutoAssetControlManager *)self sharedDispatchQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke;
  block[3] = &unk_4B2AF0;
  v21 = v10;
  selfCopy = self;
  v23 = requestCopy;
  v18 = requestCopy;
  v19 = v10;
  dispatch_async(sharedDispatchQueue, block);

  os_activity_scope_leave(&state);
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke(uint64_t a1)
{
  v2 = getControlManager();
  v3 = [*(a1 + 32) targetingPurgeAmount];
  v4 = objc_alloc_init(MADAnalyticsCacheDeleteResults);
  v5 = [*(a1 + 32) cacheDeleteUrgency];
  v6 = [*(a1 + 32) volumeToReclaim];
  v9[0] = _NSConcreteStackBlock;
  v9[1] = 3221225472;
  v9[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_2;
  v9[3] = &unk_4B4720;
  v8 = *(a1 + 32);
  v7 = v8.i64[0];
  v10 = vextq_s8(v8, v8, 8uLL);
  v11 = *(a1 + 48);
  [v2 respondToCacheDelete:1 targetingPurgeAmount:v3 cacheDeleteResults:v4 withUrgency:v5 forVolume:v6 then:v9];
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_2(uint64_t a1, uint64_t a2)
{
  v4 = [*(a1 + 32) autoControlManagerFSM];
  v5 = [v4 extendedStateQueue];
  v7[0] = _NSConcreteStackBlock;
  v7[1] = 3221225472;
  v7[2] = __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_3;
  v7[3] = &unk_4B46F8;
  v6 = *(a1 + 40);
  v7[4] = *(a1 + 32);
  v8 = v6;
  v10 = a2;
  v9 = *(a1 + 48);
  dispatch_async(v5, v7);
}

void __89__MADAutoAssetControlManager_handleControlClientSimulatedCacheDeleteReclaimSpaceRequest___block_invoke_3(uint64_t a1)
{
  v2 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
  {
    v3 = [*(a1 + 32) _updateLatestSummary];
    v4 = [*(a1 + 40) cacheDeleteUrgency];
    v5 = [*(a1 + 40) volumeToReclaim];
    if (v5)
    {
      v6 = [*(a1 + 40) volumeToReclaim];
    }

    else
    {
      v6 = @"N";
    }

    v7 = allocStringForBytes([*(a1 + 40) targetingPurgeAmount]);
    v8 = allocStringForBytes(*(a1 + 56));
    v20 = 138544386;
    v21 = v3;
    v22 = 1024;
    v23 = v4;
    v24 = 2114;
    v25 = v6;
    v26 = 2114;
    v27 = v7;
    v28 = 2114;
    v29 = v8;
    _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulatedCacheDeleteReclaimSpaceRequest} simulating trigger from cache-delete to reclaim space | urgency:%d, volume:%{public}@, targetingPurgeAmount:%{public}@ | reclaimedSpace:%{public}@ | ...respondToCacheDelete", &v20, 0x30u);
    if (v5)
    {
    }
  }

  v9 = objc_alloc_init(NSMutableDictionary);
  v10 = [MANAutoAssetInfoControl alloc];
  v11 = [*(a1 + 40) volumeToReclaim];
  v12 = -[MANAutoAssetInfoControl initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:](v10, "initWithVolumeToReclaim:withUrgency:targetingPurgeAmount:", v11, [*(a1 + 40) cacheDeleteUrgency], *(a1 + 56));

  v13 = [MASAutoAssetInfoControl newShimmedToFramework:v12];
  [v9 setSafeObject:v13 forKey:@"control"];

  v14 = [SUCoreConnectMessage alloc];
  v15 = [*(a1 + 48) clientRequestMessage];
  v16 = [MADAutoAssetControlManager replyMessageNameForRequest:v15];
  v17 = [*(a1 + 48) clientRequestMessage];
  v18 = [v17 clientID];
  v19 = [v14 initWithType:2 messageName:v16 clientID:v18 version:0 message:v9];

  [*(a1 + 32) issueBuiltResponseForEventInfo:*(a1 + 48) issuingResponseMessage:v19 withResponseError:0 fromLocation:@"handleControlClientSimulatedCacheDeleteReclaimSpaceRequest"];
}

- (void)handleControlClientSimulateSetJobOperation:(id)operation
{
  operationCopy = operation;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v6 = _os_activity_create(&dword_0, "MADAutoControl:handleControlClientSimulateSetJobOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v6, &state);

  v85 = [(MADAutoAssetControlManager *)selfCopy clientRequestMessageInstance:operationCopy];
  clientRequestMessage = [operationCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v8 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message forKey:@"control"];
  v9 = v8;
  if (v85)
  {
    if (v8)
    {
      v81 = v8;
      simulateOperation = [v8 simulateOperation];
      simulateOperation2 = [v81 simulateOperation];
      simulateOperation3 = [v81 simulateOperation];
      v12 = [MADMarker alloc];
      clientAssetSelector = [v85 clientAssetSelector];
      assetType = [clientAssetSelector assetType];
      clientAssetSelector2 = [v85 clientAssetSelector];
      if (simulateOperation3 == &dword_8 + 2)
      {
        assetType2 = [clientAssetSelector2 assetType];
        clientAssetSelector3 = [v85 clientAssetSelector];
        assetSpecifier = [clientAssetSelector3 assetSpecifier];
        clientAssetSelector4 = [v85 clientAssetSelector];
        summary9 = [(MADMarker *)v12 initForAssetType:assetType forClientDomainName:assetType2 forAssetSetIdentifier:assetSpecifier forAssetSelector:clientAssetSelector4 forSetJob:1 withSetPolicy:0 withPushedPolicy:0];
      }

      else
      {
        summary9 = [(MADMarker *)v12 initForAssetType:assetType forClientDomainName:0 forAssetSetIdentifier:0 forAssetSelector:clientAssetSelector2 forSetJob:0 withSetPolicy:0 withPushedPolicy:0];
      }

      if (simulateOperation == &dword_4 + 3)
      {
        [MADAutoAssetConnector simulateNetworkPathUp:summary9];
LABEL_30:
        v21 = objc_alloc_init(NSMutableDictionary);
        v63 = [SUCoreConnectMessage alloc];
        clientRequestMessage2 = [operationCopy clientRequestMessage];
        v65 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
        clientRequestMessage3 = [operationCopy clientRequestMessage];
        clientID = [clientRequestMessage3 clientID];
        v68 = [v63 initWithType:2 messageName:v65 clientID:clientID version:0 message:v21];

        [(MADAutoAssetControlManager *)selfCopy issueBuiltResponseForEventInfo:operationCopy issuingResponseMessage:v68 withResponseError:0 fromLocation:@"handleControlClientSimulateSetJobOperation"];
        v9 = v81;
        goto LABEL_31;
      }

      if (simulateOperation2 == &dword_8)
      {
        [MADAutoAssetConnector simulateNetworkPathDown:summary9];
        goto LABEL_30;
      }

      if (simulateOperation3 == &dword_8 + 2)
      {
        clientAssetSelector5 = [v85 clientAssetSelector];
        assetType3 = [clientAssetSelector5 assetType];
        clientAssetSelector6 = [v85 clientAssetSelector];
        assetSpecifier2 = [clientAssetSelector6 assetSpecifier];
        v27 = [(MADAutoAssetControlManager *)selfCopy newSetEntryIDForClientDomain:assetType3 forAssetSetIdentifier:assetSpecifier2];

        currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)selfCopy currentSetJobsByIdentifier];
        v29 = [currentSetJobsByIdentifier safeObjectForKey:v27 ofClass:objc_opt_class()];

        v30 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          summary = [summary9 summary];
          v33 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v34 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544130;
          v89 = _updateLatestSummary;
          v90 = 2114;
          v91 = summary;
          v92 = 2114;
          v93 = v33;
          v94 = 2114;
          v95 = v34;
          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | setting set-job simulate operation | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x2Au);
        }

        [(MADAutoAssetControlManager *)selfCopy setSimulateOperationRequested:1];
        simulateOperationsBySetJobKey = [(MADAutoAssetControlManager *)selfCopy simulateOperationsBySetJobKey];
        [simulateOperationsBySetJobKey setSafeObject:v81 forKey:v27];

        if (v29)
        {
          [v29 handleSimulateOperation:v81];
        }

        goto LABEL_29;
      }

      assetSelector = [summary9 assetSelector];
      v27 = [(MADAutoAssetControlManager *)selfCopy currentJobBySelector:assetSelector];

      clientAssetSelector7 = [v85 clientAssetSelector];
      assetType4 = [clientAssetSelector7 assetType];
      clientAssetSelector8 = [v85 clientAssetSelector];
      assetSpecifier3 = [clientAssetSelector8 assetSpecifier];
      v29 = [(MADAutoAssetControlManager *)selfCopy newSetEntryIDForClientDomain:assetType4 forAssetSetIdentifier:assetSpecifier3];

      currentSetJobsByIdentifier2 = [(MADAutoAssetControlManager *)selfCopy currentSetJobsByIdentifier];
      v80 = [currentSetJobsByIdentifier2 safeObjectForKey:v29 ofClass:objc_opt_class()];

      v42 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
        summary2 = [summary9 summary];
        v45 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
        v46 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
        *buf = 138544130;
        v89 = _updateLatestSummary2;
        v90 = 2114;
        v91 = summary2;
        v92 = 2114;
        v93 = v45;
        v94 = 2114;
        v95 = v46;
        _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | setting set-job simulate operation | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x2Au);
      }

      [(MADAutoAssetControlManager *)selfCopy setSimulateOperationRequested:1];
      simulateOperationsBySelector = [(MADAutoAssetControlManager *)selfCopy simulateOperationsBySelector];
      assetSelector2 = [summary9 assetSelector];
      persistedEntryID = [assetSelector2 persistedEntryID];
      [simulateOperationsBySelector setSafeObject:v81 forKey:persistedEntryID];

      simulateOperationsBySetJobKey2 = [(MADAutoAssetControlManager *)selfCopy simulateOperationsBySetJobKey];
      [simulateOperationsBySetJobKey2 setSafeObject:v81 forKey:v29];

      if (v27)
      {
        v51 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          summary3 = [v27 summary];
          summary4 = [summary9 summary];
          v55 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v56 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544386;
          v89 = _updateLatestSummary3;
          v90 = 2114;
          v91 = summary3;
          v92 = 2114;
          v93 = summary4;
          v94 = 2114;
          v95 = v55;
          v96 = 2114;
          v97 = v56;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to job | autoJobBySelector:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
        }

        v57 = v27;
      }

      else
      {
        if (!v80)
        {
          if ([v81 simulateOperation] == &dword_8 + 3)
          {
            stagerCurrentJob = [(MADAutoAssetControlManager *)selfCopy stagerCurrentJob];
            v70 = stagerCurrentJob == 0;

            if (!v70)
            {
              v71 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary4 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                stagerCurrentJob2 = [(MADAutoAssetControlManager *)selfCopy stagerCurrentJob];
                summary5 = [stagerCurrentJob2 summary];
                summary6 = [summary9 summary];
                v75 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
                v76 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
                *buf = 138544386;
                v89 = _updateLatestSummary4;
                v90 = 2114;
                v91 = summary5;
                v92 = 2114;
                v93 = summary6;
                v94 = 2114;
                v95 = v75;
                v96 = 2114;
                v97 = v76;
                _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to stager-job | stagerCurrentJob:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
              }

              stagerCurrentJob3 = [(MADAutoAssetControlManager *)selfCopy stagerCurrentJob];
              [stagerCurrentJob3 handleSimulateOperation:v81];
            }
          }

          goto LABEL_28;
        }

        v51 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary5 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          summary7 = [v80 summary];
          summary8 = [summary9 summary];
          v61 = +[MANAutoAssetInfoControl nameOfSimulateOperation:](MANAutoAssetInfoControl, "nameOfSimulateOperation:", [v81 simulateOperation]);
          v62 = +[MANAutoAssetInfoControl nameOfSimulateEnd:](MANAutoAssetInfoControl, "nameOfSimulateEnd:", [v81 simulateEnd]);
          *buf = 138544386;
          v89 = _updateLatestSummary5;
          v90 = 2114;
          v91 = summary7;
          v92 = 2114;
          v93 = summary8;
          v94 = 2114;
          v95 = v61;
          v96 = 2114;
          v97 = v62;
          _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleControlClientSimulateSetJobOperation} SIMULATE | routing to job | autoJobByIdentifier:%{public}@ | marker:%{public}@ | simulateOperation:%{public}@, simulateEnd:%{public}@", buf, 0x34u);
        }

        v57 = v80;
      }

      [v57 handleSimulateOperation:v81];
LABEL_28:

LABEL_29:
      goto LABEL_30;
    }

    v22 = [NSString alloc];
    summary9 = [operationCopy summary];
    v21 = [v22 initWithFormat:@"SIMULATE | invalid eventInfo (control:MISSING) | eventInfo:%@", summary9];
    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:operationCopy withErrorCode:6102 fromAction:@"handleControlClientSimulateSetJobOperation" withDescription:v21];
  }

  else
  {
    v20 = [NSString alloc];
    summary9 = [operationCopy summary];
    v21 = [v20 initWithFormat:@"SIMULATE | invalid eventInfo (instance:MISSING) | eventInfo:%@", summary9];
    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:operationCopy withErrorCode:6102 fromAction:@"handleControlClientSimulateSetJobOperation" withDescription:v21];
  }

LABEL_31:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientNeedForAtomicRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientNeedForAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequest = [requestCopy clientRequest];
  clientRequestMessage = [clientRequest clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v14 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:requestCopy];
  locationCopy = [NSString stringWithFormat:@"%@:handleSetClientNeedForAtomicRequest", locationCopy];
  if (v14)
  {
    atomicInstance = [v14 atomicInstance];
    v17 = atomicInstance == 0;

    if (!v17)
    {
      v18 = [[NSString alloc] initWithFormat:@"atomicInstance specified when not valid for messageName:%@", messageName];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6108 fromAction:locationCopy withDescription:v18];
LABEL_37:

      goto LABEL_38;
    }

    v55 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:v14];
    knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    v56 = [knownSetConfigurationsByIdentifier safeObjectForKey:v55 ofClass:objc_opt_class()];

    if (v56)
    {
      if ([v56 inhibitImpliedScheduling])
      {
LABEL_36:
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:0 fromAction:locationCopy withDescription:@"successful need-for-atomic (no immediate set-job required)"];

        v18 = v55;
        goto LABEL_37;
      }

      clientRequest2 = [requestCopy clientRequest];
      summary4 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest2];

      clientAssetSetPolicy = [summary4 clientAssetSetPolicy];
      blockCheckDownload = [clientAssetSetPolicy blockCheckDownload];

      if (blockCheckDownload)
      {
        autoAssetEntries = 1;
      }

      else
      {
        autoAssetEntries = [v14 autoAssetEntries];
        if (autoAssetEntries)
        {
          autoAssetEntries2 = [v14 autoAssetEntries];
          v27 = [autoAssetEntries2 count];
          v28 = autoAssetEntries2;
          v29 = autoAssetEntries;
          autoAssetEntries = v27 == 0;
        }

        else
        {
          v29 = 0;
        }
      }

      if (autoAssetEntries != [v56 inhibitImpliedScheduling])
      {
        persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v52 = [persistedKnownSetConfigurations persistedEntry:v55 fromLocation:locationCopy];

        if (v52)
        {
          [v56 setInhibitImpliedScheduling:autoAssetEntries];
          [v52 persistSecureCodedObject:v56 forKey:@"setConfiguration"];
          persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          summary = [v56 summary];
          [persistedKnownSetConfigurations2 storePersistedEntry:v55 withEntrySummary:summary fromLocation:locationCopy];

          v33 = [NSString alloc];
          summary2 = [v56 summary];
          v35 = [v33 initWithFormat:@"modified inhibitImpliedScheduling | setConfiguration:%@", summary2];
          [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:locationCopy operation:@"ENTRY_MODIFY" forPersistedEntryID:v55 withSetConfiguration:v56 historyOperation:443 message:v35];

          knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
          [knownSetConfigurationsByIdentifier2 setSafeObject:v56 forKey:v55];
        }

        else
        {
          v37 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary3 = [requestCopy summary];
            *buf = 138543874;
            v59 = _updateLatestSummary;
            v60 = 2114;
            v61 = locationCopy;
            v62 = 2114;
            v50 = summary3;
            v63 = summary3;
            _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to load persisted-set-configuration file | set-eventInfo:%{public}@", buf, 0x20u);
          }

          v40 = [NSString alloc];
          knownSetConfigurationsByIdentifier2 = [requestCopy summary];
          v41 = [v40 initWithFormat:@"unable to load persisted-set-configuration file | set-eventInfo:%@", knownSetConfigurationsByIdentifier2];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6101 fromAction:locationCopy withDescription:v41];
        }
      }

      if ([v56 everProvidedLatestToVend])
      {
LABEL_35:

        goto LABEL_36;
      }

      v42 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543362;
        v59 = locationCopy;
        _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "{%{public}@} Received need for atomic request where latest-to-vend has never been set. Attempting to set latest-to-vend via preinstalled assets.", buf, 0xCu);
      }

      clientDomainName = [v14 clientDomainName];
      autoAssetSetClientName = [v14 autoAssetSetClientName];
      assetSetIdentifier = [v14 assetSetIdentifier];
      firstEntryAssetType = [v56 firstEntryAssetType];
      v25 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:locationCopy forClientDomainName:clientDomainName forSetClientName:autoAssetSetClientName forAssetSetIdentifier:assetSetIdentifier forAssetType:firstEntryAssetType];

      if (v25)
      {
        v45 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543362;
          v59 = locationCopy;
          _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "{%{public}@} Created valid set descriptor from preinstalled set, will adopt as latest to vend.", buf, 0xCu);
        }

        latestDownloadedAtomicInstance = [v25 latestDownloadedAtomicInstance];
        v47 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

        if (v47 && ![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:locationCopy fromSetDescriptor:v25 toSetConfiguration:v56 fromPreSUStaging:0 allowEmpty:0]&& [MADAutoAssetSecure isPersonalizationRequired:locationCopy forSetDescriptor:v25])
        {
          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543362;
            v59 = locationCopy;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "{%{public}@} Personalization is required to adopt set descriptor.", buf, 0xCu);
          }

          atomicInstanceUUID = [v47 atomicInstanceUUID];
          [v56 setNewerAtomicInstanceOncePersonalized:atomicInstanceUUID];

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v56 fromLocation:locationCopy forReason:@"pre-installed is available as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
        }
      }
    }

    else
    {
      v24 = [NSString alloc];
      summary4 = [requestCopy summary];
      v25 = [v24 initWithFormat:@"invalid set-configuration (no set-configuration found) | set-eventInfo:%@", summary4];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6554 fromAction:locationCopy withDescription:v25];
    }

    goto LABEL_35;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:@"no auto-asset-set-instance provided in client request"];
LABEL_38:

  os_activity_scope_leave(&state);
}

- (BOOL)handleClientPotentialSetJob:(id)job forAutoJob:(id)autoJob fromLocation:(id)location
{
  jobCopy = job;
  autoJobCopy = autoJob;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleClientPotentialSetJob", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  clientRequest = [jobCopy clientRequest];
  clientRequestMessage = [clientRequest clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:jobCopy];
  if (v17)
  {
    clientRequest2 = [jobCopy clientRequest];
    v19 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest2];

    if (v19)
    {
      if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CHECK_ATOMIC"])
      {
        v20 = [(MADAutoAssetControlManager *)self handleSetClientCheckAtomic:jobCopy forAutoJob:autoJobCopy instance:v17 desire:v19 fromLocation:locationCopy];
LABEL_9:
        v21 = v20;
LABEL_12:

        goto LABEL_13;
      }

      if ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:LOCK_ATOMIC"])
      {
        v20 = [(MADAutoAssetControlManager *)self handleSetClientLockAtomic:jobCopy forAutoJob:autoJobCopy instance:v17 desire:v19 fromLocation:locationCopy];
        goto LABEL_9;
      }

      v22 = [[NSString alloc] initWithFormat:@"unexpected messageName:%@", messageName];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6108 fromAction:@"handleClientPotentialSetJob" withDescription:v22];
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6102 fromAction:@"handleClientPotentialSetJob" withDescription:@"no auto-asset-set-desire provided in client request"];
    }

    v21 = 0;
    goto LABEL_12;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:jobCopy withErrorCode:6102 fromAction:locationCopy withDescription:@"no auto-asset-set-instance provided in client request"];
  v21 = 0;
LABEL_13:

  os_activity_scope_leave(&state);
  return v21;
}

- (BOOL)handleSetClientCheckAtomic:(id)atomic forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location
{
  atomicCopy = atomic;
  jobCopy = job;
  instanceCopy = instance;
  desireCopy = desire;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v15 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientCheckAtomic", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v15, &state);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:handleSetClientCheckAtomic", locationCopy];
  clientRequest = [atomicCopy clientRequest];
  v17 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];
  v69 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  checkWaitTimeoutSecs = [desireCopy checkWaitTimeoutSecs];
  if (checkWaitTimeoutSecs)
  {
    goto LABEL_49;
  }

  v65 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if (!v17)
  {
    if (!v69)
    {
      [v65 appendString:@"ERROR(no set-configuration)|"];
      v21 = @"checkAtomic (NO_WAIT) unable to load set-configuration";
      goto LABEL_45;
    }

    atomicInstance = [instanceCopy atomicInstance];
    v23 = atomicInstance == 0;

    if (!v23)
    {
      atomicInstance2 = [instanceCopy atomicInstance];
      v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:atomicInstance2 requireExists:0];

      if (!v66)
      {
        [v65 appendString:@"ERROR(no downloaded atomic-instance [later])|"];
        v21 = @"checkAtomic (NO_WAIT) requested when no already downloaded asset-version available";
        goto LABEL_45;
      }

      clientDomainName2 = [v66 clientDomainName];
      clientDomainName3 = [instanceCopy clientDomainName];
      if (([SUCore stringIsEqual:clientDomainName2 to:clientDomainName3]& 1) != 0)
      {
        assetSetIdentifier2 = [v66 assetSetIdentifier];
        assetSetIdentifier3 = [instanceCopy assetSetIdentifier];
        v29 = [SUCore stringIsEqual:assetSetIdentifier2 to:assetSetIdentifier3];

        if (v29)
        {
          LOBYTE(v30) = 0;
          goto LABEL_23;
        }
      }

      else
      {
      }

      [v65 appendString:@"ERROR(specific atomic-instance not downloaded)|"];

      v21 = @"checkAtomic (NO_WAIT) requested specific atomic-instance not valid for given set-identifier";
      goto LABEL_45;
    }

    v31 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
    {
      summary = [v69 summary];
      *buf = 138543618;
      v88 = locationCopy;
      v89 = 2114;
      v90 = summary;
      _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{%{public}@} determining atomic-instance to use for checkAtomic (NO_WAIT) | setConfiguration:%{public}@", buf, 0x16u);
    }

    latestAtomicInstanceToVend = [v69 latestAtomicInstanceToVend];
    v30 = latestAtomicInstanceToVend != 0;

    if (!v30 || ([v65 appendString:@"using latestToVend|"], objc_msgSend(v69, "latestAtomicInstanceToVend"), v34 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetDescriptor:forAtomicInstanceUUID:requireExists:](self, "locateSetDescriptor:forAtomicInstanceUUID:requireExists:", locationCopy, v34, 1), v66 = objc_claimAutoreleasedReturnValue(), v34, !v66))
    {
      newerAtomicInstanceOncePersonalized = [v69 newerAtomicInstanceOncePersonalized];
      v36 = newerAtomicInstanceOncePersonalized == 0;

      if (!v36)
      {
        [v65 appendString:@"using newer-once-personalized|"];
        newerAtomicInstanceOncePersonalized2 = [v69 newerAtomicInstanceOncePersonalized];
        v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:newerAtomicInstanceOncePersonalized2 requireExists:1];

        if (v66)
        {
          goto LABEL_23;
        }
      }

      if (([v69 everProvidedLatestToVend] & 1) == 0)
      {
        clientDomainName4 = [v69 clientDomainName];
        autoAssetSetClientName = [instanceCopy autoAssetSetClientName];
        assetSetIdentifier4 = [v69 assetSetIdentifier];
        firstEntryAssetType = [v69 firstEntryAssetType];
        v66 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:locationCopy forClientDomainName:clientDomainName4 forSetClientName:autoAssetSetClientName forAssetSetIdentifier:assetSetIdentifier4 forAssetType:firstEntryAssetType];

        if (v66)
        {
          latestDownloadedAtomicInstance = [v66 latestDownloadedAtomicInstance];
          v43 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

          if (v43)
          {
            [v65 appendString:@"using pre-installed|"];

            goto LABEL_23;
          }

          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v57 = [NSString alloc];
          summary2 = [v66 summary];
          v59 = [v57 initWithFormat:@"{%@} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", locationCopy, summary2];
          [diag trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v59 withResult:6103 withError:0];
        }
      }

      [v65 appendString:@"ERROR(no downloaded atomic-instance)|"];
      v21 = @"checkAtomic (NO_WAIT) requested when no latest atomic-instance to vend and no newer-once-personalized";
      goto LABEL_45;
    }

    LOBYTE(v30) = 1;
LABEL_23:
    v85 = 0;
    v44 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:atomicCopy fromLocation:locationCopy errorString:&v85];
    v64 = v85;
    if (v64)
    {
      [v65 appendString:@"ERROR(failed to schedule)|"];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:v44 fromAction:locationCopy withDescription:v64];
    }

    else if ([(MADAutoAssetControlManager *)self _doesSetDescriptorRequirePersonalization:locationCopy forSetDescriptor:v66])
    {
      [v65 appendString:@"awaiting secure|"];
      v83 = 0u;
      v84 = 0u;
      v81 = 0u;
      v82 = 0u;
      latestDowloadedAtomicInstanceEntries = [v66 latestDowloadedAtomicInstanceEntries];
      v46 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v81 objects:v93 count:16];
      if (v46)
      {
        v47 = *v82;
        do
        {
          for (i = 0; i != v46; i = i + 1)
          {
            if (*v82 != v47)
            {
              objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
            }

            fullAssetSelector = [*(*(&v81 + 1) + 8 * i) fullAssetSelector];
            v50 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

            if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:locationCopy forDescriptor:v50]&& [MADAutoAssetSecure isPersonalizationRequired:locationCopy forDescriptor:v50])
            {
              [v50 setSecureOperationInProgress:1];
              [v66 setSecureOperationInProgress:1];
            }
          }

          v46 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v81 objects:v93 count:16];
        }

        while (v46);
      }

      v51 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v66];
      v73[0] = _NSConcreteStackBlock;
      v73[1] = 3221225472;
      v73[2] = __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke;
      v73[3] = &unk_4B4770;
      v73[4] = self;
      v74 = v66;
      v75 = locationCopy;
      v76 = instanceCopy;
      v77 = v69;
      v78 = clientRequest;
      v79 = desireCopy;
      v80 = atomicCopy;
      [MADAutoAssetSecure personalizeSetDownloaded:v75 forSetDescriptor:v74 allowingNetwork:1 withAutoAssetDescriptors:v51 completion:v73];
    }

    else
    {
      if (!v30)
      {
        [v65 appendString:@"now latest-to-vend|"];
        [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:locationCopy fromSetDescriptor:v66 toSetConfiguration:v69 fromPreSUStaging:0 allowEmpty:0];
      }

      v52 = [(MADAutoAssetControlManager *)self newSetDescriptorLimitedToCheckInformation:v66];
      v53 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"checkAtomic" forClientRequest:clientRequest withFoundSetDescriptor:v52 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:instanceCopy withDesire:desireCopy fromLocation:locationCopy];
      [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest issuingResponseMessage:v53 withResponseError:0];
    }

    v54 = v66;
    goto LABEL_46;
  }

  [v65 appendString:@"ERROR(before first-unlock)|"];
  v21 = @"checkAtomic (NO_WAIT) requested when device before first-unlock";
LABEL_45:
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:6251 fromAction:locationCopy withDescription:v21];
  v54 = 0;
LABEL_46:
  v60 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v60, OS_LOG_TYPE_DEFAULT))
  {
    summary3 = [v69 summary];
    *buf = 138543874;
    v88 = locationCopy;
    v89 = 2114;
    v90 = v65;
    v91 = 2114;
    v92 = summary3;
    _os_log_impl(&dword_0, v60, OS_LOG_TYPE_DEFAULT, "{%{public}@} CHECK-NO-WAIT-FLOW[%{public}@] set-configuration:%{public}@", buf, 0x20u);
  }

  checkWaitTimeoutSecs = 0;
LABEL_49:
  v62 = checkWaitTimeoutSecs != 0;

  os_activity_scope_leave(&state);
  return v62;
}

void __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke_2;
  block[3] = &unk_4B4748;
  v20 = v4;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v18 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v21 = v18;
  v22 = v10;
  v11 = a1[8];
  v12 = a1[9];
  v13 = a1[10];
  v14 = a1[11];
  *&v15 = v13;
  *(&v15 + 1) = v14;
  *&v16 = v11;
  *(&v16 + 1) = v12;
  v23 = v16;
  v24 = v15;
  v17 = v4;
  dispatch_async(v6, block);
}

void __97__MADAutoAssetControlManager_handleSetClientCheckAtomic_forAutoJob_instance_desire_fromLocation___block_invoke_2(uint64_t a1)
{
  v1 = a1;
  v2 = *(a1 + 32);
  [*(v1 + 40) setSecureOperationInProgress:0];
  v45 = 0u;
  v46 = 0u;
  v43 = 0u;
  v44 = 0u;
  v3 = [*(v1 + 40) latestDowloadedAtomicInstanceEntries];
  v4 = [v3 countByEnumeratingWithState:&v43 objects:v55 count:16];
  if (v4)
  {
    v5 = v4;
    v6 = *v44;
    v7 = @"AutoControl";
    v42 = v1;
    do
    {
      v8 = 0;
      v41 = v5;
      do
      {
        if (*v44 != v6)
        {
          objc_enumerationMutation(v3);
        }

        v9 = *(v1 + 48);
        v10 = [*(*(&v43 + 1) + 8 * v8) fullAssetSelector];
        v11 = [v9 locateDownloadedByFullSelector:v10];

        [v11 setSecureOperationInProgress:0];
        if ([v11 secureOperationEliminating])
        {
          v12 = _MADLog(v7);
          if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
          {
            v13 = v7;
            v14 = v6;
            v15 = v3;
            v16 = v2;
            v17 = *(v1 + 56);
            v18 = [*(v1 + 40) summary];
            v19 = [v11 summary];
            *buf = 138544130;
            v48 = @"AUTO-PERSONALIZATION";
            v49 = 2114;
            v50 = v17;
            v2 = v16;
            v3 = v15;
            v6 = v14;
            v7 = v13;
            v5 = v41;
            v51 = 2114;
            v52 = v18;
            v53 = 2114;
            v54 = v19;
            _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} auto-asset of set-descriptor eliminate while performing secure operation(s) | setDescriptor:%{public}@ | nextDownloadedDescriptor:%{public}@", buf, 0x2Au);

            v1 = v42;
          }

          [*(v1 + 48) eliminateUngraftDescriptor:*(v1 + 56) forAutoAssetDescriptor:v11 failingClientRequestForEventInfo:0];
          if (!v2)
          {
            v20 = *(v1 + 56);
            v21 = [NSString alloc];
            v22 = [v11 summary];
            v23 = [v21 initWithFormat:@"encountered set-descriptor with auto-asset being eliminated | nextDownloadedDescriptor:%@", v22];
            v2 = [MAAutoAssetError buildError:6114 fromOperation:v20 underlyingError:0 withDescription:v23];

            v1 = v42;
          }
        }

        v8 = v8 + 1;
      }

      while (v5 != v8);
      v5 = [v3 countByEnumeratingWithState:&v43 objects:v55 count:16];
    }

    while (v5);
  }

  v24 = *(v1 + 48);
  v25 = *(v1 + 56);
  v26 = [*(v1 + 64) clientDomainName];
  v27 = [*(v1 + 64) assetSetIdentifier];
  LODWORD(v24) = [v24 isSetIdentifierBeingEliminated:v25 forClientDomainName:v26 ofSetIdentifier:v27];

  if (v24)
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
    {
      v29 = v2;
      v30 = *(v1 + 56);
      v31 = [*(v1 + 40) summary];
      *buf = 138543874;
      v48 = @"AUTO-PERSONALIZATION";
      v49 = 2114;
      v50 = v30;
      v2 = v29;
      v51 = 2114;
      v52 = v31;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} set-identifier eliminate while performing secure operation(s) | nextDownloadedDescriptor:%{public}@", buf, 0x20u);
    }

    [*(v1 + 48) eliminateUngraftSetDescriptor:*(v1 + 40) failingClientRequestForEventInfo:0];
    if (v2)
    {
      goto LABEL_19;
    }

    v32 = *(v1 + 56);
    v33 = [NSString alloc];
    v34 = [*(v1 + 40) summary];
    v35 = [v33 initWithFormat:@"encountered set-descriptor being eliminated | setDescriptor:%@", v34];
    v2 = [MAAutoAssetError buildError:6114 fromOperation:v32 underlyingError:0 withDescription:v35];
  }

  if (!v2)
  {
    [*(v1 + 48) setConfigurationAdoptLatestToVend:*(v1 + 56) fromSetDescriptor:*(v1 + 40) toSetConfiguration:*(v1 + 72) fromPreSUStaging:0 allowEmpty:0];
    v40 = [*(v1 + 48) newSetDescriptorLimitedToCheckInformation:*(v1 + 40)];
    v2 = [*(v1 + 48) buildSetFoundResponseMessage:@"checkAtomic" forClientRequest:*(v1 + 80) withFoundSetDescriptor:v40 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(v1 + 64) withDesire:*(v1 + 88) fromLocation:*(v1 + 56)];
    [*(v1 + 48) issueResponseToClientRequest:*(v1 + 80) issuingResponseMessage:v2 withResponseError:0];
    goto LABEL_21;
  }

LABEL_19:
  v36 = *(v1 + 48);
  v37 = *(v1 + 96);
  v38 = [v2 checkedCode];
  v39 = *(v1 + 56);
  v40 = [v2 checkedDescription];
  [v36 issueResponseForEventInfo:v37 withErrorCode:v38 fromAction:v39 withDescription:v40];
LABEL_21:
}

- (BOOL)doesSetDescriptor:(id)descriptor alignWithSetConfiguration:(id)configuration
{
  descriptorCopy = descriptor;
  autoAssetEntries = [configuration autoAssetEntries];
  [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  obj = v41 = 0u;
  v26 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
  if (!v26)
  {
    v22 = 1;
    goto LABEL_23;
  }

  v27 = *v39;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v24 = descriptorCopy;
  while (2)
  {
    v7 = 0;
    while (2)
    {
      if (*v39 != v27)
      {
        objc_enumerationMutation(obj);
      }

      v29 = v7;
      v8 = *(*(&v38 + 1) + 8 * v7);
      v34 = 0u;
      v35 = 0u;
      v36 = 0u;
      v37 = 0u;
      v31 = autoAssetEntries;
      v33 = [v31 countByEnumeratingWithState:&v34 objects:v42 count:16];
      if (!v33)
      {
LABEL_21:

        v22 = 0;
        descriptorCopy = v24;
        goto LABEL_23;
      }

      v9 = *v35;
      v30 = v8;
LABEL_8:
      v10 = 0;
      while (1)
      {
        if (*v35 != v9)
        {
          objc_enumerationMutation(v31);
        }

        v11 = *(*(&v34 + 1) + 8 * v10);
        v12 = p_weak_ivar_lyt[223];
        assetSelector = [v11 assetSelector];
        assetType = [assetSelector assetType];
        fullAssetSelector = [v8 fullAssetSelector];
        assetType2 = [fullAssetSelector assetType];
        if (![v12 stringIsEqual:assetType to:assetType2])
        {

          goto LABEL_15;
        }

        v32 = p_weak_ivar_lyt[223];
        assetSelector2 = [v11 assetSelector];
        assetSpecifier = [assetSelector2 assetSpecifier];
        fullAssetSelector2 = [v8 fullAssetSelector];
        [fullAssetSelector2 assetSpecifier];
        v21 = v20 = v9;
        LOBYTE(v32) = [v32 stringIsEqual:assetSpecifier to:v21];

        v9 = v20;
        v8 = v30;

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v32)
        {
          break;
        }

LABEL_15:
        if (v33 == ++v10)
        {
          v33 = [v31 countByEnumeratingWithState:&v34 objects:v42 count:16];
          if (v33)
          {
            goto LABEL_8;
          }

          goto LABEL_21;
        }
      }

      v7 = v29 + 1;
      if ((v29 + 1) != v26)
      {
        continue;
      }

      break;
    }

    v22 = 1;
    descriptorCopy = v24;
    v26 = [obj countByEnumeratingWithState:&v38 objects:v43 count:16];
    if (v26)
    {
      continue;
    }

    break;
  }

LABEL_23:

  return v22;
}

- (BOOL)doesSetDescriptor:(id)descriptor matchSetConfiguration:(id)configuration
{
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  autoAssetEntries = [configurationCopy autoAssetEntries];
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v10 = [autoAssetEntries count];
  if (v10 == [latestDowloadedAtomicInstanceEntries count])
  {
    v11 = [(MADAutoAssetControlManager *)self doesSetDescriptor:descriptorCopy alignWithSetConfiguration:configurationCopy];
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (BOOL)handleSetClientLockAtomic:(id)atomic forAutoJob:(id)job instance:(id)instance desire:(id)desire fromLocation:(id)location
{
  atomicCopy = atomic;
  jobCopy = job;
  instanceCopy = instance;
  desireCopy = desire;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v14 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientLockAtomic", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v14, &state);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:handleSetClientLockAtomic", locationCopy];
  clientRequest = [atomicCopy clientRequest];
  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];
  v122 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  v17 = +[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock];
  v123 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  if ([desireCopy lockWaitTimeoutSecs])
  {
    if ([desireCopy lockWaitTimeoutSecs] != -3)
    {
      clientAssetSetPolicy = [desireCopy clientAssetSetPolicy];
      supportingShortTermLocks = [clientAssetSetPolicy supportingShortTermLocks];

      v21 = 0;
      v25 = 0;
      v29 = @"lockAtomic";
      if (supportingShortTermLocks)
      {
        v29 = @"lockAtomic[SUPPORTING-SHORT-TERM]";
      }

      v117 = v29;
      if (v17)
      {
        goto LABEL_10;
      }

LABEL_14:
      if (!v122)
      {
        [v123 appendString:@"ERROR(no set-configuration)|"];
        v117 = [[NSString alloc] initWithFormat:@"%@ requested when unable to load set-configuration", v117];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:6111 fromAction:locationCopy withDescription:v117];
        goto LABEL_38;
      }

      atomicInstance = [instanceCopy atomicInstance];
      v31 = atomicInstance == 0;

      if (v31)
      {
        v38 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
        {
          summary = [v122 summary];
          *buf = 138543618;
          v140 = locationCopy;
          v141 = 2114;
          v142 = summary;
          _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "{%{public}@} determining atomic-instance to use | setConfiguration:%{public}@", buf, 0x16u);
        }

        latestAtomicInstanceToVend = [v122 latestAtomicInstanceToVend];
        v127 = latestAtomicInstanceToVend != 0;

        if (v127)
        {
          [v123 appendString:@"using latestToVend|"];
          latestAtomicInstanceToVend2 = [v122 latestAtomicInstanceToVend];
          v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

          if (v120)
          {
            LOBYTE(v127) = 1;
            goto LABEL_40;
          }
        }

        newerAtomicInstanceOncePersonalized = [v122 newerAtomicInstanceOncePersonalized];
        v43 = newerAtomicInstanceOncePersonalized == 0;

        if (!v43)
        {
          [v123 appendString:@"using newer-once-personalized|"];
          newerAtomicInstanceOncePersonalized2 = [v122 newerAtomicInstanceOncePersonalized];
          v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:newerAtomicInstanceOncePersonalized2 requireExists:1];

          if (v120)
          {
LABEL_40:
            v136 = 0;
            v137 = 0;
            v54 = [(MADAutoAssetControlManager *)self verifySetDescriptorIsLockable:v120 fromLocation:locationCopy notLocakableError:&v137 corruptedAtomicEntries:&v136];
            v128 = v137;
            v117 = v136;
            if ((v54 & 1) == 0)
            {
              [v123 appendString:@"ERROR(not lockable)|"];
              if ([v128 code] == "reUpdateCoreSupport")
              {
                [v123 appendString:@"corrupted assets found | "];
                v134 = 0u;
                v135 = 0u;
                v132 = 0u;
                v133 = 0u;
                v116 = v117;
                v62 = v117;
                v63 = [v62 countByEnumeratingWithState:&v132 objects:v145 count:16];
                if (v63)
                {
                  v64 = *v133;
                  do
                  {
                    for (i = 0; i != v63; i = i + 1)
                    {
                      if (*v133 != v64)
                      {
                        objc_enumerationMutation(v62);
                      }

                      v66 = *(*(&v132 + 1) + 8 * i);
                      v67 = [(MADAutoAssetControlManager *)self getCorruptedEntryInfo:v66];
                      v68 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v68, OS_LOG_TYPE_DEFAULT))
                      {
                        *buf = 138543618;
                        v140 = locationCopy;
                        v141 = 2114;
                        v142 = v67;
                        _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, "{%{public}@} Removing corrupted asset %{public}@", buf, 0x16u);
                      }

                      fullAssetSelector = [v66 fullAssetSelector];
                      [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:locationCopy dueToError:v128 fullAssetSelector:fullAssetSelector historyOperationAI:1502 historyOperationSD:393];

                      fullAssetSelector2 = [v66 fullAssetSelector];
                      v71 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector2];
                      [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:locationCopy droppingDescriptor:v71 forHistoryOperation:409 firstClientName:0];
                    }

                    v63 = [v62 countByEnumeratingWithState:&v132 objects:v145 count:16];
                  }

                  while (v63);
                }

                v117 = v116;
              }

              v1172 = [[NSString alloc] initWithFormat:@"%@ requested when chosen downloaded descriptor not lockable", v117];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withAutoAssetError:v128 fromAction:locationCopy withDescription:v1172];
              goto LABEL_60;
            }

            latestDowloadedAtomicInstanceEntries = [v120 latestDowloadedAtomicInstanceEntries];
            v56 = [latestDowloadedAtomicInstanceEntries count] == 0;

            if (v56)
            {
              v57 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
              {
                summary2 = [v122 summary];
                *buf = 138543618;
                v140 = locationCopy;
                v141 = 2114;
                v142 = summary2;
                _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "{%{public}@} processing zero-entries set | setConfiguration:%{public}@", buf, 0x16u);
              }
            }

            v131 = 0;
            v59 = [(MADAutoAssetControlManager *)self _scheduleAndCreateSetConfiguration:atomicCopy fromLocation:locationCopy errorString:&v131];
            v60 = v131;
            v1172 = v60;
            if (v59)
            {
              [v123 appendString:@"ERROR(failed to schedule)|"];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:v59 fromAction:locationCopy withDescription:v1172];
LABEL_60:
              v53 = 0;
LABEL_94:

              goto LABEL_95;
            }

            v115 = v60;
            atomicInstance2 = [instanceCopy atomicInstance];
            clientDomainName2 = [instanceCopy clientDomainName];
            assetSetIdentifier2 = [instanceCopy assetSetIdentifier];
            v114 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:atomicInstance2 elseByClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 fromLocation:locationCopy];

            if (v21)
            {
              v1174 = 0;
LABEL_76:
              v1173 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:v117 forClientRequest:clientRequest withFoundSetDescriptor:v120 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:instanceCopy withDesire:desireCopy fromLocation:locationCopy];
              atomicInstance3 = [instanceCopy atomicInstance];
              if (atomicInstance3)
              {
                v100 = 1;
              }

              else
              {
                v100 = v127;
              }

              if ((v100 & 1) == 0)
              {
                [v123 appendString:@"now latest-to-vend|"];
                [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:locationCopy fromSetDescriptor:v120 toSetConfiguration:v122 fromPreSUStaging:0 allowEmpty:0];
              }

              [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest issuingResponseMessage:v1173 withResponseError:0];
              if (v21)
              {
                v101 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v101, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  summary3 = [v120 summary];
                  *buf = 138543874;
                  v140 = _updateLatestSummary;
                  v141 = 2114;
                  v142 = locationCopy;
                  v143 = 2114;
                  v144 = summary3;
                  _os_log_impl(&dword_0, v101, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} NO_WAIT_NOT_PERSISTED | successful lock | chosenDownloadedSetDescriptor:%{public}@", buf, 0x20u);
                }
              }

              goto LABEL_91;
            }

            v82 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v120];
            v83 = [MADAutoAssetSecure doesSetDescriptorInvolveSecureOperations:@"handleSetClientLockAtomic" forSetDescriptor:v120 withAutoAssetDescriptors:v82];

            if (v83 && (v84 = [MADAutoAssetSecure isPersonalizationOrGraftingRequired:@"handleSetClientLockAtomic" forSetDescriptor:v120], v84 & 1 | ![(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:locationCopy forSetDescriptor:v120]))
            {
              v1173 = [[NSMutableString alloc] initWithString:@"secure operations pending"];
              [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDMostRecentlyReceived:locationCopy fromSetDescriptor:v120 forSetConfiguration:v122 buildingPersistReason:v1173];
              [(MADAutoAssetControlManager *)self setConfigurationPersist:v122 fromLocation:locationCopy forReason:v1173 dueToAlter:0 forHistoryOperation:459];
              [v123 appendString:@"awaiting secure|"];
              [(MADAutoAssetControlManager *)self securePersonalizeGraftLockSet:locationCopy lockingSetDescriptor:v120 forEventInfo:atomicCopy fallingBackToSetDescriptor:0 fromPreSUStaging:0];
              v1174 = 0;
            }

            else
            {
              [v123 appendString:@"no grafting required|"];
              autoAssetSetClientName = [instanceCopy autoAssetSetClientName];
              clientProcessName = [instanceCopy clientProcessName];
              clientProcessID = [instanceCopy clientProcessID];
              desireReason = [desireCopy desireReason];
              currentNeedPolicy = [v114 currentNeedPolicy];
              v130 = 0;
              v91 = [MADAutoAssetLocker lockedSetByClient:autoAssetSetClientName forClientProcessName:clientProcessName withClientProcessID:clientProcessID lockingSetDescriptor:v120 forLockReason:desireReason withSetUsagePolicy:currentNeedPolicy lockError:&v130];
              v1174 = v130;

              if (v91)
              {
                [v123 appendString:@"asset locked|"];
                desireReason2 = [desireCopy desireReason];
                [(MADAutoAssetControlManager *)self setLockUsageMapLockedSetDescriptor:v120 forLockReason:desireReason2];

                if ([v120 neverBeenLocked])
                {
                  [v120 setNeverBeenLocked:0];
                  atomicInstance4 = [instanceCopy atomicInstance];
                  autoAssetSetClientName2 = [instanceCopy autoAssetSetClientName];
                  LOBYTE(v113) = 0;
                  BYTE2(v112) = 0;
                  LOWORD(v112) = 1;
                  [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v120 forLatestDownloaded:locationCopy forSpecificAtomicInstance:1 withCurrentSetStatus:atomicInstance4 changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v112 latestToVend:0 historyOperation:autoAssetSetClientName2 firstClientName:v113 fromPreSUStaging:?];
                }

                clientRequestMessage = [atomicCopy clientRequestMessage];
                v96 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:clientRequestMessage];

                if ([v96 supportingShortTermLocks])
                {
                  [v123 appendString:@"supporting SHORT-TERM|"];
                  atomicInstance5 = [instanceCopy atomicInstance];
                  v98 = [(MADAutoAssetControlManager *)self shortTermLockSetDescriptor:@"handleSetClientLockAtomic" forSetDescriptor:v120 forSpecificAtomicInstance:atomicInstance5];
                }

                goto LABEL_76;
              }

              if (!v25)
              {
                [v123 appendString:@"may be stale - routing to set-job|"];
                v53 = 1;
                goto LABEL_92;
              }

              [v123 appendString:@"ERROR(unable to lock)|"];
              v1173 = [[NSString alloc] initWithFormat:@"unable to lock auto-asset-set (failed to persist [additional] set-lock) for %@", v117];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withAutoAssetError:v1174 fromAction:locationCopy withDescription:v1173];
            }

LABEL_91:

            v53 = 0;
LABEL_92:

            goto LABEL_93;
          }
        }

        if (([v122 everProvidedLatestToVend] & 1) == 0)
        {
          clientDomainName3 = [v122 clientDomainName];
          autoAssetSetClientName3 = [instanceCopy autoAssetSetClientName];
          assetSetIdentifier3 = [v122 assetSetIdentifier];
          firstEntryAssetType = [v122 firstEntryAssetType];
          v79 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:locationCopy forClientDomainName:clientDomainName3 forSetClientName:autoAssetSetClientName3 forAssetSetIdentifier:assetSetIdentifier3 forAssetType:firstEntryAssetType];

          if (v79)
          {
            latestDownloadedAtomicInstance = [v79 latestDownloadedAtomicInstance];
            v81 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

            if (v81)
            {
              [v123 appendString:@"using pre-installed|"];
              v45 = v79;
            }

            else
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v106 = [NSString alloc];
              summary4 = [v79 summary];
              v107 = [v106 initWithFormat:@"{%@} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", locationCopy, summary4];
              [diag trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v107 withResult:6103 withError:0];

              v45 = 0;
            }
          }

          else
          {
            v45 = 0;
          }

          goto LABEL_31;
        }
      }

      else
      {
        atomicInstance6 = [instanceCopy atomicInstance];
        v120 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:atomicInstance6 requireExists:0];

        if (v120)
        {
          clientDomainName4 = [v120 clientDomainName];
          clientDomainName5 = [instanceCopy clientDomainName];
          if (([SUCore stringIsEqual:clientDomainName4 to:clientDomainName5]& 1) != 0)
          {
            assetSetIdentifier4 = [v120 assetSetIdentifier];
            assetSetIdentifier5 = [instanceCopy assetSetIdentifier];
            v37 = [SUCore stringIsEqual:assetSetIdentifier4 to:assetSetIdentifier5];

            if (v37)
            {
              LOBYTE(v127) = 0;
              goto LABEL_40;
            }
          }

          else
          {
          }

          [v123 appendString:@"ERROR(specific atomic-instance not downloaded)|"];

          v117 = [[NSString alloc] initWithFormat:@"%@ requested when specific atomic-instance not already downloaded", v117];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:6103 fromAction:locationCopy withDescription:v117];
          goto LABEL_38;
        }

        LOBYTE(v127) = 0;
      }

      v45 = 0;
LABEL_31:
      v46 = v25 ^ 1;
      if (v45)
      {
        v46 = 1;
      }

      if ((v46 & 1) == 0)
      {
        atomicInstance7 = [instanceCopy atomicInstance];
        clientDomainName6 = [instanceCopy clientDomainName];
        assetSetIdentifier6 = [instanceCopy assetSetIdentifier];
        v117 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:atomicInstance7 elseByClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6 fromLocation:locationCopy];

        availableForUseError = [v117 availableForUseError];
        LODWORD(clientDomainName6) = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:availableForUseError];

        if (!clientDomainName6)
        {
          [v123 appendString:@"ERROR(no downloaded atomic-instance)|"];
          v1172 = [[NSString alloc] initWithFormat:@"%@ requested when unable to locate already downloaded content", v117];
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:6503 fromAction:locationCopy withDescription:v1172];
          v120 = 0;
          v128 = 0;
          goto LABEL_60;
        }

        [v123 appendString:@"ERROR(unable to graft - device locked)|"];
        availableForUseError2 = [v117 availableForUseError];
        v1174 = [[NSString alloc] initWithFormat:@"%@ requested when unable to graft - device locked", v117];
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withAutoAssetError:availableForUseError2 fromAction:locationCopy withDescription:v1174];
        v115 = availableForUseError2;
        v120 = 0;
        v128 = 0;
        v53 = 0;
LABEL_93:

        v1172 = v115;
        goto LABEL_94;
      }

      v120 = v45;
      if (!v45)
      {
        [v123 appendString:@"routing to set-job|"];
        v120 = 0;
        v128 = 0;
        v53 = 1;
        goto LABEL_96;
      }

      goto LABEL_40;
    }

    clientAssetSetPolicy2 = [desireCopy clientAssetSetPolicy];
    supportingShortTermLocks2 = [clientAssetSetPolicy2 supportingShortTermLocks];

    v20 = @"lockAtomic[NO_WAIT_NOT_PERSISTED][SUPPORTING-SHORT-TERM]";
    if (supportingShortTermLocks2)
    {
      v20 = @"lockAtomic[NO_WAIT][SUPPORTING-SHORT-TERM]";
    }

    v117 = v20;
    v21 = 1;
  }

  else
  {
    clientAssetSetPolicy3 = [desireCopy clientAssetSetPolicy];
    supportingShortTermLocks3 = [clientAssetSetPolicy3 supportingShortTermLocks];

    v21 = 0;
    v24 = @"lockAtomic[NO_WAIT]";
    if (supportingShortTermLocks3)
    {
      v24 = @"lockAtomic[NO_WAIT][SUPPORTING-SHORT-TERM]";
    }

    v117 = v24;
  }

  v25 = 1;
  if (!v17)
  {
    goto LABEL_14;
  }

LABEL_10:
  [v123 appendString:@"ERROR(before first-unlock)|"];
  v117 = [[NSString alloc] initWithFormat:@"%@ requested when device is before first-unlock", v117];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:atomicCopy withErrorCode:6101 fromAction:locationCopy withDescription:v117];
LABEL_38:
  v120 = 0;
  v128 = 0;
  v53 = 0;
LABEL_95:

LABEL_96:
  v109 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v109, OS_LOG_TYPE_DEFAULT))
  {
    summary5 = [v122 summary];
    *buf = 138543874;
    v140 = locationCopy;
    v141 = 2114;
    v142 = v123;
    v143 = 2114;
    v144 = summary5;
    _os_log_impl(&dword_0, v109, OS_LOG_TYPE_DEFAULT, "{%{public}@} LOCK-FLOW[%{public}@] set-configuration:%{public}@", buf, 0x20u);
  }

  os_activity_scope_leave(&state);
  return v53;
}

- (void)handleSetClientMapLockedAtomicEntryRequest:(id)request forAutoJob:(id)job fromLocation:(id)location
{
  requestCopy = request;
  jobCopy = job;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v13 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientMapLockedAtomicEntryRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v13, &state);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:handleSetClientMapLockedAtomicEntryRequest", locationCopy];
  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientMapLockedAtomicEntryRequest" withEventInfo:requestCopy];
  v16 = v15;
  if (v15)
  {
    atomicInstance = [v15 atomicInstance];

    if (atomicInstance)
    {
      atomicInstance2 = [v16 atomicInstance];
      latestAtomicInstanceToVend = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:atomicInstance2 requireExists:0];
    }

    else
    {
      clientDomainName = [v16 clientDomainName];
      assetSetIdentifier = [v16 assetSetIdentifier];
      atomicInstance2 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

      if (atomicInstance2)
      {
        latestAtomicInstanceToVend = [atomicInstance2 latestAtomicInstanceToVend];

        if (latestAtomicInstanceToVend)
        {
          latestAtomicInstanceToVend2 = [atomicInstance2 latestAtomicInstanceToVend];
          latestAtomicInstanceToVend = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];
        }
      }

      else
      {
        latestAtomicInstanceToVend = 0;
      }
    }

    if (latestAtomicInstanceToVend)
    {
      if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientMapLockedAtomicEntryRequest" forSetDescriptor:latestAtomicInstanceToVend])
      {
        autoAssetEntries = [v16 autoAssetEntries];

        if (autoAssetEntries)
        {
          autoAssetEntries2 = [v16 autoAssetEntries];
          v22 = [autoAssetEntries2 count];

          if (v22 == &dword_0 + 1)
          {
            autoAssetEntries3 = [v16 autoAssetEntries];
            v24 = [autoAssetEntries3 objectAtIndex:0];

            assetSelector = [v24 assetSelector];
            assetType = [assetSelector assetType];
            assetSpecifier = [assetSelector assetSpecifier];
            v43 = [latestAtomicInstanceToVend downloadedEntryForAssetType:assetType forAssetSpecifier:assetSpecifier];

            assetVersion = [assetSelector assetVersion];

            if (assetVersion)
            {
              assetVersion2 = [assetSelector assetVersion];
              fullAssetSelector = [v43 fullAssetSelector];
              assetVersion3 = [fullAssetSelector assetVersion];
              v41 = [SUCore stringIsEqual:assetVersion2 to:assetVersion3];

              if (v41)
              {
                fullAssetSelector2 = assetSelector;
LABEL_25:
                v37 = v43;
                if (!fullAssetSelector2)
                {
LABEL_34:

                  goto LABEL_12;
                }

                v38 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector2];
                v39 = v38;
                if (v38)
                {
                  [v38 setSecureOperationInProgress:1];
                  v45[0] = _NSConcreteStackBlock;
                  v45[1] = 3221225472;
                  v45[2] = __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke;
                  v45[3] = &unk_4B47C0;
                  v45[4] = self;
                  v46 = v39;
                  v47 = fullAssetSelector2;
                  v48 = locationCopy;
                  v49 = requestCopy;
                  v50 = latestAtomicInstanceToVend;
                  v51 = v16;
                  [MADAutoAssetSecure mapToExclave:v48 forDescriptor:v46 completion:v45];
                }

                else
                {
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6111 fromAction:locationCopy withDescription:@"atomic-instance lock to be mapped to exclave environment with auto-asset asset-selector that is not currently downloaded"];
                }

                assetSelector = fullAssetSelector2;

LABEL_33:
                v37 = v43;
                goto LABEL_34;
              }

              v40 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries value for different asset-version than entry associated with atomic-instance";
            }

            else
            {
              if (v43)
              {
                fullAssetSelector2 = [v43 fullAssetSelector];

                goto LABEL_25;
              }

              v40 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries value (without asset-version) that is not found in the associated atomic-instance";
            }

            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6108 fromAction:locationCopy withDescription:v40];
            goto LABEL_33;
          }

          v35 = @"atomic-instance lock to be mapped to exclave environment with autoAssetEntries count other than 1 (limited to mapping a single asset-selector per set-identifier)";
          v36 = 6108;
        }

        else
        {
          v35 = @"atomic-instance lock to be mapped to exclave environment MISSING autoAssetEntries";
          v36 = 6102;
        }
      }

      else
      {
        v35 = @"atomic-instance lock to be mapped to exclave environment is not currently locked";
        v36 = 6501;
      }
    }

    else
    {
      v35 = @"atomic-instance lock to be mapped to exclave environment is not downloaded";
      v36 = 6551;
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:v36 fromAction:locationCopy withDescription:v35];
    goto LABEL_22;
  }

  v31 = [NSString alloc];
  latestAtomicInstanceToVend = [requestCopy summary];
  v24 = [v31 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", latestAtomicInstanceToVend];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:locationCopy withDescription:v24];
LABEL_12:

LABEL_22:
  os_activity_scope_leave(&state);
}

void __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke(id *a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [a1[4] autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke_2;
  block[3] = &unk_4B4798;
  *&v7 = a1[5];
  *(&v7 + 1) = a1[4];
  v12 = v7;
  v8 = a1[6];
  v9 = a1[7];
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v14 = v12;
  v15 = v10;
  v16 = a1[8];
  v17 = v4;
  v18 = a1[9];
  v19 = a1[10];
  v11 = v4;
  dispatch_async(v6, block);
}

void __97__MADAutoAssetControlManager_handleSetClientMapLockedAtomicEntryRequest_forAutoJob_fromLocation___block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) setSecureOperationInProgress:0];
  if ([*(a1 + 40) isAutoAssetBeingEliminated:*(a1 + 48)])
  {
    v2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v2, OS_LOG_TYPE_DEFAULT))
    {
      v3 = *(a1 + 56);
      v4 = [*(a1 + 32) summary];
      *buf = 138543618;
      v13 = v3;
      v14 = 2114;
      v15 = v4;
      _os_log_impl(&dword_0, v2, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-MAP][ELIMINATE] {%{public}@} | eliminate triggered while mapping-to-exclave | mapDescriptor:%{public}@", buf, 0x16u);
    }

    [*(a1 + 40) eliminateUngraftDescriptor:*(a1 + 56) forAutoAssetDescriptor:*(a1 + 32) failingClientRequestForEventInfo:*(a1 + 64)];
  }

  else
  {
    v5 = *(a1 + 40);
    v6 = *(a1 + 64);
    if (*(a1 + 72))
    {
      v7 = *(a1 + 40);

      [v7 issueResponseForEventInfo:v6 withAutoAssetError:? fromAction:? withDescription:?];
    }

    else
    {
      v8 = [*(a1 + 64) clientRequest];
      v11 = [v5 buildSetFoundResponseMessage:@"mapToExclave" forClientRequest:v8 withFoundSetDescriptor:*(a1 + 80) withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(a1 + 88) withDesire:0 fromLocation:*(a1 + 56)];

      v9 = *(a1 + 40);
      v10 = [*(a1 + 64) clientRequest];
      [v9 issueResponseToClientRequest:v10 issuingResponseMessage:v11 withResponseError:0];
    }
  }
}

- (void)handleSetClientCurrentStatusRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientCurrentStatusRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v109 = [(MADAutoAssetControlManager *)selfCopy clientRequestMessageSetInstance:@"handleSetClientCurrentStatusRequest" withEventInfo:requestCopy];
  atomicInstance = [v109 atomicInstance];
  clientDomainName = [v109 clientDomainName];
  assetSetIdentifier = [v109 assetSetIdentifier];
  v12 = [(MADAutoAssetControlManager *)selfCopy locateSetStatusPreferringByInstance:atomicInstance elseByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier fromLocation:@"lockSetAlreadyCompletedToClient"];

  clientDomainName2 = [v109 clientDomainName];
  assetSetIdentifier2 = [v109 assetSetIdentifier];
  v102 = [(MADAutoAssetControlManager *)selfCopy setConfigurationForClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

  if (v12)
  {
    latestAtomicInstanceToVend = [v102 latestAtomicInstanceToVend];
    v16 = latestAtomicInstanceToVend == 0;

    if (v16)
    {
      obj = 0;
    }

    else
    {
      obj = [v102 latestAtomicInstanceToVend];
      latestAtomicInstanceToVend2 = [v102 latestAtomicInstanceToVend];
      latestDownloadedAtomicInstance2 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"handleSetClientCurrentStatusRequest" forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

      if (latestDownloadedAtomicInstance2)
      {
        latestDowloadedAtomicInstanceEntries = [(MANAutoAssetSetNotifications *)latestDownloadedAtomicInstance2 latestDowloadedAtomicInstanceEntries];
        v103 = [(MADAutoAssetControlManager *)selfCopy _limitToCheckAtomicEntries:latestDowloadedAtomicInstanceEntries];

LABEL_11:
        clientDomainName3 = [v12 clientDomainName];
        assetSetIdentifier3 = [v12 assetSetIdentifier];
        atomicInstancesDownloaded = [v12 atomicInstancesDownloaded];
        newerAtomicInstanceDiscovered = [v12 newerAtomicInstanceDiscovered];
        newerDiscoveredAtomicEntries = [v12 newerDiscoveredAtomicEntries];
        latestAtomicInstanceToVendFromPreSUStaging = [v102 latestAtomicInstanceToVendFromPreSUStaging];
        currentNotifications = [v12 currentNotifications];
        currentNeedPolicy = [v12 currentNeedPolicy];
        clientDomainName4 = [v109 clientDomainName];
        assetSetIdentifier4 = [v109 assetSetIdentifier];
        v93 = [MADAutoAssetScheduler newSetPolicyForDomainName:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4];
        availableForUseError3 = +[MADAutoAssetControlManager stagerSetPolicy];
        downloadUserInitiated = [v12 downloadUserInitiated];
        downloadProgress = [v12 downloadProgress];
        downloadedNetworkBytes = [v12 downloadedNetworkBytes];
        downloadedFilesystemBytes = [v12 downloadedFilesystemBytes];
        selectorsForStaging = [v12 selectorsForStaging];
        availableForUseError = [v102 availableForUseError];
        newerVersionError = [v102 newerVersionError];
        LOBYTE(v89) = 1;
        LOBYTE(v88) = downloadUserInitiated;
        LOBYTE(v87) = latestAtomicInstanceToVendFromPreSUStaging;
        v36 = [(MADAutoAssetControlManager *)selfCopy newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"extended set-job to include lock-usage" forClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3 withAtomicInstancesDownloaded:atomicInstancesDownloaded withNewerAtomicInstanceDiscovered:newerAtomicInstanceDiscovered withNewerDiscoveredAtomicEntries:newerDiscoveredAtomicEntries withLatestDownloadedAtomicInstance:obj withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:v103 withCurrentNotifications:currentNotifications withCurrentNeedPolicy:currentNeedPolicy withSchedulerPolicy:v93 withStagerPolicy:availableForUseError3 withDownloadUserInitiated:v88 withDownloadProgress:downloadProgress withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes extendingWithCurrentLockUsage:v89 withSelectorsForStaging:selectorsForStaging withAvailableForUseError:availableForUseError withNewerVersionError:newerVersionError];

        clientDomainName6 = clientDomainName3;
        goto LABEL_12;
      }
    }

    v103 = 0;
    latestDownloadedAtomicInstance2 = 0;
    goto LABEL_11;
  }

  atomicInstance2 = [v109 atomicInstance];
  v20 = atomicInstance2 == 0;

  if (v20)
  {
    +[MADAutoAssetScheduler jobsAwaitingTrigger];
    v116 = 0u;
    v117 = 0u;
    v114 = 0u;
    obj = v115 = 0u;
    v57 = [obj countByEnumeratingWithState:&v114 objects:v128 count:16];
    if (!v57)
    {
      goto LABEL_36;
    }

    v107 = *v115;
    while (1)
    {
      for (i = 0; i != v57; i = i + 1)
      {
        if (*v115 != v107)
        {
          objc_enumerationMutation(obj);
        }

        v59 = *(*(&v114 + 1) + 8 * i);
        if ([v59 setJob])
        {
          assetSelector = [v59 assetSelector];
          assetType = [assetSelector assetType];
          clientDomainName5 = [v109 clientDomainName];
          if (([SUCore stringIsEqual:assetType to:clientDomainName5]& 1) != 0)
          {
            assetSelector2 = [v59 assetSelector];
            assetSpecifier = [assetSelector2 assetSpecifier];
            assetSetIdentifier5 = [v109 assetSetIdentifier];
            v66 = [SUCore stringIsEqual:assetSpecifier to:assetSetIdentifier5];

            if (v66)
            {
              v37 = v59;

              if (v37)
              {
                latestDownloadedAtomicInstance2 = 0;
                v76 = 0;
              }

              else
              {
LABEL_52:
                clientRequest = [requestCopy clientRequest];
                v78 = [(MADAutoAssetControlManager *)selfCopy clientRequestMessageName:clientRequest];
                latestDownloadedAtomicInstance2 = [(MADAutoAssetControlManager *)selfCopy setConfigurationFromMessageName:v78 withInfoInstance:v109 errorCode:0 errorDescription:0];

                v37 = 0;
                if (!latestDownloadedAtomicInstance2)
                {
                  v36 = 0;
                  goto LABEL_18;
                }

                v76 = 1;
              }

              clientDomainName6 = [v109 clientDomainName];
              assetSetIdentifier3 = [v109 assetSetIdentifier];
              atomicInstancesDownloaded = objc_alloc_init(MANAutoAssetSetNotifications);
              if (v76)
              {
                currentNotifications = 0;
              }

              else
              {
                newerAtomicInstanceDiscovered = [v109 clientDomainName];
                newerDiscoveredAtomicEntries = [v109 assetSetIdentifier];
                currentNotifications = [MADAutoAssetScheduler newSetPolicyForDomainName:newerAtomicInstanceDiscovered forAssetSetIdentifier:newerDiscoveredAtomicEntries];
              }

              v83 = +[MADAutoAssetControlManager stagerSetPolicy];
              availableForUseError2 = [v102 availableForUseError];
              newerVersionError2 = [v102 newerVersionError];
              LOBYTE(v89) = 1;
              LOBYTE(v88) = 0;
              LOBYTE(v87) = 0;
              v36 = [(MADAutoAssetControlManager *)selfCopy newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"scheduled set-job" forClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier3 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:atomicInstancesDownloaded withCurrentNeedPolicy:0 withSchedulerPolicy:currentNotifications withStagerPolicy:v83 withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:availableForUseError2 withNewerVersionError:newerVersionError2];

              if (v76)
              {
LABEL_15:

                v38 = latestDownloadedAtomicInstance2;
LABEL_16:

                goto LABEL_17;
              }

LABEL_14:

              goto LABEL_15;
            }
          }

          else
          {
          }
        }
      }

      v57 = [obj countByEnumeratingWithState:&v114 objects:v128 count:16];
      if (!v57)
      {
LABEL_36:

        goto LABEL_52;
      }
    }
  }

  atomicInstance3 = [v109 atomicInstance];
  obj = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"handleSetClientCurrentStatusRequest" forAtomicInstanceUUID:atomicInstance3 requireExists:0];

  if (obj)
  {
    v103 = objc_alloc_init(MANAutoAssetSetNotifications);
    latestDownloadedAtomicInstance = [obj latestDownloadedAtomicInstance];
    latestAtomicInstanceToVend3 = [v102 latestAtomicInstanceToVend];
    v24 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestAtomicInstanceToVend3];

    if (v24)
    {
      latestDownloadedAtomicInstance2 = [obj latestDownloadedAtomicInstance];
      latestDowloadedAtomicInstanceEntries2 = [obj latestDowloadedAtomicInstanceEntries];
      clientDomainName6 = [(MADAutoAssetControlManager *)selfCopy _limitToCheckAtomicEntries:latestDowloadedAtomicInstanceEntries2];
    }

    else
    {
      latestDownloadedAtomicInstance2 = 0;
      clientDomainName6 = 0;
    }

    [(MANAutoAssetSetNotifications *)v103 setAtomicInstanceDiscovered:1];
    [(MANAutoAssetSetNotifications *)v103 setAtomicInstanceAvailableForUse:1];
    assetSetIdentifier3 = [obj clientDomainName];
    atomicInstancesDownloaded = [obj assetSetIdentifier];
    newerAtomicInstanceDiscovered = [(MADAutoAssetControlManager *)selfCopy _newAtomicInstancesDownloadedForSetIdentifier:obj];
    newerDiscoveredAtomicEntries = [obj discoveredAtomicInstance];
    currentNotifications = [obj discoveredAtomicEntries];
    latestAtomicInstanceToVendFromPreSUStaging2 = [v102 latestAtomicInstanceToVendFromPreSUStaging];
    currentNeedPolicy = [obj clientDomainName];
    clientDomainName4 = [obj assetSetIdentifier];
    assetSetIdentifier4 = [MADAutoAssetScheduler newSetPolicyForDomainName:currentNeedPolicy forAssetSetIdentifier:clientDomainName4];
    v93 = +[MADAutoAssetControlManager stagerSetPolicy];
    downloadUserInitiated2 = [obj downloadUserInitiated];
    downloadedNetworkBytes2 = [obj downloadedNetworkBytes];
    downloadedFilesystemBytes2 = [obj downloadedFilesystemBytes];
    availableForUseError3 = [v102 availableForUseError];
    downloadProgress = [v102 newerVersionError];
    LOBYTE(v89) = 1;
    LOBYTE(v88) = downloadUserInitiated2;
    LOBYTE(v87) = latestAtomicInstanceToVendFromPreSUStaging2;
    v36 = [(MADAutoAssetControlManager *)selfCopy newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"downloaded auto-asset-set" forClientDomain:assetSetIdentifier3 forAssetSetIdentifier:atomicInstancesDownloaded withAtomicInstancesDownloaded:newerAtomicInstanceDiscovered withNewerAtomicInstanceDiscovered:newerDiscoveredAtomicEntries withNewerDiscoveredAtomicEntries:currentNotifications withLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance2 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:clientDomainName6 withCurrentNotifications:v103 withCurrentNeedPolicy:0 withSchedulerPolicy:assetSetIdentifier4 withStagerPolicy:v93 withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:downloadedNetworkBytes2 withDownloadedFilesystemBytes:downloadedFilesystemBytes2 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:availableForUseError3 withNewerVersionError:downloadProgress];
LABEL_12:

LABEL_13:
    v37 = v103;
    goto LABEL_14;
  }

  +[MADAutoAssetScheduler jobsAwaitingTrigger];
  v112 = 0u;
  v113 = 0u;
  v110 = 0u;
  v103 = v111 = 0u;
  v36 = [(MANAutoAssetSetNotifications *)v103 countByEnumeratingWithState:&v110 objects:v127 count:16];
  if (!v36)
  {
LABEL_49:
    v38 = v103;
    v37 = v103;
    goto LABEL_16;
  }

  v108 = *v111;
LABEL_39:
  v67 = 0;
  while (1)
  {
    if (*v111 != v108)
    {
      objc_enumerationMutation(v103);
    }

    v68 = *(*(&v110 + 1) + 8 * v67);
    if (![v68 setJob])
    {
      goto LABEL_47;
    }

    assetSelector3 = [v68 assetSelector];
    assetType2 = [assetSelector3 assetType];
    clientDomainName7 = [v109 clientDomainName];
    if (([SUCore stringIsEqual:assetType2 to:clientDomainName7]& 1) == 0)
    {

      goto LABEL_47;
    }

    assetSelector4 = [v68 assetSelector];
    assetSpecifier2 = [assetSelector4 assetSpecifier];
    assetSetIdentifier6 = [v109 assetSetIdentifier];
    v75 = [SUCore stringIsEqual:assetSpecifier2 to:assetSetIdentifier6];

    if (v75)
    {
      break;
    }

LABEL_47:
    if (v36 == ++v67)
    {
      v36 = [(MANAutoAssetSetNotifications *)v103 countByEnumeratingWithState:&v110 objects:v127 count:16];
      if (v36)
      {
        goto LABEL_39;
      }

      goto LABEL_49;
    }
  }

  latestDownloadedAtomicInstance2 = v68;

  if (latestDownloadedAtomicInstance2)
  {
    clientDomainName6 = [v109 clientDomainName];
    assetSetIdentifier3 = [v109 assetSetIdentifier];
    atomicInstancesDownloaded = objc_alloc_init(MANAutoAssetSetNotifications);
    newerAtomicInstanceDiscovered = [v109 clientDomainName];
    newerDiscoveredAtomicEntries = [v109 assetSetIdentifier];
    currentNotifications = [MADAutoAssetScheduler newSetPolicyForDomainName:newerAtomicInstanceDiscovered forAssetSetIdentifier:newerDiscoveredAtomicEntries];
    currentNeedPolicy = +[MADAutoAssetControlManager stagerSetPolicy];
    clientDomainName4 = [v102 availableForUseError];
    newerVersionError3 = [v102 newerVersionError];
    LOBYTE(v89) = 1;
    LOBYTE(v88) = 0;
    LOBYTE(v87) = 0;
    v36 = [(MADAutoAssetControlManager *)selfCopy newAssetSetStatus:@"handleSetClientCurrentStatusRequest" forReason:@"scheduled set-job" forClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier3 withAtomicInstancesDownloaded:0 withNewerAtomicInstanceDiscovered:0 withNewerDiscoveredAtomicEntries:0 withLatestDownloadedAtomicInstance:0 withLatestDownloadedAtomicInstanceFromPreSUStaging:v87 withLatestDowloadedAtomicInstanceEntries:0 withCurrentNotifications:atomicInstancesDownloaded withCurrentNeedPolicy:0 withSchedulerPolicy:currentNotifications withStagerPolicy:currentNeedPolicy withDownloadUserInitiated:v88 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 extendingWithCurrentLockUsage:v89 withSelectorsForStaging:0 withAvailableForUseError:clientDomainName4 withNewerVersionError:newerVersionError3];

    goto LABEL_13;
  }

  v36 = 0;
  v37 = v103;
LABEL_17:

LABEL_18:
  if (v36)
  {
    summary4 = objc_alloc_init(NSMutableDictionary);
    v40 = [MANAutoAssetSetInfoFound alloc];
    assetSetIdentifier7 = [v36 assetSetIdentifier];
    v42 = [(MANAutoAssetSetInfoFound *)v40 initForAssetSetIdentifier:assetSetIdentifier7 reportingStatus:v36];

    v43 = [MASAutoAssetSetInfoInstance newShimmedToFramework:v109];
    [summary4 setSafeObject:v43 forKey:@"setInstance"];

    v44 = [MASAutoAssetSetInfoFound newShimmedToFramework:v42];
    [summary4 setSafeObject:v44 forKey:@"setFound"];

    v45 = [SUCoreConnectMessage alloc];
    clientRequestMessage = [requestCopy clientRequestMessage];
    v47 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
    clientRequestMessage2 = [requestCopy clientRequestMessage];
    clientID = [clientRequestMessage2 clientID];
    v50 = [v45 initWithType:2 messageName:v47 clientID:clientID version:0 message:summary4];

    [(MADAutoAssetControlManager *)selfCopy issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v50 withResponseError:0 fromLocation:@"handleSetClientCurrentStatusRequest"];
    v51 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v51, OS_LOG_TYPE_DEBUG))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      summary = [v109 summary];
      summary2 = [v36 summary];
      summary3 = [requestCopy summary];
      *buf = 138544130;
      v120 = _updateLatestSummary;
      v121 = 2114;
      v122 = summary;
      v123 = 2114;
      v124 = summary2;
      v125 = 2114;
      v126 = summary3;
      _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEBUG, "[%{public}@] {handleSetClientCurrentStatusRequest} current set-status request | setInstance:%{public}@, lastSetJobStatus:%{public}@, event:%{public}@", buf, 0x2Au);
    }
  }

  else
  {
    v56 = [NSString alloc];
    summary4 = [v109 summary];
    v42 = [v56 initWithFormat:@"current status requested for unknown auto-asset-set (no status available for setInstance:%@)", summary4];
    [(MADAutoAssetControlManager *)selfCopy issueResponseForEventInfo:requestCopy withErrorCode:6301 fromAction:@"handleSetClientCurrentStatusRequest" withDescription:v42];
  }

  os_activity_scope_leave(&state);
}

- (void)handleSetControlClientAssetSetsOverviewRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetControlClientAssetSetsOverviewRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v78 = [MASAutoAssetSetInfoControl newShimmedFromFrameworkMessage:message forKey:@"setControl"];
  v75 = objc_alloc_init(NSMutableArray);
  v82 = objc_alloc_init(NSMutableDictionary);
  v93 = 0u;
  v94 = 0u;
  v91 = 0u;
  v92 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  obj = [allKeys copy];

  v12 = [obj countByEnumeratingWithState:&v91 objects:v98 count:16];
  if (v12)
  {
    v79 = *v92;
    do
    {
      v13 = 0;
      do
      {
        if (*v92 != v79)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v91 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v17 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v17)
        {
          assetSetIdentifier = [v17 assetSetIdentifier];
          clientDomainName = [v17 clientDomainName];
          v20 = [MADAutoAssetControlManager assetSetToBeIncluded:assetSetIdentifier consideredClientDomain:clientDomainName basedOnControl:v78];

          if (v20)
          {
            v21 = [MANAutoAssetSetOverview alloc];
            clientDomainName2 = [v17 clientDomainName];
            assetSetIdentifier2 = [v17 assetSetIdentifier];
            autoAssetEntries = [v17 autoAssetEntries];
            v25 = [(MANAutoAssetSetOverview *)v21 initWithDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 withConfiguredAssetEntries:autoAssetEntries withLatestDownloadedAtomicInstance:0 withDownloadedAtomicInstances:0 withDiscoveredAtomicInstance:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0];

            if (v25)
            {
              [v75 addObject:v25];
            }

            clientDomainName3 = [v17 clientDomainName];
            assetSetIdentifier3 = [v17 assetSetIdentifier];
            v28 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

            if (v25)
            {
              [v82 setSafeObject:v25 forKey:v28];
            }
          }
        }

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v12 != v13);
      v12 = [obj countByEnumeratingWithState:&v91 objects:v98 count:16];
    }

    while (v12);
  }

  [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  v89 = 0u;
  v90 = 0u;
  v87 = 0u;
  obja = v88 = 0u;
  v29 = [obja countByEnumeratingWithState:&v87 objects:v97 count:16];
  if (v29)
  {
    v80 = *v88;
    do
    {
      v30 = 0;
      do
      {
        if (*v88 != v80)
        {
          objc_enumerationMutation(obja);
        }

        v31 = *(*(&v87 + 1) + 8 * v30);
        v32 = objc_autoreleasePoolPush();
        v33 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetControlClientAssetSetsOverviewRequest" forKey:v31];
        v34 = v33;
        if (v33)
        {
          clientDomainName4 = [v33 clientDomainName];
          assetSetIdentifier4 = [v34 assetSetIdentifier];
          v37 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4];

          v38 = [v82 safeObjectForKey:v37 ofClass:objc_opt_class()];
          v39 = v38;
          if (v38)
          {
            downloadedAtomicInstances = [v38 downloadedAtomicInstances];
            v41 = downloadedAtomicInstances == 0;

            if (v41)
            {
              v42 = objc_alloc_init(NSMutableArray);
              [v39 setDownloadedAtomicInstances:v42];
            }

            latestDownloadedAtomicInstance = [v34 latestDownloadedAtomicInstance];
            v44 = latestDownloadedAtomicInstance == 0;

            if (!v44)
            {
              downloadedAtomicInstances2 = [v39 downloadedAtomicInstances];
              latestDownloadedAtomicInstance2 = [v34 latestDownloadedAtomicInstance];
              [downloadedAtomicInstances2 addObject:latestDownloadedAtomicInstance2];
            }

            clientDomainName5 = [v34 clientDomainName];
            assetSetIdentifier5 = [v34 assetSetIdentifier];
            v49 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName5 forAssetSetIdentifier:assetSetIdentifier5];

            latestAtomicInstanceToVend = [v49 latestAtomicInstanceToVend];
            [v39 setLatestDownloadedAtomicInstance:latestAtomicInstanceToVend];
          }
        }

        objc_autoreleasePoolPop(v32);
        v30 = v30 + 1;
      }

      while (v29 != v30);
      v29 = [obja countByEnumeratingWithState:&v87 objects:v97 count:16];
    }

    while (v29);
  }

  v85 = 0u;
  v86 = 0u;
  v83 = 0u;
  v84 = 0u;
  activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
  v52 = [activeSetDescriptorsByInstance countByEnumeratingWithState:&v83 objects:v96 count:16];
  if (v52)
  {
    v53 = *v84;
    v81 = activeSetDescriptorsByInstance;
    do
    {
      v54 = 0;
      do
      {
        if (*v84 != v53)
        {
          objc_enumerationMutation(v81);
        }

        v55 = *(*(&v83 + 1) + 8 * v54);
        v56 = objc_autoreleasePoolPush();
        activeSetDescriptorsByInstance2 = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
        v58 = [activeSetDescriptorsByInstance2 safeObjectForKey:v55 ofClass:objc_opt_class()];

        if (v58)
        {
          clientDomainName6 = [v58 clientDomainName];
          assetSetIdentifier6 = [v58 assetSetIdentifier];
          v61 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6];

          v62 = [v82 safeObjectForKey:v61 ofClass:objc_opt_class()];
          v63 = v62;
          if (v62)
          {
            [v62 setDiscoveredAtomicInstance:v55];
          }
        }

        objc_autoreleasePoolPop(v56);
        v54 = v54 + 1;
      }

      while (v52 != v54);
      activeSetDescriptorsByInstance = v81;
      v52 = [v81 countByEnumeratingWithState:&v83 objects:v96 count:16];
    }

    while (v52);
  }

  v64 = objc_alloc_init(NSMutableDictionary);
  v65 = [MASAutoAssetSetOverview newShimmedArrayToFramework:v75];
  [v64 setSafeObject:v65 forKey:@"setOverview"];

  v66 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v68 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v71 = [v66 initWithType:2 messageName:v68 clientID:clientID version:0 message:v64];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v71 withResponseError:0 fromLocation:@"handleSetControlClientAssetSetsOverviewRequest"];
  os_activity_scope_leave(&state);
}

- (void)handleSetControlClientInstanceInfoRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetControlClientInstanceInfoRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  clientRequestMessage = [requestCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v37 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:message forKey:@"setInstance"];
  atomicInstance = [v37 atomicInstance];
  v38 = atomicInstance;
  if (atomicInstance && ((-[MADAutoAssetControlManager setDescriptorWalkLocate:forKey:](selfCopy, "setDescriptorWalkLocate:forKey:", @"handleSetControlClientInstanceInfoRequest", atomicInstance), (v14 = objc_claimAutoreleasedReturnValue()) != 0) || (-[MADAutoAssetControlManager activeSetDescriptorsByInstance](selfCopy, "activeSetDescriptorsByInstance"), v15 = objc_claimAutoreleasedReturnValue(), [v15 safeObjectForKey:v38 ofClass:objc_opt_class()], v14 = objc_claimAutoreleasedReturnValue(), v15, v14)))
  {
    v35 = message;
    v36 = jobCopy;
    if ([v14 isDiscoveredFullyDownloaded])
    {
      [v14 latestDowloadedAtomicInstanceEntries];
    }

    else
    {
      [v14 discoveredAtomicEntries];
    }
    v17 = ;
    v34 = [MANAutoAssetSetInstanceDescriptor alloc];
    clientDomainName = [v14 clientDomainName];
    assetSetIdentifier = [v14 assetSetIdentifier];
    isDiscoveredFullyDownloaded = [v14 isDiscoveredFullyDownloaded];
    neverBeenLocked = [v14 neverBeenLocked];
    downloadUserInitiated = [v14 downloadUserInitiated];
    downloadedNetworkBytes = [v14 downloadedNetworkBytes];
    downloadedFilesystemBytes = [v14 downloadedFilesystemBytes];
    LOBYTE(v33) = [v14 stagedPriorToAvailable];
    v16 = [(MANAutoAssetSetInstanceDescriptor *)v34 initForClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier withAtomicInstanceEntries:v17 withFullyDownloaded:isDiscoveredFullyDownloaded withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withStagedPriorToAvailable:v33];

    message = v35;
    jobCopy = v36;
  }

  else
  {
    v16 = 0;
  }

  v25 = objc_alloc_init(NSMutableDictionary);
  if (v16)
  {
    v26 = [MASAutoAssetSetInstanceDescriptor newShimmedToFramework:v16];
    [v25 setSafeObject:v26 forKey:@"setInstanceInfo"];
  }

  v27 = [SUCoreConnectMessage alloc];
  clientRequestMessage2 = [requestCopy clientRequestMessage];
  v29 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
  clientRequestMessage3 = [requestCopy clientRequestMessage];
  clientID = [clientRequestMessage3 clientID];
  v32 = [v27 initWithType:2 messageName:v29 clientID:clientID version:0 message:v25];

  [(MADAutoAssetControlManager *)selfCopy issueBuiltResponseForEventInfo:requestCopy issuingResponseMessage:v32 withResponseError:0 fromLocation:@"handleSetControlClientInstanceInfoRequest"];
  os_activity_scope_leave(&state);
}

+ (BOOL)assetSetToBeIncluded:(id)included consideredClientDomain:(id)domain basedOnControl:(id)control
{
  includedCopy = included;
  domainCopy = domain;
  controlCopy = control;
  v10 = controlCopy;
  if (controlCopy)
  {
    limitedToSetIdentifiers = [controlCopy limitedToSetIdentifiers];

    if (limitedToSetIdentifiers)
    {
      v26 = 0u;
      v27 = 0u;
      v24 = 0u;
      v25 = 0u;
      limitedToSetIdentifiers2 = [v10 limitedToSetIdentifiers];
      v13 = [limitedToSetIdentifiers2 countByEnumeratingWithState:&v24 objects:v29 count:16];
      if (v13)
      {
        v14 = *v25;
        while (2)
        {
          for (i = 0; i != v13; i = i + 1)
          {
            if (*v25 != v14)
            {
              objc_enumerationMutation(limitedToSetIdentifiers2);
            }

            if (([SUCore stringIsEqual:includedCopy to:*(*(&v24 + 1) + 8 * i)]& 1) != 0)
            {

              goto LABEL_13;
            }
          }

          v13 = [limitedToSetIdentifiers2 countByEnumeratingWithState:&v24 objects:v29 count:16];
          if (v13)
          {
            continue;
          }

          break;
        }
      }

      goto LABEL_25;
    }

LABEL_13:
    limitedToClientDomains = [v10 limitedToClientDomains];

    if (limitedToClientDomains)
    {
      v22 = 0u;
      v23 = 0u;
      v20 = 0u;
      v21 = 0u;
      limitedToSetIdentifiers2 = [v10 limitedToClientDomains];
      v13 = [limitedToSetIdentifiers2 countByEnumeratingWithState:&v20 objects:v28 count:16];
      if (v13)
      {
        v17 = *v21;
        while (2)
        {
          for (j = 0; j != v13; j = j + 1)
          {
            if (*v21 != v17)
            {
              objc_enumerationMutation(limitedToSetIdentifiers2);
            }

            if (([SUCore stringIsEqual:domainCopy to:*(*(&v20 + 1) + 8 * j)]& 1) != 0)
            {
              LOBYTE(v13) = 1;
              goto LABEL_25;
            }
          }

          v13 = [limitedToSetIdentifiers2 countByEnumeratingWithState:&v20 objects:v28 count:16];
          if (v13)
          {
            continue;
          }

          break;
        }
      }

LABEL_25:

      goto LABEL_26;
    }
  }

  LOBYTE(v13) = 1;
LABEL_26:

  return v13;
}

- (void)handleSetClientAlterEntriesRepresentingAtomicRequest:(id)request forAutoJob:(id)job whenCancelingSetJob:(id)setJob alteringFromSetConfiguration:(id)configuration
{
  requestCopy = request;
  jobCopy = job;
  setJobCopy = setJob;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v14 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientAlterEntriesRepresentingAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v14, &state);

  v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (v15)
  {
    clientDomainName = [v15 clientDomainName];
    if (clientDomainName)
    {
      autoAssetSetClientName = [v15 autoAssetSetClientName];
      if (autoAssetSetClientName)
      {
        assetSetIdentifier = [v15 assetSetIdentifier];
        if (assetSetIdentifier)
        {
          autoAssetEntries = [v15 autoAssetEntries];
          v22 = autoAssetEntries == 0;

          if (!v22)
          {
            summary9 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:v15];
            knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
            v25 = [knownSetConfigurationsByIdentifier safeObjectForKey:summary9 ofClass:objc_opt_class()];

            if (!v25)
            {
              v34 = [NSString alloc];
              summary = [requestCopy summary];
              v110 = [v34 initWithFormat:@"[ALTER] invalid set-eventInfo (no set-identifier to be altered) | set-eventInfo:%@", summary];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6554 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v110];
LABEL_53:

              goto LABEL_16;
            }

            persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            summary = [persistedKnownSetConfigurations persistedEntry:summary9 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest"];

            if (summary)
            {
              summary8 = configurationCopy;
              autoAssetEntries2 = [v15 autoAssetEntries];
              if (!autoAssetEntries2 || ([v15 autoAssetEntries], v28 = objc_claimAutoreleasedReturnValue(), v29 = objc_msgSend(v28, "count") == 0, v28, autoAssetEntries2, v29))
              {
                v36 = [NSString alloc];
                summary2 = [requestCopy summary];
                v38 = [v36 initWithFormat:@"[ALTER] no valid asset-entries to alter to | set-eventInfo:%@", summary2];
                [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6555 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v38];
              }

              else
              {
                v106 = [(MADAutoAssetControlManager *)self setConfiguration:summary8 matchesAssetEntriesFromInfoInstance:v15];
                clientAssetSetPolicy = [v17 clientAssetSetPolicy];
                blockCheckDownload = [clientAssetSetPolicy blockCheckDownload];

                if (blockCheckDownload)
                {
                  v108 = 1;
                }

                else
                {
                  autoAssetEntries3 = [v15 autoAssetEntries];
                  v108 = [autoAssetEntries3 count] == 0;
                }

                if (v106)
                {
                  v45 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    summary3 = [v15 summary];
                    *buf = 138543618;
                    v117 = _updateLatestSummary;
                    v118 = 2114;
                    v119 = summary3;
                    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[ALTER] altered without change to auto-asset-entries | setInfoInstance:%{public}@", buf, 0x16u);
                  }
                }

                else if (setJobCopy)
                {
                  v45 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    summary4 = [v15 summary];
                    *buf = 138543618;
                    v117 = _updateLatestSummary2;
                    v118 = 2114;
                    v119 = summary4;
                    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[ALTER] altered when canceling set-job | setInfoInstance:%{public}@", buf, 0x16u);
                  }
                }

                else
                {
                  clientDomainName2 = [v15 clientDomainName];
                  assetSetIdentifier2 = [v15 assetSetIdentifier];
                  v45 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName2 byIdentifier:assetSetIdentifier2];

                  if (v45)
                  {
                    if ([v45 beingCanceled])
                    {
                      v52 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
                      {
                        _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        summary5 = [requestCopy summary];
                        *buf = 138543618;
                        v117 = _updateLatestSummary3;
                        v118 = 2114;
                        v102 = summary5;
                        v119 = summary5;
                        _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[CANCEL-SET-JOB][ALTER] already canceling set-job | set-eventInfo:%{public}@", buf, 0x16u);
                      }
                    }

                    else
                    {
                      v55 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
                      {
                        _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        summary6 = [requestCopy summary];
                        *buf = 138543618;
                        v117 = _updateLatestSummary4;
                        v118 = 2114;
                        v103 = summary6;
                        v119 = summary6;
                        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest}\n[CANCEL-SET-JOB][ALTER] canceling active set-job | set-eventInfo:%{public}@", buf, 0x16u);
                      }

                      [(MADAutoAssetControlManager *)self cancelActiveSetJob:@"handleSetClientAlterEntriesRepresentingAtomicRequest" activeSetJob:v45];
                    }
                  }
                }

                newerAtomicInstanceOncePersonalized = [summary8 newerAtomicInstanceOncePersonalized];
                v59 = newerAtomicInstanceOncePersonalized == 0;

                if (!v59)
                {
                  [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forSetConfiguration:summary8];
                }

                v60 = [MADAutoSetConfiguration alloc];
                clientDomainName3 = [v15 clientDomainName];
                autoAssetSetClientName2 = [v15 autoAssetSetClientName];
                assetSetIdentifier3 = [v15 assetSetIdentifier];
                autoAssetEntries4 = [v15 autoAssetEntries];
                v104 = objc_opt_self();
                discoveredInFlightAtomicInstance = [v104 discoveredInFlightAtomicInstance];
                newerAtomicInstanceOncePersonalized2 = [summary8 newerAtomicInstanceOncePersonalized];
                latestAtomicInstanceToVend = [summary8 latestAtomicInstanceToVend];
                latestAtomicInstanceToVendFromPreSUStaging = [summary8 latestAtomicInstanceToVendFromPreSUStaging];
                previouslyVendedLockedAtomicInstances = [summary8 previouslyVendedLockedAtomicInstances];
                ticksUntilPreviousForceUnlocked = [summary8 ticksUntilPreviousForceUnlocked];
                mostRecentlyReceivedCachedAssetSetID = [summary8 mostRecentlyReceivedCachedAssetSetID];
                mostRecentlyReceivedDownloadedFromLive = [summary8 mostRecentlyReceivedDownloadedFromLive];
                mostRecentlyReceivedLastTimeChecked = [summary8 mostRecentlyReceivedLastTimeChecked];
                mostRecentlyReceivedPostedDate = [summary8 mostRecentlyReceivedPostedDate];
                latestToVendCachedAssetSetID = [summary8 latestToVendCachedAssetSetID];
                latestToVendDownloadedFromLive = [summary8 latestToVendDownloadedFromLive];
                latestToVendLastTimeChecked = [summary8 latestToVendLastTimeChecked];
                latestToVendPostedDate = [summary8 latestToVendPostedDate];
                availableForUseError = [summary8 availableForUseError];
                newerVersionError = [summary8 newerVersionError];
                everProvidedLatestToVend = [summary8 everProvidedLatestToVend];
                BYTE3(v76) = v106;
                BYTE2(v76) = [summary8 haveReceivedLookupResponse];
                BYTE1(v76) = v108;
                LOBYTE(v76) = everProvidedLatestToVend;
                LOBYTE(v75) = latestAtomicInstanceToVendFromPreSUStaging;
                v109 = [MADAutoSetConfiguration initForClientDomainName:v60 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:clientDomainName3 withAutoAssetEntries:autoAssetSetClientName2 withDiscoveredInFlightAtomicInstance:assetSetIdentifier3 withNewerAtomicInstanceOncePersonalized:autoAssetEntries4 withLatestAtomicInstanceToVend:discoveredInFlightAtomicInstance withLatestAtomicInstanceToVendFromPreSUStaging:newerAtomicInstanceOncePersonalized2 withPreviouslyVendedLockedAtomicInstances:latestAtomicInstanceToVend withTicksUntilPreviousForceUnlocked:v75 withMostRecentlyReceivedCachedAssetSetID:previouslyVendedLockedAtomicInstances withMostRecentlyReceivedDownloadedFromLive:ticksUntilPreviousForceUnlocked withMostRecentlyReceivedLastTimeChecked:mostRecentlyReceivedCachedAssetSetID withMostRecentlyReceivedPostedDate:mostRecentlyReceivedDownloadedFromLive withLatestToVendCachedAssetSetID:mostRecentlyReceivedLastTimeChecked withLatestToVendDownloadedFromLive:mostRecentlyReceivedPostedDate withLatestToVendLastTimeChecked:latestToVendCachedAssetSetID withLatestToVendPostedDate:latestToVendDownloadedFromLive withAavailableForUseError:latestToVendLastTimeChecked withNewerVersionError:latestToVendPostedDate havingEverProvidedLatestToVend:availableForUseError inhibitingImpliedScheduling:newerVersionError havingReceivedLookupResponse:v76 vendingAtomicInstanceForConfiguredEntries:?];

                if (v109)
                {
                  latestAtomicInstanceToVend2 = [v109 latestAtomicInstanceToVend];
                  v64 = latestAtomicInstanceToVend2 == 0;

                  if (!v64)
                  {
                    latestAtomicInstanceToVend3 = [v109 latestAtomicInstanceToVend];
                    v66 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forAtomicInstanceUUID:latestAtomicInstanceToVend3 requireExists:1];

                    if (v66 && [(MADAutoAssetControlManager *)self doesSetDescriptor:v66 satisfySetConfiguration:v109 allowingMoreDownloaded:0])
                    {
                      [v109 setVendingAtomicInstanceForConfiguredEntries:1];
                    }
                  }

                  [(MADAutoAssetControlManager *)self setConfigurationPersist:v109 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest" forReason:@"altered autoAssetEntries" dueToAlter:1 forHistoryOperation:449];
                  [MADAutoAssetLookupCache clearLookupResultsForSetConfiguration:v109];
                  if ((v106 & 1) == 0)
                  {
                    [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
                    [MADAutoAssetStager controlAlteredSetConfiguration:v109];
                  }

                  v93 = [MANAutoAssetSetInfoInstance alloc];
                  clientDomainName4 = [v15 clientDomainName];
                  autoAssetSetClientName3 = [v15 autoAssetSetClientName];
                  clientProcessName = [v15 clientProcessName];
                  clientProcessID = [v15 clientProcessID];
                  assetSetIdentifier4 = [v15 assetSetIdentifier];
                  latestAtomicInstanceToVend4 = [v109 latestAtomicInstanceToVend];
                  autoAssetEntries5 = [v15 autoAssetEntries];
                  entriesWhenTargeting = [v15 entriesWhenTargeting];
                  frameworkInstanceUUID = [v15 frameworkInstanceUUID];
                  summary2 = [(MANAutoAssetSetInfoInstance *)v93 initUsingClientDomain:clientDomainName4 forClientName:autoAssetSetClientName3 withProcessName:clientProcessName withProcessID:clientProcessID forAssetSetIdentifier:assetSetIdentifier4 forAtomicInstance:latestAtomicInstanceToVend4 comprisedOfEntries:autoAssetEntries5 asEntriesWhenTargeting:entriesWhenTargeting associatingFrameworkUUID:frameworkInstanceUUID];

                  clientRequest2 = [requestCopy clientRequest];
                  v69 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"alterEntriesRepresentingAtomic" forClientRequest:clientRequest2 withFoundSetDescriptor:0 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:summary2 withDesire:v17 fromLocation:@"handleSetClientAlterEntriesRepresentingAtomicRequest"];
                  v70 = clientRequest2;
                  v38 = v69;

                  clientRequest3 = [requestCopy clientRequest];
                  [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest3 issuingResponseMessage:v38 withResponseError:0];

                  summary8 = v109;
                }

                else
                {
                  v72 = [NSString alloc];
                  summary2 = [requestCopy summary];
                  v38 = [v72 initWithFormat:@"[ALTER] unable to allocate set-configuration | set-eventInfo:%@", summary2];
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6101 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v38];
                  summary8 = 0;
                }
              }

              clientAssetSetPolicy2 = [v17 clientAssetSetPolicy];
              v74 = clientAssetSetPolicy2 == 0;

              if (v74)
              {
                goto LABEL_52;
              }

              clientAssetSetPolicy3 = [v17 clientAssetSetPolicy];
              [(MADAutoAssetControlManager *)self _scheduleSetConfiguration:summary8 withClientSetPolicy:clientAssetSetPolicy3];
            }

            else
            {
              v39 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                summary7 = [requestCopy summary];
                *buf = 138543618;
                v117 = _updateLatestSummary5;
                v118 = 2114;
                v119 = summary7;
                _os_log_impl(&dword_0, v39, OS_LOG_TYPE_ERROR, "[%{public}@] {handleSetClientAlterEntriesRepresentingAtomicRequest} [ALTER] unable to load persisted-set-configuration file | set-eventInfo:%{public}@", buf, 0x16u);
              }

              v42 = [NSString alloc];
              summary8 = [requestCopy summary];
              clientAssetSetPolicy3 = [v42 initWithFormat:@"[ALTER] unable to load persisted-set-configuration file | set-eventInfo:%@", summary8];
              [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6101 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:clientAssetSetPolicy3];
            }

LABEL_52:
            v110 = summary8;
            goto LABEL_53;
          }

          goto LABEL_15;
        }
      }
    }

LABEL_15:
    v33 = [NSString alloc];
    summary9 = [requestCopy summary];
    v25 = [v33 initWithFormat:@"[ALTER] incomplete set-eventInfo | set-eventInfo:%@", summary9];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v25];
    goto LABEL_16;
  }

  v32 = [NSString alloc];
  summary9 = [requestCopy summary];
  v25 = [v32 initWithFormat:@"[ALTER] invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary9];
  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientAlterEntriesRepresentingAtomicRequest" withDescription:v25];
LABEL_16:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientFormSubAtomicRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientFormSubAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientFormSubAtomicRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (!v10)
  {
    v30 = [NSString alloc];
    summary = [requestCopy summary];
    v16 = [v30 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:v16];
LABEL_20:

    goto LABEL_21;
  }

  v13 = [(MADAutoAssetControlManager *)self atomicInstanceMatchingInfoInstance:@"handleSetClientFormSubAtomicRequest" withSetInfoInstance:v10];
  summary = v13;
  if (v13)
  {
    atomicInstanceUUID = [v13 atomicInstanceUUID];
    v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientFormSubAtomicRequest" forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

    if (v16)
    {
      v44 = 0;
      v42 = [(MADAutoAssetControlManager *)self atomicInstanceNewSubAtomicFromAtomic:summary forSubsetInfoInstance:v10 error:&v44];
      v17 = v44;
      v41 = v17;
      if (!v42 || v17)
      {
        if (v17)
        {
          code = [v17 code];
          localizedDescription = [v41 localizedDescription];
        }

        else
        {
          localizedDescription = @"unable to form sub-atomic-instance is to be formed from is not a known atomic-instance";
          code = "/System/Library/PrivateFrameworks/PowerLog.framework/PowerLog" + 56;
        }

        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:code fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:localizedDescription];
        if (!v41)
        {
          goto LABEL_19;
        }
      }

      else
      {
        instanceEntries = [v42 instanceEntries];
        v19 = [instanceEntries count];

        if (v19)
        {
          v20 = [(MADAutoAssetControlManager *)self newSetDescriptorFromAlreadyDownloaded:@"handleSetClientFormSubAtomicRequest" forSetInfoInstance:v10 fromDownloadedSetDescriptor:v16 forAtomicInstance:v42];
          if (!v20)
          {
            atomicInstanceUUID2 = [v42 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"handleSetClientFormSubAtomicRequest" setAtomicInstanceUUID:atomicInstanceUUID2 removingForReason:@"unable to create new set-descriptor" historyOperation:323];

            [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6101 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:@"unable to create new set-descriptor associated with the new sub-atomic-instance"];
            goto LABEL_19;
          }
        }

        v35 = [MANAutoAssetSetInfoInstance alloc];
        clientDomainName = [v10 clientDomainName];
        autoAssetSetClientName = [v10 autoAssetSetClientName];
        clientProcessName = [v10 clientProcessName];
        clientProcessID = [v10 clientProcessID];
        assetSetIdentifier = [v10 assetSetIdentifier];
        atomicInstanceUUID3 = [v42 atomicInstanceUUID];
        autoAssetEntries = [v10 autoAssetEntries];
        entriesWhenTargeting = [v10 entriesWhenTargeting];
        frameworkInstanceUUID = [v10 frameworkInstanceUUID];
        localizedDescription = [(MANAutoAssetSetInfoInstance *)v35 initUsingClientDomain:clientDomainName forClientName:autoAssetSetClientName withProcessName:clientProcessName withProcessID:clientProcessID forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:atomicInstanceUUID3 comprisedOfEntries:autoAssetEntries asEntriesWhenTargeting:entriesWhenTargeting associatingFrameworkUUID:frameworkInstanceUUID];

        clientRequest2 = [requestCopy clientRequest];
        atomicInstanceUUID4 = [v42 atomicInstanceUUID];
        v28 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"formSubAtomicInstance" forClientRequest:clientRequest2 withFoundSetDescriptor:0 withSubAtomicInstance:atomicInstanceUUID4 forLatestDownloaded:1 withInstance:localizedDescription withDesire:v12 fromLocation:@"handleSetClientFormSubAtomicRequest"];

        clientRequest3 = [requestCopy clientRequest];
        [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest3 issuingResponseMessage:v28 withResponseError:0];
      }

LABEL_19:
      goto LABEL_20;
    }

    v31 = @"atomic-instance that sub-atomic-instance is to be formed from has no associated set-descriptor (orphaned atomic-instance)";
    v32 = 6557;
  }

  else
  {
    v31 = @"atomic-instance that sub-atomic-instance is to be formed from is not a known atomic-instance";
    v32 = 6551;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:v32 fromAction:@"handleSetClientFormSubAtomicRequest" withDescription:v31];
LABEL_21:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientContinueAtomicLockRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientContinueAtomicLockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientContinueAtomicLockRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (!v10)
  {
    v23 = [NSString alloc];
    summary = [requestCopy summary];
    v19 = [v23 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:v19];
LABEL_8:

    goto LABEL_9;
  }

  atomicInstance = [v10 atomicInstance];
  summary = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientContinueAtomicLockRequest" forAtomicInstanceUUID:atomicInstance requireExists:0];

  if (summary)
  {
    autoAssetSetClientName = [v10 autoAssetSetClientName];
    desireReason = [v12 desireReason];
    clientAssetSetPolicy = [v12 clientAssetSetPolicy];
    v25 = 0;
    v18 = [MADAutoAssetLocker continuedSetLockByClient:autoAssetSetClientName forSetDescriptor:summary forLockReason:desireReason withSetUsagePolicy:clientAssetSetPolicy continueError:&v25];
    v19 = v25;

    if (v18)
    {
      clientRequest2 = [requestCopy clientRequest];
      v21 = [(MADAutoAssetControlManager *)self buildSetFoundResponseMessage:@"continueAtomicLock" forClientRequest:clientRequest2 withFoundSetDescriptor:summary withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v10 withDesire:v12 fromLocation:@"handleSetClientContinueAtomicLockRequest"];

      clientRequest3 = [requestCopy clientRequest];
      [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest3 issuingResponseMessage:v21 withResponseError:0];
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v19 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:@"failed lock continuation of auto-asset-set"];
    }

    goto LABEL_8;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6551 fromAction:@"handleSetClientContinueAtomicLockRequest" withDescription:@"atomic-instance lock to be continued for unknown atomic-instance [presumed retired]"];
LABEL_9:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEndAtomicLockRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEndAtomicLockRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEndAtomicLockRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (!v10)
  {
    v19 = [NSString alloc];
    summary = [requestCopy summary];
    v17 = [v19 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:v17];
    goto LABEL_23;
  }

  atomicInstance = [v10 atomicInstance];
  summary = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientEndAtomicLockRequest" forAtomicInstanceUUID:atomicInstance requireExists:0];

  if (summary)
  {
    if (![(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:summary])
    {
      v18 = 0;
LABEL_9:
      autoAssetSetClientName = [v10 autoAssetSetClientName];
      desireReason = [v12 desireReason];
      v39 = v18;
      v22 = [MADAutoAssetLocker endedPreviousSetLocksByClient:autoAssetSetClientName forSetDescriptor:summary forLockReason:desireReason removingLockCount:1 endError:&v39];
      v17 = v39;

      if (v22)
      {
        desireReason2 = [v12 desireReason];
        [(MADAutoAssetControlManager *)self setLockUsageMapEndedLockForSetDescriptor:summary forLockReason:desireReason2 endedLockCount:1];

        if ([(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientEndAtomicLockRequest" forSetDescriptor:summary])
        {
          v24 = 0;
        }

        else
        {
          clientDomainName = [summary clientDomainName];
          assetSetIdentifier = [summary assetSetIdentifier];
          v37 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

          [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLockRequest" forSetDescriptorNoLongerLocked:summary];
          if (__isPlatformVersionAtLeast(2, 18, 4, 0))
          {
            [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:summary];
          }

          latestAtomicInstanceToVend = [v37 latestAtomicInstanceToVend];
          latestDownloadedAtomicInstance = [summary latestDownloadedAtomicInstance];
          if (([SUCore stringIsEqual:latestAtomicInstanceToVend to:latestDownloadedAtomicInstance]& 1) != 0)
          {
            v29 = v37;
            v24 = 0;
          }

          else
          {
            clientDomainName2 = [summary clientDomainName];
            assetSetIdentifier2 = [summary assetSetIdentifier];
            v32 = [(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:@"handleSetClientEndAtomicLockRequest" forClientDomainName:clientDomainName2 ofSetIdentifier:assetSetIdentifier2];
            v33 = assetSetIdentifier2;
            v36 = clientDomainName2;
            v29 = v37;
            v24 = v32 ^ 1;
          }
        }

        [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLockRequest" setDescriptor:summary allowRemovalWithoutNewerDescriptor:0];
        if (v24)
        {
          [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:summary fromLocation:@"handleSetClientEndAtomicLockRequest" checkingByInstance:1 regardlessOfLatest:0 historyOperationAI:322 historyOperationSD:376];
        }

        clientDomainName3 = [summary clientDomainName];
        assetSetIdentifier3 = [summary assetSetIdentifier];
        [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLockRequest" forClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:0 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"successful end of atomic-lock of auto-asset-set (for client-specified criteria)"];
      }

      else
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v17 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"failed to end previous atomic-lock of auto-asset-set (for client-specified criteria)"];
      }

      goto LABEL_23;
    }

    v40 = 0;
    v15 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLockRequest" forSetDescriptor:summary endingAll:0 performingHardEliminate:0 error:&v40];
    v16 = v40;
    v17 = v16;
    if (v15)
    {
      v18 = v16;
      goto LABEL_9;
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v16 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"failed to end SHORT-TERM locking of set-descriptor"];
LABEL_23:

    goto LABEL_24;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6551 fromAction:@"handleSetClientEndAtomicLockRequest" withDescription:@"atomic-instance lock to be ended for unknown atomic-instance [presumed retired]"];
LABEL_24:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEndAtomicLocksForClientRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEndAtomicLocksForClientRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v64 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEndAtomicLocksForClientRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v58 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  clientRequest2 = [requestCopy clientRequest];
  v59 = [(MADAutoAssetControlManager *)self clientRequestMessageSetEnd:clientRequest2];

  if (!v64)
  {
    v34 = [NSString alloc];
    summary = [requestCopy summary];
    v35 = [v34 initWithFormat:@"invalid set-eventInfo (instance:MISSING) | set-eventInfo:%@", summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:v35];
    goto LABEL_55;
  }

  if (!v59)
  {
    v36 = [NSString alloc];
    summary = [requestCopy summary];
    v35 = [v36 initWithFormat:@"invalid set-eventInfo (end:MISSING) | set-eventInfo:%@", summary];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:v35];
    goto LABEL_55;
  }

  atomicInstance = [v64 atomicInstance];
  v12 = [atomicInstance isEqualToString:@"ALL_INSTANCES"];

  if (v12)
  {
    clientDomainName = [v64 clientDomainName];
    assetSetIdentifier = [v64 assetSetIdentifier];
    summary = [(MADAutoAssetControlManager *)self setLockUsageMapForClientDomain:clientDomainName forSetIdentifier:assetSetIdentifier];

    if (!summary)
    {
      v41 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
      {
        clientDomainName2 = [v64 clientDomainName];
        assetSetIdentifier2 = [v64 assetSetIdentifier];
        *buf = 138543618;
        v80 = clientDomainName2;
        v81 = 2114;
        v82 = assetSetIdentifier2;
        _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "{handleSetClientEndAtomicLocksForClientRequest} No lock is held when requesting to end all locks in all atomic and sub-atomic instances for domain: %{public}@, setID: %{public}@", buf, 0x16u);
      }

      goto LABEL_53;
    }

    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      clientDomainName3 = [v64 clientDomainName];
      assetSetIdentifier3 = [v64 assetSetIdentifier];
      *buf = 138543618;
      v80 = clientDomainName3;
      v81 = 2114;
      v82 = assetSetIdentifier3;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "{handleSetClientEndAtomicLocksForClientRequest} Ending all locks in all atomic and sub-atomic instances for domain: %{public}@, setID: %{public}@", buf, 0x16u);
    }

    v18 = objc_alloc_init(NSMutableArray);
    clientDomainName4 = [v64 clientDomainName];
    assetSetIdentifier4 = [v64 assetSetIdentifier];
    v21 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:clientDomainName4 assetSetIdentifier:assetSetIdentifier4];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"handleSetClientEndAtomicLocksForClientRequest" ofContainer:@"setDescriptorKeysForAssetSet"];
    v74 = 0u;
    v75 = 0u;
    v72 = 0u;
    v73 = 0u;
    obj = v21;
    v22 = [obj countByEnumeratingWithState:&v72 objects:v78 count:16];
    if (!v22)
    {
      v61 = 0;
      goto LABEL_41;
    }

    v61 = 0;
    v23 = *v73;
    while (1)
    {
      for (i = 0; i != v22; i = i + 1)
      {
        if (*v73 != v23)
        {
          objc_enumerationMutation(obj);
        }

        v25 = *(*(&v72 + 1) + 8 * i);
        v26 = objc_autoreleasePoolPush();
        v27 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v25];
        v28 = v27;
        if (v27)
        {
          latestDownloadedAtomicInstance = [v27 latestDownloadedAtomicInstance];
          v30 = [(MADAutoAssetControlManager *)self setLockUsageMapForAtomicInstance:latestDownloadedAtomicInstance clientLockUsageMap:summary lockReason:0]> 0;

          if (v30)
          {
            if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:v28])
            {
              v71 = 0;
              v31 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest(ALL)" forSetDescriptor:v28 endingAll:1 performingHardEliminate:0 error:&v71];
              v32 = v71;
              v33 = v32;
              if ((v31 & 1) == 0)
              {
                if (!v61)
                {
                  v33 = v32;
                  v61 = v33;
                }

                goto LABEL_20;
              }
            }

            else
            {
              v33 = 0;
            }

            [v18 addObject:v28];
LABEL_20:
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v22 = [obj countByEnumeratingWithState:&v72 objects:v78 count:16];
      if (!v22)
      {
LABEL_41:

        v69 = 0u;
        v70 = 0u;
        v67 = 0u;
        v68 = 0u;
        v41 = v18;
        v50 = [v41 countByEnumeratingWithState:&v67 objects:v77 count:16];
        if (v50)
        {
          v51 = *v68;
          do
          {
            for (j = 0; j != v50; j = j + 1)
            {
              if (*v68 != v51)
              {
                objc_enumerationMutation(v41);
              }

              v53 = *(*(&v67 + 1) + 8 * j);
              [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptorNoLongerLocked:v53];
              if (__isPlatformVersionAtLeast(2, 18, 4, 0))
              {
                [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:v53];
              }

              autoAssetSetClientName = [v64 autoAssetSetClientName];
              [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:autoAssetSetClientName forSetDescriptor:v53];

              [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLocksForClientRequest" setDescriptor:v53 allowRemovalWithoutNewerDescriptor:0];
            }

            v50 = [v41 countByEnumeratingWithState:&v67 objects:v77 count:16];
          }

          while (v50);
        }

        if (v61)
        {

          v35 = v61;
          [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v61 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end all locks due to SHORT-TERM locks"];
          goto LABEL_55;
        }

        clientDomainName5 = [v64 clientDomainName];
        assetSetIdentifier5 = [v64 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:clientDomainName5 forSetIdentifier:assetSetIdentifier5];

LABEL_53:
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:0 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"Completed end of all atomic-locks of auto-asset-set for MA_END_ATOMIC_LOCKS_ALL_INSTANCES request"];
        clientDomainName6 = [v64 clientDomainName];
        assetSetIdentifier6 = [v64 assetSetIdentifier];
        [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLocksForClientRequest" forClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6];
        v35 = 0;
LABEL_54:

LABEL_55:
        goto LABEL_56;
      }
    }
  }

  atomicInstance2 = [v64 atomicInstance];
  summary = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest" forAtomicInstanceUUID:atomicInstance2 requireExists:0];

  if (summary)
  {
    if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:?])
    {
      v66 = 0;
      v38 = [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:@"handleSetClientEndAtomicLocksForClientRequest(specific)" forSetDescriptor:summary endingAll:0 performingHardEliminate:0 error:&v66];
      v39 = v66;
      v35 = v39;
      if ((v38 & 1) == 0)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v39 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end standard-lock due to SHORT-TERM locks"];
        goto LABEL_55;
      }

      v40 = v39;
    }

    else
    {
      v40 = 0;
    }

    autoAssetSetClientName2 = [v64 autoAssetSetClientName];
    desireReason = [v58 desireReason];
    v65 = v40;
    v46 = +[MADAutoAssetLocker endedPreviousSetLocksByClient:forSetDescriptor:forLockReason:removingLockCount:endError:](MADAutoAssetLocker, "endedPreviousSetLocksByClient:forSetDescriptor:forLockReason:removingLockCount:endError:", autoAssetSetClientName2, summary, desireReason, [v59 endLockCount], &v65);
    v35 = v65;

    if (!v46)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withAutoAssetError:v35 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"failed to end previous atomic-locks of auto-asset-set (for client-specified criteria)"];
      goto LABEL_55;
    }

    desireReason2 = [v58 desireReason];
    -[MADAutoAssetControlManager setLockUsageMapEndedLockForSetDescriptor:forLockReason:endedLockCount:](self, "setLockUsageMapEndedLockForSetDescriptor:forLockReason:endedLockCount:", summary, desireReason2, [v59 endLockCount]);

    if (![(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptor:summary])
    {
      [(MADAutoAssetControlManager *)self secureCheckUngraftAll:@"handleSetClientEndAtomicLocksForClientRequest" forSetDescriptorNoLongerLocked:summary];
      if (__isPlatformVersionAtLeast(2, 18, 4, 0))
      {
        [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:summary];
      }
    }

    [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:@"handleSetClientEndAtomicLocksForClientRequest" setDescriptor:summary allowRemovalWithoutNewerDescriptor:0];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:0 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"successful end of atomic-locks of auto-asset-set (for client-specified criteria)"];
    clientDomainName6 = [summary clientDomainName];
    assetSetIdentifier6 = [summary assetSetIdentifier];
    [(MADAutoAssetControlManager *)self finishSetEliminateIfAwaitingUnlocked:@"handleSetClientEndAtomicLocksForClientRequest" forClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6];
    goto LABEL_54;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6551 fromAction:@"handleSetClientEndAtomicLocksForClientRequest" withDescription:@"atomic-instance locks to be ended for unknown atomic-instance [presumed retired]"];
LABEL_56:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientAssetSetForStagingRequest:(id)request forAutoJob:(id)job
{
  requestCopy = request;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v8 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientAssetSetForStagingRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v8, &state);

  v9 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientAssetSetForStagingRequest" withEventInfo:requestCopy];
  v57 = v9;
  if (!v9)
  {
    v17 = @"setInfoInstance is not provided in request | MISSING REQUIRED FIELD";
LABEL_9:
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6103 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:v17];
    v18 = v57;
    goto LABEL_30;
  }

  entriesWhenTargeting = [v9 entriesWhenTargeting];
  v11 = entriesWhenTargeting == 0;

  if (v11)
  {
    v17 = @"no set-target entries provided in request | MISSING REQUIRED FIELD";
    goto LABEL_9;
  }

  clientDomainName = [v57 clientDomainName];
  assetSetIdentifier = [v57 assetSetIdentifier];
  v51 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  if (v51)
  {
    if ([(MADAutoAssetControlManager *)self setTargetPersistedMatchesClientSpecified:v57])
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [v57 summary];
        *buf = 138543618;
        v65 = _updateLatestSummary;
        v66 = 2114;
        v67 = summary;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@] {handleSetClientAssetSetForStagingRequest}\n[SET-TARGETS] client-specified set-target matches already-persisted | setInfoInstance:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      clientDomainName2 = [v57 clientDomainName];
      assetSetIdentifier2 = [v57 assetSetIdentifier];
      [(MADAutoAssetControlManager *)self removeSetTargetsForClientDomain:clientDomainName2 forSetIdentifier:assetSetIdentifier2 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

      [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
      entriesWhenTargeting2 = [v57 entriesWhenTargeting];
      [MADAutoAssetStager controlSetTargetsSpecified:entriesWhenTargeting2];

      v60 = 0u;
      v61 = 0u;
      v58 = 0u;
      v59 = 0u;
      obj = [v57 entriesWhenTargeting];
      v26 = [obj countByEnumeratingWithState:&v58 objects:v63 count:16];
      v14 = obj;
      if (v26)
      {
        v55 = *v59;
        do
        {
          v56 = v26;
          for (i = 0; i != v56; i = i + 1)
          {
            if (*v59 != v55)
            {
              objc_enumerationMutation(obj);
            }

            v28 = *(*(&v58 + 1) + 8 * i);
            v29 = objc_autoreleasePoolPush();
            if (v28)
            {
              clientDomainName3 = [v57 clientDomainName];
              assetSetIdentifier3 = [v57 assetSetIdentifier];
              v32 = [(MADAutoAssetControlManager *)self newSetTargetFromClientProvidedSetTarget:v28 forClientDomainName:clientDomainName3 forSetIdentifier:assetSetIdentifier3];

              clientDomainName4 = [v32 clientDomainName];
              assetSetIdentifier4 = [v32 assetSetIdentifier];
              v35 = [(MADAutoAssetControlManager *)self setTargetNewEntryIDForClientDomainName:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4 forClientProvidedSetTarget:v28];

              persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
              LODWORD(clientDomainName4) = [persistedSetTargets persistedEntryAlreadyExists:v35 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

              v37 = @"ENTRY_ADD";
              if (clientDomainName4)
              {
                autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                diag = [autoControlManagerFSM2 diag];
                v40 = [NSString alloc];
                summary2 = [v32 summary];
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v43 = [v40 initWithFormat:@"{handleSetClientAssetSetForStagingRequest} persisted-entry already exists when should have just been removed | setTarget:%@ | %@", summary2, _updateLatestSummary2];
                [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v43 withResult:6109 withError:0];

                v37 = @"ENTRY_MODIFY";
              }

              persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
              v45 = [persistedSetTargets2 persistedEntry:v35 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

              if (v45)
              {
                [v45 persistSecureCodedObject:v32 forKey:@"setTarget"];
                persistedSetTargets3 = [(MADAutoAssetControlManager *)self persistedSetTargets];
                summary3 = [v32 summary];
                [persistedSetTargets3 storePersistedEntry:v35 withEntrySummary:summary3 fromLocation:@"handleSetClientAssetSetForStagingRequest"];

                [(MADAutoAssetControlManager *)self _logPersistedSetTarget:@"handleSetClientAssetSetForStagingRequest" operation:v37 forPersistedEntryID:v35 withSetTarget:v32 message:@"new set-target"];
              }

              else
              {
                v48 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
                {
                  _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  summary4 = [v32 summary];
                  *buf = 138543618;
                  v65 = _updateLatestSummary3;
                  v66 = 2114;
                  v67 = summary4;
                  _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "[%{public}@] {handleSetClientAssetSetForStagingRequest} unable to load persisted-set-target file | setTarget:%{public}@", buf, 0x16u);
                }
              }
            }

            objc_autoreleasePoolPop(v29);
          }

          v26 = [obj countByEnumeratingWithState:&v58 objects:v63 count:16];
        }

        while (v26);
        v14 = obj;
      }
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:0 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:@"successfully defined asset-set-for-staging"];
  }

  else
  {
    v19 = [NSString alloc];
    clientDomainName5 = [v57 clientDomainName];
    assetSetIdentifier5 = [v57 assetSetIdentifier];
    v22 = [v19 initWithFormat:@"set-identifier (for given client-domain-name) is not currently defined | clientDomainName:%@ | assetSetIdentifier:%@", clientDomainName5, assetSetIdentifier5];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6558 fromAction:@"handleSetClientAssetSetForStagingRequest" withDescription:v22];
  }

  v18 = v57;
LABEL_30:

  os_activity_scope_leave(&state);
}

- (void)handleSetClientEliminateAtomicRequest:(id)request whenCancelingSetJob:(id)job forAutoJob:(id)autoJob
{
  requestCopy = request;
  jobCopy = job;
  autoJobCopy = autoJob;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:handleSetClientEliminateAtomicRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v33 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:@"handleSetClientEliminateAtomicRequest" withEventInfo:requestCopy];
  clientRequest = [requestCopy clientRequest];
  v31 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

  if (v33)
  {
    clientDomainName = [v33 clientDomainName];
    v13 = clientDomainName == 0;

    if (v13)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"instance missing client-domain-name when required for eliminate request"];
      clientDomainName2 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(clientDomainName2, OS_LOG_TYPE_ERROR))
      {
        summary = [requestCopy summary];
        *buf = 138543362;
        v42 = summary;
        _os_log_impl(&dword_0, clientDomainName2, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] instance missing client-domain-name when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
      }
    }

    else
    {
      assetSetIdentifier = [v33 assetSetIdentifier];
      v15 = assetSetIdentifier == 0;

      if (v15)
      {
        [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"instance missing asset-set-identifier when required for eliminate request"];
        clientDomainName2 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(clientDomainName2, OS_LOG_TYPE_ERROR))
        {
          summary2 = [requestCopy summary];
          *buf = 138543362;
          v42 = summary2;
          _os_log_impl(&dword_0, clientDomainName2, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] instance missing asset-set-identifier when required for eliminate request | eventInfo:%{public}@", buf, 0xCu);
        }
      }

      else
      {
        if (jobCopy)
        {
          queuedRequestsForNewJobOnceCanceled = [jobCopy queuedRequestsForNewJobOnceCanceled];
          v17 = queuedRequestsForNewJobOnceCanceled == 0;

          if (!v17)
          {
            v37 = 0u;
            v38 = 0u;
            v35 = 0u;
            v36 = 0u;
            queuedRequestsForNewJobOnceCanceled2 = [jobCopy queuedRequestsForNewJobOnceCanceled];
            v19 = [queuedRequestsForNewJobOnceCanceled2 countByEnumeratingWithState:&v35 objects:v40 count:16];
            if (v19)
            {
              v20 = *v36;
              do
              {
                for (i = 0; i != v19; i = i + 1)
                {
                  if (*v36 != v20)
                  {
                    objc_enumerationMutation(queuedRequestsForNewJobOnceCanceled2);
                  }

                  v22 = *(*(&v35 + 1) + 8 * i);
                  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v22 withErrorCode:6115 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"client-request that had been waiting for set-job to be canceled when set was eliminated"];
                  v23 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                  {
                    summary3 = [v22 summary];
                    *buf = 138543362;
                    v42 = summary3;
                    _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} failed client-request that had been waiting for cancel to complete when eliminated | dropEventInfo:%{public}@", buf, 0xCu);
                  }
                }

                v19 = [queuedRequestsForNewJobOnceCanceled2 countByEnumeratingWithState:&v35 objects:v40 count:16];
              }

              while (v19);
            }

            [jobCopy setQueuedRequestsForNewJobOnceCanceled:0];
          }
        }

        clientDomainName2 = [v33 clientDomainName];
        assetSetIdentifier2 = [v33 assetSetIdentifier];
        -[MADAutoAssetControlManager _eliminateAtomicTriggeredByClient:forClientDomainName:forAssetSetIdentifier:awaitingUnlocked:](self, "_eliminateAtomicTriggeredByClient:forClientDomainName:forAssetSetIdentifier:awaitingUnlocked:", requestCopy, clientDomainName2, assetSetIdentifier2, [v31 awaitDownloadingOfDiscovered]);
      }
    }
  }

  else
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:requestCopy withErrorCode:6102 fromAction:@"handleSetClientEliminateAtomicRequest" withDescription:@"no instance provided in client eliminate request"];
    clientDomainName2 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(clientDomainName2, OS_LOG_TYPE_ERROR))
    {
      summary4 = [requestCopy summary];
      *buf = 138543362;
      v42 = summary4;
      _os_log_impl(&dword_0, clientDomainName2, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{handleSetClientEliminateAtomicRequest} [MissingParameter] no instance provided in client eliminate request | eventInfo:%{public}@", buf, 0xCu);
    }
  }

  os_activity_scope_leave(&state);
}

- (void)_eliminateAtomicTriggeredWhileLoading:(id)loading forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  nameCopy = name;
  loadingCopy = loading;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self _eliminateForgetAtomicLostToVend:loadingCopy forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy];
  [(MADAutoAssetControlManager *)self setConfigurationEliminate:loadingCopy forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy];
}

- (void)_eliminateForgetAtomicLostToVend:(id)vend forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  vendCopy = vend;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v56 = vendCopy;
  vendCopy = [[NSString alloc] initWithFormat:@"%@:_eliminateForgetAtomicLostToVend", vendCopy];
  v14 = objc_alloc_init(NSMutableArray);
  v64 = nameCopy;
  v59 = identifierCopy;
  v15 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:nameCopy assetSetIdentifier:identifierCopy];
  v60 = vendCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:vendCopy ofContainer:@"setDescriptorKeysForAssetSet"];
  v79 = 0u;
  v80 = 0u;
  v77 = 0u;
  v78 = 0u;
  obj = v15;
  v16 = [obj countByEnumeratingWithState:&v77 objects:v84 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v78;
    do
    {
      for (i = 0; i != v17; i = i + 1)
      {
        if (*v78 != v18)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v77 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        v22 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v20];
        if (v22)
        {
          v23 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:v22];

          if (v23)
          {
            [(MADAutoAssetControlManager *)self _forceSetUngraftAndEliminateAllSetLocks:v60 forSetDescriptor:v22];
            [(MADAutoAssetControlManager *)self _shortTermForceForget:v60 forSetDescriptor:v22];
          }

          [v14 addObject:v22];
        }

        objc_autoreleasePoolPop(v21);
      }

      v17 = [obj countByEnumeratingWithState:&v77 objects:v84 count:16];
    }

    while (v17);
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  v62 = v14;
  v24 = [v62 countByEnumeratingWithState:&v73 objects:v83 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v74;
    do
    {
      for (j = 0; j != v25; j = j + 1)
      {
        if (*v74 != v26)
        {
          objc_enumerationMutation(v62);
        }

        v28 = *(*(&v73 + 1) + 8 * j);
        v29 = objc_autoreleasePoolPush();
        latestDownloadedAtomicInstance = [v28 latestDownloadedAtomicInstance];
        v31 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

        if (v31)
        {
          [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:v60 dueToError:0 forgettingAtomicInstance:v31];
        }

        else
        {
          [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v28 fromLocation:v60 checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:326 historyOperationSD:370];
          [(MADAutoAssetControlManager *)self _forceSetUngraftAndEliminateAllSetLocks:v60 forSetDescriptor:v28];
          [(MADAutoAssetControlManager *)self _shortTermForceForget:v60 forSetDescriptor:v28];
        }

        objc_autoreleasePoolPop(v29);
      }

      v25 = [v62 countByEnumeratingWithState:&v73 objects:v83 count:16];
    }

    while (v25);
  }

  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:v64 forSetIdentifier:v59];
  [(MADAutoAssetControlManager *)self atomicInstanceEliminate:v60 forClientDomainName:v64 forAssetSetIdentifier:v59];
  v57 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:v60 ofContainer:@"currentSetStatusByInstance"];
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  currentSetStatusByInstance = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
  v32 = [currentSetStatusByInstance countByEnumeratingWithState:&v69 objects:v82 count:16];
  if (v32)
  {
    v33 = v32;
    v34 = *v70;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    selfCopy = self;
    do
    {
      for (k = 0; k != v33; k = k + 1)
      {
        if (*v70 != v34)
        {
          objc_enumerationMutation(currentSetStatusByInstance);
        }

        v37 = *(*(&v69 + 1) + 8 * k);
        v38 = objc_autoreleasePoolPush();
        v39 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:v37];
        v40 = v39;
        if (v37)
        {
          v41 = p_weak_ivar_lyt[223];
          clientDomainName = [v39 clientDomainName];
          if ([v41 stringIsEqual:clientDomainName to:v64])
          {
            v43 = p_weak_ivar_lyt[223];
            [v40 assetSetIdentifier];
            v44 = v33;
            v45 = v34;
            v47 = v46 = p_weak_ivar_lyt;
            LODWORD(v43) = [v43 stringIsEqual:v47 to:v59];

            p_weak_ivar_lyt = v46;
            v34 = v45;
            v33 = v44;
            self = selfCopy;

            if (v43)
            {
              [v57 addObject:v37];
            }
          }

          else
          {
          }
        }

        objc_autoreleasePoolPop(v38);
      }

      v33 = [currentSetStatusByInstance countByEnumeratingWithState:&v69 objects:v82 count:16];
    }

    while (v33);
  }

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v48 = v57;
  v49 = [v48 countByEnumeratingWithState:&v65 objects:v81 count:16];
  if (v49)
  {
    v50 = v49;
    v51 = *v66;
    do
    {
      for (m = 0; m != v50; m = m + 1)
      {
        if (*v66 != v51)
        {
          objc_enumerationMutation(v48);
        }

        v53 = *(*(&v65 + 1) + 8 * m);
        v54 = objc_autoreleasePoolPush();
        currentSetStatusByInstance2 = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
        [currentSetStatusByInstance2 removeObjectForKey:v53];

        objc_autoreleasePoolPop(v54);
      }

      v50 = [v48 countByEnumeratingWithState:&v65 objects:v81 count:16];
    }

    while (v50);
  }
}

- (void)_eliminateAtomicTriggeredByClient:(id)client forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier awaitingUnlocked:(BOOL)unlocked
{
  unlockedCopy = unlocked;
  clientCopy = client;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14 = [[MAAutoAssetSelector alloc] initForAssetType:nameCopy withAssetSpecifier:identifierCopy];
  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  persistedEntryID = [v14 persistedEntryID];
  v17 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v17)
  {
    if (![v17 awaitingUnlocked] || unlockedCopy)
    {
      v18 = [NSString alloc];
      summary = [v14 summary];
      v20 = [v18 initWithFormat:@"eliminate-atomic when already eliminating (and not changing from soft to hard eliminate) | eliminateSelector:%@", summary];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:clientCopy withErrorCode:6114 fromAction:@"_eliminateAtomicTriggeredByClient" withDescription:v20];

      goto LABEL_9;
    }
  }

  else
  {
    v21 = [NSString alloc];
    v22 = @"N";
    if (unlockedCopy)
    {
      v22 = @"Y";
    }

    v23 = [v21 initWithFormat:@"_eliminateAtomicTriggeredByClient(awaitUnlocked:%@)", v22];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_ELIMINATED" forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy forAtomicInstanceUUID:0 fromModule:@"AUTO-CONTROL" fromLocation:v23];
  }

  [(MADAutoAssetControlManager *)self setDescriptorEliminate:@"_eliminateAtomicTriggeredByClient" triggeredByClient:clientCopy forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy awaitingUnlocked:unlockedCopy];
LABEL_9:
}

- (id)buildSetFoundResponseMessage:(id)message forClientRequest:(id)request withFoundSetDescriptor:(id)descriptor withSubAtomicInstance:(id)instance forLatestDownloaded:(BOOL)downloaded withInstance:(id)withInstance withDesire:(id)desire fromLocation:(id)self0
{
  messageCopy = message;
  requestCopy = request;
  withInstanceCopy = withInstance;
  desireCopy = desire;
  locationCopy = location;
  instanceCopy = instance;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v51 = objc_alloc_init(NSMutableDictionary);
  v21 = [(MADAutoAssetControlManager *)self clientRequestMessageName:requestCopy];
  v50 = requestCopy;
  if (([SUCore stringIsEqual:v21 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0)
  {
    v22 = 1;
  }

  else
  {
    v23 = [(MADAutoAssetControlManager *)self clientRequestMessageName:requestCopy];
    v22 = [SUCore stringIsEqual:v23 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];
  }

  clientDomainName = [withInstanceCopy clientDomainName];
  assetSetIdentifier = [withInstanceCopy assetSetIdentifier];
  atomicInstance = [withInstanceCopy atomicInstance];
  LOBYTE(v47) = v22;
  v27 = [(MADAutoAssetControlManager *)self buildReportedSetStatus:locationCopy forClientDomainName:clientDomainName forSetIdentifier:assetSetIdentifier forAtomicInstance:atomicInstance withFoundSetDescriptor:descriptorCopy withSubAtomicInstance:instanceCopy reportingLocalContentURLs:v47];

  if (!v27)
  {
    v30 = 0;
    v41 = messageCopy;
    v40 = v50;
LABEL_10:
    v42 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [v40 summary];
      if (v30)
      {
        summary2 = [v30 summary];
      }

      else
      {
        summary2 = @"N";
      }

      *buf = 138544386;
      v54 = _updateLatestSummary;
      v55 = 2114;
      v56 = locationCopy;
      v57 = 2114;
      v58 = v41;
      v59 = 2114;
      v60 = summary;
      v61 = 2114;
      v62 = summary2;
      _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:buildSetFoundResponseMessage} unable to build response for %{public}@ request | clientRequest:%{public}@ | found:%{public}@", buf, 0x34u);
      if (v30)
      {
      }
    }

    v39 = 0;
    v33 = desireCopy;
    goto LABEL_18;
  }

  v28 = [MANAutoAssetSetInfoFound alloc];
  assetSetIdentifier2 = [v27 assetSetIdentifier];
  v30 = [(MANAutoAssetSetInfoFound *)v28 initForAssetSetIdentifier:assetSetIdentifier2 reportingStatus:v27];

  v31 = [MASAutoAssetSetInfoInstance newShimmedToFramework:withInstanceCopy];
  [v51 setSafeObject:v31 forKey:@"setInstance"];

  v32 = [MASAutoAssetSetInfoFound newShimmedToFramework:v30];
  [v51 setSafeObject:v32 forKey:@"setFound"];

  v33 = desireCopy;
  if (desireCopy)
  {
    v34 = [MASAutoAssetSetInfoDesire newShimmedToFramework:desireCopy];
    [v51 setSafeObject:v34 forKey:@"setDesire"];
  }

  v35 = [SUCoreConnectMessage alloc];
  clientRequestMessage = [v50 clientRequestMessage];
  v37 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientID = [v50 clientID];
  v39 = [v35 initWithType:2 messageName:v37 clientID:clientID version:0 message:v51];

  v40 = v50;
  v41 = messageCopy;
  if (!v39)
  {
    goto LABEL_10;
  }

LABEL_18:

  return v39;
}

- (id)buildReportedSetStatus:(id)status forClientDomainName:(id)name forSetIdentifier:(id)identifier forAtomicInstance:(id)instance withFoundSetDescriptor:(id)descriptor withSubAtomicInstance:(id)atomicInstance reportingLocalContentURLs:(BOOL)ls
{
  statusCopy = status;
  nameCopy = name;
  identifierCopy = identifier;
  descriptorCopy = descriptor;
  atomicInstanceCopy = atomicInstance;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v22 = [(MADAutoAssetControlManager *)self locateSetStatusPreferringByInstance:instanceCopy elseByClientDomain:0 forAssetSetIdentifier:0 fromLocation:statusCopy];

  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v131 = nameCopy;
  v24 = nameCopy;
  v25 = identifierCopy;
  v132 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v24 forAssetSetIdentifier:identifierCopy];
  v26 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:descriptorCopy];
  LODWORD(instanceCopy) = [MADAutoAssetSecure doesSetDescriptorInvolveSecureOperations:statusCopy forSetDescriptor:descriptorCopy withAutoAssetDescriptors:v26];

  if (instanceCopy)
  {
    v133[0] = 0;
    v27 = [MADAutoAssetSecure latestDownloadedAtomicInstanceEntries:statusCopy forSetDescriptor:descriptorCopy withAvailableForUseError:v133];
    v28 = v133[0];

    latestDowloadedAtomicInstanceEntries = v27;
  }

  else
  {
    v28 = 0;
  }

  availableForUseError = [v132 availableForUseError];
  v30 = [(MADAutoAssetControlManager *)self statusErrorConsideredMatch:v28 to:availableForUseError];

  if ((v30 & 1) == 0)
  {
    if (v28)
    {
      if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v28])
      {
        [(MADAutoAssetControlManager *)self forceGlobalSetUnlock:statusCopy dueToError:v28 ofSetDescriptor:descriptorCopy historyOperationAI:1503 historyOperationSD:394];
      }

      availableForUseError2 = [v132 availableForUseError];

      if (availableForUseError2)
      {
        v32 = 9999;
      }

      else
      {
        v32 = 460;
      }

      [v132 setAvailableForUseError:v28];
      v33 = @"reporting set-status when attempt to form all localConentURLs failed to access all secure asset-versions";
      selfCopy2 = self;
      v35 = v132;
      v36 = statusCopy;
      v37 = v32;
    }

    else
    {
      [v132 setAvailableForUseError:0];
      v33 = @"reporting set-status when attempt to form all localConentURLs gained access all secure asset-versions";
      selfCopy2 = self;
      v35 = v132;
      v36 = statusCopy;
      v37 = 461;
    }

    [(MADAutoAssetControlManager *)selfCopy2 setConfigurationPersist:v35 fromLocation:v36 forReason:v33 dueToAlter:0 forHistoryOperation:v37];
  }

  v106 = v28;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v39 = v25;
  v109 = descriptorCopy;
  v108 = latestDowloadedAtomicInstanceEntries;
  v110 = v25;
  if (v22 || ([descriptorCopy latestDownloadedAtomicInstance], v40 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:](self, "locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:", v40, 0, 0, statusCopy), v22 = objc_claimAutoreleasedReturnValue(), v40, v22) || (objc_msgSend(descriptorCopy, "discoveredAtomicInstance"), v41 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:](self, "locateSetStatusPreferringByInstance:elseByClientDomain:forAssetSetIdentifier:fromLocation:", v41, 0, 0, statusCopy), v22 = objc_claimAutoreleasedReturnValue(), v41, v22))
  {
    if (descriptorCopy)
    {
      currentNotifications = [v22 currentNotifications];
      [currentNotifications setAtomicInstanceDiscovered:1];

      currentNotifications2 = [v22 currentNotifications];
      [currentNotifications2 setAtomicInstanceAvailableForUse:1];

      atomicInstancesDownloaded = [v22 atomicInstancesDownloaded];

      if (!atomicInstancesDownloaded)
      {
        v45 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDArrayForSetDescriptor:descriptorCopy];
        [v22 setAtomicInstancesDownloaded:v45];
      }

      latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
      [v22 setLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance];

      [v22 setLatestDowloadedAtomicInstanceEntries:latestDowloadedAtomicInstanceEntries];
    }

    availableForUseError3 = [v132 availableForUseError];
    [v22 setAvailableForUseError:availableForUseError3];

    newerVersionError = [v132 newerVersionError];
    [v22 setNewerVersionError:newerVersionError];

    catalogCachedAssetSetID = [v22 catalogCachedAssetSetID];

    if (!catalogCachedAssetSetID)
    {
      catalogCachedAssetSetID2 = [descriptorCopy catalogCachedAssetSetID];
      [v22 setCatalogCachedAssetSetID:catalogCachedAssetSetID2];

      catalogDownloadedFromLive = [descriptorCopy catalogDownloadedFromLive];
      [v22 setCatalogDownloadedFromLive:catalogDownloadedFromLive];

      catalogLastTimeChecked = [descriptorCopy catalogLastTimeChecked];
      [v22 setCatalogLastTimeChecked:catalogLastTimeChecked];

      catalogPostedDate = [descriptorCopy catalogPostedDate];
      [v22 setCatalogPostedDate:catalogPostedDate];
    }

    downloadedCatalogCachedAssetSetID = [v22 downloadedCatalogCachedAssetSetID];

    if (!downloadedCatalogCachedAssetSetID)
    {
      downloadedCatalogCachedAssetSetID2 = [descriptorCopy downloadedCatalogCachedAssetSetID];
      [v22 setDownloadedCatalogCachedAssetSetID:downloadedCatalogCachedAssetSetID2];

      downloadedCatalogDownloadedFromLive = [descriptorCopy downloadedCatalogDownloadedFromLive];
      [v22 setDownloadedCatalogDownloadedFromLive:downloadedCatalogDownloadedFromLive];

      downloadedCatalogLastTimeChecked = [descriptorCopy downloadedCatalogLastTimeChecked];
      [v22 setDownloadedCatalogLastTimeChecked:downloadedCatalogLastTimeChecked];

      downloadedCatalogPostedDate = [descriptorCopy downloadedCatalogPostedDate];
      [v22 setDownloadedCatalogPostedDate:downloadedCatalogPostedDate];
    }

    [(MADAutoAssetControlManager *)self _updateCurrentSetStatus:@"FOUND_SET_STATUS" forSetIdentifier:v25 withSetStatus:v22];
  }

  else
  {
    discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];
    v72 = objc_alloc_init(MANAutoAssetSetNotifications);
    if (!discoveredAtomicInstance)
    {
      discoveredAtomicInstance = atomicInstanceCopy;
    }

    v130 = discoveredAtomicInstance;
    [(MANAutoAssetSetNotifications *)v72 setAtomicInstanceDiscovered:1];
    [(MANAutoAssetSetNotifications *)v72 setAtomicInstanceAvailableForUse:1];
    v105 = [MANAutoAssetSetStatus alloc];
    v128 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:descriptorCopy];
    v126 = [(MADAutoAssetControlManager *)self atomicInstanceUUIDArrayForSetDescriptor:descriptorCopy];
    mostRecentlyReceivedCachedAssetSetID = [v132 mostRecentlyReceivedCachedAssetSetID];
    mostRecentlyReceivedDownloadedFromLive = [v132 mostRecentlyReceivedDownloadedFromLive];
    mostRecentlyReceivedLastTimeChecked = [v132 mostRecentlyReceivedLastTimeChecked];
    mostRecentlyReceivedPostedDate = [v132 mostRecentlyReceivedPostedDate];
    discoveredAtomicEntries = [descriptorCopy discoveredAtomicEntries];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    latestAtomicInstanceToVendFromPreSUStaging = [v132 latestAtomicInstanceToVendFromPreSUStaging];
    latestToVendCachedAssetSetID = [v132 latestToVendCachedAssetSetID];
    latestToVendDownloadedFromLive = [v132 latestToVendDownloadedFromLive];
    latestToVendLastTimeChecked = [v132 latestToVendLastTimeChecked];
    latestToVendPostedDate = [v132 latestToVendPostedDate];
    v101 = v72;
    v93 = [MADAutoAssetScheduler newSetPolicyForDomainName:v131 forAssetSetIdentifier:v25];
    v73 = +[MADAutoAssetControlManager stagerSetPolicy];
    haveReceivedLookupResponse = [v132 haveReceivedLookupResponse];
    vendingAtomicInstanceForConfiguredEntries = [v132 vendingAtomicInstanceForConfiguredEntries];
    [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:descriptorCopy];
    v76 = v103 = self;
    availableForUseError4 = [v132 availableForUseError];
    newerVersionError2 = [v132 newerVersionError];
    BYTE2(v80) = 0;
    BYTE1(v80) = vendingAtomicInstanceForConfiguredEntries;
    LOBYTE(v80) = haveReceivedLookupResponse;
    LOBYTE(v79) = latestAtomicInstanceToVendFromPreSUStaging;
    v22 = [MANAutoAssetSetStatus initStatusForClientDomain:v105 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v131 withAtomicInstancesDownloaded:v25 withCatalogCachedAssetSetID:v128 withCatalogDownloadedFromLive:v126 withCatalogLastTimeChecked:mostRecentlyReceivedCachedAssetSetID withCatalogPostedDate:mostRecentlyReceivedDownloadedFromLive withNewerAtomicInstanceDiscovered:mostRecentlyReceivedLastTimeChecked withNewerDiscoveredAtomicEntries:mostRecentlyReceivedPostedDate withLatestDownloadedAtomicInstance:v130 withLatestDownloadedAtomicInstanceFromPreSUStaging:discoveredAtomicEntries withLatestDowloadedAtomicInstanceEntries:latestDownloadedAtomicInstance2 withDownloadedCatalogCachedAssetSetID:v79 withDownloadedCatalogDownloadedFromLive:v108 withDownloadedCatalogLastTimeChecked:latestToVendCachedAssetSetID withDownloadedCatalogPostedDate:latestToVendDownloadedFromLive withCurrentNotifications:latestToVendLastTimeChecked withCurrentNeedPolicy:latestToVendPostedDate withSchedulerPolicy:v72 withStagerPolicy:0 havingReceivedLookupResponse:v93 vendingAtomicInstanceForConfiguredEntries:v73 withDownloadUserInitiated:v80 withDownloadProgress:0 withDownloadedNetworkBytes:0 withDownloadedFilesystemBytes:0 withCurrentLockUsage:v76 withSelectorsForStaging:0 withAvailableForUseError:availableForUseError4 withNewerVersionError:newerVersionError2];

    self = v103;
    descriptorCopy = v109;

    v39 = v25;
    latestDowloadedAtomicInstanceEntries = v108;

    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    if (!v22)
    {
      v68 = 0;
      v69 = 0;
      v67 = v106;
      goto LABEL_34;
    }
  }

  if (ls)
  {
    v59 = latestDowloadedAtomicInstanceEntries;
  }

  else
  {
    v59 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:latestDowloadedAtomicInstanceEntries];
  }

  v129 = v59;
  v99 = objc_alloc(p_weak_ivar_lyt[344]);
  v127 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:descriptorCopy];
  atomicInstancesDownloaded2 = [v22 atomicInstancesDownloaded];
  mostRecentlyReceivedCachedAssetSetID2 = [v132 mostRecentlyReceivedCachedAssetSetID];
  mostRecentlyReceivedDownloadedFromLive2 = [v132 mostRecentlyReceivedDownloadedFromLive];
  mostRecentlyReceivedLastTimeChecked2 = [v132 mostRecentlyReceivedLastTimeChecked];
  mostRecentlyReceivedPostedDate2 = [v132 mostRecentlyReceivedPostedDate];
  newerAtomicInstanceDiscovered = [v22 newerAtomicInstanceDiscovered];
  newerDiscoveredAtomicEntries = [v22 newerDiscoveredAtomicEntries];
  v115 = newerDiscoveredAtomicEntries;
  if (!ls)
  {
    v115 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:newerDiscoveredAtomicEntries];
  }

  v102 = newerDiscoveredAtomicEntries;
  latestDownloadedAtomicInstance3 = [v22 latestDownloadedAtomicInstance];
  latestAtomicInstanceToVendFromPreSUStaging2 = [v132 latestAtomicInstanceToVendFromPreSUStaging];
  latestToVendCachedAssetSetID2 = [v132 latestToVendCachedAssetSetID];
  latestToVendDownloadedFromLive2 = [v132 latestToVendDownloadedFromLive];
  latestToVendLastTimeChecked2 = [v132 latestToVendLastTimeChecked];
  latestToVendPostedDate2 = [v132 latestToVendPostedDate];
  currentNotifications3 = [v22 currentNotifications];
  currentNeedPolicy = [v22 currentNeedPolicy];
  v87 = [MADAutoAssetScheduler newSetPolicyForDomainName:v131 forAssetSetIdentifier:v39];
  v84 = +[MADAutoAssetControlManager stagerSetPolicy];
  haveReceivedLookupResponse2 = [v132 haveReceivedLookupResponse];
  vendingAtomicInstanceForConfiguredEntries2 = [v132 vendingAtomicInstanceForConfiguredEntries];
  downloadUserInitiated = [v22 downloadUserInitiated];
  downloadProgress = [v22 downloadProgress];
  downloadedNetworkBytes = [v22 downloadedNetworkBytes];
  downloadedFilesystemBytes = [v22 downloadedFilesystemBytes];
  v81 = [(MADAutoAssetControlManager *)self setLockUsageMapForSetDescriptor:descriptorCopy];
  [v22 selectorsForStaging];
  v64 = v63 = v39;
  availableForUseError5 = [v132 availableForUseError];
  newerVersionError3 = [v132 newerVersionError];
  BYTE2(v80) = downloadUserInitiated;
  BYTE1(v80) = vendingAtomicInstanceForConfiguredEntries2;
  LOBYTE(v80) = haveReceivedLookupResponse2;
  LOBYTE(v79) = latestAtomicInstanceToVendFromPreSUStaging2;
  v100 = [v99 initStatusForClientDomain:v131 forAssetSetIdentifier:v63 withConfiguredAssetEntries:v127 withAtomicInstancesDownloaded:atomicInstancesDownloaded2 withCatalogCachedAssetSetID:mostRecentlyReceivedCachedAssetSetID2 withCatalogDownloadedFromLive:mostRecentlyReceivedDownloadedFromLive2 withCatalogLastTimeChecked:mostRecentlyReceivedLastTimeChecked2 withCatalogPostedDate:mostRecentlyReceivedPostedDate2 withNewerAtomicInstanceDiscovered:newerAtomicInstanceDiscovered withNewerDiscoveredAtomicEntries:v115 withLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance3 withLatestDownloadedAtomicInstanceFromPreSUStaging:v79 withLatestDowloadedAtomicInstanceEntries:v129 withDownloadedCatalogCachedAssetSetID:latestToVendCachedAssetSetID2 withDownloadedCatalogDownloadedFromLive:latestToVendDownloadedFromLive2 withDownloadedCatalogLastTimeChecked:latestToVendLastTimeChecked2 withDownloadedCatalogPostedDate:latestToVendPostedDate2 withCurrentNotifications:currentNotifications3 withCurrentNeedPolicy:currentNeedPolicy withSchedulerPolicy:v87 withStagerPolicy:v84 havingReceivedLookupResponse:v80 vendingAtomicInstanceForConfiguredEntries:downloadProgress withDownloadUserInitiated:downloadedNetworkBytes withDownloadProgress:downloadedFilesystemBytes withDownloadedNetworkBytes:v81 withDownloadedFilesystemBytes:v64 withCurrentLockUsage:availableForUseError5 withSelectorsForStaging:newerVersionError3 withAvailableForUseError:? withNewerVersionError:?];

  if (!ls)
  {
  }

  v39 = v110;
  latestDowloadedAtomicInstanceEntries = v108;
  descriptorCopy = v109;
  v67 = v106;
  v68 = v22;
  v69 = v100;
LABEL_34:

  return v69;
}

- (id)setJobInstanceKeyFromSetDescriptor:(id)descriptor forLatestDownloaded:(BOOL)downloaded
{
  downloadedCopy = downloaded;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  assetSetIdentifier = [descriptorCopy assetSetIdentifier];

  if (assetSetIdentifier)
  {
    if (downloadedCopy)
    {
      latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

      if (latestDownloadedAtomicInstance)
      {
        v11 = [NSString alloc];
        assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
        latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
LABEL_9:
        v19 = latestDownloadedAtomicInstance2;
        v20 = [v11 initWithFormat:@"%@_%@", assetSetIdentifier2, latestDownloadedAtomicInstance2];

        goto LABEL_16;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [descriptorCopy summary];
        *buf = 138543618;
        v23 = _updateLatestSummary;
        v24 = 2114;
        v25 = summary;
        v17 = "[%{public}@] {setJobInstanceKey} no latestDownloadedAtomicInstance | autoSetDescriptor:%{public}@";
        goto LABEL_14;
      }
    }

    else
    {
      discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];

      if (discoveredAtomicInstance)
      {
        v11 = [NSString alloc];
        assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
        latestDownloadedAtomicInstance2 = [descriptorCopy discoveredAtomicInstance];
        goto LABEL_9;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [descriptorCopy summary];
        *buf = 138543618;
        v23 = _updateLatestSummary;
        v24 = 2114;
        v25 = summary;
        v17 = "[%{public}@] {setJobInstanceKey} no newerAtomicInstanceDiscovered | autoSetDescriptor:%{public}@";
        goto LABEL_14;
      }
    }
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [descriptorCopy summary];
      *buf = 138543618;
      v23 = _updateLatestSummary;
      v24 = 2114;
      v25 = summary;
      v17 = "[%{public}@] {setJobInstanceKey} no assetSetIdentifier | autoSetDescriptor:%{public}@";
LABEL_14:
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, v17, buf, 0x16u);
    }
  }

  v20 = 0;
LABEL_16:

  return v20;
}

- (id)setJobInstanceKeyFromSetStatus:(id)status forLatestDownloaded:(BOOL)downloaded
{
  downloadedCopy = downloaded;
  statusCopy = status;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  assetSetIdentifier = [statusCopy assetSetIdentifier];

  if (assetSetIdentifier)
  {
    if (downloadedCopy)
    {
      latestDownloadedAtomicInstance = [statusCopy latestDownloadedAtomicInstance];

      if (latestDownloadedAtomicInstance)
      {
        v11 = [NSString alloc];
        assetSetIdentifier2 = [statusCopy assetSetIdentifier];
        latestDownloadedAtomicInstance2 = [statusCopy latestDownloadedAtomicInstance];
LABEL_9:
        v19 = latestDownloadedAtomicInstance2;
        v20 = [v11 initWithFormat:@"%@_%@", assetSetIdentifier2, latestDownloadedAtomicInstance2];

        goto LABEL_16;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [statusCopy summary];
        *buf = 138543618;
        v23 = _updateLatestSummary;
        v24 = 2114;
        v25 = summary;
        v17 = "[%{public}@] {setJobInstanceKey} no latestDownloadedAtomicInstance | autoSetStatus:%{public}@";
        goto LABEL_14;
      }
    }

    else
    {
      newerAtomicInstanceDiscovered = [statusCopy newerAtomicInstanceDiscovered];

      if (newerAtomicInstanceDiscovered)
      {
        v11 = [NSString alloc];
        assetSetIdentifier2 = [statusCopy assetSetIdentifier];
        latestDownloadedAtomicInstance2 = [statusCopy newerAtomicInstanceDiscovered];
        goto LABEL_9;
      }

      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [statusCopy summary];
        *buf = 138543618;
        v23 = _updateLatestSummary;
        v24 = 2114;
        v25 = summary;
        v17 = "[%{public}@] {setJobInstanceKey} no newerAtomicInstanceDiscovered | autoSetStatus:%{public}@";
        goto LABEL_14;
      }
    }
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [statusCopy summary];
      *buf = 138543618;
      v23 = _updateLatestSummary;
      v24 = 2114;
      v25 = summary;
      v17 = "[%{public}@] {setJobInstanceKey} no assetSetIdentifier | autoSetStatus:%{public}@";
LABEL_14:
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, v17, buf, 0x16u);
    }
  }

  v20 = 0;
LABEL_16:

  return v20;
}

- (id)setJobInstanceKeyForSetInstance:(id)instance
{
  instanceCopy = instance;
  assetSetIdentifier = [instanceCopy assetSetIdentifier];

  if (assetSetIdentifier)
  {
    atomicInstance = [instanceCopy atomicInstance];

    if (atomicInstance)
    {
      v7 = [NSString alloc];
      assetSetIdentifier2 = [instanceCopy assetSetIdentifier];
      atomicInstance2 = [instanceCopy atomicInstance];
      assetSetIdentifier3 = [v7 initWithFormat:@"%@_%@", assetSetIdentifier2, atomicInstance2];
    }

    else
    {
      assetSetIdentifier3 = [instanceCopy assetSetIdentifier];
    }
  }

  else
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [instanceCopy summary];
      *buf = 138543618;
      v16 = _updateLatestSummary;
      v17 = 2114;
      v18 = summary;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[%{public}@] {setJobInstanceKeyForSetInstance} no assetSetIdentifier | setInstance:%{public}@", buf, 0x16u);
    }

    assetSetIdentifier3 = 0;
  }

  return assetSetIdentifier3;
}

- (id)_alreadyDownloadedDescriptorsArray:(id)array limitingToSupportingStaging:(BOOL)staging
{
  stagingCopy = staging;
  arrayCopy = array;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9 = objc_alloc_init(NSMutableArray);
  v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorLimitedToStaging:stagingCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:arrayCopy ofContainer:@"downloadedDescriptorsBySelector"];
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v11 = v10;
  v12 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v21;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v21 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v20 + 1) + 8 * i);
        v17 = objc_autoreleasePoolPush();
        v18 = [v11 safeObjectForKey:v16 ofClass:{objc_opt_class(), v20}];
        if (v18)
        {
          [v9 addObject:v18];
        }

        objc_autoreleasePoolPop(v17);
      }

      v13 = [v11 countByEnumeratingWithState:&v20 objects:v24 count:16];
    }

    while (v13);
  }

  return v9;
}

- (void)ensureStagerFullyResumed
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self stagerResumePostponed])
  {
    [(MADAutoAssetControlManager *)self setStagerResumePostponed:0];

    +[MADAutoAssetStager finishSuspendedResumeFromPersisted];
  }
}

- (BOOL)isNoWaitRequestInvolvingSecureAsset:(id)asset
{
  assetCopy = asset;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:assetCopy];
  clientRequest = [assetCopy clientRequest];

  clientRequestMessage = [clientRequest clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  if (v7 && ([v7 clientAssetSelector], (v11 = objc_claimAutoreleasedReturnValue()) != 0))
  {
    v12 = v11;
    if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"])
    {

      goto LABEL_7;
    }

    v13 = [SUCore stringIsEqual:messageName to:@"MA-AUTO:LOCK_CONTENT"];

    if (v13)
    {
LABEL_7:
      clientRequestMessage2 = [clientRequest clientRequestMessage];
      v15 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage2];

      if (v15)
      {
        if ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"])
        {
          if (![v15 checkWaitTimeoutSecs])
          {
            goto LABEL_15;
          }
        }

        else if (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO:LOCK_CONTENT") && (![v15 checkWaitTimeoutSecs] || !objc_msgSend(v15, "lockWaitTimeoutSecs")))
        {
LABEL_15:
          clientAssetSelector = [v7 clientAssetSelector];
          assetVersion = [clientAssetSelector assetVersion];

          clientAssetSelector2 = [v7 clientAssetSelector];
          v19 = clientAssetSelector2;
          if (assetVersion)
          {
            v20 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:clientAssetSelector2];
          }

          else
          {
            assetType = [clientAssetSelector2 assetType];
            clientAssetSelector3 = [v7 clientAssetSelector];
            assetSpecifier = [clientAssetSelector3 assetSpecifier];
            v20 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"isNoWaitRequestInvolvingSecureAsset" forAssetType:assetType withAssetSpecifier:assetSpecifier];
          }

          if (v20 && [MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"isNoWaitRequestInvolvingSecureAsset" forDescriptor:v20])
          {
            LOBYTE(v13) = [MADAutoAssetSecure isSecureAsset:@"isNoWaitRequestInvolvingSecureAsset" forDescriptor:v20];
          }

          else
          {
            LOBYTE(v13) = 0;
          }

          goto LABEL_23;
        }
      }

      LOBYTE(v13) = 0;
LABEL_23:
    }
  }

  else
  {
    LOBYTE(v13) = 0;
  }

  return v13;
}

- (void)securePersonalizeGraftLockSet:(id)set lockingSetDescriptor:(id)descriptor forEventInfo:(id)info fallingBackToSetDescriptor:(id)setDescriptor fromPreSUStaging:(BOOL)staging
{
  stagingCopy = staging;
  setCopy = set;
  infoCopy = info;
  setDescriptorCopy = setDescriptor;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v22[0] = _NSConcreteStackBlock;
  v22[1] = 3221225472;
  v22[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_fallingBackToSetDescriptor_fromPreSUStaging___block_invoke;
  v22[3] = &unk_4B4828;
  v18 = setDescriptorCopy == 0;
  v23 = setDescriptorCopy;
  selfCopy = self;
  v25 = setCopy;
  v26 = infoCopy;
  v27 = stagingCopy;
  v19 = infoCopy;
  v20 = setCopy;
  v21 = setDescriptorCopy;
  [(MADAutoAssetControlManager *)self securePersonalizeGraftLockSet:v20 lockingSetDescriptor:descriptorCopy forEventInfo:v19 replyingOnError:v18 fromPreSUStaging:stagingCopy completion:v22];
}

unsigned __int8 *__138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_fallingBackToSetDescriptor_fromPreSUStaging___block_invoke(unsigned __int8 *result, uint64_t a2)
{
  if (a2)
  {
    v2 = *(result + 4);
    if (v2)
    {
      return [*(result + 5) securePersonalizeGraftLockSet:*(result + 6) lockingSetDescriptor:v2 forEventInfo:*(result + 7) replyingOnError:1 fromPreSUStaging:result[64] completion:&__block_literal_global_4144];
    }
  }

  return result;
}

- (void)securePersonalizeGraftLockSet:(id)set lockingSetDescriptor:(id)descriptor forEventInfo:(id)info replyingOnError:(BOOL)error fromPreSUStaging:(BOOL)staging completion:(id)completion
{
  stagingCopy = staging;
  errorCopy = error;
  setCopy = set;
  descriptorCopy = descriptor;
  infoCopy = info;
  completionCopy = completion;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  setCopy = [[NSString alloc] initWithFormat:@"%@:securePersonalizeGraftLockSet", setCopy];
  setJobInformation = [infoCopy setJobInformation];
  clientInstance = [setJobInformation clientInstance];
  clientDesire = [setJobInformation clientDesire];
  v21 = clientDesire;
  if (clientInstance)
  {
    if (clientDesire)
    {
      goto LABEL_3;
    }
  }

  else
  {
    clientInstance = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:setCopy withEventInfo:infoCopy];
    if (v21)
    {
      goto LABEL_3;
    }
  }

  clientRequest = [infoCopy clientRequest];
  v21 = [(MADAutoAssetControlManager *)self clientRequestMessageSetDesire:clientRequest];

LABEL_3:
  v85 = v21;
  v86 = clientInstance;
  v83 = setCopy;
  v84 = completionCopy;
  v87 = descriptorCopy;
  if ([descriptorCopy secureOperationInProgress])
  {
    v22 = [NSString alloc];
    summary = [descriptorCopy summary];
    v24 = [v22 initWithFormat:@"encountered set-descriptor with already in-progress secure-operation | setDescriptor:%@", summary];
    [MAAutoAssetError buildError:6532 fromOperation:setCopy underlyingError:0 withDescription:v24];
    v26 = v25 = descriptorCopy;

    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v29 = [NSString alloc];
    summary2 = [v25 summary];
    v31 = [v29 initWithFormat:@"{%@:securePersonalizeGraftLockSet} already in-progress secure-operation | setDescriptor:%@", setCopy, summary2];
    [diag trackAnomaly:@"AUTO-SECURE" forReason:v31 withResult:6532 withError:v26];

    if (errorCopy)
    {
      clientDomainName = [v86 clientDomainName];
      assetSetIdentifier = [infoCopy assetSetIdentifier];
      clientRequest2 = [infoCopy clientRequest];
      responseMessage = [clientRequest2 responseMessage];
      [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:setCopy forClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier forJobResponse:responseMessage withResponseError:0 clearingDownloadProgressReason:@"reached [secure operation] lock phase" withAssetSetStatus:0];
      v36 = v79 = setJobInformation;

      [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:infoCopy issuingResponseMessage:v36 withResponseError:v26 fromLocation:setCopy];
      v37 = [[NSString alloc] initWithFormat:@"%@ (secure operation already in progress)", setCopy];
      [(MADAutoAssetControlManager *)self decrementClientRequestCount:v37 forEventInfo:infoCopy];

      setJobInformation = v79;
    }

    v38 = v84;
    (v84)[2](v84, v26);

    v40 = v86;
    v39 = v87;
    v41 = setCopy;
    goto LABEL_39;
  }

  v80 = setJobInformation;
  v77 = infoCopy;
  v101 = 0u;
  v102 = 0u;
  v99 = 0u;
  v100 = 0u;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v43 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v99 objects:v103 count:16];
  if (v43)
  {
    v44 = v43;
    v45 = 0;
    v46 = 0;
    v47 = *v100;
    do
    {
      for (i = 0; i != v44; i = i + 1)
      {
        if (*v100 != v47)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        fullAssetSelector = [*(*(&v99 + 1) + 8 * i) fullAssetSelector];
        v50 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

        v41 = setCopy;
        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:setCopy forDescriptor:v50])
        {
          if ([MADAutoAssetSecure isPersonalizationRequired:setCopy forDescriptor:v50])
          {
            [v50 setSecureOperationInProgress:1];
            [v87 setSecureOperationInProgress:1];
            ++v46;
          }

          if ([MADAutoAssetSecure doesDescriptorInvolveGrafting:setCopy forDescriptor:v50])
          {
            [v50 setSecureOperationInProgress:1];
            [v87 setSecureOperationInProgress:1];
            ++v45;
          }
        }
      }

      v44 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v99 objects:v103 count:16];
    }

    while (v44);
  }

  else
  {
    v45 = 0;
    v46 = 0;
    v41 = setCopy;
  }

  if (v46 <= 0 && v45 < 1)
  {
    infoCopy = v77;
    clientReplyCompletion = [v77 clientReplyCompletion];
    selfCopy2 = self;
    v39 = v87;
    v54 = [(MADAutoAssetControlManager *)self notifyLockerAsIndicatedBySetJob:v41 withSetInstance:v86 withSetDesire:v85 forSetDescriptor:v87 withClientReplyCompletion:clientReplyCompletion];

    if (v54)
    {
      v38 = v84;
      if (!errorCopy)
      {
LABEL_38:
        (v38)[2](v38, v54);

        v40 = v86;
        goto LABEL_39;
      }

      clientRequest3 = [v77 clientRequest];
      clientRequestMessage = [clientRequest3 clientRequestMessage];
      v56 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
      clientRequest4 = [v77 clientRequest];
      clientRequestMessage2 = [clientRequest4 clientRequestMessage];
      [clientRequestMessage2 clientID];
      v60 = v59 = v54;
      v61 = [MADAutoAssetControlManager createSeverMessageWithName:v56 sender:@"com.apple.MAAutoControl" clientID:v60 response:0 error:v59];

      v38 = v84;
      setJobInformation = v80;

      v41 = setCopy;
      clientRequest5 = [v77 clientRequest];
      selfCopy2 = self;
      selfCopy3 = self;
      v64 = v59;
      v65 = v59;
      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      [(MADAutoAssetControlManager *)selfCopy3 issueResponseToClientRequest:clientRequest5 issuingResponseMessage:v61 withResponseError:v65];

      v67 = @"%@ (no secure operation required [reply-on-error])";
    }

    else
    {
      v64 = 0;
      clientRequest6 = [v77 clientRequest];
      v61 = [(MADAutoAssetControlManager *)selfCopy2 buildSetFoundResponseMessage:@"[AUTO-PERSONALIZATION] lockAtomic(SUCCESS)" forClientRequest:clientRequest6 withFoundSetDescriptor:v87 withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:v86 withDesire:v85 fromLocation:v41];

      atomicInstance = [v86 atomicInstance];

      v38 = v84;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      if (!atomicInstance)
      {
        clientDomainName2 = [v87 clientDomainName];
        assetSetIdentifier2 = [v87 assetSetIdentifier];
        v75 = [(MADAutoAssetControlManager *)selfCopy2 locateSetConfigurationByClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

        [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAdoptLatestToVend:setCopy fromSetDescriptor:v87 toSetConfiguration:v75 fromPreSUStaging:stagingCopy allowEmpty:0];
        setJobInformation = v80;
      }

      v41 = setCopy;
      [(MADAutoAssetControlManager *)selfCopy2 issueBuiltResponseForEventInfo:v77 issuingResponseMessage:v61 withResponseError:0 fromLocation:setCopy];
      v67 = @"%@ (no secure operation required [SUCCESS])";
    }

    v76 = [objc_alloc(p_weak_ivar_lyt[226]) initWithFormat:v67, v41];
    [(MADAutoAssetControlManager *)selfCopy2 decrementClientRequestCount:v76 forEventInfo:v77];

    v54 = v64;
    goto LABEL_38;
  }

  v68 = @"AUTO-PERSONALIZATION-GRAFT";
  if (v45 < 1)
  {
    v68 = @"AUTO-PERSONALIZATION";
  }

  if (v46 >= 1)
  {
    v69 = v68;
  }

  else
  {
    v69 = @"AUTO-GRAFT";
  }

  v70 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v87];
  v89[0] = _NSConcreteStackBlock;
  v89[1] = 3221225472;
  v89[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke;
  v89[3] = &unk_4B4878;
  v89[4] = self;
  v90 = v87;
  v91 = setCopy;
  v92 = v69;
  v39 = v87;
  v40 = v86;
  v93 = v86;
  v94 = v85;
  infoCopy = v77;
  v95 = v77;
  v97 = stagingCopy;
  v98 = errorCopy;
  v38 = v84;
  v96 = v84;
  v41 = setCopy;
  [MADAutoAssetSecure personalizeGraftSetDownloaded:v91 forSetDescriptor:v90 allowingNetwork:1 withAutoAssetDescriptors:v70 completion:v89];

LABEL_39:
}

void __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke(uint64_t a1, uint64_t a2, void *a3)
{
  v4 = a3;
  v5 = [*(a1 + 32) autoControlManagerFSM];
  v6 = [v5 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke_2;
  block[3] = &unk_4B4850;
  v20 = v4;
  *&v7 = *(a1 + 40);
  *(&v7 + 1) = *(a1 + 32);
  v18 = v7;
  v8 = *(a1 + 48);
  v9 = *(a1 + 56);
  *&v10 = v8;
  *(&v10 + 1) = v9;
  v21 = v18;
  v22 = v10;
  v11 = *(a1 + 64);
  v12 = *(a1 + 72);
  v13 = *(a1 + 80);
  v25 = *(a1 + 96);
  v14 = *(a1 + 88);
  *&v15 = v13;
  *(&v15 + 1) = v14;
  *&v16 = v11;
  *(&v16 + 1) = v12;
  v23 = v16;
  v24 = v15;
  v17 = v4;
  dispatch_async(v6, block);
}

void __138__MADAutoAssetControlManager_securePersonalizeGraftLockSet_lockingSetDescriptor_forEventInfo_replyingOnError_fromPreSUStaging_completion___block_invoke_2(uint64_t a1)
{
  v1 = a1;
  v2 = *(a1 + 32);
  [*(v1 + 40) setSecureOperationInProgress:0];
  v90 = v1;
  if (v2)
  {
    v3 = v1;
    v4 = *(v1 + 48);
    v5 = [*(v3 + 40) clientDomainName];
    v6 = [*(v3 + 40) assetSetIdentifier];
    v7 = [v4 setConfigurationForClientDomain:v5 forAssetSetIdentifier:v6];

    if (v7)
    {
      v8 = [v7 latestAtomicInstanceToVend];

      if (v8)
      {
        if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:v2])
        {
          [*(v90 + 48) forceGlobalSetUnlock:*(v90 + 56) dueToError:v2 ofSetDescriptor:*(v90 + 40) historyOperationAI:1503 historyOperationSD:394];
          goto LABEL_9;
        }

        v9 = [NSError buildCheckedError:v2];
        [v7 setNewerVersionError:v9];
      }

      else
      {
        v9 = [NSError buildCheckedError:v2];
        [v7 setAvailableForUseError:v9];
      }
    }

LABEL_9:

    v1 = v90;
  }

  v93 = 0u;
  v94 = 0u;
  v91 = 0u;
  v92 = 0u;
  v10 = [*(v1 + 40) latestDowloadedAtomicInstanceEntries];
  v11 = [v10 countByEnumeratingWithState:&v91 objects:v104 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v92;
    do
    {
      v14 = 0;
      v89 = v12;
      do
      {
        if (*v92 != v13)
        {
          objc_enumerationMutation(v10);
        }

        v15 = *(v1 + 48);
        v16 = [*(*(&v91 + 1) + 8 * v14) fullAssetSelector];
        v17 = [v15 locateDownloadedByFullSelector:v16];

        [v17 setSecureOperationInProgress:0];
        if ([v17 secureOperationEliminating])
        {
          v18 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
          {
            v19 = v13;
            v20 = v10;
            v21 = v2;
            v22 = *(v1 + 64);
            v23 = *(v90 + 56);
            v24 = [*(v90 + 40) summary];
            v25 = [v17 summary];
            *buf = 138544130;
            v97 = v22;
            v2 = v21;
            v10 = v20;
            v13 = v19;
            v98 = 2114;
            v99 = v23;
            v1 = v90;
            v100 = 2114;
            v101 = v24;
            v102 = 2114;
            v103 = v25;
            _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} auto-asset of set-descriptor eliminate while performing secure operation(s) | setDescriptor:%{public}@ | nextDownloadedDescriptor:%{public}@", buf, 0x2Au);

            v12 = v89;
          }

          [*(v1 + 48) eliminateUngraftDescriptor:*(v1 + 56) forAutoAssetDescriptor:v17 failingClientRequestForEventInfo:0];
          if (!v2)
          {
            v26 = *(v1 + 56);
            v27 = [NSString alloc];
            v28 = [v17 summary];
            v29 = [v27 initWithFormat:@"encountered set-descriptor with auto-asset being eliminated | nextDownloadedDescriptor:%@", v28];
            v30 = v26;
            v12 = v89;
            v2 = [MAAutoAssetError buildError:6114 fromOperation:v30 underlyingError:0 withDescription:v29];
          }
        }

        v14 = v14 + 1;
      }

      while (v12 != v14);
      v12 = [v10 countByEnumeratingWithState:&v91 objects:v104 count:16];
    }

    while (v12);
  }

  v31 = v1;
  v32 = *(v1 + 48);
  v33 = *(v31 + 56);
  v34 = [*(v31 + 72) clientDomainName];
  v35 = [*(v31 + 72) assetSetIdentifier];
  LODWORD(v32) = [v32 isSetIdentifierBeingEliminated:v33 forClientDomainName:v34 ofSetIdentifier:v35];

  if (v32)
  {
    v36 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
    {
      v37 = v2;
      v39 = *(v90 + 56);
      v38 = *(v90 + 64);
      v40 = [*(v90 + 40) summary];
      *buf = 138543874;
      v97 = v38;
      v2 = v37;
      v98 = 2114;
      v99 = v39;
      v100 = 2114;
      v101 = v40;
      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "\n[SECURE][%{public}@][SET-CONTROL][ELIMINATE] {%{public}@} set-identifier eliminate while performing secure operation(s) | nextDownloadedDescriptor:%{public}@", buf, 0x20u);
    }

    v41 = v90;
    [*(v90 + 48) eliminateUngraftSetDescriptor:*(v90 + 40) failingClientRequestForEventInfo:0];
    if (v2)
    {
      goto LABEL_29;
    }

    v42 = *(v90 + 56);
    v43 = [NSString alloc];
    v44 = [*(v90 + 40) summary];
    v45 = [v43 initWithFormat:@"encountered set-descriptor being eliminated | setDescriptor:%@", v44];
    v2 = [MAAutoAssetError buildError:6114 fromOperation:v42 underlyingError:0 withDescription:v45];
  }

  v41 = v90;
  if (!v2)
  {
    v46 = *(v90 + 56);
    v47 = *(v90 + 72);
    v48 = *(v90 + 80);
    v49 = *(v90 + 48);
    v50 = *(v90 + 40);
    v51 = [*(v90 + 88) clientReplyCompletion];
    v41 = v90;
    v2 = [v49 notifyLockerAsIndicatedBySetJob:v46 withSetInstance:v47 withSetDesire:v48 forSetDescriptor:v50 withClientReplyCompletion:v51];

    if (!v2)
    {
      v82 = *(v90 + 48);
      v83 = [*(v90 + 88) clientRequest];
      v60 = [v82 buildSetFoundResponseMessage:@"[AUTO-PERSONALIZATION] lockAtomic(SUCCESS)" forClientRequest:v83 withFoundSetDescriptor:*(v90 + 40) withSubAtomicInstance:0 forLatestDownloaded:1 withInstance:*(v90 + 72) withDesire:*(v90 + 80) fromLocation:*(v90 + 56)];

      v84 = [*(v90 + 72) atomicInstance];

      if (!v84)
      {
        v85 = *(v90 + 48);
        v86 = [*(v90 + 40) clientDomainName];
        v87 = [*(v90 + 40) assetSetIdentifier];
        v88 = [v85 locateSetConfigurationByClientDomain:v86 forAssetSetIdentifier:v87];

        [*(v90 + 48) setConfigurationAdoptLatestToVend:*(v90 + 56) fromSetDescriptor:*(v90 + 40) toSetConfiguration:v88 fromPreSUStaging:*(v90 + 104) allowEmpty:0];
      }

      v2 = 0;
      v52 = 1;
      v53 = v90;
      if (v60)
      {
        goto LABEL_32;
      }

      goto LABEL_31;
    }
  }

LABEL_29:
  if ((*(v41 + 105) & 1) == 0)
  {
    v60 = 0;
    goto LABEL_39;
  }

  v52 = 0;
  v53 = v90;
LABEL_31:
  v54 = *(v53 + 48);
  v55 = *(v53 + 56);
  v56 = [*(v53 + 72) clientDomainName];
  v57 = [*(v53 + 88) assetSetIdentifier];
  v58 = [*(v53 + 88) clientRequest];
  v59 = [v58 responseMessage];
  v60 = [v54 updateAutoAssetSetStatus:v55 forClientDomain:v56 forAssetSetIdentifier:v57 forJobResponse:v59 withResponseError:v2 clearingDownloadProgressReason:@"reached [secure operation] lock phase" withAssetSetStatus:0];

LABEL_32:
  [*(v53 + 48) issueBuiltResponseForEventInfo:*(v53 + 88) issuingResponseMessage:v60 withResponseError:v2 fromLocation:*(v53 + 56)];
  v61 = *(v53 + 48);
  v62 = [[NSString alloc] initWithFormat:@"%@ (after secure operation attempt)", *(v53 + 56)];
  [v61 decrementClientRequestCount:v62 forEventInfo:*(v53 + 88)];

  if ((v52 & 1) == 0)
  {
    v63 = [*(v53 + 72) autoAssetSetClientName];
    v64 = *(v53 + 72);
    if (v63)
    {
      [v64 autoAssetSetClientName];
    }

    else
    {
      [v64 clientProcessName];
    }
    v65 = ;
    v66 = [*(v90 + 72) clientDomainName];
    v67 = [*(v90 + 72) assetSetIdentifier];
    v68 = [*(v90 + 40) latestDownloadedAtomicInstance];
    [MADAutoAssetHistory recordFailedOperation:504 fromClient:v65 forClientDomainName:v66 forAssetSetIdentifier:v67 forAtomicInstance:v68 failingWithError:v2];

    if (+[MAAIRBEventReporter isAvailable])
    {
      v69 = [MAAIRBMobileAssetOperationMetadata alloc];
      v70 = [MADAutoAssetHistoryTracker operationName:504];
      v71 = [(MAAIRBMobileAssetOperationMetadata *)v69 initWithCode:504 name:v70];

      v72 = [MAAIRBMobileAssetAtomicInstance alloc];
      v73 = [MAAIRBMobileAssetAssetSet alloc];
      v74 = [*(v90 + 72) assetSetIdentifier];
      v75 = [(MAAIRBMobileAssetAssetSet *)v73 initWithAssetSetIdentifier:v74];
      v76 = [*(v90 + 40) latestDownloadedAtomicInstance];
      v77 = [(MAAIRBMobileAssetAtomicInstance *)v72 initWithAssetSet:v75 atomicInstanceId:v76];

      v78 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:v71 atomicInstance:v77 assetCount:0];
      v79 = [MAAIRBAppleIntelligenceAssetDeliveryEvent alloc];
      v95 = v2;
      v80 = [NSArray arrayWithObjects:&v95 count:1];
      v81 = [(MAAIRBAppleIntelligenceAssetDeliveryEvent *)v79 initWithErrors:v80 type:v78];

      [MAAIRBEventReporter emitAppleIntelligenceEvent:v81];
    }
  }

LABEL_39:
  (*(*(v90 + 96) + 16))();
}

- (void)secureStartupEstablishOperationSequence:(id)sequence forRequiringPersonalization:(id)personalization forRequiringGrafting:(id)grafting
{
  sequenceCopy = sequence;
  personalizationCopy = personalization;
  graftingCopy = grafting;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v42 = sequenceCopy;
  sequenceCopy = [[NSString alloc] initWithFormat:@"%@:secureStartupEstablishOperationSequence", sequenceCopy];
  v12 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setDescriptorsRequiringPersonalization:v12];

  v13 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self setDescriptorsRequiringGrafting:v13];

  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  v14 = personalizationCopy;
  v15 = [v14 countByEnumeratingWithState:&v50 objects:v61 count:16];
  v44 = v14;
  if (v15)
  {
    v16 = v15;
    v17 = 0;
    v18 = *v51;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v51 != v18)
        {
          objc_enumerationMutation(v14);
        }

        v20 = *(*(&v50 + 1) + 8 * i);
        v21 = [v14 safeObjectForKey:v20 ofClass:objc_opt_class()];
        if (v21)
        {
          v17 += [(MADAutoAssetControlManager *)self addToTryPersonalize:sequenceCopy forDescriptor:v21];
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v24 = [[NSString alloc] initWithFormat:@"{%@} unable to load secure descriptor to be personalized | descriptorKey:%@", sequenceCopy, v20];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6111 withError:0];

          v14 = v44;
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v50 objects:v61 count:16];
    }

    while (v16);
  }

  else
  {
    v17 = 0;
  }

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  v25 = graftingCopy;
  v26 = [v25 countByEnumeratingWithState:&v46 objects:v60 count:16];
  if (v26)
  {
    v27 = v26;
    v28 = *v47;
    do
    {
      for (j = 0; j != v27; j = j + 1)
      {
        if (*v47 != v28)
        {
          objc_enumerationMutation(v25);
        }

        v30 = *(*(&v46 + 1) + 8 * j);
        v31 = [v25 safeObjectForKey:v30 ofClass:objc_opt_class()];
        if (v31)
        {
          ++v17;
          descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
          [descriptorsRequiringGrafting addObject:v31];

          autoControlManagerFSM3 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(autoControlManagerFSM3, OS_LOG_TYPE_DEFAULT))
          {
            summary = [v31 summary];
            *buf = 138543874;
            v55 = sequenceCopy;
            v56 = 2048;
            v57 = v17;
            v58 = 2114;
            v59 = summary;
            _os_log_impl(&dword_0, autoControlManagerFSM3, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-GRAFT][STARTUP] {%{public}@} heal operation #%ld (graft|mount) | secureDescriptor:%{public}@", buf, 0x20u);
          }
        }

        else
        {
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag2 = [autoControlManagerFSM3 diag];
          v36 = [[NSString alloc] initWithFormat:@"{%@} unable to load secure descriptor to be grafted | descriptorKey:%@", sequenceCopy, v30];
          [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6111 withError:0];
        }
      }

      v27 = [v25 countByEnumeratingWithState:&v46 objects:v60 count:16];
    }

    while (v27);
  }

  v37 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
  {
    descriptorsRequiringPersonalization = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
    v39 = [descriptorsRequiringPersonalization count];
    descriptorsRequiringGrafting2 = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v41 = [descriptorsRequiringGrafting2 count];
    *buf = 138543874;
    v55 = sequenceCopy;
    v56 = 2048;
    v57 = v39;
    v58 = 2048;
    v59 = v41;
    _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION-GRAFT][STARTUP] {%{public}@} ready to begin secure operations | requiringPersonalized:%ld | requiringGrafting:%ld", buf, 0x20u);
  }
}

- (BOOL)addToTryPersonalize:(id)personalize forDescriptor:(id)descriptor
{
  personalizeCopy = personalize;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v38 = personalizeCopy;
  selfCopy = self;
  personalizeCopy = [[NSString alloc] initWithFormat:@"%@:addToTryPersonalize", personalizeCopy];
  v40 = 0u;
  v41 = 0u;
  v42 = 0u;
  v43 = 0u;
  descriptorsRequiringPersonalization = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v11 = [descriptorsRequiringPersonalization countByEnumeratingWithState:&v40 objects:v50 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v41;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v15 = 0;
      v39 = v12;
      do
      {
        if (*v41 != v13)
        {
          objc_enumerationMutation(descriptorsRequiringPersonalization);
        }

        v16 = *(*(&v40 + 1) + 8 * v15);
        v17 = p_weak_ivar_lyt[223];
        assetType = [descriptorCopy assetType];
        assetType2 = [v16 assetType];
        if ([v17 stringIsEqual:assetType to:assetType2])
        {
          v20 = p_weak_ivar_lyt[223];
          [descriptorCopy assetSpecifier];
          v21 = v13;
          v22 = p_weak_ivar_lyt;
          v23 = descriptorCopy;
          v25 = v24 = descriptorsRequiringPersonalization;
          assetSpecifier = [v16 assetSpecifier];
          LOBYTE(v20) = [v20 stringIsEqual:v25 to:assetSpecifier];

          descriptorsRequiringPersonalization = v24;
          descriptorCopy = v23;
          p_weak_ivar_lyt = v22;
          v13 = v21;
          v12 = v39;

          if (v20)
          {
            v34 = 0;
            goto LABEL_15;
          }
        }

        else
        {
        }

        v15 = v15 + 1;
      }

      while (v12 != v15);
      v12 = [descriptorsRequiringPersonalization countByEnumeratingWithState:&v40 objects:v50 count:16];
    }

    while (v12);
  }

  descriptorsRequiringPersonalization2 = [(MADAutoAssetControlManager *)selfCopy descriptorsRequiringPersonalization];
  [descriptorsRequiringPersonalization2 addObject:descriptorCopy];

  descriptorsRequiringPersonalization = _MADLog(@"AutoControl");
  if (os_log_type_enabled(descriptorsRequiringPersonalization, OS_LOG_TYPE_DEFAULT))
  {
    [(MADAutoAssetControlManager *)selfCopy descriptorsRequiringPersonalization];
    v29 = v28 = descriptorsRequiringPersonalization;
    v30 = [v29 count];
    summary = [descriptorCopy summary];
    *buf = 138543874;
    v32 = personalizeCopy;
    v45 = personalizeCopy;
    v46 = 2048;
    v47 = v30;
    v48 = 2114;
    v49 = summary;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} will attempt personalization count:%ld | secureDescriptor:%{public}@", buf, 0x20u);

    descriptorsRequiringPersonalization = v28;
    v34 = 1;
    v33 = v38;
  }

  else
  {
    v34 = 1;
LABEL_15:
    v32 = personalizeCopy;
    v33 = v38;
  }

  return v34;
}

- (BOOL)_acceptPersonalizationFromPSUSToBecomeLatestToVend:(id)vend forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized
{
  vendCopy = vend;
  configurationCopy = configuration;
  candidatesCopy = candidates;
  personalizedCopy = personalized;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendCopy = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationFromPSUSToBecomeLatestToVend", vendCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:vendCopy ofContainer:@"stagedSetLookupResults"];
  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  stagedSetLookupResults = [(MADAutoAssetControlManager *)self stagedSetLookupResults];
  v17 = [stagedSetLookupResults countByEnumeratingWithState:&v33 objects:v37 count:16];
  if (v17)
  {
    v18 = v17;
    v28 = vendCopy;
    v29 = personalizedCopy;
    v30 = candidatesCopy;
    v31 = vendCopy;
    v19 = *v34;
    while (2)
    {
      for (i = 0; i != v18; i = i + 1)
      {
        if (*v34 != v19)
        {
          objc_enumerationMutation(stagedSetLookupResults);
        }

        v21 = *(*(&v33 + 1) + 8 * i);
        v22 = objc_autoreleasePoolPush();
        if (v21)
        {
          assetType = [v21 assetType];
          firstEntryAssetType = [configurationCopy firstEntryAssetType];
          v25 = [SUCore stringIsEqual:assetType to:firstEntryAssetType];

          if (v25)
          {
            vendCopy = v28;
            personalizedCopy = v29;
            candidatesCopy = v30;
            v26 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:v28 forSetLookupResult:v21 withCandidates:v30 extendingToBePersonalized:v29];
            objc_autoreleasePoolPop(v22);
            vendCopy = v31;
            goto LABEL_13;
          }
        }

        objc_autoreleasePoolPop(v22);
      }

      v18 = [stagedSetLookupResults countByEnumeratingWithState:&v33 objects:v37 count:16];
      if (v18)
      {
        continue;
      }

      break;
    }

    v26 = 0;
    candidatesCopy = v30;
    vendCopy = v31;
    vendCopy = v28;
    personalizedCopy = v29;
  }

  else
  {
    v26 = 0;
  }

LABEL_13:

  return v26;
}

- (BOOL)_acceptPersonalizationToProvideLatestToVend:(id)vend forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized
{
  configurationCopy = configuration;
  candidatesCopy = candidates;
  personalizedCopy = personalized;
  vendCopy = vend;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendCopy = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToProvideLatestToVend", vendCopy];
  latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];

  if (latestAtomicInstanceToVend)
  {
    latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
    v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:vendCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

    v20 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:vendCopy forSetDescriptor:v19 withCandidates:candidatesCopy extendingToBePersonalized:personalizedCopy];
  }

  else
  {
    v20 = 0;
  }

  return v20;
}

- (BOOL)_acceptPersonalizationToProvidePreinstalled:(id)preinstalled forSetConfiguration:(id)configuration withCandidates:(id)candidates extendingToBePersonalized:(id)personalized
{
  preinstalledCopy = preinstalled;
  configurationCopy = configuration;
  candidatesCopy = candidates;
  personalizedCopy = personalized;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  preinstalledCopy = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToProvidePreinstalled", preinstalledCopy];
  clientDomainName = [configurationCopy clientDomainName];
  v36 = configurationCopy;
  assetSetIdentifier = [configurationCopy assetSetIdentifier];
  v19 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:clientDomainName assetSetIdentifier:assetSetIdentifier];

  v35 = preinstalledCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:preinstalledCopy ofContainer:@"setDescriptorKeysForAssetSet"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  v20 = v19;
  v21 = [v20 countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (v21)
  {
    v22 = v21;
    v33 = candidatesCopy;
    v34 = preinstalledCopy;
    v23 = *v38;
    do
    {
      for (i = 0; i != v22; i = i + 1)
      {
        if (*v38 != v23)
        {
          objc_enumerationMutation(v20);
        }

        v25 = *(*(&v37 + 1) + 8 * i);
        v26 = objc_autoreleasePoolPush();
        v27 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"handleSetClientEndAtomicLocksForClientRequest" forKey:v25];
        if (v27)
        {
          autoAssetEntries = [v36 autoAssetEntries];
          if ([(MADAutoAssetControlManager *)self doesSetDescriptor:v27 coverRequestedAutoAssetEntries:autoAssetEntries])
          {
            v29 = [(MADAutoAssetControlManager *)self doesSetDescriptorReferenceAllPreInstalledContent:v27];

            if (v29)
            {
              v30 = v35;
              candidatesCopy = v33;
              v31 = [(MADAutoAssetControlManager *)self _acceptPersonalizationToAttempt:v35 forSetDescriptor:v27 withCandidates:v33 extendingToBePersonalized:personalizedCopy];

              objc_autoreleasePoolPop(v26);
              preinstalledCopy = v34;
              goto LABEL_16;
            }
          }

          else
          {
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v22 = [v20 countByEnumeratingWithState:&v37 objects:v41 count:16];
    }

    while (v22);
    v31 = 0;
    candidatesCopy = v33;
    preinstalledCopy = v34;
  }

  else
  {
    v31 = 0;
  }

  v30 = v35;
LABEL_16:

  return v31;
}

- (BOOL)_acceptPersonalizationToAttempt:(id)attempt forSetDescriptor:(id)descriptor withCandidates:(id)candidates extendingToBePersonalized:(id)personalized
{
  attemptCopy = attempt;
  descriptorCopy = descriptor;
  candidatesCopy = candidates;
  personalizedCopy = personalized;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  attemptCopy = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToAttempt(forSetDescriptor)", attemptCopy];
  v47 = candidatesCopy;
  if (descriptorCopy)
  {
    v44 = personalizedCopy;
    v46 = attemptCopy;
    v16 = objc_alloc_init(NSMutableDictionary);
    v59 = 0u;
    v60 = 0u;
    v61 = 0u;
    v62 = 0u;
    v45 = descriptorCopy;
    latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v18 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v59 objects:v69 count:16];
    if (v18)
    {
      v19 = v18;
      v48 = *v60;
      while (2)
      {
        for (i = 0; i != v19; i = i + 1)
        {
          v21 = v16;
          if (*v60 != v48)
          {
            objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
          }

          v22 = *(*(&v59 + 1) + 8 * i);
          v23 = objc_autoreleasePoolPush();
          v24 = [(MADAutoAssetControlManager *)selfCopy _acceptPersonalizationToAttempt:attemptCopy forAtomicEntry:v22];
          if (!v24)
          {
            objc_autoreleasePoolPop(v23);
            descriptorCopy = v45;
            attemptCopy = v46;
            personalizedCopy = v44;
            goto LABEL_28;
          }

          v25 = [MAAutoAssetSelector alloc];
          assetType = [v24 assetType];
          assetSpecifier = [v24 assetSpecifier];
          assetVersion = [v24 assetVersion];
          v29 = [v25 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

          persistedEntryID = [v29 persistedEntryID];
          v16 = v21;
          [v21 setSafeObject:v24 forKey:persistedEntryID];

          objc_autoreleasePoolPop(v23);
        }

        v19 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v59 objects:v69 count:16];
        if (v19)
        {
          continue;
        }

        break;
      }
    }

    if ([v16 count])
    {
      v57 = 0u;
      v58 = 0u;
      v55 = 0u;
      v56 = 0u;
      latestDowloadedAtomicInstanceEntries = v16;
      v31 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v55 objects:v68 count:16];
      personalizedCopy = v44;
      if (v31)
      {
        v32 = v31;
        v33 = *v56;
        while (2)
        {
          for (j = 0; j != v32; j = j + 1)
          {
            if (*v56 != v33)
            {
              objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
            }

            v35 = *(*(&v55 + 1) + 8 * j);
            v36 = [v47 safeObjectForKey:v35 ofClass:objc_opt_class()];
            if (!v36)
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138543618;
                v65 = attemptCopy;
                v66 = 2114;
                v67 = v35;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} candidate unavailable for attempting personalization | nextSelectorKey:%{public}@", buf, 0x16u);
              }

              LOBYTE(v24) = 0;
              goto LABEL_33;
            }
          }

          v32 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v55 objects:v68 count:16];
          if (v32)
          {
            continue;
          }

          break;
        }
      }

      v53 = 0u;
      v54 = 0u;
      v51 = 0u;
      v52 = 0u;
      latestDowloadedAtomicInstanceEntries = latestDowloadedAtomicInstanceEntries;
      v37 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v51 objects:v63 count:16];
      if (v37)
      {
        v38 = v37;
        v21 = v16;
        v39 = *v52;
        descriptorCopy = v45;
        do
        {
          for (k = 0; k != v38; k = k + 1)
          {
            if (*v52 != v39)
            {
              objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
            }

            v41 = *(*(&v51 + 1) + 8 * k);
            v42 = [latestDowloadedAtomicInstanceEntries safeObjectForKey:v41 ofClass:objc_opt_class()];
            [v44 setSafeObject:v42 forKey:v41];
          }

          v38 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v51 objects:v63 count:16];
        }

        while (v38);
        LOBYTE(v24) = 1;
        attemptCopy = v46;
LABEL_28:
        v16 = v21;
      }

      else
      {
        LOBYTE(v24) = 1;
LABEL_33:
        descriptorCopy = v45;
        attemptCopy = v46;
      }
    }

    else
    {
      LOBYTE(v24) = 0;
      descriptorCopy = v45;
      attemptCopy = v46;
      personalizedCopy = v44;
    }
  }

  else
  {
    LOBYTE(v24) = 0;
  }

  return v24;
}

- (BOOL)_acceptPersonalizationToAttempt:(id)attempt forSetLookupResult:(id)result withCandidates:(id)candidates extendingToBePersonalized:(id)personalized
{
  attemptCopy = attempt;
  resultCopy = result;
  candidatesCopy = candidates;
  personalizedCopy = personalized;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  attemptCopy = [[NSString alloc] initWithFormat:@"%@:_acceptPersonalizationToAttempt(forSetLookupResult)", attemptCopy];
  v58 = objc_alloc_init(NSMutableDictionary);
  if (!resultCopy)
  {
    discoveredAtomicEntries = _MADLog(@"AutoControl");
    if (os_log_type_enabled(discoveredAtomicEntries, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v76 = attemptCopy;
      _os_log_impl(&dword_0, discoveredAtomicEntries, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} received nil set lookup result", buf, 0xCu);
    }

LABEL_40:
    v48 = 0;
    goto LABEL_41;
  }

  v53 = candidatesCopy;
  v54 = resultCopy;
  v55 = attemptCopy;
  v71 = 0u;
  v72 = 0u;
  v69 = 0u;
  v70 = 0u;
  discoveredAtomicEntries = [resultCopy discoveredAtomicEntries];
  v17 = selfCopy;
  v59 = [discoveredAtomicEntries countByEnumeratingWithState:&v69 objects:v79 count:16];
  v56 = attemptCopy;
  if (!v59)
  {
    goto LABEL_16;
  }

  v18 = *v70;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  while (2)
  {
    for (i = 0; i != v59; i = i + 1)
    {
      if (*v70 != v18)
      {
        objc_enumerationMutation(discoveredAtomicEntries);
      }

      v21 = *(*(&v69 + 1) + 8 * i);
      v22 = objc_autoreleasePoolPush();
      fullAssetSelector = [v21 fullAssetSelector];
      v24 = [(MADAutoAssetControlManager *)v17 locateDownloadedByFullSelector:fullAssetSelector];

      if ([p_weak_ivar_lyt[287] doesDescriptorInvolvePersonalization:attemptCopy forDescriptor:v24] && (objc_msgSend(p_weak_ivar_lyt[287], "isPersonalizationRequired:forDescriptor:", attemptCopy, v24) & 1) != 0)
      {
        v25 = [(MADAutoAssetControlManager *)v17 _acceptPersonalizationToAttempt:attemptCopy forAtomicEntry:v21];
        if (!v25)
        {
          v49 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v49, OS_LOG_TYPE_DEFAULT))
          {
            summary = [v21 summary];
            *buf = 138543618;
            v76 = attemptCopy;
            v77 = 2114;
            v78 = summary;
            _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} received nil descriptor for entry requiring personalization | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

          objc_autoreleasePoolPop(v22);
          v48 = 0;
          resultCopy = v54;
          attemptCopy = v55;
          candidatesCopy = v53;
          goto LABEL_41;
        }

        v26 = v25;
        v27 = [MAAutoAssetSelector alloc];
        assetType = [v26 assetType];
        assetSpecifier = [v26 assetSpecifier];
        [v26 assetVersion];
        v30 = v22;
        v31 = discoveredAtomicEntries;
        v33 = v32 = v18;
        summary2 = [v27 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:v33];

        v18 = v32;
        discoveredAtomicEntries = v31;
        v22 = v30;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        attemptCopy = v56;
        persistedEntryID = [summary2 persistedEntryID];
        [v58 setSafeObject:v26 forKey:persistedEntryID];

        v17 = selfCopy;
      }

      else
      {
        v26 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
        {
          goto LABEL_14;
        }

        summary2 = [v21 summary];
        *buf = 138543618;
        v76 = attemptCopy;
        v77 = 2114;
        v78 = summary2;
        _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} skipping set configuration atomic entry, does not involve personalization or does not require personalization | nextAtomicEntry:%{public}@", buf, 0x16u);
      }

LABEL_14:
      objc_autoreleasePoolPop(v22);
    }

    v59 = [discoveredAtomicEntries countByEnumeratingWithState:&v69 objects:v79 count:16];
    if (v59)
    {
      continue;
    }

    break;
  }

LABEL_16:

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  discoveredAtomicEntries = v58;
  v36 = [discoveredAtomicEntries countByEnumeratingWithState:&v65 objects:v74 count:16];
  resultCopy = v54;
  attemptCopy = v55;
  candidatesCopy = v53;
  if (v36)
  {
    v37 = v36;
    v38 = *v66;
    while (2)
    {
      for (j = 0; j != v37; j = j + 1)
      {
        if (*v66 != v38)
        {
          objc_enumerationMutation(discoveredAtomicEntries);
        }

        v40 = *(*(&v65 + 1) + 8 * j);
        v41 = [v53 safeObjectForKey:v40 ofClass:objc_opt_class()];
        if (!v41)
        {
          v51 = _MADLog(@"AutoControl");
          attemptCopy = v56;
          if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
          {
            *buf = 138543618;
            v76 = v56;
            v77 = 2114;
            v78 = v40;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {%{public}@} candidate unavailable for attempting personalization | nextSelectorKey:%{public}@", buf, 0x16u);
          }

          goto LABEL_40;
        }
      }

      v37 = [discoveredAtomicEntries countByEnumeratingWithState:&v65 objects:v74 count:16];
      if (v37)
      {
        continue;
      }

      break;
    }
  }

  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  discoveredAtomicEntries = discoveredAtomicEntries;
  v42 = [discoveredAtomicEntries countByEnumeratingWithState:&v61 objects:v73 count:16];
  if (v42)
  {
    v43 = v42;
    v44 = *v62;
    do
    {
      for (k = 0; k != v43; k = k + 1)
      {
        if (*v62 != v44)
        {
          objc_enumerationMutation(discoveredAtomicEntries);
        }

        v46 = *(*(&v61 + 1) + 8 * k);
        v47 = [discoveredAtomicEntries safeObjectForKey:v46 ofClass:objc_opt_class()];
        [personalizedCopy setSafeObject:v47 forKey:v46];
      }

      v43 = [discoveredAtomicEntries countByEnumeratingWithState:&v61 objects:v73 count:16];
    }

    while (v43);
  }

  v48 = 1;
  attemptCopy = v56;
LABEL_41:

  return v48;
}

- (id)_acceptPersonalizationToAttempt:(id)attempt forAtomicEntry:(id)entry
{
  attemptCopy = attempt;
  entryCopy = entry;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!entryCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    attemptCopy = [[NSString alloc] initWithFormat:@"{%@} nil atomic-instance entry", attemptCopy];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:attemptCopy withResult:6108 withError:0];
LABEL_11:

    goto LABEL_12;
  }

  fullAssetSelector = [entryCopy fullAssetSelector];
  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

  if (!autoControlManagerFSM2)
  {
    diag = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    attemptCopy = [diag diag];
    v15 = [NSString alloc];
    summary = [entryCopy summary];
    v17 = [v15 initWithFormat:@"{%@} unable to locate asset-descriptor for atomic-instance entry | atomicEntry:%@", attemptCopy, summary];
    [attemptCopy trackAnomaly:@"AUTO-SET-CONTROL" forReason:v17 withResult:6108 withError:0];

LABEL_10:
    goto LABEL_11;
  }

  if (![autoControlManagerFSM2 isOnFilesystem])
  {
    diag = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    attemptCopy = [diag diag];
    v18 = [NSString alloc];
    summary = [entryCopy summary];
    summary2 = [autoControlManagerFSM2 summary];
    v20 = [v18 initWithFormat:@"{%@} atomic-instance entry no longer on the filesystem | atomicEntry:%@ | assetDescriptor:%@", attemptCopy, summary, summary2];
    [attemptCopy trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6108 withError:0];

    goto LABEL_10;
  }

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:attemptCopy forDescriptor:autoControlManagerFSM2]&& [MADAutoAssetSecure isPersonalizationRequired:attemptCopy forDescriptor:autoControlManagerFSM2])
  {
    autoControlManagerFSM2 = autoControlManagerFSM2;
    v12 = autoControlManagerFSM2;
    goto LABEL_13;
  }

LABEL_12:
  v12 = 0;
LABEL_13:

  return v12;
}

- (void)assetPersonalizatonAttemptCompletePostEvent:(id)event withControlParam:(id)param
{
  eventCopy = event;
  paramCopy = param;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v77 = eventCopy;
  eventCopy = [[NSString alloc] initWithFormat:@"%@:assetPersonalizatonAttemptCompletePostEvent", eventCopy];
  descriptorsRequiringPersonalization = [(MADAutoAssetControlManager *)self descriptorsRequiringPersonalization];
  v12 = [descriptorsRequiringPersonalization count];

  if (v12)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = autoControlManagerFSM2;
    v15 = @"HaveNeedingPersonalize";
LABEL_3:
    [autoControlManagerFSM2 postEvent:v15 withInfo:paramCopy];

    goto LABEL_54;
  }

  v76 = paramCopy;
  prePersonalizedSelectors = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v17 = [prePersonalizedSelectors count];

  if (!v17)
  {
    [(MADAutoAssetControlManager *)self considerDownloadedWithPSUSLookupResultsForLatestToVend];
    descriptorsRequiringGrafting = [(MADAutoAssetControlManager *)self descriptorsRequiringGrafting];
    v69 = [descriptorsRequiringGrafting count];

    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v14 = autoControlManagerFSM2;
    if (v69)
    {
      v15 = @"HaveNeedingGraft";
    }

    else
    {
      v15 = @"NoneNeedingPersonalize";
    }

    goto LABEL_3;
  }

  v18 = objc_alloc_init(NSMutableArray);
  v96 = 0u;
  v97 = 0u;
  v98 = 0u;
  v99 = 0u;
  obj = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  selfCopy = self;
  selfCopy2 = self;
  v87 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
  if (!v87)
  {
    goto LABEL_39;
  }

  v86 = *v97;
  v78 = eventCopy;
  v80 = v18;
  do
  {
    v20 = 0;
    do
    {
      if (*v97 != v86)
      {
        objc_enumerationMutation(obj);
      }

      v21 = *(*(&v96 + 1) + 8 * v20);
      v22 = objc_autoreleasePoolPush();
      v23 = [(MADAutoAssetControlManager *)selfCopy locateDownloadedByFullSelector:v21];
      v88 = v23;
      if (!v23)
      {
        autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        diag = [autoControlManagerFSM3 diag];
        v44 = v22;
        v45 = [NSString alloc];
        summary = [v21 summary];
        v47 = [v45 initWithFormat:@"{%@} pre-personalized selector yet no downloaded asset descriptor | prePersonalizedSelector:%@", eventCopy, summary];
        [diag trackAnomaly:@"AUTO-CONTROL" forReason:v47 withResult:6111 withError:0];

        v22 = v44;
        goto LABEL_34;
      }

      v24 = [(MADAutoAssetControlManager *)selfCopy setConfigurationForDescriptorIfManagedAsSet:v23];
      autoControlManagerFSM3 = v24;
      if (!v24 || ([v24 latestAtomicInstanceToVend], v26 = objc_claimAutoreleasedReturnValue(), v26, !v26))
      {
        [v18 addObject:v21];
        goto LABEL_34;
      }

      v82 = v22;
      v83 = v20;
      latestAtomicInstanceToVend = [autoControlManagerFSM3 latestAtomicInstanceToVend];
      v28 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:eventCopy forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:1];

      v84 = autoControlManagerFSM3;
      v81 = v28;
      if (!v28)
      {
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        diag2 = [autoControlManagerFSM4 diag];
        v50 = v21;
        v51 = [NSString alloc];
        summary2 = [v50 summary];
        summary3 = [autoControlManagerFSM3 summary];
        v54 = [v51 initWithFormat:@"{%@} pre-personalized selector managed as set with latest-to-vend yet unable to locate being-vended set-descriptor | prePersonalizedSelector:%@ | managingSetConfiguration:%@", eventCopy, summary2, summary3];
        [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v54 withResult:6111 withError:0];

        v18 = v80;
        [v80 addObject:v50];
LABEL_32:
        v22 = v82;
        v20 = v83;
        goto LABEL_33;
      }

      v94 = 0u;
      v95 = 0u;
      v92 = 0u;
      v93 = 0u;
      latestDowloadedAtomicInstanceEntries = [v28 latestDowloadedAtomicInstanceEntries];
      v29 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v92 objects:v106 count:16];
      if (!v29)
      {
LABEL_25:

        v18 = v80;
        [v80 addObject:v21];
LABEL_31:
        eventCopy = v78;
        selfCopy = selfCopy2;
        goto LABEL_32;
      }

      v30 = v29;
      v31 = *v93;
      v90 = *v93;
LABEL_16:
      v32 = 0;
      while (1)
      {
        if (*v93 != v31)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        v33 = *(*(&v92 + 1) + 8 * v32);
        assetType = [v21 assetType];
        fullAssetSelector = [v33 fullAssetSelector];
        assetType2 = [fullAssetSelector assetType];
        if (([SUCore stringIsEqual:assetType to:assetType2]& 1) == 0)
        {

          goto LABEL_23;
        }

        assetSpecifier = [v21 assetSpecifier];
        v89 = v33;
        fullAssetSelector2 = [v33 fullAssetSelector];
        [fullAssetSelector2 assetSpecifier];
        v39 = v30;
        v41 = v40 = v21;
        v42 = [SUCore stringIsEqual:assetSpecifier to:v41];

        v21 = v40;
        v30 = v39;

        v31 = v90;
        if (v42)
        {
          break;
        }

LABEL_23:
        if (v30 == ++v32)
        {
          v30 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v92 objects:v106 count:16];
          if (v30)
          {
            goto LABEL_16;
          }

          goto LABEL_25;
        }
      }

      assetVersion = [v21 assetVersion];
      fullAssetSelector3 = [v89 fullAssetSelector];
      assetVersion2 = [fullAssetSelector3 assetVersion];
      v58 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

      if (v58)
      {
        v18 = v80;
        [v80 addObject:v21];

        goto LABEL_31;
      }

      selfCopy = selfCopy2;
      eventCopy = v78;
      v18 = v80;
      v22 = v82;
      v20 = v83;
      if ([(MADAutoAssetControlManager *)selfCopy2 wouldSetDescriptorForStagedPlusPrePersonalizedVendAtomicInstance:v84])
      {
        [v80 addObject:v21];
      }

LABEL_33:

      autoControlManagerFSM3 = v84;
LABEL_34:

      objc_autoreleasePoolPop(v22);
      v20 = v20 + 1;
    }

    while (v20 != v87);
    v59 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
    v87 = v59;
  }

  while (v59);
LABEL_39:

  v60 = objc_alloc_init(NSMutableArray);
  v61 = selfCopy;
  v62 = v60;
  [(MADAutoAssetControlManager *)v61 setPrePersonalizedSelectors:v60];

  if ([v18 count])
  {
    v63 = [MADAutoAssetSecure commitPrePersonalizedSync:eventCopy committingSelectors:v18];
    v64 = _MADLog(@"AutoControl");
    v65 = v64;
    if (v63)
    {
      if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR))
      {
        checkedDescription = [v63 checkedDescription];
        v67 = [v18 count];
        *buf = 138543874;
        v101 = eventCopy;
        v102 = 2114;
        v103 = checkedDescription;
        v104 = 2048;
        v105 = v67;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {%{public}@} | commit pre-personalized asset-selectors ERROR | error:%{public}@ | prePersonalizedSelectors:%ld", buf, 0x20u);
      }
    }

    else
    {
      if (os_log_type_enabled(v64, OS_LOG_TYPE_DEFAULT))
      {
        v70 = [v18 count];
        *buf = 138543618;
        v101 = eventCopy;
        v102 = 2048;
        v103 = v70;
        _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-PERSONALIZATION-COMMIT][STARTUP] {%{public}@} | commit pre-personalized asset-selectors SUCCESS | prePersonalizedSelectors:%ld", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)selfCopy2 setConfigurationsPrePersonalizedJustCommitted:@"PersonalizeSuccessDecideMore[NO-GRAFTING]"];
    }
  }

  [(MADAutoAssetControlManager *)selfCopy2 considerDownloadedWithPSUSLookupResultsForLatestToVend];
  descriptorsRequiringGrafting2 = [(MADAutoAssetControlManager *)selfCopy2 descriptorsRequiringGrafting];
  v72 = [descriptorsRequiringGrafting2 count];

  autoControlManagerFSM5 = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
  v74 = autoControlManagerFSM5;
  if (v72)
  {
    v75 = @"HaveNeedingGraft";
  }

  else
  {
    v75 = @"NoneNeedingPersonalize";
  }

  paramCopy = v76;
  [autoControlManagerFSM5 postEvent:v75 withInfo:v76];

LABEL_54:
}

- (void)addActiveJobs:(id)jobs basedOnControl:(id)control
{
  jobsCopy = jobs;
  controlCopy = control;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"addActiveJobs" ofContainer:@"currentJobsBySelector"];
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v10 = [currentJobsBySelector countByEnumeratingWithState:&v30 objects:v34 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v31;
    v26 = currentJobsBySelector;
    v27 = controlCopy;
    v25 = *v31;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v31 != v12)
        {
          objc_enumerationMutation(currentJobsBySelector);
        }

        v14 = *(*(&v30 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        currentJobsBySelector2 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
        v17 = [currentJobsBySelector2 safeObjectForKey:v14 ofClass:objc_opt_class()];

        if (v17 && [(MADAutoAssetControlManager *)self jobToBeIncluded:v17 basedOnControl:controlCopy])
        {
          summaryOfJob = [v17 summaryOfJob];
          v19 = summaryOfJob;
          if (summaryOfJob)
          {
            [summaryOfJob setAssetRepresentation:300];
            [jobsCopy addObject:v19];
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            v21 = [NSString alloc];
            summary = [v17 summary];
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v24 = [v21 initWithFormat:@"{addActiveJobs} unable to form job summaryEntry | job:%@ | %@", summary, _updateLatestSummary];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6111 withError:0];

            controlCopy = v27;
            v12 = v25;

            currentJobsBySelector = v26;
          }
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [currentJobsBySelector countByEnumeratingWithState:&v30 objects:v34 count:16];
    }

    while (v11);
  }
}

- (void)addSuccessfullyDownloadedJobs:(id)jobs basedOnControl:(id)control
{
  jobsCopy = jobs;
  controlCopy = control;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v54 = objc_alloc_init(MAAutoAssetNotifications);
  [v54 setContentAvailableForUse:1];
  locateDownloadedNewAllBySelector = [(MADAutoAssetControlManager *)self locateDownloadedNewAllBySelector];
  selfCopy = self;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"addSuccessfullyDownloadedJobs" ofContainer:@"locateDownloadedNewAllBySelector"];
  v66 = 0u;
  v67 = 0u;
  v64 = 0u;
  v65 = 0u;
  v10 = locateDownloadedNewAllBySelector;
  v11 = [v10 countByEnumeratingWithState:&v64 objects:v68 count:16];
  if (v11)
  {
    v12 = v11;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v14 = *v65;
    v52 = v10;
    v53 = controlCopy;
    v51 = *v65;
    do
    {
      v15 = 0;
      v55 = v12;
      do
      {
        if (*v65 != v14)
        {
          objc_enumerationMutation(v10);
        }

        v16 = *(*(&v64 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        v18 = [v10 safeObjectForKey:v16 ofClass:objc_opt_class()];
        if (v18 && [p_weak_ivar_lyt[266] descriptorToBeIncluded:v18 basedOnControl:controlCopy])
        {
          v62 = v17;
          v19 = [MAAutoAssetSelector alloc];
          assetType = [v18 assetType];
          assetSpecifier = [v18 assetSpecifier];
          assetVersion = [v18 assetVersion];
          v63 = [v19 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

          metadata = [v18 metadata];
          neverBeenLocked = [v18 neverBeenLocked];
          downloadUserInitiated = [v18 downloadUserInitiated];
          downloadedNetworkBytes = [v18 downloadedNetworkBytes];
          downloadedFilesystemBytes = [v18 downloadedFilesystemBytes];
          isPatch = [v18 isPatch];
          patchedFromBaseSelector = [v18 patchedFromBaseSelector];
          patchedFromBaseFilesystemBytes = [v18 patchedFromBaseFilesystemBytes];
          patchingAttempted = [v18 patchingAttempted];
          LOBYTE(assetVersion) = [v18 stagedPriorToAvailable];
          stagedFromOSVersion = [v18 stagedFromOSVersion];
          stagedFromBuildVersion = [v18 stagedFromBuildVersion];
          patchingAttemptError = [v18 patchingAttemptError];
          LOBYTE(v49) = 1;
          BYTE1(v48) = assetVersion;
          LOBYTE(v48) = patchingAttempted;
          LOBYTE(v47) = isPatch;
          v30 = [(MADAutoAssetControlManager *)selfCopy newAssetStatusForSelector:v63 withNotifications:v54 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:0 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v47 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v48 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:stagedFromBuildVersion withStagedFromBuildVersion:v49 extendingWithCurrentLockUsage:0 withAvailableForUseError:patchingAttemptError withPatchingAttemptError:0 withNewerVersionError:?];

          v31 = [v30 copy];
          if (!__isPlatformVersionAtLeast(2, 16, 4, 0))
          {
            [v31 setCurrentLockUsage:0];
          }

          v32 = [MAAutoAssetSummary alloc];
          v33 = objc_opt_respondsToSelector();

          if (v33)
          {
            v34 = [MADAutoAssetSecure isSecureAsset:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v35 = [MADAutoAssetSecure isPersonalizationRequired:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v36 = [MADAutoAssetSecure isPrePersonalized:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v37 = [MADAutoAssetSecure isGraftedOrMounted:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            v38 = v37;
            if (v37)
            {
              v39 = [MADAutoAssetSecure getGraftPath:@"{addSuccessfullyDownloadedJobs}" forDescriptor:v18];
            }

            else
            {
              v39 = 0;
            }

            BYTE3(v48) = v38;
            BYTE2(v48) = v36;
            BYTE1(v48) = v35 ^ 1;
            LOBYTE(v48) = v34;
            v40 = v63;
            v41 = [[MAAutoAssetSummary alloc] initWithAssetSelector:v63 withAssetRepresentation:500 withAssetWasPatched:objc_msgSend(v18 withAssetIsStaged:"isPatch") withJobStatus:0 withScheduledIntervalSecs:v31 withScheduledRemainingSecs:0 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:0 withIsSecureMobileAsset:0 withPersonalizationStatus:v48 withPrePersonalizationStatus:v39 withGraftStatus:0 withGraftPoint:0 withStageGroupType:? withTargetOS:?];
          }

          else
          {
            v40 = v63;
            v41 = [[MAAutoAssetSummary alloc] initWithAssetSelector:v63 withAssetRepresentation:500 withAssetWasPatched:objc_msgSend(v18 withAssetIsStaged:"isPatch") withJobStatus:objc_msgSend(v18 withScheduledIntervalSecs:"isPatch") withScheduledRemainingSecs:v31 withPushDelaySecs:0 withActiveClientCount:0 withActiveMonitorCount:0 withMaximumClientCount:0 withTotalClientCount:{0, 0, 0}];
          }

          v14 = v51;
          if (v41)
          {
            [jobsCopy addObject:v41];
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            v44 = [NSString alloc];
            _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            v46 = [v44 initWithFormat:@"{addSuccessfullyDownloadedJobs} unable to form job jobSummary | %@", _updateLatestSummary];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v46 withResult:6111 withError:0];

            v40 = v63;
          }

          v10 = v52;
          controlCopy = v53;
          v12 = v55;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v17 = v62;
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v12 != v15);
      v12 = [v10 countByEnumeratingWithState:&v64 objects:v68 count:16];
    }

    while (v12);
  }
}

- (id)_updateSandboxExtensionForResponse:(id)response responseError:(id)error clientRequest:(id)request alreadyOnStateQueue:(BOOL)queue
{
  queueCopy = queue;
  responseCopy = response;
  errorCopy = error;
  requestCopy = request;
  v13 = responseCopy;
  v14 = v13;
  if (__isPlatformVersionAtLeast(2, 17, 4, 0))
  {
    clientRequestMessage = [requestCopy clientRequestMessage];
    v16 = objc_opt_respondsToSelector();

    v14 = v13;
    if (v16)
    {
      messageName = [v13 messageName];
      if (([messageName isEqualToString:@"MA-AUTO(REPLY):LOCK_CONTENT"] & 1) == 0)
      {
        messageName2 = [v13 messageName];
        if (([messageName2 isEqualToString:@"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE"] & 1) == 0)
        {
          messageName3 = [v13 messageName];
          if (![messageName3 isEqualToString:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"])
          {
            messageName4 = [v13 messageName];
            v47 = [messageName4 isEqualToString:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"];

            if ((v47 & 1) == 0)
            {
              v14 = v13;
              if (!_MAPreferencesIsVerboseLoggingEnabled())
              {
                goto LABEL_36;
              }

              v22 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
              {
                v48 = v22;
                _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                if (v13)
                {
                  summary = [v13 summary];
                }

                else
                {
                  summary = @"N";
                }

                v54 = [MADAutoAssetClientRequest responseErrorSummary:errorCopy];
                summary2 = [requestCopy summary];
                *buf = 138544130;
                *&buf[4] = _updateLatestSummary;
                *&buf[12] = 2114;
                *&buf[14] = summary;
                *&buf[22] = 2114;
                *&buf[24] = v54;
                v63 = 2114;
                v64 = summary2;
                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy not applicable for this message | responseMessage:%{public}@, responseError:%{public}@, clientRequest:%{public}@", buf, 0x2Au);
                if (v13)
                {
                }

                v14 = v13;
                v22 = v48;
              }

              else
              {
                v14 = v13;
              }

              goto LABEL_35;
            }

LABEL_9:
            selfCopy = self;
            clientRequestMessage2 = [requestCopy clientRequestMessage];
            v21 = [MADAutoAssetAuthorizationPolicy authorizationAssetTypeFromMessage:clientRequestMessage2 alreadyOnStateQueue:queueCopy];

            v22 = v21;
            v23 = repositoryPath(v21);
            v24 = getAutoLocalUrlFromTypeGivenDefaultRepoWithPurpose(v22, 1, v23, @"auto");
            path = [v24 path];

            v60 = 0u;
            v61 = 0u;
            clientRequestMessage3 = [requestCopy clientRequestMessage];
            v27 = clientRequestMessage3;
            if (clientRequestMessage3)
            {
              [clientRequestMessage3 clientConnectionAuditToken];
            }

            else
            {
              v60 = 0u;
              v61 = 0u;
            }

            *buf = v60;
            *&buf[16] = v61;
            v28 = [MADAutoAssetAuthorizationPolicy issueSandboxExtensionForAuditToken:buf path:path];
            if (v28)
            {
              log = errorCopy;
              message = [v13 message];
              v30 = [message mutableCopy];

              v56 = v28;
              [v30 setSafeObject:v28 forKey:@"sandboxExtensionKey"];
              [v30 setSafeObject:path forKey:@"sandboxExtensionPathKey"];
              v31 = [SUCoreConnectMessage alloc];
              messageType = [v13 messageType];
              messageName5 = [v13 messageName];
              clientIDRaw = [v13 clientIDRaw];
              [v13 version];
              v35 = path;
              v37 = v36 = v22;
              v38 = v31;
              v39 = v30;
              v14 = [v38 initWithType:messageType messageName:messageName5 clientID:clientIDRaw version:v37 message:v30];

              v22 = v36;
              path = v35;

              v40 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                v42 = v39;
                if (v13)
                {
                  summary3 = [v13 summary];
                }

                else
                {
                  summary3 = @"N";
                }

                summary4 = [requestCopy summary];
                *buf = 138544386;
                *&buf[4] = _updateLatestSummary2;
                *&buf[12] = 2114;
                *&buf[14] = v22;
                *&buf[22] = 2114;
                *&buf[24] = path;
                v63 = 2114;
                v64 = summary3;
                v65 = 2114;
                v66 = summary4;
                _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy successfully set sandbox extension for response message | assetType=%{public}@, path=%{public}@, responseMessage:%{public}@, clientRequest:%{public}@", buf, 0x34u);
                if (v13)
                {
                }

                v39 = v42;
              }

              v28 = v56;
              errorCopy = log;
            }

            else
            {
              v39 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                loga = v39;
                if (v13)
                {
                  summary5 = [v13 summary];
                }

                else
                {
                  summary5 = @"N";
                }

                summary6 = [requestCopy summary];
                *buf = 138544386;
                *&buf[4] = _updateLatestSummary3;
                *&buf[12] = 2114;
                *&buf[14] = v22;
                *&buf[22] = 2114;
                *&buf[24] = path;
                v63 = 2114;
                v64 = summary5;
                v65 = 2114;
                v66 = summary6;
                _os_log_impl(&dword_0, loga, OS_LOG_TYPE_ERROR, "[%{public}@] {_updateSandboxExtensionForResponse} MADAutoAssetAuthorizationPolicy failed set sandbox extension for response message | assetType=%{public}@, path=%{public}@, responseMessage:%{public}@, clientRequest:%{public}@", buf, 0x34u);
                if (v13)
                {
                }

                v14 = v13;
                v39 = loga;
              }

              else
              {
                v14 = v13;
              }
            }

LABEL_35:
            goto LABEL_36;
          }
        }
      }

      goto LABEL_9;
    }
  }

LABEL_36:

  return v14;
}

- (void)issueResponseToClientRequest:(id)request issuingResponseMessage:(id)message withResponseError:(id)error
{
  requestCopy = request;
  messageCopy = message;
  errorCopy = error;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientReplyCompletion = [requestCopy clientReplyCompletion];

  if (clientReplyCompletion)
  {
    if (!messageCopy && errorCopy)
    {
      clientRequestMessage = [requestCopy clientRequestMessage];
      v15 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
      clientID = [requestCopy clientID];
      messageCopy = [MADAutoAssetControlManager createSeverMessageWithName:v15 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:errorCopy];

LABEL_15:
      statistics = [(MADAutoAssetControlManager *)self statistics];
      totalClientRepliesFailure = [statistics totalClientRepliesFailure];
LABEL_17:
      [(MADAutoAssetControlManager *)self _statsIncrement:totalClientRepliesFailure forClientRequest:requestCopy];

      clientReplyCompletion2 = [requestCopy clientReplyCompletion];
      clientReplyCompletion2[2](clientReplyCompletion2, messageCopy, errorCopy);

      [requestCopy setClientReplyCompletion:0];
      [(MADAutoAssetControlManager *)self removeClientRequest:requestCopy fromLocation:@"issueResponseToClientRequest"];
      goto LABEL_18;
    }

    if (!(messageCopy | errorCopy))
    {
      errorCopy = [MAAutoAssetError buildError:6111 fromOperation:@"issueResponseToClientRequest" underlyingError:0 withDescription:@"no response message or response error at point where reply is to be issued to client"];
      clientRequestMessage2 = [requestCopy clientRequestMessage];
      v21 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
      clientID2 = [requestCopy clientID];
      messageCopy = [MADAutoAssetControlManager createSeverMessageWithName:v21 sender:@"com.apple.MAAutoControl" clientID:clientID2 response:0 error:errorCopy];

      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v25 = [NSString alloc];
      summary = [requestCopy summary];
      v27 = [v25 initWithFormat:@"%@ | clientRequest:%@", @"no response message or response error at point where reply is to be issued to client", summary];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6111 withError:errorCopy];
    }

    if (requestCopy && messageCopy && !errorCopy)
    {
      v28 = [(MADAutoAssetControlManager *)self _updateSandboxExtensionForResponse:messageCopy responseError:0 clientRequest:requestCopy alreadyOnStateQueue:1];

      messageCopy = v28;
    }

    else if (errorCopy)
    {
      goto LABEL_15;
    }

    statistics = [(MADAutoAssetControlManager *)self statistics];
    totalClientRepliesFailure = [statistics totalClientRepliesSuccess];
    errorCopy = 0;
    goto LABEL_17;
  }

  v17 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary2 = [requestCopy summary];
    *buf = 138543618;
    v33 = _updateLatestSummary;
    v34 = 2114;
    v35 = summary2;
    _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "[%{public}@] {issueResponseToClientRequest} no response issued (already replied to client) | clientRequest:%{public}@", buf, 0x16u);
  }

LABEL_18:
}

- (void)issueBuiltResponseForEventInfo:(id)info issuingResponseMessage:(id)message withResponseError:(id)error fromLocation:(id)location
{
  infoCopy = info;
  messageCopy = message;
  errorCopy = error;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:issueBuiltResponseForEventInfo", locationCopy];
  clientRequest = [infoCopy clientRequest];
  clientReplyCompletion = [clientRequest clientReplyCompletion];

  if (clientReplyCompletion)
  {
    if (!messageCopy && errorCopy)
    {
      clientRequest2 = [infoCopy clientRequest];
      clientRequestMessage = [clientRequest2 clientRequestMessage];
      v21 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
      clientRequest3 = [infoCopy clientRequest];
      clientID = [clientRequest3 clientID];
      messageCopy = [MADAutoAssetControlManager createSeverMessageWithName:v21 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:errorCopy];

LABEL_22:
      statistics = [(MADAutoAssetControlManager *)self statistics];
      totalClientRepliesFailure = [statistics totalClientRepliesFailure];
      clientRequest4 = [infoCopy clientRequest];
      [(MADAutoAssetControlManager *)self _statsIncrement:totalClientRepliesFailure forClientRequest:clientRequest4];

      v36 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        if (messageCopy)
        {
          summary = [messageCopy summary];
        }

        else
        {
          summary = @"N";
        }

        v42 = [MADAutoAssetClientRequest responseErrorSummary:errorCopy];
        *buf = 138544130;
        v48 = _updateLatestSummary;
        v49 = 2114;
        v50 = locationCopy;
        v51 = 2114;
        v52 = summary;
        v53 = 2114;
        v54 = v42;
        _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} responding to client with error | responseMessage:%{public}@, responseError:%{public}@", buf, 0x2Au);
        if (messageCopy)
        {
        }
      }

      goto LABEL_31;
    }

    if (messageCopy | errorCopy)
    {
      if (!messageCopy || errorCopy)
      {
        if (errorCopy)
        {
          goto LABEL_22;
        }
      }

      else
      {
        clientRequest5 = [infoCopy clientRequest];

        if (clientRequest5)
        {
          clientRequest6 = [infoCopy clientRequest];
          v32 = [(MADAutoAssetControlManager *)self _updateSandboxExtensionForResponse:messageCopy responseError:0 clientRequest:clientRequest6 alreadyOnStateQueue:1];

          messageCopy = v32;
        }
      }
    }

    else
    {
      errorCopy = [MAAutoAssetError buildError:6111 fromOperation:locationCopy underlyingError:0 withDescription:@"about to issue successful response when no response message"];
      messageCopy = 0;
      if (errorCopy)
      {
        goto LABEL_22;
      }
    }

    statistics2 = [(MADAutoAssetControlManager *)self statistics];
    totalClientRepliesSuccess = [statistics2 totalClientRepliesSuccess];
    clientRequest7 = [infoCopy clientRequest];
    [(MADAutoAssetControlManager *)self _statsIncrement:totalClientRepliesSuccess forClientRequest:clientRequest7];

    errorCopy = 0;
LABEL_31:
    clientRequest8 = [infoCopy clientRequest];
    clientReplyCompletion2 = [clientRequest8 clientReplyCompletion];
    clientReplyCompletion2[2](clientReplyCompletion2, messageCopy, errorCopy);

    clientRequest9 = [infoCopy clientRequest];
    [clientRequest9 setClientReplyCompletion:0];

    clientRequest10 = [infoCopy clientRequest];
    [(MADAutoAssetControlManager *)self removeClientRequest:clientRequest10 fromLocation:locationCopy];
    goto LABEL_32;
  }

  clientRequest10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(clientRequest10, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    clientRequest11 = [infoCopy clientRequest];
    clientReplyCompletion3 = [clientRequest11 clientReplyCompletion];
    summary2 = @"N";
    if (clientReplyCompletion3)
    {
      v28 = @"Y";
    }

    else
    {
      v28 = @"N";
    }

    if (messageCopy)
    {
      summary2 = [messageCopy summary];
    }

    v29 = [MADAutoAssetClientRequest responseErrorSummary:errorCopy];
    *buf = 138544386;
    v48 = _updateLatestSummary2;
    v49 = 2114;
    v50 = locationCopy;
    v51 = 2114;
    v52 = v28;
    v53 = 2114;
    v54 = summary2;
    v55 = 2114;
    v56 = v29;
    _os_log_impl(&dword_0, clientRequest10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no response issued (already completed or scheduled event) | clientReplyCompletion:%{public}@, responseMessage:%{public}@, responseError:%{public}@", buf, 0x34u);
    if (messageCopy)
    {
    }
  }

LABEL_32:
}

- (void)issueResponseForEventInfo:(id)info withErrorCode:(int64_t)code fromAction:(id)action withDescription:(id)description
{
  infoCopy = info;
  actionCopy = action;
  descriptionCopy = description;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (code)
  {
    actionCopy = [[NSString alloc] initWithFormat:@"AUTO-CONTROL(%@)", actionCopy];
    code = [MAAutoAssetError buildError:code fromOperation:actionCopy underlyingError:0 withDescription:descriptionCopy];
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:infoCopy withAutoAssetError:code fromAction:actionCopy withDescription:descriptionCopy];
}

- (void)issueResponseForEventInfo:(id)info withAutoAssetError:(id)error fromAction:(id)action withDescription:(id)description
{
  actionCopy = action;
  errorCopy = error;
  infoCopy = info;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [infoCopy clientRequestMessage];
  v15 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
  clientRequestMessage2 = [infoCopy clientRequestMessage];
  clientID = [clientRequestMessage2 clientID];
  v18 = [MADAutoAssetControlManager createSeverMessageWithName:v15 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:errorCopy];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:infoCopy issuingResponseMessage:v18 withResponseError:errorCopy fromLocation:actionCopy];
}

- (void)issueResponseToFailedAutoAssetLockRequest:(id)request forEventInfo:(id)info withResponseError:(id)error forAttemptedDescriptor:(id)descriptor
{
  requestCopy = request;
  infoCopy = info;
  errorCopy = error;
  descriptorCopy = descriptor;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  jobInformation = [infoCopy jobInformation];
  fullAssetSelector = [jobInformation fullAssetSelector];
  originalSelector = [infoCopy originalSelector];
  if (originalSelector)
  {
    [infoCopy originalSelector];
  }

  else
  {
    [infoCopy autoAssetSelector];
  }
  v17 = ;

  v41 = jobInformation;
  clientInstance = [jobInformation clientInstance];
  if (!descriptorCopy)
  {
    v19 = selfCopy;
    if (v17)
    {
      goto LABEL_8;
    }

LABEL_20:
    v17 = fullAssetSelector;
    if (clientInstance)
    {
      goto LABEL_9;
    }

    goto LABEL_21;
  }

  v19 = selfCopy;
  if (!v17)
  {
    v20 = [MAAutoAssetSelector alloc];
    assetType = [descriptorCopy assetType];
    assetSpecifier = [descriptorCopy assetSpecifier];
    assetVersion = [descriptorCopy assetVersion];
    v17 = [v20 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];
  }

  if (!v17)
  {
    goto LABEL_20;
  }

LABEL_8:
  if (clientInstance)
  {
    goto LABEL_9;
  }

LABEL_21:
  clientInstance = [(MADAutoAssetControlManager *)v19 clientRequestMessageInstance:infoCopy];
LABEL_9:
  autoAssetUUID = [infoCopy autoAssetUUID];
  clientRequest = [infoCopy clientRequest];
  responseMessage = [clientRequest responseMessage];
  v27 = [(MADAutoAssetControlManager *)v19 updateAutoAssetStatus:v17 forActiveJobUUID:autoAssetUUID forJobResponse:responseMessage withResponseError:errorCopy];

  v44 = errorCopy;
  v40 = descriptorCopy;
  if (!v27)
  {
    v28 = objc_alloc_init(NSMutableDictionary);
    v39 = [SUCoreConnectMessage alloc];
    clientRequest2 = [infoCopy clientRequest];
    clientRequestMessage = [clientRequest2 clientRequestMessage];
    v31 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
    clientRequest3 = [infoCopy clientRequest];
    clientID = [clientRequest3 clientID];
    v27 = [v39 initWithType:2 messageName:v31 clientID:clientID version:0 message:v28];

    if (!v27)
    {
      v34 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
      {
        summary = [infoCopy summary];
        *buf = 138543618;
        v47 = requestCopy;
        v48 = 2114;
        v49 = summary;
        _os_log_impl(&dword_0, v34, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to build response message | eventInfo:%{public}@", buf, 0x16u);
      }
    }

    errorCopy = v44;
    v19 = selfCopy;
  }

  [(MADAutoAssetControlManager *)v19 issueBuiltResponseForEventInfo:infoCopy issuingResponseMessage:v27 withResponseError:errorCopy fromLocation:requestCopy];
  autoAssetClientName = [clientInstance autoAssetClientName];
  if (autoAssetClientName)
  {
    [clientInstance autoAssetClientName];
  }

  else
  {
    [clientInstance clientProcessName];
  }
  v37 = ;
  assetId = [v40 assetId];
  [MADAutoAssetHistory recordFailedOperation:500 fromClient:v37 forAssetID:assetId withSelector:v17 failingWithError:v44];
}

- (void)issueResponseToFailedSetLockRequest:(id)request forEventInfo:(id)info forAtomicInstance:(id)instance withResponseError:(id)error
{
  infoCopy = info;
  errorCopy = error;
  instanceCopy = instance;
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  setJobInformation = [infoCopy setJobInformation];
  clientInstance = [setJobInformation clientInstance];
  autoAssetSetClientName = [clientInstance autoAssetSetClientName];
  if (autoAssetSetClientName)
  {
    [clientInstance autoAssetSetClientName];
  }

  else
  {
    [clientInstance clientProcessName];
  }
  v16 = ;

  if (v16)
  {
    v17 = v16;
  }

  else
  {
    v17 = @"UNKNOWN";
  }

  clientDomainName = [clientInstance clientDomainName];
  assetSetIdentifier = [infoCopy assetSetIdentifier];
  clientRequest = [infoCopy clientRequest];
  responseMessage = [clientRequest responseMessage];
  v22 = [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:requestCopy forClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier forJobResponse:responseMessage withResponseError:errorCopy clearingDownloadProgressReason:@"failed attempt to lock set" withAssetSetStatus:0];

  [(MADAutoAssetControlManager *)self issueBuiltResponseForEventInfo:infoCopy issuingResponseMessage:v22 withResponseError:errorCopy fromLocation:requestCopy];
  clientDomainName2 = [clientInstance clientDomainName];
  v24 = clientDomainName2;
  if (clientDomainName2)
  {
    v25 = clientDomainName2;
  }

  else
  {
    v25 = @"UNKNOWN";
  }

  assetSetIdentifier2 = [clientInstance assetSetIdentifier];
  v27 = assetSetIdentifier2;
  if (assetSetIdentifier2)
  {
    v28 = assetSetIdentifier2;
  }

  else
  {
    v28 = @"UNKNOWN";
  }

  [MADAutoAssetHistory recordFailedOperation:500 fromClient:v17 forClientDomainName:v25 forAssetSetIdentifier:v28 forAtomicInstance:instanceCopy failingWithError:errorCopy];
}

- (id)clientRequestMessageName:(id)name
{
  clientRequestMessage = [name clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  return messageName;
}

- (id)clientRequestMessageInstance:(id)instance
{
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [instanceCopy clientRequestMessage];

  message = [clientRequestMessage message];

  v9 = [message objectForKey:@"instance"];
  if (!v9)
  {
    goto LABEL_31;
  }

  v10 = [message safeObjectForKey:@"instance" ofClass:objc_opt_class()];
  if (!v10)
  {
    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v47 = _updateLatestSummary;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageInstance} MAAutoAssetInfoInstance of unexpected class", buf, 0xCu);
    }

    goto LABEL_30;
  }

  v11 = v10;
  autoAssetClientName = [v10 autoAssetClientName];
  if (autoAssetClientName)
  {
    v13 = autoAssetClientName;
    clientProcessName = [v11 clientProcessName];
    if (clientProcessName)
    {
      v15 = clientProcessName;
      clientAssetSelector = [v11 clientAssetSelector];
      if (clientAssetSelector)
      {
        v17 = clientAssetSelector;
        clientAssetSelector2 = [v11 clientAssetSelector];
        assetType = [clientAssetSelector2 assetType];
        if (assetType)
        {
          v20 = assetType;
          clientAssetSelector3 = [v11 clientAssetSelector];
          [clientAssetSelector3 assetSpecifier];
          v22 = v44 = clientAssetSelector2;

          if (v22)
          {
            goto LABEL_32;
          }

          goto LABEL_14;
        }
      }
    }
  }

LABEL_14:
  selfCopy = self;
  v43 = v9;
  v45 = message;
  v40 = [NSMutableString alloc];
  autoAssetClientName2 = [v11 autoAssetClientName];
  v25 = @"autoAssetClientName";
  if (autoAssetClientName2)
  {
    v25 = &stru_4BD3F0;
  }

  v39 = v25;
  clientProcessName2 = [v11 clientProcessName];
  if (clientProcessName2)
  {
    v26 = &stru_4BD3F0;
  }

  else
  {
    v26 = @"clientProcessName";
  }

  clientAssetSelector4 = [v11 clientAssetSelector];
  if (clientAssetSelector4)
  {
    v28 = &stru_4BD3F0;
  }

  else
  {
    v28 = @"clientAssetSelector";
  }

  clientAssetSelector5 = [v11 clientAssetSelector];
  assetType2 = [clientAssetSelector5 assetType];
  if (assetType2)
  {
    v31 = &stru_4BD3F0;
  }

  else
  {
    v31 = @"assetType";
  }

  clientAssetSelector6 = [v11 clientAssetSelector];
  assetSpecifier = [clientAssetSelector6 assetSpecifier];
  v34 = @"assetSpecifier";
  if (assetSpecifier)
  {
    v34 = &stru_4BD3F0;
  }

  v23 = [v40 initWithFormat:@"(%@, %@, %@, %@, %@, %@)", &stru_4BD3F0, v39, v26, v28, v31, v34];

  v35 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
  {
    _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    *buf = 138543618;
    v47 = _updateLatestSummary2;
    v48 = 2114;
    v49 = v23;
    _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageInstance} invalid MAAutoAssetInfoInstance | missing:%{public}@", buf, 0x16u);
  }

  v9 = v43;
  message = v45;
LABEL_30:

LABEL_31:
  v11 = 0;
LABEL_32:

  return v11;
}

- (id)clientRequestMessageDesire:(id)desire
{
  desireCopy = desire;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  message = [desireCopy message];

  v8 = [message objectForKey:@"desire"];
  if (v8)
  {
    v9 = [message safeObjectForKey:@"desire" ofClass:objc_opt_class()];
    if (v9)
    {
      goto LABEL_7;
    }

    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v13 = 138543362;
      v14 = _updateLatestSummary;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageDesire} MAAutoAssetInfoDesire of unexpected class", &v13, 0xCu);
    }
  }

  v9 = 0;
LABEL_7:

  return v9;
}

- (BOOL)clientRequestIndicatesNoWait:(id)wait
{
  waitCopy = wait;
  clientRequestMessage = [waitCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v7 = [message safeObjectForKey:@"desire" ofClass:objc_opt_class()];
  clientReplyCompletion = [waitCopy clientReplyCompletion];

  v9 = 0;
  if (clientReplyCompletion && v7)
  {
    clientRequest = [waitCopy clientRequest];
    v11 = [(MADAutoAssetControlManager *)self clientRequestMessageName:clientRequest];

    if ([SUCore stringIsEqual:v11 to:@"MA-AUTO:CHECK_FOR_NEWER"])
    {
      v9 = [v7 checkWaitTimeoutSecs] == 0;
    }

    else
    {
      v9 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v11, @"MA-AUTO:LOCK_CONTENT") && (![v7 checkWaitTimeoutSecs] || !objc_msgSend(v7, "lockWaitTimeoutSecs"));
    }
  }

  return v9;
}

- (id)clientRequestMessageSetInstance:(id)instance withEventInfo:(id)info
{
  instanceCopy = instance;
  infoCopy = info;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [infoCopy clientRequestMessage];

  message = [clientRequestMessage message];

  v12 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:message forKey:@"setInstance"];
  v13 = v12;
  if (v12)
  {
    autoAssetSetClientName = [v12 autoAssetSetClientName];
    if (autoAssetSetClientName)
    {
      v15 = autoAssetSetClientName;
      clientProcessName = [v13 clientProcessName];
      if (!clientProcessName)
      {
        selfCopy3 = self;
        v33 = message;
        v19 = instanceCopy;

        goto LABEL_8;
      }

      v17 = clientProcessName;
      assetSetIdentifier = [v13 assetSetIdentifier];

      if (assetSetIdentifier)
      {
        goto LABEL_20;
      }
    }

    selfCopy3 = self;
    v33 = message;
    v19 = instanceCopy;
LABEL_8:
    v20 = &stru_4BD3F0;
    goto LABEL_9;
  }

  selfCopy3 = self;
  v33 = message;
  v19 = instanceCopy;
  v20 = @"instance";
LABEL_9:
  v21 = [NSMutableString alloc];
  autoAssetSetClientName2 = [v13 autoAssetSetClientName];
  if (autoAssetSetClientName2)
  {
    v23 = &stru_4BD3F0;
  }

  else
  {
    v23 = @"autoAssetSetClientName";
  }

  clientProcessName2 = [v13 clientProcessName];
  if (clientProcessName2)
  {
    v25 = &stru_4BD3F0;
  }

  else
  {
    v25 = @"clientProcessName";
  }

  assetSetIdentifier2 = [v13 assetSetIdentifier];
  v27 = @"assetSetIdentifier";
  if (assetSetIdentifier2)
  {
    v27 = &stru_4BD3F0;
  }

  v28 = [v21 initWithFormat:@"(%@, %@, %@, %@)", v20, v23, v25, v27];

  v29 = _MADLog(@"AutoControl");
  instanceCopy = v19;
  if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy3 _updateLatestSummary];
    *buf = 138543874;
    v35 = v19;
    v36 = 2114;
    v37 = _updateLatestSummary;
    v38 = 2114;
    v39 = v28;
    _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:clientRequestMessageSetInstance} invalid MANAutoAssetSetInfoInstance | missing:%{public}@", buf, 0x20u);
  }

  v13 = 0;
  message = v33;
LABEL_20:

  return v13;
}

- (id)clientRequestMessageSetDesire:(id)desire
{
  desireCopy = desire;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [desireCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v9 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:message forKey:@"setDesire"];
  if (!v9)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [desireCopy summary];
      v14 = 138543618;
      v15 = _updateLatestSummary;
      v16 = 2114;
      v17 = summary;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetDesire} MISSING:desire | clientRequest:%{public}@", &v14, 0x16u);
    }
  }

  return v9;
}

- (id)clientRequestMessageSetPolicy:(id)policy
{
  policyCopy = policy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  messageName = [policyCopy messageName];
  message = [policyCopy message];
  v9 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:message forKey:@"setDesire"];
  v10 = v9;
  if (v9)
  {
    clientAssetSetPolicy = [v9 clientAssetSetPolicy];
  }

  else
  {
    if (([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"])
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [policyCopy summary];
        v16 = 138543618;
        v17 = _updateLatestSummary;
        v18 = 2114;
        v19 = summary;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetPolicy} MISSING:desire | clientRequestMessage:%{public}@", &v16, 0x16u);
      }
    }

    clientAssetSetPolicy = 0;
  }

  return clientAssetSetPolicy;
}

- (id)clientRequestMessageSetEnd:(id)end
{
  endCopy = end;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [endCopy clientRequestMessage];
  message = [clientRequestMessage message];

  v9 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:message forKey:@"setEnd"];
  if (!v9)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [endCopy summary];
      v14 = 138543618;
      v15 = _updateLatestSummary;
      v16 = 2114;
      v17 = summary;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_ERROR, "[%{public}@] {clientRequestMessageSetEnd} MISSING:end | clientRequest:%{public}@", &v14, 0x16u);
    }
  }

  return v9;
}

+ (BOOL)isMessageNameForSetMessage:(id)message
{
  messageCopy = message;
  v4 = ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):CHECK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):LOCK_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC"]& 1) != 0
    || ([SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET-CONTROL(REPLY):ASSET_SETS_OVERVIEW"]& 1) != 0
    || [SUCore stringIsEqual:messageCopy to:@"MA-AUTO-SET-CONTROL(REPLY):SET_INSTANCE_INFO"];

  return v4;
}

+ (id)replyMessageNameForRequest:(id)request
{
  requestCopy = request;
  messageName = [requestCopy messageName];
  v5 = [SUCore stringIsEqual:messageName to:@"MA-AUTO:INTEREST_IN_CONTENT"];

  if (v5)
  {
    v6 = @"MA-AUTO(REPLY):INTEREST_IN_CONTENT";
  }

  else
  {
    messageName2 = [requestCopy messageName];
    v8 = [SUCore stringIsEqual:messageName2 to:@"MA-AUTO:CHECK_FOR_NEWER"];

    if (v8)
    {
      v6 = @"MA-AUTO(REPLY):CHECK_FOR_NEWER";
    }

    else
    {
      messageName3 = [requestCopy messageName];
      v10 = [SUCore stringIsEqual:messageName3 to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"];

      if (v10)
      {
        v6 = @"MA-AUTO(REPLY):DETERMINE_IF_AVAILABLE";
      }

      else
      {
        messageName4 = [requestCopy messageName];
        v12 = [SUCore stringIsEqual:messageName4 to:@"MA-AUTO:CURRENT_STATUS"];

        if (v12)
        {
          v6 = @"MA-AUTO(REPLY):CURRENT_STATUS";
        }

        else
        {
          messageName5 = [requestCopy messageName];
          v14 = [SUCore stringIsEqual:messageName5 to:@"MA-AUTO:LOCK_CONTENT"];

          if (v14)
          {
            v6 = @"MA-AUTO(REPLY):LOCK_CONTENT";
          }

          else
          {
            messageName6 = [requestCopy messageName];
            v16 = [SUCore stringIsEqual:messageName6 to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"];

            if (v16)
            {
              v6 = @"MA-AUTO(REPLY):MAP_LOCKED_CONTENT_TO_EXCLAVE";
            }

            else
            {
              messageName7 = [requestCopy messageName];
              v18 = [SUCore stringIsEqual:messageName7 to:@"MA-AUTO:CONTINUE_LOCK_USAGE"];

              if (v18)
              {
                v6 = @"MA-AUTO(REPLY):CONTINUE_LOCK_USAGE";
              }

              else
              {
                messageName8 = [requestCopy messageName];
                v20 = [SUCore stringIsEqual:messageName8 to:@"MA-AUTO:END_LOCK_USAGE"];

                if (v20)
                {
                  v6 = @"MA-AUTO(REPLY):END_LOCK_USAGE";
                }

                else
                {
                  messageName9 = [requestCopy messageName];
                  v22 = [SUCore stringIsEqual:messageName9 to:@"MA-AUTO:END_PREVIOUS_LOCKS"];

                  if (v22)
                  {
                    v6 = @"MA-AUTO(REPLY):END_PREVIOUS_LOCKS";
                  }

                  else
                  {
                    messageName10 = [requestCopy messageName];
                    v24 = [SUCore stringIsEqual:messageName10 to:@"MA-AUTO:END_ALL_PREVIOUS_LOCKS"];

                    if (v24)
                    {
                      v6 = @"MA-AUTO(REPLY):END_ALL_PREVIOUS_LOCKS";
                    }

                    else
                    {
                      messageName11 = [requestCopy messageName];
                      v26 = [SUCore stringIsEqual:messageName11 to:@"MA-AUTO:CANCEL_ACTIVITY_FOR_SELECTOR"];

                      if (v26)
                      {
                        v6 = @"MA-AUTO(REPLY):CANCEL_ACTIVITY_FOR_SELECTOR";
                      }

                      else
                      {
                        messageName12 = [requestCopy messageName];
                        v28 = [SUCore stringIsEqual:messageName12 to:@"MA-AUTO:ELIMINATE_ALL_FOR_SELECTOR"];

                        if (v28)
                        {
                          v6 = @"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_SELECTOR";
                        }

                        else
                        {
                          messageName13 = [requestCopy messageName];
                          v30 = [SUCore stringIsEqual:messageName13 to:@"MA-AUTO:ELIMINATE_ALL_FOR_ASSET_TYPE"];

                          if (v30)
                          {
                            v6 = @"MA-AUTO(REPLY):ELIMINATE_ALL_FOR_ASSET_TYPE";
                          }

                          else
                          {
                            messageName14 = [requestCopy messageName];
                            v32 = [SUCore stringIsEqual:messageName14 to:@"MA-AUTO:ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR"];

                            if (v32)
                            {
                              v6 = @"MA-AUTO(REPLY):ELIMINATE_PROMOTED_NEVER_LOCKED_FOR_SELECTOR";
                            }

                            else
                            {
                              messageName15 = [requestCopy messageName];
                              v34 = [SUCore stringIsEqual:messageName15 to:@"MA-AUTO-STAGE:DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE"];

                              if (v34)
                              {
                                v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_GROUPS_AVAILABLE_FOR_UPDATE";
                              }

                              else
                              {
                                messageName16 = [requestCopy messageName];
                                v36 = [SUCore stringIsEqual:messageName16 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE_FOR_UPDATE"];

                                if (v36)
                                {
                                  v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE_FOR_UPDATE";
                                }

                                else
                                {
                                  messageName17 = [requestCopy messageName];
                                  v38 = [SUCore stringIsEqual:messageName17 to:@"MA-AUTO-STAGE:DETERMINE_ALL_AVAILABLE"];

                                  if (v38)
                                  {
                                    v6 = @"MA-AUTO-STAGE(REPLY):DETERMINE_ALL_AVAILABLE";
                                  }

                                  else
                                  {
                                    messageName18 = [requestCopy messageName];
                                    v40 = [SUCore stringIsEqual:messageName18 to:@"MA-AUTO-STAGE:DOWNLOAD_GROUPS"];

                                    if (v40)
                                    {
                                      v6 = @"MA-AUTO-STAGE(REPLY):DOWNLOAD_GROUPS";
                                    }

                                    else
                                    {
                                      messageName19 = [requestCopy messageName];
                                      v42 = [SUCore stringIsEqual:messageName19 to:@"MA-AUTO-STAGE:DOWNLOAD_ALL"];

                                      if (v42)
                                      {
                                        v6 = @"MA-AUTO-STAGE(REPLY):DOWNLOAD_ALL";
                                      }

                                      else
                                      {
                                        messageName20 = [requestCopy messageName];
                                        v44 = [SUCore stringIsEqual:messageName20 to:@"MA-AUTO-STAGE:CANCEL_OPERATION"];

                                        if (v44)
                                        {
                                          v6 = @"MA-AUTO-STAGE(REPLY):CANCEL_OPERATION";
                                        }

                                        else
                                        {
                                          messageName21 = [requestCopy messageName];
                                          v46 = [SUCore stringIsEqual:messageName21 to:@"MA-AUTO-STAGE:PURGE_ALL"];

                                          if (v46)
                                          {
                                            v6 = @"MA-AUTO-STAGE(REPLY):PURGE_ALL";
                                          }

                                          else
                                          {
                                            messageName22 = [requestCopy messageName];
                                            v48 = [SUCore stringIsEqual:messageName22 to:@"MA-AUTO-STAGE:ERASE_ALL"];

                                            if (v48)
                                            {
                                              v6 = @"MA-AUTO-STAGE(REPLY):ERASE_ALL";
                                            }

                                            else
                                            {
                                              messageName23 = [requestCopy messageName];
                                              v50 = [SUCore stringIsEqual:messageName23 to:@"MA-AUTO-SUSPEND-RESUME-SU:EVICTABLE_BYTES"];

                                              if (v50)
                                              {
                                                v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):EVICTABLE_BYTES";
                                              }

                                              else
                                              {
                                                messageName24 = [requestCopy messageName];
                                                v52 = [SUCore stringIsEqual:messageName24 to:@"MA-AUTO-SUSPEND-RESUME-SU:SUSPEND"];

                                                if (v52)
                                                {
                                                  v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):SUSPEND";
                                                }

                                                else
                                                {
                                                  messageName25 = [requestCopy messageName];
                                                  v54 = [SUCore stringIsEqual:messageName25 to:@"MA-AUTO-SUSPEND-RESUME-SU:RESUME"];

                                                  if (v54)
                                                  {
                                                    v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):RESUME";
                                                  }

                                                  else
                                                  {
                                                    messageName26 = [requestCopy messageName];
                                                    v56 = [SUCore stringIsEqual:messageName26 to:@"MA-AUTO-SUSPEND-RESUME-SU:STATUS"];

                                                    if (v56)
                                                    {
                                                      v6 = @"MA-AUTO-SUSPEND-RESUME-SU(REPLY):STATUS";
                                                    }

                                                    else
                                                    {
                                                      messageName27 = [requestCopy messageName];
                                                      v58 = [SUCore stringIsEqual:messageName27 to:@"MA-AUTO-CONTROL:CONTROL_STATISTICS"];

                                                      if (v58)
                                                      {
                                                        v6 = @"MA-AUTO-CONTROL(REPLY):CONTROL_STATISTICS";
                                                      }

                                                      else
                                                      {
                                                        messageName28 = [requestCopy messageName];
                                                        v60 = [SUCore stringIsEqual:messageName28 to:@"MA-AUTO-CONTROL:KNOWN_ASSET_SUMMARY"];

                                                        if (v60)
                                                        {
                                                          v6 = @"MA-AUTO-CONTROL(REPLY):KNOWN_ASSET_SUMMARY";
                                                        }

                                                        else
                                                        {
                                                          messageName29 = [requestCopy messageName];
                                                          v62 = [SUCore stringIsEqual:messageName29 to:@"MA-AUTO-CONTROL:AVAILABLE_FOR_STAGING_ASSET_SUMMARY"];

                                                          if (v62)
                                                          {
                                                            v6 = @"MA-AUTO-CONTROL(REPLY):AVAILABLE_FOR_STAGING_ASSET_SUMMARY";
                                                          }

                                                          else
                                                          {
                                                            messageName30 = [requestCopy messageName];
                                                            v64 = [SUCore stringIsEqual:messageName30 to:@"MA-AUTO-CONTROL:ACTIVE_JOB_SUMMARY"];

                                                            if (v64)
                                                            {
                                                              v6 = @"MA-AUTO-CONTROL(REPLY):ACTIVE_JOB_SUMMARY";
                                                            }

                                                            else
                                                            {
                                                              messageName31 = [requestCopy messageName];
                                                              v66 = [SUCore stringIsEqual:messageName31 to:@"MA-AUTO-CONTROL:SCHEDULED_JOB_SUMMARY"];

                                                              if (v66)
                                                              {
                                                                v6 = @"MA-AUTO-CONTROL(REPLY):SCHEDULED_JOB_SUMMARY";
                                                              }

                                                              else
                                                              {
                                                                messageName32 = [requestCopy messageName];
                                                                v68 = [SUCore stringIsEqual:messageName32 to:@"MA-AUTO-CONTROL:LOCKED_ASSET_SUMMARY"];

                                                                if (v68)
                                                                {
                                                                  v6 = @"MA-AUTO-CONTROL(REPLY):LOCKED_ASSET_SUMMARY";
                                                                }

                                                                else
                                                                {
                                                                  messageName33 = [requestCopy messageName];
                                                                  v70 = [SUCore stringIsEqual:messageName33 to:@"MA-AUTO-CONTROL:STAGED_ASSET_SUMMARY"];

                                                                  if (v70)
                                                                  {
                                                                    v6 = @"MA-AUTO-CONTROL(REPLY):STAGED_ASSET_SUMMARY";
                                                                  }

                                                                  else
                                                                  {
                                                                    messageName34 = [requestCopy messageName];
                                                                    v72 = [SUCore stringIsEqual:messageName34 to:@"MA-AUTO-CONTROL:STAGER_OVERVIEW"];

                                                                    if (v72)
                                                                    {
                                                                      v6 = @"MA-AUTO-CONTROL(REPLY):STAGER_OVERVIEW";
                                                                    }

                                                                    else
                                                                    {
                                                                      messageName35 = [requestCopy messageName];
                                                                      v74 = [SUCore stringIsEqual:messageName35 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_UNLOCK"];

                                                                      if (v74)
                                                                      {
                                                                        v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_UNLOCK";
                                                                      }

                                                                      else
                                                                      {
                                                                        messageName36 = [requestCopy messageName];
                                                                        v76 = [SUCore stringIsEqual:messageName36 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_FORGET"];

                                                                        if (v76)
                                                                        {
                                                                          v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_FORGET";
                                                                        }

                                                                        else
                                                                        {
                                                                          messageName37 = [requestCopy messageName];
                                                                          v78 = [SUCore stringIsEqual:messageName37 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_PURGE"];

                                                                          if (v78)
                                                                          {
                                                                            v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_PURGE";
                                                                          }

                                                                          else
                                                                          {
                                                                            messageName38 = [requestCopy messageName];
                                                                            v80 = [SUCore stringIsEqual:messageName38 to:@"MA-AUTO-CONTROL:FORCE_GLOBAL_ABANDON"];

                                                                            if (v80)
                                                                            {
                                                                              v6 = @"MA-AUTO-CONTROL(REPLY):FORCE_GLOBAL_ABANDON";
                                                                            }

                                                                            else
                                                                            {
                                                                              messageName39 = [requestCopy messageName];
                                                                              v82 = [SUCore stringIsEqual:messageName39 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE"];

                                                                              if (v82)
                                                                              {
                                                                                v6 = @"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_DETERMINE_RECLAIMABLE";
                                                                              }

                                                                              else
                                                                              {
                                                                                messageName40 = [requestCopy messageName];
                                                                                v84 = [SUCore stringIsEqual:messageName40 to:@"MA-AUTO-CONTROL:SIM_CACHE_DELETE_RECLAIM_SPACE"];

                                                                                if (v84)
                                                                                {
                                                                                  v6 = @"MA-AUTO-CONTROL(REPLY):SIM_CACHE_DELETE_RECLAIM_SPACE";
                                                                                }

                                                                                else
                                                                                {
                                                                                  messageName41 = [requestCopy messageName];
                                                                                  v86 = [SUCore stringIsEqual:messageName41 to:@"MA-AUTO-CONTROL:SIM_SET_JOB_OPERATION"];

                                                                                  if (v86)
                                                                                  {
                                                                                    v6 = @"MA-AUTO-CONTROL(REPLY):SIM_SET_JOB_OPERATION";
                                                                                  }

                                                                                  else
                                                                                  {
                                                                                    messageName42 = [requestCopy messageName];
                                                                                    v88 = [SUCore stringIsEqual:messageName42 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"];

                                                                                    if (v88)
                                                                                    {
                                                                                      v6 = @"MA-AUTO-SET(REPLY):ALTER_ENTRIES_REPRESENTING_ATOMIC";
                                                                                    }

                                                                                    else
                                                                                    {
                                                                                      messageName43 = [requestCopy messageName];
                                                                                      v90 = [SUCore stringIsEqual:messageName43 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"];

                                                                                      if (v90)
                                                                                      {
                                                                                        v6 = @"MA-AUTO-SET(REPLY):NEED_FOR_ATOMIC";
                                                                                      }

                                                                                      else
                                                                                      {
                                                                                        messageName44 = [requestCopy messageName];
                                                                                        v92 = [SUCore stringIsEqual:messageName44 to:@"MA-AUTO-SET:CHECK_ATOMIC"];

                                                                                        if (v92)
                                                                                        {
                                                                                          v6 = @"MA-AUTO-SET(REPLY):CHECK_ATOMIC";
                                                                                        }

                                                                                        else
                                                                                        {
                                                                                          messageName45 = [requestCopy messageName];
                                                                                          v94 = [SUCore stringIsEqual:messageName45 to:@"MA-AUTO-SET:LOCK_ATOMIC"];

                                                                                          if (v94)
                                                                                          {
                                                                                            v6 = @"MA-AUTO-SET(REPLY):LOCK_ATOMIC";
                                                                                          }

                                                                                          else
                                                                                          {
                                                                                            messageName46 = [requestCopy messageName];
                                                                                            v96 = [SUCore stringIsEqual:messageName46 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];

                                                                                            if (v96)
                                                                                            {
                                                                                              v6 = @"MA-AUTO-SET(REPLY):MAP_LOCKED_ATOMIC_ENTRY";
                                                                                            }

                                                                                            else
                                                                                            {
                                                                                              messageName47 = [requestCopy messageName];
                                                                                              v98 = [SUCore stringIsEqual:messageName47 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"];

                                                                                              if (v98)
                                                                                              {
                                                                                                v6 = @"MA-AUTO-SET(REPLY):FORM_SUB_ATOMIC";
                                                                                              }

                                                                                              else
                                                                                              {
                                                                                                messageName48 = [requestCopy messageName];
                                                                                                v100 = [SUCore stringIsEqual:messageName48 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"];

                                                                                                if (v100)
                                                                                                {
                                                                                                  v6 = @"MA-AUTO-SET(REPLY):CONTINUE_ATOMIC_LOCK";
                                                                                                }

                                                                                                else
                                                                                                {
                                                                                                  messageName49 = [requestCopy messageName];
                                                                                                  v102 = [SUCore stringIsEqual:messageName49 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"];

                                                                                                  if (v102)
                                                                                                  {
                                                                                                    v6 = @"MA-AUTO-SET(REPLY):END_ATOMIC_LOCK";
                                                                                                  }

                                                                                                  else
                                                                                                  {
                                                                                                    messageName50 = [requestCopy messageName];
                                                                                                    v104 = [SUCore stringIsEqual:messageName50 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"];

                                                                                                    if (v104)
                                                                                                    {
                                                                                                      v6 = @"MA-AUTO-SET(REPLY):END_ATOMIC_LOCKS_FOR_CLIENT";
                                                                                                    }

                                                                                                    else
                                                                                                    {
                                                                                                      messageName51 = [requestCopy messageName];
                                                                                                      v106 = [SUCore stringIsEqual:messageName51 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];

                                                                                                      if (v106)
                                                                                                      {
                                                                                                        v6 = @"MA-AUTO-SET(REPLY):ASSET_SET_FOR_STAGING";
                                                                                                      }

                                                                                                      else
                                                                                                      {
                                                                                                        messageName52 = [requestCopy messageName];
                                                                                                        v108 = [SUCore stringIsEqual:messageName52 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"];

                                                                                                        if (v108)
                                                                                                        {
                                                                                                          v6 = @"MA-AUTO-SET(REPLY):CURRENT_SET_STATUS";
                                                                                                        }

                                                                                                        else
                                                                                                        {
                                                                                                          messageName53 = [requestCopy messageName];
                                                                                                          v110 = [SUCore stringIsEqual:messageName53 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"];

                                                                                                          if (v110)
                                                                                                          {
                                                                                                            v6 = @"MA-AUTO-SET(REPLY):ELIMINATE_ATOMIC";
                                                                                                          }

                                                                                                          else
                                                                                                          {
                                                                                                            messageName54 = [requestCopy messageName];
                                                                                                            v112 = [SUCore stringIsEqual:messageName54 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"];

                                                                                                            if (v112)
                                                                                                            {
                                                                                                              v6 = @"MA-AUTO-SET-CONTROL(REPLY):ASSET_SETS_OVERVIEW";
                                                                                                            }

                                                                                                            else
                                                                                                            {
                                                                                                              messageName55 = [requestCopy messageName];
                                                                                                              v114 = [SUCore stringIsEqual:messageName55 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];

                                                                                                              if (v114)
                                                                                                              {
                                                                                                                v6 = @"MA-AUTO-SET-CONTROL(REPLY):SET_INSTANCE_INFO";
                                                                                                              }

                                                                                                              else
                                                                                                              {
                                                                                                                v6 = @"UNKNOWN_REQUEST_NAME";
                                                                                                              }
                                                                                                            }
                                                                                                          }
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }

  return v6;
}

+ (id)newSummaryForRequestMessage:(id)message includingSelector:(BOOL)selector
{
  selectorCopy = selector;
  messageCopy = message;
  v6 = [NSMutableString alloc];
  messageName = [messageCopy messageName];
  v8 = [v6 initWithFormat:@"%@", messageName];

  message = [messageCopy message];

  if (message)
  {
    messageName2 = [messageCopy messageName];
    v11 = [MADAutoAssetControlManager isMessageNameForSetMessage:messageName2];

    if (v11)
    {
      message2 = [messageCopy message];
      v13 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:message2 forKey:@"setInstance"];

      message3 = [messageCopy message];
      v15 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:message3 forKey:@"setDesire"];

      message4 = [messageCopy message];
      v17 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:message4 forKey:@"setEnd"];

      message5 = [messageCopy message];
      v19 = [MASAutoAssetSetInfoControl newShimmedFromFrameworkMessage:message5 forKey:@"setControl"];

      if (v13)
      {
        if (selectorCopy)
        {
          summary = [v13 summary];
        }

        else
        {
          v48 = [NSString alloc];
          autoAssetSetClientName = [v13 autoAssetSetClientName];
          clientProcessName = [v13 clientProcessName];
          clientProcessID = [v13 clientProcessID];
          atomicInstance = [v13 atomicInstance];
          if (atomicInstance)
          {
            atomicInstance2 = [v13 atomicInstance];
          }

          else
          {
            atomicInstance2 = @"N";
          }

          autoAssetEntries = [v13 autoAssetEntries];
          if (autoAssetEntries)
          {
            v36 = [NSString alloc];
            autoAssetEntries2 = [v13 autoAssetEntries];
            v49 = [v36 initWithFormat:@"%ld", objc_msgSend(autoAssetEntries2, "count")];
          }

          else
          {
            v49 = @"N";
          }

          entriesWhenTargeting = [v13 entriesWhenTargeting];
          if (entriesWhenTargeting)
          {
            v38 = [NSString alloc];
            [v13 entriesWhenTargeting];
            v39 = v45 = atomicInstance;
            v40 = [v38 initWithFormat:@"%ld", objc_msgSend(v39, "count")];
            summary = [v48 initWithFormat:@"clientName:%@|processName:%@|pid:%ld|atomicInstance:%@|entries:%@(WhenTargeting:%@)", autoAssetSetClientName, clientProcessName, clientProcessID, atomicInstance2, v49, v40];

            atomicInstance = v45;
          }

          else
          {
            summary = [v48 initWithFormat:@"clientName:%@|processName:%@|pid:%ld|atomicInstance:%@|entries:%@(WhenTargeting:%@)", autoAssetSetClientName, clientProcessName, clientProcessID, atomicInstance2, v49, @"N"];
          }

          if (autoAssetEntries)
          {
          }

          if (atomicInstance)
          {
          }
        }

        [v8 appendFormat:@"[instance:%@]", summary];
      }

      if (v15)
      {
        summary2 = [v15 summary];
        [v8 appendFormat:@"[desire:%@]", summary2];
      }

      if (v17)
      {
        summary3 = [v17 summary];
        [v8 appendFormat:@"[end:%@]", summary3];
      }

      if (!v19)
      {
        goto LABEL_41;
      }

      summary4 = [v19 summary];
      [v8 appendFormat:@"[control:%@]", summary4];
    }

    else
    {
      message6 = [messageCopy message];
      v13 = [message6 safeObjectForKey:@"instance" ofClass:objc_opt_class()];

      message7 = [messageCopy message];
      v15 = [message7 safeObjectForKey:@"desire" ofClass:objc_opt_class()];

      message8 = [messageCopy message];
      v17 = [message8 safeObjectForKey:@"listen" ofClass:objc_opt_class()];

      message9 = [messageCopy message];
      v19 = [message9 safeObjectForKey:@"end" ofClass:objc_opt_class()];

      message10 = [messageCopy message];
      summary4 = [MASAutoAssetInfoControl newShimmedFromFrameworkMessage:message10 forKey:@"control"];

      if (v13)
      {
        if (selectorCopy)
        {
          summary5 = [v13 summary];
        }

        else
        {
          v29 = [NSString alloc];
          autoAssetClientName = [v13 autoAssetClientName];
          clientProcessName2 = [v13 clientProcessName];
          summary5 = [v29 initWithFormat:@"%@(%@:%ld)", autoAssetClientName, clientProcessName2, objc_msgSend(v13, "clientProcessID")];
        }

        [v8 appendFormat:@"[instance:%@]", summary5];
      }

      if (v15)
      {
        summary6 = [v15 summary];
        [v8 appendFormat:@"[desire:%@]", summary6];
      }

      if (v17)
      {
        summary7 = [v17 summary];
        [v8 appendFormat:@"[listen:%@]", summary7];
      }

      if (v19)
      {
        summary8 = [v19 summary];
        [v8 appendFormat:@"[end:%@]", summary8];
      }

      if (summary4)
      {
        v26Summary = [summary4 summary];
        [v8 appendFormat:@"[control:%@]", v26Summary];
      }
    }

LABEL_41:
  }

  return v8;
}

+ (id)assetTypeForClientDomainName:(id)name forSetIdentifier:(id)identifier alreadyOnStateQueue:(BOOL)queue
{
  queueCopy = queue;
  nameCopy = name;
  identifierCopy = identifier;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v10 = v9;
  v27 = 0;
  v28 = &v27;
  v29 = 0x3032000000;
  v30 = __Block_byref_object_copy__12;
  v31 = __Block_byref_object_dispose__12;
  v32 = 0;
  if (queueCopy)
  {
    autoControlManagerFSM = [v9 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
    dispatch_assert_queue_V2(extendedStateQueue);

    v13 = [v10 setConfigurationForClientDomain:nameCopy forAssetSetIdentifier:identifierCopy];
    firstEntryAssetType = [v13 firstEntryAssetType];
    v15 = v28[5];
    v28[5] = firstEntryAssetType;
  }

  else
  {
    autoControlManagerFSM2 = [v9 autoControlManagerFSM];

    if (autoControlManagerFSM2)
    {
      autoControlManagerFSM3 = [v10 autoControlManagerFSM];
      extendedStateQueue2 = [autoControlManagerFSM3 extendedStateQueue];
      v21[0] = _NSConcreteStackBlock;
      v21[1] = 3221225472;
      v21[2] = __96__MADAutoAssetControlManager_assetTypeForClientDomainName_forSetIdentifier_alreadyOnStateQueue___block_invoke;
      v21[3] = &unk_4B48A0;
      v22 = v10;
      v23 = nameCopy;
      v24 = identifierCopy;
      v25 = &v27;
      dispatch_sync(extendedStateQueue2, v21);

      v13 = v22;
    }

    else
    {
      v13 = _MADLog(@"Auto");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "AUTO:{assetTypeForClientDomainName} Returning nil for asset type since FSM is not initialized", buf, 2u);
      }
    }
  }

  v19 = v28[5];
  _Block_object_dispose(&v27, 8);

  return v19;
}

void __96__MADAutoAssetControlManager_assetTypeForClientDomainName_forSetIdentifier_alreadyOnStateQueue___block_invoke(uint64_t a1)
{
  v5 = [*(a1 + 32) setConfigurationForClientDomain:*(a1 + 40) forAssetSetIdentifier:*(a1 + 48)];
  v2 = [v5 firstEntryAssetType];
  v3 = *(*(a1 + 56) + 8);
  v4 = *(v3 + 40);
  *(v3 + 40) = v2;
}

+ (id)newSummaryForSetRequestMessage:(id)message includingSetAtomicInstance:(BOOL)instance
{
  instanceCopy = instance;
  messageCopy = message;
  v6 = [NSMutableString alloc];
  messageName = [messageCopy messageName];
  v8 = [v6 initWithFormat:@"%@", messageName];

  message = [messageCopy message];

  if (message)
  {
    message2 = [messageCopy message];
    v11 = [MASAutoAssetSetInfoInstance newShimmedFromFrameworkMessage:message2 forKey:@"setInstance"];

    message3 = [messageCopy message];
    v13 = [MASAutoAssetSetInfoDesire newShimmedFromFrameworkMessage:message3 forKey:@"desire"];

    message4 = [messageCopy message];
    v15 = [MASAutoAssetSetInfoEnd newShimmedFromFrameworkMessage:message4 forKey:@"end"];

    if (v11)
    {
      if (instanceCopy)
      {
        summary = [v11 summary];
      }

      else
      {
        v30 = [NSString alloc];
        clientDomainName = [v11 clientDomainName];
        autoAssetSetClientName = [v11 autoAssetSetClientName];
        clientProcessName = [v11 clientProcessName];
        clientProcessID = [v11 clientProcessID];
        assetSetIdentifier = [v11 assetSetIdentifier];
        atomicInstance = [v11 atomicInstance];
        if (atomicInstance)
        {
          atomicInstance2 = [v11 atomicInstance];
        }

        else
        {
          atomicInstance2 = @"N";
        }

        autoAssetEntries = [v11 autoAssetEntries];
        if (autoAssetEntries)
        {
          v19 = [NSString alloc];
          autoAssetEntries2 = [v11 autoAssetEntries];
          v31 = [v19 initWithFormat:@"%ld", objc_msgSend(autoAssetEntries2, "count")];
        }

        else
        {
          v31 = @"N";
        }

        entriesWhenTargeting = [v11 entriesWhenTargeting];
        if (entriesWhenTargeting)
        {
          v21 = [NSString alloc];
          [v11 entriesWhenTargeting];
          v22 = v28 = atomicInstance;
          v23 = [v21 initWithFormat:@"%ld", objc_msgSend(v22, "count")];
          summary = [v30 initWithFormat:@"domainName:%@|clientName:%@|processName:%@|pid:%ld|setIdentifier:%@|atomicInstance:%@|entries:%@(WhenTargeting:%@)", clientDomainName, autoAssetSetClientName, clientProcessName, clientProcessID, assetSetIdentifier, atomicInstance2, v31, v23];

          atomicInstance = v28;
        }

        else
        {
          summary = [v30 initWithFormat:@"domainName:%@|clientName:%@|processName:%@|pid:%ld|setIdentifier:%@|atomicInstance:%@|entries:%@(WhenTargeting:%@)", clientDomainName, autoAssetSetClientName, clientProcessName, clientProcessID, assetSetIdentifier, atomicInstance2, v31, @"N"];
        }

        if (autoAssetEntries)
        {
        }

        if (atomicInstance)
        {
        }
      }

      [v8 appendFormat:@"[instance:%@]", summary];
    }

    if (v13)
    {
      summary2 = [v13 summary];
      [v8 appendFormat:@"[desire:%@]", summary2];
    }

    if (v15)
    {
      summary3 = [v15 summary];
      [v8 appendFormat:@"[end:%@]", summary3];
    }
  }

  return v8;
}

- (void)eliminateUngraftDescriptor:(id)descriptor forAutoAssetDescriptor:(id)assetDescriptor failingClientRequestForEventInfo:(id)info
{
  assetDescriptorCopy = assetDescriptor;
  infoCopy = info;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:eliminateUngraftDescriptor", descriptorCopy];
  v13 = [MAAutoAssetError buildError:6114 fromOperation:descriptorCopy underlyingError:0 withDescription:@"auto-asset eliminate occurred when had been personalizing / grafting [or mounting]"];
  v14 = [MAAutoAssetSelector alloc];
  assetType = [assetDescriptorCopy assetType];
  assetSpecifier = [assetDescriptorCopy assetSpecifier];
  assetVersion = [assetDescriptorCopy assetVersion];
  v18 = [v14 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  v19 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:v18];
  [(MADAutoAssetControlManager *)self secureForceUngraft:descriptorCopy forDescriptorBeingRemoved:assetDescriptorCopy];
  if (infoCopy)
  {
    [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:descriptorCopy forEventInfo:infoCopy withResponseError:v13 forAttemptedDescriptor:assetDescriptorCopy];
  }

  if ([assetDescriptorCopy secureOperationEliminating])
  {
    if (v19)
    {
      [(MADAutoAssetControlManager *)self _eliminateSecureOperationFinished:v19 forEliminateDescriptor:assetDescriptorCopy];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v22 = [NSString alloc];
      summary = [assetDescriptorCopy summary];
      v24 = [v22 initWithFormat:@"{%@} no eliminateTracker | beingEliminatedDescriptor:%@", descriptorCopy, summary];
      [diag trackAnomaly:@"ELIMINATE|AUTO-SECURE" forReason:v24 withResult:6111 withError:0];
    }
  }
}

- (void)eliminateUngraftSetDescriptor:(id)descriptor failingClientRequestForEventInfo:(id)info
{
  descriptorCopy = descriptor;
  infoCopy = info;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9 = [MAAutoAssetError buildError:6114 fromOperation:@"eliminateUngraftSetDescriptor" underlyingError:0 withDescription:@"auto-asset-set eliminate occurred when had been personalizing / grafting [or mounting]"];
  v10 = [MAAutoAssetSelector alloc];
  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v13 = [v10 initForAssetType:clientDomainName withAssetSpecifier:assetSetIdentifier];

  v14 = [(MADAutoAssetControlManager *)self eliminateTrackerForSelector:v13];
  if (v14)
  {
    if (infoCopy)
    {
      [(MADAutoAssetControlManager *)self issueResponseToFailedAutoAssetLockRequest:@"eliminateUngraftSetDescriptor" forEventInfo:infoCopy withResponseError:v9 forAttemptedDescriptor:0];
    }

    if ([descriptorCopy secureOperationEliminating])
    {
      [(MADAutoAssetControlManager *)self _eliminateSecureOperationFinished:v14 forEliminateSetDescriptor:descriptorCopy];
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v17 = [NSString alloc];
    summary = [descriptorCopy summary];
    if (infoCopy)
    {
      summary2 = [infoCopy summary];
    }

    else
    {
      summary2 = @"N";
    }

    v20 = [v17 initWithFormat:@"{eliminateUngraftSetDescriptor} no eliminateTracker | setDescriptor:%@ | eventInfo:%@", summary, summary2];
    [diag trackAnomaly:@"SET-ELIMINATE|AUTO-SECURE" forReason:v20 withResult:6111 withError:0];

    if (infoCopy)
    {
    }
  }

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  [(MADAutoAssetControlManager *)self issueResponseToFailedSetLockRequest:@"eliminateUngraftSetDescriptor" forEventInfo:infoCopy forAtomicInstance:latestDownloadedAtomicInstance withResponseError:v9];
}

- (id)jobToBeGivenGrant:(id)grant
{
  grantCopy = grant;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (grantCopy && ([grantCopy awaitingExclusiveGrant], v7 = objc_claimAutoreleasedReturnValue(), v8 = objc_msgSend(v7, "count"), v7, v8))
  {
    awaitingExclusiveGrant = [grantCopy awaitingExclusiveGrant];
    v10 = [awaitingExclusiveGrant objectAtIndex:0];

    awaitingExclusiveGrant2 = [grantCopy awaitingExclusiveGrant];
    [awaitingExclusiveGrant2 removeObjectAtIndex:0];

    v12 = [(MADAutoAssetControlManager *)self currentJobByUUID:v10 potentiallyResumingJob:0 withOriginalSelector:0 fromLocation:@"jobToBeGivenGrant" notFoundCode:6111 notFoundReason:@"next auto-asset-job for obtain-lookup-grant not found" downloadingDescriptor:0 baseForPatchDescriptor:0];
    if (v12)
    {
      [grantCopy setHolderJobUUID:v10];
    }
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (void)handleStagingClientDetermineGroupsAvailableForUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineGroupsAvailableForUpdateRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientDetermineGroupsAvailable:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDetermineAllAvailableForUpdateRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineGroupsAvailableForUpdateRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientDetermineAllAvailable:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDetermineAllAvailableRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDetermineAllAvailableRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientDetermineAllAvailable:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientDownloadGroupsRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10.opaque[0] = 0;
  v10.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDownloadGroupsRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v10);

  v8 = [(MADAutoAssetControlManager *)self _alreadyDownloadedDescriptorsArray:@"handleStagingClientDownloadGroupsRequest" limitingToSupportingStaging:0, v10.opaque[0], v10.opaque[1]];
  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientDownloadGroups:clientRequest withAlreadyDownloadedDescriptors:v8];

  os_activity_scope_leave(&v10);
}

- (void)handleStagingClientDownloadAllRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientDownloadAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientDownloadAll:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientCancelOperation:(id)operation
{
  operationCopy = operation;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientCancelOperation", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [operationCopy clientRequest];
  [MADAutoAssetStager clientCancelOperation:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientPurgeAllRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientPurgeAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientPurgeAll:clientRequest];

  os_activity_scope_leave(&v9);
}

- (void)handleStagingClientEraseAllRequest:(id)request
{
  requestCopy = request;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9.opaque[0] = 0;
  v9.opaque[1] = 0;
  v7 = _os_activity_create(&dword_0, "MADAutoControl:handleStagingClientEraseAllRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v7, &v9);

  [(MADAutoAssetControlManager *)self ensureStagerFullyResumed:v9.opaque[0]];
  clientRequest = [requestCopy clientRequest];
  [MADAutoAssetStager clientEraseAll:clientRequest];

  os_activity_scope_leave(&v9);
}

- (id)_combinedStatisticsWithStagerClientRepliesSuccess:(id)success withStagerClientRepliesFailure:(id)failure withStagerTotalStaged:(id)staged withStagerTotalUnstaged:(id)unstaged
{
  successCopy = success;
  failureCopy = failure;
  stagedCopy = staged;
  unstagedCopy = unstaged;
  statistics = [(MADAutoAssetControlManager *)self statistics];
  v15 = [statistics copy];

  if (successCopy)
  {
    totalClientRepliesSuccess = [v15 totalClientRepliesSuccess];
    [totalClientRepliesSuccess setStageDetermineAllAvailable:{objc_msgSend(successCopy, "stageDetermineAllAvailable") + objc_msgSend(totalClientRepliesSuccess, "stageDetermineAllAvailable")}];

    totalClientRepliesSuccess2 = [v15 totalClientRepliesSuccess];
    [totalClientRepliesSuccess2 setStageDownloadAll:{objc_msgSend(successCopy, "stageDownloadAll") + objc_msgSend(totalClientRepliesSuccess2, "stageDownloadAll")}];

    totalClientRepliesSuccess3 = [v15 totalClientRepliesSuccess];
    [totalClientRepliesSuccess3 setStagePurgeAll:{objc_msgSend(successCopy, "stagePurgeAll") + objc_msgSend(totalClientRepliesSuccess3, "stagePurgeAll")}];

    totalClientRepliesSuccess4 = [v15 totalClientRepliesSuccess];
    [totalClientRepliesSuccess4 setStageEraseAll:{objc_msgSend(successCopy, "stageEraseAll") + objc_msgSend(totalClientRepliesSuccess4, "stageEraseAll")}];
  }

  if (failureCopy)
  {
    totalClientRepliesFailure = [v15 totalClientRepliesFailure];
    [totalClientRepliesFailure setStageDetermineAllAvailable:{objc_msgSend(failureCopy, "stageDetermineAllAvailable") + objc_msgSend(totalClientRepliesFailure, "stageDetermineAllAvailable")}];

    totalClientRepliesFailure2 = [v15 totalClientRepliesFailure];
    [totalClientRepliesFailure2 setStageDownloadAll:{objc_msgSend(failureCopy, "stageDownloadAll") + objc_msgSend(totalClientRepliesFailure2, "stageDownloadAll")}];

    totalClientRepliesFailure3 = [v15 totalClientRepliesFailure];
    [totalClientRepliesFailure3 setStagePurgeAll:{objc_msgSend(failureCopy, "stagePurgeAll") + objc_msgSend(totalClientRepliesFailure3, "stagePurgeAll")}];

    totalClientRepliesFailure4 = [v15 totalClientRepliesFailure];
    [totalClientRepliesFailure4 setStageEraseAll:{objc_msgSend(failureCopy, "stageEraseAll") + objc_msgSend(totalClientRepliesFailure4, "stageEraseAll")}];
  }

  if (stagedCopy)
  {
    totalStaged = [v15 totalStaged];
    [totalStaged setPatchedAssets:{objc_msgSend(stagedCopy, "patchedAssets") + objc_msgSend(totalStaged, "patchedAssets")}];

    totalStaged2 = [v15 totalStaged];
    [totalStaged2 setPatchedBytes:{objc_msgSend(stagedCopy, "patchedBytes") + objc_msgSend(totalStaged2, "patchedBytes")}];

    totalStaged3 = [v15 totalStaged];
    [totalStaged3 setFullAssets:{objc_msgSend(stagedCopy, "fullAssets") + objc_msgSend(totalStaged3, "fullAssets")}];

    totalStaged4 = [v15 totalStaged];
    [totalStaged4 setFullBytes:{objc_msgSend(stagedCopy, "fullBytes") + objc_msgSend(totalStaged4, "fullBytes")}];
  }

  if (unstagedCopy)
  {
    totalUnstaged = [v15 totalUnstaged];
    [totalUnstaged setPatchedAssets:{objc_msgSend(unstagedCopy, "patchedAssets") + objc_msgSend(totalUnstaged, "patchedAssets")}];

    totalUnstaged2 = [v15 totalUnstaged];
    [totalUnstaged2 setPatchedBytes:{objc_msgSend(unstagedCopy, "patchedBytes") + objc_msgSend(totalUnstaged2, "patchedBytes")}];

    totalUnstaged3 = [v15 totalUnstaged];
    [totalUnstaged3 setFullAssets:{objc_msgSend(unstagedCopy, "fullAssets") + objc_msgSend(totalUnstaged3, "fullAssets")}];

    totalUnstaged4 = [v15 totalUnstaged];
    [totalUnstaged4 setFullBytes:{objc_msgSend(unstagedCopy, "fullBytes") + objc_msgSend(totalUnstaged4, "fullBytes")}];
  }

  return v15;
}

- (id)_latestDownloadedDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier
{
  descriptorCopy = descriptor;
  typeCopy = type;
  specifierCopy = specifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:_latestDownloadedDescriptor", descriptorCopy];
  v45 = specifierCopy;
  v44 = [[MAAutoAssetSelector alloc] initForAssetType:typeCopy withAssetSpecifier:specifierCopy];
  v14 = [MADAutoAssetControlManager locateDownloadedNewForSelector:"locateDownloadedNewForSelector:assetSelector:limitedToStaging:" assetSelector:descriptorCopy limitedToStaging:?];
  selfCopy = self;
  v48 = descriptorCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorCopy ofContainer:@"locateDownloadedNewAllBySelector"];
  v52 = 0u;
  v53 = 0u;
  v50 = 0u;
  v51 = 0u;
  v15 = v14;
  v16 = [v15 countByEnumeratingWithState:&v50 objects:v62 count:16];
  v47 = v15;
  if (!v16)
  {

    v18 = 0;
    goto LABEL_21;
  }

  v17 = v16;
  v42 = typeCopy;
  v43 = descriptorCopy;
  v18 = 0;
  v19 = 0;
  v49 = *v51;
  do
  {
    for (i = 0; i != v17; i = i + 1)
    {
      if (*v51 != v49)
      {
        objc_enumerationMutation(v15);
      }

      v21 = *(*(&v50 + 1) + 8 * i);
      v22 = objc_autoreleasePoolPush();
      v23 = [v15 safeObjectForKey:v21 ofClass:objc_opt_class()];
      v24 = v23;
      if (v19)
      {
        v25 = [SUCoreRestoreVersion alloc];
        assetVersion = [v24 assetVersion];
        assetVersion2 = [v25 initWithRestoreVersion:assetVersion];

        if ([assetVersion2 isComparable:v18])
        {
          if ([assetVersion2 compare:v18]!= &dword_0 + 1)
          {
            goto LABEL_14;
          }

          v28 = v24;

          assetVersion2 = assetVersion2;
          v29 = v18;
          v18 = assetVersion2;
          v19 = v28;
        }

        else
        {
          v29 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            summary = [v24 summary];
            *buf = 138543874;
            v55 = _updateLatestSummary;
            v56 = 2114;
            v57 = v48;
            v58 = 2114;
            v59 = summary;
            _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} ignoring (invalid restore version) | descriptor:%{public}@", buf, 0x20u);

            v15 = v47;
          }
        }
      }

      else
      {
        v19 = v23;
        v30 = [SUCoreRestoreVersion alloc];
        assetVersion2 = [v19 assetVersion];
        v31 = [v30 initWithRestoreVersion:assetVersion2];
        v29 = v18;
        v18 = v31;
      }

LABEL_14:
      objc_autoreleasePoolPop(v22);
    }

    v17 = [v15 countByEnumeratingWithState:&v50 objects:v62 count:16];
  }

  while (v17);

  if (v19)
  {
    v34 = _MADLog(@"AutoControl");
    typeCopy = v42;
    descriptorCopy = v43;
    v35 = v45;
    v36 = v48;
    if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      summary2 = [v19 summary];
      *buf = 138543874;
      v55 = _updateLatestSummary2;
      v56 = 2114;
      v57 = v48;
      v58 = 2114;
      v59 = summary2;
      _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} matched on downloaded | descriptor:%{public}@", buf, 0x20u);
    }

    goto LABEL_24;
  }

  typeCopy = v42;
  descriptorCopy = v43;
LABEL_21:
  v35 = v45;
  v36 = v48;
  v34 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    *buf = 138544130;
    v55 = _updateLatestSummary3;
    v56 = 2114;
    v57 = v48;
    v58 = 2114;
    v59 = typeCopy;
    v60 = 2114;
    v61 = v45;
    _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no match on downloaded descriptor | assetType:%{public}@, assetSpecifier:%{public}@", buf, 0x2Au);
  }

  v19 = 0;
LABEL_24:

  v40 = v19;
  return v19;
}

- (id)_latestDownloadedDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier matchingAssetVersion:(id)version
{
  descriptorCopy = descriptor;
  typeCopy = type;
  specifierCopy = specifier;
  versionCopy = version;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:_latestDownloadedDescriptor", descriptorCopy];
  v17 = [[MAAutoAssetSelector alloc] initForAssetType:typeCopy withAssetSpecifier:specifierCopy matchingAssetVersion:versionCopy];
  v18 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_latestDownloadedDescriptor" assetSelector:v17 limitedToStaging:0];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorCopy ofContainer:@"locateDownloadedNewAllBySelector"];
  memset(v29, 0, sizeof(v29));
  v19 = v18;
  if (![v19 countByEnumeratingWithState:v29 objects:v38 count:16])
  {

LABEL_7:
    v25 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544130;
      v31 = descriptorCopy;
      v32 = 2114;
      v33 = typeCopy;
      v34 = 2114;
      v35 = specifierCopy;
      v36 = 2114;
      v37 = versionCopy;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "{%{public}@} no downloaded asset-descriptor | assetType:%{public}@, assetSpecifier:%{public}@, assetVersion:%{public}@", buf, 0x2Au);
    }

    goto LABEL_12;
  }

  v20 = **(&v29[0] + 1);
  v21 = objc_autoreleasePoolPush();
  v22 = [v19 safeObjectForKey:v20 ofClass:objc_opt_class()];
  objc_autoreleasePoolPop(v21);

  if (!v22)
  {
    goto LABEL_7;
  }

  existsOnFilesystem = [v22 existsOnFilesystem];
  v24 = _MADLog(@"AutoControl");
  v25 = v24;
  if (!existsOnFilesystem)
  {
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      summary = [v22 summary];
      *buf = 138543618;
      v31 = descriptorCopy;
      v32 = 2114;
      v33 = summary;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "{%{public}@} tracked as downloaded yet not on filesystem | descriptor:%{public}@", buf, 0x16u);
    }

    v25 = v22;
LABEL_12:
    v22 = 0;
    goto LABEL_13;
  }

  if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
  {
    summary2 = [v22 summary];
    *buf = 138543618;
    v31 = descriptorCopy;
    v32 = 2114;
    v33 = summary2;
    _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "{%{public}@} downloaded (on filesystem) asset-descriptor | descriptor:%{public}@", buf, 0x16u);
  }

LABEL_13:

  return v22;
}

- (id)_preInstalledDescriptor:(id)descriptor forAssetType:(id)type withAssetSpecifier:(id)specifier
{
  specifierCopy = specifier;
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = [MADAutoAssetDescriptor typeAndSpecifierKeyForAssetType:typeCopy andAssetSpecifier:specifierCopy];

  preinstalledAssetDescriptorsBySelector = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
  v13 = [preinstalledAssetDescriptorsBySelector safeObjectForKey:v11 ofClass:objc_opt_class()];

  return v13;
}

- (id)_allPreInstalledDescriptor:(id)descriptor forAssetType:(id)type
{
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v24 = typeCopy;
  v25 = objc_opt_new();
  v8 = normalizedAssetType(typeCopy);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  preinstalledAssetDescriptorsBySelector = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
  allKeys = [preinstalledAssetDescriptorsBySelector allKeys];

  v11 = [allKeys countByEnumeratingWithState:&v26 objects:v34 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v27;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v27 != v13)
        {
          objc_enumerationMutation(allKeys);
        }

        v15 = *(*(&v26 + 1) + 8 * i);
        v16 = normalizedAssetType(v15);
        if ([v16 containsString:v8])
        {
          preinstalledAssetDescriptorsBySelector2 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
          v18 = [preinstalledAssetDescriptorsBySelector2 safeObjectForKey:v15 ofClass:objc_opt_class()];

          assetType = [v18 assetType];
          v20 = normalizedAssetType(assetType);

          if (v20 && [v8 isEqualToString:v20])
          {
            [v25 addObject:v18];
          }
        }
      }

      v12 = [allKeys countByEnumeratingWithState:&v26 objects:v34 count:16];
    }

    while (v12);
  }

  v21 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
  {
    v22 = [v25 count];
    *buf = 134218242;
    v31 = v22;
    v32 = 2114;
    v33 = v24;
    _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{_allPreinstalledDescriptor} returned %llu descriptor(s) for type:%{public}@", buf, 0x16u);
  }

  return v25;
}

- (int64_t)_bytesDownloadedForDescriptor:(id)descriptor
{
  metadata = [descriptor metadata];
  v4 = [metadata safeIntegerForKey:@"_UnarchivedSize"];

  return v4;
}

- (id)setConfigurationForDescriptorIfManagedAsSet:(id)set
{
  setCopy = set;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationForDescriptorIfManagedAsSet" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v9 = [allKeys copy];

  obj = v9;
  v10 = [v9 countByEnumeratingWithState:&v22 objects:v26 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v23;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v23 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v22 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v17 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v14 ofClass:objc_opt_class()];

        firstEntryAssetType = [v17 firstEntryAssetType];
        assetType = [setCopy assetType];
        LODWORD(knownSetConfigurationsByIdentifier2) = [SUCore stringIsEqual:firstEntryAssetType to:assetType];

        if (knownSetConfigurationsByIdentifier2)
        {
          objc_autoreleasePoolPop(v15);
          goto LABEL_11;
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [obj countByEnumeratingWithState:&v22 objects:v26 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }
  }

  v17 = 0;
LABEL_11:

  return v17;
}

- (BOOL)isDescriptorCurrentlyLocked:(id)locked forDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v8 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];

  v12 = [v8 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];
  locksPriorToSecureHealing = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];

  if (locksPriorToSecureHealing)
  {
    persistedEntryID = [v12 persistedEntryID];
    locksPriorToSecureHealing2 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
    v16 = [locksPriorToSecureHealing2 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

    v17 = v16 != 0;
  }

  else
  {
    v18 = [MADAutoAssetLocker lockedSelectorsForEliminate:v12];
    persistedEntryID = v18;
    if (v18)
    {
      v17 = [v18 count] != 0;
    }

    else
    {
      v17 = 0;
    }
  }

  return v17;
}

- (BOOL)filesystemDoesFileExist:(id)exist atPath:(id)path
{
  existCopy = exist;
  pathCopy = path;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  filesystemFileExistAtPathCache = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (filesystemFileExistAtPathCache)
  {
    v11 = [(MADAutoAssetControlManager *)self _filesystemCachedInfo:existCopy forPath:pathCopy];
    v13 = v11 == 300 || v11 == 200;
  }

  else
  {
    v14 = +[NSFileManager defaultManager];
    v13 = [v14 fileExistsAtPath:pathCopy];
  }

  return v13;
}

- (BOOL)filesystemDoesDirectoryExist:(id)exist atPath:(id)path isDirectory:(BOOL *)directory
{
  existCopy = exist;
  pathCopy = path;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v17 = 0;
  filesystemFileExistAtPathCache = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (!filesystemFileExistAtPathCache)
  {
    v15 = +[NSFileManager defaultManager];
    v14 = [v15 fileExistsAtPath:pathCopy isDirectory:&v17];

    if (!directory)
    {
      goto LABEL_10;
    }

    goto LABEL_9;
  }

  v13 = [(MADAutoAssetControlManager *)self _filesystemCachedInfo:existCopy forPath:pathCopy];
  if (v13 != 200)
  {
    if (v13 == 300)
    {
      v14 = 1;
      v17 = 1;
      if (!directory)
      {
        goto LABEL_10;
      }
    }

    else
    {
      v14 = 0;
      if (!directory)
      {
        goto LABEL_10;
      }
    }

    goto LABEL_9;
  }

  v14 = 1;
  if (directory)
  {
LABEL_9:
    *directory = v17;
  }

LABEL_10:

  return v14;
}

- (int64_t)_filesystemCachedInfo:(id)info forPath:(id)path
{
  infoCopy = info;
  pathCopy = path;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  filesystemFileExistAtPathCache = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];

  if (filesystemFileExistAtPathCache)
  {
    filesystemFileExistAtPathCache2 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];
    v12 = [filesystemFileExistAtPathCache2 safeObjectForKey:pathCopy ofClass:objc_opt_class()];

    filesystemFileExistAtPathCache = v12 == 0;
    if (v12)
    {
      integerValue = [v12 integerValue];
    }

    else
    {
      v20 = 0;
      v14 = +[NSFileManager defaultManager];
      v15 = [v14 fileExistsAtPath:pathCopy isDirectory:&v20];

      v16 = 200;
      if (v20)
      {
        v16 = 300;
      }

      if (v15)
      {
        integerValue = v16;
      }

      else
      {
        integerValue = &stru_20 + 68;
      }

      v17 = [[NSNumber alloc] initWithInteger:integerValue];
      filesystemFileExistAtPathCache3 = [(MADAutoAssetControlManager *)self filesystemFileExistAtPathCache];
      [filesystemFileExistAtPathCache3 setSafeObject:v17 forKey:pathCopy];
    }

    [(MADAutoAssetControlManager *)self setFilesystemStartupLookupCount:[(MADAutoAssetControlManager *)self filesystemStartupLookupCount]+ 1];
  }

  else
  {
    integerValue = 0;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceFilesystemExistCheck:infoCopy atPath:pathCopy withFilesystemInfo:integerValue justUpdatedCache:filesystemFileExistAtPathCache];

  return integerValue;
}

- (BOOL)_updateTrackedDescriptor:(id)descriptor fromLatestDescriptor:(id)latestDescriptor
{
  descriptorCopy = descriptor;
  latestDescriptorCopy = latestDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  assetType = [descriptorCopy assetType];
  if (!assetType)
  {
    goto LABEL_40;
  }

  v11 = assetType;
  assetType2 = [latestDescriptorCopy assetType];
  if (!assetType2)
  {
    goto LABEL_39;
  }

  v13 = assetType2;
  assetSpecifier = [descriptorCopy assetSpecifier];
  if (!assetSpecifier)
  {
LABEL_38:

LABEL_39:
    goto LABEL_40;
  }

  v15 = assetSpecifier;
  assetSpecifier2 = [latestDescriptorCopy assetSpecifier];
  if (!assetSpecifier2)
  {
LABEL_37:

    goto LABEL_38;
  }

  v17 = assetSpecifier2;
  assetId = [descriptorCopy assetId];
  if (!assetId)
  {
LABEL_36:

    goto LABEL_37;
  }

  v19 = assetId;
  assetId2 = [latestDescriptorCopy assetId];
  if (!assetId2 || ![descriptorCopy isMAAutoAsset])
  {

    goto LABEL_36;
  }

  isMAAutoAsset = [latestDescriptorCopy isMAAutoAsset];

  if ((isMAAutoAsset & 1) == 0)
  {
LABEL_40:
    v42 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
LABEL_43:

      LOBYTE(stagedFromOSVersion3) = 0;
      goto LABEL_44;
    }

    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [descriptorCopy summary];
    summary2 = [latestDescriptorCopy summary];
    v60 = 138543874;
    v61 = _updateLatestSummary;
    v62 = 2114;
    v63 = summary;
    v64 = 2114;
    v65 = summary2;
    v46 = "[%{public}@] {_updateTrackedDescriptor} missing base-level information | updateDescriptor:%{public}@ | recentDescriptor:%{public}@";
LABEL_42:
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, v46, &v60, 0x20u);

    goto LABEL_43;
  }

  assetVersion = [descriptorCopy assetVersion];
  if (assetVersion)
  {
    v23 = assetVersion;
    assetVersion2 = [latestDescriptorCopy assetVersion];

    if (!assetVersion2)
    {
      v42 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_43;
      }

      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [descriptorCopy summary];
      summary2 = [latestDescriptorCopy summary];
      v60 = 138543874;
      v61 = _updateLatestSummary;
      v62 = 2114;
      v63 = summary;
      v64 = 2114;
      v65 = summary2;
      v46 = "[%{public}@] {_updateTrackedDescriptor} update full-asset-selector when recent not full | updateDescriptor:%{public}@ | recentDescriptor:%{public}@";
      goto LABEL_42;
    }
  }

  foundByLookupWithoutAssetVersion = [descriptorCopy foundByLookupWithoutAssetVersion];
  LODWORD(stagedFromOSVersion3) = foundByLookupWithoutAssetVersion ^ [latestDescriptorCopy foundByLookupWithoutAssetVersion];
  if (stagedFromOSVersion3 == 1)
  {
    [descriptorCopy setFoundByLookupWithoutAssetVersion:{objc_msgSend(latestDescriptorCopy, "foundByLookupWithoutAssetVersion")}];
  }

  preSoftwareUpdateAssetStaging = [descriptorCopy preSoftwareUpdateAssetStaging];
  if (preSoftwareUpdateAssetStaging != [latestDescriptorCopy preSoftwareUpdateAssetStaging])
  {
    [descriptorCopy setPreSoftwareUpdateAssetStaging:{objc_msgSend(latestDescriptorCopy, "preSoftwareUpdateAssetStaging")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  isPatch = [descriptorCopy isPatch];
  if (isPatch != [latestDescriptorCopy isPatch])
  {
    [descriptorCopy setIsPatch:{objc_msgSend(latestDescriptorCopy, "isPatch")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  isOnFilesystem = [descriptorCopy isOnFilesystem];
  if (isOnFilesystem != [latestDescriptorCopy isOnFilesystem])
  {
    [descriptorCopy setIsOnFilesystem:{objc_msgSend(latestDescriptorCopy, "isOnFilesystem")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  neverBeenLocked = [descriptorCopy neverBeenLocked];
  if (neverBeenLocked != [latestDescriptorCopy neverBeenLocked] && objc_msgSend(descriptorCopy, "neverBeenLocked"))
  {
    [descriptorCopy setNeverBeenLocked:{objc_msgSend(latestDescriptorCopy, "neverBeenLocked")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  downloadUserInitiated = [descriptorCopy downloadUserInitiated];
  if (downloadUserInitiated != [latestDescriptorCopy downloadUserInitiated])
  {
    [descriptorCopy setDownloadUserInitiated:{objc_msgSend(latestDescriptorCopy, "downloadUserInitiated")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  downloadedNetworkBytes = [descriptorCopy downloadedNetworkBytes];
  if (downloadedNetworkBytes != [latestDescriptorCopy downloadedNetworkBytes])
  {
    [descriptorCopy setDownloadedNetworkBytes:{objc_msgSend(latestDescriptorCopy, "downloadedNetworkBytes")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  downloadedFilesystemBytes = [descriptorCopy downloadedFilesystemBytes];
  if (downloadedFilesystemBytes != [latestDescriptorCopy downloadedFilesystemBytes])
  {
    [descriptorCopy setDownloadedFilesystemBytes:{objc_msgSend(latestDescriptorCopy, "downloadedFilesystemBytes")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  patchedFromBaseSelector = [descriptorCopy patchedFromBaseSelector];
  if (!patchedFromBaseSelector)
  {
    patchedFromBaseSelector2 = [latestDescriptorCopy patchedFromBaseSelector];
    if (patchedFromBaseSelector2)
    {

LABEL_47:
      patchedFromBaseSelector = [latestDescriptorCopy patchedFromBaseSelector];
      [descriptorCopy setPatchedFromBaseSelector:patchedFromBaseSelector];
      LOBYTE(stagedFromOSVersion3) = 1;
      goto LABEL_51;
    }
  }

  patchedFromBaseSelector3 = [descriptorCopy patchedFromBaseSelector];
  if (patchedFromBaseSelector3)
  {
    v36 = patchedFromBaseSelector3;
    patchedFromBaseSelector4 = [latestDescriptorCopy patchedFromBaseSelector];
    if (!patchedFromBaseSelector4)
    {

      goto LABEL_51;
    }

    v38 = patchedFromBaseSelector4;
    patchedFromBaseSelector5 = [descriptorCopy patchedFromBaseSelector];
    patchedFromBaseSelector6 = [latestDescriptorCopy patchedFromBaseSelector];
    v41 = [patchedFromBaseSelector5 isEqual:patchedFromBaseSelector6];

    if (patchedFromBaseSelector)
    {
    }

    if (v41)
    {
      goto LABEL_52;
    }

    goto LABEL_47;
  }

LABEL_51:

LABEL_52:
  patchedFromBaseFilesystemBytes = [descriptorCopy patchedFromBaseFilesystemBytes];
  if (patchedFromBaseFilesystemBytes != [latestDescriptorCopy patchedFromBaseFilesystemBytes])
  {
    [descriptorCopy setPatchedFromBaseFilesystemBytes:{objc_msgSend(latestDescriptorCopy, "patchedFromBaseFilesystemBytes")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  patchingAttempted = [descriptorCopy patchingAttempted];
  if (patchingAttempted != [latestDescriptorCopy patchingAttempted])
  {
    [descriptorCopy setPatchingAttempted:{objc_msgSend(latestDescriptorCopy, "patchingAttempted")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  stagedPriorToAvailable = [descriptorCopy stagedPriorToAvailable];
  if (stagedPriorToAvailable != [latestDescriptorCopy stagedPriorToAvailable])
  {
    [descriptorCopy setStagedPriorToAvailable:{objc_msgSend(latestDescriptorCopy, "stagedPriorToAvailable")}];
    LOBYTE(stagedFromOSVersion3) = 1;
  }

  stagedFromOSVersion = [descriptorCopy stagedFromOSVersion];
  stagedFromOSVersion2 = [latestDescriptorCopy stagedFromOSVersion];
  v54 = [SUCore stringIsEqual:stagedFromOSVersion to:stagedFromOSVersion2];

  if ((v54 & 1) == 0)
  {
    stagedFromOSVersion3 = [latestDescriptorCopy stagedFromOSVersion];
    [descriptorCopy setStagedFromOSVersion:stagedFromOSVersion3];

    LOBYTE(stagedFromOSVersion3) = 1;
  }

  stagedFromBuildVersion = [descriptorCopy stagedFromBuildVersion];
  stagedFromBuildVersion2 = [latestDescriptorCopy stagedFromBuildVersion];
  v57 = [SUCore stringIsEqual:stagedFromBuildVersion to:stagedFromBuildVersion2];

  if ((v57 & 1) == 0)
  {
    stagedFromOSVersion3 = [latestDescriptorCopy stagedFromBuildVersion];
    [descriptorCopy setStagedFromBuildVersion:stagedFromOSVersion3];

    LOBYTE(stagedFromOSVersion3) = 1;
  }

  patchingAttemptError = [descriptorCopy patchingAttemptError];
  if (patchingAttemptError)
  {
  }

  else
  {
    patchingAttemptError2 = [latestDescriptorCopy patchingAttemptError];

    if (patchingAttemptError2)
    {
      stagedFromOSVersion3 = [latestDescriptorCopy patchingAttemptError];
      [descriptorCopy setPatchingAttemptError:stagedFromOSVersion3];

      LOBYTE(stagedFromOSVersion3) = 1;
    }
  }

LABEL_44:

  return stagedFromOSVersion3;
}

- (BOOL)doesSelectorArray:(id)array coverAssetDescriptor:(id)descriptor
{
  arrayCopy = array;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  obj = arrayCopy;
  v10 = [obj countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v10)
  {
    v11 = *v22;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v22 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v13 = *(*(&v21 + 1) + 8 * i);
        assetType = [v13 assetType];
        assetType2 = [descriptorCopy assetType];
        if (([SUCore stringIsEqual:assetType to:assetType2]& 1) != 0)
        {
          assetSpecifier = [v13 assetSpecifier];
          assetSpecifier2 = [descriptorCopy assetSpecifier];
          v18 = [SUCore stringIsEqual:assetSpecifier to:assetSpecifier2];

          if (v18)
          {
            LOBYTE(v10) = 1;
            goto LABEL_12;
          }
        }

        else
        {
        }
      }

      v10 = [obj countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v10);
  }

LABEL_12:

  return v10;
}

- (void)setConfigurationLoadedFromPersisted:(id)persisted persistedEntryID:(id)d
{
  persistedCopy = persisted;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:persistedCopy];
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v9 = [knownSetConfigurationsByIdentifier safeObjectForKey:v7 ofClass:objc_opt_class()];

  if (v9)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v12 = [NSString alloc];
    summary = [persistedCopy summary];
    v14 = [v12 initWithFormat:@"{setConfigurationLoadedFromPersisted} already tracking setConfiguration:%@", summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v14 withResult:6109 withError:0];
  }

  else
  {
    knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    [knownSetConfigurationsByIdentifier2 setSafeObject:persistedCopy forKey:v7];

    [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:@"setConfigurationLoadedFromPersisted" operation:@"ENTRY_LOAD" forPersistedEntryID:v7 withSetConfiguration:persistedCopy historyOperation:444 message:@"set-configuration validated"];
  }
}

- (void)setConfigurationsRefreshStaleIndications
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationsRefreshStaleIndications" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v7 = [allKeys copy];

  obj = v7;
  v8 = [v7 countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v27;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v27 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v26 + 1) + 8 * i);
        v13 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v15 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v12 ofClass:objc_opt_class()];

        if (v15)
        {
          previouslyVendedLockedAtomicInstances = [v15 previouslyVendedLockedAtomicInstances];
          if (previouslyVendedLockedAtomicInstances)
          {
            previouslyVendedLockedAtomicInstances2 = [v15 previouslyVendedLockedAtomicInstances];
            v18 = [previouslyVendedLockedAtomicInstances2 count] != 0;
          }

          else
          {
            v18 = 0;
          }

          latestAtomicInstanceToVend = [v15 latestAtomicInstanceToVend];
          if (latestAtomicInstanceToVend)
          {
            haveReceivedLookupResponse = [v15 haveReceivedLookupResponse];

            if (haveReceivedLookupResponse)
            {
              latestAtomicInstanceToVend = 0;
              goto LABEL_13;
            }

            [v15 setHaveReceivedLookupResponse:1];
            v21 = 0;
            latestAtomicInstanceToVend = @"set haveReceivedLookupResponse";
          }

          else
          {
LABEL_13:
            v21 = 1;
          }

          if ([v15 everProvidedLatestToVend] & 1) != 0 || (objc_msgSend(v15, "latestAtomicInstanceToVend"), v22 = objc_claimAutoreleasedReturnValue(), v23 = v22 == 0, v22, (v23 & ~v18))
          {
LABEL_19:
            v24 = latestAtomicInstanceToVend;
            if (!latestAtomicInstanceToVend)
            {
              goto LABEL_21;
            }
          }

          else
          {
            [v15 setEverProvidedLatestToVend:1];
            v24 = @"set everProvidedLatestToVend";
            if ((v21 & 1) == 0)
            {
              latestAtomicInstanceToVend = [[NSString alloc] initWithFormat:@"%@, set everProvidedLatestToVend", latestAtomicInstanceToVend];
              goto LABEL_19;
            }
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v15 fromLocation:@"setConfigurationsRefreshStaleIndications" forReason:v24 dueToAlter:0 forHistoryOperation:450];
        }

LABEL_21:

        objc_autoreleasePoolPop(v13);
      }

      v9 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v9);
  }
}

- (int64_t)setConfigurationSelectUsingInfoInstance:(id)instance dueToMessageName:(id)name selectedConfig:(id *)config
{
  instanceCopy = instance;
  nameCopy = name;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetEntries = [instanceCopy autoAssetEntries];

  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];
  v15 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  if (!autoAssetEntries)
  {
    v20 = 0;
    v22 = v15;
    if (config)
    {
      goto LABEL_35;
    }

    goto LABEL_36;
  }

  v45 = nameCopy;
  if (!v15)
  {
    v60 = 0;
    v20 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:@"setConfigurationSelectUsingInfoInstance" forSetInfoInstance:instanceCopy dueToMessageName:nameCopy selectedConfig:&v60];
    v15 = v60;
    if (v20)
    {
      v21 = 0;
      goto LABEL_34;
    }
  }

  autoAssetEntries2 = [instanceCopy autoAssetEntries];
  v17 = [autoAssetEntries2 count];

  v47 = v15;
  autoAssetEntries3 = [v15 autoAssetEntries];
  v19 = [autoAssetEntries3 count];

  if (v17 <= 0 && v19 <= 0)
  {
    goto LABEL_5;
  }

  if (v17 != v19)
  {
    v20 = 0;
    v21 = 0;
LABEL_33:
    v15 = v47;
    goto LABEL_34;
  }

  v58 = 0u;
  v59 = 0u;
  v56 = 0u;
  v57 = 0u;
  obj = [instanceCopy autoAssetEntries];
  v43 = [obj countByEnumeratingWithState:&v56 objects:v62 count:16];
  if (!v43)
  {
    goto LABEL_28;
  }

  v44 = *v57;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  configCopy = config;
  v41 = instanceCopy;
  while (2)
  {
    v24 = 0;
    while (2)
    {
      if (*v57 != v44)
      {
        objc_enumerationMutation(obj);
      }

      v46 = v24;
      v25 = *(*(&v56 + 1) + 8 * v24);
      v52 = 0u;
      v53 = 0u;
      v54 = 0u;
      v55 = 0u;
      autoAssetEntries4 = [v47 autoAssetEntries];
      v51 = [autoAssetEntries4 countByEnumeratingWithState:&v52 objects:v61 count:16];
      if (!v51)
      {
LABEL_32:

        v20 = 0;
        v21 = 0;
        config = configCopy;
        instanceCopy = v41;
        goto LABEL_33;
      }

      v26 = *v53;
      v48 = *v53;
LABEL_16:
      v27 = 0;
      while (1)
      {
        if (*v53 != v26)
        {
          objc_enumerationMutation(autoAssetEntries4);
        }

        v28 = *(*(&v52 + 1) + 8 * v27);
        v29 = p_weak_ivar_lyt[223];
        assetSelector = [v28 assetSelector];
        assetType = [assetSelector assetType];
        assetSelector2 = [v25 assetSelector];
        assetType2 = [assetSelector2 assetType];
        if (![v29 stringIsEqual:assetType to:assetType2])
        {

          goto LABEL_23;
        }

        v50 = p_weak_ivar_lyt[223];
        assetSelector3 = [v28 assetSelector];
        assetSpecifier = [assetSelector3 assetSpecifier];
        assetSelector4 = [v25 assetSelector];
        [assetSelector4 assetSpecifier];
        v38 = v37 = v25;
        LOBYTE(v50) = [v50 stringIsEqual:assetSpecifier to:v38];

        v25 = v37;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        v26 = v48;
        if (v50)
        {
          break;
        }

LABEL_23:
        if (v51 == ++v27)
        {
          v51 = [autoAssetEntries4 countByEnumeratingWithState:&v52 objects:v61 count:16];
          if (v51)
          {
            goto LABEL_16;
          }

          goto LABEL_32;
        }
      }

      v24 = v46 + 1;
      if ((v46 + 1) != v43)
      {
        continue;
      }

      break;
    }

    config = configCopy;
    instanceCopy = v41;
    v43 = [obj countByEnumeratingWithState:&v56 objects:v62 count:16];
    if (v43)
    {
      continue;
    }

    break;
  }

LABEL_28:

LABEL_5:
  v15 = v47;
  v20 = 0;
  v21 = v15;
LABEL_34:

  v22 = v21;
  nameCopy = v45;
  if (config)
  {
LABEL_35:
    v22 = v22;
    *config = v22;
  }

LABEL_36:

  return v20;
}

- (int64_t)setConfigurationNewSetConfiguration:(id)configuration forSetInfoInstance:(id)instance dueToMessageName:(id)name selectedConfig:(id *)config
{
  configurationCopy = configuration;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetEntries = [instanceCopy autoAssetEntries];

  if (autoAssetEntries)
  {
    autoAssetEntries2 = [instanceCopy autoAssetEntries];
    v15 = [autoAssetEntries2 count];

    if (v15)
    {
      v16 = [MADAutoSetConfiguration alloc];
      clientDomainName = [instanceCopy clientDomainName];
      autoAssetSetClientName = [instanceCopy autoAssetSetClientName];
      assetSetIdentifier = [instanceCopy assetSetIdentifier];
      autoAssetEntries3 = [instanceCopy autoAssetEntries];
      LODWORD(v28) = 0;
      LOBYTE(v27) = 0;
      v15 = [MADAutoSetConfiguration initForClientDomainName:v16 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:clientDomainName withAutoAssetEntries:autoAssetSetClientName withDiscoveredInFlightAtomicInstance:assetSetIdentifier withNewerAtomicInstanceOncePersonalized:autoAssetEntries3 withLatestAtomicInstanceToVend:0 withLatestAtomicInstanceToVendFromPreSUStaging:0 withPreviouslyVendedLockedAtomicInstances:0 withTicksUntilPreviousForceUnlocked:v27 withMostRecentlyReceivedCachedAssetSetID:0 withMostRecentlyReceivedDownloadedFromLive:-1 withMostRecentlyReceivedLastTimeChecked:0 withMostRecentlyReceivedPostedDate:0 withLatestToVendCachedAssetSetID:0 withLatestToVendDownloadedFromLive:0 withLatestToVendLastTimeChecked:0 withLatestToVendPostedDate:0 withAavailableForUseError:0 withNewerVersionError:0 havingEverProvidedLatestToVend:0 inhibitingImpliedScheduling:0 havingReceivedLookupResponse:v28 vendingAtomicInstanceForConfiguredEntries:?];

      [(MADAutoAssetControlManager *)self setConfigurationPersist:v15 fromLocation:configurationCopy forReason:@"created from setInfoInstance" dueToAlter:0 forHistoryOperation:451];
      v21 = 0;
      if (!config)
      {
        goto LABEL_9;
      }
    }

    else
    {
      v21 = 6555;
      if (!config)
      {
        goto LABEL_9;
      }
    }

    goto LABEL_8;
  }

  v22 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [instanceCopy summary];
    *buf = 138543874;
    v30 = _updateLatestSummary;
    v31 = 2114;
    v32 = configurationCopy;
    v33 = 2114;
    v34 = summary;
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:setConfigurationNewSetConfiguration} MISSING asset-entries from set-information | setInfoInstance:%{public}@", buf, 0x20u);
  }

  v21 = 0;
  v15 = 0;
  if (config)
  {
LABEL_8:
    v25 = v15;
    *config = v15;
  }

LABEL_9:

  return v21;
}

- (BOOL)setConfigurationTrackLatestToVend:(id)vend forSetConfiguration:(id)configuration becomingLatestToVend:(id)toVend historyOperation:(int64_t)operation fromPreSUStaging:(BOOL)staging
{
  stagingCopy = staging;
  configurationCopy = configuration;
  toVendCopy = toVend;
  vendCopy = vend;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationTrackLatestToVend", vendCopy];
  v17 = [NSMutableString alloc];
  v18 = @"cleared";
  if (toVendCopy)
  {
    v18 = @"set";
  }

  v19 = [v17 initWithFormat:@"%@ latestToVend", v18];
  [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDMostRecentlyReceived:vendCopy fromSetDescriptor:toVendCopy forSetConfiguration:configurationCopy buildingPersistReason:v19];
  [(MADAutoAssetControlManager *)self setConfigurationAssetSetIDLatestToVend:vendCopy fromSetDescriptor:toVendCopy forSetConfiguration:configurationCopy buildingPersistReason:v19];
  if (toVendCopy)
  {
    latestDownloadedAtomicInstance = [toVendCopy latestDownloadedAtomicInstance];
    v58 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];
  }

  else
  {
    v58 = 0;
  }

  newerAtomicInstanceOncePersonalized = [configurationCopy newerAtomicInstanceOncePersonalized];

  if (newerAtomicInstanceOncePersonalized)
  {
    newerAtomicInstanceOncePersonalized2 = [configurationCopy newerAtomicInstanceOncePersonalized];
    latestDownloadedAtomicInstance2 = [toVendCopy latestDownloadedAtomicInstance];
    v24 = [SUCore stringIsEqual:newerAtomicInstanceOncePersonalized2 to:latestDownloadedAtomicInstance2];

    if ((v24 & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:vendCopy forSetConfiguration:configurationCopy];
    }
  }

  latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];

  if (latestAtomicInstanceToVend)
  {
    latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
    v27 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend2];
  }

  else
  {
    v27 = 0;
  }

  v28 = [(MADAutoAssetControlManager *)self setConfigurationPreviouslyVendedLockedAtomicInstances:configurationCopy];
  v57 = v28;
  if (v27 && (v29 = v28, [(MADAutoAssetControlManager *)self atomicInstanceIsCurrentlyLocked:v27]))
  {
    v30 = _MADLog(@"AutoControl");
    v31 = os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT);
    if (v29)
    {
      if (v31)
      {
        *buf = 138543618;
        v60 = vendCopy;
        v61 = 2114;
        v62 = v27;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] additional latest-to-vend moved to previously-vended-still-locked | hadBeenLatestAtomicInstance:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      if (v31)
      {
        *buf = 138543618;
        v60 = vendCopy;
        v61 = 2114;
        v62 = v27;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] first latest-to-vend moved to previously-vended-still-locked | hadBeenLatestAtomicInstance:%{public}@", buf, 0x16u);
      }

      v30 = objc_alloc_init(NSMutableArray);
      [configurationCopy setPreviouslyVendedLockedAtomicInstances:v30];
    }

    atomicInstanceUUID = [v27 atomicInstanceUUID];

    if (atomicInstanceUUID)
    {
      previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];
      atomicInstanceUUID2 = [v27 atomicInstanceUUID];
      [previouslyVendedLockedAtomicInstances addObject:atomicInstanceUUID2];

      [configurationCopy setTicksUntilPreviousForceUnlocked:2];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      [autoControlManagerFSM2 diag];
      v37 = v36 = operation;
      v38 = [NSString alloc];
      summary = [v27 summary];
      v40 = [v38 initWithFormat:@"{%@} set-atomic-instance without atomicInstanceUUID | hadBeenLatestAtomicInstance:%@", vendCopy, summary];
      [v37 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v40 withResult:6108 withError:0];

      operation = v36;
    }

    [v19 appendString:{@", new previouslyVendedLocked"}];
    v32 = 1;
  }

  else
  {
    v32 = 0;
  }

  if (!toVendCopy)
  {
    [configurationCopy setLatestAtomicInstanceToVend:0];
    [configurationCopy setVendingAtomicInstanceForConfiguredEntries:0];
    [configurationCopy setLatestAtomicInstanceToVendFromPreSUStaging:0];
    goto LABEL_36;
  }

  availableForUseError = [configurationCopy availableForUseError];
  if (availableForUseError)
  {

    latestDownloadedAtomicInstance3 = [toVendCopy latestDownloadedAtomicInstance];
    [configurationCopy setLatestAtomicInstanceToVend:latestDownloadedAtomicInstance3];

    [configurationCopy setEverProvidedLatestToVend:1];
    [configurationCopy setLatestAtomicInstanceToVendFromPreSUStaging:stagingCopy];
    [(MADAutoAssetControlManager *)self setConfigurationClearAvailableForUseError:vendCopy forSetConfiguration:configurationCopy appendingToPersistReason:0 withReason:@"cleared set-configuration error tracking" maintainingHistoryOperation:0];
    [configurationCopy setNewerVersionError:0];
LABEL_30:
    v45 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
    {
      summary2 = [configurationCopy summary];
      *buf = 138543618;
      v60 = vendCopy;
      v61 = 2114;
      v62 = summary2;
      _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-STATUS-ERROR-CHANGE] cleared set-configuration error tracking | setConfiguration:%{public}@", buf, 0x16u);
    }

    goto LABEL_33;
  }

  newerVersionError = [configurationCopy newerVersionError];

  latestDownloadedAtomicInstance4 = [toVendCopy latestDownloadedAtomicInstance];
  [configurationCopy setLatestAtomicInstanceToVend:latestDownloadedAtomicInstance4];

  [configurationCopy setEverProvidedLatestToVend:1];
  [configurationCopy setLatestAtomicInstanceToVendFromPreSUStaging:stagingCopy];
  [(MADAutoAssetControlManager *)self setConfigurationClearAvailableForUseError:vendCopy forSetConfiguration:configurationCopy appendingToPersistReason:0 withReason:@"cleared set-configuration error tracking" maintainingHistoryOperation:0];
  [configurationCopy setNewerVersionError:0];
  if (newerVersionError)
  {
    goto LABEL_30;
  }

LABEL_33:
  v47 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
  {
    summary3 = [toVendCopy summary];
    *buf = 138543874;
    v60 = vendCopy;
    v61 = 2114;
    v62 = v19;
    v63 = 2114;
    v64 = summary3;
    _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[BECAME-LATEST-TO-VEND] adopted set-descriptor as latest-to-vend\n| persistReason:%{public}@\n| setDescriptor:%{public}@", buf, 0x20u);
  }

LABEL_36:
  [(MADAutoAssetControlManager *)self setConfigurationPersist:configurationCopy fromLocation:vendCopy forReason:v19 dueToAlter:0 forHistoryOperation:operation];
  v49 = v58;
  if (v58)
  {
    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:vendCopy toNewStatus:@"LATEST_TO_VEND" forAtomicInstance:v58];
  }

  if (v27)
  {
    if (v32)
    {
      clientDomainName = [v27 clientDomainName];
      assetSetIdentifier = [v27 assetSetIdentifier];
      atomicInstanceUUID3 = [v27 atomicInstanceUUID];
      [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_UNLOCK_DESIRED" forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstanceUUID:atomicInstanceUUID3 fromModule:@"AUTO-CONTROL" fromLocation:vendCopy];

      v49 = v58;
      v53 = @"PREVIOUS_VEND_LOCKED";
    }

    else
    {
      v53 = @"FORGOTTEN";
    }

    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:vendCopy toNewStatus:v53 forAtomicInstance:v27];
  }

  return toVendCopy != 0;
}

- (id)setConfigurationPreviouslyVendedLockedAtomicInstances:(id)instances
{
  instancesCopy = instances;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  previouslyVendedLockedAtomicInstances = [instancesCopy previouslyVendedLockedAtomicInstances];

  if (!previouslyVendedLockedAtomicInstances)
  {
    goto LABEL_17;
  }

  previouslyVendedLockedAtomicInstances2 = [instancesCopy previouslyVendedLockedAtomicInstances];
  v9 = [previouslyVendedLockedAtomicInstances2 count];

  if (!v9)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v28 = [NSString alloc];
    summary = [instancesCopy summary];
    v30 = [v28 initWithFormat:@"{setConfigurationPreviouslyVendedLockedAtomicInstances} set-configuration with invalid previouslyVendedLockedAtomicInstances | setConfiguration:%@", summary];
    [diag trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v30 withResult:6108 withError:0];

LABEL_17:
    v10 = 0;
    goto LABEL_18;
  }

  v10 = objc_alloc_init(NSMutableArray);
  v36 = 0u;
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v33 = instancesCopy;
  previouslyVendedLockedAtomicInstances3 = [instancesCopy previouslyVendedLockedAtomicInstances];
  v12 = [previouslyVendedLockedAtomicInstances3 copy];

  obj = v12;
  v13 = [v12 countByEnumeratingWithState:&v36 objects:v40 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v37;
    v32 = *v37;
    do
    {
      v16 = 0;
      v34 = v14;
      do
      {
        if (*v37 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v36 + 1) + 8 * v16);
        v18 = objc_autoreleasePoolPush();
        v19 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v17];
        if (v19)
        {
          [v10 addObject:v19];
        }

        else
        {
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag2 = [autoControlManagerFSM3 diag];
          selfCopy = self;
          v23 = [NSString alloc];
          summary2 = [v33 summary];
          v25 = [v23 initWithFormat:@"{setConfigurationPreviouslyVendedLockedAtomicInstances} set-configuration previouslyVendedLockedAtomicInstances references orphan atomic-instance | nextPreviouslyVendedStillLockedUUID:%@ | setConfiguration:%@", v17, summary2];
          [diag2 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v25 withResult:6108 withError:0];

          self = selfCopy;
          v14 = v34;

          v15 = v32;
        }

        objc_autoreleasePoolPop(v18);
        v16 = v16 + 1;
      }

      while (v14 != v16);
      v14 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
    }

    while (v14);
  }

  if (![v10 count])
  {

    v10 = 0;
  }

  instancesCopy = v33;
LABEL_18:

  return v10;
}

- (void)setConfigurationPersist:(id)persist fromLocation:(id)location forReason:(id)reason dueToAlter:(BOOL)alter forHistoryOperation:(int64_t)operation
{
  persistCopy = persist;
  locationCopy = location;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (persistCopy)
  {
    v35 = reasonCopy;
    v16 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:persistCopy];
    v17 = objc_opt_self();
    persistedKnownSetConfigurations = [v17 persistedKnownSetConfigurations];
    v19 = [persistedKnownSetConfigurations persistedEntryAlreadyExists:v16 fromLocation:locationCopy];

    v20 = @"ENTRY_ADD";
    if (v19)
    {
      v20 = @"ENTRY_MODIFY";
    }

    v21 = v20;
    persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
    v23 = [persistedKnownSetConfigurations2 persistedEntry:v16 fromLocation:locationCopy];

    if (v23)
    {
      [v23 persistSecureCodedObject:persistCopy forKey:@"setConfiguration"];
      persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      [persistCopy summary];
      v26 = v25 = operation;
      [persistedKnownSetConfigurations3 storePersistedEntry:v16 withEntrySummary:v26 fromLocation:locationCopy];

      v27 = [NSString alloc];
      if (v19)
      {
        v28 = @"altered";
      }

      else
      {
        v28 = @"new";
      }

      summary = [persistCopy summary];
      v30 = [v27 initWithFormat:@"%@ set-configuration - %@ | setConfiguration:%@", v28, v35, summary];
      [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:locationCopy operation:v21 forPersistedEntryID:v16 withSetConfiguration:persistCopy historyOperation:v25 message:v30];

      knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      [knownSetConfigurationsByIdentifier setSafeObject:persistCopy forKey:v16];
    }

    else
    {
      v32 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary2 = [persistCopy summary];
        *buf = 138543874;
        v37 = _updateLatestSummary;
        v38 = 2114;
        v39 = locationCopy;
        v40 = 2114;
        v41 = summary2;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:setConfigurationPersist} unable to load persisted-set-configuration file | setConfiguration:%{public}@", buf, 0x20u);
      }
    }

    reasonCopy = v35;
  }
}

- (id)setConfigurationFromMessageName:(id)name withInfoInstance:(id)instance errorCode:(int64_t *)code errorDescription:(id *)description
{
  nameCopy = name;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v14 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForInfoInstance:instanceCopy];
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v16 = [knownSetConfigurationsByIdentifier safeObjectForKey:v14 ofClass:objc_opt_class()];

  v17 = [SUCore stringIsEqual:nameCopy to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
  if (v16)
  {
    if (v17)
    {
      goto LABEL_20;
    }

    autoAssetEntries = [instanceCopy autoAssetEntries];

    if (!autoAssetEntries)
    {
      goto LABEL_20;
    }

    if ([SUCore stringIsEqual:nameCopy to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"])
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [instanceCopy summary];
        summary2 = [v16 summary];
        *buf = 138544130;
        v51 = _updateLatestSummary;
        v52 = 2114;
        v53 = nameCopy;
        v54 = 2114;
        v55 = summary;
        v56 = 2114;
        v57 = summary2;
        v23 = "[%{public}@] {setConfigurationFromMessageName} pre-existing set-configuration potentially valid for forming sub-atomic-instance | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@";
LABEL_18:
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, v23, buf, 0x2Au);

        goto LABEL_19;
      }

      goto LABEL_19;
    }

    if ([SUCore stringIsEqual:nameCopy to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"])
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [instanceCopy summary];
        summary2 = [v16 summary];
        *buf = 138544130;
        v51 = _updateLatestSummary;
        v52 = 2114;
        v53 = nameCopy;
        v54 = 2114;
        v55 = summary;
        v56 = 2114;
        v57 = summary2;
        v23 = "[%{public}@] {setConfigurationFromMessageName} pre-existing set-configuration potentially being altered | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@";
        goto LABEL_18;
      }

LABEL_19:

      goto LABEL_20;
    }

    autoAssetEntries2 = [v16 autoAssetEntries];

    if (!autoAssetEntries2)
    {
      v44 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary3 = [instanceCopy summary];
        summary4 = [v16 summary];
        *buf = 138544130;
        v51 = _updateLatestSummary2;
        v52 = 2114;
        v53 = nameCopy;
        v54 = 2114;
        v55 = summary3;
        v56 = 2114;
        v57 = summary4;
        _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setConfigurationFromMessageName} auto-asset-entries learned for pre-existing set-configuration | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@", buf, 0x2Au);
      }

      autoAssetEntries3 = [instanceCopy autoAssetEntries];
      [v16 setAutoAssetEntries:autoAssetEntries3];

      goto LABEL_20;
    }

    if ([(MADAutoAssetControlManager *)self setConfiguration:v16 matchesAssetEntriesFromInfoInstance:instanceCopy])
    {
LABEL_20:
      v27 = 0;
      v28 = 0;
      goto LABEL_21;
    }

    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary5 = [instanceCopy summary];
      summary6 = [v16 summary];
      *buf = 138544130;
      v51 = _updateLatestSummary3;
      v52 = 2114;
      v53 = nameCopy;
      v54 = 2114;
      v55 = summary5;
      v56 = 2114;
      v57 = summary6;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} different auto-asset-entries than are currently defined | messageName:%{public}@, setInfoInstance:%{public}@, setConfiguration:%{public}@", buf, 0x2Au);
    }

    v27 = 0;
    v28 = 0;
    v16 = 0;
  }

  else if (v17 & 1 | ![(MADAutoAssetControlManager *)self _setMessageCanCreateSetConfiguration:nameCopy])
  {
    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary7 = [instanceCopy summary];
      *buf = 138543874;
      v51 = _updateLatestSummary4;
      v52 = 2114;
      v53 = nameCopy;
      v54 = 2114;
      v55 = summary7;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no set-configuration found for command requiring pre-defined set-configuration | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
    }

    v16 = 0;
    v27 = @"no known set-configuration for command requiring pre-defined set-configuration";
    v28 = 6558;
  }

  else
  {
    autoAssetEntries4 = [instanceCopy autoAssetEntries];

    if (autoAssetEntries4)
    {
      autoAssetEntries5 = [instanceCopy autoAssetEntries];
      v31 = [autoAssetEntries5 count];

      if (v31)
      {
        v49 = 0;
        v28 = [(MADAutoAssetControlManager *)self setConfigurationNewSetConfiguration:@"setConfigurationFromMessageName" forSetInfoInstance:instanceCopy dueToMessageName:nameCopy selectedConfig:&v49];
        v16 = v49;
        if (v16)
        {
          v27 = 0;
        }

        else
        {
          v27 = @"unable to create set-configuration from provided asset-entries";
          v28 = 6101;
        }
      }

      else
      {
        v41 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v41, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary8 = [instanceCopy summary];
          *buf = 138543874;
          v51 = _updateLatestSummary5;
          v52 = 2114;
          v53 = nameCopy;
          v54 = 2114;
          v55 = summary8;
          _os_log_impl(&dword_0, v41, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no known set-configuration and empty provided asset-entries | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
        }

        v16 = 0;
        v27 = @"no known set-configuration and empty provided asset-entries";
        v28 = 6555;
      }
    }

    else
    {
      v33 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary9 = [instanceCopy summary];
        *buf = 138543874;
        v51 = _updateLatestSummary6;
        v52 = 2114;
        v53 = nameCopy;
        v54 = 2114;
        v55 = summary9;
        _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "[%{public}@] {setConfigurationFromMessageName} no known set-configuration and no asset-entries provided | messageName:%{public}@, setInfoInstance:%{public}@", buf, 0x20u);
      }

      v16 = 0;
      v27 = @"no known set-configuration and no asset-entries provided";
      v28 = 6551;
    }
  }

LABEL_21:
  if (code)
  {
    *code = v28;
  }

  if (description)
  {
    *description = v27;
  }

  return v16;
}

- (id)setConfigurationForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];

  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [knownSetConfigurationsByIdentifier safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)setConfigurationVendingDescriptor:(id)descriptor managedAsSet:(BOOL *)set
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v9 = [persistedKnownSetConfigurations persistedEntryIDs:@"{setConfigurationVendingDescriptor}"];

  if ([v9 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationVendingDescriptor" ofContainer:@"persistedKnownSetConfigurations"];
    v70 = 0u;
    v71 = 0u;
    v68 = 0u;
    v69 = 0u;
    v10 = v9;
    v56 = [v10 countByEnumeratingWithState:&v68 objects:v75 count:16];
    if (v56)
    {
      setCopy = set;
      v11 = 0;
      v12 = *v69;
      v51 = v10;
      v52 = v9;
      v48 = *v69;
      selfCopy = self;
      while (1)
      {
        for (i = 0; i != v56; i = v42 + 1)
        {
          if (*v69 != v12)
          {
            objc_enumerationMutation(v10);
          }

          v57 = i;
          v14 = *(*(&v68 + 1) + 8 * i);
          context = objc_autoreleasePoolPush();
          persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v16 = [persistedKnownSetConfigurations2 persistedEntry:v14 fromLocation:@"{setConfigurationVendingDescriptor}"];

          if (v16)
          {
            persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            v18 = [persistedKnownSetConfigurations3 decodeFromLocation:@"{setConfigurationVendingDescriptor}" ofEntryName:v14 fromPersistedEntry:v16 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              v55 = v16;
              [v18 firstEntryAssetType];
              v20 = v19 = v18;
              assetType = [descriptorCopy assetType];
              v22 = [SUCore stringIsEqual:v20 to:assetType];

              if (!v22)
              {
                v42 = v57;
                v18 = v19;
LABEL_34:
                v16 = v55;
                goto LABEL_40;
              }

              latestAtomicInstanceToVend = [v19 latestAtomicInstanceToVend];

              v18 = v19;
              if (!latestAtomicInstanceToVend)
              {
                v11 = 1;
                v42 = v57;
                goto LABEL_34;
              }

              latestAtomicInstanceToVend2 = [v19 latestAtomicInstanceToVend];
              v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setConfigurationVendingDescriptor" forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

              v16 = v55;
              v54 = v25;
              if (v25)
              {
                v66 = 0u;
                v67 = 0u;
                v64 = 0u;
                v65 = 0u;
                latestDowloadedAtomicInstanceEntries = [v25 latestDowloadedAtomicInstanceEntries];
                p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
                v63 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v64 objects:v72 count:16];
                if (v63)
                {
                  v53 = v18;
                  v62 = *v65;
                  v28 = descriptorCopy;
                  v60 = latestDowloadedAtomicInstanceEntries;
                  while (1)
                  {
                    for (j = 0; j != v63; j = j + 1)
                    {
                      if (*v65 != v62)
                      {
                        objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
                      }

                      v30 = *(*(&v64 + 1) + 8 * j);
                      v31 = p_weak_ivar_lyt[223];
                      fullAssetSelector = [v30 fullAssetSelector];
                      assetType2 = [fullAssetSelector assetType];
                      assetType3 = [v28 assetType];
                      if (![v31 stringIsEqual:assetType2 to:assetType3])
                      {
                        goto LABEL_22;
                      }

                      v35 = p_weak_ivar_lyt[223];
                      fullAssetSelector2 = [v30 fullAssetSelector];
                      assetSpecifier = [fullAssetSelector2 assetSpecifier];
                      assetSpecifier2 = [v28 assetSpecifier];
                      if (![v35 stringIsEqual:assetSpecifier to:assetSpecifier2])
                      {

                        latestDowloadedAtomicInstanceEntries = v60;
LABEL_22:

                        continue;
                      }

                      v38 = p_weak_ivar_lyt[223];
                      fullAssetSelector3 = [v30 fullAssetSelector];
                      assetVersion = [fullAssetSelector3 assetVersion];
                      assetVersion2 = [v28 assetVersion];
                      LOBYTE(v38) = [v38 stringIsEqual:assetVersion to:assetVersion2];

                      v28 = descriptorCopy;
                      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

                      latestDowloadedAtomicInstanceEntries = v60;
                      if (v38)
                      {

                        objc_autoreleasePoolPop(context);
                        v11 = 1;
                        set = setCopy;
                        v10 = v51;
                        v9 = v52;
                        v46 = v53;
                        goto LABEL_46;
                      }
                    }

                    v63 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v64 objects:v72 count:16];
                    if (!v63)
                    {
                      v10 = v51;
                      v9 = v52;
                      v12 = v48;
                      self = selfCopy;
                      v42 = v57;
                      v18 = v53;
                      v16 = v55;
                      goto LABEL_38;
                    }
                  }
                }
              }

              else
              {
                latestDowloadedAtomicInstanceEntries = _MADLog(@"AutoControl");
                if (os_log_type_enabled(latestDowloadedAtomicInstanceEntries, OS_LOG_TYPE_ERROR))
                {
                  summary = [v18 summary];
                  *buf = 138543362;
                  v74 = summary;
                  _os_log_impl(&dword_0, latestDowloadedAtomicInstanceEntries, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load set descriptor for latest-to-vend | setConfiguration:%{public}@", buf, 0xCu);
                }
              }

              v42 = v57;
LABEL_38:

              v11 = 1;
              v44 = v54;
            }

            else
            {
              v44 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v74 = v16;
                _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load secure-coded set-configuration | entryID:%{public}@", buf, 0xCu);
              }

              v42 = v57;
            }
          }

          else
          {
            v43 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v74 = v14;
              _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "{setConfigurationVendingDescriptor} unable to load set-configuration from persisted-state | entryID:%{public}@", buf, 0xCu);
            }

            v42 = v57;
            v18 = v43;
            v16 = 0;
          }

LABEL_40:

          objc_autoreleasePoolPop(context);
        }

        v56 = [v10 countByEnumeratingWithState:&v68 objects:v75 count:16];
        if (!v56)
        {
          v46 = 0;
          set = setCopy;
          goto LABEL_46;
        }
      }
    }

    v11 = 0;
    v46 = 0;
LABEL_46:

    if (set)
    {
      goto LABEL_47;
    }
  }

  else
  {
    v11 = 0;
    v46 = 0;
    if (set)
    {
LABEL_47:
      *set = v11 & 1;
    }
  }

  return v46;
}

- (BOOL)setConfigurationReferencesDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v8 = [persistedKnownSetConfigurations persistedEntryIDs:@"{setConfigurationReferencesDescriptor}"];

  if (![v8 count])
  {
    v9 = 0;
    goto LABEL_59;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setConfigurationReferencesDescriptor" ofContainer:@"persistedKnownSetConfigurations"];
  v82 = 0u;
  v83 = 0u;
  v80 = 0u;
  v81 = 0u;
  obj = v8;
  v60 = [obj countByEnumeratingWithState:&v80 objects:v88 count:16];
  v9 = 0;
  if (!v60)
  {
    goto LABEL_57;
  }

  v59 = *v81;
  selfCopy = self;
  v66 = descriptorCopy;
  v61 = v8;
  do
  {
    v10 = 0;
    do
    {
      if (*v81 != v59)
      {
        v11 = v10;
        objc_enumerationMutation(obj);
        v10 = v11;
      }

      v63 = v10;
      v12 = *(*(&v80 + 1) + 8 * v10);
      context = objc_autoreleasePoolPush();
      persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v14 = [persistedKnownSetConfigurations2 persistedEntry:v12 fromLocation:@"{setConfigurationReferencesDescriptor}"];

      v64 = v14;
      if (!v14)
      {
        v16 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v87 = v12;
          _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load set-configuration from persisted-state | entryID:%{public}@", buf, 0xCu);
        }

        goto LABEL_33;
      }

      persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v16 = [persistedKnownSetConfigurations3 decodeFromLocation:@"{setConfigurationReferencesDescriptor}" ofEntryName:v12 fromPersistedEntry:v14 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v16)
      {
        v36 = _MADLog(@"AutoControl");
        v8 = v61;
        if (os_log_type_enabled(v36, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v87 = v64;
          _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load secure-coded set-configuration | entryID:%{public}@", buf, 0xCu);
        }

        goto LABEL_34;
      }

      firstEntryAssetType = [v16 firstEntryAssetType];
      assetType = [descriptorCopy assetType];
      v19 = [SUCore stringIsEqual:firstEntryAssetType to:assetType];

      if (!v19)
      {
        descriptorCopy = v66;
LABEL_33:
        v8 = v61;
        goto LABEL_34;
      }

      latestAtomicInstanceToVend = [v16 latestAtomicInstanceToVend];

      v8 = v61;
      if (!latestAtomicInstanceToVend)
      {
        descriptorCopy = v66;
        if ((v9 & 1) == 0)
        {
          goto LABEL_41;
        }

        goto LABEL_37;
      }

      latestAtomicInstanceToVend2 = [v16 latestAtomicInstanceToVend];
      v22 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setConfigurationReferencesDescriptor" forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

      v23 = v22;
      descriptorCopy = v66;
      if (!v23)
      {
        v37 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
        {
          summary = [v16 summary];
          *buf = 138543362;
          v87 = summary;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "{setConfigurationReferencesDescriptor} unable to load set descriptor for latest-to-vend | setConfiguration:%{public}@", buf, 0xCu);

          v8 = v61;
        }

        if (v9)
        {
          goto LABEL_37;
        }

LABEL_41:
        v74 = 0u;
        v75 = 0u;
        v72 = 0u;
        v73 = 0u;
        v57 = v16;
        autoAssetEntries = [v16 autoAssetEntries];
        v39 = [autoAssetEntries countByEnumeratingWithState:&v72 objects:v84 count:16];
        if (v39)
        {
          v40 = v39;
          v41 = *v73;
          do
          {
            v42 = 0;
            v69 = v40;
            do
            {
              if (*v73 != v41)
              {
                objc_enumerationMutation(autoAssetEntries);
              }

              v43 = *(*(&v72 + 1) + 8 * v42);
              assetSelector = [v43 assetSelector];
              assetType2 = [assetSelector assetType];
              assetType3 = [v66 assetType];
              if (([SUCore stringIsEqual:assetType2 to:assetType3]& 1) != 0)
              {
                assetSelector2 = [v43 assetSelector];
                assetSpecifier = [assetSelector2 assetSpecifier];
                assetSpecifier2 = [v66 assetSpecifier];
                v50 = [SUCore stringIsEqual:assetSpecifier to:assetSpecifier2];

                v40 = v69;
                if (v50)
                {
                  v9 = 1;
                  goto LABEL_53;
                }
              }

              else
              {
              }

              v42 = v42 + 1;
            }

            while (v40 != v42);
            v40 = [autoAssetEntries countByEnumeratingWithState:&v72 objects:v84 count:16];
          }

          while (v40);
          v9 = 0;
LABEL_53:
          descriptorCopy = v66;
          self = selfCopy;
          v8 = v61;
        }

        else
        {
          v9 = 0;
        }

        v16 = v57;
        goto LABEL_34;
      }

      v53 = v9;
      v55 = v23;
      v56 = v16;
      v78 = 0u;
      v79 = 0u;
      v76 = 0u;
      v77 = 0u;
      latestDowloadedAtomicInstanceEntries = [v23 latestDowloadedAtomicInstanceEntries];
      v70 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v76 objects:v85 count:16];
      if (!v70)
      {
        goto LABEL_25;
      }

      v68 = *v77;
      do
      {
        for (i = 0; i != v70; i = i + 1)
        {
          if (*v77 != v68)
          {
            objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
          }

          v25 = *(*(&v76 + 1) + 8 * i);
          fullAssetSelector = [v25 fullAssetSelector];
          assetType4 = [fullAssetSelector assetType];
          assetType5 = [descriptorCopy assetType];
          if (![SUCore stringIsEqual:assetType4 to:assetType5])
          {
            goto LABEL_22;
          }

          fullAssetSelector2 = [v25 fullAssetSelector];
          assetSpecifier3 = [fullAssetSelector2 assetSpecifier];
          assetSpecifier4 = [descriptorCopy assetSpecifier];
          v31 = assetSpecifier3;
          if (![SUCore stringIsEqual:assetSpecifier3 to:assetSpecifier4])
          {

LABEL_22:
            continue;
          }

          fullAssetSelector3 = [v25 fullAssetSelector];
          assetVersion = [fullAssetSelector3 assetVersion];
          assetVersion2 = [descriptorCopy assetVersion];
          v35 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

          descriptorCopy = v66;
          if (v35)
          {

            v9 = 1;
            v8 = v61;
            v16 = v56;
            self = selfCopy;
            goto LABEL_34;
          }
        }

        v70 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v76 objects:v85 count:16];
      }

      while (v70);
LABEL_25:

      v8 = v61;
      v16 = v56;
      self = selfCopy;
      if ((v53 & 1) == 0)
      {
        goto LABEL_41;
      }

LABEL_37:
      v9 = 1;
LABEL_34:

      objc_autoreleasePoolPop(context);
      v10 = v63 + 1;
    }

    while ((v63 + 1) != v60);
    v51 = [obj countByEnumeratingWithState:&v80 objects:v88 count:16];
    v60 = v51;
  }

  while (v51);
LABEL_57:

LABEL_59:
  return v9 & 1;
}

- (id)setConfigurationAssetEntries:(id)entries
{
  entriesCopy = entries;
  clientDomainName = [entriesCopy clientDomainName];
  assetSetIdentifier = [entriesCopy assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self setConfigurationAssetEntries:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  return v7;
}

- (id)setConfigurationAssetEntries:(id)entries forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  entriesCopy = entries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:entriesCopy forAssetSetIdentifier:identifierCopy];
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  v12 = [knownSetConfigurationsByIdentifier safeObjectForKey:v10 ofClass:objc_opt_class()];

  autoAssetEntries = [v12 autoAssetEntries];

  return autoAssetEntries;
}

- (id)setConfigurationNewEntryIDForSetConfiguration:(id)configuration
{
  configurationCopy = configuration;
  clientDomainName = [configurationCopy clientDomainName];
  assetSetIdentifier = [configurationCopy assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  return v7;
}

- (id)setConfigurationNewEntryIDForInfoInstance:(id)instance
{
  instanceCopy = instance;
  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];

  v7 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  return v7;
}

- (id)setConfigurationNewEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  v4 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domain forAssetSetIdentifier:identifier];

  return v4;
}

- (BOOL)setConfiguration:(id)configuration matchesAssetEntriesFromInfoInstance:(id)instance
{
  configurationCopy = configuration;
  instanceCopy = instance;
  v8 = instanceCopy;
  if (!configurationCopy || !instanceCopy || ([configurationCopy autoAssetEntries], (v9 = objc_claimAutoreleasedReturnValue()) == 0) || (v10 = v9, objc_msgSend(v8, "autoAssetEntries"), v11 = objc_claimAutoreleasedReturnValue(), v11, v10, !v11))
  {
    autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v35 = [NSString alloc];
    if (configurationCopy)
    {
      summary = [configurationCopy summary];
      if (v8)
      {
LABEL_40:
        summary2 = [v8 summary];
LABEL_43:
        v38 = [v35 initWithFormat:@"{setConfiguration:matchesAssetEntriesFromInfoInstance:} missing required | setConfiguration:%@, setInfoInstance:%@", summary, summary2];
        [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v38 withResult:6111 withError:0];

        if (v8)
        {
        }

        if (configurationCopy)
        {
        }

LABEL_48:
        v32 = 0;
        goto LABEL_49;
      }
    }

    else
    {
      summary = @"N";
      if (v8)
      {
        goto LABEL_40;
      }
    }

    summary2 = @"N";
    goto LABEL_43;
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  obj = [configurationCopy autoAssetEntries];
  v12 = [obj countByEnumeratingWithState:&v54 objects:v61 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v55;
    while (1)
    {
      v15 = 0;
LABEL_8:
      if (*v55 != v14)
      {
        objc_enumerationMutation(obj);
      }

      v16 = *(*(&v54 + 1) + 8 * v15);
      v50 = 0u;
      v51 = 0u;
      v52 = 0u;
      v53 = 0u;
      autoAssetEntries = [v8 autoAssetEntries];
      v18 = [autoAssetEntries countByEnumeratingWithState:&v50 objects:v60 count:16];
      if (!v18)
      {
        break;
      }

      v19 = v18;
      v20 = *v51;
LABEL_12:
      v21 = 0;
      while (1)
      {
        if (*v51 != v20)
        {
          objc_enumerationMutation(autoAssetEntries);
        }

        if ([v16 isEqual:*(*(&v50 + 1) + 8 * v21)])
        {
          break;
        }

        if (v19 == ++v21)
        {
          v19 = [autoAssetEntries countByEnumeratingWithState:&v50 objects:v60 count:16];
          if (v19)
          {
            goto LABEL_12;
          }

          goto LABEL_50;
        }
      }

      if (++v15 != v13)
      {
        goto LABEL_8;
      }

      v13 = [obj countByEnumeratingWithState:&v54 objects:v61 count:16];
      if (!v13)
      {
        goto LABEL_21;
      }
    }

LABEL_50:

    goto LABEL_48;
  }

LABEL_21:

  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  obja = [v8 autoAssetEntries];
  v22 = [obja countByEnumeratingWithState:&v46 objects:v59 count:16];
  if (v22)
  {
    v23 = v22;
    v24 = *v47;
    while (1)
    {
      v25 = 0;
LABEL_24:
      if (*v47 != v24)
      {
        objc_enumerationMutation(obja);
      }

      v26 = *(*(&v46 + 1) + 8 * v25);
      v42 = 0u;
      v43 = 0u;
      v44 = 0u;
      v45 = 0u;
      autoAssetEntries2 = [configurationCopy autoAssetEntries];
      v28 = [autoAssetEntries2 countByEnumeratingWithState:&v42 objects:v58 count:16];
      if (!v28)
      {
        break;
      }

      v29 = v28;
      v30 = *v43;
LABEL_28:
      v31 = 0;
      while (1)
      {
        if (*v43 != v30)
        {
          objc_enumerationMutation(autoAssetEntries2);
        }

        if ([v26 isEqual:*(*(&v42 + 1) + 8 * v31)])
        {
          break;
        }

        if (v29 == ++v31)
        {
          v29 = [autoAssetEntries2 countByEnumeratingWithState:&v42 objects:v58 count:16];
          if (v29)
          {
            goto LABEL_28;
          }

          goto LABEL_51;
        }
      }

      if (++v25 != v23)
      {
        goto LABEL_24;
      }

      v23 = [obja countByEnumeratingWithState:&v46 objects:v59 count:16];
      v32 = 1;
      if (!v23)
      {
        goto LABEL_53;
      }
    }

LABEL_51:

    v32 = 0;
  }

  else
  {
    v32 = 1;
  }

LABEL_53:

LABEL_49:
  return v32;
}

- (BOOL)setConfigurationPotentialLatestToVend:(id)vend forSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration
{
  vendCopy = vend;
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationPotentialLatestToVend", vendCopy];
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance && ([descriptorCopy latestDowloadedAtomicInstanceEntries], v15 = objc_claimAutoreleasedReturnValue(), v16 = objc_msgSend(v15, "count"), v15, v16))
  {
    v34 = 0u;
    v35 = 0u;
    v32 = 0u;
    v33 = 0u;
    obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v17 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    if (v17)
    {
      v18 = v17;
      v19 = 0;
      v20 = *v33;
      v29 = configurationCopy;
      v30 = vendCopy;
      while (2)
      {
        for (i = 0; i != v18; i = i + 1)
        {
          if (*v33 != v20)
          {
            objc_enumerationMutation(obj);
          }

          v22 = *(*(&v32 + 1) + 8 * i);
          v23 = objc_autoreleasePoolPush();
          if (!v22)
          {
            goto LABEL_18;
          }

          fullAssetSelector = [v22 fullAssetSelector];
          v25 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

          if (!v25 || ![v25 isOnFilesystem] || +[MADAutoAssetSecure doesDescriptorInvolvePersonalization:forDescriptor:](MADAutoAssetSecure, "doesDescriptorInvolvePersonalization:forDescriptor:", vendCopy, v25) && +[MADAutoAssetSecure isPersonalizationRequired:forDescriptor:](MADAutoAssetSecure, "isPersonalizationRequired:forDescriptor:", vendCopy, v25))
          {

LABEL_18:
            objc_autoreleasePoolPop(v23);
            v26 = 0;
            configurationCopy = v29;
            vendCopy = v30;
            goto LABEL_20;
          }

          objc_autoreleasePoolPop(v23);
          v19 = 1;
        }

        v18 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
        v26 = 1;
        configurationCopy = v29;
        vendCopy = v30;
        if (v18)
        {
          continue;
        }

        break;
      }
    }

    else
    {
      v19 = 0;
      v26 = 1;
    }

LABEL_20:

    v27 = v19 & v26;
  }

  else
  {
    v27 = 0;
  }

  return v27;
}

- (BOOL)setConfigurationAdoptLatestToVend:(id)vend fromSetDescriptor:(id)descriptor toSetConfiguration:(id)configuration fromPreSUStaging:(BOOL)staging allowEmpty:(BOOL)empty
{
  stagingCopy = staging;
  vendCopy = vend;
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v151 = vendCopy;
  vendCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationAdoptLatestToVend", vendCopy];
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];
  v19 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestAtomicInstanceToVend];

  latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];

  if (!latestDownloadedAtomicInstance2)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v35 = [NSString alloc];
    if (descriptorCopy)
    {
      summary = [descriptorCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v38 = v151;
    v39 = [v35 initWithFormat:@"{%@} set-descriptor without latest-to-vend | setDescriptor:%@", vendCopy, summary];
    goto LABEL_41;
  }

  selfCopy = self;
  v21 = empty | v19;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v23 = ([latestDowloadedAtomicInstanceEntries count] != 0) | v21;

  if ((v23 & 1) == 0)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v37 = [NSString alloc];
    if (descriptorCopy)
    {
      summary = [descriptorCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v38 = v151;
    v39 = [v37 initWithFormat:@"{%@} empty set-descriptor | setDescriptor:%@", vendCopy, summary];
LABEL_41:
    v61 = v39;
    [diag trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v39 withResult:6108 withError:0];

    if (descriptorCopy)
    {
    }

LABEL_44:
    v62 = 0;
    goto LABEL_45;
  }

  v156 = 0u;
  v157 = 0u;
  v154 = 0u;
  v155 = 0u;
  latestDowloadedAtomicInstanceEntries2 = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v25 = [latestDowloadedAtomicInstanceEntries2 countByEnumeratingWithState:&v154 objects:v164 count:16];
  v153 = vendCopy;
  if (v25)
  {
    v26 = v25;
    v142 = configurationCopy;
    v144 = descriptorCopy;
    v27 = *v155;
    obj = latestDowloadedAtomicInstanceEntries2;
LABEL_5:
    v28 = 0;
    while (1)
    {
      if (*v155 != v27)
      {
        objc_enumerationMutation(obj);
      }

      v29 = *(*(&v154 + 1) + 8 * v28);
      v30 = objc_autoreleasePoolPush();
      if (!v29)
      {
        break;
      }

      fullAssetSelector = [v29 fullAssetSelector];
      v32 = [(MADAutoAssetControlManager *)selfCopy locateDownloadedByFullSelector:fullAssetSelector];

      if (!v32)
      {
        v147 = @"{%@} unable to locate asset-descriptor for atomic-instance entry | nextAtomicEntry:%@ | setDescriptor:%@";
        goto LABEL_50;
      }

      if (![v32 isOnFilesystem])
      {
        v147 = @"{%@} atomic-instance entry no longer on the filesystem | nextAtomicEntry:%@ | setDescriptor:%@";
LABEL_50:
        autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        diag2 = [autoControlManagerFSM3 diag];
        v73 = [NSString alloc];
        summary2 = [v29 summary];
        v68 = v144;
        summary3 = [v144 summary];
        vendCopy = v153;
        v76 = [v73 initWithFormat:v147, v153, summary2, summary3];
        [diag2 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v76 withResult:6108 withError:0];

LABEL_51:
        v77 = v30;
        descriptorCopy = v68;
        objc_autoreleasePoolPop(v77);

        v62 = 0;
        v38 = v151;
        configurationCopy = v142;
        p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
        if (v21)
        {
          goto LABEL_45;
        }

        goto LABEL_52;
      }

      if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:v153 forDescriptor:v32]&& [MADAutoAssetSecure isPersonalizationRequired:v153 forDescriptor:v32])
      {
        v95 = _MADLog(@"AutoControl");
        v38 = v151;
        if (os_log_type_enabled(v95, OS_LOG_TYPE_DEFAULT))
        {
          summary4 = [v29 summary];
          summary5 = [v144 summary];
          *buf = 138543874;
          v159 = v151;
          v160 = 2114;
          v161 = summary4;
          v162 = 2114;
          v163 = summary5;
          _os_log_impl(&dword_0, v95, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] [NO_CHANGE] atomic-instance entry requiring personalization | nextAtomicEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
        }

        objc_autoreleasePoolPop(v30);
        configurationCopy = v142;
        descriptorCopy = v144;
        vendCopy = v153;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if ((v21 & 1) == 0)
        {
          v62 = 1;
          goto LABEL_52;
        }

        goto LABEL_55;
      }

      objc_autoreleasePoolPop(v30);
      v28 = v28 + 1;
      v21 = 1;
      if (v26 == v28)
      {
        v26 = [obj countByEnumeratingWithState:&v154 objects:v164 count:16];
        if (v26)
        {
          goto LABEL_5;
        }

        configurationCopy = v142;
        descriptorCopy = v144;
        vendCopy = v153;
        goto LABEL_23;
      }
    }

    autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag3 = [autoControlManagerFSM4 diag];
    v67 = [NSString alloc];
    v68 = v144;
    summary6 = [v144 summary];
    vendCopy = v153;
    v70 = [v67 initWithFormat:@"{%@} unable to access latest downloaded atomic-instance entry | setDescriptor:%@", v153, summary6];
    [diag3 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v70 withResult:6108 withError:0];

    goto LABEL_51;
  }

  if ((v21 & 1) == 0)
  {
    v62 = 1;
    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
    v38 = v151;
LABEL_52:
    v78 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v78, OS_LOG_TYPE_DEFAULT))
    {
      summary7 = [descriptorCopy summary];
      *buf = 138543618;
      v159 = vendCopy;
      v160 = 2114;
      v161 = summary7;
      _os_log_impl(&dword_0, v78, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] [NO_CHANGE] no asset-versions are available to the client | setDescriptor:%{public}@", buf, 0x16u);
    }

    if (v62)
    {
LABEL_55:
      newerAtomicInstanceOncePersonalized = [configurationCopy newerAtomicInstanceOncePersonalized];
      if (newerAtomicInstanceOncePersonalized)
      {
        v81 = newerAtomicInstanceOncePersonalized;
        v82 = p_weak_ivar_lyt[223];
        latestDownloadedAtomicInstance3 = [descriptorCopy latestDownloadedAtomicInstance];
        newerAtomicInstanceOncePersonalized2 = [configurationCopy newerAtomicInstanceOncePersonalized];
        LOBYTE(v82) = [v82 stringIsEqual:latestDownloadedAtomicInstance3 to:newerAtomicInstanceOncePersonalized2];

        if (v82)
        {
          v62 = 0;
          vendCopy = v153;
          goto LABEL_45;
        }

        v85 = p_weak_ivar_lyt[223];
        newerAtomicInstanceOncePersonalized3 = [configurationCopy newerAtomicInstanceOncePersonalized];
        latestDownloadedAtomicInstance4 = [descriptorCopy latestDownloadedAtomicInstance];
        LODWORD(v85) = [v85 stringIsEqual:newerAtomicInstanceOncePersonalized3 to:latestDownloadedAtomicInstance4];

        if (v85)
        {
          v88 = selfCopy;
          autoControlManagerFSM5 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
          diag4 = [autoControlManagerFSM5 diag];
          v91 = [NSString alloc];
          summary8 = [configurationCopy summary];
          summary9 = [descriptorCopy summary];
          v94 = [v91 initWithFormat:@"{%@} set-configuration newer-once-personalized matches not-fully-personalized set-descriptor to become newer-once-personalized | setConfiguration:%@ | setDescriptor:%@", v153, summary8, summary9];
          [diag4 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v94 withResult:6108 withError:0];

          vendCopy = v153;
        }

        else
        {
          autoControlManagerFSM5 = [configurationCopy newerAtomicInstanceOncePersonalized];
          v88 = selfCopy;
          vendCopy = v153;
          [(MADAutoAssetControlManager *)selfCopy atomicInstanceRemove:v153 setAtomicInstanceUUID:autoControlManagerFSM5 removingForReason:@"dropping set-configuration older newer-once-personalized" historyOperation:343];
        }

        latestDownloadedAtomicInstance5 = [descriptorCopy latestDownloadedAtomicInstance];
        [configurationCopy setNewerAtomicInstanceOncePersonalized:latestDownloadedAtomicInstance5];

        [(MADAutoAssetControlManager *)v88 setConfigurationPersist:configurationCopy fromLocation:vendCopy forReason:@"unable to make latest-to-vend since not fully personalized so tracked as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
      }
    }

    goto LABEL_44;
  }

LABEL_23:
  if (v19)
  {
    if ([configurationCopy vendingAtomicInstanceForConfiguredEntries])
    {
LABEL_65:
      v62 = 0;
      v38 = v151;
      goto LABEL_45;
    }

    if (([configurationCopy vendingAtomicInstanceForConfiguredEntries] & 1) == 0)
    {
      v40 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
      {
        summary10 = [descriptorCopy summary];
        *buf = 138543618;
        v159 = vendCopy;
        v160 = 2114;
        v161 = summary10;
        _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] set-descriptor matches latest-to-vend when vendingAtomicInstanceForConfiguredEntries=NO | setDescriptor:%{public}@", buf, 0x16u);
      }
    }
  }

  if (![(MADAutoAssetControlManager *)selfCopy setDescriptorVerifyNoDuplicates:descriptorCopy])
  {
    v42 = [(MADAutoAssetControlManager *)selfCopy setDescriptorDedupDownloadedEntries:vendCopy forSetDescriptor:descriptorCopy];
    if (v42)
    {
      [(MADAutoAssetControlManager *)selfCopy persistSetDescriptorDownloadedJob:v42 fromLocation:vendCopy];
      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
      {
        summary11 = [v42 summary];
        *buf = 138543618;
        v159 = v153;
        v160 = 2114;
        v161 = summary11;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND][SELF-HEAL] deduped setDescriptor:%{public}@", buf, 0x16u);
      }

      v45 = v42;
      descriptorCopy = v45;
    }
  }

  if (![(MADAutoAssetControlManager *)selfCopy setDescriptorVerifyNoDuplicates:descriptorCopy])
  {
    autoControlManagerFSM6 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag5 = [autoControlManagerFSM6 diag];
    v100 = [NSString alloc];
    summary12 = [descriptorCopy summary];
    summary13 = [configurationCopy summary];
    v102 = [v100 initWithFormat:@"{%@} all entries available yet set-descriptor contains duplicate selectors | setDescriptor:%@| setConfiguration:%@", v153, summary12, summary13];
    [diag5 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v102 withResult:6108 withError:0];

    vendCopy = v153;
    goto LABEL_65;
  }

  v141 = v19;
  latestDownloadedAtomicInstance6 = [descriptorCopy latestDownloadedAtomicInstance];
  v47 = [(MADAutoAssetControlManager *)selfCopy locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance6];

  v48 = [[NSMutableString alloc] initWithString:{@"have-received-lookup-response, vending-for-configured"}];
  [configurationCopy setHaveReceivedLookupResponse:1];
  [configurationCopy setVendingAtomicInstanceForConfiguredEntries:1];
  newerAtomicInstanceOncePersonalized4 = [configurationCopy newerAtomicInstanceOncePersonalized];

  if (newerAtomicInstanceOncePersonalized4)
  {
    newerAtomicInstanceOncePersonalized5 = [configurationCopy newerAtomicInstanceOncePersonalized];
    latestDownloadedAtomicInstance7 = [descriptorCopy latestDownloadedAtomicInstance];
    v52 = [SUCore stringIsEqual:newerAtomicInstanceOncePersonalized5 to:latestDownloadedAtomicInstance7];

    if (v52)
    {
      autoControlManagerFSM7 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      diag6 = [autoControlManagerFSM7 diag];
      v55 = [NSString alloc];
      summary14 = [configurationCopy summary];
      [descriptorCopy summary];
      v57 = v47;
      v59 = v58 = v48;
      v60 = [v55 initWithFormat:@"{%@} set-configuration newer-once-personalized matches set-descriptor to become latest-to-vend | setConfiguration:%@ | setDescriptor:%@", v153, summary14, v59];
      [diag6 trackAnomaly:@"ANOMALY-LATEST-TO-VEND" forReason:v60 withResult:6108 withError:0];

      v48 = v58;
      v47 = v57;
    }

    else
    {
      autoControlManagerFSM7 = [configurationCopy newerAtomicInstanceOncePersonalized];
      [(MADAutoAssetControlManager *)selfCopy atomicInstanceRemove:v153 setAtomicInstanceUUID:autoControlManagerFSM7 removingForReason:@"dropping set-configuration newer-once-personalized" historyOperation:343];
    }

    [configurationCopy setNewerAtomicInstanceOncePersonalized:0];
    [v48 appendString:{@", cleared newer-once-personalized"}];
  }

  discoveredInFlightAtomicInstance = [configurationCopy discoveredInFlightAtomicInstance];
  latestDownloadedAtomicInstance8 = [descriptorCopy latestDownloadedAtomicInstance];
  v107 = [SUCore stringIsEqual:discoveredInFlightAtomicInstance to:latestDownloadedAtomicInstance8];

  if (v107)
  {
    [configurationCopy setDiscoveredInFlightAtomicInstance:0];
    [v48 appendString:{@", cleared discovered-in-flight"}];
  }

  [configurationCopy setHaveReceivedLookupResponse:1];
  [configurationCopy setVendingAtomicInstanceForConfiguredEntries:1];
  latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
  if (latestAtomicInstanceToVend2)
  {
    latestAtomicInstanceToVend3 = [configurationCopy latestAtomicInstanceToVend];
    v110 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:v153 forAtomicInstanceUUID:latestAtomicInstanceToVend3 requireExists:1];

    if (v110)
    {
      LODWORD(latestAtomicInstanceToVend2) = [(MADAutoAssetControlManager *)selfCopy doesSetJobDescriptor:descriptorCopy representSameContentAs:v110];
    }

    else
    {
      LODWORD(latestAtomicInstanceToVend2) = 0;
    }
  }

  vendCopy = v153;
  if ((v141 | latestAtomicInstanceToVend2))
  {
    [(MADAutoAssetControlManager *)selfCopy setConfigurationAssetSetIDMostRecentlyReceived:v153 fromSetDescriptor:descriptorCopy forSetConfiguration:configurationCopy buildingPersistReason:v48];
    [(MADAutoAssetControlManager *)selfCopy setConfigurationAssetSetIDLatestToVend:v153 fromSetDescriptor:descriptorCopy forSetConfiguration:configurationCopy buildingPersistReason:v48];
    [(MADAutoAssetControlManager *)selfCopy setConfigurationPersist:configurationCopy fromLocation:v153 forReason:v48 dueToAlter:0 forHistoryOperation:457];
    v62 = 0;
    v38 = v151;
  }

  else
  {
    v143 = v48;
    v62 = [(MADAutoAssetControlManager *)selfCopy setConfigurationTrackLatestToVend:v153 forSetConfiguration:configurationCopy becomingLatestToVend:descriptorCopy historyOperation:441 fromPreSUStaging:stagingCopy];
    v111 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v111, OS_LOG_TYPE_DEFAULT))
    {
      summary15 = [configurationCopy summary];
      *buf = 138543618;
      v159 = v153;
      v160 = 2114;
      v161 = summary15;
      _os_log_impl(&dword_0, v111, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[FROM-TRACKED-LATEST-TO-VEND] update to set-configuration latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x16u);
    }

    autoAssetEntries = [configurationCopy autoAssetEntries];
    v140 = [autoAssetEntries count];
    requestedAutoAssetEntries = [descriptorCopy requestedAutoAssetEntries];
    v139 = [requestedAutoAssetEntries count];
    discoveredAtomicEntries = [descriptorCopy discoveredAtomicEntries];
    v138 = [discoveredAtomicEntries count];
    obja = v47;
    [v47 instanceEntries];
    v116 = v115 = descriptorCopy;
    v117 = [v116 count];
    clientDomainName = [configurationCopy clientDomainName];
    [configurationCopy assetSetIdentifier];
    v120 = v119 = configurationCopy;
    latestAtomicInstanceToVend4 = [v119 latestAtomicInstanceToVend];
    v145 = v115;
    v122 = [(MADAutoAssetControlManager *)selfCopy _specifierVersionNamesForSetDescriptor:v115];
    [MADAutoAssetHistory recordOperation:441 toHistoryType:2 fromLayer:1 configuredCount:v140 requestedCount:v139 fromPallasCount:v138 vendingCount:v117 forClientDomainName:clientDomainName forAssetSetIdentifier:v120 forAtomicInstance:latestAtomicInstanceToVend4 withAddendumMessage:v122];

    configurationCopy = v119;
    if (+[MAAIRBEventReporter isAvailable])
    {
      v123 = [MAAIRBMobileAssetOperationMetadata alloc];
      v124 = [MADAutoAssetHistoryTracker operationName:441];
      v125 = [(MAAIRBMobileAssetOperationMetadata *)v123 initWithCode:441 name:v124];

      v126 = [MAAIRBMobileAssetAtomicInstance alloc];
      v127 = [MAAIRBMobileAssetAssetSet alloc];
      assetSetIdentifier = [v119 assetSetIdentifier];
      v129 = [(MAAIRBMobileAssetAssetSet *)v127 initWithAssetSetIdentifier:assetSetIdentifier];
      latestAtomicInstanceToVend5 = [v119 latestAtomicInstanceToVend];
      v131 = [(MAAIRBMobileAssetAtomicInstance *)v126 initWithAssetSet:v129 atomicInstanceId:latestAtomicInstanceToVend5];

      instanceEntries = [obja instanceEntries];
      v133 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v125, v131, [instanceEntries count]);

      v134 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v133];
      [MAAIRBEventReporter emitAppleIntelligenceEvent:v134];
    }

    descriptorCopy = v145;
    [(MADAutoAssetControlManager *)selfCopy _reclaimDownloadedDescriptorsWhenJustDownloaded:v145 fromLocation:v153];
    v38 = v151;
    v48 = v143;
    if (([v145 atomicInstanceDownloadedNotified] & 1) == 0)
    {
      [v145 setAtomicInstanceDownloadedNotified:1];
      [(MADAutoAssetControlManager *)selfCopy persistSetDescriptorDownloadedJob:v145 fromLocation:v153];
    }

    clientDomainName2 = [v119 clientDomainName];
    assetSetIdentifier2 = [v119 assetSetIdentifier];
    latestAtomicInstanceToVend6 = [v119 latestAtomicInstanceToVend];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_DOWNLOADED" forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forAtomicInstanceUUID:latestAtomicInstanceToVend6 fromModule:@"AUTO-CONTROL" fromLocation:v153];

    vendCopy = v153;
    v47 = obja;
  }

LABEL_45:
  return v62;
}

- (void)setConfigurationAssetSetIDMostRecentlyReceived:(id)received fromSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration buildingPersistReason:(id)reason
{
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  catalogCachedAssetSetID = [descriptorCopy catalogCachedAssetSetID];

  if (catalogCachedAssetSetID)
  {
    catalogCachedAssetSetID2 = [descriptorCopy catalogCachedAssetSetID];
    [configurationCopy setMostRecentlyReceivedCachedAssetSetID:catalogCachedAssetSetID2];
  }

  catalogDownloadedFromLive = [descriptorCopy catalogDownloadedFromLive];

  if (catalogDownloadedFromLive)
  {
    catalogDownloadedFromLive2 = [descriptorCopy catalogDownloadedFromLive];
    [configurationCopy setMostRecentlyReceivedDownloadedFromLive:catalogDownloadedFromLive2];
  }

  catalogLastTimeChecked = [descriptorCopy catalogLastTimeChecked];

  if (catalogLastTimeChecked)
  {
    catalogLastTimeChecked2 = [descriptorCopy catalogLastTimeChecked];
    [configurationCopy setMostRecentlyReceivedLastTimeChecked:catalogLastTimeChecked2];
  }

  catalogPostedDate = [descriptorCopy catalogPostedDate];

  if (catalogPostedDate)
  {
    catalogPostedDate2 = [descriptorCopy catalogPostedDate];
    [configurationCopy setMostRecentlyReceivedPostedDate:catalogPostedDate2];
  }

  [reasonCopy appendString:{@", updated asset-set-ID (most-recenty-received)"}];
}

- (void)setConfigurationAssetSetIDLatestToVend:(id)vend fromSetDescriptor:(id)descriptor forSetConfiguration:(id)configuration buildingPersistReason:(id)reason
{
  descriptorCopy = descriptor;
  configurationCopy = configuration;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  catalogCachedAssetSetID = [descriptorCopy catalogCachedAssetSetID];

  if (catalogCachedAssetSetID)
  {
    downloadedCatalogCachedAssetSetID = [descriptorCopy downloadedCatalogCachedAssetSetID];
    [configurationCopy setLatestToVendCachedAssetSetID:downloadedCatalogCachedAssetSetID];
  }

  catalogDownloadedFromLive = [descriptorCopy catalogDownloadedFromLive];

  if (catalogDownloadedFromLive)
  {
    downloadedCatalogDownloadedFromLive = [descriptorCopy downloadedCatalogDownloadedFromLive];
    [configurationCopy setLatestToVendDownloadedFromLive:downloadedCatalogDownloadedFromLive];
  }

  catalogLastTimeChecked = [descriptorCopy catalogLastTimeChecked];

  if (catalogLastTimeChecked)
  {
    downloadedCatalogLastTimeChecked = [descriptorCopy downloadedCatalogLastTimeChecked];
    [configurationCopy setLatestToVendLastTimeChecked:downloadedCatalogLastTimeChecked];
  }

  catalogPostedDate = [descriptorCopy catalogPostedDate];

  if (catalogPostedDate)
  {
    downloadedCatalogPostedDate = [descriptorCopy downloadedCatalogPostedDate];
    [configurationCopy setLatestToVendPostedDate:downloadedCatalogPostedDate];
  }

  [reasonCopy appendString:{@", updated asset-set-ID (latest-to-vend)"}];
}

- (BOOL)setConfigurationTrackAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration addingAtomicInstance:(id)instance
{
  configurationCopy = configuration;
  instanceCopy = instance;
  vendedCopy = vended;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendedCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationTrackAsPreviouslyVended", vendedCopy];
  if (instanceCopy)
  {
    previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];

    if (!previouslyVendedLockedAtomicInstances)
    {
      v15 = objc_alloc_init(NSMutableArray);
      [configurationCopy setPreviouslyVendedLockedAtomicInstances:v15];
    }

    previouslyVendedLockedAtomicInstances2 = [configurationCopy previouslyVendedLockedAtomicInstances];
    [previouslyVendedLockedAtomicInstances2 count];

    previouslyVendedLockedAtomicInstances3 = [configurationCopy previouslyVendedLockedAtomicInstances];
    [previouslyVendedLockedAtomicInstances3 addObject:instanceCopy];

    [configurationCopy setTicksUntilPreviousForceUnlocked:2];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v20 = [NSString alloc];
    summary = [configurationCopy summary];
    v22 = [v20 initWithFormat:@"{%@} setConfigurationTrackAsPreviouslyVended nil atomic-instance-UUID | setConfiguration:%@", vendedCopy, summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v22 withResult:6111 withError:0];
  }

  return instanceCopy != 0;
}

- (void)setConfigurationTickForPreviouslyVended
{
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"setConfigurationTickForPreviouslyVended" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)selfCopy knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v7 = [allKeys copy];

  v8 = [v7 countByEnumeratingWithState:&v32 objects:v38 count:16];
  if (v8)
  {
    v10 = v8;
    v11 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v13 = @"setConfigurationTickForPreviouslyVended";
    *&v9 = 138543362;
    v30 = v9;
    v31 = selfCopy;
    do
    {
      v14 = 0;
      do
      {
        if (*v33 != v11)
        {
          objc_enumerationMutation(v7);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)selfCopy knownSetConfigurationsByIdentifier];
        v18 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v15 ofClass:objc_opt_class()];

        if (([v18 ticksUntilPreviousForceUnlocked] & 0x8000000000000000) == 0)
        {
          ticksUntilPreviousForceUnlocked = [v18 ticksUntilPreviousForceUnlocked];
          ticksUntilPreviousForceUnlocked2 = [v18 ticksUntilPreviousForceUnlocked];
          if (ticksUntilPreviousForceUnlocked < 1)
          {
            if (ticksUntilPreviousForceUnlocked2 >= 1)
            {
              goto LABEL_15;
            }

LABEL_13:
            [(MADAutoAssetControlManager *)selfCopy setConfigurationAllPreviouslyVendedForceUnlock:v13 forSetConfiguration:v18, v21, v30];
            v21 = @"ticksUntilPreviousForceUnlocked FIRED - force-unlocked";
          }

          else
          {
            [v18 setTicksUntilPreviousForceUnlocked:ticksUntilPreviousForceUnlocked2 - 1];
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
            {
              [v18 summary];
              v23 = v10;
              v24 = v11;
              v25 = p_weak_ivar_lyt;
              v26 = v7;
              v28 = v27 = v13;
              *buf = v30;
              v37 = v28;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "{setConfigurationTickForPreviouslyVended}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] decremented countdown to force-unlocked | nextSetConfiguration:%{public}@", buf, 0xCu);

              v13 = v27;
              v7 = v26;
              p_weak_ivar_lyt = v25;
              v11 = v24;
              v10 = v23;
              selfCopy = v31;
            }

            ticksUntilPreviousForceUnlocked3 = [v18 ticksUntilPreviousForceUnlocked];
            v21 = @"decremented ticksUntilPreviousForceUnlocked";
            if (ticksUntilPreviousForceUnlocked3 <= 0)
            {
              goto LABEL_13;
            }
          }

          [(MADAutoAssetControlManager *)selfCopy setConfigurationPersist:v18 fromLocation:v13 forReason:v21 dueToAlter:0 forHistoryOperation:9999, v30];
        }

LABEL_15:

        objc_autoreleasePoolPop(v16);
        v14 = v14 + 1;
      }

      while (v10 != v14);
      v10 = [v7 countByEnumeratingWithState:&v32 objects:v38 count:16];
    }

    while (v10);
  }
}

- (void)setConfigurationForceUnlocked:(id)unlocked forSetConfiguration:(id)configuration
{
  configurationCopy = configuration;
  unlockedCopy = unlocked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  unlockedCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationForceUnlocked", unlockedCopy];
  latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];
  v11 = [(MADAutoAssetControlManager *)self locateSetDescriptor:unlockedCopy forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:0];

  latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
  v13 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend2];

  [(MADAutoAssetControlManager *)self setConfigurationAllPreviouslyVendedForceUnlock:unlockedCopy forSetConfiguration:configurationCopy];
  if (v11)
  {
    availableForUseError = [configurationCopy availableForUseError];
    [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:unlockedCopy dueToError:availableForUseError forgettingAtomicInstance:v13];
  }

  clientDomainName = [configurationCopy clientDomainName];
  assetSetIdentifier = [configurationCopy assetSetIdentifier];
  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:clientDomainName forSetIdentifier:assetSetIdentifier];

  [configurationCopy setVendingAtomicInstanceForConfiguredEntries:0];
  [(MADAutoAssetControlManager *)self setConfigurationTrackLatestToVend:unlockedCopy forSetConfiguration:configurationCopy becomingLatestToVend:0 historyOperation:442 fromPreSUStaging:0];
  [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:unlockedCopy toNewStatus:@"FORGOTTEN" forAtomicInstance:v13];
}

- (BOOL)setConfigurationIsTrackedAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration forAtomicInstanceUUID:(id)d
{
  vendedCopy = vended;
  configurationCopy = configuration;
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendedCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationIsTrackedAsPreviouslyVended", vendedCopy];
  previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];

  if (previouslyVendedLockedAtomicInstances)
  {
    previouslyVendedLockedAtomicInstances2 = [configurationCopy previouslyVendedLockedAtomicInstances];
    v16 = [previouslyVendedLockedAtomicInstances2 count];

    v17 = v16 - 1;
    if (v16 < 1)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      previouslyVendedLockedAtomicInstances = [autoControlManagerFSM2 diag];
      v23 = [NSString alloc];
      summary = [configurationCopy summary];
      v25 = [v23 initWithFormat:@"{%@} previouslyVendedLockedAtomicInstances count of 0 yet present | setConfiguration:%@", vendedCopy, summary];
      [previouslyVendedLockedAtomicInstances trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6111 withError:0];

      LOBYTE(previouslyVendedLockedAtomicInstances) = 0;
    }

    else
    {
      v18 = 0;
      do
      {
        v19 = objc_autoreleasePoolPush();
        previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];
        v20 = [previouslyVendedLockedAtomicInstances objectAtIndex:v18];

        LOBYTE(previouslyVendedLockedAtomicInstances) = [SUCore stringIsEqual:v20 to:dCopy];
        objc_autoreleasePoolPop(v19);
        if (previouslyVendedLockedAtomicInstances)
        {
          break;
        }
      }

      while (v17 != v18++);
    }
  }

  return previouslyVendedLockedAtomicInstances;
}

- (BOOL)setConfigurationAllPreviouslyVendedForceUnlock:(id)unlock forSetConfiguration:(id)configuration
{
  unlockCopy = unlock;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  unlockCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationAllPreviouslyVendedForceUnlock", unlockCopy];
  previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];
  v12 = previouslyVendedLockedAtomicInstances != 0;

  if (previouslyVendedLockedAtomicInstances)
  {
    previouslyVendedLockedAtomicInstances2 = [configurationCopy previouslyVendedLockedAtomicInstances];
    v14 = [previouslyVendedLockedAtomicInstances2 count];

    if (v14)
    {
      v49 = v12;
      v51 = unlockCopy;
      previouslyVendedLockedAtomicInstances3 = [configurationCopy previouslyVendedLockedAtomicInstances];
      v16 = [previouslyVendedLockedAtomicInstances3 count];

      v17 = [NSMutableString alloc];
      if (v16 == &dword_0 + 1)
      {
        v18 = @":";
      }

      else
      {
        v18 = @"s:\n";
      }

      v19 = [v17 initWithString:v18];
      v53 = objc_alloc_init(NSMutableArray);
      v59 = 0u;
      v60 = 0u;
      v61 = 0u;
      v62 = 0u;
      v50 = configurationCopy;
      previouslyVendedLockedAtomicInstances4 = [configurationCopy previouslyVendedLockedAtomicInstances];
      v21 = [previouslyVendedLockedAtomicInstances4 copy];

      obj = v21;
      v22 = [v21 countByEnumeratingWithState:&v59 objects:v68 count:16];
      if (v22)
      {
        v23 = v22;
        v24 = *v60;
        v25 = 1;
        selfCopy = self;
        do
        {
          for (i = 0; i != v23; i = i + 1)
          {
            if (*v60 != v24)
            {
              objc_enumerationMutation(obj);
            }

            v27 = *(*(&v59 + 1) + 8 * i);
            v28 = objc_autoreleasePoolPush();
            v29 = [(MADAutoAssetControlManager *)self locateSetDescriptor:unlockCopy forAtomicInstanceUUID:v27 requireExists:1];
            if (v25)
            {
              [v19 appendString:v27];
              if (!v29)
              {
                goto LABEL_20;
              }
            }

            else
            {
              [v19 appendFormat:@", %@", v27];
              if (!v29)
              {
                goto LABEL_20;
              }
            }

            v30 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v27];
            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
            {
              [v29 summary];
              v32 = v23;
              v33 = v24;
              v35 = v34 = v19;
              *buf = 138543618;
              v65 = unlockCopy;
              v66 = 2114;
              v67 = v35;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] all previously vended force-unlocked | previouslyVendedSetDescriptor:%{public}@", buf, 0x16u);

              v19 = v34;
              v24 = v33;
              v23 = v32;
              self = selfCopy;
            }

            if (v30)
            {
              [v53 addObject:v30];
            }

LABEL_20:
            objc_autoreleasePoolPop(v28);
            v25 = 0;
          }

          v23 = [obj countByEnumeratingWithState:&v59 objects:v68 count:16];
          v25 = 0;
        }

        while (v23);
      }

      v57 = 0u;
      v58 = 0u;
      v55 = 0u;
      v56 = 0u;
      v36 = v53;
      v37 = [v36 countByEnumeratingWithState:&v55 objects:v63 count:16];
      v12 = v49;
      if (v37)
      {
        v38 = v37;
        v39 = *v56;
        do
        {
          for (j = 0; j != v38; j = j + 1)
          {
            if (*v56 != v39)
            {
              objc_enumerationMutation(v36);
            }

            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:unlockCopy dueToError:0 forgettingAtomicInstance:*(*(&v55 + 1) + 8 * j)];
          }

          v38 = [v36 countByEnumeratingWithState:&v55 objects:v63 count:16];
        }

        while (v38);
      }

      v41 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v41, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543618;
        v65 = unlockCopy;
        v66 = 2114;
        v67 = v19;
        _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[AUTO-CONTROL-PREVIOUSLY-VENDED-LOCKED] all previously vended force-unlocked | dropped atomic-instance%{public}@", buf, 0x16u);
      }

      configurationCopy = v50;
      unlockCopy = v51;
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v44 = [NSString alloc];
      summary = [configurationCopy summary];
      v46 = [v44 initWithFormat:@"{%@} ticksUntilPreviousForceUnlocked at 0 yet no previouslyVendedLockedAtomicInstances | setConfiguration:%@", unlockCopy, summary];
      [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v46 withResult:6111 withError:0];
    }
  }

  previouslyVendedLockedAtomicInstances5 = [configurationCopy previouslyVendedLockedAtomicInstances];

  if (previouslyVendedLockedAtomicInstances5)
  {
    [configurationCopy setPreviouslyVendedLockedAtomicInstances:0];
    v12 = 1;
  }

  if ([configurationCopy ticksUntilPreviousForceUnlocked] != -1)
  {
    [configurationCopy setTicksUntilPreviousForceUnlocked:-1];
    v12 = 1;
  }

  return v12;
}

- (BOOL)setConfigurationForgetIfTrackedAsPreviouslyVended:(id)vended forSetConfiguration:(id)configuration removingAtomicInstance:(id)instance
{
  vendedCopy = vended;
  configurationCopy = configuration;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  vendedCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationForgetIfTrackedAsPreviouslyVended", vendedCopy];
  previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];

  if (previouslyVendedLockedAtomicInstances)
  {
    previouslyVendedLockedAtomicInstances2 = [configurationCopy previouslyVendedLockedAtomicInstances];
    v16 = [previouslyVendedLockedAtomicInstances2 count];

    if (v16 <= 0)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v30 = [NSString alloc];
      summary = [configurationCopy summary];
      v32 = [v30 initWithFormat:@"{%@} previouslyVendedLockedAtomicInstances count of 0 yet present | setConfiguration:%@", vendedCopy, summary];
      [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v32 withResult:6111 withError:0];

      [configurationCopy setPreviouslyVendedLockedAtomicInstances:0];
      [configurationCopy setTicksUntilPreviousForceUnlocked:-1];
      v24 = 1;
    }

    else
    {
      selfCopy = self;
      v35 = vendedCopy;
      v36 = vendedCopy;
      v17 = objc_alloc_init(NSMutableArray);
      v18 = 0;
      v19 = -1;
      do
      {
        v20 = objc_autoreleasePoolPush();
        previouslyVendedLockedAtomicInstances3 = [configurationCopy previouslyVendedLockedAtomicInstances];
        v22 = [previouslyVendedLockedAtomicInstances3 objectAtIndex:v18];

        v23 = v18;
        if (([SUCore stringIsEqual:v22 to:instanceCopy]& 1) == 0)
        {
          [v17 addObject:v22];
          v23 = v19;
        }

        objc_autoreleasePoolPop(v20);
        ++v18;
        v19 = v23;
      }

      while (v16 != v18);
      v24 = v23 >= 0;
      vendedCopy = v35;
      if ((v23 & 0x8000000000000000) == 0)
      {
        v25 = [(MADAutoAssetControlManager *)selfCopy locateSetAtomicInstanceByInstanceUUID:instanceCopy];
        [configurationCopy setPreviouslyVendedLockedAtomicInstances:v17];
        previouslyVendedLockedAtomicInstances4 = [configurationCopy previouslyVendedLockedAtomicInstances];
        v27 = [previouslyVendedLockedAtomicInstances4 count];

        if (!v27)
        {
          [configurationCopy setPreviouslyVendedLockedAtomicInstances:0];
          [configurationCopy setTicksUntilPreviousForceUnlocked:-1];
        }

        if (v25)
        {
          [(MADAutoAssetControlManager *)selfCopy atomicInstanceForceUnlock:v35 dueToError:0 forgettingAtomicInstance:v25];
        }
      }

      vendedCopy = v36;
    }
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (void)setConfigurationRemovedAtomicInstance:(id)instance fromLocation:(id)location
{
  instanceCopy = instance;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationRemovedAtomicInstance", locationCopy];
  if (instanceCopy)
  {
    v29 = locationCopy;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
    v34 = 0u;
    v35 = 0u;
    v32 = 0u;
    v33 = 0u;
    knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
    [knownSetConfigurationsByIdentifier allKeys];
    v12 = v31 = locationCopy;
    v13 = [v12 copy];

    locationCopy = v31;
    obj = v13;
    v14 = [v13 countByEnumeratingWithState:&v32 objects:v36 count:16];
    if (!v14)
    {
      goto LABEL_18;
    }

    v15 = v14;
    v16 = *v33;
    while (1)
    {
      v17 = 0;
      do
      {
        if (*v33 != v16)
        {
          objc_enumerationMutation(obj);
        }

        v18 = *(*(&v32 + 1) + 8 * v17);
        v19 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v21 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v18 ofClass:objc_opt_class()];

        if (v21)
        {
          discoveredInFlightAtomicInstance = [v21 discoveredInFlightAtomicInstance];
          v23 = [SUCore stringIsEqual:discoveredInFlightAtomicInstance to:instanceCopy];

          if (v23)
          {
            [v21 setDiscoveredInFlightAtomicInstance:0];
          }

          newerAtomicInstanceOncePersonalized = [v21 newerAtomicInstanceOncePersonalized];
          v25 = [SUCore stringIsEqual:newerAtomicInstanceOncePersonalized to:instanceCopy];

          if (v25)
          {
            [v21 setNewerAtomicInstanceOncePersonalized:0];
            v23 = 1;
          }

          latestAtomicInstanceToVend = [v21 latestAtomicInstanceToVend];
          v27 = [SUCore stringIsEqual:latestAtomicInstanceToVend to:instanceCopy];

          if (v27)
          {
            [v21 setLatestAtomicInstanceToVend:0];
            [v21 setLatestAtomicInstanceToVendFromPreSUStaging:0];
            locationCopy = v31;
            [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:v31 forSetConfiguration:v21 removingAtomicInstance:instanceCopy];
          }

          else
          {
            locationCopy = v31;
            if ((([(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:v31 forSetConfiguration:v21 removingAtomicInstance:instanceCopy]| v23) & 1) == 0)
            {
              goto LABEL_16;
            }
          }

          instanceCopy = [[NSString alloc] initWithFormat:@"cleared UUID[%@] (removed across all atomic-instances)", instanceCopy];
          [(MADAutoAssetControlManager *)self setConfigurationPersist:v21 fromLocation:locationCopy forReason:instanceCopy dueToAlter:0 forHistoryOperation:9999];
        }

LABEL_16:

        objc_autoreleasePoolPop(v19);
        v17 = v17 + 1;
      }

      while (v15 != v17);
      v15 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
      if (!v15)
      {
LABEL_18:

        locationCopy = v29;
        break;
      }
    }
  }
}

- (void)setConfigurationEliminate:(id)eliminate forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  eliminateCopy = eliminate;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v47 = eliminateCopy;
  eliminateCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationEliminate", eliminateCopy];
  v48 = nameCopy;
  v49 = objc_alloc_init(NSMutableArray);
  v14 = nameCopy;
  v46 = identifierCopy;
  v15 = eliminateCopy;
  [(MADAutoAssetControlManager *)self removeSetTargetsForClientDomain:v14 forSetIdentifier:identifierCopy fromLocation:eliminateCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:eliminateCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
  v60 = 0u;
  v61 = 0u;
  v58 = 0u;
  v59 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v18 = [allKeys copy];

  obj = v18;
  v19 = [v18 countByEnumeratingWithState:&v58 objects:v67 count:16];
  v53 = v15;
  if (v19)
  {
    v20 = v19;
    v21 = *v59;
    do
    {
      for (i = 0; i != v20; i = i + 1)
      {
        if (*v59 != v21)
        {
          objc_enumerationMutation(obj);
        }

        v23 = *(*(&v58 + 1) + 8 * i);
        v24 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v26 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v23 ofClass:objc_opt_class()];

        if (v23)
        {
          v27 = v26 == 0;
        }

        else
        {
          v27 = 1;
        }

        if (!v27)
        {
          clientDomainName = [v26 clientDomainName];
          if ([SUCore stringIsEqual:v48 to:clientDomainName])
          {
            assetSetIdentifier = [v26 assetSetIdentifier];
            v30 = [SUCore stringIsEqual:v46 to:assetSetIdentifier];

            if (!v30)
            {
              goto LABEL_15;
            }

            [v49 addObject:v23];
            clientDomainName = _MADLog(@"AutoControl");
            if (os_log_type_enabled(clientDomainName, OS_LOG_TYPE_DEFAULT))
            {
              summary = [v26 summary];
              *buf = 138543618;
              v64 = v53;
              v65 = 2114;
              v66 = summary;
              _os_log_impl(&dword_0, clientDomainName, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@:} eliminating | nextSetConfiguration:%{public}@", buf, 0x16u);
            }
          }
        }

LABEL_15:

        objc_autoreleasePoolPop(v24);
      }

      v20 = [obj countByEnumeratingWithState:&v58 objects:v67 count:16];
    }

    while (v20);
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v50 = v49;
  v32 = [v50 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v32)
  {
    v33 = v32;
    obja = *v55;
    do
    {
      for (j = 0; j != v33; j = j + 1)
      {
        if (*v55 != obja)
        {
          objc_enumerationMutation(v50);
        }

        v35 = *(*(&v54 + 1) + 8 * j);
        v36 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier3 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v38 = [knownSetConfigurationsByIdentifier3 safeObjectForKey:v35 ofClass:objc_opt_class()];

        if (v38)
        {
          v39 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v38];
          persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v41 = [persistedKnownSetConfigurations persistedEntry:v39 fromLocation:v53];

          if (v41)
          {
            persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
            [persistedKnownSetConfigurations2 removePersistedEntry:v39 fromLocation:v47];

            [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationRemoved:v53 removedPersistedEntryID:v39 removedSetConfiguration:v38 message:@"eliminated by client"];
          }

          else
          {
            v43 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
            {
              summary2 = [v38 summary];
              *buf = 138543618;
              v64 = v53;
              v65 = 2114;
              v66 = summary2;
              _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} unable to load persisted-set-configuration file | nextRemoveSetConfiguration:%{public}@", buf, 0x16u);
            }
          }
        }

        objc_autoreleasePoolPop(v36);
        if (v35)
        {
          knownSetConfigurationsByIdentifier4 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
          [knownSetConfigurationsByIdentifier4 removeObjectForKey:v35];
        }
      }

      v33 = [v50 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v33);
  }
}

- (id)setConfigurationCopy:(id)copy
{
  copyCopy = copy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v28 = copyCopy;
  copyCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationEliminate", copyCopy];
  v8 = objc_alloc_init(NSMutableArray);
  v30 = copyCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:copyCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v11 = [allKeys copy];

  v12 = v11;
  v13 = [v11 countByEnumeratingWithState:&v31 objects:v39 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v32;
    v29 = *v32;
    do
    {
      for (i = 0; i != v14; i = i + 1)
      {
        if (*v32 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v31 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v20)
        {
          v21 = [v20 copy];
          if (v21)
          {
            [v8 addObject:v21];
          }

          else
          {
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
            {
              [v20 summary];
              selfCopy = self;
              v24 = v12;
              v26 = v25 = v8;
              *buf = 138543618;
              v36 = v30;
              v37 = 2114;
              v38 = v26;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "\n[SET-CONFIGURATION]{%{public}@} unable to copy set-configuration | nextSetConfiguration:%{public}@", buf, 0x16u);

              v8 = v25;
              v12 = v24;
              self = selfCopy;
              v15 = v29;
            }
          }
        }

        else
        {
          v21 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v36 = v30;
            v37 = 2114;
            v38 = v17;
            _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[SET-CONFIGURATION]{%{public}@} unable to load set-configuration | setConfigurationKey:%{public}@", buf, 0x16u);
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      v14 = [v12 countByEnumeratingWithState:&v31 objects:v39 count:16];
    }

    while (v14);
  }

  return v8;
}

- (void)setConfigurationsPrePersonalizedJustCommitted:(id)committed
{
  committedCopy = committed;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = objc_alloc_init(NSMutableDictionary);
  v37 = committedCopy;
  committedCopy = [[NSString alloc] initWithFormat:@"%@:setConfigurationsPrePersonalizedJustCommitted", committedCopy];
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  v47 = 0u;
  prePersonalizedSelectors = [(MADAutoAssetControlManager *)self prePersonalizedSelectors];
  v9 = [prePersonalizedSelectors countByEnumeratingWithState:&v44 objects:v53 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v45;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v45 != v11)
        {
          objc_enumerationMutation(prePersonalizedSelectors);
        }

        v13 = *(*(&v44 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        v15 = [(MADAutoAssetControlManager *)self locateSetDescriptorForSelector:v13];
        v16 = v15;
        if (v15)
        {
          latestDownloadedAtomicInstance = [v15 latestDownloadedAtomicInstance];
          v18 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

          if (v18)
          {
            atomicInstanceUUID = [v18 atomicInstanceUUID];
            [v7 setSafeObject:v18 forKey:atomicInstanceUUID];
          }
        }

        objc_autoreleasePoolPop(v14);
      }

      v10 = [prePersonalizedSelectors countByEnumeratingWithState:&v44 objects:v53 count:16];
    }

    while (v10);
  }

  v42 = 0u;
  v43 = 0u;
  v40 = 0u;
  v41 = 0u;
  v20 = v7;
  v21 = [v20 countByEnumeratingWithState:&v40 objects:v52 count:16];
  v22 = committedCopy;
  if (v21)
  {
    v23 = v21;
    v39 = *v41;
    do
    {
      for (j = 0; j != v23; j = j + 1)
      {
        if (*v41 != v39)
        {
          objc_enumerationMutation(v20);
        }

        v25 = *(*(&v40 + 1) + 8 * j);
        v26 = objc_autoreleasePoolPush();
        v27 = [v20 safeObjectForKey:v25 ofClass:objc_opt_class()];
        v28 = v27;
        if (v27)
        {
          clientDomainName = [v27 clientDomainName];
          assetSetIdentifier = [v28 assetSetIdentifier];
          v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

          atomicInstanceUUID2 = [v28 atomicInstanceUUID];
          v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v22 forAtomicInstanceUUID:atomicInstanceUUID2 requireExists:0];

          if (v31)
          {
            v34 = v33 == 0;
          }

          else
          {
            v34 = 1;
          }

          if (!v34)
          {
            [(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:v22 fromSetDescriptor:v33 toSetConfiguration:v31 fromPreSUStaging:[(MADAutoAssetControlManager *)self isAtomicInstancePartOfPSUS:v28] allowEmpty:0];
            v35 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
            {
              summary = [v33 summary];
              *buf = 138543618;
              v49 = committedCopy;
              v50 = 2114;
              v51 = summary;
              _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SECURE-COMMITTED-LATEST-TO-VEND] just committed all pre-personalized secure | setDescriptor:%{public}@", buf, 0x16u);

              v22 = committedCopy;
            }
          }
        }

        objc_autoreleasePoolPop(v26);
      }

      v23 = [v20 countByEnumeratingWithState:&v40 objects:v52 count:16];
    }

    while (v23);
  }
}

- (BOOL)isAtomicInstancePartOfPSUS:(id)s
{
  sCopy = s;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (sCopy && ([sCopy creationReason], v7 = objc_claimAutoreleasedReturnValue(), v7, v7))
  {
    creationReason = [sCopy creationReason];
    if (([SUCore stringIsEqual:creationReason to:@"STAGED_LOOKUP_NEWOS_PROMOTE"]& 1) != 0)
    {
      v9 = 1;
    }

    else
    {
      creationReason2 = [sCopy creationReason];
      if (([SUCore stringIsEqual:creationReason2 to:@"FROM_STAGED_PROMOTED_LOOKUP"]& 1) != 0)
      {
        v9 = 1;
      }

      else
      {
        creationReason3 = [sCopy creationReason];
        v9 = [SUCore stringIsEqual:creationReason3 to:@"PSUS_NEEDS_PERSONALIZATION"];
      }
    }
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (BOOL)doesSetConfiguration:(id)configuration coverAssetDescriptor:(id)descriptor
{
  configurationCopy = configuration;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  obj = [configurationCopy autoAssetEntries];
  v10 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = configurationCopy;
    v12 = *v33;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v14 = 0;
      v29 = v11;
      do
      {
        if (*v33 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v32 + 1) + 8 * v14);
        v16 = p_weak_ivar_lyt[223];
        assetSelector = [v15 assetSelector];
        assetType = [assetSelector assetType];
        assetType2 = [descriptorCopy assetType];
        if ([v16 stringIsEqual:assetType to:assetType2])
        {
          v31 = p_weak_ivar_lyt[223];
          assetSelector2 = [v15 assetSelector];
          assetSpecifier = [assetSelector2 assetSpecifier];
          [descriptorCopy assetSpecifier];
          v22 = p_weak_ivar_lyt;
          v23 = descriptorCopy;
          v25 = v24 = v12;
          LOBYTE(v31) = [v31 stringIsEqual:assetSpecifier to:v25];

          v12 = v24;
          descriptorCopy = v23;
          p_weak_ivar_lyt = v22;

          v11 = v29;
          if (v31)
          {
            v26 = 1;
            goto LABEL_13;
          }
        }

        else
        {
        }

        v14 = v14 + 1;
      }

      while (v11 != v14);
      v11 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
    }

    while (v11);
    v26 = 0;
LABEL_13:
    configurationCopy = v28;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (BOOL)_isSetDescriptorAvailableToClient:(id)client forSetDescriptor:(id)descriptor
{
  clientCopy = client;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v11 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v23 objects:v31 count:16];
  if (v11)
  {
    v12 = v11;
    v22 = descriptorCopy;
    v13 = *v24;
    while (2)
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v24 != v13)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        v15 = *(*(&v23 + 1) + 8 * i);
        fullAssetSelector = [v15 fullAssetSelector];
        v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

        if (!v17)
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            summary = [v15 summary];
            *buf = 138543618;
            v28 = clientCopy;
            v29 = 2114;
            v30 = summary;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_isSetDescriptorAvailableToClient} unable to locate asset-descriptor | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

LABEL_15:
          v18 = 0;
          goto LABEL_16;
        }

        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:clientCopy forDescriptor:v17]&& [MADAutoAssetSecure isPersonalizationOrGraftingRequired:clientCopy forDescriptor:v17])
        {
          goto LABEL_15;
        }
      }

      v12 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v23 objects:v31 count:16];
      if (v12)
      {
        continue;
      }

      break;
    }

    v18 = 1;
LABEL_16:
    descriptorCopy = v22;
  }

  else
  {
    v18 = 1;
  }

  return v18;
}

- (BOOL)_doesSetDescriptorRequirePersonalization:(id)personalization forSetDescriptor:(id)descriptor
{
  personalizationCopy = personalization;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v11 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v23 objects:v31 count:16];
  if (v11)
  {
    v12 = v11;
    v22 = descriptorCopy;
    v13 = *v24;
    while (2)
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v24 != v13)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        v15 = *(*(&v23 + 1) + 8 * i);
        fullAssetSelector = [v15 fullAssetSelector];
        v17 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

        if (!v17)
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            summary = [v15 summary];
            *buf = 138543618;
            v28 = personalizationCopy;
            v29 = 2114;
            v30 = summary;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_doesSetDescriptorRequirePersonalization} unable to locate asset-descriptor | nextAtomicEntry:%{public}@", buf, 0x16u);
          }

LABEL_15:
          v18 = 1;
          goto LABEL_16;
        }

        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:personalizationCopy forDescriptor:v17]&& [MADAutoAssetSecure isPersonalizationRequired:personalizationCopy forDescriptor:v17])
        {
          goto LABEL_15;
        }
      }

      v12 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v23 objects:v31 count:16];
      if (v12)
      {
        continue;
      }

      break;
    }

    v18 = 0;
LABEL_16:
    descriptorCopy = v22;
  }

  else
  {
    v18 = 0;
  }

  return v18;
}

- (BOOL)_doesSetDescriptorDownloadedMatchLatestToVend:(id)vend forSetDescriptor:(id)descriptor
{
  vendCopy = vend;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v12 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  if (v12 && ([v12 latestAtomicInstanceToVend], v13 = objc_claimAutoreleasedReturnValue(), v13, v13))
  {
    latestAtomicInstanceToVend = [v12 latestAtomicInstanceToVend];
    v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:vendCopy forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:1];

    if (v15)
    {
      v16 = [(MADAutoAssetControlManager *)self doesSetJobDescriptor:v15 representSameContentAs:descriptorCopy];
    }

    else
    {
      v16 = 0;
    }
  }

  else
  {
    v16 = 0;
  }

  return v16;
}

- (BOOL)_isDownloadedDescriptorPartOfLatestToVend:(id)vend fromLocation:(id)location
{
  vendCopy = vend;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v49 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:_isDownloadedDescriptorPartOfLatestToVend", locationCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
  v64 = 0u;
  v65 = 0u;
  v62 = 0u;
  v63 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v12 = [allKeys copy];

  v13 = [v12 countByEnumeratingWithState:&v62 objects:v67 count:16];
  if (v13)
  {
    v14 = v13;
    v15 = *v63;
    v43 = *v63;
    selfCopy = self;
    v47 = v12;
    v48 = locationCopy;
    while (1)
    {
      v16 = 0;
      v45 = v14;
      do
      {
        if (*v63 != v15)
        {
          objc_enumerationMutation(v12);
        }

        v17 = *(*(&v62 + 1) + 8 * v16);
        v18 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v17 ofClass:objc_opt_class()];

        v21 = v20;
        if (!v20)
        {
          goto LABEL_24;
        }

        v52 = v20;
        latestAtomicInstanceToVend = [v20 latestAtomicInstanceToVend];

        v21 = v52;
        if (!latestAtomicInstanceToVend)
        {
          goto LABEL_24;
        }

        latestAtomicInstanceToVend2 = [v52 latestAtomicInstanceToVend];
        v24 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

        if (!v24)
        {
          goto LABEL_23;
        }

        v50 = v24;
        context = v18;
        v46 = v16;
        v60 = 0u;
        v61 = 0u;
        v58 = 0u;
        v59 = 0u;
        obj = [v24 latestDowloadedAtomicInstanceEntries];
        v25 = vendCopy;
        p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
        v57 = [obj countByEnumeratingWithState:&v58 objects:v66 count:16];
        if (!v57)
        {
          goto LABEL_22;
        }

        v27 = *v59;
        v54 = *v59;
        do
        {
          for (i = 0; i != v57; i = i + 1)
          {
            if (*v59 != v27)
            {
              objc_enumerationMutation(obj);
            }

            v29 = *(*(&v58 + 1) + 8 * i);
            v30 = p_weak_ivar_lyt[223];
            fullAssetSelector = [v29 fullAssetSelector];
            assetType = [fullAssetSelector assetType];
            assetType2 = [v25 assetType];
            if (![v30 stringIsEqual:assetType to:assetType2])
            {
              goto LABEL_19;
            }

            v34 = p_weak_ivar_lyt[223];
            fullAssetSelector2 = [v29 fullAssetSelector];
            assetSpecifier = [fullAssetSelector2 assetSpecifier];
            assetSpecifier2 = [v25 assetSpecifier];
            if (![v34 stringIsEqual:assetSpecifier to:assetSpecifier2])
            {

              v27 = v54;
LABEL_19:

              continue;
            }

            v37 = p_weak_ivar_lyt[223];
            fullAssetSelector3 = [v29 fullAssetSelector];
            assetVersion = [fullAssetSelector3 assetVersion];
            assetVersion2 = [v25 assetVersion];
            LOBYTE(v37) = [v37 stringIsEqual:assetVersion to:assetVersion2];

            v25 = vendCopy;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

            v27 = v54;
            if (v37)
            {

              objc_autoreleasePoolPop(context);
              v41 = 1;
              v12 = v47;
              locationCopy = v48;
              goto LABEL_28;
            }
          }

          v57 = [obj countByEnumeratingWithState:&v58 objects:v66 count:16];
        }

        while (v57);
LABEL_22:

        v15 = v43;
        self = selfCopy;
        v12 = v47;
        locationCopy = v48;
        v14 = v45;
        v16 = v46;
        v24 = v50;
        v18 = context;
LABEL_23:

        v21 = v52;
LABEL_24:

        objc_autoreleasePoolPop(v18);
        v16 = v16 + 1;
      }

      while (v16 != v14);
      v14 = [v12 countByEnumeratingWithState:&v62 objects:v67 count:16];
      v41 = 0;
      if (!v14)
      {
        goto LABEL_28;
      }
    }
  }

  v41 = 0;
LABEL_28:

  return v41;
}

- (BOOL)_isDownloadedSetDescriptorLatestToVend:(id)vend fromLocation:(id)location
{
  vendCopy = vend;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_isDownloadedSetDescriptorLatestToVend", locationCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
  v31 = 0u;
  v32 = 0u;
  v29 = 0u;
  v30 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v12 = [allKeys copy];

  obj = v12;
  v13 = [v12 countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v13)
  {
    v14 = v13;
    v26 = locationCopy;
    v15 = *v30;
    while (2)
    {
      for (i = 0; i != v14; i = i + 1)
      {
        if (*v30 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v29 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v20 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v20)
        {
          latestAtomicInstanceToVend = [v20 latestAtomicInstanceToVend];
          latestDownloadedAtomicInstance = [vendCopy latestDownloadedAtomicInstance];
          v23 = [SUCore stringIsEqual:latestAtomicInstanceToVend to:latestDownloadedAtomicInstance];

          if (v23)
          {

            objc_autoreleasePoolPop(v18);
            v24 = 1;
            goto LABEL_12;
          }
        }

        objc_autoreleasePoolPop(v18);
      }

      v14 = [obj countByEnumeratingWithState:&v29 objects:v33 count:16];
      if (v14)
      {
        continue;
      }

      break;
    }

    v24 = 0;
LABEL_12:
    locationCopy = v26;
  }

  else
  {
    v24 = 0;
  }

  return v24;
}

- (void)_clearAtomicInstanceFromAllSetConfigurations:(id)configurations fromLocation:(id)location
{
  configurationsCopy = configurations;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v27 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:_clearAtomicInstanceFromAllSetConfigurations", locationCopy];
  v31 = configurationsCopy;
  atomicInstanceUUID = [configurationsCopy atomicInstanceUUID];
  v28 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

  v30 = locationCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"knownSetConfigurationsByIdentifier"];
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v14 = [allKeys copy];

  obj = v14;
  v15 = [v14 countByEnumeratingWithState:&v32 objects:v36 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v33;
    while (2)
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v33 != v17)
        {
          objc_enumerationMutation(obj);
        }

        v19 = *(*(&v32 + 1) + 8 * i);
        v20 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v22 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v19 ofClass:objc_opt_class()];

        if (v22)
        {
          latestAtomicInstanceToVend = [v22 latestAtomicInstanceToVend];
          v24 = [(MADAutoAssetControlManager *)self locateSetDescriptor:v30 forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:0];

          latestAtomicInstanceToVend2 = [v22 latestAtomicInstanceToVend];
          atomicInstanceUUID2 = [v31 atomicInstanceUUID];
          LODWORD(latestAtomicInstanceToVend) = [SUCore stringIsEqual:latestAtomicInstanceToVend2 to:atomicInstanceUUID2];

          if (latestAtomicInstanceToVend)
          {
            [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromSetConfiguration:v22 forSetDesriptor:v24 forSetAtomicInstance:v31 fromLocation:v30];
            if (v28)
            {
              [(MADAutoAssetControlManager *)self _removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:v27 setDescriptor:v28 allowRemovalWithoutNewerDescriptor:0];
            }

            objc_autoreleasePoolPop(v20);
            goto LABEL_15;
          }
        }

        objc_autoreleasePoolPop(v20);
      }

      v16 = [obj countByEnumeratingWithState:&v32 objects:v36 count:16];
      if (v16)
      {
        continue;
      }

      break;
    }
  }

LABEL_15:
}

- (void)_clearAtomicInstanceFromSetConfiguration:(id)configuration forSetDesriptor:(id)desriptor forSetAtomicInstance:(id)instance fromLocation:(id)location
{
  configurationCopy = configuration;
  desriptorCopy = desriptor;
  instanceCopy = instance;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  selfCopy = self;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:_clearAtomicInstanceFromSetConfiguration", locationCopy];
  if (configurationCopy && ([configurationCopy latestAtomicInstanceToVend], v17 = objc_claimAutoreleasedReturnValue(), v17, v17) && (objc_msgSend(configurationCopy, "latestAtomicInstanceToVend"), v18 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetAtomicInstanceByInstanceUUID:](self, "locateSetAtomicInstanceByInstanceUUID:", v18), v19 = objc_claimAutoreleasedReturnValue(), v18, v19))
  {
    if ([(MADAutoAssetControlManager *)selfCopy atomicInstanceIsCurrentlyLocked:v19])
    {
      v20 = @"Y";
    }

    else
    {
      v20 = @"N";
    }

    [(MADAutoAssetControlManager *)selfCopy setConfigurationTrackLatestToVend:locationCopy forSetConfiguration:configurationCopy becomingLatestToVend:0 historyOperation:442 fromPreSUStaging:0];
  }

  else
  {
    previouslyVendedLockedAtomicInstances = [configurationCopy previouslyVendedLockedAtomicInstances];

    if (previouslyVendedLockedAtomicInstances)
    {
      v41 = locationCopy;
      v42 = locationCopy;
      v22 = selfCopy;
      v43 = desriptorCopy;
      v47 = 0u;
      v48 = 0u;
      v45 = 0u;
      v46 = 0u;
      previouslyVendedLockedAtomicInstances2 = [configurationCopy previouslyVendedLockedAtomicInstances];
      v24 = [previouslyVendedLockedAtomicInstances2 copy];

      v25 = [v24 countByEnumeratingWithState:&v45 objects:v57 count:16];
      if (v25)
      {
        v26 = v25;
        v27 = *v46;
        while (2)
        {
          for (i = 0; i != v26; i = i + 1)
          {
            if (*v46 != v27)
            {
              objc_enumerationMutation(v24);
            }

            v29 = *(*(&v45 + 1) + 8 * i);
            v30 = objc_autoreleasePoolPush();
            atomicInstanceUUID = [instanceCopy atomicInstanceUUID];
            v32 = [SUCore stringIsEqual:v29 to:atomicInstanceUUID];

            if (v32)
            {
              v33 = [(MADAutoAssetControlManager *)v22 locateSetAtomicInstanceByInstanceUUID:v29];
              if (v33)
              {
                v19 = v33;
                objc_autoreleasePoolPop(v30);

                atomicInstanceUUID2 = [v19 atomicInstanceUUID];
                selfCopy = v22;
                v37 = v22;
                locationCopy = v41;
                [(MADAutoAssetControlManager *)v37 setConfigurationForgetIfTrackedAsPreviouslyVended:v41 forSetConfiguration:configurationCopy removingAtomicInstance:atomicInstanceUUID2];

                v20 = @"N";
                locationCopy = v42;
                desriptorCopy = v43;
                goto LABEL_24;
              }
            }

            objc_autoreleasePoolPop(v30);
          }

          v26 = [v24 countByEnumeratingWithState:&v45 objects:v57 count:16];
          if (v26)
          {
            continue;
          }

          break;
        }
      }

      desriptorCopy = v43;
      selfCopy = v22;
      locationCopy = v41;
      locationCopy = v42;
    }

    newerAtomicInstanceOncePersonalized = [configurationCopy newerAtomicInstanceOncePersonalized];

    if (!newerAtomicInstanceOncePersonalized || ([configurationCopy newerAtomicInstanceOncePersonalized], v35 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetAtomicInstanceByInstanceUUID:](selfCopy, "locateSetAtomicInstanceByInstanceUUID:", v35), v19 = objc_claimAutoreleasedReturnValue(), v35, !v19))
    {
      v20 = @"N";
      goto LABEL_25;
    }

    [configurationCopy setNewerAtomicInstanceOncePersonalized:0];
    v20 = @"N";
  }

LABEL_24:

LABEL_25:
  [(MADAutoAssetControlManager *)selfCopy atomicInstanceUpdateUsageStatus:locationCopy toNewStatus:@"FORGOTTEN" forAtomicInstance:instanceCopy];
  v38 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    summary = [configurationCopy summary];
    *buf = 138544130;
    v50 = _updateLatestSummary;
    v51 = 2114;
    v52 = locationCopy;
    v53 = 2114;
    v54 = v20;
    v55 = 2114;
    v56 = summary;
    _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@}\n[CLEARER-LATEST-TO-VEND] clearing set-configuration latestAtomicInstanceToVend | hadBeenLatestIsLocked:%{public}@ | setConfiguration:%{public}@", buf, 0x2Au);
  }
}

- (BOOL)setTargetPersistedMatchesClientSpecified:(id)specified
{
  specifiedCopy = specified;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v8 = [persistedSetTargets persistedEntryIDs:@"setTargetPersistedMatchesClientSpecified"];

  if (![v8 count])
  {
    LOBYTE(v9) = 0;
    goto LABEL_49;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setTargetPersistedMatchesClientSpecified" ofContainer:@"persistedSetTargets"];
  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  obj = v8;
  v48 = [obj countByEnumeratingWithState:&v65 objects:v72 count:16];
  if (!v48)
  {
    LOBYTE(v9) = 1;
    goto LABEL_48;
  }

  v49 = v8;
  v50 = *v66;
  LODWORD(v9) = 1;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  selfCopy = self;
  v55 = specifiedCopy;
  while (2)
  {
    v47 = v9;
    v11 = 0;
    do
    {
      if (*v66 != v50)
      {
        objc_enumerationMutation(obj);
      }

      v51 = v11;
      v12 = *(*(&v65 + 1) + 8 * v11);
      v13 = objc_autoreleasePoolPush();
      persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
      v15 = [persistedSetTargets2 persistedEntry:v12 fromLocation:@"setTargetPersistedMatchesClientSpecified"];

      if (v12)
      {
        v16 = v15 == 0;
      }

      else
      {
        v16 = 1;
      }

      if (v16)
      {
        v18 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
        {
          v45 = @"N";
          if (v12)
          {
            v45 = v12;
          }

          *buf = 138543362;
          v71 = v45;
          _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | unable to load persisted set-target | entryID:%{public}@", buf, 0xCu);
        }

        LOBYTE(v9) = 0;
LABEL_46:

        objc_autoreleasePoolPop(v13);
        goto LABEL_48;
      }

      persistedSetTargets3 = [(MADAutoAssetControlManager *)self persistedSetTargets];
      v18 = [persistedSetTargets3 decodeFromLocation:@"setTargetPersistedMatchesClientSpecified" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

      if (!v18)
      {
        v46 = _MADLog(@"AutoControl");
        v58 = v46;
        if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543362;
          v71 = v12;
          _os_log_impl(&dword_0, v46, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | unable to decode persisted set-target | entryID:%{public}@", buf, 0xCu);
        }

        LOBYTE(v9) = 0;
LABEL_45:

        goto LABEL_46;
      }

      v53 = v15;
      v54 = v13;
      v63 = 0u;
      v64 = 0u;
      v61 = 0u;
      v62 = 0u;
      entriesWhenTargeting = [specifiedCopy entriesWhenTargeting];
      v60 = [entriesWhenTargeting countByEnumeratingWithState:&v61 objects:v69 count:16];
      if (v60)
      {
        v56 = 0;
        v58 = entriesWhenTargeting;
        v59 = *v62;
        while (2)
        {
          for (i = 0; i != v60; i = i + 1)
          {
            if (*v62 != v59)
            {
              objc_enumerationMutation(v58);
            }

            v21 = *(*(&v61 + 1) + 8 * i);
            if (!v21)
            {
              v9 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
              {
                summary = [specifiedCopy summary];
                *buf = 138543362;
                v71 = summary;
                _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, "{setTargetPersistedMatchesClientSpecified} | nil entry provided by client - treating as same set-target to preserve persisted | setInfoInstance:%{public}@", buf, 0xCu);
              }

              v8 = v49;
              v15 = v53;
              v13 = v54;
              LOBYTE(v9) = v47;
              goto LABEL_45;
            }

            v22 = p_weak_ivar_lyt[223];
            clientDomainName = [v18 clientDomainName];
            clientDomainName2 = [specifiedCopy clientDomainName];
            if ([v22 stringIsEqual:clientDomainName to:clientDomainName2])
            {
              v25 = p_weak_ivar_lyt[223];
              assetSetIdentifier = [v18 assetSetIdentifier];
              assetSetIdentifier2 = [specifiedCopy assetSetIdentifier];
              LODWORD(v25) = [v25 stringIsEqual:assetSetIdentifier to:assetSetIdentifier2];

              if (v25)
              {
                v28 = p_weak_ivar_lyt[223];
                minTargetOSVersion = [v18 minTargetOSVersion];
                minTargetOSVersion2 = [v21 minTargetOSVersion];
                if (([v28 stringIsEqual:minTargetOSVersion to:minTargetOSVersion2] & 1) == 0)
                {

                  v47 = 0;
                  v8 = v49;
                  v42 = v53;
                  v41 = v54;
                  self = selfCopy;
LABEL_35:
                  v40 = 1;
                  goto LABEL_37;
                }

                v31 = p_weak_ivar_lyt[223];
                maxTargetOSVersion = [v18 maxTargetOSVersion];
                maxTargetOSVersion2 = [v21 maxTargetOSVersion];
                if (![v31 stringIsEqual:maxTargetOSVersion to:maxTargetOSVersion2])
                {
                  v34 = v18;

                  v47 = 0;
                  v38 = 1;
LABEL_32:
                  v39 = v58;
                  goto LABEL_33;
                }

                v34 = v18;
                autoAssetEntries = [v18 autoAssetEntries];
                autoAssetEntries2 = [v21 autoAssetEntries];
                v37 = [(MADAutoAssetControlManager *)selfCopy setTargetEntries:autoAssetEntries match:autoAssetEntries2];

                v38 = 1;
                if (!v37)
                {
                  v47 = 0;
                  goto LABEL_32;
                }

                v56 = 1;
                specifiedCopy = v55;
                p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              }
            }

            else
            {
            }
          }

          v39 = v58;
          v60 = [v58 countByEnumeratingWithState:&v61 objects:v69 count:16];
          if (v60)
          {
            continue;
          }

          break;
        }

        v34 = v18;
        v38 = v56;
LABEL_33:

        v8 = v49;
        v42 = v53;
        v41 = v54;
        self = selfCopy;
        if (v38)
        {
          specifiedCopy = v55;
          v18 = v34;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          goto LABEL_35;
        }

        v40 = 0;
        specifiedCopy = v55;
        v18 = v34;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
      }

      else
      {

        v40 = 0;
        v8 = v49;
        v42 = v15;
        v41 = v54;
        self = selfCopy;
      }

LABEL_37:

      objc_autoreleasePoolPop(v41);
      if (!v40)
      {
        LOBYTE(v9) = 0;
        goto LABEL_48;
      }

      v11 = v51 + 1;
    }

    while ((v51 + 1) != v48);
    LODWORD(v9) = v47;
    v48 = [obj countByEnumeratingWithState:&v65 objects:v72 count:16];
    if (v48)
    {
      continue;
    }

    break;
  }

LABEL_48:

LABEL_49:
  return v9 & 1;
}

- (BOOL)setTargetEntries:(id)entries match:(id)match
{
  entriesCopy = entries;
  matchCopy = match;
  v7 = [entriesCopy count];
  v30 = matchCopy;
  if (v7 != [matchCopy count])
  {
    v24 = 0;
    goto LABEL_26;
  }

  v42 = 0u;
  v43 = 0u;
  v40 = 0u;
  v41 = 0u;
  obj = entriesCopy;
  v28 = [obj countByEnumeratingWithState:&v40 objects:v45 count:16];
  if (!v28)
  {
    v24 = 1;
    goto LABEL_25;
  }

  v29 = *v41;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v26 = entriesCopy;
  while (2)
  {
    v9 = 0;
    while (2)
    {
      if (*v41 != v29)
      {
        objc_enumerationMutation(obj);
      }

      v31 = v9;
      v10 = *(*(&v40 + 1) + 8 * v9);
      v36 = 0u;
      v37 = 0u;
      v38 = 0u;
      v39 = 0u;
      v33 = v30;
      v35 = [v33 countByEnumeratingWithState:&v36 objects:v44 count:16];
      if (!v35)
      {
LABEL_23:

        v24 = 0;
        entriesCopy = v26;
        goto LABEL_25;
      }

      v11 = *v37;
      v32 = v10;
LABEL_9:
      v12 = 0;
      while (1)
      {
        if (*v37 != v11)
        {
          objc_enumerationMutation(v33);
        }

        v13 = *(*(&v36 + 1) + 8 * v12);
        v14 = p_weak_ivar_lyt[223];
        assetSelector = [v10 assetSelector];
        assetType = [assetSelector assetType];
        assetSelector2 = [v13 assetSelector];
        assetType2 = [assetSelector2 assetType];
        if (![v14 stringIsEqual:assetType to:assetType2])
        {

          goto LABEL_16;
        }

        v34 = p_weak_ivar_lyt[223];
        assetSelector3 = [v10 assetSelector];
        assetSpecifier = [assetSelector3 assetSpecifier];
        assetSelector4 = [v13 assetSelector];
        [assetSelector4 assetSpecifier];
        v23 = v22 = v11;
        LOBYTE(v34) = [v34 stringIsEqual:assetSpecifier to:v23];

        v11 = v22;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);

        v10 = v32;
        if (v34)
        {
          break;
        }

LABEL_16:
        if (v35 == ++v12)
        {
          v35 = [v33 countByEnumeratingWithState:&v36 objects:v44 count:16];
          if (v35)
          {
            goto LABEL_9;
          }

          goto LABEL_23;
        }
      }

      v9 = v31 + 1;
      if ((v31 + 1) != v28)
      {
        continue;
      }

      break;
    }

    v24 = 1;
    entriesCopy = v26;
    v28 = [obj countByEnumeratingWithState:&v40 objects:v45 count:16];
    if (v28)
    {
      continue;
    }

    break;
  }

LABEL_25:

LABEL_26:
  return v24;
}

- (void)atomicInstanceLoadedFromPersisted:(id)persisted persistedEntryID:(id)d
{
  persistedCopy = persisted;
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  atomicInstanceUUID = [persistedCopy atomicInstanceUUID];
  v11 = [knownSetAtomicInstancesByInstance safeObjectForKey:atomicInstanceUUID ofClass:objc_opt_class()];

  if (v11)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v14 = [NSString alloc];
    summary = [persistedCopy summary];
    v16 = [v14 initWithFormat:@"{atomicInstanceLoadedFromPersisted} already tracking setAtomicInstance:%@", summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v16 withResult:6109 withError:0];
  }

  else
  {
    knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    atomicInstanceUUID2 = [persistedCopy atomicInstanceUUID];
    [knownSetAtomicInstancesByInstance2 setSafeObject:persistedCopy forKey:atomicInstanceUUID2];

    [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstance:@"atomicInstanceLoadedFromPersisted" operation:@"ENTRY_LOAD" forPersistedEntryID:dCopy withSetAtomicInstance:persistedCopy message:@"set-atomic-instance validated"];
  }
}

- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation forSetInfoInstance:(id)infoInstance asSubAtomicFrom:(id)from
{
  fromCopy = from;
  infoInstanceCopy = infoInstance;
  reasonCopy = reason;
  instanceCopy = instance;
  clientDomainName = [infoInstanceCopy clientDomainName];
  autoAssetSetClientName = [infoInstanceCopy autoAssetSetClientName];
  assetSetIdentifier = [infoInstanceCopy assetSetIdentifier];
  autoAssetEntries = [infoInstanceCopy autoAssetEntries];

  v20 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:instanceCopy forCreationReason:reasonCopy recordingHistoryOperation:operation forClientDomainName:clientDomainName forSetClientName:autoAssetSetClientName forAssetSetIdentifier:assetSetIdentifier representingInstanceEntries:autoAssetEntries recoveringAtomicInstanceUUID:0 asSubAtomicFrom:fromCopy];

  return v20;
}

- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation recoveringForSetDescriptor:(id)descriptor usingAsSetClient:(id)client
{
  instanceCopy = instance;
  reasonCopy = reason;
  descriptorCopy = descriptor;
  clientCopy = client;
  v35 = objc_alloc_init(NSMutableArray);
  v37 = 0u;
  v38 = 0u;
  v39 = 0u;
  v40 = 0u;
  v31 = descriptorCopy;
  obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v11 = [obj countByEnumeratingWithState:&v37 objects:v41 count:16];
  if (v11)
  {
    v12 = v11;
    v36 = *v38;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v38 != v36)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v37 + 1) + 8 * i);
        v15 = [MANAutoAssetSetEntry alloc];
        fullAssetSelector = [v14 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        fullAssetSelector2 = [v14 fullAssetSelector];
        assetSpecifier = [fullAssetSelector2 assetSpecifier];
        fullAssetSelector3 = [v14 fullAssetSelector];
        downloadDecryptionKey = [fullAssetSelector3 downloadDecryptionKey];
        v22 = -[MANAutoAssetSetEntry initForAssetType:withAssetSpecifier:usingDecryptionKey:assetLockedInhibitsRemoval:](v15, "initForAssetType:withAssetSpecifier:usingDecryptionKey:assetLockedInhibitsRemoval:", assetType, assetSpecifier, downloadDecryptionKey, [v14 inhibitedFromEmergencyRemoval]);

        if (v22)
        {
          [v35 addObject:v22];
        }
      }

      v12 = [obj countByEnumeratingWithState:&v37 objects:v41 count:16];
    }

    while (v12);
  }

  clientDomainName = [v31 clientDomainName];
  assetSetIdentifier = [v31 assetSetIdentifier];
  latestDownloadedAtomicInstance = [v31 latestDownloadedAtomicInstance];
  v26 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:instanceCopy forCreationReason:reasonCopy recordingHistoryOperation:operation forClientDomainName:clientDomainName forSetClientName:clientCopy forAssetSetIdentifier:assetSetIdentifier representingInstanceEntries:v35 recoveringAtomicInstanceUUID:latestDownloadedAtomicInstance asSubAtomicFrom:0];

  return v26;
}

- (id)atomicInstanceNewSetAtomicInstance:(id)instance forCreationReason:(id)reason recordingHistoryOperation:(int64_t)operation forClientDomainName:(id)name forSetClientName:(id)clientName forAssetSetIdentifier:(id)identifier representingInstanceEntries:(id)entries recoveringAtomicInstanceUUID:(id)self0 asSubAtomicFrom:(id)self1
{
  instanceCopy = instance;
  nameCopy = name;
  identifierCopy = identifier;
  dCopy = d;
  fromCopy = from;
  entriesCopy = entries;
  clientNameCopy = clientName;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    uUIDString = dCopy;
  }

  else
  {
    v24 = objc_alloc_init(NSUUID);
    uUIDString = [v24 UUIDString];
  }

  v25 = [MADAutoSetAtomicInstance alloc];
  v26 = objc_alloc_init(NSDate);
  selfCopy = self;
  v27 = instanceCopy;
  v28 = [(MADAutoSetAtomicInstance *)v25 initForClientDomainName:nameCopy forSetClientName:clientNameCopy forAssetSetIdentifier:identifierCopy withAtomicInstanceUUID:uUIDString asSubAtomicFrom:fromCopy forCreationReason:reasonCopy originallyCreatedOnDate:v26 withCreationIndex:[(MADAutoAssetControlManager *)self atomicInstanceNextCreationIndex:instanceCopy forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy] representingInstanceEntries:entriesCopy inUseBySetJob:0];

  if (!v28)
  {
    goto LABEL_21;
  }

  if (operation == 226)
  {
    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      summary = [v28 summary];
      *buf = 138543618;
      v64 = instanceCopy;
      v65 = 2114;
      v66 = summary;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} not persisting sub-atomic-instance of 0 entries | setAtomicInstance:%{public}@", buf, 0x16u);
    }

    goto LABEL_18;
  }

  v29 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v28];
  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v32 = [persistedKnownSetAtomicInstances persistedEntry:v29 fromLocation:instanceCopy];

  if (v32)
  {
    [v32 persistSecureCodedObject:v28 forKey:@"setAtomicInstance"];
    persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
    summary2 = [v28 summary];
    [persistedKnownSetAtomicInstances2 storePersistedEntry:v29 withEntrySummary:summary2 fromLocation:instanceCopy];

    instanceEntries = [v28 instanceEntries];
    v36 = [instanceEntries count];
    v37 = [(MADAutoAssetControlManager *)selfCopy _specifierVersionNamesForAtomicInstance:v28];
    [MADAutoAssetHistory recordOperation:operation toHistoryType:2 fromLayer:1 usageCount:v36 forClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy forAtomicInstance:uUIDString withAddendumMessage:v37];

    v38 = [NSString alloc];
    subAtomicFromAtomicInstanceUUID = [v28 subAtomicFromAtomicInstanceUUID];
    if (subAtomicFromAtomicInstanceUUID)
    {
      v40 = @"sub-";
    }

    else
    {
      v40 = &stru_4BD3F0;
    }

    summary3 = [v28 summary];
    v57 = v40;
    v27 = instanceCopy;
    v42 = [v38 initWithFormat:@"new set %@atomic-instance added | setAtomicInstance:%@", v57, summary3];
    [(MADAutoAssetControlManager *)selfCopy _logPersistedSetAtomicInstance:instanceCopy operation:@"ENTRY_ADD" forPersistedEntryID:v29 withSetAtomicInstance:v28 message:v42];

    if (!+[MAAIRBEventReporter isAvailable])
    {
      goto LABEL_17;
    }

    v43 = [MAAIRBMobileAssetOperationMetadata alloc];
    v44 = [MADAutoAssetHistoryTracker operationName:operation];
    v45 = [(MAAIRBMobileAssetOperationMetadata *)v43 initWithCode:operation name:v44];

    v46 = [MAAIRBMobileAssetAtomicInstance alloc];
    v47 = [[MAAIRBMobileAssetAssetSet alloc] initWithAssetSetIdentifier:identifierCopy];
    v48 = [(MAAIRBMobileAssetAtomicInstance *)v46 initWithAssetSet:v47 atomicInstanceId:uUIDString];

    instanceEntries2 = [v28 instanceEntries];
    v50 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v45, v48, [instanceEntries2 count]);

    v51 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v50];
    [MAAIRBEventReporter emitAppleIntelligenceStartEvent:v51];

    v27 = instanceCopy;
  }

  else
  {
    v45 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
    {
      summary4 = [v28 summary];
      *buf = 138543618;
      v64 = instanceCopy;
      v65 = 2114;
      v66 = summary4;
      _os_log_impl(&dword_0, v45, OS_LOG_TYPE_ERROR, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} unable to load persisted-set-atomic-instance file | setAtomicInstance:%{public}@", buf, 0x16u);
    }
  }

LABEL_17:
  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
  [knownSetAtomicInstancesByInstance setSafeObject:v28 forKey:uUIDString];

  [(MADAutoAssetControlManager *)selfCopy atomicInstanceTrimOverflowAfterPersisting:v28];
LABEL_18:

  v54 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v54, OS_LOG_TYPE_DEFAULT))
  {
    summary5 = [v28 summary];
    *buf = 138543618;
    v64 = v27;
    v65 = 2114;
    v66 = summary5;
    _os_log_impl(&dword_0, v54, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@:atomicInstanceNewSetAtomicInstance} created | setAtomicInstance:%{public}@", buf, 0x16u);
  }

LABEL_21:

  return v28;
}

- (void)atomicInstanceUpdateUsageStatus:(id)status toNewStatus:(id)newStatus forAtomicInstance:(id)instance
{
  statusCopy = status;
  newStatusCopy = newStatus;
  instanceCopy = instance;
  v11 = instanceCopy;
  if (instanceCopy)
  {
    usageStatus = [instanceCopy usageStatus];
    v13 = [SUCore stringIsEqual:usageStatus to:newStatusCopy];

    if ((v13 & 1) == 0)
    {
      v14 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v11];
      persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [persistedKnownSetAtomicInstances persistedEntry:v14 fromLocation:statusCopy];

      if (v16)
      {
        [v11 setUsageStatus:newStatusCopy];
        [v16 persistSecureCodedObject:v11 forKey:@"setAtomicInstance"];
        persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        summary = [v11 summary];
        [persistedKnownSetAtomicInstances2 storePersistedEntry:v14 withEntrySummary:summary fromLocation:statusCopy];

        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        atomicInstanceUUID = [v11 atomicInstanceUUID];
        [knownSetAtomicInstancesByInstance setSafeObject:v11 forKey:atomicInstanceUUID];

        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          summary2 = [v11 summary];
          v26 = 138543618;
          v27 = statusCopy;
          v28 = 2114;
          v29 = summary2;
          v23 = "\n[ATOMIC-INSTANCE] {%{public}@} updated usage-status | setAtomicInstance:%{public}@";
          v24 = v21;
          v25 = OS_LOG_TYPE_DEFAULT;
LABEL_8:
          _os_log_impl(&dword_0, v24, v25, v23, &v26, 0x16u);
        }
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          summary2 = [v11 summary];
          v26 = 138543618;
          v27 = statusCopy;
          v28 = 2114;
          v29 = summary2;
          v23 = "\n[ATOMIC-INSTANCE] {%{public}@} unable to update atomic-instance usage-status - failed to load persisted-set-atomic-instance file | setAtomicInstance:%{public}@";
          v24 = v21;
          v25 = OS_LOG_TYPE_ERROR;
          goto LABEL_8;
        }
      }
    }
  }
}

- (id)atomicInstanceUUIDForNewSetJob:(id)job forReason:(id)reason
{
  jobCopy = job;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  atomicInstance = [jobCopy atomicInstance];

  if (!atomicInstance || (-[MADAutoAssetControlManager knownSetAtomicInstancesByInstance](self, "knownSetAtomicInstancesByInstance"), v11 = objc_claimAutoreleasedReturnValue(), [jobCopy atomicInstance], v12 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v11, "safeObjectForKey:ofClass:", v12, objc_opt_class()), v13 = objc_claimAutoreleasedReturnValue(), v12, v11, !v13))
  {
    reasonCopy = [[NSString alloc] initWithFormat:@"atomicInstanceUUIDForNewSetJob(%@)", reasonCopy];
    v13 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:reasonCopy forCreationReason:@"FROM_CLIENT_IN_FLIGHT" recordingHistoryOperation:225 forSetInfoInstance:jobCopy asSubAtomicFrom:0];

    clientDomainName = [jobCopy clientDomainName];
    assetSetIdentifier = [jobCopy assetSetIdentifier];
    v17 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    if (v17)
    {
      atomicInstanceUUID = [v13 atomicInstanceUUID];
      [v17 setDiscoveredInFlightAtomicInstance:atomicInstanceUUID];

      [(MADAutoAssetControlManager *)self setConfigurationPersist:v17 fromLocation:@"atomicInstanceUUIDForNewSetJob" forReason:@"set discoveredInFlight" dueToAlter:0 forHistoryOperation:9999];
    }
  }

  atomicInstanceUUID2 = [v13 atomicInstanceUUID];

  return atomicInstanceUUID2;
}

- (id)atomicInstanceNewIdentifierForSetAtomicInstance:(id)instance
{
  instanceCopy = instance;
  v4 = [NSString alloc];
  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];

  v7 = [v4 initWithFormat:@"%@_%@", clientDomainName, assetSetIdentifier];

  return v7;
}

- (id)atomicInstanceNewEntryIDForSetAtomicInstance:(id)instance
{
  instanceCopy = instance;
  v4 = [NSString alloc];
  clientDomainName = [instanceCopy clientDomainName];
  assetSetIdentifier = [instanceCopy assetSetIdentifier];
  atomicInstanceUUID = [instanceCopy atomicInstanceUUID];

  v8 = [v4 initWithFormat:@"%@_%@_%@", clientDomainName, assetSetIdentifier, atomicInstanceUUID];

  return v8;
}

- (id)atomicInstanceUUIDArrayForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  v4 = objc_alloc_init(NSMutableArray);
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance)
  {
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    [v4 addObject:latestDownloadedAtomicInstance2];
  }

  if (![v4 count])
  {

    v4 = 0;
  }

  return v4;
}

- (id)atomicInstanceNewSubAtomicFromAtomic:(id)atomic forSubsetInfoInstance:(id)instance error:(id *)error
{
  atomicCopy = atomic;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  atomicInstanceUUID = [atomicCopy atomicInstanceUUID];

  if (!atomicInstanceUUID)
  {
    v36 = [NSString alloc];
    summary = [atomicCopy summary];
    v38 = [v36 initWithFormat:@"auto-asset-set to create sub-atomic-instance from has no atomic-instance | fromSetAtomicInstance:%@", summary];
    v39 = [MAAutoAssetError buildError:6551 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v38];

    v40 = 0;
    if (v39)
    {
      goto LABEL_36;
    }

    goto LABEL_39;
  }

  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  atomicInstanceUUID2 = [atomicCopy atomicInstanceUUID];
  v14 = [knownSetAtomicInstancesByInstance safeObjectForKey:atomicInstanceUUID2 ofClass:objc_opt_class()];

  v55 = v14;
  if (!v14)
  {
    v41 = [NSString alloc];
    summary2 = [atomicCopy summary];
    v43 = [v41 initWithFormat:@"auto-asset-set to create sub-atomic-instance from is not currenty known [presumed retired] | fromSetAtomicInstance:%@", summary2];
    v44 = 6551;
LABEL_31:
    v39 = [MAAutoAssetError buildError:v44 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v43];

    v40 = 0;
    goto LABEL_35;
  }

  autoAssetEntries = [instanceCopy autoAssetEntries];

  if (!autoAssetEntries)
  {
    v45 = [NSString alloc];
    summary2 = [instanceCopy summary];
    v43 = [v45 initWithFormat:@"entries to make up sub-atomic-instance must be specified [use empty array to indicate empty sub-atomic-instance | subsetAtomicInfoInstance:%@", summary2];
    v44 = 6102;
    goto LABEL_31;
  }

  autoAssetEntries2 = [instanceCopy autoAssetEntries];
  v17 = [autoAssetEntries2 count];

  if (!v17)
  {
    atomicInstanceUUID3 = [atomicCopy atomicInstanceUUID];
    v33 = @"SUB_ATOMIC_0_ENTRIES";
    selfCopy3 = self;
    v35 = 226;
    goto LABEL_34;
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  obj = [instanceCopy autoAssetEntries];
  v52 = [obj countByEnumeratingWithState:&v73 objects:v78 count:16];
  if (!v52)
  {
    goto LABEL_26;
  }

  v53 = atomicCopy;
  v54 = *v74;
  v60 = instanceCopy;
  selfCopy2 = self;
  while (2)
  {
    v18 = 0;
    while (2)
    {
      if (*v74 != v54)
      {
        v19 = v18;
        objc_enumerationMutation(obj);
        v18 = v19;
      }

      v56 = v18;
      v68 = *(*(&v73 + 1) + 8 * v18);
      v69 = 0u;
      v70 = 0u;
      v71 = 0u;
      v72 = 0u;
      instanceEntries = [atomicCopy instanceEntries];
      v67 = [instanceEntries countByEnumeratingWithState:&v69 objects:v77 count:16];
      if (!v67)
      {
LABEL_32:

        v46 = [NSString alloc];
        summary3 = [instanceCopy summary];
        v48 = [v46 initWithFormat:@"auto-asset-set to create sub-atomic-instance from does not represent selector(s) to be a sub-atomic-instance | subsetAtomicInfoInstance:%@", summary3];
        v39 = [MAAutoAssetError buildError:6553 fromOperation:@"atomicInstanceNewSubAtomicFromAtomic" underlyingError:0 withDescription:v48];

        v40 = 0;
        atomicCopy = v53;
        goto LABEL_35;
      }

      v66 = *v70;
LABEL_12:
      v20 = 0;
      while (1)
      {
        if (*v70 != v66)
        {
          objc_enumerationMutation(instanceEntries);
        }

        v21 = *(*(&v69 + 1) + 8 * v20);
        assetSelector = [v68 assetSelector];
        assetType = [assetSelector assetType];
        assetSelector2 = [v21 assetSelector];
        assetType2 = [assetSelector2 assetType];
        if (![SUCore stringIsEqual:assetType to:assetType2])
        {
          goto LABEL_20;
        }

        v63 = assetSelector;
        assetSelector3 = [v68 assetSelector];
        assetSpecifier = [assetSelector3 assetSpecifier];
        assetSelector4 = [v21 assetSelector];
        assetSpecifier2 = [assetSelector4 assetSpecifier];
        v64 = assetSpecifier;
        if (![SUCore stringIsEqual:assetSpecifier to:assetSpecifier2])
        {

          instanceCopy = v60;
          assetSelector = v63;
LABEL_20:

          goto LABEL_21;
        }

        assetSelector5 = [v68 assetSelector];
        assetVersion = [assetSelector5 assetVersion];
        assetSelector6 = [v21 assetSelector];
        assetVersion2 = [assetSelector6 assetVersion];
        v59 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

        instanceCopy = v60;
        self = selfCopy2;
        if (v59)
        {
          break;
        }

LABEL_21:
        if (v67 == ++v20)
        {
          v67 = [instanceEntries countByEnumeratingWithState:&v69 objects:v77 count:16];
          if (v67)
          {
            goto LABEL_12;
          }

          goto LABEL_32;
        }
      }

      v18 = v56 + 1;
      atomicCopy = v53;
      if ((v56 + 1) != v52)
      {
        continue;
      }

      break;
    }

    v52 = [obj countByEnumeratingWithState:&v73 objects:v78 count:16];
    if (v52)
    {
      continue;
    }

    break;
  }

LABEL_26:

  atomicInstanceUUID3 = [atomicCopy atomicInstanceUUID];
  v33 = @"SUB_ATOMIC_WITH_ENTRIES";
  selfCopy3 = self;
  v35 = 227;
LABEL_34:
  v40 = [(MADAutoAssetControlManager *)selfCopy3 atomicInstanceNewSetAtomicInstance:@"atomicInstanceNewSubAtomicFromAtomic" forCreationReason:v33 recordingHistoryOperation:v35 forSetInfoInstance:instanceCopy asSubAtomicFrom:atomicInstanceUUID3];

  v39 = 0;
LABEL_35:

  if (v39)
  {
LABEL_36:

    if (error)
    {
      v49 = v39;
      v40 = 0;
      *error = v39;
    }

    else
    {
      v40 = 0;
    }
  }

LABEL_39:

  return v40;
}

- (id)atomicInstanceMatchingInfoInstance:(id)instance withSetInfoInstance:(id)infoInstance
{
  instanceCopy = instance;
  infoInstanceCopy = infoInstance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  atomicInstance = [infoInstanceCopy atomicInstance];

  if (!atomicInstance)
  {
    v19 = 0;
    goto LABEL_11;
  }

  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  atomicInstance2 = [infoInstanceCopy atomicInstance];
  v13 = [knownSetAtomicInstancesByInstance safeObjectForKey:atomicInstance2 ofClass:objc_opt_class()];

  if (!v13)
  {
    goto LABEL_9;
  }

  clientDomainName = [v13 clientDomainName];
  clientDomainName2 = [infoInstanceCopy clientDomainName];
  if (([SUCore stringIsEqual:clientDomainName to:clientDomainName2]& 1) == 0)
  {

    goto LABEL_8;
  }

  assetSetIdentifier = [v13 assetSetIdentifier];
  assetSetIdentifier2 = [infoInstanceCopy assetSetIdentifier];
  v18 = [SUCore stringIsEqual:assetSetIdentifier to:assetSetIdentifier2];

  if (!v18)
  {
LABEL_8:
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v22 = [NSString alloc];
    summary = [infoInstanceCopy summary];
    summary2 = [v13 summary];
    v25 = [v22 initWithFormat:@"{%@:atomicInstanceMatchingInfoInstance} setInfoInstance is tracking a different auto-asset-set | setInfoInstance:%@ | setAtomicInstance:%@", instanceCopy, summary, summary2];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6108 withError:0];

LABEL_9:
    v19 = 0;
    goto LABEL_10;
  }

  v19 = v13;
LABEL_10:

LABEL_11:

  return v19;
}

- (id)atomicInstanceForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance)
  {
    knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
LABEL_5:
    v11 = latestDownloadedAtomicInstance2;
    v12 = [knownSetAtomicInstancesByInstance safeObjectForKey:latestDownloadedAtomicInstance2 ofClass:objc_opt_class()];

    goto LABEL_6;
  }

  discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];

  if (discoveredAtomicInstance)
  {
    knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
    latestDownloadedAtomicInstance2 = [descriptorCopy discoveredAtomicInstance];
    goto LABEL_5;
  }

  v12 = 0;
LABEL_6:

  return v12;
}

- (int64_t)atomicInstanceNextCreationIndex:(id)index forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  indexCopy = index;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  indexCopy = [[NSString alloc] initWithFormat:@"%@:atomicInstanceNextCreationIndex", indexCopy];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:indexCopy ofContainer:@"knownSetAtomicInstancesByInstance"];
  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
  if (v12)
  {
    v13 = v12;
    v29 = indexCopy;
    v30 = indexCopy;
    instanceCreationIndex = 0;
    v14 = *v37;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v37 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v36 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v20 = [knownSetAtomicInstancesByInstance safeObjectForKey:v17 ofClass:objc_opt_class()];

        clientDomainName = [v20 clientDomainName];
        if (([SUCore stringIsEqual:clientDomainName to:nameCopy]& 1) != 0)
        {
          v34 = v18;
          v22 = v14;
          selfCopy = self;
          v24 = p_weak_ivar_lyt;
          assetSetIdentifier = [v20 assetSetIdentifier];
          v26 = [SUCore stringIsEqual:assetSetIdentifier to:identifierCopy];

          if (v26)
          {
            p_weak_ivar_lyt = v24;
            self = selfCopy;
            v14 = v22;
            v18 = v34;
            if ([v20 instanceCreationIndex] > instanceCreationIndex)
            {
              instanceCreationIndex = [v20 instanceCreationIndex];
            }
          }

          else
          {
            p_weak_ivar_lyt = v24;
            self = selfCopy;
            v14 = v22;
            v18 = v34;
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v18);
      }

      v13 = [obj countByEnumeratingWithState:&v36 objects:v40 count:16];
    }

    while (v13);
    indexCopy = v30;
    v27 = instanceCreationIndex + 1;
    indexCopy = v29;
  }

  else
  {
    v27 = 1;
  }

  return v27;
}

- (void)atomicInstanceTrackSetDescriptor:(id)descriptor fromLocation:(id)location forSpecificAtomicInstance:(id)instance
{
  v6 = [(MADAutoAssetControlManager *)self autoControlManagerFSM:descriptor];
  extendedStateQueue = [v6 extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);
}

- (void)atomicInstanceForceUnlock:(id)unlock dueToError:(id)error forgettingAtomicInstance:(id)instance historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d
{
  errorCopy = error;
  instanceCopy = instance;
  unlockCopy = unlock;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  unlockCopy = [[NSString alloc] initWithFormat:@"%@:atomicInstanceForceUnlock", unlockCopy];
  atomicInstanceUUID = [instanceCopy atomicInstanceUUID];

  v19 = [(MADAutoAssetControlManager *)self locateSetDescriptor:unlockCopy forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

  if (v19)
  {
    [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v19];
    if ([(MADAutoAssetControlManager *)self isShortTermLockableSetDescriptor:v19])
    {
      [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:unlockCopy forSetDescriptor:v19 endingAll:0 performingHardEliminate:1 error:0];
    }

    [(MADAutoAssetControlManager *)self secureCheckUngraftAll:unlockCopy forSetDescriptorNoLongerLocked:v19];
    [(MADAutoAssetControlManager *)self setLockUsageMapEndedLockForSetDescriptor:v19 forLockReason:0 endedLockCount:-1];
    clientDomainName = [v19 clientDomainName];
    assetSetIdentifier = [v19 assetSetIdentifier];
    v22 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    if (v22)
    {
      latestAtomicInstanceToVend = [v22 latestAtomicInstanceToVend];

      if (latestAtomicInstanceToVend)
      {
        dCopy = d;
        latestAtomicInstanceToVend2 = [v22 latestAtomicInstanceToVend];
        v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:unlockCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

        latestDownloadedAtomicInstance = [v25 latestDownloadedAtomicInstance];
        latestDownloadedAtomicInstance2 = [v19 latestDownloadedAtomicInstance];
        LODWORD(latestAtomicInstanceToVend2) = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestDownloadedAtomicInstance2];

        if (latestAtomicInstanceToVend2)
        {
          if (errorCopy)
          {
            availableForUseError = [v22 availableForUseError];
            v29 = [(MADAutoAssetControlManager *)self statusErrorConsideredMatch:errorCopy to:availableForUseError];

            if ((v29 & 1) == 0)
            {
              [v22 setAvailableForUseError:errorCopy];
              [(MADAutoAssetControlManager *)self setConfigurationPersist:v22 fromLocation:unlockCopy forReason:@"latest-to-vend atomic-instance force-unlocked" dueToAlter:0 forHistoryOperation:460];
            }
          }
        }

        else
        {
          [(MADAutoAssetControlManager *)self _removeAllUnlockedForOtherAtomicInstances:v25 fromLocation:unlockCopy];
        }

        d = dCopy;
      }
    }

    if ([MADAutoAssetSecure isErrorDueToDeviceBeingLocked:errorCopy])
    {
      v30 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
      {
        summary = [v22 summary];
        *buf = 138543618;
        v37 = unlockCopy;
        v38 = 2114;
        v39 = summary;
        _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@} force-unlock due to failure to graft (due to device being locked) | setConfiguration:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v19 fromLocation:unlockCopy checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:i historyOperationSD:d];
    }

    clientDomainName2 = [v19 clientDomainName];
    assetSetIdentifier2 = [v19 assetSetIdentifier];
    latestDownloadedAtomicInstance3 = [v19 latestDownloadedAtomicInstance];
    [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_FORCE_UNLOCKED" forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forAtomicInstanceUUID:latestDownloadedAtomicInstance3 fromModule:@"AUTO-CONTROL" fromLocation:unlockCopy];
  }
}

- (BOOL)atomicInstanceIsCurrentlyLocked:(id)locked
{
  lockedCopy = locked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (lockedCopy)
  {
    atomicInstanceUUID = [lockedCopy atomicInstanceUUID];
    v8 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"atomicInstanceIsCurrentlyLocked" forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

    if (v8)
    {
      v9 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"atomicInstanceIsCurrentlyLocked" forSetDescriptor:v8];
    }

    else
    {
      v9 = 0;
    }
  }

  else
  {
    v9 = 0;
  }

  return v9;
}

- (id)atomicInstanceUUIDFromCurrentStatus:(id)status
{
  statusCopy = status;
  newerAtomicInstanceDiscovered = [statusCopy newerAtomicInstanceDiscovered];
  if (!newerAtomicInstanceDiscovered)
  {
    newerAtomicInstanceDiscovered = [statusCopy latestDownloadedAtomicInstance];
  }

  return newerAtomicInstanceDiscovered;
}

- (void)atomicInstanceRemovedSetJob:(id)job removingForReason:(id)reason historyOperation:(int64_t)operation
{
  jobCopy = job;
  reasonCopy = reason;
  v9 = jobCopy;
  v40 = reasonCopy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v42 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceRemovedSetJob" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v54 = 0u;
  v55 = 0u;
  v52 = 0u;
  v53 = 0u;
  selfCopy = self;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v43 = jobCopy;
  v46 = [obj countByEnumeratingWithState:&v52 objects:v57 count:16];
  if (v46)
  {
    v45 = *v53;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      v13 = 0;
      do
      {
        if (*v53 != v45)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v52 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
        v17 = [knownSetAtomicInstancesByInstance safeObjectForKey:v14 ofClass:objc_opt_class()];

        atomicInstanceUUID = [v17 atomicInstanceUUID];
        if (atomicInstanceUUID)
        {
          v19 = atomicInstanceUUID;
          v20 = p_weak_ivar_lyt[223];
          clientDomainName = [v17 clientDomainName];
          clientDomainName2 = [v9 clientDomainName];
          if ([v20 stringIsEqual:clientDomainName to:clientDomainName2])
          {
            v23 = p_weak_ivar_lyt[223];
            assetSetIdentifier = [v17 assetSetIdentifier];
            autoAssetSetIdentifier = [v9 autoAssetSetIdentifier];
            LODWORD(v23) = [v23 stringIsEqual:assetSetIdentifier to:autoAssetSetIdentifier];

            v9 = v43;
            if (!v23)
            {
              goto LABEL_15;
            }

            atomicInstanceUUID2 = [v17 atomicInstanceUUID];
            v19 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"atomicInstanceRemovedSetJob" forAtomicInstanceUUID:atomicInstanceUUID2 requireExists:0];

            if (!v19)
            {
              atomicInstanceUUID3 = [v17 atomicInstanceUUID];

              if (atomicInstanceUUID3)
              {
                clientDomainName = [v17 atomicInstanceUUID];
                [v42 addObject:clientDomainName];
              }

              else
              {
                clientDomainName = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
                diag = [clientDomainName diag];
                v29 = [NSString alloc];
                summary = [v17 summary];
                v31 = [v29 initWithFormat:@"{atomicInstanceRemovedSetJob} MISSING atomicInstanceUUID | nextSetAtomicInstance:%@", summary];
                [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v31 withResult:6108 withError:0];

                v9 = v43;
              }

LABEL_13:

              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            }

            goto LABEL_15;
          }

          goto LABEL_13;
        }

LABEL_15:

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v46 != v13);
      v32 = [obj countByEnumeratingWithState:&v52 objects:v57 count:16];
      v46 = v32;
    }

    while (v32);
  }

  v50 = 0u;
  v51 = 0u;
  v48 = 0u;
  v49 = 0u;
  v33 = v42;
  v34 = [v33 countByEnumeratingWithState:&v48 objects:v56 count:16];
  if (v34)
  {
    v35 = v34;
    v36 = *v49;
    do
    {
      for (i = 0; i != v35; i = i + 1)
      {
        if (*v49 != v36)
        {
          objc_enumerationMutation(v33);
        }

        v38 = *(*(&v48 + 1) + 8 * i);
        v39 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)selfCopy atomicInstanceRemove:@"atomicInstanceRemovedSetJob" setAtomicInstanceUUID:v38 removingForReason:v40 historyOperation:operation];
        objc_autoreleasePoolPop(v39);
      }

      v35 = [v33 countByEnumeratingWithState:&v48 objects:v56 count:16];
    }

    while (v35);
  }
}

- (void)atomicInstanceEliminate:(id)eliminate forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier
{
  eliminateCopy = eliminate;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v54 = eliminateCopy;
  eliminateCopy = [[NSString alloc] initWithFormat:@"%@:atomicInstanceEliminate", eliminateCopy];
  v61 = objc_alloc_init(NSMutableArray);
  v57 = eliminateCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:eliminateCopy ofContainer:@"knownSetAtomicInstancesByInstance"];
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  selfCopy = self;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v71 objects:v82 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v72;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v72 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v17 = *(*(&v71 + 1) + 8 * i);
        v18 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
        v20 = [knownSetAtomicInstancesByInstance safeObjectForKey:v17 ofClass:objc_opt_class()];

        if (v17)
        {
          v21 = v20 == 0;
        }

        else
        {
          v21 = 1;
        }

        if (!v21)
        {
          v22 = p_weak_ivar_lyt[223];
          clientDomainName = [v20 clientDomainName];
          if ([v22 stringIsEqual:nameCopy to:clientDomainName])
          {
            v24 = p_weak_ivar_lyt[223];
            [v20 assetSetIdentifier];
            v26 = v25 = p_weak_ivar_lyt;
            LODWORD(v24) = [v24 stringIsEqual:identifierCopy to:v26];

            p_weak_ivar_lyt = v25;
            if (!v24)
            {
              goto LABEL_15;
            }

            [v61 addObject:v17];
            clientDomainName = _MADLog(@"AutoControl");
            if (os_log_type_enabled(clientDomainName, OS_LOG_TYPE_DEFAULT))
            {
              summary = [(MADAutoAssetControlManager *)selfCopy summary];
              summary2 = [v20 summary];
              *buf = 138543874;
              v77 = summary;
              v78 = 2114;
              v79 = v57;
              v80 = 2114;
              v81 = summary2;
              _os_log_impl(&dword_0, clientDomainName, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} | eliminating nextSetAtomicInstance:%{public}@", buf, 0x20u);

              p_weak_ivar_lyt = v25;
            }
          }
        }

LABEL_15:

        objc_autoreleasePoolPop(v18);
      }

      v13 = [obj countByEnumeratingWithState:&v71 objects:v82 count:16];
    }

    while (v13);
  }

  v69 = 0u;
  v70 = 0u;
  v67 = 0u;
  v68 = 0u;
  v59 = v61;
  v29 = [v59 countByEnumeratingWithState:&v67 objects:v75 count:16];
  v30 = selfCopy;
  v31 = v57;
  if (v29)
  {
    v32 = v29;
    v60 = *v68;
    do
    {
      v33 = 0;
      v56 = v32;
      do
      {
        if (*v68 != v60)
        {
          objc_enumerationMutation(v59);
        }

        v34 = *(*(&v67 + 1) + 8 * v33);
        v35 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)v30 knownSetAtomicInstancesByInstance];
        v37 = [knownSetAtomicInstancesByInstance2 safeObjectForKey:v34 ofClass:objc_opt_class()];

        if (v37)
        {
          v38 = [(MADAutoAssetControlManager *)v30 atomicInstanceNewEntryIDForSetAtomicInstance:v37];
          persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)v30 persistedKnownSetAtomicInstances];
          v40 = [persistedKnownSetAtomicInstances persistedEntry:v38 fromLocation:v31];

          if (v40)
          {
            v62 = v40;
            obja = v35;
            [v37 setUsageStatus:@"FORGOTTEN"];
            persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)v30 persistedKnownSetAtomicInstances];
            [persistedKnownSetAtomicInstances2 removePersistedEntry:v38 fromLocation:v31];

            instanceEntries = [v37 instanceEntries];
            v43 = [instanceEntries count];
            clientDomainName2 = [v37 clientDomainName];
            assetSetIdentifier = [v37 assetSetIdentifier];
            atomicInstanceUUID = [v37 atomicInstanceUUID];
            [MADAutoAssetHistory recordOperation:300 toHistoryType:2 fromLayer:1 usageCount:v43 forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:atomicInstanceUUID];

            v31 = v57;
            v30 = selfCopy;

            [(MADAutoAssetControlManager *)selfCopy _logPersistedSetAtomicInstanceRemoved:v57 removedPersistedEntryID:v38 removedSetAtomicInstance:v37 message:@"eliminated by client"];
            atomicInstanceUUID2 = [v37 atomicInstanceUUID];

            if (atomicInstanceUUID2)
            {
              knownSetAtomicInstancesByInstance3 = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
              atomicInstanceUUID3 = [v37 atomicInstanceUUID];
              [knownSetAtomicInstancesByInstance3 removeObjectForKey:atomicInstanceUUID3];
            }

            [(MADAutoAssetControlManager *)selfCopy _clearAtomicInstanceFromAllSetConfigurations:v37 fromLocation:v57];
            v32 = v56;
            v40 = v62;
            v35 = obja;
          }

          else
          {
            v50 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)v30 _updateLatestSummary];
              [v37 summary];
              v52 = objb = v35;
              *buf = 138543874;
              v77 = _updateLatestSummary;
              v78 = 2114;
              v79 = v31;
              v80 = 2114;
              v81 = v52;
              _os_log_impl(&dword_0, v50, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to load persisted-set-atomic-instance file | nextRemoveSetInstance:%{public}@", buf, 0x20u);

              v35 = objb;
              v40 = 0;
            }
          }
        }

        if (v34)
        {
          knownSetAtomicInstancesByInstance4 = [(MADAutoAssetControlManager *)v30 knownSetAtomicInstancesByInstance];
          [knownSetAtomicInstancesByInstance4 removeObjectForKey:v34];
        }

        objc_autoreleasePoolPop(v35);
        v33 = v33 + 1;
      }

      while (v32 != v33);
      v32 = [v59 countByEnumeratingWithState:&v67 objects:v75 count:16];
    }

    while (v32);
  }
}

- (void)atomicInstanceRemove:(id)remove setAtomicInstanceUUID:(id)d removingForReason:(id)reason historyOperation:(int64_t)operation
{
  removeCopy = remove;
  dCopy = d;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v67 = objc_alloc_init(NSMutableArray);
  v61 = removeCopy;
  removeCopy = [[NSString alloc] initWithFormat:@"%@:atomicInstanceRemove", removeCopy];
  [MADAutoAssetControlManager trackPerformanceIteration:"trackPerformanceIteration:ofContainer:" ofContainer:?];
  v81 = 0u;
  v82 = 0u;
  v79 = 0u;
  v80 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v12 = [obj countByEnumeratingWithState:&v79 objects:v94 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v80;
    v69 = *v80;
    do
    {
      for (i = 0; i != v13; i = i + 1)
      {
        if (*v80 != v14)
        {
          objc_enumerationMutation(obj);
        }

        v16 = *(*(&v79 + 1) + 8 * i);
        v17 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v19 = [knownSetAtomicInstancesByInstance safeObjectForKey:v16 ofClass:objc_opt_class()];

        if (v16)
        {
          v20 = v19 == 0;
        }

        else
        {
          v20 = 1;
        }

        if (!v20)
        {
          atomicInstanceUUID = [v19 atomicInstanceUUID];
          if ([SUCore stringIsEqual:atomicInstanceUUID to:dCopy])
          {
          }

          else
          {
            subAtomicFromAtomicInstanceUUID = [v19 subAtomicFromAtomicInstanceUUID];
            v23 = [SUCore stringIsEqual:subAtomicFromAtomicInstanceUUID to:dCopy];

            v14 = v69;
            if (!v23)
            {
              goto LABEL_16;
            }
          }

          [v67 addObject:v16];
          v24 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
          {
            summary = [(MADAutoAssetControlManager *)self summary];
            summary2 = [v19 summary];
            *buf = 138544386;
            v85 = summary;
            v86 = 2114;
            v87 = removeCopy;
            v88 = 2114;
            v89 = reasonCopy;
            v90 = 2114;
            v91 = dCopy;
            v92 = 2114;
            v93 = summary2;
            _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} (%{public}@) removing by UUID | setAtomicInstanceUUID:%{public}@ | nextSetAtomicInstance:%{public}@", buf, 0x34u);

            v14 = v69;
          }
        }

LABEL_16:

        objc_autoreleasePoolPop(v17);
      }

      v13 = [obj countByEnumeratingWithState:&v79 objects:v94 count:16];
    }

    while (v13);
  }

  v77 = 0u;
  v78 = 0u;
  v75 = 0u;
  v76 = 0u;
  v62 = v67;
  v27 = dCopy;
  v28 = removeCopy;
  v73 = [v62 countByEnumeratingWithState:&v75 objects:v83 count:16];
  if (v73)
  {
    obja = *v76;
    do
    {
      for (j = 0; j != v73; j = j + 1)
      {
        if (*v76 != obja)
        {
          objc_enumerationMutation(v62);
        }

        v30 = *(*(&v75 + 1) + 8 * j);
        v31 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v33 = [knownSetAtomicInstancesByInstance2 safeObjectForKey:v30 ofClass:objc_opt_class()];

        if (v33)
        {
          [(MADAutoAssetControlManager *)self setConfigurationRemovedAtomicInstance:v27 fromLocation:v28];
          v34 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v33];
          persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v36 = [persistedKnownSetAtomicInstances persistedEntry:v34 fromLocation:v28];

          if (v36)
          {
            v66 = v36;
            v70 = v31;
            [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromAllSetConfigurations:v33 fromLocation:v28];
            [(MADAutoAssetControlManager *)self setConfigurationRemovedAtomicInstance:v27 fromLocation:v28];
            [v33 setUsageStatus:@"FORGOTTEN"];
            persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
            [persistedKnownSetAtomicInstances2 removePersistedEntry:v34 fromLocation:v28];

            instanceEntries = [v33 instanceEntries];
            v68 = v34;
            v39 = [instanceEntries count];
            clientDomainName = [v33 clientDomainName];
            assetSetIdentifier = [v33 assetSetIdentifier];
            atomicInstanceUUID2 = [v33 atomicInstanceUUID];
            v43 = v39;
            v34 = v68;
            [MADAutoAssetHistory recordOperation:operation toHistoryType:2 fromLayer:1 usageCount:v43 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:atomicInstanceUUID2];

            v28 = removeCopy;
            reasonCopy = [[NSString alloc] initWithFormat:@"removed set-atomic-instance | removalReason:%@", reasonCopy];
            [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstanceRemoved:removeCopy removedPersistedEntryID:v68 removedSetAtomicInstance:v33 message:reasonCopy];

            if (v30)
            {
              knownSetAtomicInstancesByInstance3 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
              [knownSetAtomicInstancesByInstance3 removeObjectForKey:v30];
            }

            v46 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
            {
              summary3 = [v33 summary];
              *buf = 138543618;
              v85 = removeCopy;
              v86 = 2114;
              v87 = summary3;
              _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "\n[ATOMIC-INSTANCE] {%{public}@} removed | nextRemoveSetInstance:%{public}@", buf, 0x16u);
            }

            v27 = dCopy;
            v31 = v70;
            v36 = v66;
            if (+[MAAIRBEventReporter isAvailable])
            {
              v48 = [MAAIRBMobileAssetOperationMetadata alloc];
              v49 = [MADAutoAssetHistoryTracker operationName:operation];
              v50 = [(MAAIRBMobileAssetOperationMetadata *)v48 initWithCode:operation name:v49];

              v51 = [MAAIRBMobileAssetAtomicInstance alloc];
              v52 = [MAAIRBMobileAssetAssetSet alloc];
              assetSetIdentifier2 = [v33 assetSetIdentifier];
              v54 = [(MAAIRBMobileAssetAssetSet *)v52 initWithAssetSetIdentifier:assetSetIdentifier2];
              atomicInstanceUUID3 = [v33 atomicInstanceUUID];
              _updateLatestSummary = [(MAAIRBMobileAssetAtomicInstance *)v51 initWithAssetSet:v54 atomicInstanceId:atomicInstanceUUID3];

              v28 = removeCopy;
              v36 = v66;
              instanceEntries2 = [v33 instanceEntries];
              v58 = +[MAAIRBAppleIntelligenceAssetDeliveryEventType typeAtomicInstance:atomicInstance:assetCount:](MAAIRBAppleIntelligenceAssetDeliveryEventType, "typeAtomicInstance:atomicInstance:assetCount:", v50, _updateLatestSummary, [instanceEntries2 count]);

              v59 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v58];
              [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v59];

              v34 = v68;
              v31 = v70;
              goto LABEL_33;
            }
          }

          else
          {
            v50 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v50, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary4 = [v33 summary];
              *buf = 138544130;
              v85 = _updateLatestSummary;
              v86 = 2114;
              v87 = v28;
              v88 = 2114;
              v89 = reasonCopy;
              v90 = 2114;
              v91 = summary4;
              _os_log_impl(&dword_0, v50, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] (%{public}@) {%{public}@} unable to load persisted-set-atomic-instance file | nextRemoveSetInstance:%{public}@", buf, 0x2Au);

              v27 = dCopy;
LABEL_33:
            }
          }
        }

        objc_autoreleasePoolPop(v31);
      }

      v73 = [v62 countByEnumeratingWithState:&v75 objects:v83 count:16];
    }

    while (v73);
  }
}

- (id)newSetLockUsageMapKeyForClientDomain:(id)domain forSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  identifierCopy = [[NSString alloc] initWithFormat:@"%@_%@", domainCopy, identifierCopy];

  return identifierCopy;
}

- (id)setLockUsageMapForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];

  v9 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:clientDomainName forSetIdentifier:assetSetIdentifier];
  setLockUsageMap = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v11 = [setLockUsageMap safeObjectForKey:v9 ofClass:objc_opt_class()];

  return v11;
}

- (id)setLockUsageMapForClientDomain:(id)domain forSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:domainCopy forSetIdentifier:identifierCopy];
  setLockUsageMap = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v12 = [setLockUsageMap safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (void)setLockUsageMapLockedSetDescriptor:(id)descriptor forLockReason:(id)reason
{
  descriptorCopy = descriptor;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9 = [[NSNumber alloc] initWithLong:1];
  if (v9)
  {
    clientDomainName = [descriptorCopy clientDomainName];
    assetSetIdentifier = [descriptorCopy assetSetIdentifier];
    v12 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:clientDomainName forSetIdentifier:assetSetIdentifier];

    setLockUsageMap = [(MADAutoAssetControlManager *)self setLockUsageMap];
    v14 = [setLockUsageMap safeObjectForKey:v12 ofClass:objc_opt_class()];

    if (!v14)
    {
      v20 = objc_alloc_init(NSMutableDictionary);
      if (!v20)
      {
LABEL_16:

        goto LABEL_17;
      }

      v14 = v20;
      v16 = objc_alloc_init(NSMutableDictionary);
      if (v16)
      {
        latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
        [v16 setSafeObject:v9 forKey:latestDownloadedAtomicInstance];

        [v14 setSafeObject:v16 forKey:reasonCopy];
        setLockUsageMap2 = [(MADAutoAssetControlManager *)self setLockUsageMap];
        [setLockUsageMap2 setSafeObject:v14 forKey:v12];
      }

      goto LABEL_14;
    }

    v15 = [v14 safeObjectForKey:reasonCopy ofClass:objc_opt_class()];
    if (v15)
    {
      v16 = v15;
      latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
      v18 = [v16 safeObjectForKey:latestDownloadedAtomicInstance2 ofClass:objc_opt_class()];

      if (v18)
      {
        v19 = [[NSNumber alloc] initWithLong:{objc_msgSend(v18, "longValue") + objc_msgSend(v9, "longValue")}];

        if (!v19)
        {
          goto LABEL_14;
        }
      }

      else
      {
        v19 = v9;
      }

      latestDownloadedAtomicInstance3 = [descriptorCopy latestDownloadedAtomicInstance];
      [v16 setSafeObject:v19 forKey:latestDownloadedAtomicInstance3];
    }

    else
    {
      v23 = objc_alloc_init(NSMutableDictionary);
      if (!v23)
      {
LABEL_15:

        goto LABEL_16;
      }

      v16 = v23;
      latestDownloadedAtomicInstance4 = [descriptorCopy latestDownloadedAtomicInstance];
      [v16 setSafeObject:v9 forKey:latestDownloadedAtomicInstance4];

      [v14 setSafeObject:v16 forKey:reasonCopy];
    }

LABEL_14:

    goto LABEL_15;
  }

LABEL_17:
}

- (void)setLockUsageMapEndedLockForSetDescriptor:(id)descriptor forLockReason:(id)reason endedLockCount:(int64_t)count
{
  descriptorCopy = descriptor;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:clientDomainName forSetIdentifier:assetSetIdentifier];

  selfCopy = self;
  setLockUsageMap = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v16 = [setLockUsageMap safeObjectForKey:v13 ofClass:objc_opt_class()];

  v55 = v13;
  v58 = v16;
  if (v16)
  {
    if (reasonCopy)
    {
      v67 = reasonCopy;
      allKeys = [NSArray arrayWithObjects:&v67 count:1];
      v18 = v16;
    }

    else
    {
      v18 = v16;
      allKeys = [v16 allKeys];
    }

    v64 = 0u;
    v65 = 0u;
    v62 = 0u;
    v63 = 0u;
    v19 = allKeys;
    v60 = [v19 countByEnumeratingWithState:&v62 objects:v66 count:16];
    if (v60)
    {
      v59 = *v63;
      obj = v19;
      do
      {
        v22 = 0;
        do
        {
          if (*v63 != v59)
          {
            objc_enumerationMutation(obj);
          }

          v23 = [v18 safeObjectForKey:*(*(&v62 + 1) + 8 * v22) ofClass:objc_opt_class()];
          if (!v23)
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            v38 = [NSString alloc];
            summary = [descriptorCopy summary];
            v40 = [v38 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when no lockReasonByAtomicInstanceUUID in lock-usage-map | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | setIdentifierByLockReason:%@", reasonCopy, count, summary, v18];
            [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v40 withResult:6108 withError:0];

            goto LABEL_18;
          }

          latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
          autoControlManagerFSM3 = [v23 safeObjectForKey:latestDownloadedAtomicInstance ofClass:objc_opt_class()];

          if (!autoControlManagerFSM3)
          {
            if (reasonCopy)
            {
              autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
              diag2 = [autoControlManagerFSM3 diag];
              v42 = [NSString alloc];
              summary2 = [descriptorCopy summary];
              v44 = [v42 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when no autoAssetLockCount in lock-usage-map | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | lockReasonByAtomicInstanceUUID:%@", reasonCopy, count, summary2, v23];
              [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v44 withResult:6108 withError:0];
            }

            else
            {
              autoControlManagerFSM3 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(autoControlManagerFSM3, OS_LOG_TYPE_DEFAULT))
              {
                goto LABEL_27;
              }

              diag2 = [descriptorCopy summary];
              setLockUsageMap2 = [(MADAutoAssetControlManager *)selfCopy setLockUsageMap];
              *buf = 138543618;
              v69 = diag2;
              v70 = 2114;
              v71 = setLockUsageMap2;
              _os_log_impl(&dword_0, autoControlManagerFSM3, OS_LOG_TYPE_DEFAULT, "{setLockUsageMapEndedLockForSetDescriptor} no set-locks in set-lock-usage-map for set-descriptor | setDescriptor:%{public}@ | setLockUsageMap:\n%{public}@", buf, 0x16u);
            }

            goto LABEL_27;
          }

          intValue = [autoControlManagerFSM3 intValue];
          if (count == -1)
          {
            goto LABEL_27;
          }

          v27 = descriptorCopy;
          v28 = selfCopy;
          v29 = reasonCopy;
          v30 = intValue;
          if (intValue < count)
          {
            v31 = v28;
            autoControlManagerFSM4 = [(MADAutoAssetControlManager *)v28 autoControlManagerFSM];
            diag3 = [autoControlManagerFSM4 diag];
            v33 = [NSString alloc];
            descriptorCopy = v27;
            summary3 = [v27 summary];
            v54 = v29;
            v53 = v30;
            reasonCopy = v29;
            selfCopy = v31;
            v35 = [v33 initWithFormat:@"{setLockUsageMapEndedLockForSetDescriptor} just ended locks when previousLockCount(%ld) too small | justEndedReason:%@ | justEndedLockCount:%ld | setDescriptor:%@ | lockReasonByAtomicInstanceUUID:%@", v53, v54, count, summary3, v23];
            [diag3 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v35 withResult:6108 withError:0];

LABEL_27:
            goto LABEL_28;
          }

          if (intValue == count)
          {
            reasonCopy = v29;
            selfCopy = v28;
            descriptorCopy = v27;
            goto LABEL_27;
          }

          autoControlManagerFSM2 = [[NSNumber alloc] initWithLong:intValue - count];

          reasonCopy = v29;
          selfCopy = v28;
          descriptorCopy = v27;
          if (autoControlManagerFSM2)
          {
            latestDownloadedAtomicInstance2 = [v27 latestDownloadedAtomicInstance];
            [v23 setSafeObject:autoControlManagerFSM2 forKey:latestDownloadedAtomicInstance2];
            goto LABEL_43;
          }

LABEL_28:
          latestDownloadedAtomicInstance3 = [descriptorCopy latestDownloadedAtomicInstance];

          if (latestDownloadedAtomicInstance3)
          {
            latestDownloadedAtomicInstance4 = [descriptorCopy latestDownloadedAtomicInstance];
            [v23 removeObjectForKey:latestDownloadedAtomicInstance4];
          }

          v18 = v58;
          if (![v23 count])
          {
            if (reasonCopy)
            {
              [v58 removeObjectForKey:reasonCopy];
            }

            if (![v58 count])
            {
              if (v55)
              {
                setLockUsageMap3 = [(MADAutoAssetControlManager *)selfCopy setLockUsageMap];
                [setLockUsageMap3 removeObjectForKey:v55];
              }

              setLockUsageMap4 = [(MADAutoAssetControlManager *)selfCopy setLockUsageMap];
              v50 = [setLockUsageMap4 count];

              v18 = v58;
              if (!v50)
              {
                autoControlManagerFSM2 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
                {
                  latestDownloadedAtomicInstance2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  *buf = 138543362;
                  v69 = latestDownloadedAtomicInstance2;
                  _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setLockUsageMapEndedLockForSetDescriptor} no remaining set-locks in set-lock-usage-map", buf, 0xCu);
LABEL_43:

                  v18 = v58;
                }

LABEL_18:
              }
            }
          }

          v22 = v22 + 1;
        }

        while (v60 != v22);
        v19 = obj;
        v52 = [obj countByEnumeratingWithState:&v62 objects:v66 count:16];
        v60 = v52;
      }

      while (v52);
    }

    v13 = v55;
  }

  else
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      summary4 = [descriptorCopy summary];
      *buf = 138543618;
      v69 = _updateLatestSummary;
      v70 = 2114;
      v71 = summary4;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {setLockUsageMapEndedLockForSetDescriptor} set-descriptor not in lock-usage-map | setDescriptor:%{public}@", buf, 0x16u);
    }
  }
}

- (void)setLockUsageMapEliminateForClientDomain:(id)domain forSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v11 = [(MADAutoAssetControlManager *)self newSetLockUsageMapKeyForClientDomain:domainCopy forSetIdentifier:identifierCopy];
  if (v11)
  {
    setLockUsageMap = [(MADAutoAssetControlManager *)self setLockUsageMap];
    [setLockUsageMap removeObjectForKey:v11];
  }
}

- (int)setLockUsageMapForAtomicInstance:(id)instance clientLockUsageMap:(id)map lockReason:(id)reason
{
  instanceCopy = instance;
  mapCopy = map;
  reasonCopy = reason;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (reasonCopy)
  {
    v30 = reasonCopy;
    allKeys = [NSArray arrayWithObjects:&v30 count:1];
  }

  else
  {
    allKeys = [mapCopy allKeys];
  }

  v24 = reasonCopy;
  v27 = 0u;
  v28 = 0u;
  v25 = 0u;
  v26 = 0u;
  v14 = allKeys;
  v15 = [v14 countByEnumeratingWithState:&v25 objects:v29 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = 0;
    v18 = *v26;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v26 != v18)
        {
          objc_enumerationMutation(v14);
        }

        v20 = [mapCopy safeObjectForKey:*(*(&v25 + 1) + 8 * i) ofClass:objc_opt_class()];
        if (v20)
        {
          v21 = [v20 safeObjectForKey:instanceCopy ofClass:objc_opt_class()];
          v22 = v21;
          if (v21)
          {
            v17 += [v21 intValue];
          }
        }
      }

      v16 = [v14 countByEnumeratingWithState:&v25 objects:v29 count:16];
    }

    while (v16);
  }

  else
  {
    v17 = 0;
  }

  return v17;
}

- (int64_t)setLockUsageMapLockCount
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"setLockUsageMapLockCount" ofContainer:@"setLockUsageMap"];
  v48 = 0u;
  v49 = 0u;
  v46 = 0u;
  v47 = 0u;
  selfCopy = self;
  obj = [(MADAutoAssetControlManager *)self setLockUsageMap];
  v30 = [obj countByEnumeratingWithState:&v46 objects:v52 count:16];
  v5 = 0;
  if (v30)
  {
    v28 = *v47;
    do
    {
      v6 = 0;
      do
      {
        if (*v47 != v28)
        {
          objc_enumerationMutation(obj);
        }

        v7 = *(*(&v46 + 1) + 8 * v6);
        v8 = objc_autoreleasePoolPush();
        setLockUsageMap = [(MADAutoAssetControlManager *)selfCopy setLockUsageMap];
        v10 = [setLockUsageMap safeObjectForKey:v7 ofClass:objc_opt_class()];

        if (v10)
        {
          v32 = v8;
          v33 = v6;
          v44 = 0u;
          v45 = 0u;
          v42 = 0u;
          v43 = 0u;
          v31 = v10;
          v11 = v10;
          v36 = [v11 countByEnumeratingWithState:&v42 objects:v51 count:16];
          if (v36)
          {
            v34 = v11;
            v35 = *v43;
            do
            {
              v12 = 0;
              do
              {
                if (*v43 != v35)
                {
                  objc_enumerationMutation(v11);
                }

                v13 = *(*(&v42 + 1) + 8 * v12);
                v14 = objc_autoreleasePoolPush();
                v15 = [v11 safeObjectForKey:v13 ofClass:objc_opt_class()];
                v16 = v15;
                if (v15)
                {
                  v37 = v14;
                  v40 = 0u;
                  v41 = 0u;
                  v38 = 0u;
                  v39 = 0u;
                  v17 = v15;
                  v18 = [v17 countByEnumeratingWithState:&v38 objects:v50 count:16];
                  if (v18)
                  {
                    v19 = v18;
                    v20 = *v39;
                    do
                    {
                      v21 = 0;
                      do
                      {
                        if (*v39 != v20)
                        {
                          objc_enumerationMutation(v17);
                        }

                        v22 = *(*(&v38 + 1) + 8 * v21);
                        v23 = objc_autoreleasePoolPush();
                        v24 = [v17 safeObjectForKey:v22 ofClass:objc_opt_class()];
                        v25 = v24;
                        if (v24)
                        {
                          v5 += [v24 longValue];
                        }

                        objc_autoreleasePoolPop(v23);
                        v21 = v21 + 1;
                      }

                      while (v19 != v21);
                      v19 = [v17 countByEnumeratingWithState:&v38 objects:v50 count:16];
                    }

                    while (v19);
                  }

                  v11 = v34;
                  v14 = v37;
                }

                objc_autoreleasePoolPop(v14);
                v12 = v12 + 1;
              }

              while (v12 != v36);
              v36 = [v11 countByEnumeratingWithState:&v42 objects:v51 count:16];
            }

            while (v36);
          }

          v8 = v32;
          v6 = v33;
          v10 = v31;
        }

        objc_autoreleasePoolPop(v8);
        v6 = v6 + 1;
      }

      while (v6 != v30);
      v30 = [obj countByEnumeratingWithState:&v46 objects:v52 count:16];
    }

    while (v30);
  }

  return v5;
}

- (id)shortTermLockSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor forSpecificAtomicInstance:(id)instance
{
  descriptorCopy = descriptor;
  setDescriptorCopy = setDescriptor;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:shortTermLockSetDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &state);

  v50 = +[NSFileManager defaultManager];
  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:shortTermLockSetDescriptor", descriptorCopy];
  clientDomainName = [setDescriptorCopy clientDomainName];
  assetSetIdentifier = [setDescriptorCopy assetSetIdentifier];
  v49 = [(MADAutoAssetControlManager *)self latestShortTermLockableAtomicInstanceForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  clientDomainName2 = [setDescriptorCopy clientDomainName];
  assetSetIdentifier2 = [setDescriptorCopy assetSetIdentifier];
  v17 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forSetAtomicInstance:0];

  clientDomainName3 = [setDescriptorCopy clientDomainName];
  assetSetIdentifier3 = [setDescriptorCopy assetSetIdentifier];
  latestDownloadedAtomicInstance = [setDescriptorCopy latestDownloadedAtomicInstance];
  v21 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3 forSetAtomicInstance:latestDownloadedAtomicInstance];

  if (v17 && v21)
  {
    clientDomainName4 = [setDescriptorCopy clientDomainName];
    assetSetIdentifier4 = [setDescriptorCopy assetSetIdentifier];
    latestDownloadedAtomicInstance2 = [setDescriptorCopy latestDownloadedAtomicInstance];
    LOBYTE(v45) = 1;
    v25 = [(MADAutoAssetControlManager *)self buildReportedSetStatus:descriptorCopy forClientDomainName:clientDomainName4 forSetIdentifier:assetSetIdentifier4 forAtomicInstance:latestDownloadedAtomicInstance2 withFoundSetDescriptor:setDescriptorCopy withSubAtomicInstance:0 reportingLocalContentURLs:v45];

    clientDomainName5 = [setDescriptorCopy clientDomainName];
    assetSetIdentifier5 = [setDescriptorCopy assetSetIdentifier];
    v28 = [MANAutoAssetSetStatus shortTermLockDirectory:clientDomainName5 forAssetSetIdentifier:assetSetIdentifier5];

    v60 = NSFilePosixPermissions;
    v61 = &off_4F7F88;
    v29 = [NSDictionary dictionaryWithObjects:&v61 forKeys:&v60 count:1];
    v52 = 0;
    LOBYTE(assetSetIdentifier4) = [v50 createDirectoryAtPath:v28 withIntermediateDirectories:1 attributes:v29 error:&v52];
    v30 = v52;

    v31 = __error();
    if (assetSetIdentifier4)
    {
      if (!v49)
      {
        v32 = [(MADAutoAssetControlManager *)self _shortTermPersistSetStatus:descriptorCopy forSetDescriptor:setDescriptorCopy persistingSetStatus:v25 toFilename:v21];
        if (!v32)
        {
          v42 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
          {
            summary = [setDescriptorCopy summary];
            *buf = 138543874;
            v55 = descriptorCopy;
            v56 = 2114;
            v57 = v21;
            v58 = 2114;
            v59 = summary;
            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][FILE]{%{public}@} created SHORT-TERM atomic-instance file | filename:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
          }

          v32 = [(MADAutoAssetControlManager *)self _shortTermCreateSymbolicLink:descriptorCopy symbolicLinkFilename:v17 linkedToFilename:v21 forSetDescriptor:setDescriptorCopy usingFileManager:v50];
          if (!v32)
          {
            [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:setDescriptorCopy forSpecificAtomicInstance:instanceCopy isReadOnlyForResumeFromPersisted:0];
            v32 = 0;
          }
        }

        goto LABEL_17;
      }

      v32 = [(MADAutoAssetControlManager *)self _shortTermPersistSetStatus:descriptorCopy forSetDescriptor:setDescriptorCopy persistingSetStatus:v25 toFilename:v21];
      if (v32)
      {
LABEL_17:

        goto LABEL_18;
      }

      v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:descriptorCopy forAtomicInstanceUUID:v49 requireExists:1];
      if (v33)
      {
        if (instanceCopy)
        {
LABEL_34:
          v32 = 0;
          goto LABEL_16;
        }
      }

      else
      {
        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag = [autoControlManagerFSM2 diag];
        v44 = [[NSString alloc] initWithFormat:@"{%@} unable to determine set-descriptor for atomic-instance that should be currently symlinked | atomic-instance:%@", descriptorCopy, v49];
        [diag trackAnomaly:@"AUTO-CONTROL" forReason:v44 withResult:6103 withError:0];
      }

      v32 = [(MADAutoAssetControlManager *)self _shortTermCreateSymbolicLink:descriptorCopy symbolicLinkFilename:v17 linkedToFilename:v21 forSetDescriptor:setDescriptorCopy usingFileManager:v50];
      if (!v32)
      {
        [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:setDescriptorCopy forSpecificAtomicInstance:instanceCopy isReadOnlyForResumeFromPersisted:0];
        goto LABEL_34;
      }
    }

    else
    {
      v33 = [[NSString alloc] initWithFormat:@"unable to create directory for SHORT-TERM lock atomic-instance file | filename:%@ | setDescriptor:%@ | errno:%i", v21, v28, *v31];
      v32 = [(MADAutoAssetControlManager *)self buildShortTermLockError:descriptorCopy code:6583 description:v33 forSetDescriptor:setDescriptorCopy underlyingError:v30];
    }

LABEL_16:

    goto LABEL_17;
  }

  v34 = [NSString alloc];
  v35 = @"N";
  if (v17)
  {
    v36 = v17;
  }

  else
  {
    v36 = @"N";
  }

  if (v21)
  {
    v35 = v21;
  }

  v25 = [v34 initWithFormat:@"unable to prepare for SHORT-TERM locking [MISSING-REQUIRED] | atomic-instance filenames (latest:%@, base:%@)", v36, v35];
  v32 = [(MADAutoAssetControlManager *)self buildShortTermLockError:descriptorCopy code:6101 description:v25 forSetDescriptor:setDescriptorCopy underlyingError:0];
  v30 = 0;
LABEL_18:

  if (v32)
  {
    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
    {
      checkedDescription = [v32 checkedDescription];
      summary2 = [setDescriptorCopy summary];
      *buf = 138543874;
      v55 = descriptorCopy;
      v56 = 2114;
      v57 = checkedDescription;
      v58 = 2114;
      v59 = summary2;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} ERROR preparing for SHORT-TERM locking | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
    }
  }

  else
  {
    v37 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
    {
      summary3 = [setDescriptorCopy summary];
      *buf = 138543618;
      v55 = descriptorCopy;
      v56 = 2114;
      v57 = summary3;
      _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} SUCCESS preparing for SHORT-TERM locking | setDescriptor:%{public}@", buf, 0x16u);
    }
  }

  os_activity_scope_leave(&state);

  return v32;
}

- (void)trackShortTermLockedSetDescriptor:(id)descriptor forSpecificAtomicInstance:(id)instance isReadOnlyForResumeFromPersisted:(BOOL)persisted
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  shortTermLockedLatestByIdentifier = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
  v15 = [shortTermLockedLatestByIdentifier safeObjectForKey:v13 ofClass:objc_opt_class()];

  v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"trackShortTermLockedSetDescriptor" forAtomicInstanceUUID:v15 requireExists:0];
  v17 = v16;
  if (instance)
  {
    v18 = v16 == 0;
  }

  else
  {
    v18 = 1;
  }

  v19 = v18;
  if (!persisted)
  {
    latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
    [(MADAutoAssetControlManager *)self _shortTermChangeAtomicInstance:@"trackShortTermLockedSetDescriptor" forAtomicInstance:latestDownloadedAtomicInstance toShortTermSupported:1];
  }

  if (v19)
  {
    shortTermLockedLatestByIdentifier2 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    [shortTermLockedLatestByIdentifier2 setSafeObject:latestDownloadedAtomicInstance2 forKey:v13];

    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      if (v17)
      {
        v24 = @"Replacing";
      }

      else
      {
        v24 = @"Setting";
      }

      latestDownloadedAtomicInstance3 = [descriptorCopy latestDownloadedAtomicInstance];
      summary = [descriptorCopy summary];
      v35 = 138543874;
      v36 = v24;
      v37 = 2114;
      v38 = latestDownloadedAtomicInstance3;
      v39 = 2114;
      v40 = summary;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{trackShortTermLockedSetDescriptor} %{public}@ latest supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", &v35, 0x20u);
    }
  }

  shortTermLockedByAtomicInstance = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
  latestDownloadedAtomicInstance4 = [descriptorCopy latestDownloadedAtomicInstance];
  [shortTermLockedByAtomicInstance setSafeObject:v13 forKey:latestDownloadedAtomicInstance4];

  v29 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
  {
    latestDownloadedAtomicInstance5 = [descriptorCopy latestDownloadedAtomicInstance];
    summary2 = [descriptorCopy summary];
    v35 = 138543618;
    v36 = latestDownloadedAtomicInstance5;
    v37 = 2114;
    v38 = summary2;
    _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{trackShortTermLockedSetDescriptor} now supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", &v35, 0x16u);
  }

  clientDomainName2 = [descriptorCopy clientDomainName];
  assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
  latestDownloadedAtomicInstance6 = [descriptorCopy latestDownloadedAtomicInstance];
  [MADAutoAssetControlManager postSetNotificationName:@"ATOMIC_INSTANCE_FIRST_LOCKED" forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forAtomicInstanceUUID:latestDownloadedAtomicInstance6 fromModule:@"AUTO-CONTROL" fromLocation:@"trackShortTermLockedSetDescriptor"];
}

- (BOOL)removeShortTermLockingOfSetDescriptor:(id)descriptor forSetDescriptor:(id)setDescriptor endingAll:(BOOL)all performingHardEliminate:(BOOL)eliminate error:(id *)error
{
  descriptorCopy = descriptor;
  setDescriptorCopy = setDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v11 = _os_activity_create(&dword_0, "MADAutoControl:removeShortTermLockingOfSetDescriptor", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v11, &state);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:removeShortTermLockingOfSetDescriptor", descriptorCopy];
  clientDomainName = [setDescriptorCopy clientDomainName];
  assetSetIdentifier = [setDescriptorCopy assetSetIdentifier];
  v95 = [(MADAutoAssetControlManager *)self latestShortTermLockableAtomicInstanceForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  if (!v95)
  {
    v22 = 0;
    v24 = 1;
    goto LABEL_77;
  }

  v104 = +[NSFileManager defaultManager];
  v97 = objc_alloc_init(NSMutableArray);
  v96 = objc_alloc_init(NSMutableArray);
  clientDomainName2 = [setDescriptorCopy clientDomainName];
  assetSetIdentifier2 = [setDescriptorCopy assetSetIdentifier];
  v92 = [(MADAutoAssetControlManager *)self setLockUsageMapForClientDomain:clientDomainName2 forSetIdentifier:assetSetIdentifier2];

  clientDomainName3 = [setDescriptorCopy clientDomainName];
  assetSetIdentifier3 = [setDescriptorCopy assetSetIdentifier];
  v105 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

  if (!v92)
  {
    v23 = 0;
    v22 = 0;
    v24 = 1;
LABEL_40:
    v35 = setDescriptorCopy;
    goto LABEL_41;
  }

  latestDownloadedAtomicInstance = [setDescriptorCopy latestDownloadedAtomicInstance];
  v19 = [(MADAutoAssetControlManager *)self setLockUsageMapForAtomicInstance:latestDownloadedAtomicInstance clientLockUsageMap:v92 lockReason:0];

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    summary = [setDescriptorCopy summary];
    *buf = 138544130;
    v129 = descriptorCopy;
    v130 = 1024;
    *v131 = v19;
    *&v131[4] = 2114;
    *&v131[6] = v95;
    *&v131[14] = 2114;
    *&v131[16] = summary;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} from clientLockUsageMap, currently held standard locks:%d | latestShortTermLockableAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x26u);
  }

  if (v19 > 1)
  {
    v22 = 0;
    v91 = 0;
    v23 = 0;
    v24 = 1;
LABEL_65:
    v35 = setDescriptorCopy;
    goto LABEL_67;
  }

  v123 = 0u;
  v124 = 0u;
  v121 = 0u;
  v122 = 0u;
  shortTermLockedByAtomicInstance = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
  v26 = [shortTermLockedByAtomicInstance countByEnumeratingWithState:&v121 objects:v133 count:16];
  if (v26)
  {
    v27 = *v122;
    do
    {
      for (i = 0; i != v26; i = i + 1)
      {
        if (*v122 != v27)
        {
          objc_enumerationMutation(shortTermLockedByAtomicInstance);
        }

        v29 = *(*(&v121 + 1) + 8 * i);
        shortTermLockedByAtomicInstance2 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
        v31 = [shortTermLockedByAtomicInstance2 safeObjectForKey:v29 ofClass:objc_opt_class()];

        if (v29)
        {
          if ([SUCore stringIsEqual:v31 to:v105])
          {
            latestDownloadedAtomicInstance2 = [setDescriptorCopy latestDownloadedAtomicInstance];
            v33 = [SUCore stringIsEqual:v29 to:latestDownloadedAtomicInstance2];

            if (v33)
            {
              [v97 addObject:v29];
            }
          }
        }
      }

      v26 = [shortTermLockedByAtomicInstance countByEnumeratingWithState:&v121 objects:v133 count:16];
    }

    while (v26);
  }

  v34 = [v97 count];
  v23 = 0;
  v24 = v34 == 0;
  v35 = setDescriptorCopy;
  v22 = 0;
  if (v34 && !eliminate)
  {
    v119 = 0u;
    v120 = 0u;
    v117 = 0u;
    v118 = 0u;
    obj = v97;
    v36 = [obj countByEnumeratingWithState:&v117 objects:v132 count:16];
    v23 = 0;
    if (v36)
    {
      v102 = *v118;
      while (2)
      {
        v37 = v36;
        for (j = 0; j != v37; j = j + 1)
        {
          if (*v118 != v102)
          {
            objc_enumerationMutation(obj);
          }

          v39 = *(*(&v117 + 1) + 8 * j);
          clientDomainName4 = [setDescriptorCopy clientDomainName];
          assetSetIdentifier4 = [setDescriptorCopy assetSetIdentifier];
          v42 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4 forSetAtomicInstance:v39];

          v116 = v23;
          v43 = [(MADAutoAssetControlManager *)self _shortTermSharedLockOpenExclusive:descriptorCopy forSetDescriptor:setDescriptorCopy atomicInstanceFilename:v42 error:&v116];
          v44 = v116;

          v23 = v44;
          if (v43)
          {
            [v96 addObject:v43];
          }

          else
          {
            if ([v44 code] == "/System/Library/PrivateFrameworks/MobileInBoxUpdate.framework/MobileInBoxUpdate")
            {
              v48 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v48, OS_LOG_TYPE_DEFAULT))
              {
                summary2 = [setDescriptorCopy summary];
                *buf = 138543874;
                v129 = descriptorCopy;
                v130 = 2114;
                *v131 = v39;
                *&v131[8] = 2114;
                *&v131[10] = summary2;
                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} unable to end SHORT-TERM locking (shared lock held) | nextAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
              }

              v23 = v44;
              v22 = v23;
              goto LABEL_39;
            }

            v45 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
            {
              summary3 = [setDescriptorCopy summary];
              checkedDescription = [v23 checkedDescription];
              *buf = 138544130;
              v129 = descriptorCopy;
              v130 = 2114;
              *v131 = v39;
              *&v131[8] = 2114;
              *&v131[10] = summary3;
              *&v131[18] = 2114;
              *&v131[20] = checkedDescription;
              _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} unable to end SHORT-TERM locking (considering as no shared locks) | nextAtomicInstance:%{public}@ | setDescriptor:%{public}@ | underlyingError:%{public}@", buf, 0x2Au);
            }
          }
        }

        v36 = [obj countByEnumeratingWithState:&v117 objects:v132 count:16];
        if (v36)
        {
          continue;
        }

        break;
      }
    }

    v22 = 0;
LABEL_39:

    v24 = 0;
    goto LABEL_40;
  }

LABEL_41:
  if (!v22)
  {
    clientDomainName5 = [v35 clientDomainName];
    assetSetIdentifier5 = [v35 assetSetIdentifier];
    v52 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName5 forAssetSetIdentifier:assetSetIdentifier5 forSetAtomicInstance:0];

    latestDownloadedAtomicInstance3 = [setDescriptorCopy latestDownloadedAtomicInstance];
    v91 = [SUCore stringIsEqual:latestDownloadedAtomicInstance3 to:v95];

    if (v91)
    {
      v90 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:descriptorCopy removingSharedLockFilename:v52 usingFileManager:v104 removingDescription:@"atomic-instance shared lock file (no other atomic-instance supporting SHORT-TERM locking)"];

      if (v105)
      {
        shortTermLockedLatestByIdentifier = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
        [shortTermLockedLatestByIdentifier removeObjectForKey:v105];

        v55 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
        {
          summary4 = [setDescriptorCopy summary];
          *buf = 138543874;
          v129 = descriptorCopy;
          v130 = 2114;
          *v131 = v105;
          *&v131[8] = 2114;
          *&v131[10] = summary4;
          _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{%{public}@} no longer supporting SHORT-TERM locking | shortTermLockedKey:%{public}@ | otherSetDescriptor:%{public}@", buf, 0x20u);
        }
      }
    }

    else
    {
      v90 = v23;
    }

    v22 = 0;
    v24 = 1;
    v35 = setDescriptorCopy;
    if (!setDescriptorCopy || !v105)
    {
      v23 = v90;
      goto LABEL_67;
    }

    v114 = 0u;
    v115 = 0u;
    v112 = 0u;
    v113 = 0u;
    v98 = v97;
    v57 = [v98 countByEnumeratingWithState:&v112 objects:v127 count:16];
    if (v57)
    {
      obja = *v113;
      do
      {
        v103 = v57;
        for (k = 0; k != v103; k = k + 1)
        {
          if (*v113 != obja)
          {
            objc_enumerationMutation(v98);
          }

          v59 = *(*(&v112 + 1) + 8 * k);
          clientDomainName6 = [v35 clientDomainName];
          assetSetIdentifier6 = [v35 assetSetIdentifier];
          v62 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6 forSetAtomicInstance:v59];

          clientDomainName7 = [setDescriptorCopy clientDomainName];
          assetSetIdentifier7 = [setDescriptorCopy assetSetIdentifier];
          v65 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName7 forAssetSetIdentifier:assetSetIdentifier7];

          shortTermLockedLatestByIdentifier2 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
          v67 = [shortTermLockedLatestByIdentifier2 safeObjectForKey:v105 ofClass:objc_opt_class()];

          v68 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:descriptorCopy removingSharedLockFilename:v62 usingFileManager:v104 removingDescription:@"atomic-instance shared lock file (just removed from supporting SHORT-TERM locking)"];
          [(MADAutoAssetControlManager *)self _shortTermChangeAtomicInstance:descriptorCopy forAtomicInstance:v59 toShortTermSupported:0];
          shortTermLockedByAtomicInstance3 = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
          [shortTermLockedByAtomicInstance3 removeObjectForKey:v59];

          if ([SUCore stringIsEqual:v59 to:v67])
          {
            shortTermLockedLatestByIdentifier3 = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
            [shortTermLockedLatestByIdentifier3 removeObjectForKey:v65];

            v71 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543618;
              v129 = descriptorCopy;
              v130 = 2114;
              *v131 = v65;
              _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][LATEST]{%{public}@} removed latest | shortTermLatestLockedKey:%{public}@", buf, 0x16u);
            }
          }

          v72 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v72, OS_LOG_TYPE_DEFAULT))
          {
            summary5 = [setDescriptorCopy summary];
            *buf = 138543874;
            v129 = descriptorCopy;
            v130 = 2114;
            *v131 = v59;
            *&v131[8] = 2114;
            *&v131[10] = summary5;
            _os_log_impl(&dword_0, v72, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][INSTANCE]{%{public}@} no longer supporting SHORT-TERM locking | atomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
          }

          v35 = setDescriptorCopy;
        }

        v57 = [v98 countByEnumeratingWithState:&v112 objects:v127 count:16];
      }

      while (v57);
    }

    v22 = 0;
    v24 = 1;
    v23 = v90;
    goto LABEL_65;
  }

  v91 = 0;
LABEL_67:
  v74 = v23;
  v110 = 0u;
  v111 = 0u;
  v108 = 0u;
  v109 = 0u;
  v75 = v96;
  v76 = [v75 countByEnumeratingWithState:&v108 objects:v126 count:16];
  if (v76)
  {
    v77 = *v109;
    do
    {
      for (m = 0; m != v76; m = m + 1)
      {
        if (*v109 != v77)
        {
          objc_enumerationMutation(v75);
        }

        [(MADAutoAssetControlManager *)self _shortTermSharedLockClose:descriptorCopy forSetDescriptor:v35 atomicInstanceFileDescriptor:*(*(&v108 + 1) + 8 * m)];
      }

      v76 = [v75 countByEnumeratingWithState:&v108 objects:v126 count:16];
    }

    while (v76);
  }

  v79 = v74;
  if (v91)
  {
    clientDomainName8 = [setDescriptorCopy clientDomainName];
    assetSetIdentifier8 = [setDescriptorCopy assetSetIdentifier];
    v82 = [MANAutoAssetSetStatus shortTermLockDirectory:clientDomainName8 forAssetSetIdentifier:assetSetIdentifier8];

    v83 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:descriptorCopy removingSharedLockFilename:v82 usingFileManager:v104 removingDescription:@"atomic-instance shared lock directory (no more SHORT-TERM locking support for the set-identifier)"];

    v79 = v83;
  }

LABEL_77:
  if (error)
  {
    v84 = v22;
    *error = v22;
  }

  if (v22)
  {
    v85 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v85, OS_LOG_TYPE_ERROR))
    {
      checkedDescription2 = [v22 checkedDescription];
      summary6 = [setDescriptorCopy summary];
      *buf = 138543874;
      v129 = descriptorCopy;
      v130 = 2114;
      *v131 = checkedDescription2;
      *&v131[8] = 2114;
      *&v131[10] = summary6;
      _os_log_impl(&dword_0, v85, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} ERROR removing SHORT-TERM locking | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
    }
  }

  else
  {
    v85 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v85, OS_LOG_TYPE_DEFAULT))
    {
      summary7 = [setDescriptorCopy summary];
      *buf = 138543618;
      v129 = descriptorCopy;
      v130 = 2114;
      *v131 = summary7;
      _os_log_impl(&dword_0, v85, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SUPPORT]{%{public}@} SUCCESS removing SHORT-TERM locking | setDescriptor:%{public}@", buf, 0x16u);
    }
  }

  os_activity_scope_leave(&state);
  return v24;
}

- (id)_shortTermSharedLockOpenExclusive:(id)exclusive forSetDescriptor:(id)descriptor atomicInstanceFilename:(id)filename error:(id *)error
{
  exclusiveCopy = exclusive;
  descriptorCopy = descriptor;
  filenameCopy = filename;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  exclusiveCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermSharedLockOpenExclusive", exclusiveCopy];
  v16 = open([filenameCopy UTF8String], 36);
  if ((v16 & 0x80000000) != 0)
  {
    filenameCopy = [[NSString alloc] initWithFormat:@"{%@} unable to obtain exclusive lock | errno:%d | atomicInstanceFilename:%@", exclusiveCopy, *__error(), filenameCopy];
    v18 = [(MADAutoAssetControlManager *)self buildShortTermLockError:exclusiveCopy code:6584 description:filenameCopy forSetDescriptor:descriptorCopy underlyingError:0];

    if (!v18)
    {
      goto LABEL_4;
    }
  }

  else
  {
    v17 = [[NSNumber alloc] initWithInteger:v16];
    if (v17)
    {
LABEL_5:
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        summary = [descriptorCopy summary];
        *buf = 138544130;
        v27 = exclusiveCopy;
        v28 = 1024;
        v29 = v16;
        v30 = 2114;
        v31 = filenameCopy;
        v32 = 2114;
        v33 = summary;
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@} SUCCESS(%d) | atomicInstanceFilename:%{public}@ | setDescriptor:%{public}@", buf, 0x26u);
      }

      v18 = 0;
      goto LABEL_12;
    }

    [(MADAutoAssetControlManager *)self _shortTermSharedLockClose:exclusiveCopy forSetDescriptor:descriptorCopy atomicInstanceFileDescriptor:0];
    v18 = [(MADAutoAssetControlManager *)self buildShortTermLockError:exclusiveCopy code:6584 description:@"insufficient memory to perform removal" forSetDescriptor:descriptorCopy underlyingError:0];
    if (!v18)
    {
LABEL_4:
      v17 = 0;
      goto LABEL_5;
    }
  }

  v19 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
  {
    checkedDescription = [v18 checkedDescription];
    summary2 = [descriptorCopy summary];
    *buf = 138544386;
    v27 = exclusiveCopy;
    v28 = 1024;
    v29 = v16;
    v30 = 2114;
    v31 = filenameCopy;
    v32 = 2114;
    v33 = checkedDescription;
    v34 = 2114;
    v35 = summary2;
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@} ERROR(%d) | atomicInstanceFilename:%{public}@ | returnedError:%{public}@ | setDescriptor:%{public}@", buf, 0x30u);
  }

  v17 = 0;
LABEL_12:

  if (error)
  {
    v24 = v18;
    *error = v18;
  }

  return v17;
}

- (void)_shortTermSharedLockClose:(id)close forSetDescriptor:(id)descriptor atomicInstanceFileDescriptor:(id)fileDescriptor
{
  closeCopy = close;
  descriptorCopy = descriptor;
  fileDescriptorCopy = fileDescriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  intValue = [fileDescriptorCopy intValue];
  if (close(intValue))
  {
    v14 = *__error();
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
    {
      summary = [descriptorCopy summary];
      v21 = 138544130;
      v22 = closeCopy;
      v23 = 1024;
      v24 = intValue;
      v25 = 1024;
      LODWORD(v26[0]) = v14;
      WORD2(v26[0]) = 2114;
      *(v26 + 6) = summary;
      v17 = "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@:_shortTermSharedLockClose} ERROR(%d) | errno:%d | setDescriptor:%{public}@";
      v18 = v15;
      v19 = OS_LOG_TYPE_ERROR;
      v20 = 34;
LABEL_6:
      _os_log_impl(&dword_0, v18, v19, v17, &v21, v20);
    }
  }

  else
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      summary = [descriptorCopy summary];
      v21 = 138543874;
      v22 = closeCopy;
      v23 = 1024;
      v24 = intValue;
      v25 = 2114;
      v26[0] = summary;
      v17 = "[AUTO-SHORT-TERM][EXCLUSIVE]{%{public}@:_shortTermSharedLockClose} SUCCESS(%d) | setDescriptor:%{public}@";
      v18 = v15;
      v19 = OS_LOG_TYPE_DEFAULT;
      v20 = 28;
      goto LABEL_6;
    }
  }
}

- (id)_shortTermCreateSymbolicLink:(id)link symbolicLinkFilename:(id)filename linkedToFilename:(id)toFilename forSetDescriptor:(id)descriptor usingFileManager:(id)manager
{
  linkCopy = link;
  filenameCopy = filename;
  toFilenameCopy = toFilename;
  descriptorCopy = descriptor;
  managerCopy = manager;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v55 = 0;
  linkCopy = [managerCopy destinationOfSymbolicLinkAtPath:filenameCopy error:&v55];
  v20 = v55;
  v21 = v20;
  if (!linkCopy)
  {
    if (v20 && [v20 code] != &stru_B8.reserved3)
    {
      linkCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
      filenameCopy = [[NSString alloc] initWithFormat:@"Failed to get information about current symbolic link for SHORT-TERM locking latest %@", filenameCopy];
      v23 = [(MADAutoAssetControlManager *)selfCopy buildShortTermLockError:linkCopy code:6583 description:filenameCopy forSetDescriptor:descriptorCopy underlyingError:v21];
      goto LABEL_33;
    }

    v24 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v57 = linkCopy;
      _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} No SHORT-TERM locking latest symlink exists yet. Creating", buf, 0xCu);
    }

    v54 = 0;
    v25 = [managerCopy createSymbolicLinkAtPath:filenameCopy withDestinationPath:toFilenameCopy error:&v54];
    v21 = v54;
    if (v25)
    {
      goto LABEL_21;
    }

    v26 = linkCopy;
    v27 = descriptorCopy;
    linkCopy2 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
    toFilenameCopy = [[NSString alloc] initWithFormat:@"Unable to create symbolic link for SHORT-TERM locking latest | %@ >=> %@", filenameCopy, toFilenameCopy];
    v50 = v27;
    v30 = [(MADAutoAssetControlManager *)selfCopy buildShortTermLockError:linkCopy2 code:6583 description:toFilenameCopy forSetDescriptor:v27 underlyingError:v21];
    goto LABEL_19;
  }

  if (![SUCore stringIsEqual:linkCopy to:toFilenameCopy])
  {
    v50 = descriptorCopy;

    v31 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543874;
      v57 = linkCopy;
      v58 = 2114;
      v59 = linkCopy;
      v60 = 2114;
      v61 = toFilenameCopy;
      _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} latest symlink currently pointed to target: %{public}@, but it is not the requested target: %{public}@.  Updating symlink.", buf, 0x20u);
    }

    stringByDeletingLastPathComponent = [filenameCopy stringByDeletingLastPathComponent];
    linkCopy2 = [stringByDeletingLastPathComponent stringByAppendingPathComponent:@"tmpSymlink"];

    v53 = 0;
    LOBYTE(stringByDeletingLastPathComponent) = [managerCopy createSymbolicLinkAtPath:linkCopy2 withDestinationPath:toFilenameCopy error:&v53];
    v21 = v53;
    if (stringByDeletingLastPathComponent)
    {
      uTF8String = [linkCopy2 UTF8String];
      uTF8String2 = [filenameCopy UTF8String];
      rename(uTF8String, uTF8String2, v35);
      if (!v36)
      {
        v30 = 0;
LABEL_20:

        descriptorCopy = v50;
        if (v30)
        {
LABEL_32:
          v23 = v30;
          filenameCopy = linkCopy;
          linkCopy = v23;
          goto LABEL_33;
        }

LABEL_21:

        v52 = 0;
        linkCopy = [managerCopy destinationOfSymbolicLinkAtPath:filenameCopy error:&v52];
        v21 = v52;
        if (v21 || !linkCopy)
        {
          v46 = descriptorCopy;
          linkCopy3 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
          toFilenameCopy2 = [[NSString alloc] initWithFormat:@"After SHORT-TERM locking latest symlink is created, failed to get the destination. %@ >=> %@", filenameCopy, toFilenameCopy];
          v43 = v46;
          v30 = [(MADAutoAssetControlManager *)selfCopy buildShortTermLockError:linkCopy3 code:6583 description:toFilenameCopy2 forSetDescriptor:v46 underlyingError:v21];
        }

        else
        {
          v43 = descriptorCopy;
          if ([SUCore stringIsEqual:linkCopy to:toFilenameCopy])
          {
            linkCopy3 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(linkCopy3, OS_LOG_TYPE_DEFAULT))
            {
              summary = [v43 summary];
              *buf = 138544130;
              v57 = linkCopy;
              v58 = 2114;
              v59 = filenameCopy;
              v60 = 2114;
              v61 = toFilenameCopy;
              v62 = 2114;
              v63 = summary;
              _os_log_impl(&dword_0, linkCopy3, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} created SHORT-TERM locking symlink | %{public}@ >=> %{public}@ | setDescriptor:%{public}@", buf, 0x2Au);
            }

            v30 = 0;
          }

          else
          {
            linkCopy3 = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
            v48 = [[NSString alloc] initWithFormat:@"After SHORT-TERM locking latest symlink is created, target is not the expected destination. Expected destination: %@. Current destination: %@", toFilenameCopy, linkCopy];
            v30 = [(MADAutoAssetControlManager *)selfCopy buildShortTermLockError:linkCopy3 code:6583 description:v48 forSetDescriptor:v43 underlyingError:0];
          }

          v21 = 0;
        }

        descriptorCopy = v43;
        goto LABEL_32;
      }

      v26 = linkCopy;
      toFilenameCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
      v37 = [[NSString alloc] initWithFormat:@"Failed to rename temporary symbolic link for SHORT-TERM locking to final name %@ >=> %@.  Errno: %d", linkCopy2, filenameCopy, *__error()];
      v39 = v50;
      v38 = selfCopy;
      v40 = toFilenameCopy;
      v41 = v37;
      v42 = 0;
    }

    else
    {
      v26 = linkCopy;
      toFilenameCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermCreateSymbolicLink", linkCopy];
      v37 = [[NSString alloc] initWithFormat:@"Unable to create temporary symbolic link for SHORT-TERM locking latest %@", linkCopy2];
      v39 = v50;
      v38 = selfCopy;
      v40 = toFilenameCopy;
      v41 = v37;
      v42 = v21;
    }

    v30 = [(MADAutoAssetControlManager *)v38 buildShortTermLockError:v40 code:6583 description:v41 forSetDescriptor:v39 underlyingError:v42];

LABEL_19:
    linkCopy = v26;
    goto LABEL_20;
  }

  filenameCopy = _MADLog(@"AutoControl");
  if (os_log_type_enabled(filenameCopy, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543618;
    v57 = linkCopy;
    v58 = 2114;
    v59 = toFilenameCopy;
    _os_log_impl(&dword_0, filenameCopy, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][SYMLINK]{%{public}@:_shortTermCreateSymbolicLink} latest symlink already pointed to requested target file: %{public}@.  No change needed", buf, 0x16u);
  }

  v23 = 0;
LABEL_33:

  return v23;
}

- (id)_shortTermPersistSetStatus:(id)status forSetDescriptor:(id)descriptor persistingSetStatus:(id)setStatus toFilename:(id)filename
{
  statusCopy = status;
  descriptorCopy = descriptor;
  setStatusCopy = setStatus;
  filenameCopy = filename;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MASAutoAssetSetStatus newShimmedToFramework:setStatusCopy];
  if (!v16)
  {
    statusCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", statusCopy];
    v24 = [NSString alloc];
    summary = [setStatusCopy summary];
    v26 = [v24 initWithFormat:@"unable to create shimmed set-status to write to shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", filenameCopy, summary];
    v27 = [(MADAutoAssetControlManager *)self buildShortTermLockError:statusCopy code:6583 description:v26 forSetDescriptor:descriptorCopy underlyingError:0];

    goto LABEL_14;
  }

  v17 = [SUCorePersistedState alloc];
  v18 = objc_opt_respondsToSelector();

  v19 = [SUCorePersistedState alloc];
  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
  if (v18)
  {
    v22 = [v19 initWithDispatchQueue:extendedStateQueue2 withPersistencePath:filenameCopy forPolicyVersion:@"1.0" issuingDefaultLevelLogging:0];
  }

  else
  {
    v22 = [v19 initWithDispatchQueue:extendedStateQueue2 withPersistencePath:filenameCopy forPolicyVersion:@"1.0"];
  }

  statusCopy = v22;

  if (!statusCopy)
  {
    statusCopy2 = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", statusCopy];
    v32 = [NSString alloc];
    summary2 = [setStatusCopy summary];
    v34 = [v32 initWithFormat:@"unable to create persisted-state for shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", filenameCopy, summary2];
LABEL_13:
    v36 = v34;
    v27 = [(MADAutoAssetControlManager *)self buildShortTermLockError:statusCopy2 code:6583 description:v34 forSetDescriptor:descriptorCopy underlyingError:0];

    goto LABEL_14;
  }

  if (![statusCopy loadPersistedState])
  {
    statusCopy2 = [[NSString alloc] initWithFormat:@"%@:_shortTermPersistSetStatus", statusCopy];
    v35 = [NSString alloc];
    summary2 = [setStatusCopy summary];
    v34 = [v35 initWithFormat:@"unable to load persisted-state for shared lock file | atomicInstanceFilename:%@ | firstLockedSetStatus:%@", filenameCopy, summary2];
    goto LABEL_13;
  }

  [statusCopy persistString:@"SHORT-TERM" forKey:@"lockerType" shouldPersist:0];
  [statusCopy persistSecureCodedObject:v16 forKey:@"sharedLockSetStatus" shouldPersist:1];
  v28 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
  {
    summary3 = [descriptorCopy summary];
    summary4 = [setStatusCopy summary];
    *buf = 138544130;
    v39 = statusCopy;
    v40 = 2114;
    v41 = filenameCopy;
    v42 = 2114;
    v43 = summary3;
    v44 = 2114;
    v45 = summary4;
    _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM][FILE]{%{public}@} attempted to persist SHORT-TERM atomic-instance file | filename:%{public}@ | setDescriptor:%{public}@ | setStatus:%{public}@ ", buf, 0x2Au);
  }

  v27 = 0;
LABEL_14:

  return v27;
}

- (id)_shortTermSharedLockRemove:(id)remove removingSharedLockFilename:(id)filename usingFileManager:(id)manager removingDescription:(id)description
{
  removeCopy = remove;
  filenameCopy = filename;
  descriptionCopy = description;
  managerCopy = manager;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v24 = 0;
  [managerCopy removeItemAtPath:filenameCopy error:&v24];

  v16 = v24;
  v17 = v16;
  if (!v16)
  {
    v19 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
    {
      goto LABEL_10;
    }

    *buf = 138543874;
    v26 = removeCopy;
    v27 = 2114;
    v28 = descriptionCopy;
    v29 = 2114;
    v30 = filenameCopy;
    v21 = "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} removed %{public}@ | sharedLockFilename:%{public}@";
    goto LABEL_7;
  }

  code = [v16 code];
  v19 = _MADLog(@"AutoControl");
  v20 = os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT);
  if (code == &dword_0 + 2)
  {
    if (!v20)
    {
      goto LABEL_10;
    }

    *buf = 138543874;
    v26 = removeCopy;
    v27 = 2114;
    v28 = descriptionCopy;
    v29 = 2114;
    v30 = filenameCopy;
    v21 = "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} attempted to remove %{public}@ [did not exist] | sharedLockFilename:%{public}@";
LABEL_7:
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, v21, buf, 0x20u);
    goto LABEL_10;
  }

  if (v20)
  {
    checkedDescription = [v17 checkedDescription];
    *buf = 138544130;
    v26 = removeCopy;
    v27 = 2114;
    v28 = descriptionCopy;
    v29 = 2114;
    v30 = filenameCopy;
    v31 = 2114;
    v32 = checkedDescription;
    _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[AUTO-SHORT-TERM]{%{public}@:_shortTermSharedLockRemove} WARNING unable to remove %{public}@ | sharedLockFilename:%{public}@ | removeError:%{public}@", buf, 0x2Au);
  }

LABEL_10:

  return v17;
}

- (void)_shortTermChangeAtomicInstance:(id)instance forAtomicInstance:(id)atomicInstance toShortTermSupported:(BOOL)supported
{
  supportedCopy = supported;
  atomicInstanceCopy = atomicInstance;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  instanceCopy = [[NSString alloc] initWithFormat:@"%@:_shortTermChangeAtomicInstance", instanceCopy];
  if (atomicInstanceCopy)
  {
    v13 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:atomicInstanceCopy];
    if (v13)
    {
      v14 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v13];
      persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [persistedKnownSetAtomicInstances persistedEntry:v14 fromLocation:instanceCopy];

      if (v16)
      {
        [v13 setLockedSupportingShortTermLocking:supportedCopy];
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        atomicInstanceUUID = [v13 atomicInstanceUUID];
        [knownSetAtomicInstancesByInstance setSafeObject:v13 forKey:atomicInstanceUUID];

        [v16 persistSecureCodedObject:v13 forKey:@"setAtomicInstance"];
        persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        summary = [v13 summary];
        [persistedKnownSetAtomicInstances2 storePersistedEntry:v14 withEntrySummary:summary fromLocation:instanceCopy];

        v21 = [NSString alloc];
        if (supportedCopy)
        {
          v22 = @"Y";
        }

        else
        {
          v22 = @"N";
        }

        summary2 = [v13 summary];
        v24 = [v21 initWithFormat:@"SHORT-TERM behavior change | supportingShortTermLocking:%@ | setAtomicInstance:%@", v22, summary2];
        [(MADAutoAssetControlManager *)self _logPersistedSetAtomicInstance:instanceCopy operation:@"ENTRY_MODIFY" forPersistedEntryID:v14 withSetAtomicInstance:v13 message:v24];
      }

      else
      {
        v25 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v27 = instanceCopy;
          v28 = 2114;
          v29 = atomicInstanceCopy;
          _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} WARNING unable to load atomic-instance persisted-state entry | atomicInstance:%{public}@", buf, 0x16u);
        }
      }
    }

    else
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543618;
        v27 = instanceCopy;
        v28 = 2114;
        v29 = atomicInstanceCopy;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} no atomic-instance tracked | atomicInstance:%{public}@", buf, 0x16u);
      }
    }
  }

  else
  {
    v13 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      *buf = 138543362;
      v27 = instanceCopy;
      _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "[AUTO-SHORT-TERM]{%{public}@} no atomic-instance provided", buf, 0xCu);
    }
  }
}

- (void)_shortTermForceForget:(id)forget forSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance)
  {
    shortTermLockedByAtomicInstance = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    [shortTermLockedByAtomicInstance removeObjectForKey:latestDownloadedAtomicInstance2];
  }

  if (v9)
  {
    shortTermLockedLatestByIdentifier = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
    [shortTermLockedLatestByIdentifier removeObjectForKey:v9];
  }
}

- (id)buildShortTermLockError:(id)error code:(int64_t)code description:(id)description forSetDescriptor:(id)descriptor underlyingError:(id)underlyingError
{
  descriptionCopy = description;
  underlyingErrorCopy = underlyingError;
  descriptorCopy = descriptor;
  errorCopy = error;
  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  v14 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName forAssetSetIdentifier:assetSetIdentifier forSetAtomicInstance:0];

  clientDomainName2 = [descriptorCopy clientDomainName];
  assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  v18 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forSetAtomicInstance:latestDownloadedAtomicInstance];

  latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
  v20 = [(MADAutoAssetControlManager *)self locateSetStatusByInstance:latestDownloadedAtomicInstance2];

  v21 = [NSString alloc];
  summary = [descriptorCopy summary];

  summary2 = @"N";
  if (v18)
  {
    v24 = v18;
  }

  else
  {
    v24 = @"N";
  }

  if (v14)
  {
    v25 = @"Y";
  }

  else
  {
    v25 = @"N";
  }

  if (v20)
  {
    summary2 = [v20 summary];
  }

  if (underlyingErrorCopy)
  {
    checkedDescription = [underlyingErrorCopy checkedDescription];
  }

  else
  {
    checkedDescription = @"N";
  }

  v27 = [v21 initWithFormat:@"%@ | setDescriptor:%@ | atomicInstanceFilename:%@ | latest:%@ | setDescriptorCurrentStatus:%@ | error:%@", descriptionCopy, summary, v24, v25, summary2, checkedDescription];
  v28 = [MAAutoAssetError buildError:code fromOperation:errorCopy underlyingError:underlyingErrorCopy withDescription:v27];

  if (underlyingErrorCopy)
  {
  }

  if (v20)
  {
  }

  return v28;
}

- (BOOL)isShortTermLockableSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];

  if (latestDownloadedAtomicInstance)
  {
    shortTermLockedByAtomicInstance = [(MADAutoAssetControlManager *)self shortTermLockedByAtomicInstance];
    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    v10 = [shortTermLockedByAtomicInstance safeObjectForKey:latestDownloadedAtomicInstance2 ofClass:objc_opt_class()];

    v11 = v10 != 0;
  }

  else
  {
    v11 = 0;
  }

  return v11;
}

- (id)latestShortTermLockableAtomicInstanceForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:domainCopy forAssetSetIdentifier:identifierCopy];
  shortTermLockedLatestByIdentifier = [(MADAutoAssetControlManager *)self shortTermLockedLatestByIdentifier];
  v12 = [shortTermLockedLatestByIdentifier safeObjectForKey:v10 ofClass:objc_opt_class()];

  return v12;
}

- (id)newSetInfoLimitedToCheckInformation:(id)information forAssetSetIdentifier:(id)identifier fromSetInfoFound:(id)found
{
  informationCopy = information;
  identifierCopy = identifier;
  foundCopy = found;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v67 = identifierCopy;
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:informationCopy forAssetSetIdentifier:identifierCopy];
  latestAtomicInstanceToVend = [v13 latestAtomicInstanceToVend];

  if (latestAtomicInstanceToVend)
  {
    latestAtomicInstanceToVend2 = [v13 latestAtomicInstanceToVend];
    v16 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"newSetInfoLimitedToCheckInformation" forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

    v17 = v16 != 0;
  }

  else
  {
    v17 = 0;
  }

  v49 = [MANAutoAssetSetStatus alloc];
  currentSetStatus = [foundCopy currentSetStatus];
  configuredAssetEntries = [currentSetStatus configuredAssetEntries];
  currentSetStatus2 = [foundCopy currentSetStatus];
  atomicInstancesDownloaded = [currentSetStatus2 atomicInstancesDownloaded];
  mostRecentlyReceivedCachedAssetSetID = [v13 mostRecentlyReceivedCachedAssetSetID];
  mostRecentlyReceivedDownloadedFromLive = [v13 mostRecentlyReceivedDownloadedFromLive];
  mostRecentlyReceivedLastTimeChecked = [v13 mostRecentlyReceivedLastTimeChecked];
  mostRecentlyReceivedPostedDate = [v13 mostRecentlyReceivedPostedDate];
  currentSetStatus3 = [foundCopy currentSetStatus];
  newerAtomicInstanceDiscovered = [currentSetStatus3 newerAtomicInstanceDiscovered];
  currentSetStatus4 = [foundCopy currentSetStatus];
  newerDiscoveredAtomicEntries = [currentSetStatus4 newerDiscoveredAtomicEntries];
  v59 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:?];
  v66 = configuredAssetEntries;
  if (v17)
  {
    currentSetStatus5 = [foundCopy currentSetStatus];
    latestDownloadedAtomicInstance = [currentSetStatus5 latestDownloadedAtomicInstance];
    latestAtomicInstanceToVendFromPreSUStaging = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    currentSetStatus6 = [foundCopy currentSetStatus];
    latestDowloadedAtomicInstanceEntries = [currentSetStatus6 latestDowloadedAtomicInstanceEntries];
    v56 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:?];
  }

  else
  {
    latestAtomicInstanceToVendFromPreSUStaging = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    v56 = 0;
    latestDownloadedAtomicInstance = 0;
  }

  latestToVendCachedAssetSetID = [v13 latestToVendCachedAssetSetID];
  latestToVendDownloadedFromLive = [v13 latestToVendDownloadedFromLive];
  latestToVendLastTimeChecked = [v13 latestToVendLastTimeChecked];
  latestToVendPostedDate = [v13 latestToVendPostedDate];
  currentSetStatus7 = [foundCopy currentSetStatus];
  currentNotifications = [currentSetStatus7 currentNotifications];
  v39 = [MADAutoAssetScheduler newSetPolicyForDomainName:informationCopy forAssetSetIdentifier:v67];
  v38 = +[MADAutoAssetControlManager stagerSetPolicy];
  haveReceivedLookupResponse = [v13 haveReceivedLookupResponse];
  vendingAtomicInstanceForConfiguredEntries = [v13 vendingAtomicInstanceForConfiguredEntries];
  currentSetStatus8 = [foundCopy currentSetStatus];
  downloadUserInitiated = [currentSetStatus8 downloadUserInitiated];
  currentSetStatus9 = [foundCopy currentSetStatus];
  downloadProgress = [currentSetStatus9 downloadProgress];
  currentSetStatus10 = [foundCopy currentSetStatus];
  downloadedNetworkBytes = [currentSetStatus10 downloadedNetworkBytes];
  currentSetStatus11 = [foundCopy currentSetStatus];
  downloadedFilesystemBytes = [currentSetStatus11 downloadedFilesystemBytes];
  v55 = foundCopy;
  currentSetStatus12 = [foundCopy currentSetStatus];
  currentLockUsage = [currentSetStatus12 currentLockUsage];
  availableForUseError = [v13 availableForUseError];
  newerVersionError = [v13 newerVersionError];
  BYTE2(v28) = downloadUserInitiated;
  BYTE1(v28) = vendingAtomicInstanceForConfiguredEntries;
  LOBYTE(v28) = haveReceivedLookupResponse;
  LOBYTE(v27) = latestAtomicInstanceToVendFromPreSUStaging;
  v48 = [MANAutoAssetSetStatus initStatusForClientDomain:v49 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:mostRecentlyReceivedLastTimeChecked withAtomicInstancesDownloaded:mostRecentlyReceivedPostedDate withCatalogCachedAssetSetID:newerAtomicInstanceDiscovered withCatalogDownloadedFromLive:v59 withCatalogLastTimeChecked:latestDownloadedAtomicInstance withCatalogPostedDate:v27 withNewerAtomicInstanceDiscovered:v56 withNewerDiscoveredAtomicEntries:latestToVendCachedAssetSetID withLatestDownloadedAtomicInstance:latestToVendDownloadedFromLive withLatestDownloadedAtomicInstanceFromPreSUStaging:latestToVendLastTimeChecked withLatestDowloadedAtomicInstanceEntries:latestToVendPostedDate withDownloadedCatalogCachedAssetSetID:currentNotifications withDownloadedCatalogDownloadedFromLive:0 withDownloadedCatalogLastTimeChecked:v39 withDownloadedCatalogPostedDate:v38 withCurrentNotifications:v28 withCurrentNeedPolicy:downloadProgress withSchedulerPolicy:downloadedNetworkBytes withStagerPolicy:downloadedFilesystemBytes havingReceivedLookupResponse:currentLockUsage vendingAtomicInstanceForConfiguredEntries:0 withDownloadUserInitiated:availableForUseError withDownloadProgress:newerVersionError withDownloadedNetworkBytes:? withDownloadedFilesystemBytes:? withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];

  if (v17)
  {
  }

  v25 = [[MANAutoAssetSetInfoFound alloc] initForAssetSetIdentifier:v67 reportingStatus:v48];
  return v25;
}

- (id)setDescriptorNewEntryIDForDownloaded:(id)downloaded
{
  downloadedCopy = downloaded;
  clientDomainName = [downloadedCopy clientDomainName];
  assetSetIdentifier = [downloadedCopy assetSetIdentifier];
  latestDownloadedAtomicInstance = [downloadedCopy latestDownloadedAtomicInstance];

  v8 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier ofAtomicInstance:latestDownloadedAtomicInstance];

  return v8;
}

- (id)newSetDescriptorLimitedToCheckInformation:(id)information
{
  if (!information)
  {
    return 0;
  }

  informationCopy = information;
  v5 = [informationCopy copy];
  discoveredAtomicEntries = [informationCopy discoveredAtomicEntries];
  v7 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:discoveredAtomicEntries];
  [v5 setDiscoveredAtomicEntries:v7];

  latestDowloadedAtomicInstanceEntries = [informationCopy latestDowloadedAtomicInstanceEntries];

  v9 = [(MADAutoAssetControlManager *)self _limitToCheckAtomicEntries:latestDowloadedAtomicInstanceEntries];
  [v5 setLatestDowloadedAtomicInstanceEntries:v9];

  return v5;
}

- (void)setDescriptorEliminateMatching:(id)matching forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier eliminatingSetIdentifer:(BOOL)identifer
{
  context = identifer;
  matchingCopy = matching;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v95 = matchingCopy;
  matchingCopy = [[NSString alloc] initWithFormat:@"%@:setDescriptorEliminateMatching", matchingCopy];
  v15 = objc_alloc_init(NSMutableArray);
  v94 = +[NSFileManager defaultManager];
  v83 = identifierCopy;
  v84 = nameCopy;
  v16 = identifierCopy;
  v17 = matchingCopy;
  v18 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:nameCopy assetSetIdentifier:v16];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:matchingCopy ofContainer:@"setDescriptorKeysForAssetSet"];
  v111 = 0u;
  v112 = 0u;
  v109 = 0u;
  v110 = 0u;
  obj = v18;
  v19 = [obj countByEnumeratingWithState:&v109 objects:v122 count:16];
  if (v19)
  {
    v20 = v19;
    v21 = *v110;
    do
    {
      for (i = 0; i != v20; i = i + 1)
      {
        if (*v110 != v21)
        {
          objc_enumerationMutation(obj);
        }

        v23 = *(*(&v109 + 1) + 8 * i);
        v24 = objc_autoreleasePoolPush();
        v25 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:v17 forKey:v23];
        if (v25)
        {
          [v15 addObject:v25];
        }

        objc_autoreleasePoolPop(v24);
      }

      v20 = [obj countByEnumeratingWithState:&v109 objects:v122 count:16];
    }

    while (v20);
  }

  v93 = v17;

  v107 = 0u;
  v108 = 0u;
  v105 = 0u;
  v106 = 0u;
  v86 = v15;
  v26 = [v86 countByEnumeratingWithState:&v105 objects:v121 count:16];
  selfCopy = self;
  if (v26)
  {
    v27 = v26;
    v28 = *v106;
    do
    {
      for (j = 0; j != v27; j = j + 1)
      {
        if (*v106 != v28)
        {
          objc_enumerationMutation(v86);
        }

        v30 = *(*(&v105 + 1) + 8 * j);
        latestDownloadedAtomicInstance = [v30 latestDownloadedAtomicInstance];
        if (latestDownloadedAtomicInstance)
        {
          [v30 latestDownloadedAtomicInstance];
        }

        else
        {
          [v30 discoveredAtomicInstance];
        }
        v32 = ;

        clientDomainName = [v30 clientDomainName];
        assetSetIdentifier = [v30 assetSetIdentifier];
        v35 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName forAssetSetIdentifier:assetSetIdentifier forSetAtomicInstance:v32];

        self = selfCopy;
        [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorDownloaded:v30 fromLocation:v95 checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:327 historyOperationSD:371];
        v36 = [(MADAutoAssetControlManager *)selfCopy _shortTermSharedLockRemove:@"setDescriptorEliminateMatching" removingSharedLockFilename:v35 usingFileManager:v94 removingDescription:@"atomic-instance shared lock removed (eliminated set-identifier)"];
      }

      v27 = [v86 countByEnumeratingWithState:&v105 objects:v121 count:16];
    }

    while (v27);
  }

  v37 = v93;
  if (!context)
  {
    goto LABEL_62;
  }

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v39 = [persistedDownloadedSetDescriptors persistedEntryIDs:@"setDescriptorEliminate"];

  if (![v39 count])
  {
    goto LABEL_61;
  }

  v88 = objc_alloc_init(NSMutableArray);
  v101 = 0u;
  v102 = 0u;
  v103 = 0u;
  v104 = 0u;
  v80 = v39;
  contexta = v39;
  v40 = [contexta countByEnumeratingWithState:&v101 objects:v120 count:16];
  if (v40)
  {
    v41 = v40;
    v42 = *v102;
    v81 = *v102;
    do
    {
      v43 = 0;
      v85 = v41;
      do
      {
        if (*v102 != v42)
        {
          objc_enumerationMutation(contexta);
        }

        v44 = *(*(&v101 + 1) + 8 * v43);
        v45 = objc_autoreleasePoolPush();
        if (v44)
        {
          persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          v47 = [persistedDownloadedSetDescriptors2 persistedEntry:v44 fromLocation:v93];

          if (v47)
          {
            persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v49 = [persistedDownloadedSetDescriptors3 decodeFromLocation:v93 ofEntryName:v44 fromPersistedEntry:v47 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v49)
            {
              clientDomainName2 = [v49 clientDomainName];
              if (([SUCore stringIsEqual:clientDomainName2 to:v84]& 1) != 0)
              {
                assetSetIdentifier2 = [v49 assetSetIdentifier];
                v52 = [SUCore stringIsEqual:assetSetIdentifier2 to:v83];

                self = selfCopy;
                if (v52)
                {
                  v53 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
                  {
                    *buf = 138543874;
                    v115 = v93;
                    v116 = 2114;
                    v117 = v84;
                    v118 = 2114;
                    v119 = v83;
                    v54 = v53;
                    v55 = OS_LOG_TYPE_DEFAULT;
                    v56 = "\n[SET-ELIMINATE]{%{public}@} matched set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@";
                    goto LABEL_41;
                  }

                  goto LABEL_42;
                }
              }

              else
              {
              }
            }

            else
            {
              v53 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543874;
                v115 = v93;
                v116 = 2114;
                v117 = v84;
                v118 = 2114;
                v119 = v83;
                v54 = v53;
                v55 = OS_LOG_TYPE_ERROR;
                v56 = "\n[SET-ELIMINATE]{%{public}@} unable to load set-descriptor | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@";
LABEL_41:
                _os_log_impl(&dword_0, v54, v55, v56, buf, 0x20u);
              }

LABEL_42:

              [v88 addObject:v44];
            }

            v42 = v81;
            v41 = v85;
            goto LABEL_45;
          }

          v57 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543874;
            v115 = v93;
            v116 = 2114;
            v117 = v84;
            v118 = 2114;
            v119 = v83;
            _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} unable to load persisted entry | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
          }

          [v88 addObject:v44];
        }

        else
        {
          v47 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543874;
            v115 = v93;
            v116 = 2114;
            v117 = v84;
            v118 = 2114;
            v119 = v83;
            _os_log_impl(&dword_0, v47, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@:} no entryID | clientDomainName:%{public}@ | assetSetIdentifier:%{public}@", buf, 0x20u);
          }
        }

LABEL_45:

        objc_autoreleasePoolPop(v45);
        v43 = v43 + 1;
      }

      while (v41 != v43);
      v41 = [contexta countByEnumeratingWithState:&v101 objects:v120 count:16];
    }

    while (v41);
  }

  v99 = 0u;
  v100 = 0u;
  v97 = 0u;
  v98 = 0u;
  v82 = v88;
  v58 = [v82 countByEnumeratingWithState:&v97 objects:v113 count:16];
  v37 = v93;
  if (!v58)
  {
    goto LABEL_60;
  }

  v59 = v58;
  v60 = *v98;
  do
  {
    for (k = 0; k != v59; k = k + 1)
    {
      if (*v98 != v60)
      {
        objc_enumerationMutation(v82);
      }

      v62 = *(*(&v97 + 1) + 8 * k);
      contextb = objc_autoreleasePoolPush();
      persistedDownloadedSetDescriptors4 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v64 = [persistedDownloadedSetDescriptors4 persistedEntry:v62 fromLocation:v37];

      persistedDownloadedSetDescriptors5 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v89 = v64;
      v66 = [persistedDownloadedSetDescriptors5 decodeFromLocation:v37 ofEntryName:v62 fromPersistedEntry:v64 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (v66)
      {
        latestDownloadedAtomicInstance2 = [v66 latestDownloadedAtomicInstance];

        if (latestDownloadedAtomicInstance2)
        {
          persistedDownloadedSetDescriptors6 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
          [persistedDownloadedSetDescriptors6 removePersistedEntry:v62 fromLocation:v37];

          latestDowloadedAtomicInstanceEntries = [v66 latestDowloadedAtomicInstanceEntries];
          v70 = [latestDowloadedAtomicInstanceEntries count];
          clientDomainName3 = [v66 clientDomainName];
          assetSetIdentifier3 = [v66 assetSetIdentifier];
          [v66 discoveredAtomicInstance];
          v73 = v60;
          v75 = v74 = v59;
          [MADAutoAssetHistory recordOperation:377 toHistoryType:2 fromLayer:1 usageCount:v70 forClientDomainName:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3 forAtomicInstance:v75];

          v59 = v74;
          v60 = v73;

          v37 = v93;
          self = selfCopy;
          [(MADAutoAssetControlManager *)selfCopy _logPersistedSetDescriptorRemoved:v93 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v62 removedSetDescriptor:v66 message:@"removing previously persisted downloaded-set-descriptor that has been eliminated"];
          goto LABEL_58;
        }

        v76 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
      }

      else
      {
        v76 = @"EntryID: %@. descriptor to be dropped is nil";
      }

      v77 = [[NSString alloc] initWithFormat:v76, v62];
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      [diag trackAnomaly:@"setDescriptorEliminateMatching" forReason:v77 withResult:6101 withError:0];

      v37 = v93;
LABEL_58:

      objc_autoreleasePoolPop(contextb);
    }

    v59 = [v82 countByEnumeratingWithState:&v97 objects:v113 count:16];
  }

  while (v59);
LABEL_60:

  v39 = v80;
LABEL_61:

LABEL_62:
}

- (id)_limitSetAtomicEntries:(id)entries fromSetDescriptor:(id)descriptor requestedAutoAssetEntries:(id)assetEntries
{
  descriptorCopy = descriptor;
  assetEntriesCopy = assetEntries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v39 = assetEntriesCopy;
  v34 = v39;
  if (v39 || ([descriptorCopy clientDomainName], v11 = objc_claimAutoreleasedReturnValue(), objc_msgSend(descriptorCopy, "assetSetIdentifier"), v12 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager locateSetConfigurationByClientDomain:forAssetSetIdentifier:](self, "locateSetConfigurationByClientDomain:forAssetSetIdentifier:", v11, v12), v13 = objc_claimAutoreleasedReturnValue(), v12, v11, objc_msgSend(v13, "autoAssetEntries"), v14 = objc_claimAutoreleasedReturnValue(), v13, (v39 = v14) != 0))
  {
    v15 = objc_alloc_init(NSMutableArray);
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v40 = [obj countByEnumeratingWithState:&v50 objects:v55 count:16];
    if (v40)
    {
      v36 = *v51;
      v37 = v15;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      v38 = descriptorCopy;
      do
      {
        v17 = 0;
        do
        {
          if (*v51 != v36)
          {
            objc_enumerationMutation(obj);
          }

          v41 = v17;
          v18 = *(*(&v50 + 1) + 8 * v17);
          v46 = 0u;
          v47 = 0u;
          v48 = 0u;
          v49 = 0u;
          v43 = v39;
          v45 = [v43 countByEnumeratingWithState:&v46 objects:v54 count:16];
          if (v45)
          {
            v19 = *v47;
            v42 = v18;
            while (2)
            {
              for (i = 0; i != v45; i = i + 1)
              {
                if (*v47 != v19)
                {
                  objc_enumerationMutation(v43);
                }

                v21 = *(*(&v46 + 1) + 8 * i);
                v22 = p_weak_ivar_lyt[223];
                assetSelector = [v21 assetSelector];
                assetType = [assetSelector assetType];
                fullAssetSelector = [v18 fullAssetSelector];
                assetType2 = [fullAssetSelector assetType];
                if ([v22 stringIsEqual:assetType to:assetType2])
                {
                  v44 = p_weak_ivar_lyt[223];
                  assetSelector2 = [v21 assetSelector];
                  assetSpecifier = [assetSelector2 assetSpecifier];
                  fullAssetSelector2 = [v18 fullAssetSelector];
                  [fullAssetSelector2 assetSpecifier];
                  v31 = v30 = v19;
                  LOBYTE(v44) = [v44 stringIsEqual:assetSpecifier to:v31];

                  v19 = v30;
                  v18 = v42;

                  p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                  if (v44)
                  {

                    v15 = v37;
                    if (v42)
                    {
                      [v37 addObject:v42];
                    }

                    goto LABEL_22;
                  }
                }

                else
                {
                }
              }

              v45 = [v43 countByEnumeratingWithState:&v46 objects:v54 count:16];
              if (v45)
              {
                continue;
              }

              break;
            }
          }

          v15 = v37;
LABEL_22:
          v17 = v41 + 1;
          descriptorCopy = v38;
        }

        while ((v41 + 1) != v40);
        v40 = [obj countByEnumeratingWithState:&v50 objects:v55 count:16];
      }

      while (v40);
    }

    if ([v15 count])
    {
      v32 = v15;
    }

    else
    {
      v32 = 0;
    }
  }

  else
  {
    v32 = 0;
  }

  return v32;
}

- (id)_limitToCheckAtomicEntries:(id)entries
{
  entriesCopy = entries;
  v16 = objc_alloc_init(NSMutableArray);
  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  v20 = 0u;
  v4 = entriesCopy;
  v5 = [v4 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v5)
  {
    v6 = v5;
    v7 = *v18;
    do
    {
      for (i = 0; i != v6; i = i + 1)
      {
        if (*v18 != v7)
        {
          objc_enumerationMutation(v4);
        }

        v9 = *(*(&v17 + 1) + 8 * i);
        v10 = [MANAutoAssetSetAtomicEntry alloc];
        fullAssetSelector = [v9 fullAssetSelector];
        assetID = [v9 assetID];
        assetAttributes = [v9 assetAttributes];
        v14 = -[MANAutoAssetSetAtomicEntry initWithFullAssetSelector:withAssetID:withLocalContentURL:withAssetAttributes:inhibitedFromEmergencyRemoval:](v10, "initWithFullAssetSelector:withAssetID:withLocalContentURL:withAssetAttributes:inhibitedFromEmergencyRemoval:", fullAssetSelector, assetID, 0, assetAttributes, [v9 inhibitedFromEmergencyRemoval]);

        if (v14)
        {
          [v16 addObject:v14];
        }
      }

      v6 = [v4 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v6);
  }

  return v16;
}

- (void)setDescriptorAddedPreInstalled:(id)installed
{
  installedCopy = installed;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDownloadedAtomicInstance = [installedCopy latestDownloadedAtomicInstance];
  if (latestDownloadedAtomicInstance)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"setDescriptorAddedPreInstalled" forAtomicInstanceUUID:latestDownloadedAtomicInstance requireExists:0];
    if (autoControlManagerFSM2)
    {
      v9 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [installedCopy summary];
        *buf = 138543618;
        v29 = _updateLatestSummary;
        v30 = 2114;
        v31 = summary;
        _os_log_impl(&dword_0, v9, OS_LOG_TYPE_ERROR, "[%{public}@] {setDescriptorAddedPreInstalled} downloaded-by-instance set-descriptor already known | setDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v16 = [(MADAutoAssetControlManager *)self setDescriptorNewEntryIDForDownloaded:installedCopy];
      persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v26 = v16;
      v27 = [persistedDownloadedSetDescriptors persistedEntry:v16 fromLocation:@"setDescriptorAddedPreInstalled"];

      [v27 persistSecureCodedObject:installedCopy forKey:@"assetSetDescriptor"];
      persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      summary2 = [installedCopy summary];
      [persistedDownloadedSetDescriptors2 storePersistedEntry:v16 withEntrySummary:summary2 fromLocation:@"setDescriptorAddedPreInstalled"];

      latestDowloadedAtomicInstanceEntries = [installedCopy latestDowloadedAtomicInstanceEntries];
      v21 = [latestDowloadedAtomicInstanceEntries count];
      clientDomainName = [installedCopy clientDomainName];
      assetSetIdentifier = [installedCopy assetSetIdentifier];
      discoveredAtomicInstance = [installedCopy discoveredAtomicInstance];
      v25 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetDescriptor:installedCopy];
      [MADAutoAssetHistory recordOperation:352 toHistoryType:2 fromLayer:1 usageCount:v21 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:discoveredAtomicInstance withAddendumMessage:v25];

      v9 = v26;
      [(MADAutoAssetControlManager *)self _logPersistedSetDescriptor:@"setDescriptorAddedPreInstalled" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_ADD" forPersistedEntryID:v26 forClientRequest:0 withJobUUID:0 withSetDescriptor:installedCopy message:@"new descriptor representing pre-installed auto-asset entries"];
      [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:@"setDescriptorAddedPreInstalled" forSetDescriptor:installedCopy];
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v13 = [NSString alloc];
    summary3 = [installedCopy summary];
    v15 = [v13 initWithFormat:@"{setDescriptorAddedPreInstalled} already no latestDownloadedAtomicInstance | setDescriptor:%@", summary3];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v15 withResult:6108 withError:0];
  }
}

- (BOOL)setDescriptorAllEntriesDownloaded:(id)downloaded forSetDescriptor:(id)descriptor loggingEntryExists:(BOOL)exists
{
  existsCopy = exists;
  downloadedCopy = downloaded;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  downloadedCopy = [[NSString alloc] initWithFormat:@"%@:setDescriptorAllEntriesDownloaded", downloadedCopy];
  v42 = 0;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v35 = [latestDowloadedAtomicInstanceEntries count];

  v40 = 0u;
  v41 = 0u;
  v38 = 0u;
  v39 = 0u;
  obj = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v13 = [obj countByEnumeratingWithState:&v38 objects:v55 count:16];
  if (!v13)
  {
    v25 = 1;
    goto LABEL_29;
  }

  v14 = v13;
  v33 = descriptorCopy;
  v34 = downloadedCopy;
  v15 = 0;
  path = 0;
  v17 = *v39;
  while (2)
  {
    v18 = 0;
    v19 = path;
    do
    {
      if (*v39 != v17)
      {
        objc_enumerationMutation(obj);
      }

      v20 = *(*(&v38 + 1) + 8 * v18);
      ++v15;
      localContentURL = [v20 localContentURL];

      if (!localContentURL)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary = [v20 summary];
          descriptorCopy = v33;
          summary2 = [v33 summary];
          *buf = 138544386;
          v44 = downloadedCopy;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = summary;
          v51 = 2114;
          v52 = summary2;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | setDescriptor:%{public}@", buf, 0x34u);

LABEL_24:
          downloadedCopy = v34;
LABEL_27:

          v25 = 0;
          path = v19;
          goto LABEL_28;
        }

LABEL_26:
        descriptorCopy = v33;
        downloadedCopy = v34;
        goto LABEL_27;
      }

      localContentURL2 = [v20 localContentURL];
      path = [localContentURL2 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:downloadedCopy atPath:path isDirectory:&v42])
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary3 = [v20 summary];
          descriptorCopy = v33;
          summary4 = [v33 summary];
          *buf = 138544642;
          v44 = downloadedCopy;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = summary3;
          v51 = 2114;
          v52 = path;
          v53 = 2114;
          v54 = summary4;
          v31 = "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry missing from filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@";
LABEL_23:
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, v31, buf, 0x3Eu);

          v19 = path;
          goto LABEL_24;
        }

        goto LABEL_25;
      }

      if ((v42 & 1) == 0)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary3 = [v20 summary];
          descriptorCopy = v33;
          summary4 = [v33 summary];
          *buf = 138544642;
          v44 = downloadedCopy;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = summary3;
          v51 = 2114;
          v52 = path;
          v53 = 2114;
          v54 = summary4;
          v31 = "{%{public}@} [DROP-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@ | setDescriptor:%{public}@";
          goto LABEL_23;
        }

LABEL_25:
        v19 = path;
        goto LABEL_26;
      }

      if (existsCopy)
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
        {
          summary5 = [v20 summary];
          *buf = 138544386;
          v44 = downloadedCopy;
          v45 = 2048;
          v46 = v15;
          v47 = 2048;
          v48 = v35;
          v49 = 2114;
          v50 = summary5;
          v51 = 2114;
          v52 = path;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} [KEEP-SET-DESCRIPTOR] set-descriptor with downloaded entry on filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@", buf, 0x34u);
        }
      }

      v18 = v18 + 1;
      v19 = path;
    }

    while (v14 != v18);
    v14 = [obj countByEnumeratingWithState:&v38 objects:v55 count:16];
    if (v14)
    {
      continue;
    }

    break;
  }

  v25 = 1;
  descriptorCopy = v33;
  downloadedCopy = v34;
LABEL_28:

LABEL_29:
  return v25;
}

- (BOOL)setDescriptorAllDiscoveredEntriesDownloaded:(id)downloaded forSetDescriptor:(id)descriptor loggingEntryExists:(BOOL)exists
{
  existsCopy = exists;
  downloadedCopy = downloaded;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  downloadedCopy = [[NSString alloc] initWithFormat:@"%@:setDescriptorAllDiscoveredEntriesDownloaded", downloadedCopy];
  v40 = 0;
  discoveredAtomicEntries = [descriptorCopy discoveredAtomicEntries];
  v33 = [discoveredAtomicEntries count];

  v38 = 0u;
  v39 = 0u;
  v36 = 0u;
  v37 = 0u;
  obj = [descriptorCopy discoveredAtomicEntries];
  v13 = [obj countByEnumeratingWithState:&v36 objects:v51 count:16];
  if (!v13)
  {
    v25 = 1;
    goto LABEL_27;
  }

  v14 = v13;
  v31 = descriptorCopy;
  v32 = downloadedCopy;
  v15 = 0;
  path = 0;
  v17 = *v37;
  while (2)
  {
    v18 = 0;
    v19 = path;
    do
    {
      if (*v37 != v17)
      {
        objc_enumerationMutation(obj);
      }

      v20 = *(*(&v36 + 1) + 8 * v18);
      ++v15;
      localContentURL = [v20 localContentURL];

      if (!localContentURL)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary = [v20 summary];
          *buf = 138544130;
          v42 = downloadedCopy;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = summary;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry missing localContentURL | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@", buf, 0x2Au);
        }

        goto LABEL_25;
      }

      localContentURL2 = [v20 localContentURL];
      path = [localContentURL2 path];

      if (![(MADAutoAssetControlManager *)self filesystemDoesDirectoryExist:downloadedCopy atPath:path isDirectory:&v40])
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary2 = [v20 summary];
          *buf = 138544386;
          v42 = downloadedCopy;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = summary2;
          v49 = 2114;
          v50 = path;
          v29 = "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry missing from filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@";
LABEL_23:
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, v29, buf, 0x34u);
        }

LABEL_24:
        v19 = path;
LABEL_25:
        descriptorCopy = v31;
        downloadedCopy = v32;

        v25 = 0;
        path = v19;
        goto LABEL_26;
      }

      if ((v40 & 1) == 0)
      {
        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          summary2 = [v20 summary];
          *buf = 138544386;
          v42 = downloadedCopy;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = summary2;
          v49 = 2114;
          v50 = path;
          v29 = "{%{public}@} [INCOMPLETE-SET-DESCRIPTOR] set-descriptor with downloaded entry that is not a directory | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@";
          goto LABEL_23;
        }

        goto LABEL_24;
      }

      if (existsCopy)
      {
        v23 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
        {
          summary3 = [v20 summary];
          *buf = 138544386;
          v42 = downloadedCopy;
          v43 = 2048;
          v44 = v15;
          v45 = 2048;
          v46 = v33;
          v47 = 2114;
          v48 = summary3;
          v49 = 2114;
          v50 = path;
          _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-descriptor with downloaded entry on filesystem | entry:%ld-of-%ld | nextDownloadedEntry:%{public}@ | localContentURL:%{public}@", buf, 0x34u);
        }
      }

      v18 = v18 + 1;
      v19 = path;
    }

    while (v14 != v18);
    v14 = [obj countByEnumeratingWithState:&v36 objects:v51 count:16];
    if (v14)
    {
      continue;
    }

    break;
  }

  v25 = 1;
  descriptorCopy = v31;
  downloadedCopy = v32;
LABEL_26:

LABEL_27:
  return v25;
}

- (BOOL)setDescriptorLocked:(id)locked
{
  lockedCopy = locked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [MADAutoAssetLocker newCurrentSetLockUsageForDescriptor:lockedCopy];
  if (v7)
  {
    v8 = [v7 count] != 0;
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

- (BOOL)setDescriptorVerifyNoDuplicates:(id)duplicates
{
  duplicatesCopy = duplicates;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = objc_alloc_init(NSMutableDictionary);
  v29 = 0u;
  v30 = 0u;
  v31 = 0u;
  v32 = 0u;
  v28 = duplicatesCopy;
  latestDowloadedAtomicInstanceEntries = [duplicatesCopy latestDowloadedAtomicInstanceEntries];
  v9 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v29 objects:v33 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v30;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v30 != v11)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        v13 = *(*(&v29 + 1) + 8 * i);
        v14 = objc_autoreleasePoolPush();
        fullAssetSelector = [v13 fullAssetSelector];
        persistedEntryID = [fullAssetSelector persistedEntryID];

        v17 = [v7 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];
        if (!v17)
        {
          [v7 setSafeObject:v13 forKey:persistedEntryID];
        }

        objc_autoreleasePoolPop(v14);
      }

      v10 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v29 objects:v33 count:16];
    }

    while (v10);
  }

  latestDowloadedAtomicInstanceEntries2 = [v28 latestDowloadedAtomicInstanceEntries];
  v19 = [latestDowloadedAtomicInstanceEntries2 count];
  v20 = [v7 count];

  if (v19 != v20)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v23 = [NSString alloc];
    summary = [v28 summary];
    v25 = [v23 initWithFormat:@"{setDescriptorVerifyNoDuplicates} set-descriptor has not yet been deduped | setDescriptor:%@", summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v25 withResult:6109 withError:0];
  }

  return v19 == v20;
}

- (id)setDescriptorDedupDownloadedEntries:(id)entries forSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  entriesCopy = entries;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [descriptorCopy copy];
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];

  v12 = [(MADAutoAssetControlManager *)self setAtomicEntriesRemoveDuplicates:entriesCopy dedupingAtomicEntries:latestDowloadedAtomicInstanceEntries];

  [v10 setLatestDowloadedAtomicInstanceEntries:v12];

  return v10;
}

- (id)setAtomicEntriesRemoveDuplicates:(id)duplicates dedupingAtomicEntries:(id)entries
{
  duplicatesCopy = duplicates;
  entriesCopy = entries;
  v6 = objc_alloc_init(NSMutableDictionary);
  v22 = objc_alloc_init(NSMutableArray);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  obj = entriesCopy;
  v7 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v27;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v27 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v26 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        fullAssetSelector = [v11 fullAssetSelector];
        persistedEntryID = [fullAssetSelector persistedEntryID];

        v15 = [v6 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];
        if (v15)
        {
          autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM diag];
          v18 = [[NSString alloc] initWithFormat:@"{%@:setAtomicEntriesRemoveDuplicates} atomic-entries needed dedup | dropped selectorKey:%@", duplicatesCopy, persistedEntryID];
          [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v18 withResult:6109 withError:0];
        }

        else
        {
          [v6 setSafeObject:v11 forKey:persistedEntryID];
          [v22 addObject:v11];
        }

        objc_autoreleasePoolPop(v12);
      }

      v8 = [obj countByEnumeratingWithState:&v26 objects:v30 count:16];
    }

    while (v8);
  }

  if ([v22 count])
  {
    v19 = v22;
  }

  else
  {
    v19 = obj;
  }

  v20 = v19;

  return v19;
}

- (id)newSetEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  domainCopy = domain;
  identifierCopy = [[NSString alloc] initWithFormat:@"%@_%@", domainCopy, identifierCopy];

  return identifierCopy;
}

- (id)newSetEntryIDForClientDomain:(id)domain forAssetSetIdentifier:(id)identifier ofAtomicInstance:(id)instance
{
  instanceCopy = instance;
  identifierCopy = identifier;
  domainCopy = domain;
  instanceCopy = [[NSString alloc] initWithFormat:@"%@_%@_%@", domainCopy, identifierCopy, instanceCopy];

  return instanceCopy;
}

- (BOOL)isSetDescriptor:(id)descriptor coveredBySetDescriptorStatus:(id)status
{
  descriptorCopy = descriptor;
  statusCopy = status;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDowloadedAtomicInstanceEntries = [statusCopy latestDowloadedAtomicInstanceEntries];
  v11 = [latestDowloadedAtomicInstanceEntries count];

  if (v11)
  {
    v29 = descriptorCopy;
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    obj = [statusCopy latestDowloadedAtomicInstanceEntries];
    v12 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    if (v12)
    {
      v13 = v12;
      v28 = statusCopy;
      v14 = *v32;
      while (2)
      {
        for (i = 0; i != v13; i = i + 1)
        {
          if (*v32 != v14)
          {
            objc_enumerationMutation(obj);
          }

          v16 = *(*(&v31 + 1) + 8 * i);
          v17 = objc_autoreleasePoolPush();
          v18 = [MAAutoAssetSelector alloc];
          fullAssetSelector = [v16 fullAssetSelector];
          assetType = [fullAssetSelector assetType];
          fullAssetSelector2 = [v16 fullAssetSelector];
          assetSpecifier = [fullAssetSelector2 assetSpecifier];
          v23 = [v18 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

          v24 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"isSetDescriptor:coveredBySetDescriptorStatus" assetSelector:v23 limitedToStaging:0];
          v25 = [v24 count];

          objc_autoreleasePoolPop(v17);
          if (!v25)
          {
            v26 = 0;
            goto LABEL_12;
          }
        }

        v13 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
        if (v13)
        {
          continue;
        }

        break;
      }

      v26 = 1;
LABEL_12:
      statusCopy = v28;
    }

    else
    {
      v26 = 1;
    }

    descriptorCopy = v29;
  }

  else
  {
    v26 = 0;
  }

  return v26;
}

- (void)setDescriptorEliminate:(id)eliminate triggeredByClient:(id)client forClientDomainName:(id)name forAssetSetIdentifier:(id)identifier awaitingUnlocked:(BOOL)unlocked
{
  unlockedCopy = unlocked;
  eliminateCopy = eliminate;
  clientCopy = client;
  nameCopy = name;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  eliminateCopy = [[NSString alloc] initWithFormat:@"%@:setDescriptorEliminate", eliminateCopy];
  v48 = identifierCopy;
  v19 = [[MAAutoAssetSelector alloc] initForAssetType:nameCopy withAssetSpecifier:identifierCopy];
  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  persistedEntryID = [v19 persistedEntryID];
  v22 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v22)
  {
    if (![(MADAutoAssetEliminate *)v22 awaitingUnlocked]|| unlockedCopy)
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:clientCopy withErrorCode:6113 fromAction:eliminateCopy withDescription:@"already performing eliminate operation for the specified auto-asset-set identifier"];
      v23 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
      {
        summary = [(MADAutoAssetEliminate *)v22 summary];
        *buf = 138543618;
        v54 = eliminateCopy;
        v55 = 2114;
        v56 = summary;
        v25 = "\n[SET-ELIMINATE]{%{public}@} [BusyPerformingOperation] hard-eliminate (pending soft-eliminate should also have completed) | eliminateTracker:%{public}@";
        v26 = v23;
        v27 = OS_LOG_TYPE_ERROR;
        goto LABEL_19;
      }
    }

    else
    {
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:eliminateCopy usingEliminateTracker:v22 whenCurrentlyLocked:1 beginningToEliminate:0 removingContent:1];
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:clientCopy withErrorCode:0 fromAction:eliminateCopy withDescription:@"hard-eliminate completed (pending soft-eliminate should also have completed)"];
      v23 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
      {
        summary = [(MADAutoAssetEliminate *)v22 summary];
        *buf = 138543618;
        v54 = eliminateCopy;
        v55 = 2114;
        v56 = summary;
        v25 = "\n[SET-ELIMINATE]{%{public}@} [SUCCESS] hard-eliminate (pending soft-eliminate should also have completed) | eliminateTracker:%{public}@";
        v26 = v23;
        v27 = OS_LOG_TYPE_DEFAULT;
LABEL_19:
        _os_log_impl(&dword_0, v26, v27, v25, buf, 0x16u);
      }
    }
  }

  else
  {
    v46 = nameCopy;
    v47 = v19;
    v28 = unlockedCopy;
    v44 = clientCopy;
    v45 = eliminateCopy;
    v23 = objc_alloc_init(NSMutableArray);
    clientDomainName = [0 clientDomainName];
    assetSetIdentifier = [0 assetSetIdentifier];
    v31 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:clientDomainName assetSetIdentifier:assetSetIdentifier];

    [(MADAutoAssetControlManager *)self trackPerformanceIteration:eliminateCopy ofContainer:@"setDescriptorKeysForAssetSet"];
    v51 = 0u;
    v52 = 0u;
    v49 = 0u;
    v50 = 0u;
    v32 = v31;
    v33 = [v32 countByEnumeratingWithState:&v49 objects:v57 count:16];
    if (v33)
    {
      v34 = v33;
      v35 = *v50;
      do
      {
        for (i = 0; i != v34; i = i + 1)
        {
          if (*v50 != v35)
          {
            objc_enumerationMutation(v32);
          }

          v37 = *(*(&v49 + 1) + 8 * i);
          v38 = objc_autoreleasePoolPush();
          v39 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:eliminateCopy forKey:v37];
          if (v39)
          {
            [v23 addObject:v39];
          }

          objc_autoreleasePoolPop(v38);
        }

        v34 = [v32 countByEnumeratingWithState:&v49 objects:v57 count:16];
      }

      while (v34);
    }

    v40 = [MADAutoAssetEliminate alloc];
    clientCopy = v44;
    clientRequest = [v44 clientRequest];
    v22 = [(MADAutoAssetEliminate *)v40 initWithClientRequest:clientRequest withAssetSelector:v47 forClientDomain:v46 forSetIdentifier:v48 withDownloadedSetDescriptors:v23 awaitingUnlocked:v28];

    if (v22)
    {
      v42 = [(MADAutoAssetControlManager *)self isSetIdentifierCurrentlyLocked:eliminateCopy forClientDomainName:v46 forAssetSetIdentifier:v48];
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:eliminateCopy usingEliminateTracker:v22 whenCurrentlyLocked:v42 beginningToEliminate:1 removingContent:!v42 || !v28];
      eliminateCopy = v45;
      nameCopy = v46;
    }

    else
    {
      [(MADAutoAssetControlManager *)self issueResponseForEventInfo:v44 withErrorCode:6101 fromAction:eliminateCopy withDescription:@"unable to allocate eliminate operation tracking entry"];
      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543362;
        v54 = eliminateCopy;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_ERROR, "\n[SET-ELIMINATE]{%{public}@} [ResourceUnavailable] unable to allocate eliminate operation tracking entry", buf, 0xCu);
      }

      eliminateCopy = v45;
      nameCopy = v46;
    }

    v19 = v47;
  }
}

- (void)setIdentifierEliminate:(id)eliminate usingEliminateTracker:(id)tracker whenCurrentlyLocked:(BOOL)locked beginningToEliminate:(BOOL)toEliminate removingContent:(BOOL)content
{
  contentCopy = content;
  toEliminateCopy = toEliminate;
  lockedCopy = locked;
  eliminateCopy = eliminate;
  trackerCopy = tracker;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v114 = eliminateCopy;
  eliminateCopy = [[NSString alloc] initWithFormat:@"%@:setIdentifierEliminate", eliminateCopy];
  v16 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
  {
    summary = [trackerCopy summary];
    v18 = summary;
    v19 = @"N";
    *buf = 138544386;
    v150 = eliminateCopy;
    if (lockedCopy)
    {
      v20 = @"Y";
    }

    else
    {
      v20 = @"N";
    }

    if (toEliminateCopy)
    {
      v21 = @"Y";
    }

    else
    {
      v21 = @"N";
    }

    if (contentCopy)
    {
      v19 = @"Y";
    }

    v151 = 2114;
    *v152 = summary;
    *&v152[8] = 2114;
    *&v152[10] = v20;
    v153 = 2114;
    v154 = v21;
    v155 = 2114;
    v156 = v19;
    _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} eliminateTracker:%{public}@ | currentlyLocked:%{public}@ | beginEliminate:%{public}@ | removeContent:%{public}@", buf, 0x34u);
  }

  v117 = eliminateCopy;
  if (toEliminateCopy)
  {
    v110 = contentCopy;
    v112 = toEliminateCopy;
    [trackerCopy setAwaitingSchedulerAck:1];
    clientDomainName = [trackerCopy clientDomainName];
    assetSetIdentifier = [trackerCopy assetSetIdentifier];
    [MADAutoAssetScheduler controlEliminateSetDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier indicatingWhenEliminated:1];

    v24 = trackerCopy;
    [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:eliminateCopy ofContainer:@"currentJobsBySelector"];
    v142 = 0u;
    v143 = 0u;
    v140 = 0u;
    v141 = 0u;
    currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)selfCopy currentSetJobsByIdentifier];
    allKeys = [currentSetJobsByIdentifier allKeys];
    v27 = [allKeys copy];

    v121 = [v27 countByEnumeratingWithState:&v140 objects:v148 count:16];
    if (v121)
    {
      v119 = *v141;
      obj = v27;
      do
      {
        for (i = 0; i != v121; i = i + 1)
        {
          if (*v141 != v119)
          {
            objc_enumerationMutation(v27);
          }

          v29 = *(*(&v140 + 1) + 8 * i);
          v30 = objc_autoreleasePoolPush();
          currentSetJobsByIdentifier2 = [(MADAutoAssetControlManager *)selfCopy currentSetJobsByIdentifier];
          v32 = [currentSetJobsByIdentifier2 safeObjectForKey:v29 ofClass:objc_opt_class()];

          if (v32 && [v32 autoAssetSetJob])
          {
            clientDomainName2 = [v32 clientDomainName];
            clientDomainName3 = [v24 clientDomainName];
            if (([SUCore stringIsEqual:clientDomainName2 to:clientDomainName3]& 1) != 0)
            {
              autoAssetSetIdentifier = [v32 autoAssetSetIdentifier];
              assetSetIdentifier2 = [v24 assetSetIdentifier];
              v37 = [SUCore stringIsEqual:autoAssetSetIdentifier to:assetSetIdentifier2];

              v24 = trackerCopy;
              v27 = obj;

              if (v37)
              {
                activeJobsByUUID = [trackerCopy activeJobsByUUID];
                autoAssetUUID = [v32 autoAssetUUID];
                autoAssetUUID2 = [v32 autoAssetUUID];
                [activeJobsByUUID setSafeObject:autoAssetUUID forKey:autoAssetUUID2];

                v27 = obj;
                [(MADAutoAssetControlManager *)selfCopy cancelActiveSetJob:v117 activeSetJob:v32];
              }
            }

            else
            {
            }
          }

          objc_autoreleasePoolPop(v30);
        }

        v121 = [v27 countByEnumeratingWithState:&v140 objects:v148 count:16];
      }

      while (v121);
    }

    if ([v24 eliminatingSet])
    {
      clientDomainName4 = [v24 clientDomainName];
      assetSetIdentifier3 = [v24 assetSetIdentifier];
      assetSelector = [(MADAutoAssetControlManager *)selfCopy setConfigurationForClientDomain:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier3];

      eliminateCopy = v117;
      toEliminateCopy = v112;
      if (assetSelector)
      {
        [v24 setAwaitingStagerAck:1];
        [(MADAutoAssetControlManager *)selfCopy ensureStagerFullyResumed];
        [MADAutoAssetStager controlEliminateSetConfiguration:assetSelector];
      }
    }

    else
    {
      [v24 setAwaitingStagerAck:1];
      [(MADAutoAssetControlManager *)selfCopy ensureStagerFullyResumed];
      assetSelector = [v24 assetSelector];
      [MADAutoAssetStager controlEliminateSelector:assetSelector];
      eliminateCopy = v117;
      toEliminateCopy = v112;
    }

    activelyEliminatingSelectors = [(MADAutoAssetControlManager *)selfCopy activelyEliminatingSelectors];
    assetSelector2 = [v24 assetSelector];
    persistedEntryID = [assetSelector2 persistedEntryID];
    [activelyEliminatingSelectors setSafeObject:v24 forKey:persistedEntryID];

    v47 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
    {
      summary2 = [trackerCopy summary];
      *buf = 138543618;
      v150 = eliminateCopy;
      v151 = 2114;
      *v152 = summary2;
      _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [BEGIN] elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
    }

    contentCopy = v110;
  }

  if (contentCopy)
  {
    awaitingSecureOperations = [trackerCopy awaitingSecureOperations];
    v50 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v50, OS_LOG_TYPE_DEFAULT))
    {
      v51 = @"s";
      *buf = 138543874;
      v150 = eliminateCopy;
      if (awaitingSecureOperations == 1)
      {
        v51 = &stru_4BD3F0;
      }

      v151 = 1024;
      *v152 = awaitingSecureOperations;
      *&v152[4] = 2114;
      *&v152[6] = v51;
      _os_log_impl(&dword_0, v50, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [AUTO-SECURE] waiting for %d in-progress secure operation%{public}@", buf, 0x1Cu);
    }

    v52 = awaitingSecureOperations > 0 || toEliminateCopy;
    v111 = v52;
    v120 = objc_alloc_init(NSMutableArray);
    v113 = objc_alloc_init(NSMutableArray);
    v136 = 0u;
    v137 = 0u;
    v138 = 0u;
    v139 = 0u;
    shortTermLockedByAtomicInstance = [(MADAutoAssetControlManager *)selfCopy shortTermLockedByAtomicInstance];
    allKeys2 = [shortTermLockedByAtomicInstance allKeys];
    v55 = [allKeys2 copy];

    obja = v55;
    v122 = [v55 countByEnumeratingWithState:&v136 objects:v147 count:16];
    if (v122)
    {
      v56 = *v137;
      do
      {
        for (j = 0; j != v122; j = j + 1)
        {
          if (*v137 != v56)
          {
            objc_enumerationMutation(obja);
          }

          v58 = *(*(&v136 + 1) + 8 * j);
          knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)selfCopy knownSetAtomicInstancesByInstance];
          v60 = [knownSetAtomicInstancesByInstance safeObjectForKey:v58 ofClass:objc_opt_class()];

          if (!v60)
          {
            goto LABEL_48;
          }

          clientDomainName5 = [v60 clientDomainName];
          clientDomainName6 = [trackerCopy clientDomainName];
          if (([SUCore stringIsEqual:clientDomainName5 to:clientDomainName6]& 1) != 0)
          {
            [v60 assetSetIdentifier];
            v64 = v63 = v56;
            assetSetIdentifier4 = [trackerCopy assetSetIdentifier];
            v66 = [SUCore stringIsEqual:v64 to:assetSetIdentifier4];

            v56 = v63;
            if (!v66)
            {
              goto LABEL_55;
            }

LABEL_48:
            clientDomainName5 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:v117 forAtomicInstanceUUID:v58 requireExists:0];
            if (clientDomainName5)
            {
              if (v60 && [v60 lockedSupportingShortTermLocking])
              {
                [v113 addObject:clientDomainName5];
              }

              [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:clientDomainName5];
              [(MADAutoAssetControlManager *)selfCopy _forceSetUngraftAndEliminateAllSetLocks:v114 forSetDescriptor:clientDomainName5];
            }

            goto LABEL_54;
          }

LABEL_54:
LABEL_55:
        }

        v122 = [obja countByEnumeratingWithState:&v136 objects:v147 count:16];
      }

      while (v122);
    }

    clientDomainName7 = [trackerCopy clientDomainName];
    assetSetIdentifier5 = [trackerCopy assetSetIdentifier];
    eliminateCopy = v117;
    [(MADAutoAssetControlManager *)selfCopy setDescriptorEliminateMatching:v117 forClientDomainName:clientDomainName7 forAssetSetIdentifier:assetSetIdentifier5 eliminatingSetIdentifer:1];

    clientDomainName8 = [trackerCopy clientDomainName];
    assetSetIdentifier6 = [trackerCopy assetSetIdentifier];
    [(MADAutoAssetControlManager *)selfCopy atomicInstanceEliminate:v117 forClientDomainName:clientDomainName8 forAssetSetIdentifier:assetSetIdentifier6];

    clientDomainName9 = [trackerCopy clientDomainName];
    assetSetIdentifier7 = [trackerCopy assetSetIdentifier];
    [(MADAutoAssetControlManager *)selfCopy setConfigurationEliminate:v117 forClientDomainName:clientDomainName9 forAssetSetIdentifier:assetSetIdentifier7];

    clientDomainName10 = [trackerCopy clientDomainName];
    assetSetIdentifier8 = [trackerCopy assetSetIdentifier];
    [(MADAutoAssetControlManager *)selfCopy clearDownloadedFromSetStatus:v117 forClientDomainName:clientDomainName10 forAssetSetIdentifier:assetSetIdentifier8];

    v134 = 0u;
    v135 = 0u;
    v132 = 0u;
    v133 = 0u;
    v75 = v113;
    v76 = [v75 countByEnumeratingWithState:&v132 objects:v146 count:16];
    if (v76)
    {
      v77 = v76;
      v78 = *v133;
      do
      {
        for (k = 0; k != v77; k = k + 1)
        {
          if (*v133 != v78)
          {
            objc_enumerationMutation(v75);
          }

          v80 = *(*(&v132 + 1) + 8 * k);
          [(MADAutoAssetControlManager *)selfCopy removeShortTermLockingOfSetDescriptor:v117 forSetDescriptor:v80 endingAll:0 performingHardEliminate:1 error:0];
          [(MADAutoAssetControlManager *)selfCopy _shortTermForceForget:v117 forSetDescriptor:v80];
        }

        v77 = [v75 countByEnumeratingWithState:&v132 objects:v146 count:16];
      }

      while (v77);
    }

    clientDomainName11 = [trackerCopy clientDomainName];
    assetSetIdentifier9 = [trackerCopy assetSetIdentifier];
    v83 = [(MADAutoAssetControlManager *)selfCopy setDescriptorWalkKeysForClientDomainName:clientDomainName11 assetSetIdentifier:assetSetIdentifier9];

    v130 = 0u;
    v131 = 0u;
    v128 = 0u;
    v129 = 0u;
    v84 = v83;
    v85 = [v84 countByEnumeratingWithState:&v128 objects:v145 count:16];
    if (v85)
    {
      v86 = v85;
      v87 = *v129;
      do
      {
        for (m = 0; m != v86; m = m + 1)
        {
          if (*v129 != v87)
          {
            objc_enumerationMutation(v84);
          }

          v89 = *(*(&v128 + 1) + 8 * m);
          v90 = objc_autoreleasePoolPush();
          v91 = [(MADAutoAssetControlManager *)selfCopy setDescriptorWalkLocate:v117 forKey:v89];
          if (v91)
          {
            v92 = [(MADAutoAssetControlManager *)selfCopy setLockUsageMapForSetDescriptor:v91];

            if (v92)
            {
              [(MADAutoAssetControlManager *)selfCopy _forceSetUngraftAndEliminateAllSetLocks:v117 forSetDescriptor:v91];
              [(MADAutoAssetControlManager *)selfCopy _shortTermForceForget:v117 forSetDescriptor:v91];
            }

            [v120 addObject:v91];
          }

          objc_autoreleasePoolPop(v90);
        }

        v86 = [v84 countByEnumeratingWithState:&v128 objects:v145 count:16];
      }

      while (v86);
    }

    v126 = 0u;
    v127 = 0u;
    v124 = 0u;
    v125 = 0u;
    v93 = v120;
    v94 = [v93 countByEnumeratingWithState:&v124 objects:v144 count:16];
    if (v94)
    {
      v95 = v94;
      v96 = *v125;
      do
      {
        for (n = 0; n != v95; n = n + 1)
        {
          if (*v125 != v96)
          {
            objc_enumerationMutation(v93);
          }

          v98 = *(*(&v124 + 1) + 8 * n);
          v99 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)selfCopy _forceSetUngraftAndEliminateAllSetLocks:v117 forSetDescriptor:v98];
          [(MADAutoAssetControlManager *)selfCopy _shortTermForceForget:v117 forSetDescriptor:v98];
          [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorDownloaded:v98 fromLocation:v117 checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:328 historyOperationSD:372];
          objc_autoreleasePoolPop(v99);
        }

        v95 = [v93 countByEnumeratingWithState:&v124 objects:v144 count:16];
      }

      while (v95);
    }

    clientDomainName12 = [trackerCopy clientDomainName];
    assetSetIdentifier10 = [trackerCopy assetSetIdentifier];
    [MADAutoAssetLocker eliminateSetEndAllLocks:v114 forClientDomainName:clientDomainName12 forAssetSetIdentifier:assetSetIdentifier10];

    clientDomainName13 = [trackerCopy clientDomainName];
    assetSetIdentifier11 = [trackerCopy assetSetIdentifier];
    [(MADAutoAssetControlManager *)selfCopy setLockUsageMapEliminateForClientDomain:clientDomainName13 forSetIdentifier:assetSetIdentifier11];

    [trackerCopy setAwaitingUnlocked:0];
    v104 = _MADLog(@"AutoControl");
    v105 = os_log_type_enabled(v104, OS_LOG_TYPE_DEFAULT);
    if (v111)
    {
      if (v105)
      {
        summary3 = [trackerCopy summary];
        *buf = 138543618;
        v150 = v117;
        v151 = 2114;
        *v152 = summary3;
        _os_log_impl(&dword_0, v104, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [REMOVE-CONTENT] elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      if (v105)
      {
        summary4 = [trackerCopy summary];
        *buf = 138543618;
        v150 = v117;
        v151 = 2114;
        *v152 = summary4;
        _os_log_impl(&dword_0, v104, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} [REMOVE-CONTENT] no elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
      }

      [(MADAutoAssetControlManager *)selfCopy _eliminateCompleteIfAllDone:trackerCopy];
    }

    v107 = trackerCopy;
  }

  else
  {
    v107 = trackerCopy;
    [trackerCopy setAwaitingUnlocked:1];
    v93 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v93, OS_LOG_TYPE_DEFAULT))
    {
      summary5 = [trackerCopy summary];
      *buf = 138543618;
      v150 = eliminateCopy;
      v151 = 2114;
      *v152 = summary5;
      _os_log_impl(&dword_0, v93, OS_LOG_TYPE_DEFAULT, "\n[SET-ELIMINATE]{%{public}@} AWAIT-UNLOCKED elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
    }
  }
}

- (void)finishSetEliminateIfAwaitingUnlocked:(id)unlocked forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier
{
  unlockedCopy = unlocked;
  domainCopy = domain;
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self isSetIdentifierBeingEliminated:unlockedCopy forClientDomainName:domainCopy ofSetIdentifier:identifierCopy]&& ![(MADAutoAssetControlManager *)self isSetIdentifierCurrentlyLocked:unlockedCopy forClientDomainName:domainCopy forAssetSetIdentifier:identifierCopy])
  {
    v12 = [[MAAutoAssetSelector alloc] initForAssetType:domainCopy withAssetSpecifier:identifierCopy];
    activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    persistedEntryID = [v12 persistedEntryID];
    v15 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

    if (v15)
    {
      [(MADAutoAssetControlManager *)self setIdentifierEliminate:unlockedCopy usingEliminateTracker:v15 whenCurrentlyLocked:0 beginningToEliminate:0 removingContent:1];
    }

    else
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v18 = [NSString alloc];
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v20 = [v18 initWithFormat:@"{%@:finishSetEliminateIfAwaitingUnlocked} set-identifier being eliminated yet no eliminateTracker | clientDomainName:%@ | assetSetIdentifier:%@ | %@", unlockedCopy, domainCopy, identifierCopy, _updateLatestSummary];
      [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6111 withError:0];
    }
  }
}

- (void)_forceSetUngraftAndEliminateAllSetLocks:(id)locks forSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  locksCopy = locks;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locksCopy = [[NSString alloc] initWithFormat:@"%@:_forceSetUngraftAndEliminateAllSetLocks", locksCopy];
  v10 = +[NSFileManager defaultManager];
  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  v14 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName forAssetSetIdentifier:assetSetIdentifier forSetAtomicInstance:latestDownloadedAtomicInstance];

  v15 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:descriptorCopy];
  v16 = [NSString alloc];
  summary = [descriptorCopy summary];
  v18 = [v16 initWithFormat:@"forcing atomic-instance unlocked due to set-eliminate | setDescriptor:%@", summary];
  v19 = [MAAutoAssetError buildError:6564 fromOperation:locksCopy underlyingError:0 withDescription:v18];

  [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:locksCopy dueToError:v19 forgettingAtomicInstance:v15 historyOperationAI:1504 historyOperationSD:395];
  [(MADAutoAssetControlManager *)self secureCheckUngraftAll:locksCopy forSetDescriptorNoLongerLocked:descriptorCopy];
  [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:descriptorCopy];
  clientDomainName2 = [descriptorCopy clientDomainName];
  assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
  [(MADAutoAssetControlManager *)self setLockUsageMapEliminateForClientDomain:clientDomainName2 forSetIdentifier:assetSetIdentifier2];

  [(MADAutoAssetControlManager *)self removeShortTermLockingOfSetDescriptor:locksCopy forSetDescriptor:descriptorCopy endingAll:1 performingHardEliminate:1 error:0];
  v22 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:locksCopy removingSharedLockFilename:v14 usingFileManager:v10 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
}

- (BOOL)setJobFoundAllContent:(id)content forJobAtomicInstance:(id)instance withCurrentSetStatus:(id)status
{
  instanceCopy = instance;
  statusCopy = status;
  contentCopy = content;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  contentCopy = [[NSString alloc] initWithFormat:@"%@:setJobFoundAllContent", contentCopy];
  v14 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:instanceCopy];
  if (!v14)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v18 = [NSString alloc];
    summary = [statusCopy summary];
    autoControlManagerFSM3 = [v18 initWithFormat:@"{%@} set-job current-set-status did not include active atomic-instance | jobAtomicInstance:%@ | currentSetStatus:%@", contentCopy, instanceCopy, summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:autoControlManagerFSM3 withResult:6111 withError:0];
    goto LABEL_12;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self locateSetDescriptor:contentCopy forAtomicInstanceUUID:instanceCopy requireExists:0];
  if (!autoControlManagerFSM2)
  {
    if (statusCopy && ([statusCopy clientDomainName], v21 = objc_claimAutoreleasedReturnValue(), objc_msgSend(statusCopy, "assetSetIdentifier"), v22 = objc_claimAutoreleasedReturnValue(), -[MADAutoAssetControlManager setConfigurationForClientDomain:forAssetSetIdentifier:](self, "setConfigurationForClientDomain:forAssetSetIdentifier:", v21, v22), diag = objc_claimAutoreleasedReturnValue(), v22, v21, diag))
    {
      latestDowloadedAtomicInstanceEntries = [statusCopy latestDowloadedAtomicInstanceEntries];
      if (latestDowloadedAtomicInstanceEntries || ([statusCopy newerDiscoveredAtomicEntries], (latestDowloadedAtomicInstanceEntries = objc_claimAutoreleasedReturnValue()) != 0))
      {
        summary = latestDowloadedAtomicInstanceEntries;
        v16 = 1;
LABEL_13:

        goto LABEL_14;
      }

      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag2 = [autoControlManagerFSM3 diag];
      v27 = [NSString alloc];
      summary2 = [statusCopy summary];
      v29 = [v27 initWithFormat:@"{%@} set-job current-set-status does not include latestDowloadedEntries | jobAtomicInstance:%@ | currentSetStatus:%@", contentCopy, instanceCopy, summary2];
      [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v29 withResult:6111 withError:0];

      summary = 0;
    }

    else
    {
      diag = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      summary = [diag diag];
      v24 = [NSString alloc];
      autoControlManagerFSM3 = [statusCopy summary];
      diag2 = [v24 initWithFormat:@"{%@} set-job current-set-status has no set-configuration | jobAtomicInstance:%@ | currentSetStatus:%@", contentCopy, instanceCopy, autoControlManagerFSM3];
      [summary trackAnomaly:@"AUTO-SET-CONTROL" forReason:diag2 withResult:6111 withError:0];
    }

LABEL_12:
    v16 = 0;
    goto LABEL_13;
  }

  v16 = 0;
LABEL_14:

  return v16;
}

- (BOOL)shouldAdoptJobFoundAllContent:(id)content forJobAtomicInstance:(id)instance withCurrentSetStatus:(id)status
{
  contentCopy = content;
  instanceCopy = instance;
  statusCopy = status;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  contentCopy = [[NSString alloc] initWithFormat:@"%@:shouldAdoptJobFoundAllContent", contentCopy];
  v14 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:instanceCopy];
  if (!v14)
  {
    v15 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
    {
      summary = [0 summary];
      *buf = 138543618;
      v78 = contentCopy;
      v79 = 2114;
      v80 = summary;
      _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "{%{public}@}: atomic-instance no longer valid - never adopt | setAtomicInstance:%{public}@", buf, 0x16u);
    }

    LOBYTE(v16) = 0;
    goto LABEL_43;
  }

  v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:contentCopy forAtomicInstanceUUID:instanceCopy requireExists:0];
  v16 = 0;
  if (v15)
  {
    goto LABEL_37;
  }

  clientDomainName = [statusCopy clientDomainName];
  assetSetIdentifier = [statusCopy assetSetIdentifier];
  v19 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  v20 = v19;
  if (!v19)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v37 = [NSString alloc];
    summary2 = [statusCopy summary];
    v39 = [v37 initWithFormat:@"{%@} set-job current-set-status has no set-configuration | jobAtomicInstance:%@ | currentSetStatus:%@", contentCopy, instanceCopy, summary2];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v39 withResult:6111 withError:0];

    v20 = 0;
    v16 = 0;
    goto LABEL_36;
  }

  latestAtomicInstanceToVend = [v19 latestAtomicInstanceToVend];

  if (!latestAtomicInstanceToVend)
  {
LABEL_32:
    latestDowloadedAtomicInstanceEntries = [statusCopy latestDowloadedAtomicInstanceEntries];
    if (latestDowloadedAtomicInstanceEntries || ([statusCopy newerDiscoveredAtomicEntries], (latestDowloadedAtomicInstanceEntries = objc_claimAutoreleasedReturnValue()) != 0))
    {
      v16 = 1;
    }

    else
    {
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag2 = [autoControlManagerFSM3 diag];
      v54 = [NSString alloc];
      [statusCopy summary];
      v55 = v72 = v20;
      v56 = [v54 initWithFormat:@"{%@} set-job current-set-status does not include latestDowloadedEntries | jobAtomicInstance:%@ | currentSetStatus:%@", contentCopy, instanceCopy, v55];
      [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v56 withResult:6111 withError:0];

      v20 = v72;
      latestDowloadedAtomicInstanceEntries = 0;
      v16 = 0;
    }

    goto LABEL_36;
  }

  v71 = v20;
  latestAtomicInstanceToVend2 = [v20 latestAtomicInstanceToVend];
  v23 = [(MADAutoAssetControlManager *)self locateSetDescriptor:contentCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

  if (!v23 || ([statusCopy latestDowloadedAtomicInstanceEntries], v24 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v23, "latestDowloadedAtomicInstanceEntries"), v25 = objc_claimAutoreleasedReturnValue(), v67 = -[MADAutoAssetControlManager doSetAtomicEntries:matchOtherAtomicEntries:](self, "doSetAtomicEntries:matchOtherAtomicEntries:", v24, v25), v25, v24, !v67))
  {

    v20 = v71;
    goto LABEL_32;
  }

  v75 = 0u;
  v76 = 0u;
  v73 = 0u;
  v74 = 0u;
  latestDowloadedAtomicInstanceEntries2 = [v23 latestDowloadedAtomicInstanceEntries];
  v68 = [latestDowloadedAtomicInstanceEntries2 countByEnumeratingWithState:&v73 objects:v83 count:16];
  if (!v68)
  {

    v16 = 0;
    goto LABEL_23;
  }

  v60 = contentCopy;
  v61 = statusCopy;
  v63 = v23;
  v64 = *v74;
  while (2)
  {
    for (i = 0; i != v68; i = i + 1)
    {
      if (*v74 != v64)
      {
        objc_enumerationMutation(latestDowloadedAtomicInstanceEntries2);
      }

      v28 = latestDowloadedAtomicInstanceEntries2;
      v29 = *(*(&v73 + 1) + 8 * i);
      localContentURL = [v29 localContentURL];
      fileSystemRepresentation = [localContentURL fileSystemRepresentation];

      if (!fileSystemRepresentation)
      {
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag3 = [autoControlManagerFSM4 diag];
        v57 = [NSString alloc];
        assetSetIdentifier2 = [0 assetSetIdentifier];
        latestDownloadedAtomicInstance = [v63 latestDownloadedAtomicInstance];
        if (v29)
        {
          summary3 = [v29 summary];
        }

        else
        {
          summary3 = @"NIL";
        }

        statusCopy = v61;
        v62 = assetSetIdentifier2;
        v45 = [v57 initWithFormat:@"{%@} An entry in latest-to-vend for set %@, %@, has latestDownloadedAtomicInstanceEntries that contain nil value. Entry: %@", contentCopy, assetSetIdentifier2, latestDownloadedAtomicInstance, summary3];
        [diag3 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v45 withResult:6111 withError:0];

        if (v29)
        {
        }

        goto LABEL_31;
      }

      localContentURL2 = [v29 localContentURL];
      v33 = +[NSString stringWithUTF8String:](NSString, "stringWithUTF8String:", [localContentURL2 fileSystemRepresentation]);

      if (![(MADAutoAssetControlManager *)self filesystemDoesFileExist:contentCopy atPath:v33])
      {
        autoControlManagerFSM5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag4 = [autoControlManagerFSM5 diag];
        v59 = [NSString alloc];
        assetSetIdentifier3 = [0 assetSetIdentifier];
        latestDownloadedAtomicInstance2 = [v63 latestDownloadedAtomicInstance];
        v44 = [v59 initWithFormat:@"{%@} Latest-to-vend for set %@, %@, has atomic entries that are missing from filesystem.  Missing atomic entry: %@. ", contentCopy, assetSetIdentifier3, latestDownloadedAtomicInstance2, v33];
        [diag4 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v44 withResult:6111 withError:0];

        statusCopy = v61;
LABEL_31:
        v20 = v71;
        contentCopy = v60;
        goto LABEL_32;
      }

      latestDowloadedAtomicInstanceEntries2 = v28;
    }

    v68 = [v28 countByEnumeratingWithState:&v73 objects:v83 count:16];
    if (v68)
    {
      continue;
    }

    break;
  }

  v16 = 0;
  contentCopy = v60;
  statusCopy = v61;
LABEL_23:
  v20 = v71;
LABEL_36:

LABEL_37:
  v47 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
  {
    v48 = statusCopy;
    if (v16)
    {
      v49 = @"Y";
    }

    else
    {
      v49 = @"N";
    }

    summary4 = [v14 summary];
    *buf = 138543874;
    v78 = contentCopy;
    v79 = 2114;
    v80 = v49;
    statusCopy = v48;
    v81 = 2114;
    v82 = summary4;
    _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "{%{public}@}: atomic-instance considered for adoption | shouldAdoptAsDownloaded:%{public}@ | setAtomicInstance:%{public}@", buf, 0x20u);
  }

LABEL_43:
  return v16;
}

- (BOOL)doSetAtomicEntries:(id)entries matchOtherAtomicEntries:(id)atomicEntries
{
  entriesCopy = entries;
  atomicEntriesCopy = atomicEntries;
  v7 = [entriesCopy count];
  v34 = atomicEntriesCopy;
  if (v7 != [atomicEntriesCopy count])
  {
    v27 = 0;
    goto LABEL_28;
  }

  v49 = 0u;
  v50 = 0u;
  v47 = 0u;
  v48 = 0u;
  obj = entriesCopy;
  v31 = [obj countByEnumeratingWithState:&v47 objects:v52 count:16];
  if (!v31)
  {
    v27 = 1;
    goto LABEL_27;
  }

  v32 = *v48;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v29 = entriesCopy;
  while (2)
  {
    v9 = 0;
    while (2)
    {
      if (*v48 != v32)
      {
        objc_enumerationMutation(obj);
      }

      v33 = v9;
      v10 = *(*(&v47 + 1) + 8 * v9);
      v43 = 0u;
      v44 = 0u;
      v45 = 0u;
      v46 = 0u;
      v37 = v34;
      v42 = [v37 countByEnumeratingWithState:&v43 objects:v51 count:16];
      if (!v42)
      {
LABEL_25:

        v27 = 0;
        entriesCopy = v29;
        goto LABEL_27;
      }

      v11 = *v44;
      v36 = *v44;
LABEL_9:
      v12 = 0;
      while (1)
      {
        if (*v44 != v11)
        {
          objc_enumerationMutation(v37);
        }

        v13 = *(*(&v43 + 1) + 8 * v12);
        v14 = p_weak_ivar_lyt[223];
        fullAssetSelector = [v10 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        fullAssetSelector2 = [v13 fullAssetSelector];
        assetType2 = [fullAssetSelector2 assetType];
        if (![v14 stringIsEqual:assetType to:assetType2])
        {
          goto LABEL_17;
        }

        v39 = fullAssetSelector;
        v19 = p_weak_ivar_lyt;
        v20 = p_weak_ivar_lyt[223];
        fullAssetSelector3 = [v10 fullAssetSelector];
        assetSpecifier = [fullAssetSelector3 assetSpecifier];
        fullAssetSelector4 = [v13 fullAssetSelector];
        assetSpecifier2 = [fullAssetSelector4 assetSpecifier];
        v40 = assetSpecifier;
        if (![v20 stringIsEqual:assetSpecifier to:assetSpecifier2])
        {

          p_weak_ivar_lyt = v19;
          v11 = v36;
          fullAssetSelector = v39;
LABEL_17:

          goto LABEL_18;
        }

        v35 = v19[223];
        fullAssetSelector5 = [v10 fullAssetSelector];
        assetVersion = [fullAssetSelector5 assetVersion];
        fullAssetSelector6 = [v13 fullAssetSelector];
        assetVersion2 = [fullAssetSelector6 assetVersion];
        LOBYTE(v35) = [v35 stringIsEqual:assetVersion to:assetVersion2];

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v11 = v36;
        if (v35)
        {
          break;
        }

LABEL_18:
        if (v42 == ++v12)
        {
          v42 = [v37 countByEnumeratingWithState:&v43 objects:v51 count:16];
          if (v42)
          {
            goto LABEL_9;
          }

          goto LABEL_25;
        }
      }

      v9 = v33 + 1;
      if ((v33 + 1) != v31)
      {
        continue;
      }

      break;
    }

    v27 = 1;
    entriesCopy = v29;
    v31 = [obj countByEnumeratingWithState:&v47 objects:v52 count:16];
    if (v31)
    {
      continue;
    }

    break;
  }

LABEL_27:

LABEL_28:
  return v27;
}

- (BOOL)setPolicyValidate:(id)validate fromLocation:(id)location
{
  validateCopy = validate;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [validateCopy clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  clientRequest = [validateCopy clientRequest];
  v13 = [(MADAutoAssetControlManager *)self _isClientRequestForSetJob:clientRequest];

  if (v13)
  {
    clientRequestMessage2 = [validateCopy clientRequestMessage];
    v15 = [(MADAutoAssetControlManager *)self clientRequestMessageSetPolicy:clientRequestMessage2];

    if (!v15)
    {
      v20 = 0;
LABEL_23:

      goto LABEL_24;
    }

    v16 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
    v17 = [(MADAutoAssetControlManager *)self clientRequestMessageSetInstance:locationCopy withEventInfo:validateCopy];
    if ([v15 lockInhibitsEmergencyRemoval] && ((+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:NEED_FOR_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:CHECK_ATOMIC") & 1) != 0 || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK") & 1) != 0))
    {
      v18 = @"lockInhibitsEmergencyRemoval|";
      v19 = 6572;
    }

    else
    {
      if (![v15 blockCheckDownload] || (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:CHECK_ATOMIC") & 1) == 0 && (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:LOCK_ATOMIC") & 1) == 0 && (+[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", messageName, @"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK") & 1) == 0)
      {
        v24 = _MADLog(@"Auto");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
        {
          summary = [v17 summary];
          summary2 = [v15 summary];
          *buf = 138544130;
          v30 = locationCopy;
          v31 = 2114;
          v32 = summary;
          v33 = 2114;
          v34 = messageName;
          v35 = 2114;
          v36 = summary2;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "{%{public}@:setPolicyValidate} setInstance:%{public}@\n[SET-POLICY](%{public}@) accepted | setPolicy:%{public}@", buf, 0x2Au);
        }

        v20 = 0;
        goto LABEL_22;
      }

      v18 = @"blockCheckDownload|";
      v19 = 6573;
    }

    [v16 appendString:v18];
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
    {
      [v17 summary];
      v22 = v28 = v17;
      summary3 = [v15 summary];
      *buf = 138544642;
      v30 = locationCopy;
      v31 = 2114;
      v32 = v22;
      v33 = 2114;
      v34 = messageName;
      v35 = 2048;
      v36 = v19;
      v37 = 2114;
      v38 = v16;
      v39 = 2114;
      v40 = summary3;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{%{public}@:setPolicyValidate} setInstance:%{public}@\n[SET-POLICY](%{public}@) cannot accept set-policy | errorCode:%ld(%{public}@) | setPolicy:%{public}@", buf, 0x3Eu);

      v17 = v28;
    }

    v24 = [[NSString alloc] initWithFormat:@"set-policy invalid: setPolicy|%@ must be NO for request:%@", v16, messageName];
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:validateCopy withErrorCode:v19 fromAction:locationCopy withDescription:v24];
    v20 = 1;
LABEL_22:

    goto LABEL_23;
  }

  [(MADAutoAssetControlManager *)self issueResponseForEventInfo:validateCopy withErrorCode:6570 fromAction:locationCopy withDescription:@"set-policy invalid: client-request is not for a set-job"];
  v20 = 1;
LABEL_24:

  return v20;
}

- (id)setTargetNewEntryIDForClientDomainName:(id)name forAssetSetIdentifier:(id)identifier forClientProvidedSetTarget:(id)target
{
  targetCopy = target;
  identifierCopy = identifier;
  nameCopy = name;
  minTargetOSVersion = [targetCopy minTargetOSVersion];
  maxTargetOSVersion = [targetCopy maxTargetOSVersion];

  v13 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomainName:nameCopy forAssetSetIdentifier:identifierCopy forMinTargetOS:minTargetOSVersion forMaxTargetOS:maxTargetOSVersion];

  return v13;
}

- (id)newSetEntryIDForClientDomainName:(id)name forAssetSetIdentifier:(id)identifier forMinTargetOS:(id)s forMaxTargetOS:(id)oS
{
  oSCopy = oS;
  sCopy = s;
  identifierCopy = identifier;
  nameCopy = name;
  oSCopy = [[NSString alloc] initWithFormat:@"%@_%@_%@_%@", nameCopy, identifierCopy, sCopy, oSCopy];

  return oSCopy;
}

- (void)_routeCatalogFinished:(id)finished withEventInfo:(id)info
{
  infoCopy = info;
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetJobID = [infoCopy autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:finishedCopy notFoundCode:6103 notFoundReason:@"catalog-download-finished when no active auto-asset-job"];

  if (v10)
  {
    autoAssetJobID2 = [infoCopy autoAssetJobID];
    autoAssetCatalog = [infoCopy autoAssetCatalog];
    finishedError = [infoCopy finishedError];
    [v10 handleDownloadCatalogJobFinished:autoAssetJobID2 withCatalog:autoAssetCatalog downloadError:finishedError];
  }
}

- (void)_routeConfigFinished:(id)finished withEventInfo:(id)info
{
  infoCopy = info;
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetJobID = [infoCopy autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:finishedCopy notFoundCode:6103 notFoundReason:@"download-config when no active auto-asset-job"];

  if (v10)
  {
    autoAssetJobID2 = [infoCopy autoAssetJobID];
    downloadOptions = [infoCopy downloadOptions];
    finishedError = [infoCopy finishedError];
    [v10 handleDownloadConfigJobFinished:autoAssetJobID2 withDownloadOptions:downloadOptions configError:finishedError];
  }
}

- (void)_routeAssetProgress:(id)progress toCurrentJobByUUID:(id)d withDownloadProgress:(id)downloadProgress
{
  dCopy = d;
  downloadProgressCopy = downloadProgress;
  progressCopy = progress;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12 = [(MADAutoAssetControlManager *)self currentJobByUUID:dCopy fromLocation:progressCopy notFoundCode:6103 notFoundReason:@"download-progress when no active auto-asset-job"];

  if (v12)
  {
    [v12 handleDownloadAssetProgressForJob:dCopy withProgress:downloadProgressCopy];
  }
}

- (void)_routeAssetFinished:(id)finished withEventInfo:(id)info
{
  infoCopy = info;
  finishedCopy = finished;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  autoAssetJobID = [infoCopy autoAssetJobID];
  v10 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetJobID fromLocation:finishedCopy notFoundCode:6103 notFoundReason:@"asset-download-finished when no active auto-asset-job"];

  if (v10)
  {
    autoAssetJobID2 = [infoCopy autoAssetJobID];
    finishedError = [infoCopy finishedError];
    [v10 handleDownloadAssetJobFinished:autoAssetJobID2 downloadError:finishedError];
  }
}

- (void)_awaitingResumeRemoveType:(int64_t)type
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v6 = objc_alloc_init(NSMutableArray);
  v13 = 0u;
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  downloadManagerEventsAwaitingResumed = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v8 = [downloadManagerEventsAwaitingResumed countByEnumeratingWithState:&v13 objects:v17 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v14;
    do
    {
      v11 = 0;
      do
      {
        if (*v14 != v10)
        {
          objc_enumerationMutation(downloadManagerEventsAwaitingResumed);
        }

        v12 = *(*(&v13 + 1) + 8 * v11);
        if (v12 && [*(*(&v13 + 1) + 8 * v11) paramType] != &dword_8)
        {
          [v6 addObject:v12];
        }

        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [downloadManagerEventsAwaitingResumed countByEnumeratingWithState:&v13 objects:v17 count:16];
    }

    while (v9);
  }

  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v6];
}

- (void)_awaitingResumeReduceToLatest
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = objc_alloc_init(NSMutableArray);
  v6 = objc_alloc_init(NSMutableDictionary);
  v26 = 0u;
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  downloadManagerEventsAwaitingResumed = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v8 = [downloadManagerEventsAwaitingResumed countByEnumeratingWithState:&v26 objects:v31 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v27;
    do
    {
      for (i = 0; i != v9; i = i + 1)
      {
        if (*v27 != v10)
        {
          objc_enumerationMutation(downloadManagerEventsAwaitingResumed);
        }

        v12 = *(*(&v26 + 1) + 8 * i);
        autoAssetJobID = [v12 autoAssetJobID];
        [v6 setSafeObject:v12 forKey:autoAssetJobID];
      }

      v9 = [downloadManagerEventsAwaitingResumed countByEnumeratingWithState:&v26 objects:v31 count:16];
    }

    while (v9);
  }

  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v14 = v6;
  v15 = [v14 countByEnumeratingWithState:&v22 objects:v30 count:16];
  if (v15)
  {
    v16 = v15;
    v17 = *v23;
    do
    {
      for (j = 0; j != v16; j = j + 1)
      {
        if (*v23 != v17)
        {
          objc_enumerationMutation(v14);
        }

        v19 = *(*(&v22 + 1) + 8 * j);
        v20 = objc_autoreleasePoolPush();
        v21 = [v14 safeObjectForKey:v19 ofClass:{objc_opt_class(), v22}];
        if (v21)
        {
          [v5 addObject:v21];
        }

        objc_autoreleasePoolPop(v20);
      }

      v16 = [v14 countByEnumeratingWithState:&v22 objects:v30 count:16];
    }

    while (v16);
  }

  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v5];
}

- (void)_requestDownloadManagerSync
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self receivedDownloadManagerSync])
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v6 = [NSString alloc];
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v8 = [v6 initWithFormat:@"{_requestDownloadManagerSync} already received DownloadManager sync | %@", _updateLatestSummary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v8 withResult:6108 withError:0];
  }

  else
  {
    v9 = getDownloadManager();
    v10 = _MADLog(@"AutoControl");
    v11 = v10;
    if (v9)
    {
      if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
      {
        summary = [(MADAutoAssetControlManager *)self summary];
        *buf = 138543362;
        v16 = summary;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_requestDownloadManagerSync} | Triggering DownloadManager sync (under assumption sync attempt never occurred)", buf, 0xCu);
      }

      [v9 queryNSUrlSessiondAndUpdateState];
    }

    else
    {
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        summary2 = [(MADAutoAssetControlManager *)self summary];
        *buf = 138543362;
        v16 = summary2;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[%{public}@] {_requestDownloadManagerSync} | No download manager available; unable to attempt sync as mitigation for potential lost sync", buf, 0xCu);
      }
    }
  }
}

- (id)_updatePolicyForSelector:(id)selector
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  defaultUpdatePolicy = [(MADAutoAssetControlManager *)self defaultUpdatePolicy];
  preferenceActivityIntervalSecs = [(MADAutoAssetControlManager *)self preferenceActivityIntervalSecs];
  if (preferenceActivityIntervalSecs >= 1)
  {
    [defaultUpdatePolicy setCheckForNewerIntervalSecs:preferenceActivityIntervalSecs];
  }

  defaultUpdatePolicy2 = [(MADAutoAssetControlManager *)self defaultUpdatePolicy];

  return defaultUpdatePolicy2;
}

- (void)loadPersistedDescriptors
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  [persistedKnownDescriptors loadPersistedState:@"loadPersistedDescriptors"];

  persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [persistedKnownDescriptors2 persistedEntryIDs:@"loadPersistedDescriptors"];

  if ([v7 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedDescriptors" ofContainer:@"persistedKnownDescriptors"];
    v46 = deviceOSBuildVersion();
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v45 = v7;
    v8 = v7;
    v49 = [v8 countByEnumeratingWithState:&v50 objects:v60 count:16];
    if (!v49)
    {
      goto LABEL_41;
    }

    v9 = *v51;
    v47 = v8;
    v48 = *v51;
    while (1)
    {
      v10 = 0;
      do
      {
        if (*v51 != v9)
        {
          objc_enumerationMutation(v8);
        }

        v11 = *(*(&v50 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v14 = [persistedKnownDescriptors3 persistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

        if (!v14)
        {
          v16 = _MADLog(@"AutoControl");
          if (!os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_18;
          }

          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v55 = _updateLatestSummary;
          v56 = 2114;
          v57 = v11;
          _os_log_impl(&dword_0, v16, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          goto LABEL_17;
        }

        persistedKnownDescriptors4 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v16 = [persistedKnownDescriptors4 decodeFromLocation:@"loadPersistedDescriptors" ofEntryName:v11 fromPersistedEntry:v14 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v16)
        {
          _updateLatestSummary = _MADLog(@"AutoControl");
          if (os_log_type_enabled(_updateLatestSummary, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = _updateLatestSummary2;
            v56 = 2114;
            v57 = v11;
            v19 = _updateLatestSummary;
            v20 = OS_LOG_TYPE_ERROR;
            v21 = "[%{public}@] {loadPersistedDescriptors} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
            _os_log_impl(&dword_0, v19, v20, v21, buf, 0x16u);

            v9 = v48;
          }

LABEL_17:

          goto LABEL_18;
        }

        if ([v16 isBlankEntry])
        {
          _updateLatestSummary = _MADLog(@"AutoControl");
          if (os_log_type_enabled(_updateLatestSummary, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = _updateLatestSummary2;
            v56 = 2114;
            v57 = v11;
            v19 = _updateLatestSummary;
            v20 = OS_LOG_TYPE_DEFAULT;
            v21 = "[%{public}@] {loadPersistedDescriptors} encountered blank auto-asset-descriptor | entryID:%{public}@";
            goto LABEL_16;
          }

          goto LABEL_17;
        }

        metadata = [v16 metadata];

        if (!metadata)
        {
          v28 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v55 = _updateLatestSummary3;
            v56 = 2114;
            v57 = v11;
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} encountered auto-asset-descriptor with metadata=nil | entryID:%{public}@", buf, 0x16u);
          }

          goto LABEL_35;
        }

        if ([v16 isOnFilesystem])
        {
          v23 = [MAAutoAssetSelector alloc];
          assetType = [v16 assetType];
          assetSpecifier = [v16 assetSpecifier];
          assetVersion = [v16 assetVersion];
          v27 = [v23 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

          if ([(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:v16 forOSBuild:v46])
          {
            [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v16];
            LOBYTE(v44) = 0;
            [(MADAutoAssetControlManager *)self trackDescriptor:v16 persisting:0 fromLocation:@"loadPersistedDescriptors" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v44];
            [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"content on filesystem validated"];
          }

          else
          {
            descriptorsDroppedOnStartup = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            [descriptorsDroppedOnStartup addObject:v16];

            persistedKnownDescriptors5 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [persistedKnownDescriptors5 removePersistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v11 removedDescriptor:v16 message:@"stale descriptor (filesystem content did not validate)"];
            assetId = [v16 assetId];
            [MADAutoAssetHistory recordOperation:401 toHistoryType:0 fromLayer:1 forAssetID:assetId withSelector:v27];
          }

          v8 = v47;

LABEL_35:
          v9 = v48;
          goto LABEL_18;
        }

        if ([(MADAutoAssetControlManager *)self jobDescriptorInFlightNowOnFilesystem:v16])
        {
          v30 = _MADLog(@"AutoControl");
          v9 = v48;
          if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary = [v16 summary];
            *buf = 138543874;
            v55 = _updateLatestSummary4;
            v56 = 2114;
            v57 = v11;
            v58 = 2114;
            v59 = summary;
            _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} previously in-flight now on filesystem validated | entryID:%{public}@, adoptedDescriptor:%{public}@", buf, 0x20u);

            v8 = v47;
          }

          [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v16];
          [v16 setIsOnFilesystem:1];
          metadata2 = [v16 metadata];
          v34 = [metadata2 safeIntegerForKey:@"_UnarchivedSize"];

          if (v34 >= 1)
          {
            [v16 setDownloadedNetworkBytes:v34];
            [v16 setDownloadedFilesystemBytes:v34];
          }

          LOBYTE(v44) = 0;
          [(MADAutoAssetControlManager *)self trackDescriptor:v16 persisting:1 fromLocation:@"loadPersistedDescriptors" changedWhileTerminated:1 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v44];
          [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"previously in-flight now on filesystem validated"];
        }

        else
        {
          assetId2 = [v16 assetId];

          v9 = v48;
          if (assetId2)
          {
            [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedDescriptors" forComponentType:@"JOB_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v11 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v16 baseForPatchDescriptor:0 message:@"previously in-flight not on filesystem (will resume once active)"];
          }

          else
          {
            persistedKnownDescriptors6 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [persistedKnownDescriptors6 removePersistedEntry:v11 fromLocation:@"loadPersistedDescriptors"];

            descriptorsDroppedOnStartup2 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
            [descriptorsDroppedOnStartup2 addObject:v16];

            v9 = v48;
            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedDescriptors" forComponentType:@"JOB_DESCRIPTORS" removedPersistedEntryID:v11 removedDescriptor:v16 message:@"not adopting previous job (since not representing dowloaded or downloading content)"];
          }
        }

LABEL_18:

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v49 != v10);
      v41 = [v8 countByEnumeratingWithState:&v50 objects:v60 count:16];
      v49 = v41;
      if (!v41)
      {
LABEL_41:

        v7 = v45;
        v42 = v46;
        goto LABEL_44;
      }
    }
  }

  v42 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v55 = _updateLatestSummary5;
    _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedDescriptors} no persisted auto-asset-jobs to be resumed", buf, 0xCu);
  }

LABEL_44:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedDescriptors" forComponentType:@"KNOWN_DESCRIPTORS"];
}

- (void)loadPersistedSetConfigurations
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  [persistedKnownSetConfigurations loadPersistedState:@"loadPersistedSetConfigurations"];

  persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v7 = [persistedKnownSetConfigurations2 persistedEntryIDs:@"loadPersistedSetConfigurations"];

  if ([v7 count])
  {
    v48 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetConfigurations" ofContainer:@"persistedKnownSetConfigurations"];
    v59 = 0u;
    v60 = 0u;
    v57 = 0u;
    v58 = 0u;
    v47 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v57 objects:v66 count:16];
    if (!v8)
    {
      goto LABEL_29;
    }

    v9 = v8;
    v10 = @"AutoControl";
    v51 = *v58;
    while (1)
    {
      v11 = 0;
      v49 = v9;
      do
      {
        if (*v58 != v51)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v57 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v15 = [persistedKnownSetConfigurations3 persistedEntry:v12 fromLocation:@"loadPersistedSetConfigurations"];

        if (v12)
        {
          v16 = v15 == 0;
        }

        else
        {
          v16 = 1;
        }

        if (v16)
        {
          v21 = _MADLog(v10);
          if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v18 = _updateLatestSummary;
            *buf = 138543618;
            v19 = @"N";
            if (v12)
            {
              v19 = v12;
            }

            v63 = _updateLatestSummary;
            v64 = 2114;
            v65 = v19;
            _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetConfigurations} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }
        }

        else
        {
          persistedKnownSetConfigurations4 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v21 = [persistedKnownSetConfigurations4 decodeFromLocation:@"loadPersistedSetConfigurations" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

          if (v21)
          {
            v22 = v10;
            newerVersionError = [v21 newerVersionError];
            code = [newerVersionError code];

            if (code == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
              [v21 setNewerVersionError:0];
            }

            availableForUseError = [v21 availableForUseError];
            code2 = [availableForUseError code];

            if (code2 == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
              [v21 setAvailableForUseError:0];
              goto LABEL_25;
            }

            if (code == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
            {
LABEL_25:
              [v15 persistSecureCodedObject:v21 forKey:@"setConfiguration"];
              persistedKnownSetConfigurations5 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              summary = [v21 summary];
              [persistedKnownSetConfigurations5 storePersistedEntry:v12 withEntrySummary:summary fromLocation:@"loadPersistedSetConfigurations"];

              v31 = [NSString alloc];
              summary2 = [v21 summary];
              v33 = [v31 initWithFormat:@"altered set-configuration converted same-version-found error(s) to SUCCESS | setConfiguration:%@ ", summary2];
              [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:@"loadPersistedSetConfigurations" operation:@"ENTRY_MODIFY" forPersistedEntryID:v12 withSetConfiguration:v21 historyOperation:447 message:v33];
            }

            [(MADAutoAssetControlManager *)self setConfigurationLoadedFromPersisted:v21 persistedEntryID:v12];
            v10 = v22;
            v9 = v49;
            goto LABEL_27;
          }

          v27 = _MADLog(v10);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v63 = _updateLatestSummary2;
            v64 = 2114;
            v65 = v12;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetConfigurations} unable to load set-configuration | entryID:%{public}@", buf, 0x16u);
          }

          [v48 addObject:v12];
        }

LABEL_27:

        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [obj countByEnumeratingWithState:&v57 objects:v66 count:16];
      if (!v9)
      {
LABEL_29:

        v55 = 0u;
        v56 = 0u;
        v53 = 0u;
        v54 = 0u;
        v52 = v48;
        v34 = [v52 countByEnumeratingWithState:&v53 objects:v61 count:16];
        if (v34)
        {
          v35 = v34;
          v36 = *v54;
          do
          {
            for (i = 0; i != v35; i = i + 1)
            {
              if (*v54 != v36)
              {
                objc_enumerationMutation(v52);
              }

              v38 = *(*(&v53 + 1) + 8 * i);
              v39 = objc_autoreleasePoolPush();
              persistedKnownSetConfigurations6 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              v41 = [persistedKnownSetConfigurations6 persistedEntry:v38 fromLocation:@"loadPersistedSetConfigurations"];

              persistedKnownSetConfigurations7 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
              v43 = [persistedKnownSetConfigurations7 decodeFromLocation:@"loadPersistedSetConfigurations" ofEntryName:v38 fromPersistedEntry:v41 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

              if (v43)
              {
                persistedKnownSetConfigurations8 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
                [persistedKnownSetConfigurations8 removePersistedEntry:v38 fromLocation:@"loadPersistedSetConfigurations"];

                [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationRemoved:@"loadPersistedSetConfigurations" removedPersistedEntryID:v38 removedSetConfiguration:v43 message:@"dropped while loading persisted-state"];
              }

              objc_autoreleasePoolPop(v39);
            }

            v35 = [v52 countByEnumeratingWithState:&v53 objects:v61 count:16];
          }

          while (v35);
        }

        v45 = v52;

        v7 = v47;
        goto LABEL_41;
      }
    }
  }

  v45 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v63 = _updateLatestSummary3;
    _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetConfigurations} no persisted set-configurations to be resumed", buf, 0xCu);
  }

LABEL_41:

  [(MADAutoAssetControlManager *)self _logPersistedSetConfigurationTableOfContents:@"loadPersistedSetConfigurations"];
}

- (void)loadPersistedSetAtomicInstances
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  [persistedKnownSetAtomicInstances loadPersistedState:@"loadPersistedSetAtomicInstances"];

  persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v7 = [persistedKnownSetAtomicInstances2 persistedEntryIDs:@"loadPersistedSetAtomicInstances"];

  selfCopy = self;
  if ([v7 count])
  {
    v46 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetAtomicInstances" ofContainer:@"persistedKnownSetAtomicInstances"];
    v55 = 0u;
    v56 = 0u;
    v53 = 0u;
    v54 = 0u;
    v42 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v53 objects:v62 count:16];
    selfCopy2 = self;
    if (v8)
    {
      v10 = v8;
      v11 = *v54;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v54 != v11)
          {
            objc_enumerationMutation(obj);
          }

          v13 = *(*(&v53 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          persistedKnownSetAtomicInstances3 = [(MADAutoAssetControlManager *)selfCopy2 persistedKnownSetAtomicInstances];
          v16 = [persistedKnownSetAtomicInstances3 persistedEntry:v13 fromLocation:@"loadPersistedSetAtomicInstances"];

          if (v13)
          {
            v17 = v16 == 0;
          }

          else
          {
            v17 = 1;
          }

          if (v17)
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy2 _updateLatestSummary];
              v20 = _updateLatestSummary;
              *buf = 138543618;
              v21 = @"N";
              if (v13)
              {
                v21 = v13;
              }

              v59 = _updateLatestSummary;
              v60 = 2114;
              v61 = v21;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetAtomicInstances} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
            }

            if (v13)
            {
              [v46 addObject:v13];
            }
          }

          else
          {
            persistedKnownSetAtomicInstances4 = [(MADAutoAssetControlManager *)selfCopy2 persistedKnownSetAtomicInstances];
            v23 = [persistedKnownSetAtomicInstances4 decodeFromLocation:@"loadPersistedSetAtomicInstances" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

            if (v23)
            {
              [(MADAutoAssetControlManager *)selfCopy2 atomicInstanceLoadedFromPersisted:v23 persistedEntryID:v13];
            }

            else
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy2 _updateLatestSummary];
                *buf = 138543618;
                v59 = _updateLatestSummary2;
                v60 = 2114;
                v61 = v13;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetAtomicInstances} unable to load set-atomic-instance | entryID:%{public}@", buf, 0x16u);

                selfCopy2 = selfCopy;
              }

              [v46 addObject:v13];
            }
          }

          objc_autoreleasePoolPop(v14);
        }

        v10 = [obj countByEnumeratingWithState:&v53 objects:v62 count:16];
      }

      while (v10);
    }

    v51 = 0u;
    v52 = 0u;
    v49 = 0u;
    v50 = 0u;
    v26 = v46;
    v47 = [v26 countByEnumeratingWithState:&v49 objects:v57 count:16];
    if (v47)
    {
      v45 = *v50;
      v43 = v26;
      do
      {
        for (j = 0; j != v47; j = j + 1)
        {
          if (*v50 != v45)
          {
            objc_enumerationMutation(v43);
          }

          v28 = *(*(&v49 + 1) + 8 * j);
          v29 = objc_autoreleasePoolPush();
          persistedKnownSetAtomicInstances5 = [(MADAutoAssetControlManager *)selfCopy2 persistedKnownSetAtomicInstances];
          v31 = [persistedKnownSetAtomicInstances5 persistedEntry:v28 fromLocation:@"loadPersistedSetAtomicInstances"];

          persistedKnownSetAtomicInstances6 = [(MADAutoAssetControlManager *)selfCopy2 persistedKnownSetAtomicInstances];
          v33 = [persistedKnownSetAtomicInstances6 decodeFromLocation:@"loadPersistedSetAtomicInstances" ofEntryName:v28 fromPersistedEntry:v31 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

          if (v33)
          {
            persistedKnownSetAtomicInstances7 = [(MADAutoAssetControlManager *)selfCopy2 persistedKnownSetAtomicInstances];
            [persistedKnownSetAtomicInstances7 removePersistedEntry:v28 fromLocation:@"loadPersistedSetAtomicInstances"];

            instanceEntries = [v33 instanceEntries];
            v36 = [instanceEntries count];
            clientDomainName = [v33 clientDomainName];
            assetSetIdentifier = [v33 assetSetIdentifier];
            [v33 atomicInstanceUUID];
            v40 = v39 = v29;
            [MADAutoAssetHistory recordOperation:320 toHistoryType:2 fromLayer:1 usageCount:v36 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:v40];

            v29 = v39;
            selfCopy2 = selfCopy;
            [(MADAutoAssetControlManager *)selfCopy _logPersistedSetAtomicInstanceRemoved:@"loadPersistedSetAtomicInstances" removedPersistedEntryID:v28 removedSetAtomicInstance:v33 message:@"dropped while loading persisted-state"];
          }

          objc_autoreleasePoolPop(v29);
        }

        v26 = v43;
        v47 = [v43 countByEnumeratingWithState:&v49 objects:v57 count:16];
      }

      while (v47);
    }

    v7 = v42;
  }

  else
  {
    v26 = _MADLog(@"AutoControl");
    selfCopy2 = selfCopy;
    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      *buf = 138543362;
      v59 = _updateLatestSummary3;
      _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetAtomicInstances} no persisted set-atomic-instances to be resumed", buf, 0xCu);
    }
  }

  [(MADAutoAssetControlManager *)selfCopy2 _logPersistedSetAtomicInstanceTableOfContents:@"loadPersistedSetAtomicInstances"];
}

- (void)loadPersistedSetDownloadedDescriptors
{
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  [persistedDownloadedSetDescriptors loadPersistedState:@"loadPersistedSetDownloadedDescriptors"];

  persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  v7 = [persistedDownloadedSetDescriptors2 persistedEntryIDs:@"loadPersistedSetDownloadedDescriptors"];

  v88 = +[NSFileManager defaultManager];
  if ([v7 count])
  {
    v8 = objc_alloc_init(NSMutableArray);
    v78 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"loadPersistedSetDownloadedDescriptors" ofContainer:@"persistedDownloadedSetDescriptors"];
    v102 = 0u;
    v103 = 0u;
    v100 = 0u;
    v101 = 0u;
    v77 = v7;
    v9 = v7;
    v10 = [v9 countByEnumeratingWithState:&v100 objects:v110 count:16];
    v79 = v8;
    if (!v10)
    {
      goto LABEL_37;
    }

    v11 = v10;
    v86 = *v101;
    v80 = v9;
    while (1)
    {
      v12 = 0;
      v83 = v11;
      do
      {
        if (*v101 != v86)
        {
          objc_enumerationMutation(v9);
        }

        v13 = *(*(&v100 + 1) + 8 * v12);
        v14 = objc_autoreleasePoolPush();
        v15 = v14;
        if (v13)
        {
          v89 = v14;
          persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
          v17 = [persistedDownloadedSetDescriptors3 persistedEntry:v13 fromLocation:@"loadPersistedSetDownloadedDescriptors"];

          if (!v17)
          {
            v29 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              *buf = 138543618;
              v107 = _updateLatestSummary;
              v108 = 2114;
              v109 = v13;
              _os_log_impl(&dword_0, v29, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
            }

            [v8 addObject:v13];
            goto LABEL_34;
          }

          persistedDownloadedSetDescriptors4 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
          v19 = [persistedDownloadedSetDescriptors4 decodeFromLocation:@"loadPersistedSetDownloadedDescriptors" ofEntryName:v13 fromPersistedEntry:v17 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (v19)
          {
            latestDownloadedAtomicInstance = [v19 latestDownloadedAtomicInstance];

            if (latestDownloadedAtomicInstance)
            {
              if ([(MADAutoAssetControlManager *)selfCopy setDescriptorAllEntriesDownloaded:@"loadPersistedSetDownloadedDescriptors" forSetDescriptor:v19 loggingEntryExists:1])
              {
                if (![(MADAutoAssetControlManager *)selfCopy setDescriptorVerifyNoDuplicates:v19])
                {
                  [v78 addObject:v13];
                }

                [(MADAutoAssetControlManager *)selfCopy updateAutoAssetSetStatus:@"loadPersistedSetDownloadedDescriptors(validated)" forSetDescriptor:v19];
                [(MADAutoAssetControlManager *)selfCopy _logPersistedSetDescriptor:@"loadPersistedSetDownloadedDescriptors(validated)" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v13 forClientRequest:0 withJobUUID:0 withSetDescriptor:v19 message:@"downloaded-by-instance set-descriptor validated"];
                latestDowloadedAtomicInstanceEntries = [v19 latestDowloadedAtomicInstanceEntries];
                v22 = [latestDowloadedAtomicInstanceEntries count];
                clientDomainName = [v19 clientDomainName];
                assetSetIdentifier = [v19 assetSetIdentifier];
                discoveredAtomicInstance = [v19 discoveredAtomicInstance];
                v26 = [(MADAutoAssetControlManager *)selfCopy _specifierVersionNamesForSetDescriptor:v19];
                [MADAutoAssetHistory recordOperation:420 toHistoryType:0 fromLayer:1 usageCount:v22 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:discoveredAtomicInstance withAddendumMessage:v26];

                v8 = v79;
                v9 = v80;
                v11 = v83;
LABEL_33:

LABEL_34:
                v15 = v89;
                goto LABEL_35;
              }

              v34 = [(MADAutoAssetControlManager *)selfCopy setDescriptorLocked:v19];
              v35 = _MADLog(@"AutoControl");
              v36 = os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT);
              if (v34)
              {
                if (v36)
                {
                  _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  summary = [v19 summary];
                  *buf = 138543618;
                  v107 = _updateLatestSummary2;
                  v108 = 2114;
                  v109 = summary;
                  v39 = v35;
                  v40 = "[%{public}@] {loadPersistedSetDownloadedDescriptors} incomplete set-descriptor currently locked - dropped | setDescriptor:%{public}@";
                  goto LABEL_31;
                }
              }

              else if (v36)
              {
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                summary = [v19 summary];
                *buf = 138543618;
                v107 = _updateLatestSummary2;
                v108 = 2114;
                v109 = summary;
                v39 = v35;
                v40 = "[%{public}@] {loadPersistedSetDownloadedDescriptors} incomplete set-descriptor not currently locked - dropped | setDescriptor:%{public}@";
LABEL_31:
                _os_log_impl(&dword_0, v39, OS_LOG_TYPE_DEFAULT, v40, buf, 0x16u);
              }

              [v8 addObject:v13];
              v9 = v80;
              goto LABEL_33;
            }

            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary2 = [v19 summary];
              *buf = 138543618;
              v107 = _updateLatestSummary3;
              v108 = 2114;
              v109 = summary2;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} set-descriptor without latestDownloadedAtomicInstance - dropped | setDescriptor:%{public}@", buf, 0x16u);

LABEL_24:
              v11 = v83;
            }
          }

          else
          {
            v31 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              *buf = 138543618;
              v107 = _updateLatestSummary3;
              v108 = 2114;
              v109 = v13;
              _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
              goto LABEL_24;
            }
          }

          [v8 addObject:v13];
          goto LABEL_33;
        }

        v17 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
        {
          [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v28 = v27 = v15;
          *buf = 138543362;
          v107 = v28;
          _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no entryID", buf, 0xCu);

          v15 = v27;
        }

LABEL_35:

        objc_autoreleasePoolPop(v15);
        v12 = v12 + 1;
      }

      while (v11 != v12);
      v11 = [v9 countByEnumeratingWithState:&v100 objects:v110 count:16];
      if (!v11)
      {
LABEL_37:

        v98 = 0u;
        v99 = 0u;
        v96 = 0u;
        v97 = 0u;
        v41 = v78;
        v84 = v41;
        v90 = [v41 countByEnumeratingWithState:&v96 objects:v105 count:16];
        if (v90)
        {
          v42 = *v97;
          v43 = @"loadPersistedSetDownloadedDescriptors";
          v82 = selfCopy;
          do
          {
            for (i = 0; i != v90; i = i + 1)
            {
              if (*v97 != v42)
              {
                objc_enumerationMutation(v41);
              }

              v45 = *(*(&v96 + 1) + 8 * i);
              v46 = objc_autoreleasePoolPush();
              persistedDownloadedSetDescriptors5 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
              v48 = [persistedDownloadedSetDescriptors5 persistedEntry:v45 fromLocation:v43];

              persistedDownloadedSetDescriptors6 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
              v50 = [persistedDownloadedSetDescriptors6 decodeFromLocation:v43 ofEntryName:v45 fromPersistedEntry:v48 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              if (v50)
              {
                v51 = [(MADAutoAssetControlManager *)selfCopy setDescriptorDedupDownloadedEntries:v43 forSetDescriptor:v50];
                if (v51)
                {
                  [(MADAutoAssetControlManager *)selfCopy persistSetDescriptorDownloadedJob:v51 fromLocation:v43];
                  v52 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v52, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary4 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                    [v51 summary];
                    v54 = v43;
                    v56 = v55 = v42;
                    *buf = 138543618;
                    v107 = _updateLatestSummary4;
                    v108 = 2114;
                    v109 = v56;
                    _os_log_impl(&dword_0, v52, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors}\n[SELF-HEAL] deduped setDescriptor:%{public}@", buf, 0x16u);

                    v42 = v55;
                    v43 = v54;
                    selfCopy = v82;

                    v41 = v84;
                  }
                }
              }

              objc_autoreleasePoolPop(v46);
            }

            v90 = [v41 countByEnumeratingWithState:&v96 objects:v105 count:16];
          }

          while (v90);
        }

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        v57 = v79;
        v91 = [v57 countByEnumeratingWithState:&v92 objects:v104 count:16];
        if (v91)
        {
          v87 = *v93;
          obj = v57;
          do
          {
            for (j = 0; j != v91; j = j + 1)
            {
              if (*v93 != v87)
              {
                objc_enumerationMutation(obj);
              }

              v59 = *(*(&v92 + 1) + 8 * j);
              v60 = objc_autoreleasePoolPush();
              persistedDownloadedSetDescriptors7 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
              v62 = [persistedDownloadedSetDescriptors7 persistedEntry:v59 fromLocation:@"loadPersistedSetDownloadedDescriptors"];

              persistedDownloadedSetDescriptors8 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
              v64 = [persistedDownloadedSetDescriptors8 decodeFromLocation:@"loadPersistedSetDownloadedDescriptors" ofEntryName:v59 fromPersistedEntry:v62 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              clientDomainName2 = [v64 clientDomainName];
              assetSetIdentifier2 = [v64 assetSetIdentifier];
              latestDownloadedAtomicInstance2 = [v64 latestDownloadedAtomicInstance];
              v68 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forSetAtomicInstance:latestDownloadedAtomicInstance2];

              if (v64)
              {
                if ([(MADAutoAssetControlManager *)selfCopy setDescriptorLocked:v64])
                {
                  v69 = objc_alloc_init(NSMutableArray);
                  [v69 addObject:v64];
                  v70 = [MADAutoAssetLocker eliminateAllPreviousSetLocksNoLongerTracked:v69];
                  v71 = _MADLog(@"AutoControl");
                  v72 = os_log_type_enabled(v71, OS_LOG_TYPE_DEFAULT);
                  if (v70)
                  {
                    if (v72)
                    {
                      _updateLatestSummary5 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                      v74 = [v70 count];
                      *buf = 138543618;
                      v107 = _updateLatestSummary5;
                      v108 = 2048;
                      v109 = v74;
                      _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} just unlocked selectors:%ld", buf, 0x16u);
                    }
                  }

                  else if (v72)
                  {
                    _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                    *buf = 138543362;
                    v107 = _updateLatestSummary6;
                    _os_log_impl(&dword_0, v71, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no selectors just unlocked", buf, 0xCu);
                  }
                }

                [(MADAutoAssetControlManager *)selfCopy secureCheckUngraftAll:@"loadPersistedSetDownloadedDescriptors" forSetDescriptorNoLongerLocked:v64];
                if (__isPlatformVersionAtLeast(2, 18, 4, 0))
                {
                  [(MADAutoAssetControlManager *)selfCopy notifyEvictedCallbacksForSetDescriptor:v64];
                }

                [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorDownloaded:v64 fromLocation:@"loadPersistedSetDownloadedDescriptors" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:329 historyOperationSD:373];
              }

              v75 = [(MADAutoAssetControlManager *)selfCopy _shortTermSharedLockRemove:@"loadPersistedSetDownloadedDescriptors" removingSharedLockFilename:v68 usingFileManager:v88 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];

              objc_autoreleasePoolPop(v60);
            }

            v57 = obj;
            v91 = [obj countByEnumeratingWithState:&v92 objects:v104 count:16];
          }

          while (v91);
        }

        v7 = v77;
        goto LABEL_71;
      }
    }
  }

  v57 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary7 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    *buf = 138543362;
    v107 = _updateLatestSummary7;
    _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetDownloadedDescriptors} no persisted set-descriptors to be resumed", buf, 0xCu);
  }

LABEL_71:

  [(MADAutoAssetControlManager *)selfCopy _logPersistedSetDescriptorTableOfContents:@"loadPersistedSetDownloadedDescriptors" forComponentType:@"SET_DOWNLOADED_DESCRIPTORS"];
}

- (void)loadPersistedSetActiveJobDescriptors
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  [persistedActiveJobSetDescriptors loadPersistedState:@"loadPersistedSetActiveJobDescriptors"];

  persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v7 = [persistedActiveJobSetDescriptors2 persistedEntryIDs:@"loadPersistedSetActiveJobDescriptors"];

  if ([v7 count])
  {
    v90 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetActiveJobDescriptors" ofContainer:@"persistedActiveJobSetDescriptors"];
    v98 = 0u;
    v99 = 0u;
    v96 = 0u;
    v97 = 0u;
    v78 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
    if (!v8)
    {
      v79 = 0;
      goto LABEL_63;
    }

    v9 = v8;
    v79 = 0;
    v10 = *v97;
    v83 = *v97;
    while (1)
    {
      v11 = 0;
      v84 = v9;
      do
      {
        if (*v97 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v96 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        if (v12)
        {
          persistedActiveJobSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
          v15 = [persistedActiveJobSetDescriptors3 persistedEntry:v12 fromLocation:@"loadPersistedSetActiveJobDescriptors"];

          if (v15)
          {
            persistedActiveJobSetDescriptors4 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
            v17 = [persistedActiveJobSetDescriptors4 decodeFromLocation:@"loadPersistedSetActiveJobDescriptors" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              assetSetIdentifier = [v17 assetSetIdentifier];

              if (assetSetIdentifier)
              {
                discoveredAtomicInstance = [v17 discoveredAtomicInstance];

                if (discoveredAtomicInstance)
                {
                  discoveredAtomicEntries = [v17 discoveredAtomicEntries];

                  if (discoveredAtomicEntries)
                  {
                    if (![v17 isOnFilesystem] || objc_msgSend(v17, "onFilesystemIncomplete"))
                    {
                      clientDomainName = [v17 clientDomainName];
                      assetSetIdentifier2 = [v17 assetSetIdentifier];
                      v87 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier2];

                      discoveredAtomicInstance2 = [v17 discoveredAtomicInstance];
                      v24 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:discoveredAtomicInstance2];

                      discoveredAtomicInstance3 = [v17 discoveredAtomicInstance];
                      v26 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedSetActiveJobDescriptors" forAtomicInstanceUUID:discoveredAtomicInstance3 requireExists:0];

                      discoveredAtomicInstance4 = [v17 discoveredAtomicInstance];
                      v28 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:discoveredAtomicInstance4];

                      v88 = v26;
                      v85 = v24;
                      v86 = v28;
                      if (!v26)
                      {
                        if (v28)
                        {
                          v42 = _MADLog(@"AutoControl");
                          v10 = v83;
                          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
                          {
                            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            summary = [v17 summary];
                            summary2 = [v86 summary];
                            *buf = 138543874;
                            v102 = _updateLatestSummary;
                            v103 = 2114;
                            v104 = summary;
                            v105 = 2114;
                            v106 = summary2;
                            v45 = summary2;
                            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor repeated (already adopted set-job) | dropping repeated setJobDescriptor:%{public}@ | already tracking active setJobDescriptor:%{public}@", buf, 0x20u);
                          }
                        }

                        else
                        {
                          v10 = v83;
                          if (v87)
                          {
                            if (v24)
                            {
                              [(MADAutoAssetControlManager *)self locateActiveAutoJobForSetDescriptor:v17];
                              v81 = v9 = v84;
                              if (v81)
                              {
                                ++v79;
                                [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:@"resumeSetJobsWhenBeforeFirstUnlock" forSetDescriptor:v17];
                              }

                              else
                              {
                                v51 = _MADLog(@"AutoControl");
                                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                                {
                                  _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                  summary3 = [v17 summary];
                                  *buf = 138543618;
                                  v102 = _updateLatestSummary2;
                                  v103 = 2114;
                                  v104 = summary3;
                                  v53 = summary3;
                                  _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no active active auto-asset-job | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                                }

                                [v90 addObject:v12];
                                v24 = v85;
                              }
                            }

                            else
                            {
                              v48 = _MADLog(@"AutoControl");
                              v9 = v84;
                              if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
                              {
                                _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                summary4 = [v17 summary];
                                *buf = 138543618;
                                v102 = _updateLatestSummary3;
                                v103 = 2114;
                                v104 = summary4;
                                v50 = summary4;
                                _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no set-atomic-instance | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                              }

                              [v90 addObject:v12];
                              v24 = v85;
                            }

                            goto LABEL_43;
                          }

                          v42 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
                          {
                            _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            summary5 = [v17 summary];
                            *buf = 138543618;
                            v102 = _updateLatestSummary4;
                            v103 = 2114;
                            v104 = summary5;
                            _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} active-set-job set-descriptor yet no set-configuration | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x16u);
                          }
                        }

                        [v90 addObject:v12];
                        v24 = v85;
                        goto LABEL_42;
                      }

                      v29 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
                      {
                        _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                        summary6 = [v17 summary];
                        summary7 = [v88 summary];
                        *buf = 138543874;
                        v102 = _updateLatestSummary5;
                        v103 = 2114;
                        v104 = summary6;
                        v105 = 2114;
                        v106 = summary7;
                        _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetActiveJobDescriptors} not considering resuming active-set-job since have already downloaded set-descriptor | setJobDescriptor:%{public}@ | downloadedSetDescriptor:%{public}@", buf, 0x20u);
                      }

                      [v90 addObject:v12];
                      v24 = v85;
                      v10 = v83;
LABEL_42:
                      v9 = v84;
LABEL_43:
                    }

LABEL_35:

                    goto LABEL_36;
                  }

                  v37 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v102 = _updateLatestSummary6;
                    v103 = 2114;
                    v104 = v12;
                    v39 = v37;
                    v40 = OS_LOG_TYPE_DEFAULT;
                    v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without discoveredAtomicEntries | entryID:%{public}@";
LABEL_33:
                    _os_log_impl(&dword_0, v39, v40, v41, buf, 0x16u);
                  }
                }

                else
                {
                  v37 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v102 = _updateLatestSummary6;
                    v103 = 2114;
                    v104 = v12;
                    v39 = v37;
                    v40 = OS_LOG_TYPE_DEFAULT;
                    v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without discoveredAtomicInstance | entryID:%{public}@";
                    goto LABEL_33;
                  }
                }
              }

              else
              {
                v37 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v102 = _updateLatestSummary6;
                  v103 = 2114;
                  v104 = v12;
                  v39 = v37;
                  v40 = OS_LOG_TYPE_DEFAULT;
                  v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} encountered auto-asset-set-descriptor without assetSetIdentifier | entryID:%{public}@";
                  goto LABEL_33;
                }
              }
            }

            else
            {
              v37 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543618;
                v102 = _updateLatestSummary6;
                v103 = 2114;
                v104 = v12;
                v39 = v37;
                v40 = OS_LOG_TYPE_ERROR;
                v41 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} unable to load auto-asset-set-descriptor | entryID:%{public}@";
                goto LABEL_33;
              }
            }

            [v90 addObject:v12];
            goto LABEL_35;
          }
        }

        v33 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v33, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary7 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v35 = _updateLatestSummary7;
          *buf = 138543618;
          v36 = @"N";
          if (v12)
          {
            v36 = v12;
          }

          v102 = _updateLatestSummary7;
          v103 = 2114;
          v104 = v36;
          _os_log_impl(&dword_0, v33, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetActiveJobDescriptors} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
        }

        if (v12)
        {
          [v90 addObject:v12];
        }

LABEL_36:
        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v54 = [obj countByEnumeratingWithState:&v96 objects:v107 count:16];
      v9 = v54;
      if (!v54)
      {
LABEL_63:

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        v55 = v90;
        v57 = [v55 countByEnumeratingWithState:&v92 objects:v100 count:16];
        if (v57)
        {
          v58 = v57;
          v59 = *v93;
          v91 = v55;
          do
          {
            for (i = 0; i != v58; i = i + 1)
            {
              if (*v93 != v59)
              {
                objc_enumerationMutation(v91);
              }

              v61 = *(*(&v92 + 1) + 8 * i);
              v62 = objc_autoreleasePoolPush();
              if (v61)
              {
                persistedActiveJobSetDescriptors5 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                autoControlManagerFSM2 = [persistedActiveJobSetDescriptors5 persistedEntry:v61 fromLocation:@"loadPersistedSetActiveJobDescriptors"];

                persistedActiveJobSetDescriptors6 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                diag = [persistedActiveJobSetDescriptors6 decodeFromLocation:@"loadPersistedSetActiveJobDescriptors" ofEntryName:v61 fromPersistedEntry:autoControlManagerFSM2 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                if (diag)
                {
                  persistedActiveJobSetDescriptors7 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
                  [persistedActiveJobSetDescriptors7 removePersistedEntry:v61 fromLocation:@"resumeSetJobsWhenBeforeFirstUnlock"];

                  [(MADAutoAssetControlManager *)self _logPersistedSetDescriptorRemoved:@"loadPersistedSetActiveJobDescriptors" forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v61 removedSetDescriptor:diag message:@"removing stale active-persisted set-job"];
                }
              }

              else
              {
                autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                diag = [autoControlManagerFSM2 diag];
                v68 = [NSString alloc];
                _updateLatestSummary8 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                v70 = [v68 initWithFormat:@"{loadPersistedSetActiveJobDescriptors} nil entryID encountered on staleActivePersistedEntryIDs | %@", _updateLatestSummary8];
                [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v70 withResult:6108 withError:0];
              }

              objc_autoreleasePoolPop(v62);
            }

            v55 = v91;
            v58 = [v91 countByEnumeratingWithState:&v92 objects:v100 count:16];
          }

          while (v58);
        }

        _updateLatestSummary10 = _MADLog(@"AutoControl");
        v71 = os_log_type_enabled(_updateLatestSummary10, OS_LOG_TYPE_DEFAULT);
        if (v79 < 1)
        {
          v7 = v78;
          if (v71)
          {
            _updateLatestSummary9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543362;
            v102 = _updateLatestSummary9;
            v74 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} no set-jobs resumed | MA_MILESTONE";
            v75 = _updateLatestSummary10;
            v76 = 12;
            goto LABEL_81;
          }
        }

        else
        {
          v7 = v78;
          if (v71)
          {
            _updateLatestSummary9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v73 = @"s";
            *buf = 138543874;
            v102 = _updateLatestSummary9;
            if (v79 == 1)
            {
              v73 = &stru_4BD3F0;
            }

            v103 = 2048;
            v104 = v79;
            v105 = 2114;
            v106 = v73;
            v74 = "[%{public}@] {loadPersistedSetActiveJobDescriptors} resumed %ld set-job%{public}@ | MA_MILESTONE";
            v75 = _updateLatestSummary10;
            v76 = 32;
LABEL_81:
            _os_log_impl(&dword_0, v75, OS_LOG_TYPE_DEFAULT, v74, buf, v76);
          }
        }

LABEL_82:

        goto LABEL_83;
      }
    }
  }

  v55 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v102 = _updateLatestSummary10;
    _os_log_impl(&dword_0, v55, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetActiveJobDescriptors} no persisted auto-asset-set-jobs to be resumed | MA_MILESTONE", buf, 0xCu);
    goto LABEL_82;
  }

LABEL_83:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedSetActiveJobDescriptors" forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS"];
}

- (void)loadPersistedSetTargets
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [persistedSetTargets loadPersistedState:@"loadPersistedSetTargets"];

  persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  persistedConfig = [persistedSetTargets2 persistedConfig];
  v8 = [persistedConfig stringForKey:@"bootedOSVersion"];

  persistedSetTargets3 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  persistedConfig2 = [persistedSetTargets3 persistedConfig];
  v11 = [persistedConfig2 stringForKey:@"bootedBuildVersion"];

  persistedSetTargets4 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v13 = [persistedSetTargets4 persistedEntryIDs:@"loadPersistedSetTargets"];

  if (v8)
  {
    v14 = v11 == 0;
  }

  else
  {
    v14 = 1;
  }

  v15 = !v14;
  if (v14)
  {
    v40 = @"previous MA daemon execution was running version prior to having support for set-targets";
  }

  else
  {
    bootedOSVersion = [(MADAutoAssetControlManager *)self bootedOSVersion];
    if (([SUCore stringIsEqual:v8 to:bootedOSVersion]& 1) != 0)
    {
      bootedOSBuildVersion = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
      v18 = [SUCore stringIsEqual:v11 to:bootedOSBuildVersion];

      if (v18)
      {
        v19 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          bootedOSVersion2 = [(MADAutoAssetControlManager *)self bootedOSVersion];
          bootedOSBuildVersion2 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
          *buf = 138543874;
          v83 = _updateLatestSummary;
          v84 = 2114;
          v85 = bootedOSVersion2;
          v86 = 2114;
          v87 = bootedOSBuildVersion2;
          _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetTargets} keeping set-targets (and not adjusting set-configurations) since last-OS version matches current OS version | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
        }

        if ([v13 count])
        {
          v68 = v11;
          v70 = v8;
          [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedSetTargets" ofContainer:@"persistedSetTargets"];
          v80 = 0u;
          v81 = 0u;
          v78 = 0u;
          v79 = 0u;
          v66 = v13;
          v23 = v13;
          obj = [v23 countByEnumeratingWithState:&v78 objects:v91 count:16];
          if (!obj)
          {
            goto LABEL_28;
          }

          v24 = *v79;
          while (1)
          {
            for (i = 0; i != obj; i = i + 1)
            {
              if (*v79 != v24)
              {
                objc_enumerationMutation(v23);
              }

              v26 = *(*(&v78 + 1) + 8 * i);
              v27 = objc_autoreleasePoolPush();
              persistedSetTargets5 = [(MADAutoAssetControlManager *)self persistedSetTargets];
              v29 = [persistedSetTargets5 persistedEntry:v26 fromLocation:@"loadPersistedSetTargets"];

              if (v29)
              {
                persistedSetTargets6 = [(MADAutoAssetControlManager *)self persistedSetTargets];
                v31 = [persistedSetTargets6 decodeFromLocation:@"loadPersistedSetTargets" ofEntryName:v26 fromPersistedEntry:v29 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

                if (v31)
                {
                  [(MADAutoAssetControlManager *)self _logPersistedSetTarget:@"loadPersistedSetTargets" operation:@"ENTRY_LOAD" forPersistedEntryID:v26 withSetTarget:v31 message:@"set-target validated"];
                  goto LABEL_26;
                }

                _updateLatestSummary2 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(_updateLatestSummary2, OS_LOG_TYPE_ERROR))
                {
                  [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  v33 = v24;
                  v35 = v34 = v23;
                  *buf = 138543618;
                  v83 = v35;
                  v84 = 2114;
                  v85 = v26;
                  _os_log_impl(&dword_0, _updateLatestSummary2, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetTargets} unable to load set-target | entryID:%{public}@", buf, 0x16u);

                  v23 = v34;
                  v24 = v33;
                }
              }

              else
              {
                v31 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
                {
                  goto LABEL_26;
                }

                _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543618;
                v83 = _updateLatestSummary2;
                v84 = 2114;
                v85 = v26;
                _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedSetTargets} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
              }

LABEL_26:
              objc_autoreleasePoolPop(v27);
            }

            obj = [v23 countByEnumeratingWithState:&v78 objects:v91 count:16];
            if (!obj)
            {
LABEL_28:

              v36 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                bootedOSVersion3 = [(MADAutoAssetControlManager *)self bootedOSVersion];
                bootedOSBuildVersion3 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
                *buf = 138543874;
                v83 = _updateLatestSummary3;
                v84 = 2114;
                v85 = bootedOSVersion3;
                v86 = 2114;
                v87 = bootedOSBuildVersion3;
                _os_log_impl(&dword_0, v36, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedSetConfigurations} set-targets preserved | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@", buf, 0x20u);
              }

              v11 = v68;
              v8 = v70;
              v13 = v66;
              goto LABEL_55;
            }
          }
        }

        v36 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
        {
          goto LABEL_55;
        }

        _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        bootedOSVersion4 = [(MADAutoAssetControlManager *)self bootedOSVersion];
        bootedOSBuildVersion4 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
        *buf = 138543874;
        v83 = _updateLatestSummary4;
        v84 = 2114;
        v85 = bootedOSVersion4;
        v86 = 2114;
        v87 = bootedOSBuildVersion4;
        v62 = "[%{public}@] {loadPersistedSetConfigurations} no persisted set-targets to be resumed | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@";
        v63 = v36;
        v64 = 32;
LABEL_54:
        _os_log_impl(&dword_0, v63, OS_LOG_TYPE_DEFAULT, v62, buf, v64);

        goto LABEL_55;
      }
    }

    else
    {
    }

    [(MADAutoAssetControlManager *)self setBootedSoftwareUpdate:1];
    v40 = @"previous MA daemon execution was running from different OS version than booted OS version";
  }

  persistedSetTargets7 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  persistedConfig3 = [persistedSetTargets7 persistedConfig];
  bootedOSVersion5 = [(MADAutoAssetControlManager *)self bootedOSVersion];
  [persistedConfig3 persistString:bootedOSVersion5 forKey:@"bootedOSVersion"];

  persistedSetTargets8 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  persistedConfig4 = [persistedSetTargets8 persistedConfig];
  bootedOSBuildVersion5 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
  [persistedConfig4 persistString:bootedOSBuildVersion5 forKey:@"bootedBuildVersion"];

  if (v15 && [v13 count])
  {
    v65 = v40;
    v67 = v13;
    v69 = v11;
    v71 = v8;
    v76 = 0u;
    v77 = 0u;
    v74 = 0u;
    v75 = 0u;
    obja = v13;
    v47 = [obja countByEnumeratingWithState:&v74 objects:v90 count:16];
    if (v47)
    {
      v48 = v47;
      v49 = *v75;
      do
      {
        for (j = 0; j != v48; j = j + 1)
        {
          if (*v75 != v49)
          {
            objc_enumerationMutation(obja);
          }

          v51 = *(*(&v74 + 1) + 8 * j);
          v52 = objc_autoreleasePoolPush();
          persistedSetTargets9 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v54 = [persistedSetTargets9 persistedEntry:v51 fromLocation:@"loadPersistedSetTargets"];

          if (v54)
          {
            persistedSetTargets10 = [(MADAutoAssetControlManager *)self persistedSetTargets];
            v56 = [persistedSetTargets10 decodeFromLocation:@"loadPersistedSetTargets" ofEntryName:v51 fromPersistedEntry:v54 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

            if (v56)
            {
              [(MADAutoAssetControlManager *)self modifySetConfiguration:@"loadPersistedSetTargets" toEntriesFromSetTarget:v56];
            }

            else
            {
              v57 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v83 = v51;
                _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "{loadPersistedSetTargets} | no set-target entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v56 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v83 = v51;
              _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "{loadPersistedSetTargets} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v52);
        }

        v48 = [obja countByEnumeratingWithState:&v74 objects:v90 count:16];
      }

      while (v48);
    }

    v11 = v69;
    v8 = v71;
    v40 = v65;
    v13 = v67;
  }

  persistedSetTargets11 = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [persistedSetTargets11 removeAllPersistedEntries:v40];

  v36 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v36, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    bootedOSVersion4 = [(MADAutoAssetControlManager *)self bootedOSVersion];
    bootedOSBuildVersion4 = [(MADAutoAssetControlManager *)self bootedOSBuildVersion];
    *buf = 138544130;
    v83 = _updateLatestSummary4;
    v84 = 2114;
    v85 = v40;
    v86 = 2114;
    v87 = bootedOSVersion4;
    v88 = 2114;
    v89 = bootedOSBuildVersion4;
    v62 = "[%{public}@] {loadPersistedSetConfigurations} all set-targets removed | reason:%{public}@ | bootedOSVersion:%{public}@ | bootedOSBuildVersion:%{public}@";
    v63 = v36;
    v64 = 42;
    goto LABEL_54;
  }

LABEL_55:

  [(MADAutoAssetControlManager *)self _logPersistedSetTargetTableOfContents:@"loadPersistedSetTargets"];
}

- (void)loadPersistedActiveJobs
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  [persistedActiveJobs loadPersistedState:@"loadPersistedActiveJobs"];

  persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v7 = [persistedActiveJobs2 persistedEntryIDs:@"loadPersistedActiveJobs"];

  v8 = objc_alloc_init(NSMutableArray);
  v56 = v7;
  if ([v7 count])
  {
    v57 = v8;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedActiveJobs" ofContainer:@"persistedActiveJobs"];
    v70 = 0u;
    v71 = 0u;
    v68 = 0u;
    v69 = 0u;
    obj = v7;
    v62 = [obj countByEnumeratingWithState:&v68 objects:v79 count:16];
    if (v62)
    {
      v61 = *v69;
      do
      {
        v9 = 0;
        do
        {
          if (*v69 != v61)
          {
            objc_enumerationMutation(obj);
          }

          v10 = *(*(&v68 + 1) + 8 * v9);
          v11 = objc_autoreleasePoolPush();
          persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          v13 = [persistedActiveJobs3 persistedEntry:v10 fromLocation:@"loadPersistedActiveJobs"];

          if (v10)
          {
            v14 = v13 == 0;
          }

          else
          {
            v14 = 1;
          }

          if (!v14)
          {
            persistedActiveJobs4 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v19 = [persistedActiveJobs4 decodeFromLocation:@"loadPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v19)
            {
              if ([v19 isBlankEntry])
              {
                v20 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v74 = _updateLatestSummary;
                  v75 = 2114;
                  v76 = v10;
                  v22 = v20;
                  v23 = OS_LOG_TYPE_DEFAULT;
                  v24 = "[%{public}@] {loadPersistedActiveJobs} encountered blank previously active-job | entryID:%{public}@";
                  goto LABEL_32;
                }

                goto LABEL_33;
              }

              assetVersion = [v19 assetVersion];

              if (assetVersion)
              {
                if (![(MADAutoAssetControlManager *)self jobDescriptorInFlightNowOnFilesystem:v19])
                {
                  goto LABEL_34;
                }

                v26 = [MAAutoAssetSelector alloc];
                assetType = [v19 assetType];
                assetSpecifier = [v19 assetSpecifier];
                assetVersion2 = [v19 assetVersion];
                v20 = [v26 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion2];

                v58 = [(MADAutoAssetControlManager *)self jobSelectorKey:v20];
                if (v58)
                {
                  v30 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    summary = [v19 summary];
                    *buf = 138543874;
                    v74 = _updateLatestSummary2;
                    v75 = 2114;
                    v76 = v10;
                    v77 = 2114;
                    v78 = summary;
                    _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedActiveJobs} previously in-flight now on filesystem validated | entryID:%{public}@, adoptedDescriptor:%{public}@", buf, 0x20u);
                  }

                  [(MADAutoAssetControlManager *)self _statsIncrementPreviouslyDownloadedForDescriptor:v19];
                  [v19 setIsOnFilesystem:1];
                  metadata = [v19 metadata];
                  v34 = [metadata safeIntegerForKey:@"_UnarchivedSize"];

                  if (v34 >= 1)
                  {
                    [v19 setDownloadedNetworkBytes:v34];
                    [v19 setDownloadedFilesystemBytes:v34];
                  }

                  LOBYTE(v55) = 0;
                  [(MADAutoAssetControlManager *)self trackDescriptor:v19 persisting:1 fromLocation:@"loadPersistedActiveJobs" changedWhileTerminated:1 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v55];
                  [(MADAutoAssetControlManager *)self _logPersistedEntry:@"loadPersistedActiveJobs" forComponentType:@"DOWNLOADED_DESCRIPTORS" operation:@"ENTRY_LOAD" forPersistedEntryID:v10 forClientRequest:0 withJobUUID:0 withAssetDescriptor:v19 baseForPatchDescriptor:0 message:@"previously in-flight now on filesystem validated", v56];
                  [v57 addObject:v10];
                }

                else
                {
                  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                  diag = [autoControlManagerFSM2 diag];
                  v37 = [NSString alloc];
                  summary2 = [v20 summary];
                  v39 = [v37 initWithFormat:@"{loadPersistedActiveJobs} nil jobSelectorKey | assetSelector:%@", summary2];
                  [diag trackAnomaly:@"AUTO-CONTROL" forReason:v39 withResult:6103 withError:0];
                }

                goto LABEL_33;
              }

              v20 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
              {
LABEL_33:

                goto LABEL_34;
              }

              _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v74 = _updateLatestSummary;
              v75 = 2114;
              v76 = v10;
              v22 = v20;
              v23 = OS_LOG_TYPE_DEFAULT;
              v24 = "[%{public}@] {loadPersistedActiveJobs} encountered active-job descriptor without asset-version - not reloaded | entryID:%{public}@";
            }

            else
            {
              v20 = _MADLog(@"AutoControl");
              if (!os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
              {
                goto LABEL_33;
              }

              _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v74 = _updateLatestSummary;
              v75 = 2114;
              v76 = v10;
              v22 = v20;
              v23 = OS_LOG_TYPE_ERROR;
              v24 = "[%{public}@] {loadPersistedActiveJobs} unable to previously active-job | entryID:%{public}@";
            }

LABEL_32:
            _os_log_impl(&dword_0, v22, v23, v24, buf, 0x16u);

            goto LABEL_33;
          }

          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v16 = _updateLatestSummary3;
            *buf = 138543618;
            v17 = @"N";
            if (v10)
            {
              v17 = v10;
            }

            v74 = _updateLatestSummary3;
            v75 = 2114;
            v76 = v17;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedActiveJobs} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }

LABEL_34:

          objc_autoreleasePoolPop(v11);
          v9 = v9 + 1;
        }

        while (v62 != v9);
        v40 = [obj countByEnumeratingWithState:&v68 objects:v79 count:16];
        v62 = v40;
      }

      while (v40);
    }

    v8 = v57;
    if ([v57 count])
    {
      obja = objc_autoreleasePoolPush();
      v64 = 0u;
      v65 = 0u;
      v66 = 0u;
      v67 = 0u;
      v63 = v57;
      v41 = [v63 countByEnumeratingWithState:&v64 objects:v72 count:16];
      if (v41)
      {
        v42 = v41;
        v43 = *v65;
        do
        {
          for (i = 0; i != v42; i = i + 1)
          {
            if (*v65 != v43)
            {
              objc_enumerationMutation(v63);
            }

            v45 = *(*(&v64 + 1) + 8 * i);
            persistedActiveJobs5 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v47 = [persistedActiveJobs5 persistedEntry:v45 fromLocation:@"loadPersistedActiveJobs"];

            if (v47)
            {
              persistedActiveJobs6 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v49 = [persistedActiveJobs6 decodeFromLocation:@"loadPersistedActiveJobs" ofEntryName:v45 fromPersistedEntry:v47 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              if (v49)
              {
                persistedActiveJobs7 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                [persistedActiveJobs7 removePersistedEntry:v45 fromLocation:@"loadPersistedActiveJobs"];

                [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"loadPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v45 removedDescriptor:v49 message:@"removing stale active-persisted job encountered while loading persisted state"];
              }

              else
              {
                v51 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                {
                  _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543618;
                  v74 = _updateLatestSummary4;
                  v75 = 2114;
                  v76 = v45;
                  _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {loadPersistedActiveJobs} no persisted job descriptor for previously active-job | entryID:%{public}@", buf, 0x16u);
                }
              }
            }
          }

          v42 = [v63 countByEnumeratingWithState:&v64 objects:v72 count:16];
        }

        while (v42);
      }

      objc_autoreleasePoolPop(obja);
      v8 = v57;
    }
  }

  else
  {
    v53 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v74 = _updateLatestSummary5;
      _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {loadPersistedActiveJobs} no persisted auto-asset active-jobs to be resumed", buf, 0xCu);
    }
  }

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:@"loadPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS"];
}

- (void)loadPersistedCrosscheckStaleForceUnlock
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v101 = [(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:@"loadPersistedCrosscheckStaleForceUnlock"];
  v102 = objc_alloc_init(NSMutableArray);
  v106 = objc_alloc_init(NSMutableArray);
  v100 = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedCrosscheckStaleForceUnlock" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v131 = 0u;
  v132 = 0u;
  v129 = 0u;
  v130 = 0u;
  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v6 = [knownSetAtomicInstancesByInstance countByEnumeratingWithState:&v129 objects:v139 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v130;
    v103 = knownSetAtomicInstancesByInstance;
    v104 = *v130;
    do
    {
      v9 = 0;
      obj = v7;
      do
      {
        if (*v130 != v8)
        {
          objc_enumerationMutation(knownSetAtomicInstancesByInstance);
        }

        v10 = *(*(&v129 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v13 = [knownSetAtomicInstancesByInstance2 safeObjectForKey:v10 ofClass:objc_opt_class()];

        if (!v13)
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v25 = [[NSString alloc] initWithFormat:@"{loadPersistedCrosscheckStaleForceUnlock} unable to access knownSetAtomicInstancesByInstance | atomicInstanceKey:%@", v10];
          [diag trackAnomaly:@"STARTUP-CROSSCHECK" forReason:v25 withResult:6103 withError:0];

          goto LABEL_31;
        }

        v110 = v11;
        atomicInstanceUUID = [v13 atomicInstanceUUID];
        autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedCrosscheckStaleForceUnlock" forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

        if (autoControlManagerFSM2)
        {
          v16 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"loadPersistedCrosscheckStaleForceUnlock" forSetDescriptor:autoControlManagerFSM2];
          clientDomainName = [v13 clientDomainName];
          assetSetIdentifier = [v13 assetSetIdentifier];
          v19 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

          atomicInstanceUUID2 = [v13 atomicInstanceUUID];
          v21 = [(MADAutoAssetControlManager *)self setConfigurationIsTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v19 forAtomicInstanceUUID:atomicInstanceUUID2];

          if (v19)
          {
            if ([(MADAutoAssetControlManager *)self doesSetDescriptorReferenceDropped:@"loadPersistedCrosscheckStaleForceUnlock" forSetDescriptor:autoControlManagerFSM2])
            {
              [v106 addObject:v13];
              v22 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
              {
                summary = [v13 summary];
                *buf = 138543362;
                v138 = summary;
                _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping atomic-instance (referenced asset dropped) | setAtomicInstance:%{public}@", buf, 0xCu);
              }

              goto LABEL_13;
            }

            atomicInstanceUUID3 = [v13 atomicInstanceUUID];
            latestAtomicInstanceToVend = [v19 latestAtomicInstanceToVend];
            v34 = [SUCore stringIsEqual:atomicInstanceUUID3 to:latestAtomicInstanceToVend];

            knownSetAtomicInstancesByInstance = v103;
            v11 = v110;
            if (v34)
            {
LABEL_30:

              v7 = obj;
              v8 = v104;
              goto LABEL_31;
            }

            atomicInstanceUUID4 = [v13 atomicInstanceUUID];
            newerAtomicInstanceOncePersonalized = [v19 newerAtomicInstanceOncePersonalized];
            v37 = [SUCore stringIsEqual:atomicInstanceUUID4 to:newerAtomicInstanceOncePersonalized];

            if (v37)
            {
              v38 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
              {
                summary2 = [v13 summary];
                *buf = 138543362;
                v138 = summary2;
                _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} preserving atomic-instance (newer-once-personalized) | setAtomicInstance:%{public}@", buf, 0xCu);
              }

              knownSetAtomicInstancesByInstance = v103;
LABEL_13:
              v11 = v110;
              goto LABEL_30;
            }

            if (v101 & 1 | ((v21 & 1) == 0))
            {
              knownSetAtomicInstancesByInstance = v103;
              v11 = v110;
              if ((v16 | v21))
              {
                if (v21)
                {
                  [v100 addObject:v13];
                  goto LABEL_30;
                }

                [v102 addObject:v13];
                v28 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
                {
                  summary3 = [v13 summary];
                  *buf = 138543362;
                  v138 = summary3;
                  v30 = v28;
                  v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping locked atomic-instance (not latest-to-vend) (not previously-latest-still-locked) | setAtomicInstance:%{public}@";
LABEL_28:
                  _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, v31, buf, 0xCu);
                }
              }

              else
              {
                [v106 addObject:v13];
                v28 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
                {
                  summary3 = [v13 summary];
                  *buf = 138543362;
                  v138 = summary3;
                  v30 = v28;
                  v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping unlocked atomic-instance (not latest-to-vend) | setAtomicInstance:%{public}@";
                  goto LABEL_28;
                }
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              knownSetAtomicInstancesByInstance = v103;
              v11 = v110;
              if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
              {
                summary3 = [v13 summary];
                *buf = 138543362;
                v138 = summary3;
                v30 = v28;
                v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} preserving locked atomic-instance (previously-vended-locked) | setAtomicInstance:%{public}@";
                goto LABEL_28;
              }
            }
          }

          else if ((v16 | v21))
          {
            [v102 addObject:v13];
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              summary3 = [v13 summary];
              *buf = 138543362;
              v138 = summary3;
              v30 = v28;
              v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping locked atomic-instance without set-configuration | setAtomicInstance:%{public}@";
              goto LABEL_28;
            }
          }

          else
          {
            [v106 addObject:v13];
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              summary3 = [v13 summary];
              *buf = 138543362;
              v138 = summary3;
              v30 = v28;
              v31 = "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping unlocked atomic-instance without set-configuration | setAtomicInstance:%{public}@";
              goto LABEL_28;
            }
          }

          goto LABEL_30;
        }

        v26 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
        {
          summary4 = [v13 summary];
          *buf = 138543362;
          v138 = summary4;
          _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, "\n[STARTUP-CROSSCHECK] {loadPersistedCrosscheckStaleForceUnlock} dropping atomic-instance without set-descriptor | setAtomicInstance:%{public}@", buf, 0xCu);
        }

        [v106 addObject:v13];
LABEL_31:

        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v7 != v9);
      v40 = [knownSetAtomicInstancesByInstance countByEnumeratingWithState:&v129 objects:v139 count:16];
      v7 = v40;
    }

    while (v40);
  }

  v127 = 0u;
  v128 = 0u;
  v125 = 0u;
  v126 = 0u;
  obja = v102;
  v41 = [obja countByEnumeratingWithState:&v125 objects:v136 count:16];
  if (v41)
  {
    v42 = v41;
    v43 = *v126;
    do
    {
      for (i = 0; i != v42; i = i + 1)
      {
        if (*v126 != v43)
        {
          objc_enumerationMutation(obja);
        }

        v45 = *(*(&v125 + 1) + 8 * i);
        v46 = objc_autoreleasePoolPush();
        if (v45)
        {
          clientDomainName2 = [v45 clientDomainName];
          assetSetIdentifier2 = [v45 assetSetIdentifier];
          v49 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

          atomicInstanceUUID5 = [v45 atomicInstanceUUID];
          LOBYTE(assetSetIdentifier2) = [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v49 removingAtomicInstance:atomicInstanceUUID5];

          if ((assetSetIdentifier2 & 1) == 0)
          {
            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"loadPersistedCrosscheckStaleForceUnlock" dueToError:0 forgettingAtomicInstance:v45];
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v49 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (forceUnlockAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        }

        objc_autoreleasePoolPop(v46);
      }

      v42 = [obja countByEnumeratingWithState:&v125 objects:v136 count:16];
    }

    while (v42);
  }

  v123 = 0u;
  v124 = 0u;
  v121 = 0u;
  v122 = 0u;
  v107 = v106;
  v51 = [v107 countByEnumeratingWithState:&v121 objects:v135 count:16];
  if (v51)
  {
    v52 = v51;
    v111 = *v122;
    do
    {
      for (j = 0; j != v52; j = j + 1)
      {
        if (*v122 != v111)
        {
          objc_enumerationMutation(v107);
        }

        v54 = *(*(&v121 + 1) + 8 * j);
        v55 = objc_autoreleasePoolPush();
        if (v54)
        {
          atomicInstanceUUID6 = [v54 atomicInstanceUUID];
          v57 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedCrosscheckStaleForceUnlock" forAtomicInstanceUUID:atomicInstanceUUID6 requireExists:0];

          clientDomainName3 = [v54 clientDomainName];
          assetSetIdentifier3 = [v54 assetSetIdentifier];
          v60 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

          if (v57)
          {
            [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v57 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:343 historyOperationSD:387];
          }

          else
          {
            atomicInstanceUUID7 = [v54 atomicInstanceUUID];
            [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"loadPersistedCrosscheckStaleForceUnlock" setAtomicInstanceUUID:atomicInstanceUUID7 removingForReason:@"atomic-instance without associated set-descriptor" historyOperation:345];
          }

          atomicInstanceUUID8 = [v54 atomicInstanceUUID];
          v63 = [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v60 removingAtomicInstance:atomicInstanceUUID8];

          if ((v63 & 1) == 0)
          {
            [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"loadPersistedCrosscheckStaleForceUnlock" dueToError:0 forgettingAtomicInstance:v54];
          }

          [(MADAutoAssetControlManager *)self setConfigurationPersist:v60 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (dropAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        }

        objc_autoreleasePoolPop(v55);
      }

      v52 = [v107 countByEnumeratingWithState:&v121 objects:v135 count:16];
    }

    while (v52);
  }

  v119 = 0u;
  v120 = 0u;
  v117 = 0u;
  v118 = 0u;
  v112 = v100;
  v64 = [v112 countByEnumeratingWithState:&v117 objects:v134 count:16];
  if (v64)
  {
    v65 = v64;
    v66 = *v118;
    do
    {
      for (k = 0; k != v65; k = k + 1)
      {
        if (*v118 != v66)
        {
          objc_enumerationMutation(v112);
        }

        v68 = *(*(&v117 + 1) + 8 * k);
        v69 = objc_autoreleasePoolPush();
        clientDomainName4 = [v68 clientDomainName];
        assetSetIdentifier4 = [v68 assetSetIdentifier];
        v72 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4];

        atomicInstanceUUID9 = [v68 atomicInstanceUUID];
        [(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"loadPersistedCrosscheckStaleForceUnlock" forSetConfiguration:v72 removingAtomicInstance:atomicInstanceUUID9];

        [(MADAutoAssetControlManager *)self setConfigurationPersist:v72 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared previoulsy-vended (nextForgetPreviouslyVendedAtomicInstance)" dueToAlter:0 forHistoryOperation:9999];
        objc_autoreleasePoolPop(v69);
      }

      v65 = [v112 countByEnumeratingWithState:&v117 objects:v134 count:16];
    }

    while (v65);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedCrosscheckStaleForceUnlock" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v115 = 0u;
  v116 = 0u;
  v113 = 0u;
  v114 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v76 = [allKeys copy];

  v105 = v76;
  v77 = [v76 countByEnumeratingWithState:&v113 objects:v133 count:16];
  if (v77)
  {
    v78 = v77;
    v79 = *v114;
    do
    {
      for (m = 0; m != v78; m = m + 1)
      {
        if (*v114 != v79)
        {
          objc_enumerationMutation(v105);
        }

        v81 = *(*(&v113 + 1) + 8 * m);
        v82 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v84 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v81 ofClass:objc_opt_class()];

        if (!v84)
        {
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag2 = [autoControlManagerFSM3 diag];
          v91 = [[NSString alloc] initWithFormat:@"{loadPersistedCrosscheckStaleForceUnlock} unable to access knownSetConfigurationsByIdentifier | setConfigurationKey:%@", v81];
          [diag2 trackAnomaly:@"STARTUP-CROSSCHECK" forReason:v91 withResult:6103 withError:0];

          goto LABEL_95;
        }

        newerAtomicInstanceOncePersonalized2 = [v84 newerAtomicInstanceOncePersonalized];
        if (newerAtomicInstanceOncePersonalized2)
        {
          newerAtomicInstanceOncePersonalized3 = [v84 newerAtomicInstanceOncePersonalized];
          v87 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:newerAtomicInstanceOncePersonalized3];

          v88 = v87 == 0;
        }

        else
        {
          v88 = 1;
        }

        latestAtomicInstanceToVend2 = [v84 latestAtomicInstanceToVend];
        if (latestAtomicInstanceToVend2)
        {
          latestAtomicInstanceToVend3 = [v84 latestAtomicInstanceToVend];
          v94 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend3];

          v95 = v94 == 0;
        }

        else
        {
          v95 = 1;
        }

        newerAtomicInstanceOncePersonalized4 = [v84 newerAtomicInstanceOncePersonalized];
        v97 = newerAtomicInstanceOncePersonalized4 != 0 && v88;

        if (v97 == 1)
        {
          [v84 setNewerAtomicInstanceOncePersonalized:0];
        }

        latestAtomicInstanceToVend4 = [v84 latestAtomicInstanceToVend];
        v99 = latestAtomicInstanceToVend4 != 0 && v95;

        if (v99 == 1)
        {
          [v84 setLatestAtomicInstanceToVend:0];
          [v84 setLatestAtomicInstanceToVendFromPreSUStaging:0];
        }

        else if (!v97)
        {
          goto LABEL_95;
        }

        [(MADAutoAssetControlManager *)self setConfigurationPersist:v84 fromLocation:@"loadPersistedCrosscheckStaleForceUnlock" forReason:@"cleared stale references from set-configuration" dueToAlter:0 forHistoryOperation:9999];
LABEL_95:

        objc_autoreleasePoolPop(v82);
      }

      v78 = [v105 countByEnumeratingWithState:&v113 objects:v133 count:16];
    }

    while (v78);
  }
}

- (void)verifyLockerLatestSymlink
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)self startupActivationIsFirstExecutionSinceBoot:@"verifyLatestLockerSymlink"])
  {
    context = objc_autoreleasePoolPush();
    v5 = +[NSFileManager defaultManager];
    v6 = [NSURL URLWithString:@"/private/var/MobileAsset/AssetsV2/locks"];
    v42 = v5;
    v7 = [v5 enumeratorAtURL:v6 includingPropertiesForKeys:&__NSArray0__struct options:4 errorHandler:0];

    v39 = objc_alloc_init(NSMutableArray);
    v41 = [[NSString alloc] initWithFormat:@"%@_%@.%@", @"atomic_instance", @"latest", @"locker"];
    v50 = 0u;
    v51 = 0u;
    v52 = 0u;
    v53 = 0u;
    v8 = v7;
    v9 = [v8 countByEnumeratingWithState:&v50 objects:v59 count:16];
    v40 = v8;
    if (v9)
    {
      v10 = v9;
      v11 = *v51;
      v12 = NSURLNameKey;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      do
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v51 != v11)
          {
            objc_enumerationMutation(v8);
          }

          v15 = *(*(&v50 + 1) + 8 * i);
          v49 = 0;
          [v15 getResourceValue:&v49 forKey:NSURLIsSymbolicLinkKey error:0];
          v16 = v49;
          if ([v16 BOOLValue])
          {
            v48 = 0;
            [v15 getResourceValue:&v48 forKey:v12 error:0];
            v17 = v48;
            if ([p_weak_ivar_lyt[223] stringIsEqual:v17 to:v41])
            {
              v18 = p_weak_ivar_lyt;
              path = [v15 path];
              v20 = isValidSymlink(path);

              v21 = _MADLog(@"AutoControl");
              v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
              if (v20)
              {
                if (v22)
                {
                  path2 = [v15 path];
                  *buf = 138543362;
                  v55 = path2;
                  _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{verifyLockerLatestSymlink} Symlink %{public}@ confirmed to have valid target", buf, 0xCu);
                }
              }

              else
              {
                if (v22)
                {
                  path3 = [v15 path];
                  *buf = 138543362;
                  v55 = path3;
                  _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "{verifyLockerLatestSymlink} Symlink %{public}@ does not have a valid target, it will be removed", buf, 0xCu);
                }

                [v39 addObject:v15];
              }

              p_weak_ivar_lyt = v18;
              v8 = v40;
              v12 = NSURLNameKey;
            }
          }
        }

        v10 = [v8 countByEnumeratingWithState:&v50 objects:v59 count:16];
      }

      while (v10);
    }

    v46 = 0u;
    v47 = 0u;
    v44 = 0u;
    v45 = 0u;
    v25 = v39;
    v26 = [v25 countByEnumeratingWithState:&v44 objects:v58 count:16];
    if (v26)
    {
      v27 = v26;
      v28 = *v45;
      do
      {
        for (j = 0; j != v27; j = j + 1)
        {
          if (*v45 != v28)
          {
            objc_enumerationMutation(v25);
          }

          v30 = *(*(&v44 + 1) + 8 * j);
          v43 = 0;
          [v42 removeItemAtURL:v30 error:&v43];
          v31 = v43;
          v32 = _MADLog(@"AutoControl");
          v33 = os_log_type_enabled(v32, OS_LOG_TYPE_ERROR);
          if (v31)
          {
            if (!v33)
            {
              goto LABEL_31;
            }

            path4 = [v30 path];
            *buf = 138543618;
            v55 = path4;
            v56 = 2114;
            v57 = v31;
            v35 = v32;
            v36 = "{verifyLockerLatestSymlink} Tried to remove invalid symlink %{public}@, but failed with error: %{public}@";
            v37 = 22;
          }

          else
          {
            if (!v33)
            {
              goto LABEL_31;
            }

            path4 = [v30 path];
            *buf = 138543362;
            v55 = path4;
            v35 = v32;
            v36 = "{verifyLockerLatestSymlink} Successfully removed invalid symlink %{public}@";
            v37 = 12;
          }

          _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, v36, buf, v37);

LABEL_31:
        }

        v27 = [v25 countByEnumeratingWithState:&v44 objects:v58 count:16];
      }

      while (v27);
    }

    objc_autoreleasePoolPop(context);
  }
}

- (void)firstSchedulerCrosscheckTrim
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locateSetDescriptorsDownloaded = [(MADAutoAssetControlManager *)self locateSetDescriptorsDownloaded];
  if (!locateSetDescriptorsDownloaded)
  {
    locateSetDescriptorsDownloaded = objc_alloc_init(NSArray);
  }

  v6 = [MADAutoAssetLocker eliminateAllPreviousSetLocksNoLongerTracked:locateSetDescriptorsDownloaded];
  v7 = _MADLog(@"AutoControl");
  v8 = os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT);
  if (v6)
  {
    if (v8)
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543618;
      v25 = _updateLatestSummary;
      v26 = 2048;
      v27 = [v6 count];
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {firstSchedulerCrosscheckTrim} just unlocked selectors:%ld", buf, 0x16u);
    }

    v21 = 0u;
    v22 = 0u;
    v19 = 0u;
    v20 = 0u;
    v7 = v6;
    v10 = [v7 countByEnumeratingWithState:&v19 objects:v23 count:16];
    if (v10)
    {
      v11 = v10;
      v12 = *v20;
      do
      {
        for (i = 0; i != v11; i = i + 1)
        {
          if (*v20 != v12)
          {
            objc_enumerationMutation(v7);
          }

          v14 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v19 + 1) + 8 * i)];
          if (v14)
          {
            [(MADAutoAssetControlManager *)self secureCheckUngraft:@"firstSchedulerCrosscheckTrim" forDescriptorNoLongerLocked:v14];
          }
        }

        v11 = [v7 countByEnumeratingWithState:&v19 objects:v23 count:16];
      }

      while (v11);
    }
  }

  else if (v8)
  {
    _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543362;
    v25 = _updateLatestSummary2;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {firstSchedulerCrosscheckTrim} no selectors just unlocked", buf, 0xCu);
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke;
  block[3] = &unk_4B2AA0;
  block[4] = self;
  dispatch_async(extendedStateQueue2, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerCrosscheckTrimSetDescriptors];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_2;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_2(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerCrosscheckTrimAtomicInstances];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_3;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

void __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_3(uint64_t a1)
{
  [*(a1 + 32) firstSchedulerShortTermLockContentChecks:@"firstSchedulerCrosscheckTrim"];
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_4;
  block[3] = &unk_4B2AA0;
  block[4] = *(a1 + 32);
  dispatch_async(v3, block);
}

id __58__MADAutoAssetControlManager_firstSchedulerCrosscheckTrim__block_invoke_4(uint64_t a1)
{
  [*(a1 + 32) trackPerformanceStartupStep:@"firstSchedulerCrosscheckTrim" beginningStep:@"_removeDownloadedDescriptorsWithNewerDownloaded"];
  v2 = *(a1 + 32);

  return [v2 _removeDownloadedDescriptorsWithNewerDownloaded:@"firstSchedulerCrosscheckTrim"];
}

- (void)firstSchedulerCrosscheckTrimAtomicInstances
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v6 = [persistedKnownSetAtomicInstances persistedEntryIDs:@"firstSchedulerCrosscheckTrimAtomicInstances"];

  if (![v6 count])
  {
    goto LABEL_101;
  }

  v7 = objc_alloc_init(NSMutableArray);
  v88 = objc_alloc_init(NSMutableArray);
  v100 = objc_alloc_init(NSMutableDictionary);
  v104 = +[NSFileManager defaultManager];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"firstSchedulerCrosscheckTrimAtomicInstances" ofContainer:@"persistedKnownSetAtomicInstances"];
  v119 = 0u;
  v120 = 0u;
  v117 = 0u;
  v118 = 0u;
  v87 = v6;
  v8 = v6;
  v9 = [v8 countByEnumeratingWithState:&v117 objects:v129 count:16];
  if (!v9)
  {
    goto LABEL_82;
  }

  v11 = v9;
  v107 = *v118;
  *&v10 = 138543618;
  v86 = v10;
  v97 = v8;
  v98 = v7;
  do
  {
    v12 = 0;
    v105 = v11;
    do
    {
      if (*v118 != v107)
      {
        objc_enumerationMutation(v8);
      }

      v13 = *(*(&v117 + 1) + 8 * v12);
      v14 = objc_autoreleasePoolPush();
      persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
      v16 = [persistedKnownSetAtomicInstances2 persistedEntry:v13 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances"];

      if (v13)
      {
        v17 = v16 == 0;
      }

      else
      {
        v17 = 1;
      }

      if (!v17)
      {
        persistedKnownSetAtomicInstances3 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v21 = [persistedKnownSetAtomicInstances3 decodeFromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

        v22 = [(MADAutoAssetControlManager *)self atomicInstanceNewIdentifierForSetAtomicInstance:v21];
        v23 = v22;
        if (v21)
        {
          v24 = v22 == 0;
        }

        else
        {
          v24 = 1;
        }

        if (v24)
        {
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            if (v21)
            {
              summary = [v21 summary];
              v26 = summary;
              v27 = @"N";
            }

            else
            {
              v27 = @"N";
              v26 = @"N";
            }

            *buf = 138543874;
            if (v23)
            {
              v27 = v23;
            }

            v124 = v13;
            v125 = 2114;
            v126 = v26;
            v127 = 2114;
            v128 = v27;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to load set-atomic-instance | entryID:%{public}@ | setAtomicInstance:%{public}@ | fullSetIdentifier:%{public}@", buf, 0x20u);
            if (v21)
            {
            }
          }
        }

        else
        {
          if ([(MADAutoAssetControlManager *)self atomicInstanceHasDownloadedSetDescriptor:v21 verboseLogging:0])
          {
            clientDomainName = [v21 clientDomainName];
            assetSetIdentifier = [v21 assetSetIdentifier];
            v31 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

            atomicInstanceUUID = [v21 atomicInstanceUUID];
            obj = v31;
            discoveredInFlightAtomicInstance = [v31 discoveredInFlightAtomicInstance];
            if (([SUCore stringIsEqual:atomicInstanceUUID to:discoveredInFlightAtomicInstance]& 1) != 0)
            {
              goto LABEL_32;
            }

            v95 = v14;
            atomicInstanceUUID2 = [v21 atomicInstanceUUID];
            newerAtomicInstanceOncePersonalized = [obj newerAtomicInstanceOncePersonalized];
            if (([SUCore stringIsEqual:atomicInstanceUUID2 to:newerAtomicInstanceOncePersonalized]& 1) != 0)
            {
              goto LABEL_31;
            }

            v91 = newerAtomicInstanceOncePersonalized;
            v93 = atomicInstanceUUID2;
            atomicInstanceUUID3 = [v21 atomicInstanceUUID];
            latestAtomicInstanceToVend = [obj latestAtomicInstanceToVend];
            v90 = atomicInstanceUUID3;
            v38 = atomicInstanceUUID3;
            v39 = latestAtomicInstanceToVend;
            if (([SUCore stringIsEqual:v38 to:latestAtomicInstanceToVend]& 1) == 0)
            {
              atomicInstanceUUID4 = [v21 atomicInstanceUUID];
              v89 = [(MADAutoAssetControlManager *)self setConfigurationIsTrackedAsPreviouslyVended:@"firstSchedulerCrosscheckTrimAtomicInstances" forSetConfiguration:obj forAtomicInstanceUUID:?];

              v14 = v95;
              if (v89)
              {
                goto LABEL_33;
              }

              v52 = _MADLog(@"AutoControl");
              v7 = v98;
              if (os_log_type_enabled(v52, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v124 = v13;
                _os_log_impl(&dword_0, v52, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance not tracked by set-configuration | entryID:%{public}@", buf, 0xCu);
              }

              [v98 addObject:v13];
              v8 = v97;
              v50 = obj;
              goto LABEL_78;
            }

            atomicInstanceUUID2 = v93;
LABEL_31:

            v14 = v95;
LABEL_32:

LABEL_33:
            v40 = [v100 safeObjectForKey:v23 ofClass:objc_opt_class()];
            v7 = v98;
            if (v40)
            {
              v41 = v40;
LABEL_48:
              v8 = v97;
              [v41 addObject:{v21, v86}];
              [v100 setSafeObject:v41 forKey:v23];
              if ([v41 count] >= 7 && !+[MADAutoAssetControlManager preferenceAutoAssetNoPersistedOverflowLimit](MADAutoAssetControlManager, "preferenceAutoAssetNoPersistedOverflowLimit"))
              {
                v43 = [(MADAutoAssetControlManager *)self atomicInstanceOverflowRemove:v41];
                v96 = v43;
                if (v43)
                {
                  v44 = v43;
                  v94 = [(MADAutoAssetControlManager *)self atomicInstanceNewEntryIDForSetAtomicInstance:v43];
                  if (v94)
                  {
                    if ([(MADAutoAssetControlManager *)self isAtomicInstanceForCurrentSetJob:v44])
                    {
                      v45 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v45, OS_LOG_TYPE_DEFAULT))
                      {
                        summary2 = [v96 summary];
                        *buf = 138543362;
                        v124 = summary2;
                        v47 = v45;
                        v48 = OS_LOG_TYPE_DEFAULT;
                        v49 = "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} not subject to verflow trim - atomic-instance for currently active set-job (keeping) | setAtomicInstance:%{public}@";
                        goto LABEL_66;
                      }

                      goto LABEL_67;
                    }

                    atomicInstanceUUID5 = [v44 atomicInstanceUUID];
                    v57 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"firstSchedulerCrosscheckTrimAtomicInstances" forAtomicInstanceUUID:atomicInstanceUUID5 requireExists:0];

                    v58 = _MADLog(@"AutoControl");
                    v59 = os_log_type_enabled(v58, OS_LOG_TYPE_ERROR);
                    v92 = v57;
                    if (v57)
                    {
                      v7 = v98;
                      if (v59)
                      {
                        summary3 = [v96 summary];
                        summary4 = [v92 summary];
                        *buf = v86;
                        v124 = summary3;
                        v125 = 2114;
                        v126 = summary4;
                        _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} [WARNING] over threshold for atomic-instances by set-identifier (trimming) | setAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x16u);

                        v7 = v98;
                      }

                      [v7 addObject:v94];
                      latestDownloadedAtomicInstance = [v92 latestDownloadedAtomicInstance];
                      [v88 addObject:latestDownloadedAtomicInstance];

                      v55 = v92;
                      v8 = v97;
                      v50 = obj;
                    }

                    else
                    {
                      v7 = v98;
                      if (v59)
                      {
                        summary5 = [v96 summary];
                        *buf = 138543362;
                        v124 = summary5;
                        _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance without backing set-descriptor | removedOverflowAtomicInstance:%{public}@", buf, 0xCu);

                        v7 = v98;
                      }

                      [v7 addObject:v13];
                      v8 = v97;
                      v50 = obj;
                      v55 = 0;
                    }
                  }

                  else
                  {
                    v45 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
                    {
                      summary2 = [v96 summary];
                      *buf = 138543362;
                      v124 = summary2;
                      v47 = v45;
                      v48 = OS_LOG_TYPE_ERROR;
                      v49 = "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to determine persisted-set-atomic-instance file | setAtomicInstance:%{public}@";
LABEL_66:
                      _os_log_impl(&dword_0, v47, v48, v49, buf, 0xCu);
                    }

LABEL_67:
                    v50 = obj;
                    v55 = v45;
                    v7 = v98;
                  }
                }

                else
                {
                  v53 = _MADLog(@"AutoControl");
                  v94 = v53;
                  if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
                  {
                    summary6 = [v21 summary];
                    *buf = 138543362;
                    v124 = summary6;
                    _os_log_impl(&dword_0, v53, OS_LOG_TYPE_ERROR, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} over threshold for atomic-instances by set-identifier (unable to reduce) | setAtomicInstance:%{public}@", buf, 0xCu);
                  }

                  v50 = obj;
                  v7 = v98;
                }

LABEL_77:
LABEL_78:

LABEL_79:
                v11 = v105;

                goto LABEL_80;
              }
            }

            else
            {
              v41 = objc_alloc_init(NSMutableArray);
              if (v41)
              {
                goto LABEL_48;
              }

              v8 = v97;
            }

            v50 = obj;
            goto LABEL_77;
          }

          if ([(MADAutoAssetControlManager *)self isAtomicInstanceForCurrentSetJob:v21])
          {
            v42 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543362;
              v124 = v13;
              _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance for currently active set-job (keeping) | entryID:%{public}@", buf, 0xCu);
            }

            goto LABEL_79;
          }

          [(MADAutoAssetControlManager *)self atomicInstanceHasDownloadedSetDescriptor:v21 verboseLogging:1];
          v25 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v124 = v13;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "\n[REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} atomic-instance without backing set-descriptor | entryID:%{public}@", buf, 0xCu);
          }
        }

        [v7 addObject:v13];
        goto LABEL_79;
      }

      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
      {
        v19 = @"N";
        if (v13)
        {
          v19 = v13;
        }

        *buf = 138543362;
        v124 = v19;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "\n[CONSIDER-REMOVAL] {firstSchedulerCrosscheckTrimAtomicInstances} unable to determine previous status | entryID:%{public}@", buf, 0xCu);
      }

      if (v13)
      {
        [v7 addObject:v13];
      }

LABEL_80:

      objc_autoreleasePoolPop(v14);
      v12 = v12 + 1;
    }

    while (v11 != v12);
    v11 = [v8 countByEnumeratingWithState:&v117 objects:v129 count:16];
  }

  while (v11);
LABEL_82:

  v115 = 0u;
  v116 = 0u;
  v113 = 0u;
  v114 = 0u;
  obja = v7;
  v64 = [obja countByEnumeratingWithState:&v113 objects:v122 count:16];
  if (v64)
  {
    v65 = v64;
    v66 = *v114;
    do
    {
      for (i = 0; i != v65; i = i + 1)
      {
        if (*v114 != v66)
        {
          objc_enumerationMutation(obja);
        }

        v68 = *(*(&v113 + 1) + 8 * i);
        v69 = objc_autoreleasePoolPush();
        persistedKnownSetAtomicInstances4 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v71 = [persistedKnownSetAtomicInstances4 persistedEntry:v68 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances"];

        persistedKnownSetAtomicInstances5 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v73 = [persistedKnownSetAtomicInstances5 decodeFromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" ofEntryName:v68 fromPersistedEntry:v71 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

        if (v73)
        {
          atomicInstanceUUID6 = [v73 atomicInstanceUUID];
          [(MADAutoAssetControlManager *)self atomicInstanceRemove:@"firstSchedulerCrosscheckTrimAtomicInstances" setAtomicInstanceUUID:atomicInstanceUUID6 removingForReason:@"dropping to avoid overflow" historyOperation:334];
        }

        objc_autoreleasePoolPop(v69);
      }

      v65 = [obja countByEnumeratingWithState:&v113 objects:v122 count:16];
    }

    while (v65);
  }

  selfCopy = self;

  v111 = 0u;
  v112 = 0u;
  v109 = 0u;
  v110 = 0u;
  v101 = v88;
  v75 = [v101 countByEnumeratingWithState:&v109 objects:v121 count:16];
  if (v75)
  {
    v76 = v75;
    v106 = *v110;
    do
    {
      for (j = 0; j != v76; j = j + 1)
      {
        if (*v110 != v106)
        {
          objc_enumerationMutation(v101);
        }

        v78 = *(*(&v109 + 1) + 8 * j);
        v79 = objc_autoreleasePoolPush();
        v80 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"firstSchedulerCrosscheckTrimAtomicInstances" forAtomicInstanceUUID:v78 requireExists:0];
        v81 = v80;
        if (v80)
        {
          clientDomainName2 = [v80 clientDomainName];
          assetSetIdentifier2 = [v81 assetSetIdentifier];
          v84 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forSetAtomicInstance:v78];

          [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorDownloaded:v81 fromLocation:@"firstSchedulerCrosscheckTrimAtomicInstances" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:330 historyOperationSD:374];
          v85 = [(MADAutoAssetControlManager *)selfCopy _shortTermSharedLockRemove:@"firstSchedulerCrosscheckTrimAtomicInstances" removingSharedLockFilename:v84 usingFileManager:v104 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
        }

        objc_autoreleasePoolPop(v79);
      }

      v76 = [v101 countByEnumeratingWithState:&v109 objects:v121 count:16];
    }

    while (v76);
  }

  v6 = v87;
LABEL_101:
}

- (void)firstSchedulerCrosscheckTrimSetDescriptors
{
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
  v6 = [persistedDownloadedSetDescriptors persistedEntryIDs:@"firstSchedulerCrosscheckTrimSetDescriptors"];

  if ([v6 count])
  {
    v59 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"firstSchedulerCrosscheckTrimSetDescriptors" ofContainer:@"persistedDownloadedSetDescriptors"];
    v69 = 0u;
    v70 = 0u;
    v67 = 0u;
    v68 = 0u;
    v52 = v6;
    v7 = v6;
    v8 = [v7 countByEnumeratingWithState:&v67 objects:v74 count:16];
    v54 = selfCopy;
    if (!v8)
    {
      goto LABEL_36;
    }

    v9 = v8;
    context = *v68;
    v55 = v7;
    while (1)
    {
      v10 = 0;
      v57 = v9;
      do
      {
        if (*v68 != context)
        {
          objc_enumerationMutation(v7);
        }

        v11 = *(*(&v67 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        if (v11)
        {
          persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
          v14 = [persistedDownloadedSetDescriptors2 persistedEntry:v11 fromLocation:@"firstSchedulerCrosscheckTrimSetDescriptors"];

          if (v14)
          {
            persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
            v16 = [persistedDownloadedSetDescriptors3 decodeFromLocation:@"firstSchedulerCrosscheckTrimSetDescriptors" ofEntryName:v11 fromPersistedEntry:v14 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v16)
            {
              latestDownloadedAtomicInstance = [v16 latestDownloadedAtomicInstance];

              if (latestDownloadedAtomicInstance)
              {
                latestDownloadedAtomicInstance2 = [v16 latestDownloadedAtomicInstance];
                v19 = [(MADAutoAssetControlManager *)selfCopy locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance2];

                clientDomainName = [v16 clientDomainName];
                assetSetIdentifier = [v16 assetSetIdentifier];
                v22 = [(MADAutoAssetControlManager *)selfCopy locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

                if (v19)
                {
                  if (v22)
                  {
                    if (![(MADAutoAssetControlManager *)v54 isEveryAssetEntryOnFilesystemForSetDescriptor:@"firstSchedulerCrosscheckTrimSetDescriptors" forSetDescriptor:v16])
                    {
                      v23 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                      {
                        summary = [v16 summary];
                        *buf = 138543362;
                        v73 = summary;
                        v25 = v23;
                        v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor referencing content not on the filesystem | setDescriptor:%{public}@";
                        goto LABEL_30;
                      }

LABEL_31:

                      [v59 addObject:v11];
                    }

                    selfCopy = v54;
                    v7 = v55;
LABEL_33:

                    v9 = v57;
                    goto LABEL_34;
                  }

                  v23 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                  {
                    goto LABEL_31;
                  }

                  summary = [v16 summary];
                  *buf = 138543362;
                  v73 = summary;
                  v25 = v23;
                  v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor without set-configuration | setDescriptor:%{public}@";
                }

                else
                {
                  v23 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
                  {
                    goto LABEL_31;
                  }

                  summary = [v16 summary];
                  *buf = 138543362;
                  v73 = summary;
                  v25 = v23;
                  v26 = "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor without atomic-instance | setDescriptor:%{public}@";
                }

LABEL_30:
                _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, v26, buf, 0xCu);

                goto LABEL_31;
              }

              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                summary2 = [v16 summary];
                *buf = 138543362;
                v73 = summary2;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] set-descriptor with no latestDownloadedAtomicInstance | setDescriptor:%{public}@", buf, 0xCu);

                selfCopy = v54;
              }
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v73 = v11;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] unable to load set-descriptor | entryID:%{public}@", buf, 0xCu);
              }
            }

            [v59 addObject:v11];
            goto LABEL_33;
          }

          v27 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543362;
            v73 = v11;
            _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} [DROP-SET-DESCRIPTOR] unable to load persisted entry | entryID:%{public}@", buf, 0xCu);
          }

          [v59 addObject:v11];
        }

        else
        {
          v14 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
          {
            *buf = 0;
            _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "{firstSchedulerCrosscheckTrimSetDescriptors} no entryID", buf, 2u);
          }
        }

LABEL_34:

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v9 != v10);
      v9 = [v7 countByEnumeratingWithState:&v67 objects:v74 count:16];
      if (!v9)
      {
LABEL_36:

        v65 = 0u;
        v66 = 0u;
        v63 = 0u;
        v64 = 0u;
        obj = v59;
        v58 = [obj countByEnumeratingWithState:&v63 objects:v71 count:16];
        if (!v58)
        {
          goto LABEL_49;
        }

        v30 = @"firstSchedulerCrosscheckTrimSetDescriptors";
        v31 = @"assetSetDescriptor";
        v56 = *v64;
        while (1)
        {
          for (i = 0; i != v58; i = i + 1)
          {
            if (*v64 != v56)
            {
              objc_enumerationMutation(obj);
            }

            v33 = *(*(&v63 + 1) + 8 * i);
            contexta = objc_autoreleasePoolPush();
            persistedDownloadedSetDescriptors4 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
            v35 = [persistedDownloadedSetDescriptors4 persistedEntry:v33 fromLocation:v30];

            persistedDownloadedSetDescriptors5 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
            v60 = v35;
            v37 = [persistedDownloadedSetDescriptors5 decodeFromLocation:v30 ofEntryName:v33 fromPersistedEntry:v35 decodingObjectForKey:v31 ofClass:objc_opt_class() allowingNilObject:0];

            if (v37)
            {
              latestDownloadedAtomicInstance3 = [v37 latestDownloadedAtomicInstance];

              if (latestDownloadedAtomicInstance3)
              {
                persistedDownloadedSetDescriptors6 = [(MADAutoAssetControlManager *)selfCopy persistedDownloadedSetDescriptors];
                [persistedDownloadedSetDescriptors6 removePersistedEntry:v33 fromLocation:v30];

                latestDowloadedAtomicInstanceEntries = [v37 latestDowloadedAtomicInstanceEntries];
                v41 = v31;
                v42 = v30;
                v43 = [latestDowloadedAtomicInstanceEntries count];
                clientDomainName2 = [v37 clientDomainName];
                assetSetIdentifier2 = [v37 assetSetIdentifier];
                discoveredAtomicInstance = [v37 discoveredAtomicInstance];
                v47 = v43;
                v30 = v42;
                v31 = v41;
                [MADAutoAssetHistory recordOperation:382 toHistoryType:2 fromLayer:1 usageCount:v47 forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 forAtomicInstance:discoveredAtomicInstance];

                selfCopy = v54;
                [(MADAutoAssetControlManager *)v54 _logPersistedSetDescriptorRemoved:v30 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v33 removedSetDescriptor:v37 message:@"removing previously persisted downloaded-set-descriptor that no longer had backing latest downloaded atomic-instance"];
                goto LABEL_47;
              }

              v48 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
            }

            else
            {
              v48 = @"EntryID: %@. descriptor to be dropped is nil";
            }

            v49 = [[NSString alloc] initWithFormat:v48, v33];
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            [diag trackAnomaly:v30 forReason:v49 withResult:6101 withError:0];

LABEL_47:
            objc_autoreleasePoolPop(contexta);
          }

          v58 = [obj countByEnumeratingWithState:&v63 objects:v71 count:16];
          if (!v58)
          {
LABEL_49:

            v6 = v52;
            goto LABEL_50;
          }
        }
      }
    }
  }

LABEL_50:
}

- (void)firstSchedulerShortTermLockContentChecks:(id)checks
{
  checksCopy = checks;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v49 = checksCopy;
  checksCopy = [[NSString alloc] initWithFormat:@"%@:firstSchedulerShortTermLockContentChecks", checksCopy];
  v58 = objc_alloc_init(NSMutableArray);
  v50 = objc_alloc_init(NSMutableArray);
  v73 = 0u;
  v74 = 0u;
  v75 = 0u;
  v76 = 0u;
  obj = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v8 = [obj countByEnumeratingWithState:&v73 objects:v84 count:16];
  v60 = checksCopy;
  if (v8)
  {
    v9 = v8;
    v10 = *v74;
    v51 = *v74;
    do
    {
      v11 = 0;
      v52 = v9;
      do
      {
        if (*v74 != v10)
        {
          objc_enumerationMutation(obj);
        }

        v12 = *(*(&v73 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v15 = [knownSetAtomicInstancesByInstance safeObjectForKey:v12 ofClass:objc_opt_class()];

        v16 = v15;
        if ([v15 lockedSupportingShortTermLocking])
        {
          v17 = [(MADAutoAssetControlManager *)self locateSetDescriptor:checksCopy forAtomicInstanceUUID:v12 requireExists:1];
          v18 = v17;
          if (v17)
          {
            v55 = v16;
            v56 = v13;
            v57 = v11;
            clientDomainName = [v17 clientDomainName];
            assetSetIdentifier = [v18 assetSetIdentifier];
            v21 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

            v71 = 0u;
            v72 = 0u;
            v69 = 0u;
            v70 = 0u;
            latestDowloadedAtomicInstanceEntries = [v18 latestDowloadedAtomicInstanceEntries];
            v23 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v69 objects:v83 count:16];
            if (v23)
            {
              v24 = v23;
              v53 = v18;
              v25 = 0;
              v26 = *v70;
              do
              {
                for (i = 0; i != v24; i = i + 1)
                {
                  if (*v70 != v26)
                  {
                    objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
                  }

                  v28 = *(*(&v69 + 1) + 8 * i);
                  if (![(MADAutoAssetControlManager *)self isLocalContentValidForSetAtomicEntry:v28 fromLocation:checksCopy])
                  {
                    availableForUseError = [v21 availableForUseError];
                    v30 = [MADAutoAssetSecure isErrorDueToDeviceBeingLocked:availableForUseError];

                    checksCopy = v60;
                    if ((v30 & 1) == 0)
                    {
                      [v58 addObject:v28];
                      v25 = 1;
                    }
                  }
                }

                v24 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v69 objects:v83 count:16];
              }

              while (v24);

              v10 = v51;
              v9 = v52;
              v18 = v53;
              if (v25)
              {
                [v50 addObject:v53];
              }
            }

            else
            {
            }

            v13 = v56;
            v11 = v57;
            v16 = v55;
          }
        }

        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v11 != v9);
      v9 = [obj countByEnumeratingWithState:&v73 objects:v84 count:16];
    }

    while (v9);
  }

  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v59 = v58;
  v31 = [v59 countByEnumeratingWithState:&v65 objects:v82 count:16];
  if (v31)
  {
    v32 = v31;
    v33 = *v66;
    do
    {
      for (j = 0; j != v32; j = j + 1)
      {
        if (*v66 != v33)
        {
          objc_enumerationMutation(v59);
        }

        v35 = *(*(&v65 + 1) + 8 * j);
        v36 = [(MADAutoAssetControlManager *)self getCorruptedEntryInfo:v35];
        v37 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 138543618;
          v79 = v60;
          v80 = 2114;
          v81 = v36;
          _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "{%{public}@} Removing corrupted asset %{public}@", buf, 0x16u);
        }

        fullAssetSelector = [v35 fullAssetSelector];
        [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:v60 dueToError:0 fullAssetSelector:fullAssetSelector historyOperationAI:1502 historyOperationSD:393];

        fullAssetSelector2 = [v35 fullAssetSelector];
        v40 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector2];
        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:v60 droppingDescriptor:v40 forHistoryOperation:409 firstClientName:0];
      }

      v32 = [v59 countByEnumeratingWithState:&v65 objects:v82 count:16];
    }

    while (v32);
  }

  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v41 = v50;
  v42 = [v41 countByEnumeratingWithState:&v61 objects:v77 count:16];
  if (v42)
  {
    v43 = v42;
    v44 = *v62;
    do
    {
      for (k = 0; k != v43; k = k + 1)
      {
        if (*v62 != v44)
        {
          objc_enumerationMutation(v41);
        }

        v46 = *(*(&v61 + 1) + 8 * k);
        clientDomainName2 = [v46 clientDomainName];
        assetSetIdentifier2 = [v46 assetSetIdentifier];
        [MADAutoAssetScheduler triggerWithRetrySetDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2 usingSetUpdatePolicy:0];
      }

      v43 = [v41 countByEnumeratingWithState:&v61 objects:v77 count:16];
    }

    while (v43);
  }
}

- (void)considerDownloadedWithPSUSLookupResultsForLatestToVend
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:considerDownloadedWithPSUSLookupResultsForLatestToVend", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v102 = 0u;
  v103 = 0u;
  v100 = 0u;
  v101 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  obj = [allKeys copy];

  v7 = [obj countByEnumeratingWithState:&v100 objects:v113 count:16];
  if (v7)
  {
    v79 = *v101;
    do
    {
      v8 = 0;
      v80 = v7;
      do
      {
        if (*v101 != v79)
        {
          objc_enumerationMutation(obj);
        }

        v82 = v8;
        v9 = *(*(&v100 + 1) + 8 * v8);
        context = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v90 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v9 ofClass:objc_opt_class()];

        v11 = v90;
        if (!v90)
        {
          goto LABEL_80;
        }

        autoAssetEntries = [v90 autoAssetEntries];
        v83 = [(MADAutoAssetControlManager *)self locateSetLookupResultSatisfying:autoAssetEntries];

        if (!v83)
        {
          goto LABEL_68;
        }

        discoveredAtomicEntries = [v83 discoveredAtomicEntries];
        v14 = [discoveredAtomicEntries count] == 0;

        if (v14)
        {
          goto LABEL_68;
        }

        v98 = 0u;
        v99 = 0u;
        v96 = 0u;
        v97 = 0u;
        discoveredAtomicEntries2 = [v83 discoveredAtomicEntries];
        v16 = [discoveredAtomicEntries2 countByEnumeratingWithState:&v96 objects:v112 count:16];
        if (!v16)
        {

          goto LABEL_38;
        }

        v86 = discoveredAtomicEntries2;
        v88 = *v97;
        v84 = 0x100000000;
        do
        {
          for (i = 0; i != v16; i = i + 1)
          {
            if (*v97 != v88)
            {
              objc_enumerationMutation(v86);
            }

            v18 = *(*(&v96 + 1) + 8 * i);
            v19 = objc_autoreleasePoolPush();
            autoAssetEntries2 = [v90 autoAssetEntries];
            v21 = [(MADAutoAssetControlManager *)self isAtomicEntry:v18 desiredForAutoAssetSetEntries:autoAssetEntries2];

            if (v21)
            {
              if (v18)
              {
                fullAssetSelector = [v18 fullAssetSelector];
                assetType = [fullAssetSelector assetType];
                fullAssetSelector2 = [v18 fullAssetSelector];
                assetSpecifier = [fullAssetSelector2 assetSpecifier];
                fullAssetSelector3 = [v18 fullAssetSelector];
                assetVersion = [fullAssetSelector3 assetVersion];
                v28 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

                if (v28)
                {
                  if (![MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forDescriptor:v28])
                  {
                    goto LABEL_20;
                  }

                  if (![MADAutoAssetSecure isPersonalizationRequired:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forDescriptor:v28])
                  {
                    LOBYTE(v84) = 1;
LABEL_20:
                    v29 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
                    {
                      summary = [v90 summary];
                      summary2 = [v28 summary];
                      *buf = 138543874;
                      v107 = @"considerDownloadedWithPSUSLookupResultsForLatestToVend";
                      v108 = 2114;
                      v109 = summary;
                      v110 = 2114;
                      v111 = summary2;
                      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-descriptor discovered by PSUS lookup is currently downloaded [and if secure: is personalized] | nextSetConfiguration:%{public}@ | downloadedAssetDescriptor:%{public}@", buf, 0x20u);
                    }

                    v32 = 0;
LABEL_27:

                    goto LABEL_28;
                  }
                }

                else
                {
                  LOBYTE(v84) = 0;
                }

                BYTE4(v84) = 0;
                v32 = 4;
                goto LABEL_27;
              }

              v84 = 0;
              v32 = 4;
            }

            else
            {
              v32 = 5;
            }

LABEL_28:
            objc_autoreleasePoolPop(v19);
            if (v32 != 5 && v32)
            {
              goto LABEL_32;
            }
          }

          v16 = [v86 countByEnumeratingWithState:&v96 objects:v112 count:16];
        }

        while (v16);
LABEL_32:

        if ((v84 & 0x100000000) == 0)
        {
          v33 = v90;
          if (v84)
          {
            newerAtomicInstanceOncePersonalized = [v90 newerAtomicInstanceOncePersonalized];
            v35 = newerAtomicInstanceOncePersonalized == 0;

            v33 = v90;
            if (!v35)
            {
              [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forSetConfiguration:v90];
            }

            v36 = [(MADAutoAssetControlManager *)self atomicInstanceFromPSUSLookupResultOncePersonalized:v83 forSetConfiguration:v90];
          }

          else
          {
            v36 = 0;
          }

          goto LABEL_69;
        }

LABEL_38:
        latestAtomicInstanceToVend = [v90 latestAtomicInstanceToVend];
        v38 = latestAtomicInstanceToVend == 0;

        if (v38)
        {
          if ([(MADAutoAssetControlManager *)self newAtomicInstanceAndSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetLookupResult:v83 vendingLatestForConfiguration:v90 inStartup:1 allowEmpty:0 notifyClients:0 forCreationReason:@"FROM_STAGED_PROMOTED_LOOKUP" recordingHistoryOperation:220])
          {
            goto LABEL_79;
          }

          goto LABEL_68;
        }

        latestAtomicInstanceToVend2 = [v90 latestAtomicInstanceToVend];
        v89 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

        v94 = 0u;
        v95 = 0u;
        v92 = 0u;
        v93 = 0u;
        discoveredAtomicEntries3 = [v83 discoveredAtomicEntries];
        v41 = [discoveredAtomicEntries3 countByEnumeratingWithState:&v92 objects:v105 count:16];
        if (!v41)
        {
          v78 = 0;
          v85 = 0;
          goto LABEL_63;
        }

        v78 = 0;
        v85 = 0;
        v87 = discoveredAtomicEntries3;
        v42 = *v93;
        while (2)
        {
          v43 = 0;
          while (2)
          {
            if (*v93 != v42)
            {
              objc_enumerationMutation(v87);
            }

            v44 = *(*(&v92 + 1) + 8 * v43);
            v45 = objc_autoreleasePoolPush();
            fullAssetSelector4 = [v44 fullAssetSelector];
            assetType2 = [fullAssetSelector4 assetType];
            fullAssetSelector5 = [v44 fullAssetSelector];
            assetSpecifier2 = [fullAssetSelector5 assetSpecifier];
            v50 = [v89 downloadedEntryForAssetType:assetType2 forAssetSpecifier:assetSpecifier2];

            if (!v50)
            {
              LODWORD(v85) = 1;
              v61 = 1;
              goto LABEL_55;
            }

            v51 = [SUCoreRestoreVersion alloc];
            fullAssetSelector6 = [v44 fullAssetSelector];
            assetVersion2 = [fullAssetSelector6 assetVersion];
            v54 = [v51 initWithRestoreVersion:assetVersion2];

            v55 = [SUCoreRestoreVersion alloc];
            fullAssetSelector7 = [v50 fullAssetSelector];
            assetVersion3 = [fullAssetSelector7 assetVersion];
            v58 = [v55 initWithRestoreVersion:assetVersion3];

            if (![v54 isComparable:v58])
            {
              v61 = 0;
LABEL_53:
              BYTE4(v85) = 1;
              goto LABEL_54;
            }

            v59 = [v54 compare:v58];
            v60 = 1;
            if (v59 == -1)
            {
              v61 = 0;
              goto LABEL_53;
            }

            if (v59 != &dword_0 + 1)
            {
              v60 = v78;
            }

            v61 = 1;
            v78 = v60;
LABEL_54:

LABEL_55:
            objc_autoreleasePoolPop(v45);
            if (!v61)
            {
              discoveredAtomicEntries3 = v87;
              goto LABEL_63;
            }

            if (v41 != ++v43)
            {
              continue;
            }

            break;
          }

          discoveredAtomicEntries3 = v87;
          v41 = [v87 countByEnumeratingWithState:&v92 objects:v105 count:16];
          if (v41)
          {
            continue;
          }

          break;
        }

LABEL_63:

        if ((v85 & 0x100000000) != 0 || ((v78 | v85) & 1) == 0)
        {
        }

        else
        {
          v62 = [(MADAutoAssetControlManager *)self newAtomicInstanceAndSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetLookupResult:v83 vendingLatestForConfiguration:v90 inStartup:1 allowEmpty:0 notifyClients:0 forCreationReason:@"FROM_STAGED_PROMOTED_LOOKUP" recordingHistoryOperation:220];

          if (v62)
          {
            goto LABEL_79;
          }
        }

LABEL_68:
        v36 = 0;
        v33 = v90;
LABEL_69:
        latestAtomicInstanceToVend3 = [v33 latestAtomicInstanceToVend];
        v64 = latestAtomicInstanceToVend3 == 0;

        if (v64 && (([v90 everProvidedLatestToVend] | v36) & 1) == 0)
        {
          clientDomainName = [v90 clientDomainName];
          assetSetIdentifier = [v90 assetSetIdentifier];
          firstEntryAssetType = [v90 firstEntryAssetType];
          v68 = [(MADAutoAssetControlManager *)self preInstalledSetDescriptor:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forClientDomainName:clientDomainName forSetClientName:@"AutoControlManagerActingAsClient" forAssetSetIdentifier:assetSetIdentifier forAssetType:firstEntryAssetType];

          if (v68)
          {
            latestDownloadedAtomicInstance = [v68 latestDownloadedAtomicInstance];
            v70 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance];

            if (v70)
            {
              if (![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" fromSetDescriptor:v68 toSetConfiguration:v90 fromPreSUStaging:0 allowEmpty:0])
              {
                atomicInstanceUUID = [v70 atomicInstanceUUID];
                [v90 setNewerAtomicInstanceOncePersonalized:atomicInstanceUUID];

                [(MADAutoAssetControlManager *)self setConfigurationPersist:v90 fromLocation:@"considerDownloadedWithPSUSLookupResultsForLatestToVend" forReason:@"pre-installed set as newer-once-personalized" dueToAlter:0 forHistoryOperation:9999];
              }
            }

            else
            {
              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [autoControlManagerFSM2 diag];
              v74 = [NSString alloc];
              summary3 = [v68 summary];
              v76 = [v74 initWithFormat:@"{considerDownloadedWithPSUSLookupResultsForLatestToVend} pre-installed set-descriptor without atomic-instance | preInstalledSetDescriptor:%@", summary3];
              [diag trackAnomaly:@"STARTUP-PRE-INSTALLED" forReason:v76 withResult:6103 withError:0];
            }
          }
        }

LABEL_79:

        v11 = v90;
LABEL_80:

        objc_autoreleasePoolPop(context);
        v8 = v82 + 1;
      }

      while ((v82 + 1) != v80);
      v7 = [obj countByEnumeratingWithState:&v100 objects:v113 count:16];
    }

    while (v7);
  }

  os_activity_scope_leave(&state);
}

- (void)loadPersistedAtomicInstancesSupportingShortTermLocking
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  obj = objc_alloc_init(NSMutableArray);
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"loadPersistedAtomicInstancesSupportingShortTermLocking" ofContainer:@"knownSetAtomicInstancesByInstance"];
  v36 = 0u;
  v37 = 0u;
  v34 = 0u;
  v35 = 0u;
  knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
  v6 = [knownSetAtomicInstancesByInstance countByEnumeratingWithState:&v34 objects:v39 count:16];
  if (v6)
  {
    v7 = v6;
    v8 = *v35;
    do
    {
      v9 = 0;
      do
      {
        if (*v35 != v8)
        {
          objc_enumerationMutation(knownSetAtomicInstancesByInstance);
        }

        v10 = *(*(&v34 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance2 = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v13 = [knownSetAtomicInstancesByInstance2 safeObjectForKey:v10 ofClass:objc_opt_class()];

        if ([v13 lockedSupportingShortTermLocking])
        {
          atomicInstanceUUID = [v13 atomicInstanceUUID];
          v15 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"loadPersistedAtomicInstancesSupportingShortTermLocking" forAtomicInstanceUUID:atomicInstanceUUID requireExists:0];

          if (v15)
          {
            [obj addObject:v15];
          }
        }

        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v7 != v9);
      v7 = [knownSetAtomicInstancesByInstance countByEnumeratingWithState:&v34 objects:v39 count:16];
    }

    while (v7);
  }

  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  obja = obj;
  v16 = [obja countByEnumeratingWithState:&v30 objects:v38 count:16];
  if (v16)
  {
    v17 = v16;
    v18 = *v31;
    do
    {
      v19 = 0;
      do
      {
        if (*v31 != v18)
        {
          objc_enumerationMutation(obja);
        }

        v20 = *(*(&v30 + 1) + 8 * v19);
        if (v20)
        {
          latestDownloadedAtomicInstance = [*(*(&v30 + 1) + 8 * v19) latestDownloadedAtomicInstance];
          clientDomainName = [v20 clientDomainName];
          assetSetIdentifier = [v20 assetSetIdentifier];
          v24 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

          if (v24)
          {
            latestAtomicInstanceToVend = [v24 latestAtomicInstanceToVend];
            latestDownloadedAtomicInstance2 = [v20 latestDownloadedAtomicInstance];
            v27 = [SUCore stringIsEqual:latestAtomicInstanceToVend to:latestDownloadedAtomicInstance2];

            if (v27)
            {

              latestDownloadedAtomicInstance = 0;
            }
          }

          [(MADAutoAssetControlManager *)self trackShortTermLockedSetDescriptor:v20 forSpecificAtomicInstance:latestDownloadedAtomicInstance isReadOnlyForResumeFromPersisted:1];
        }

        v19 = v19 + 1;
      }

      while (v17 != v19);
      v17 = [obja countByEnumeratingWithState:&v30 objects:v38 count:16];
    }

    while (v17);
  }
}

- (id)atomicInstanceOverflowRemove:(id)remove
{
  removeCopy = remove;
  v5 = [removeCopy count];
  if (v5 < 1)
  {
    v7 = 0;
    goto LABEL_8;
  }

  v6 = v5;
  v7 = [removeCopy objectAtIndex:0];
  if (v6 != &dword_0 + 1)
  {
    v8 = 0;
    v10 = 1;
    while (1)
    {
      v11 = [removeCopy objectAtIndex:v10];
      instanceEntries = [v7 instanceEntries];
      v13 = [instanceEntries count];
      if (v13)
      {
        instanceEntries2 = [v11 instanceEntries];
        if (![instanceEntries2 count])
        {
          goto LABEL_25;
        }
      }

      if ([v7 allContentDownloaded] && !objc_msgSend(v11, "allContentDownloaded") || objc_msgSend(v7, "lockedSupportingShortTermLocking") && !objc_msgSend(v11, "lockedSupportingShortTermLocking") || objc_msgSend(v7, "lockedSupportingShortTermLocking") && !objc_msgSend(v11, "lockedSupportingShortTermLocking") || (objc_msgSend(v7, "awaitingLastReferenceNewerFound") & 1) == 0 && (objc_msgSend(v11, "awaitingLastReferenceNewerFound") & 1) != 0 || (objc_msgSend(v7, "awaitingLastReferenceAltered") & 1) == 0 && (objc_msgSend(v11, "awaitingLastReferenceAltered") & 1) != 0)
      {
        break;
      }

      v17 = v8;
      instanceCreationIndex = [v7 instanceCreationIndex];
      instanceCreationIndex2 = [v11 instanceCreationIndex];
      if (v13)
      {
      }

      if (instanceCreationIndex <= instanceCreationIndex2)
      {
        v8 = v17;
        goto LABEL_28;
      }

LABEL_27:
      v14 = v11;

      v7 = v14;
      v8 = v10;
LABEL_28:

      if (v6 == ++v10)
      {
        goto LABEL_4;
      }
    }

    if (v13)
    {
LABEL_25:
    }

    goto LABEL_27;
  }

  v8 = 0;
LABEL_4:
  if (v7 && (v8 & 0x8000000000000000) == 0)
  {
    [removeCopy removeObjectAtIndex:v8];
  }

LABEL_8:

  return v7;
}

- (BOOL)atomicInstanceFromPSUSLookupResultOncePersonalized:(id)personalized forSetConfiguration:(id)configuration
{
  personalizedCopy = personalized;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = +[NSUUID UUID];
  uUIDString = [v10 UUIDString];

  v12 = [MADAutoSetDescriptor alloc];
  clientDomainName = [configurationCopy clientDomainName];
  assetSetIdentifier = [configurationCopy assetSetIdentifier];
  discoveredAtomicEntries = [personalizedCopy discoveredAtomicEntries];
  v16 = [(MADAutoSetDescriptor *)v12 initForClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier withDiscoveredAtomicInstance:uUIDString withDiscoveredAtomicEntries:discoveredAtomicEntries];

  newerAtomicInstanceOncePersonalized = [configurationCopy newerAtomicInstanceOncePersonalized];

  if (newerAtomicInstanceOncePersonalized)
  {
    [(MADAutoAssetControlManager *)self atomicInstanceDropOncePersonalized:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forSetConfiguration:configurationCopy];
    if (!v16)
    {
      [(MADAutoAssetControlManager *)self setConfigurationPersist:configurationCopy fromLocation:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forReason:@"just cleared newer-once-personalized and unable to create from-staged set-descriptor" dueToAlter:0 forHistoryOperation:9999];
LABEL_7:
      v28 = 0;
      goto LABEL_8;
    }
  }

  else if (!v16)
  {
    goto LABEL_7;
  }

  catalogCachedAssetSetID = [personalizedCopy catalogCachedAssetSetID];
  [v16 setCatalogCachedAssetSetID:catalogCachedAssetSetID];

  catalogDownloadedFromLive = [personalizedCopy catalogDownloadedFromLive];
  [v16 setCatalogDownloadedFromLive:catalogDownloadedFromLive];

  catalogLastTimeChecked = [personalizedCopy catalogLastTimeChecked];
  [v16 setCatalogLastTimeChecked:catalogLastTimeChecked];

  catalogPostedDate = [personalizedCopy catalogPostedDate];
  [v16 setCatalogPostedDate:catalogPostedDate];

  catalogCachedAssetSetID2 = [personalizedCopy catalogCachedAssetSetID];
  [v16 setDownloadedCatalogCachedAssetSetID:catalogCachedAssetSetID2];

  catalogDownloadedFromLive2 = [personalizedCopy catalogDownloadedFromLive];
  [v16 setDownloadedCatalogDownloadedFromLive:catalogDownloadedFromLive2];

  catalogLastTimeChecked2 = [personalizedCopy catalogLastTimeChecked];
  [v16 setDownloadedCatalogLastTimeChecked:catalogLastTimeChecked2];

  catalogPostedDate2 = [personalizedCopy catalogPostedDate];
  [v16 setDownloadedCatalogPostedDate:catalogPostedDate2];

  requestedAutoAssetEntries = [personalizedCopy requestedAutoAssetEntries];
  [v16 setRequestedAutoAssetEntries:requestedAutoAssetEntries];

  [v16 setLatestDownloadedAtomicInstance:uUIDString];
  discoveredAtomicEntries2 = [personalizedCopy discoveredAtomicEntries];
  [v16 setLatestDowloadedAtomicInstanceEntries:discoveredAtomicEntries2];

  v28 = 1;
  [v16 setIsOnFilesystem:1];
  [v16 setIsDiscoveredFullyDownloaded:1];
  [v16 setAtomicInstanceDownloadedNotified:1];
  [v16 setNeverBeenLocked:1];
  v29 = [(MADAutoAssetControlManager *)self atomicInstanceNewSetAtomicInstance:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forCreationReason:@"PSUS_NEEDS_PERSONALIZATION" recordingHistoryOperation:220 recoveringForSetDescriptor:v16 usingAsSetClient:@"PROMOTED-NEEDS-PERSONALIZATION"];
  if (!v29)
  {
    goto LABEL_7;
  }

  v30 = v29;
  LOBYTE(v34) = 1;
  BYTE2(v33) = 0;
  LOWORD(v33) = 0;
  [MADAutoAssetControlManager trackSetDescriptor:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" fromLocation:v16 forLatestDownloaded:@"atomicInstanceFromPSUSLookupResultOncePersonalized" forSpecificAtomicInstance:1 withCurrentSetStatus:uUIDString changedWhileTerminated:0 changedNeverBeenLocked:0 notifyingIfJustDownloaded:v33 latestToVend:350 historyOperation:@"PROMOTED-NEEDS-PERSONALIZATION" firstClientName:v34 fromPreSUStaging:?];
  atomicInstanceUUID = [v30 atomicInstanceUUID];
  [configurationCopy setNewerAtomicInstanceOncePersonalized:atomicInstanceUUID];

LABEL_8:
  return v28;
}

- (void)atomicInstanceDropOncePersonalized:(id)personalized forSetConfiguration:(id)configuration
{
  personalizedCopy = personalized;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  newerAtomicInstanceOncePersonalized = [configurationCopy newerAtomicInstanceOncePersonalized];

  if (newerAtomicInstanceOncePersonalized)
  {
    newerAtomicInstanceOncePersonalized2 = [configurationCopy newerAtomicInstanceOncePersonalized];
    v11 = [(MADAutoAssetControlManager *)self locateSetDescriptor:personalizedCopy forAtomicInstanceUUID:newerAtomicInstanceOncePersonalized2 requireExists:1];

    if (v11)
    {
      [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v11 fromLocation:personalizedCopy checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:344 historyOperationSD:388];
    }

    else
    {
      newerAtomicInstanceOncePersonalized3 = [configurationCopy newerAtomicInstanceOncePersonalized];
      [(MADAutoAssetControlManager *)self atomicInstanceRemove:personalizedCopy setAtomicInstanceUUID:newerAtomicInstanceOncePersonalized3 removingForReason:@"{atomicInstanceDropOncePersonalized} (atomic-instance without set-descriptor)" historyOperation:344];
    }

    [configurationCopy setNewerAtomicInstanceOncePersonalized:0];
  }
}

- (void)atomicInstanceTrimOverflowAfterPersisting:(id)persisting
{
  persistingCopy = persisting;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [persistingCopy clientDomainName];
  assetSetIdentifier = [persistingCopy assetSetIdentifier];
  v104 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v10 = [persistedKnownSetAtomicInstances persistedEntryIDs:@"atomicInstanceTrimOverflowAfterPersisting"];

  if ([v10 count])
  {
    v11 = objc_alloc_init(NSMutableArray);
    v106 = objc_alloc_init(NSMutableArray);
    v12 = objc_alloc_init(NSMutableArray);
    v13 = v12;
    v96 = v11;
    if (v11 && v106 && v12)
    {
      v105 = persistingCopy;
      v95 = v12;
      v112 = +[NSFileManager defaultManager];
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceTrimOverflowAfterPersisting" ofContainer:@"persistedKnownSetAtomicInstances"];
      v127 = 0u;
      v128 = 0u;
      v125 = 0u;
      v126 = 0u;
      v94 = v10;
      obj = v10;
      v14 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
      selfCopy = self;
      if (!v14)
      {
        goto LABEL_68;
      }

      v15 = v14;
      v16 = *v126;
      v108 = *v126;
      while (1)
      {
        v17 = 0;
        v107 = v15;
        do
        {
          if (*v126 != v16)
          {
            objc_enumerationMutation(obj);
          }

          v18 = *(*(&v125 + 1) + 8 * v17);
          v19 = objc_autoreleasePoolPush();
          persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v21 = [persistedKnownSetAtomicInstances2 persistedEntry:v18 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting"];

          if (v18)
          {
            v22 = v21 == 0;
          }

          else
          {
            v22 = 1;
          }

          if (!v22)
          {
            v113 = v19;
            persistedKnownSetAtomicInstances3 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
            v28 = [persistedKnownSetAtomicInstances3 decodeFromLocation:@"atomicInstanceTrimOverflowAfterPersisting" ofEntryName:v18 fromPersistedEntry:v21 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

            if (!v28)
            {
              goto LABEL_27;
            }

            v110 = v21;
            [v28 atomicInstanceUUID];
            v30 = v29 = v28;
            atomicInstanceUUID = [v105 atomicInstanceUUID];
            if ([SUCore stringIsEqual:v30 to:atomicInstanceUUID])
            {

              v15 = v107;
              v32 = v30;
              v28 = v29;
              goto LABEL_26;
            }

            atomicInstanceUUID2 = [v29 atomicInstanceUUID];
            latestAtomicInstanceToVend = [v104 latestAtomicInstanceToVend];
            if (([SUCore stringIsEqual:atomicInstanceUUID2 to:latestAtomicInstanceToVend]& 1) != 0)
            {

              self = selfCopy;
              v15 = v107;
              v32 = v30;
              v28 = v29;
              goto LABEL_26;
            }

            atomicInstanceUUID3 = [v29 atomicInstanceUUID];
            atomicInstanceUUID4 = [v105 atomicInstanceUUID];
            if (atomicInstanceUUID3 == atomicInstanceUUID4)
            {

              self = selfCopy;
              v15 = v107;
              v32 = v30;
            }

            else
            {
              v99 = atomicInstanceUUID4;
              log = atomicInstanceUUID3;
              clientDomainName2 = [v29 clientDomainName];
              [v105 clientDomainName];
              v38 = v100 = clientDomainName2;
              v39 = [SUCore stringIsEqual:clientDomainName2 to:?];
              v21 = v110;
              if (v39)
              {
                v97 = v29;
                assetSetIdentifier2 = [v29 assetSetIdentifier];
                assetSetIdentifier3 = [v105 assetSetIdentifier];
                v98 = [SUCore stringIsEqual:assetSetIdentifier2 to:assetSetIdentifier3];

                self = selfCopy;
                v15 = v107;
                v28 = v97;
                if (v98)
                {
                  v32 = [(MADAutoAssetControlManager *)selfCopy atomicInstanceNewIdentifierForSetAtomicInstance:v97];
                  if (v32)
                  {
                    [v96 addObject:v97];
                    if ([v96 count] >= 7 && !+[MADAutoAssetControlManager preferenceAutoAssetNoPersistedOverflowLimit](MADAutoAssetControlManager, "preferenceAutoAssetNoPersistedOverflowLimit"))
                    {
                      v42 = [(MADAutoAssetControlManager *)selfCopy atomicInstanceOverflowRemove:v96];
                      if (v42)
                      {
                        v43 = [(MADAutoAssetControlManager *)selfCopy atomicInstanceNewEntryIDForSetAtomicInstance:v42];
                        if (v43)
                        {
                          v101 = v43;
                          v111 = v42;
                          atomicInstanceUUID5 = [v42 atomicInstanceUUID];
                          v45 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"atomicInstanceTrimOverflowAfterPersisting" forAtomicInstanceUUID:atomicInstanceUUID5 requireExists:0];

                          if (!v45)
                          {
                            v58 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
                            {
                              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                              summary = [v111 summary];
                              *buf = 138543618;
                              v132 = _updateLatestSummary;
                              v133 = 2114;
                              v134 = summary;
                              _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance without backing set-descriptor | removedOverflowAtomicInstance:%{public}@", buf, 0x16u);

                              v15 = v107;
                            }

                            [v106 addObject:v18];
                            goto LABEL_60;
                          }

                          if ([(MADAutoAssetControlManager *)selfCopy isAtomicInstanceLatestToVendForSet:v97])
                          {
                            v46 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                            {
                              _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                              summary2 = [v111 summary];
                              *buf = 138543618;
                              v132 = _updateLatestSummary2;
                              v133 = 2114;
                              v134 = summary2;
                              v49 = v46;
                              v50 = "[%{public}@]\n[CONSIDER-OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance is latest-to-vend to set (keeping) | setAtomicInstance:%{public}@";
                              goto LABEL_58;
                            }

                            goto LABEL_59;
                          }

                          v61 = [(MADAutoAssetControlManager *)selfCopy isAtomicInstanceForCurrentSetJob:v97];
                          v62 = _MADLog(@"AutoControl");
                          v46 = v62;
                          if (v61)
                          {
                            if (os_log_type_enabled(v62, OS_LOG_TYPE_DEFAULT))
                            {
                              _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                              summary2 = [v111 summary];
                              *buf = 138543618;
                              v132 = _updateLatestSummary2;
                              v133 = 2114;
                              v134 = summary2;
                              v49 = v46;
                              v50 = "[%{public}@]\n[CONSIDER-OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} atomic-instance for currently active set-job (keeping) | setAtomicInstance:%{public}@";
LABEL_58:
                              _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, v50, buf, 0x16u);
                            }

LABEL_59:

LABEL_60:
                            v43 = v101;
                            _updateLatestSummary4 = v45;
                          }

                          else
                          {
                            if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
                            {
                              _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                              summary3 = [v111 summary];
                              summary4 = [v45 summary];
                              *buf = 138543874;
                              v132 = _updateLatestSummary3;
                              v133 = 2114;
                              v134 = summary3;
                              v135 = 2114;
                              v136 = summary4;
                              _os_log_impl(&dword_0, v46, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} [WARNING] over threshold for atomic-instances by set-identifier (trimming) | setAtomicInstance:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);

                              v15 = v107;
                            }

                            v43 = v101;
                            [v106 addObject:v101];
                            latestDownloadedAtomicInstance = [v45 latestDownloadedAtomicInstance];
                            [v95 addObject:latestDownloadedAtomicInstance];

                            _updateLatestSummary4 = v45;
                          }

LABEL_61:
                          v42 = v111;
                        }

                        else
                        {
                          _updateLatestSummary4 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(_updateLatestSummary4, OS_LOG_TYPE_ERROR))
                          {
                            [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                            v56 = loga = _updateLatestSummary4;
                            summary5 = [v42 summary];
                            *buf = 138543618;
                            v132 = v56;
                            v133 = 2114;
                            v134 = summary5;
                            _os_log_impl(&dword_0, loga, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to determine persisted-set-atomic-instance file | setAtomicInstance:%{public}@", buf, 0x16u);

                            v43 = 0;
                            _updateLatestSummary4 = loga;
                          }
                        }
                      }

                      else
                      {
                        v43 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
                        {
                          _updateLatestSummary4 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                          [v97 summary];
                          v111 = 0;
                          v55 = v54 = v43;
                          *buf = 138543618;
                          v132 = _updateLatestSummary4;
                          v133 = 2114;
                          v134 = v55;
                          _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} over threshold for atomic-instances by set-identifier (unable to reduce) | setAtomicInstance:%{public}@", buf, 0x16u);

                          v43 = v54;
                          goto LABEL_61;
                        }
                      }
                    }
                  }

                  else
                  {
                    v51 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                    {
                      _updateLatestSummary5 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                      *buf = 138543618;
                      v132 = _updateLatestSummary5;
                      v133 = 2114;
                      v134 = v18;
                      _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to load set-atomic-instance | entryID:%{public}@", buf, 0x16u);
                    }

                    [v106 addObject:v18];
                  }

LABEL_26:
                }

LABEL_27:

                v16 = v108;
                v19 = v113;
                goto LABEL_28;
              }

              self = selfCopy;
              v15 = v107;
              v32 = v30;
            }

            v28 = v29;
            goto LABEL_26;
          }

          v23 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v25 = _updateLatestSummary6;
            *buf = 138543618;
            v26 = @"N";
            if (v18)
            {
              v26 = v18;
            }

            v132 = _updateLatestSummary6;
            v133 = 2114;
            v134 = v26;
            _os_log_impl(&dword_0, v23, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
          }

          if (v18)
          {
            [v106 addObject:v18];
          }

LABEL_28:

          objc_autoreleasePoolPop(v19);
          v17 = v17 + 1;
        }

        while (v15 != v17);
        v67 = [obj countByEnumeratingWithState:&v125 objects:v137 count:16];
        v15 = v67;
        if (!v67)
        {
LABEL_68:

          v123 = 0u;
          v124 = 0u;
          v121 = 0u;
          v122 = 0u;
          v114 = v106;
          v68 = [v114 countByEnumeratingWithState:&v121 objects:v130 count:16];
          if (v68)
          {
            v69 = v68;
            v70 = *v122;
            do
            {
              for (i = 0; i != v69; i = i + 1)
              {
                if (*v122 != v70)
                {
                  objc_enumerationMutation(v114);
                }

                v72 = *(*(&v121 + 1) + 8 * i);
                v73 = objc_autoreleasePoolPush();
                persistedKnownSetAtomicInstances4 = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
                v75 = [persistedKnownSetAtomicInstances4 persistedEntry:v72 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting"];

                persistedKnownSetAtomicInstances5 = [(MADAutoAssetControlManager *)selfCopy persistedKnownSetAtomicInstances];
                v77 = [persistedKnownSetAtomicInstances5 decodeFromLocation:@"atomicInstanceTrimOverflowAfterPersisting" ofEntryName:v72 fromPersistedEntry:v75 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

                if (v77)
                {
                  atomicInstanceUUID6 = [v77 atomicInstanceUUID];
                  [(MADAutoAssetControlManager *)selfCopy atomicInstanceRemove:@"atomicInstanceTrimOverflowAfterPersisting" setAtomicInstanceUUID:atomicInstanceUUID6 removingForReason:@"dropping to avoid overflow" historyOperation:335];
                }

                objc_autoreleasePoolPop(v73);
              }

              v69 = [v114 countByEnumeratingWithState:&v121 objects:v130 count:16];
            }

            while (v69);
          }

          v119 = 0u;
          v120 = 0u;
          v117 = 0u;
          v118 = 0u;
          v115 = v95;
          v79 = [v115 countByEnumeratingWithState:&v117 objects:v129 count:16];
          v80 = selfCopy;
          if (v79)
          {
            v81 = v79;
            v82 = *v118;
            do
            {
              for (j = 0; j != v81; j = j + 1)
              {
                if (*v118 != v82)
                {
                  objc_enumerationMutation(v115);
                }

                v84 = *(*(&v117 + 1) + 8 * j);
                v85 = objc_autoreleasePoolPush();
                v86 = [(MADAutoAssetControlManager *)v80 locateSetDescriptor:@"atomicInstanceTrimOverflowAfterPersisting" forAtomicInstanceUUID:v84 requireExists:0];
                v87 = v86;
                if (v86)
                {
                  clientDomainName3 = [v86 clientDomainName];
                  assetSetIdentifier4 = [v87 assetSetIdentifier];
                  v80 = selfCopy;
                  v90 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier4 forSetAtomicInstance:v84];

                  [(MADAutoAssetControlManager *)selfCopy removeSetDescriptorDownloaded:v87 fromLocation:@"atomicInstanceTrimOverflowAfterPersisting" checkingByInstance:0 regardlessOfLatest:0 historyOperationAI:336 historyOperationSD:380];
                  v91 = [(MADAutoAssetControlManager *)selfCopy _shortTermSharedLockRemove:@"atomicInstanceTrimOverflowAfterPersisting" removingSharedLockFilename:v90 usingFileManager:v112 removingDescription:@"atomic-instance shared lock directory (eliminated set-identifier)"];
                }

                objc_autoreleasePoolPop(v85);
              }

              v81 = [v115 countByEnumeratingWithState:&v117 objects:v129 count:16];
            }

            while (v81);
          }

          persistingCopy = v105;
          v10 = v94;
          v13 = v95;
          v92 = v112;
          goto LABEL_89;
        }
      }
    }

    v92 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v92, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary7 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v132 = _updateLatestSummary7;
      _os_log_impl(&dword_0, v92, OS_LOG_TYPE_ERROR, "[%{public}@]\n[OVERFLOW-TRIM] {atomicInstanceTrimOverflowAfterPersisting} unable to allocate required resources", buf, 0xCu);
    }

LABEL_89:
  }
}

- (BOOL)atomicInstanceHasDownloadedSetDescriptor:(id)descriptor verboseLogging:(BOOL)logging
{
  loggingCopy = logging;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v10 = [persistedDownloadedSetDescriptors persistedEntryIDs:@"atomicInstanceHasDownloadedSetDescriptor"];

  v76 = descriptorCopy;
  if ([v10 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"atomicInstanceHasDownloadedSetDescriptor" ofContainer:@"persistedDownloadedSetDescriptors"];
    v87 = 0u;
    v88 = 0u;
    v85 = 0u;
    v86 = 0u;
    v11 = v10;
    v12 = [v11 countByEnumeratingWithState:&v85 objects:v98 count:16];
    if (!v12)
    {
      goto LABEL_27;
    }

    v13 = v12;
    v70 = v10;
    v74 = loggingCopy;
    v14 = @"atomicInstanceHasDownloadedSetDescriptor";
    v79 = *v86;
    selfCopy = self;
LABEL_4:
    v15 = 0;
    obj = v13;
    while (1)
    {
      if (*v86 != v79)
      {
        objc_enumerationMutation(v11);
      }

      v16 = *(*(&v85 + 1) + 8 * v15);
      v17 = objc_autoreleasePoolPush();
      persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v19 = [persistedDownloadedSetDescriptors2 persistedEntry:v16 fromLocation:v14];

      if (v19)
      {
        persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        v21 = [persistedDownloadedSetDescriptors3 decodeFromLocation:v14 ofEntryName:v16 fromPersistedEntry:v19 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v21)
        {
          _updateLatestSummary4 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(_updateLatestSummary4, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = _updateLatestSummary;
            v92 = 2114;
            v93 = v16;
            _os_log_impl(&dword_0, _updateLatestSummary4, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to load set-descriptor (downloaded) | entryID:%{public}@", buf, 0x16u);

LABEL_17:
            v13 = obj;
          }

LABEL_20:

          goto LABEL_21;
        }

        v22 = v21;
        v23 = v19;
        v24 = v14;
        v25 = v17;
        v26 = v11;
        v77 = v22;
        latestDownloadedAtomicInstance = [v22 latestDownloadedAtomicInstance];
        atomicInstanceUUID = [v76 atomicInstanceUUID];
        v29 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:atomicInstanceUUID];

        if (v29)
        {
          v38 = v26;
          v58 = v25;
          if (v74)
          {
            v59 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v59, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary = [v76 summary];
              summary2 = [v77 summary];
              *buf = 138544130;
              v91 = _updateLatestSummary2;
              v92 = 2114;
              v93 = summary;
              v94 = 2114;
              v95 = v16;
              v96 = 2114;
              v97 = summary2;
              _os_log_impl(&dword_0, v59, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors matched | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);
            }
          }

          objc_autoreleasePoolPop(v58);
          v57 = 1;
          v37 = v38;
          descriptorCopy = v76;
          goto LABEL_66;
        }

        v11 = v26;
        if (v74)
        {
          _updateLatestSummary4 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(_updateLatestSummary4, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary3 = [v76 summary];
            summary4 = [v77 summary];
            *buf = 138544130;
            v91 = _updateLatestSummary3;
            v92 = 2114;
            v93 = summary3;
            v94 = 2114;
            v95 = v16;
            v96 = 2114;
            v97 = summary4;
            _os_log_impl(&dword_0, _updateLatestSummary4, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors no match | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

            v11 = v26;
            self = selfCopy;

            v17 = v25;
            v14 = v24;
            v19 = v23;
            v21 = v77;
            goto LABEL_17;
          }

          v17 = v25;
          v14 = v24;
          v19 = v23;
          v13 = obj;
          v21 = v77;
          goto LABEL_20;
        }

        v17 = v25;
        v14 = v24;
        v19 = v23;
        v13 = obj;
        v21 = v77;
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v91 = _updateLatestSummary4;
          v92 = 2114;
          v93 = v16;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to determine previous status (downloaded set-descriptors) | entryID:%{public}@", buf, 0x16u);
          goto LABEL_20;
        }
      }

LABEL_21:

      objc_autoreleasePoolPop(v17);
      if (v13 == ++v15)
      {
        v13 = [v11 countByEnumeratingWithState:&v85 objects:v98 count:16];
        if (!v13)
        {
          loggingCopy = v74;
          v10 = v70;
          descriptorCopy = v76;
          goto LABEL_27;
        }

        goto LABEL_4;
      }
    }
  }

  if (loggingCopy)
  {
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543362;
      v91 = _updateLatestSummary5;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] DownloadedSetDescriptors no persistedEntryIDs", buf, 0xCu);
    }

LABEL_27:
  }

  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
  v37 = [persistedActiveJobSetDescriptors persistedEntryIDs:@"atomicInstanceHasDownloadedSetDescriptor"];

  if ([v37 count])
  {
    v83 = 0u;
    v84 = 0u;
    v81 = 0u;
    v82 = 0u;
    v38 = v37;
    v80 = [v38 countByEnumeratingWithState:&v81 objects:v89 count:16];
    if (v80)
    {
      v75 = loggingCopy;
      v39 = @"atomicInstanceHasDownloadedSetDescriptor";
      v78 = *v82;
      obja = v38;
LABEL_31:
      v40 = 0;
      while (1)
      {
        if (*v82 != v78)
        {
          objc_enumerationMutation(obja);
        }

        v41 = *(*(&v81 + 1) + 8 * v40);
        v42 = objc_autoreleasePoolPush();
        persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        v44 = [persistedActiveJobSetDescriptors2 persistedEntry:v41 fromLocation:v39];

        if (!v44)
        {
          v47 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = _updateLatestSummary6;
            v92 = 2114;
            v93 = v41;
            _os_log_impl(&dword_0, v47, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to determine previous status (active-job set-descriptors) | entryID:%{public}@", buf, 0x16u);
          }

          goto LABEL_48;
        }

        persistedActiveJobSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
        v46 = v39;
        v47 = [persistedActiveJobSetDescriptors3 decodeFromLocation:v39 ofEntryName:v41 fromPersistedEntry:v44 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v47)
        {
          latestDownloadedAtomicInstance2 = [v47 latestDownloadedAtomicInstance];
          atomicInstanceUUID2 = [descriptorCopy atomicInstanceUUID];
          v50 = [SUCore stringIsEqual:latestDownloadedAtomicInstance2 to:atomicInstanceUUID2];

          if (v50)
          {
            descriptorCopy = v76;
            v38 = obja;
            v64 = v42;
            if (v75)
            {
              v65 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary7 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                summary5 = [v76 summary];
                summary6 = [v47 summary];
                *buf = 138544130;
                v91 = _updateLatestSummary7;
                v92 = 2114;
                v93 = summary5;
                v94 = 2114;
                v95 = v41;
                v96 = 2114;
                v97 = summary6;
                _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors matched | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

                descriptorCopy = v76;
              }
            }

            objc_autoreleasePoolPop(v64);
            v57 = 1;
            goto LABEL_65;
          }

          if (!v75)
          {
            descriptorCopy = v76;
            goto LABEL_47;
          }

          v51 = _MADLog(@"AutoControl");
          descriptorCopy = v76;
          if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary8 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary7 = [v76 summary];
            summary8 = [v47 summary];
            *buf = 138544130;
            v91 = _updateLatestSummary8;
            v92 = 2114;
            v93 = summary7;
            v94 = 2114;
            v95 = v41;
            v96 = 2114;
            v97 = summary8;
            v55 = summary8;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors no match | setAtomicInstance:%{public}@ | entryID:%{public}@ | nextSetDescriptor:%{public}@", buf, 0x2Au);

            descriptorCopy = v76;
LABEL_44:
          }
        }

        else
        {
          v51 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary8 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v91 = _updateLatestSummary8;
            v92 = 2114;
            v93 = v41;
            _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} unable to load set-descriptor (active-job) | entryID:%{public}@", buf, 0x16u);
            goto LABEL_44;
          }
        }

LABEL_47:
        v39 = v46;
LABEL_48:

        objc_autoreleasePoolPop(v42);
        if (v80 == ++v40)
        {
          v38 = obja;
          v80 = [obja countByEnumeratingWithState:&v81 objects:v89 count:16];
          if (v80)
          {
            goto LABEL_31;
          }

          break;
        }
      }
    }

    v57 = 0;
LABEL_65:
    v37 = v38;
LABEL_66:
  }

  else
  {
    if (loggingCopy)
    {
      v38 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v38, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v91 = _updateLatestSummary9;
        _os_log_impl(&dword_0, v38, OS_LOG_TYPE_DEFAULT, "[%{public}@] {atomicInstanceHasDownloadedSetDescriptor} [VERBOSE] ActiveJobSetDescriptors no persistedEntryIDs", buf, 0xCu);
      }

      v57 = 0;
      goto LABEL_66;
    }

    v57 = 0;
  }

  return v57;
}

- (void)resumeJobsWhenBeforeFirstUnlock:(BOOL)unlock
{
  unlockCopy = unlock;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [NSString alloc];
  v8 = @"Y";
  if (!unlockCopy)
  {
    v8 = @"N";
  }

  v9 = [v7 initWithFormat:@"resumeJobsWhenBeforeFirstUnlock:%@", v8];
  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v11 = [persistedActiveJobs persistedEntryIDs:v9];

  v138 = objc_alloc_init(NSMutableArray);
  if ([v11 count])
  {
    v134 = unlockCopy;
    v136 = objc_alloc_init(NSMutableArray);
    v12 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"resumeJobsWhenBeforeFirstUnlock" ofContainer:@"persistedActiveJobs"];
    v180 = 0u;
    v181 = 0u;
    v178 = 0u;
    v179 = 0u;
    v135 = v11;
    obj = v11;
    v13 = [obj countByEnumeratingWithState:&v178 objects:v194 count:16];
    v169 = v9;
    if (v13)
    {
      v14 = v13;
      v137 = 0;
      v15 = *v179;
      v163 = v12;
      v164 = *v179;
      while (1)
      {
        v16 = 0;
        do
        {
          if (*v179 != v15)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v178 + 1) + 8 * v16);
          v18 = objc_autoreleasePoolPush();
          if (v17)
          {
            persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v20 = [persistedActiveJobs2 persistedEntry:v17 fromLocation:v9];

            if (v20)
            {
              v21 = v14;
              persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v23 = [persistedActiveJobs3 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

              persistedActiveJobs4 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              v25 = [persistedActiveJobs4 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetSelector" ofClass:objc_opt_class() allowingNilObject:0];

              v167 = v23;
              if (v23)
              {
                if ([v23 isBlankEntry])
                {
                  v26 = _MADLog(@"AutoControl");
                  v14 = v21;
                  if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543874;
                    v185 = _updateLatestSummary;
                    v186 = 2114;
                    v187 = v169;
                    v188 = 2114;
                    v189 = v17;
                    v28 = v26;
                    v29 = OS_LOG_TYPE_DEFAULT;
                    v30 = "[%{public}@] {%{public}@} encountered blank auto-asset-descriptor | entryID:%{public}@";
                    goto LABEL_23;
                  }

                  goto LABEL_24;
                }

                assetVersion = [v23 assetVersion];

                v14 = v21;
                if (assetVersion)
                {
                  v15 = v164;
                  if (v25)
                  {
                    assetVersion2 = [v25 assetVersion];

                    if (assetVersion2)
                    {
                      v156 = v25;
                      if (([v167 isOnFilesystem] & 1) == 0 && !-[MADAutoAssetControlManager jobDescriptorInFlightNowOnFilesystem:](self, "jobDescriptorInFlightNowOnFilesystem:", v167))
                      {
                        assetVersion3 = [v167 assetVersion];
                        if (assetVersion3)
                        {
                          v38 = assetVersion3;
                          assetId = [v167 assetId];

                          if (assetId)
                          {
                            v40 = [v20 stringForKey:@"autoAssetUUID"];
                            persistedActiveJobs5 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                            v139 = [persistedActiveJobs5 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"clientRequestMessage" ofClass:objc_opt_class() allowingNilObject:1];

                            persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                            v43 = [persistedKnownDescriptors decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"baseForPatchDescriptor" ofClass:objc_opt_class() allowingNilObject:1];

                            v141 = v40;
                            if (!v40)
                            {
                              v140 = v43;
                              v80 = _MADLog(@"AutoControl");
                              v25 = v156;
                              if (os_log_type_enabled(v80, OS_LOG_TYPE_ERROR))
                              {
                                contextd = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                summary = [v156 summary];
                                *buf = 138544386;
                                v185 = contextd;
                                v186 = 2114;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v17;
                                v190 = 2114;
                                v191 = summary;
                                v82 = summary;
                                v192 = 2114;
                                v193 = @"MISSING";
                                _os_log_impl(&dword_0, v80, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous information | entryID:%{public}@, selector:%{public}@, UUID:%{public}@", buf, 0x34u);
                              }

                              v12 = v163;
                              [v163 addObject:v17];
                              v9 = v169;
                              v83 = 0;
                              goto LABEL_88;
                            }

                            v25 = v156;
                            v146 = [(MADAutoAssetControlManager *)self currentJobBySelector:v156];
                            v44 = v43;
                            v12 = v163;
                            if (v44)
                            {
                              isBlankEntry = [v44 isBlankEntry];
                              v46 = v44;
                              v9 = v169;
                              if (isBlankEntry)
                              {

                                v140 = 0;
                              }

                              else
                              {
                                v140 = v46;
                              }
                            }

                            else
                            {
                              v140 = 0;
                              v9 = v169;
                            }

                            if (v146)
                            {
                              v86 = _MADLog(@"AutoControl");
                              if (os_log_type_enabled(v86, OS_LOG_TYPE_DEFAULT))
                              {
                                _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                *buf = 138543874;
                                v185 = _updateLatestSummary2;
                                v186 = 2114;
                                v187 = v169;
                                v188 = 2114;
                                v189 = v17;
                                _os_log_impl(&dword_0, v86, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} auto-asset-job already resumed | entry:%{public}@", buf, 0x20u);

                                v12 = v163;
                              }

                              [v12 addObject:v17];
                              v9 = v169;
LABEL_86:
                              v83 = v141;
LABEL_87:

LABEL_88:
LABEL_43:

                              goto LABEL_44;
                            }

                            if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock]|| ([(MADAutoAssetControlManager *)self _updatePolicyForSelector:v156], (v88 = objc_claimAutoreleasedReturnValue()) == 0))
                            {
                              [(MADAutoAssetControlManager *)self _moveFromAwaitingResumedInto:v138 forSelector:v156];
                              v146 = 0;
                              goto LABEL_86;
                            }

                            v133 = v88;
                            if (v134 && ([v88 blockIfBeforeFirstUnlock] & 1) != 0)
                            {
                              [(MADAutoAssetControlManager *)self _moveFromAwaitingResumedInto:v138 forSelector:v156];
                              v89 = v17;
                              v83 = v141;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v9 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v89 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"auto-asset-job resume postponed (awaiting first-unlock)"];

                              goto LABEL_88;
                            }

                            v132 = objc_alloc_init(NSMutableArray);
                            [MADAutoAssetControlManager _moveFromAwaitingResumedInto:"_moveFromAwaitingResumedInto:forSelector:" forSelector:?];
                            v146 = [[MADAutoAssetJob alloc] initForDescriptor:v167 withLifetimeOSTransaction:0 baseForPatchDescriptor:v140 withAutoAssetUUID:v141];
                            if (!v146)
                            {
                              autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                              contexte = [autoControlManagerFSM2 diag];
                              v93 = [NSString alloc];
                              summary2 = [v156 summary];
                              v95 = [v93 initWithFormat:@"{%@} unable to allocate autoAssetJob | selector:%@", v169, summary2];
                              [contexte trackAnomaly:@"AUTO-CONTROL" forReason:v95 withResult:6101 withError:0];

                              v9 = v169;
                              v25 = v156;

                              v12 = v163;
                              [(MADAutoAssetControlManager *)self _statsIncrementFailuresToStartJobs];
                              v96 = v17;
                              v83 = v141;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v169 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v96 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"unable to create auto-asset-job (not removing from active jobs persisted-state since may be able to recover on next MA daemon startup)"];
                              goto LABEL_128;
                            }

                            if ([(MADAutoAssetControlManager *)self _inMatchedTaskDescriptors:v136 addingMatchingJobUUID:v141])
                            {
                              v9 = v169;
                              [(MADAutoAssetControlManager *)self _logPersistedEntry:v169 forComponentType:@"ACTIVE-JOBS" operation:@"ENTRY_LOAD" forPersistedEntryID:v17 forClientRequest:v139 withJobUUID:v141 withAssetDescriptor:v167 baseForPatchDescriptor:v140 message:@"in-flight taskDescriptor repeated (already mapped to additional job)"];
                              v90 = _MADLog(@"AutoControl");
                              if (os_log_type_enabled(v90, OS_LOG_TYPE_ERROR))
                              {
                                _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                summary3 = [v156 summary];
                                *buf = 138544130;
                                v185 = _updateLatestSummary3;
                                v186 = 2112;
                                v187 = v169;
                                v188 = 2114;
                                v189 = summary3;
                                v190 = 2114;
                                v191 = v141;
                                _os_log_impl(&dword_0, v90, OS_LOG_TYPE_ERROR, "[%{public}@] {resumeJobsWhenBeforeFirstUnlock:%@} in-flight taskDescriptor repeated (already mapped to additional job) | selector:%{public}@, UUID:%{public}@", buf, 0x2Au);

                                v12 = v163;
                                v9 = v169;
                              }

LABEL_127:
                              v83 = v141;
LABEL_128:

                              goto LABEL_87;
                            }

                            messageName = [v139 messageName];
                            v98 = [(MADAutoAssetControlManager *)self _messageShouldBeScheduled:messageName forAssetSelector:v156];

                            if (v98)
                            {
                              [(MADAutoAssetControlManager *)self _scheduleSelector:v156];
                            }

                            [(MADAutoAssetControlManager *)self _removeJobFromDownloadsInFlight:v141];
                            [(MADAutoAssetControlManager *)self addToCurrentJobs:v146 usingSelector:v156 withJobUUID:v141 triggeredByClientMessage:v139 downloadingDescriptor:v167 baseForPatchDescriptor:v140 usingSetDescriptor:0 fromLocation:@"resumeJobsWhenBeforeFirstUnlock"];
                            [(MADAutoAssetControlManager *)self _trackActiveDescriptor:v169 operation:@"ENTRY_LOAD" usingSelector:v156 withJobUUID:v141 triggeredByClientMessage:v139 downloadingDescriptor:v167 baseForPatchDescriptor:v140 message:@"auto-asset-job resumed"];
                            [(MADAutoAssetControlManager *)self _statsIncrementResumedInFlightJobs];
                            [(MADAutoAssetControlManager *)self _statsIncrementAutoAssetJobsStarted];
                            v99 = [(MADAutoAssetControlManager *)self jobControlInformationForSelector:v156];
                            [v146 startResumingInFlightDownload:v167 withControlInformation:v99];

                            v176 = 0u;
                            v177 = 0u;
                            v174 = 0u;
                            v175 = 0u;
                            v145 = v132;
                            v155 = [v145 countByEnumeratingWithState:&v174 objects:v183 count:16];
                            if (!v155)
                            {
LABEL_126:
                              ++v137;

                              v9 = v169;
                              v15 = v164;
                              v25 = v156;
                              goto LABEL_127;
                            }

                            v152 = *v175;
                            while (2)
                            {
                              v100 = 0;
LABEL_111:
                              if (*v175 != v152)
                              {
                                objc_enumerationMutation(v145);
                              }

                              v101 = *(*(&v174 + 1) + 8 * v100);
                              contexta = objc_autoreleasePoolPush();
                              paramType = [v101 paramType];
                              if (paramType > 6)
                              {
                                if (paramType == (&dword_4 + 3))
                                {
                                  autoAssetJobID = [v101 autoAssetJobID];
                                  downloadOptions = [v101 downloadOptions];
                                  finishedError = [v101 finishedError];
                                  [v146 handleDownloadConfigJobFinished:autoAssetJobID withDownloadOptions:downloadOptions configError:finishedError];
LABEL_123:
                                }

                                else
                                {
                                  if (paramType != &dword_8)
                                  {
                                    goto LABEL_120;
                                  }

                                  autoAssetJobID = [v101 autoAssetJobID];
                                  downloadOptions = [v101 downloadProgress];
                                  [v146 handleDownloadAssetProgressForJob:autoAssetJobID withProgress:downloadOptions];
                                }
                              }

                              else if (paramType == (&dword_4 + 1))
                              {
                                autoAssetJobID = [v101 autoAssetJobID];
                                downloadOptions = [v101 finishedError];
                                [v146 handleDownloadAssetJobFinished:autoAssetJobID downloadError:downloadOptions];
                              }

                              else
                              {
                                if (paramType == (&dword_4 + 2))
                                {
                                  autoAssetJobID = [v101 autoAssetJobID];
                                  downloadOptions = [v101 autoAssetCatalog];
                                  finishedError = [v101 finishedError];
                                  [v146 handleDownloadCatalogJobFinished:autoAssetJobID withCatalog:downloadOptions downloadError:finishedError];
                                  goto LABEL_123;
                                }

LABEL_120:
                                autoAssetJobID = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                                downloadOptions = [autoAssetJobID diag];
                                v142 = [NSString alloc];
                                paramType2 = [v101 paramType];
                                _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                v107 = [v142 initWithFormat:@"{%@} unknown paramType(%ld) on earlyDownloadManagerEvents | %@", v169, paramType2, _updateLatestSummary4];
                                [downloadOptions trackAnomaly:@"AUTO-CONTROL" forReason:v107 withResult:6108 withError:0];
                              }

                              objc_autoreleasePoolPop(contexta);
                              v100 = v100 + 1;
                              v12 = v163;
                              if (v155 == v100)
                              {
                                v155 = [v145 countByEnumeratingWithState:&v174 objects:v183 count:16];
                                if (!v155)
                                {
                                  goto LABEL_126;
                                }

                                continue;
                              }

                              goto LABEL_111;
                            }
                          }
                        }
                      }

                      if (!-[MADAutoAssetControlManager jobDescriptorInFlightNowOnFilesystem:](self, "jobDescriptorInFlightNowOnFilesystem:", v167) || ([v167 assetVersion], (v51 = objc_claimAutoreleasedReturnValue()) == 0) || (v52 = v51, objc_msgSend(v167, "assetId"), v53 = objc_claimAutoreleasedReturnValue(), v53, v52, !v53))
                      {
                        v70 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v70, OS_LOG_TYPE_DEFAULT))
                        {
                          _updateLatestSummary5 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                          summary4 = [v167 summary];
                          *buf = 138543874;
                          v185 = _updateLatestSummary5;
                          v186 = 2114;
                          v187 = v169;
                          v188 = 2114;
                          v189 = summary4;
                          _os_log_impl(&dword_0, v70, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} not considering resuming | jobDescriptor:%{public}@", buf, 0x20u);

                          v15 = v164;
                        }

                        v12 = v163;
                        [v163 addObject:v17];
                        v9 = v169;
                        v25 = v156;
                        goto LABEL_43;
                      }

                      contextb = [MAAutoAssetSelector alloc];
                      assetType = [v167 assetType];
                      assetSpecifier = [v167 assetSpecifier];
                      assetVersion4 = [v167 assetVersion];
                      v56 = [contextb initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion4];

                      v153 = v56;
                      if (v56)
                      {
                        persistedEntryID = [v56 persistedEntryID];
                        persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                        context = persistedEntryID;
                        v59 = [persistedKnownDescriptors2 persistedEntryAlreadyExists:persistedEntryID fromLocation:v169];

                        if (v59)
                        {
                          persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                          v61 = [persistedKnownDescriptors3 persistedEntry:persistedEntryID fromLocation:v169];

                          v150 = v61;
                          if (v61)
                          {
                            persistedKnownDescriptors4 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
                            v63 = [persistedKnownDescriptors4 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:context fromPersistedEntry:v61 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                            v64 = v63;
                            v12 = v163;
                            v25 = v156;
                            v147 = v64;
                            if (v64)
                            {
                              if ([v64 isOnFilesystem])
                              {
                                v65 = _MADLog(@"AutoControl");
                                if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
                                {
                                  _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                  summary5 = [v64 summary];
                                  *buf = 138543874;
                                  v185 = _updateLatestSummary6;
                                  v186 = 2114;
                                  v67 = v169;
                                  v187 = v169;
                                  v188 = 2114;
                                  v189 = summary5;
                                  v68 = v65;
                                  v69 = "[%{public}@] {%{public}@} previously in-flight already downloaded | nowDownloadedDescriptor:%{public}@";
                                  goto LABEL_92;
                                }

LABEL_93:
                                v9 = v169;
                              }

                              else
                              {
                                [v64 setIsOnFilesystem:1];
                                [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v64 fromLocation:@"resumeJobsWhenBeforeFirstUnlock(nowDownloadedDescriptor)"];
                                v65 = _MADLog(@"AutoControl");
                                if (!os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
                                {
                                  goto LABEL_93;
                                }

                                _updateLatestSummary6 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                                summary5 = [v64 summary];
                                *buf = 138543874;
                                v185 = _updateLatestSummary6;
                                v186 = 2114;
                                v67 = v169;
                                v187 = v169;
                                v188 = 2114;
                                v189 = summary5;
                                v68 = v65;
                                v69 = "[%{public}@] {%{public}@} previously in-flight already downloaded (known descriptor) | nowDownloadedDescriptor:%{public}@";
LABEL_92:
                                _os_log_impl(&dword_0, v68, OS_LOG_TYPE_DEFAULT, v69, buf, 0x20u);

                                v9 = v67;
                                v25 = v156;
                              }

                              v12 = v163;
                            }

                            else
                            {
                              v9 = v169;
                            }
                          }

                          else
                          {
                            v84 = _MADLog(@"AutoControl");
                            v147 = v84;
                            if (os_log_type_enabled(v84, OS_LOG_TYPE_ERROR))
                            {
                              _updateLatestSummary7 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                              summary6 = [v167 summary];
                              *buf = 138543874;
                              v185 = _updateLatestSummary7;
                              v186 = 2114;
                              v187 = v169;
                              v188 = 2114;
                              v189 = summary6;
                              _os_log_impl(&dword_0, v84, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} no persisted descriptor entry yet entry already exists | jobDescriptor:%{public}@", buf, 0x20u);

                              v9 = v169;
                              v12 = v163;
                            }

                            else
                            {
                              v12 = v163;
                              v9 = v169;
                            }

                            v25 = v156;
                          }
                        }

                        else
                        {
                          [v167 setIsOnFilesystem:1];
                          [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v167 fromLocation:@"resumeJobsWhenBeforeFirstUnlock(new jobDescriptor)"];
                          v77 = _MADLog(@"AutoControl");
                          v150 = v77;
                          if (os_log_type_enabled(v77, OS_LOG_TYPE_DEFAULT))
                          {
                            _updateLatestSummary8 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                            summary7 = [v167 summary];
                            *buf = 138543874;
                            v185 = _updateLatestSummary8;
                            v186 = 2114;
                            v187 = v169;
                            v188 = 2114;
                            v189 = summary7;
                            v79 = summary7;
                            _os_log_impl(&dword_0, v77, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} previously in-flight already downloaded (now downloaded descriptor) | jobDescriptor:%{public}@", buf, 0x20u);

                            v9 = v169;
                            v12 = v163;
                          }

                          else
                          {
                            v12 = v163;
                            v9 = v169;
                          }

                          v25 = v156;
                        }
                      }

                      else
                      {
                        v75 = _MADLog(@"AutoControl");
                        context = v75;
                        if (os_log_type_enabled(v75, OS_LOG_TYPE_ERROR))
                        {
                          _updateLatestSummary9 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                          summary8 = [v167 summary];
                          *buf = 138543874;
                          v185 = _updateLatestSummary9;
                          v186 = 2114;
                          v187 = v169;
                          v188 = 2114;
                          v189 = summary8;
                          _os_log_impl(&dword_0, v75, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to record downloaded-when-in-flight | jobDescriptor:%{public}@", buf, 0x20u);

                          v9 = v169;
                          v12 = v163;
                        }

                        else
                        {
                          v12 = v163;
                          v9 = v169;
                        }

                        v25 = v156;
                      }

                      [v12 addObject:v17];
                      goto LABEL_43;
                    }

                    v47 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                    {
                      contextc = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                      summary9 = [v25 summary];
                      *buf = 138544130;
                      v185 = contextc;
                      v186 = 2114;
                      v187 = v169;
                      v188 = 2114;
                      v189 = v17;
                      v190 = 2114;
                      v191 = summary9;
                      v74 = summary9;
                      _os_log_impl(&dword_0, v47, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} encountered auto-asset-descriptor with persisted asset-selector without asset-version | entryID:%{public}@ | jobSelector:%{public}@", buf, 0x2Au);

                      v12 = v163;
                    }

LABEL_41:

                    [v12 addObject:v17];
LABEL_42:
                    v9 = v169;
                    goto LABEL_43;
                  }

                  v47 = _MADLog(@"AutoControl");
                  if (!os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                  {
                    goto LABEL_41;
                  }

                  _updateLatestSummary10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v185 = _updateLatestSummary10;
                  v186 = 2114;
                  v187 = v169;
                  v188 = 2114;
                  v189 = v17;
                  v49 = v47;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-descriptor without persisted asset-selector | entryID:%{public}@";
                }

                else
                {
                  v47 = _MADLog(@"AutoControl");
                  v15 = v164;
                  if (!os_log_type_enabled(v47, OS_LOG_TYPE_DEFAULT))
                  {
                    goto LABEL_41;
                  }

                  _updateLatestSummary10 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v185 = _updateLatestSummary10;
                  v186 = 2114;
                  v187 = v169;
                  v188 = 2114;
                  v189 = v17;
                  v49 = v47;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-descriptor without asset-version | entryID:%{public}@";
                }

                _os_log_impl(&dword_0, v49, OS_LOG_TYPE_DEFAULT, v50, buf, 0x20u);

                v12 = v163;
                goto LABEL_41;
              }

              v26 = _MADLog(@"AutoControl");
              v14 = v21;
              if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                *buf = 138543874;
                v185 = _updateLatestSummary;
                v186 = 2114;
                v187 = v169;
                v188 = 2114;
                v189 = v17;
                v28 = v26;
                v29 = OS_LOG_TYPE_ERROR;
                v30 = "[%{public}@] {%{public}@} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_23:
                _os_log_impl(&dword_0, v28, v29, v30, buf, 0x20u);

                v12 = v163;
              }

LABEL_24:

              [v12 addObject:v17];
              v15 = v164;
              goto LABEL_42;
            }
          }

          v31 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary11 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v33 = _updateLatestSummary11;
            *buf = 138543874;
            v34 = @"N";
            if (v17)
            {
              v34 = v17;
            }

            v185 = _updateLatestSummary11;
            v186 = 2114;
            v187 = v9;
            v188 = 2114;
            v189 = v34;
            _os_log_impl(&dword_0, v31, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
          }

          if (v17)
          {
            [v12 addObject:v17];
          }

LABEL_44:
          objc_autoreleasePoolPop(v18);
          v16 = v16 + 1;
        }

        while (v16 != v14);
        v109 = [obj countByEnumeratingWithState:&v178 objects:v194 count:16];
        v14 = v109;
        if (!v109)
        {
          goto LABEL_134;
        }
      }
    }

    v137 = 0;
LABEL_134:

    v172 = 0u;
    v173 = 0u;
    v170 = 0u;
    v171 = 0u;
    obja = v12;
    v112 = [obja countByEnumeratingWithState:&v170 objects:v182 count:16];
    if (v112)
    {
      v113 = v112;
      v168 = *v171;
      do
      {
        for (i = 0; i != v113; i = i + 1)
        {
          if (*v171 != v168)
          {
            objc_enumerationMutation(obja);
          }

          v115 = *(*(&v170 + 1) + 8 * i);
          v116 = objc_autoreleasePoolPush();
          if (v115)
          {
            persistedActiveJobs6 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            autoControlManagerFSM3 = [persistedActiveJobs6 persistedEntry:v115 fromLocation:v169];

            persistedActiveJobs7 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            diag = [persistedActiveJobs7 decodeFromLocation:@"resumeJobsWhenBeforeFirstUnlock" ofEntryName:v115 fromPersistedEntry:autoControlManagerFSM3 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (diag)
            {
              persistedActiveJobs8 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              [persistedActiveJobs8 removePersistedEntry:v115 fromLocation:@"resumeJobsWhenBeforeFirstUnlock"];

              [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:v169 forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v115 removedDescriptor:diag message:@"removing stale active-persisted job"];
            }
          }

          else
          {
            autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [autoControlManagerFSM3 diag];
            v122 = [NSString alloc];
            _updateLatestSummary12 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v123 = [v122 initWithFormat:@"{%@} nil entryID encountered on staleActivePersistedEntryIDs | %@", v169, _updateLatestSummary12];
            [diag trackAnomaly:@"AUTO-CONTROL" forReason:v123 withResult:6108 withError:0];
          }

          objc_autoreleasePoolPop(v116);
        }

        v113 = [obja countByEnumeratingWithState:&v170 objects:v182 count:16];
      }

      while (v113);
    }

    v125 = _MADLog(@"AutoControl");
    v126 = os_log_type_enabled(v125, OS_LOG_TYPE_DEFAULT);
    if (v137 < 1)
    {
      v9 = v169;
      if (v126)
      {
        _updateLatestSummary13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v185 = _updateLatestSummary13;
        v186 = 2114;
        v187 = v169;
        v129 = "[%{public}@] {%{public}@} no jobs resumed (now active) | MA_MILESTONE";
        v130 = v125;
        v131 = 22;
LABEL_152:
        _os_log_impl(&dword_0, v130, OS_LOG_TYPE_DEFAULT, v129, buf, v131);
      }
    }

    else
    {
      v9 = v169;
      if (v126)
      {
        _updateLatestSummary13 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        v128 = @"s";
        *buf = 138544130;
        v185 = _updateLatestSummary13;
        v186 = 2114;
        if (v137 == 1)
        {
          v128 = &stru_4BD3F0;
        }

        v187 = v169;
        v188 = 2048;
        v189 = v137;
        v190 = 2114;
        v191 = v128;
        v129 = "[%{public}@] {%{public}@} resumed %ld job%{public}@ (now active) | MA_MILESTONE";
        v130 = v125;
        v131 = 42;
        goto LABEL_152;
      }
    }

    v11 = v135;
    v110 = v136;
    goto LABEL_154;
  }

  v110 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v110, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary14 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543618;
    v185 = _updateLatestSummary14;
    v186 = 2114;
    v187 = v9;
    _os_log_impl(&dword_0, v110, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no persisted auto-asset-jobs to be resumed | MA_MILESTONE", buf, 0x16u);
  }

LABEL_154:

  [(MADAutoAssetControlManager *)self _logPersistedTableOfContents:v9 forComponentType:@"ACTIVE-JOBS"];
  [(MADAutoAssetControlManager *)self setDownloadManagerEventsAwaitingResumed:v138];
}

- (void)resumeSetJobsWhenBeforeFirstUnlock:(BOOL)unlock
{
  unlockCopy = unlock;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([(MADAutoAssetControlManager *)selfCopy persistedActiveSetJobsLoaded])
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      v9 = _updateLatestSummary;
      v10 = @"N";
      if (unlockCopy)
      {
        v10 = @"Y";
      }

      *buf = 138543618;
      v116 = _updateLatestSummary;
      v117 = 2112;
      v118 = v10;
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {resumeSetJobsWhenBeforeFirstUnlock:%@} called when persisted active set-jobs loaded earlier", buf, 0x16u);
    }

    goto LABEL_101;
  }

  [(MADAutoAssetControlManager *)selfCopy setPersistedActiveSetJobsLoaded:1];
  v11 = [NSString alloc];
  v12 = @"Y";
  if (!unlockCopy)
  {
    v12 = @"N";
  }

  v7 = [v11 initWithFormat:@"resumeSetJobsWhenBeforeFirstUnlock:%@", v12];
  persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
  v14 = [persistedActiveJobSetDescriptors persistedEntryIDs:v7];

  if ([v14 count])
  {
    v15 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)selfCopy trackPerformanceIteration:@"resumeSetJobsWhenBeforeFirstUnlock" ofContainer:@"persistedActiveJobSetDescriptors"];
    v113 = 0u;
    v114 = 0u;
    v111 = 0u;
    v112 = 0u;
    v87 = v14;
    obj = v14;
    v16 = [obj countByEnumeratingWithState:&v111 objects:v126 count:16];
    v99 = v15;
    v106 = v7;
    v88 = unlockCopy;
    if (!v16)
    {
      v89 = 0;
      goto LABEL_67;
    }

    v17 = v16;
    v89 = 0;
    v18 = *v112;
    while (1)
    {
      v19 = 0;
      v102 = v17;
      do
      {
        if (*v112 != v18)
        {
          objc_enumerationMutation(obj);
        }

        v20 = *(*(&v111 + 1) + 8 * v19);
        v21 = objc_autoreleasePoolPush();
        if (v20)
        {
          persistedActiveJobSetDescriptors2 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
          v23 = [persistedActiveJobSetDescriptors2 persistedEntry:v20 fromLocation:v7];

          if (v23)
          {
            v24 = selfCopy;
            persistedActiveJobSetDescriptors3 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
            v26 = [persistedActiveJobSetDescriptors3 decodeFromLocation:@"resumeSetJobsWhenBeforeFirstUnlock" ofEntryName:v20 fromPersistedEntry:v23 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v26)
            {
              assetSetIdentifier = [v26 assetSetIdentifier];

              if (assetSetIdentifier)
              {
                discoveredAtomicInstance = [v26 discoveredAtomicInstance];

                if (discoveredAtomicInstance)
                {
                  discoveredAtomicEntries = [v26 discoveredAtomicEntries];

                  if (discoveredAtomicEntries)
                  {
                    if ([v26 isOnFilesystem])
                    {
                      goto LABEL_41;
                    }

                    clientDomainName = [v26 clientDomainName];
                    assetSetIdentifier2 = [v26 assetSetIdentifier];
                    v98 = [(MADAutoAssetControlManager *)selfCopy locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier2];

                    discoveredAtomicInstance2 = [v26 discoveredAtomicInstance];
                    v96 = [(MADAutoAssetControlManager *)selfCopy locateSetAtomicInstanceByInstanceUUID:discoveredAtomicInstance2];

                    discoveredAtomicInstance3 = [v26 discoveredAtomicInstance];
                    v34 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptor:@"resumeSetJobsWhenBeforeFirstUnlock" forAtomicInstanceUUID:discoveredAtomicInstance3 requireExists:0];

                    discoveredAtomicInstance4 = [v26 discoveredAtomicInstance];
                    v36 = [(MADAutoAssetControlManager *)selfCopy locateSetDescriptorActiveJobByAtomicInstanceUUID:discoveredAtomicInstance4];

                    v100 = v34;
                    v97 = v36;
                    if (v34)
                    {
                      v37 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
                      {
                        _updateLatestSummary2 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        summary = [v26 summary];
                        summary2 = [v34 summary];
                        *buf = 138544130;
                        v116 = _updateLatestSummary2;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = summary;
                        v121 = 2114;
                        v122 = summary2;
                        v40 = summary2;
                        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} not considering resuming active-set-job since have already downloaded set-descriptor | setJobDescriptor:%{public}@ | downloadedSetDescriptor:%{public}@", buf, 0x2Au);
                      }

                      v15 = v99;
                      [v99 addObject:v20];
                      v41 = v98;
                      goto LABEL_57;
                    }

                    v15 = v99;
                    if (v36)
                    {
                      v51 = _MADLog(@"AutoControl");
                      v41 = v98;
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        _updateLatestSummary3 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        summary3 = [v26 summary];
                        summary4 = [v97 summary];
                        *buf = 138544130;
                        v116 = _updateLatestSummary3;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = summary3;
                        v121 = 2114;
                        v122 = summary4;
                        _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} active-set-job set-descriptor repeated (already adopted set-job) | dropping repeated setJobDescriptor:%{public}@ | already tracking active setJobDescriptor:%{public}@", buf, 0x2Au);

                        v15 = v99;
                        v41 = v98;
                      }

                      goto LABEL_56;
                    }

                    v41 = v98;
                    if (v98)
                    {
                      if (v96)
                      {
                        v94 = [(MADAutoAssetControlManager *)v24 locateActiveAutoJobForSetDescriptor:v26];
                        if (v94)
                        {
                          ++v89;
                          [(MADAutoAssetControlManager *)v24 updateAutoAssetSetStatus:@"resumeSetJobsWhenBeforeFirstUnlock" forSetDescriptor:v26];
                        }

                        else
                        {
                          v58 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
                          {
                            _updateLatestSummary4 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                            summary5 = [v26 summary];
                            *buf = 138543874;
                            v116 = _updateLatestSummary4;
                            v117 = 2114;
                            v118 = v106;
                            v119 = 2114;
                            v120 = summary5;
                            v60 = summary5;
                            _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} active-set-job set-descriptor yet no active active auto-asset-job | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@", buf, 0x20u);

                            v15 = v99;
                          }

                          [v15 addObject:v20];
                        }

LABEL_57:
LABEL_41:

                        v7 = v106;
                        selfCopy = v24;
                        v17 = v102;
                        goto LABEL_42;
                      }

                      v51 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        _updateLatestSummary5 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        summary6 = [v26 summary];
                        *buf = 138543874;
                        v116 = _updateLatestSummary5;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = summary6;
                        v54 = summary6;
                        v55 = v51;
                        v56 = "[%{public}@] {%{public}@} active-set-job set-descriptor yet no set-atomic-instance | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@";
LABEL_55:
                        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, v56, buf, 0x20u);

                        v15 = v99;
                      }
                    }

                    else
                    {
                      v51 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
                      {
                        _updateLatestSummary5 = [(MADAutoAssetControlManager *)v24 _updateLatestSummary];
                        summary7 = [v26 summary];
                        *buf = 138543874;
                        v116 = _updateLatestSummary5;
                        v117 = 2114;
                        v118 = v106;
                        v119 = 2114;
                        v120 = summary7;
                        v54 = summary7;
                        v55 = v51;
                        v56 = "[%{public}@] {%{public}@} active-set-job set-descriptor yet no set-configuration | dropping presumed-stale previously active set-job | setJobDescriptor:%{public}@";
                        goto LABEL_55;
                      }
                    }

LABEL_56:

                    [v15 addObject:v20];
                    goto LABEL_57;
                  }

                  v46 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                    *buf = 138543874;
                    v116 = _updateLatestSummary6;
                    v117 = 2114;
                    v118 = v106;
                    v119 = 2114;
                    v120 = v20;
                    v48 = v46;
                    v49 = OS_LOG_TYPE_DEFAULT;
                    v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without discoveredAtomicEntries | entryID:%{public}@";
LABEL_39:
                    _os_log_impl(&dword_0, v48, v49, v50, buf, 0x20u);

                    v15 = v99;
                  }
                }

                else
                {
                  v46 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                  {
                    _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                    *buf = 138543874;
                    v116 = _updateLatestSummary6;
                    v117 = 2114;
                    v118 = v106;
                    v119 = 2114;
                    v120 = v20;
                    v48 = v46;
                    v49 = OS_LOG_TYPE_DEFAULT;
                    v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without discoveredAtomicInstance | entryID:%{public}@";
                    goto LABEL_39;
                  }
                }
              }

              else
              {
                v46 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  *buf = 138543874;
                  v116 = _updateLatestSummary6;
                  v117 = 2114;
                  v118 = v106;
                  v119 = 2114;
                  v120 = v20;
                  v48 = v46;
                  v49 = OS_LOG_TYPE_DEFAULT;
                  v50 = "[%{public}@] {%{public}@} encountered auto-asset-set-descriptor without assetSetIdentifier | entryID:%{public}@";
                  goto LABEL_39;
                }
              }
            }

            else
            {
              v46 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v46, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary6 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                *buf = 138543874;
                v116 = _updateLatestSummary6;
                v117 = 2114;
                v118 = v106;
                v119 = 2114;
                v120 = v20;
                v48 = v46;
                v49 = OS_LOG_TYPE_ERROR;
                v50 = "[%{public}@] {%{public}@} unable to load auto-asset-set-descriptor | entryID:%{public}@";
                goto LABEL_39;
              }
            }

            [v15 addObject:v20];
            goto LABEL_41;
          }
        }

        v42 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary7 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v44 = _updateLatestSummary7;
          *buf = 138543874;
          v45 = @"N";
          if (v20)
          {
            v45 = v20;
          }

          v116 = _updateLatestSummary7;
          v117 = 2114;
          v118 = v7;
          v119 = 2114;
          v120 = v45;
          _os_log_impl(&dword_0, v42, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
        }

        if (v20)
        {
          [v15 addObject:v20];
        }

LABEL_42:
        objc_autoreleasePoolPop(v21);
        v19 = v19 + 1;
      }

      while (v17 != v19);
      v61 = [obj countByEnumeratingWithState:&v111 objects:v126 count:16];
      v17 = v61;
      if (!v61)
      {
LABEL_67:

        v63 = [v15 count];
        if (v88)
        {
          v64 = v63;
          v14 = v87;
          if (v63 >= 1)
          {
            v65 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v65, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary8 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              v67 = @"s";
              *buf = 138544130;
              v116 = _updateLatestSummary8;
              v117 = 2114;
              if (v64 == &dword_0 + 1)
              {
                v67 = &stru_4BD3F0;
              }

              v118 = v7;
              v119 = 2048;
              v120 = v64;
              v121 = 2114;
              v122 = v67;
              _os_log_impl(&dword_0, v65, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} discovered %ld potentially stale active-set-job%{public}@ (when before first unlock) | waiting to be beyond first-unlock before clearing", buf, 0x2Au);
            }

            goto LABEL_86;
          }
        }

        else
        {
          v109 = 0u;
          v110 = 0u;
          v107 = 0u;
          v108 = 0u;
          v65 = v15;
          obja = [v65 countByEnumeratingWithState:&v107 objects:v125 count:16];
          if (obja)
          {
            v103 = *v108;
            v101 = v65;
            do
            {
              for (i = 0; i != obja; i = i + 1)
              {
                if (*v108 != v103)
                {
                  objc_enumerationMutation(v101);
                }

                v69 = *(*(&v107 + 1) + 8 * i);
                v70 = objc_autoreleasePoolPush();
                if (v69)
                {
                  persistedActiveJobSetDescriptors4 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
                  autoControlManagerFSM2 = [persistedActiveJobSetDescriptors4 persistedEntry:v69 fromLocation:v106];

                  persistedActiveJobSetDescriptors5 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
                  diag = [persistedActiveJobSetDescriptors5 decodeFromLocation:@"resumeSetJobsWhenBeforeFirstUnlock" ofEntryName:v69 fromPersistedEntry:autoControlManagerFSM2 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                  if (diag)
                  {
                    persistedActiveJobSetDescriptors6 = [(MADAutoAssetControlManager *)selfCopy persistedActiveJobSetDescriptors];
                    [persistedActiveJobSetDescriptors6 removePersistedEntry:v69 fromLocation:@"resumeSetJobsWhenBeforeFirstUnlock"];

                    [(MADAutoAssetControlManager *)selfCopy _logPersistedSetDescriptorRemoved:v106 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS" removedPersistedEntryID:v69 removedSetDescriptor:diag message:@"removing stale active-persisted set-job"];
                  }
                }

                else
                {
                  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
                  diag = [autoControlManagerFSM2 diag];
                  v76 = [NSString alloc];
                  _updateLatestSummary9 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  v78 = [v76 initWithFormat:@"{%@} nil entryID encountered on staleActivePersistedEntryIDs | %@", v106, _updateLatestSummary9];
                  [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v78 withResult:6108 withError:0];
                }

                objc_autoreleasePoolPop(v70);
              }

              v65 = v101;
              obja = [v101 countByEnumeratingWithState:&v107 objects:v125 count:16];
            }

            while (obja);
            v7 = v106;
          }

          v14 = v87;
          v15 = v99;
LABEL_86:
        }

        _updateLatestSummary11 = _MADLog(@"AutoControl");
        v79 = os_log_type_enabled(_updateLatestSummary11, OS_LOG_TYPE_DEFAULT);
        if (v89 < 1)
        {
          if (v79)
          {
            _updateLatestSummary10 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
            v86 = @"now active";
            *buf = 138543874;
            v116 = _updateLatestSummary10;
            v117 = 2114;
            if (v88)
            {
              v86 = @"before first-unlock";
            }

            v118 = v7;
            v119 = 2114;
            v120 = v86;
            v83 = "[%{public}@] {%{public}@} no set-jobs resumed (%{public}@) | MA_MILESTONE";
            v84 = _updateLatestSummary11;
            v85 = 32;
LABEL_98:
            _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, v83, buf, v85);
          }
        }

        else if (v79)
        {
          _updateLatestSummary10 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v81 = @"s";
          *buf = 138544386;
          v116 = _updateLatestSummary10;
          if (v89 == 1)
          {
            v81 = &stru_4BD3F0;
          }

          v82 = @"now active";
          v119 = 2048;
          v120 = v89;
          v117 = 2114;
          v118 = v7;
          v121 = 2114;
          if (v88)
          {
            v82 = @"before first-unlock";
          }

          v122 = v81;
          v123 = 2114;
          v124 = v82;
          v83 = "[%{public}@] {%{public}@} resumed %ld set-job%{public}@ (%{public}@) | MA_MILESTONE";
          v84 = _updateLatestSummary11;
          v85 = 52;
          goto LABEL_98;
        }

LABEL_99:

        goto LABEL_100;
      }
    }
  }

  v15 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary11 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    *buf = 138543618;
    v116 = _updateLatestSummary11;
    v117 = 2114;
    v118 = v7;
    _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} no persisted auto-asset-set-jobs to be resumed | MA_MILESTONE", buf, 0x16u);
    goto LABEL_99;
  }

LABEL_100:

  [(MADAutoAssetControlManager *)selfCopy _logPersistedTableOfContents:v7 forComponentType:@"SET_ACTIVE_JOB_DESCRIPTORS"];
LABEL_101:
}

- (void)_moveFromAwaitingResumedInto:(id)into forSelector:(id)selector
{
  intoCopy = into;
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v8 = objc_alloc_init(NSMutableArray);
  v24 = 0u;
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  selfCopy = self;
  obj = [(MADAutoAssetControlManager *)self downloadManagerEventsAwaitingResumed];
  v10 = [obj countByEnumeratingWithState:&v24 objects:v28 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v25;
    do
    {
      v13 = 0;
      do
      {
        if (*v25 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v24 + 1) + 8 * v13);
        v15 = objc_autoreleasePoolPush();
        if (v14)
        {
          autoAssetJobID = [v14 autoAssetJobID];
          v17 = [(MADAutoAssetControlManager *)selfCopy currentJobByUUID:autoAssetJobID fromLocation:@"_moveFromAwaitingResumedInto" notFoundCode:0 notFoundReason:0];

          v18 = v8;
          if (v17)
          {
            autoAssetSelector = [v17 autoAssetSelector];
            v20 = [autoAssetSelector isEqual:selectorCopy];

            if (v20)
            {
              v18 = intoCopy;
            }

            else
            {
              v18 = v8;
            }
          }

          [v18 addObject:v14];
        }

        objc_autoreleasePoolPop(v15);
        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v24 objects:v28 count:16];
    }

    while (v11);
  }

  [(MADAutoAssetControlManager *)selfCopy setDownloadManagerEventsAwaitingResumed:v8];
}

- (BOOL)_inDownloadsInFlight:(id)flight
{
  flightCopy = flight;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  downloadManagerInFlightTasks = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v7 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v22;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v22 != v9)
        {
          objc_enumerationMutation(downloadManagerInFlightTasks);
        }

        v11 = *(*(&v21 + 1) + 8 * i);
        v12 = objc_autoreleasePoolPush();
        if (v11)
        {
          if ([v11 containsString:flightCopy])
          {
            objc_autoreleasePoolPop(v12);
            v18 = 1;
            goto LABEL_13;
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v15 = [NSString alloc];
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v17 = [v15 initWithFormat:@"{_inDownloadsInFlight} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", _updateLatestSummary];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v17 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v12);
      }

      v8 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v8);
  }

  v18 = 0;
LABEL_13:

  return v18;
}

- (BOOL)_inMatchedTaskDescriptors:(id)descriptors addingMatchingJobUUID:(id)d
{
  descriptorsCopy = descriptors;
  dCopy = d;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  downloadManagerInFlightTasks = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v10 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v26 objects:v30 count:16];
  if (v10)
  {
    v11 = v10;
    v24 = descriptorsCopy;
    v12 = *v27;
    while (2)
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v27 != v12)
        {
          objc_enumerationMutation(downloadManagerInFlightTasks);
        }

        v14 = *(*(&v26 + 1) + 8 * i);
        v15 = objc_autoreleasePoolPush();
        if (v14)
        {
          if ([v14 containsString:dCopy])
          {
            descriptorsCopy = v24;
            v22 = [(MADAutoAssetControlManager *)self _taskDescriptorEncountered:v14 inMatchedDescriptors:v24];
            v21 = v22;
            if ((v22 & 1) == 0)
            {
              [v24 addObject:v14];
            }

            objc_autoreleasePoolPop(v15);
            goto LABEL_17;
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v18 = [NSString alloc];
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v20 = [v18 initWithFormat:@"{_inMatchedTaskDescriptors} nil taskDescriptor encountered on downloadManagerInFlightTasks | %@", _updateLatestSummary];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v20 withResult:6108 withError:0];
        }

        objc_autoreleasePoolPop(v15);
      }

      v11 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v26 objects:v30 count:16];
      if (v11)
      {
        continue;
      }

      break;
    }

    v21 = 0;
    descriptorsCopy = v24;
  }

  else
  {
    v21 = 0;
  }

LABEL_17:

  return v21;
}

- (BOOL)_taskDescriptorEncountered:(id)encountered inMatchedDescriptors:(id)descriptors
{
  encounteredCopy = encountered;
  v11 = 0u;
  v12 = 0u;
  v13 = 0u;
  v14 = 0u;
  descriptorsCopy = descriptors;
  v7 = [descriptorsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
  if (v7)
  {
    v8 = *v12;
    while (2)
    {
      for (i = 0; i != v7; i = i + 1)
      {
        if (*v12 != v8)
        {
          objc_enumerationMutation(descriptorsCopy);
        }

        if (([SUCore stringIsEqual:encounteredCopy to:*(*(&v11 + 1) + 8 * i), v11]& 1) != 0)
        {
          LOBYTE(v7) = 1;
          goto LABEL_11;
        }
      }

      v7 = [descriptorsCopy countByEnumeratingWithState:&v11 objects:v15 count:16];
      if (v7)
      {
        continue;
      }

      break;
    }
  }

LABEL_11:

  return v7;
}

- (id)_newTrimmedToAutoAssetsInFlight:(id)flight
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v6 = objc_alloc_init(NSMutableArray);
  v14 = 0u;
  v15 = 0u;
  v16 = 0u;
  v17 = 0u;
  downloadManagerInFlightTasks = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v8 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    do
    {
      v11 = 0;
      do
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(downloadManagerInFlightTasks);
        }

        v12 = *(*(&v14 + 1) + 8 * v11);
        if (v12 && [*(*(&v14 + 1) + 8 * v11) containsString:@".auto."])
        {
          [v6 addObject:v12];
        }

        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [downloadManagerInFlightTasks countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v9);
  }

  if (![v6 count])
  {

    return 0;
  }

  return v6;
}

- (void)_removeJobFromDownloadsInFlight:(id)flight
{
  flightCopy = flight;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  downloadManagerInFlightTasks = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
  v7 = [downloadManagerInFlightTasks count];

  if (v7 >= 1)
  {
    v8 = 0;
    while (1)
    {
      downloadManagerInFlightTasks2 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
      v10 = [downloadManagerInFlightTasks2 objectAtIndex:v8];

      if (v10)
      {
        if ([v10 containsString:flightCopy])
        {
          break;
        }
      }

      if (v7 == ++v8)
      {
        goto LABEL_8;
      }
    }

    downloadManagerInFlightTasks3 = [(MADAutoAssetControlManager *)self downloadManagerInFlightTasks];
    [downloadManagerInFlightTasks3 removeObjectAtIndex:v8];
  }

LABEL_8:
}

- (id)jobControlInformationForSelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  simulateOperationsBySelector = [(MADAutoAssetControlManager *)self simulateOperationsBySelector];
  persistedEntryID = [selectorCopy persistedEntryID];
  assetVersion = [simulateOperationsBySelector safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (assetVersion)
  {
    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [selectorCopy summary];
      summary2 = [assetVersion summary];
      v24 = 138543874;
      v25 = _updateLatestSummary;
      v26 = 2114;
      v27 = summary;
      v28 = 2114;
      v29 = summary2;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSelector} SIMULATE | found control information | assetSelector:%{public}@ | associatedControlInfo:%{public}@", &v24, 0x20u);
    }
  }

  else
  {
    assetVersion = [selectorCopy assetVersion];

    if (!assetVersion)
    {
      goto LABEL_10;
    }

    v14 = [MAAutoAssetSelector alloc];
    assetType = [selectorCopy assetType];
    assetSpecifier = [selectorCopy assetSpecifier];
    v10 = [v14 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

    simulateOperationsBySelector2 = [(MADAutoAssetControlManager *)self simulateOperationsBySelector];
    persistedEntryID2 = [v10 persistedEntryID];
    assetVersion = [simulateOperationsBySelector2 safeObjectForKey:persistedEntryID2 ofClass:objc_opt_class()];

    if (assetVersion)
    {
      v19 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary3 = [v10 summary];
        summary4 = [assetVersion summary];
        v24 = 138543874;
        v25 = _updateLatestSummary2;
        v26 = 2114;
        v27 = summary3;
        v28 = 2114;
        v29 = summary4;
        _os_log_impl(&dword_0, v19, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSelector} SIMULATE(wildcarded) | found control information | assetSelector:%{public}@ | associatedControlInfo:%{public}@", &v24, 0x20u);
      }
    }
  }

LABEL_10:

  return assetVersion;
}

- (id)jobControlInformationForSetJobKey:(id)key
{
  keyCopy = key;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  simulateOperationsBySetJobKey = [(MADAutoAssetControlManager *)self simulateOperationsBySetJobKey];
  v8 = [simulateOperationsBySetJobKey safeObjectForKey:keyCopy ofClass:objc_opt_class()];

  if (v8)
  {
    v9 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [v8 summary];
      v13 = 138543874;
      v14 = _updateLatestSummary;
      v15 = 2114;
      v16 = keyCopy;
      v17 = 2114;
      v18 = summary;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSetJobKey} SIMULATE | found control information | setJobKey:%{public}@ | associatedControlInfo:%{public}@", &v13, 0x20u);
    }
  }

  return v8;
}

- (id)jobControlInformationForSetConfiguration:(id)configuration
{
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [configurationCopy clientDomainName];
  assetSetIdentifier = [configurationCopy assetSetIdentifier];
  v9 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  simulateOperationsBySetJobKey = [(MADAutoAssetControlManager *)self simulateOperationsBySetJobKey];
  v11 = [simulateOperationsBySetJobKey safeObjectForKey:v9 ofClass:objc_opt_class()];

  if (v11)
  {
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [configurationCopy summary];
      summary2 = [v11 summary];
      v17 = 138543874;
      v18 = _updateLatestSummary;
      v19 = 2114;
      v20 = summary;
      v21 = 2114;
      v22 = summary2;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {jobControlInformationForSetJobKey} SIMULATE | found control information | setConfiguration:%{public}@ | associatedControlInfo:%{public}@", &v17, 0x20u);
    }
  }

  return v11;
}

- (void)_removeFromPersistedActiveJobs:(id)jobs
{
  jobsCopy = jobs;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v8 = [persistedActiveJobs persistedEntryIDs:@"_removeFromPersistedActiveJobs"];

  if ([v8 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeFromPersistedActiveJobs" ofContainer:@"persistedActiveJobs"];
    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    v33 = v8;
    obj = v8;
    v37 = [obj countByEnumeratingWithState:&v38 objects:v46 count:16];
    if (!v37)
    {
      goto LABEL_30;
    }

    v36 = *v39;
    v34 = jobsCopy;
    while (1)
    {
      v9 = 0;
      do
      {
        if (*v39 != v36)
        {
          objc_enumerationMutation(obj);
        }

        v10 = *(*(&v38 + 1) + 8 * v9);
        v11 = objc_autoreleasePoolPush();
        persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
        v13 = [persistedActiveJobs2 persistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

        if (v13)
        {
          persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          v15 = [persistedActiveJobs3 decodeFromLocation:@"_removeFromPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          persistedActiveJobs4 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
          _updateLatestSummary3 = [persistedActiveJobs4 decodeFromLocation:@"_removeFromPersistedActiveJobs" ofEntryName:v10 fromPersistedEntry:v13 decodingObjectForKey:@"assetSelector" ofClass:objc_opt_class() allowingNilObject:0];

          if (v15)
          {
            if (![v15 isBlankEntry])
            {
              assetType = [v15 assetType];
              v25 = [SUCore stringIsEqual:assetType to:jobsCopy];

              if (v25)
              {
                if (_updateLatestSummary3)
                {
                  persistedEntryID = [_updateLatestSummary3 persistedEntryID];
                  currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
                  v28 = [currentJobsBySelector safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

                  if (v28)
                  {
                    currentJobsBySelector2 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
                    [currentJobsBySelector2 removeObjectForKey:persistedEntryID];
                  }

                  jobsCopy = v34;
                }

                else
                {
                  persistedEntryID = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(persistedEntryID, OS_LOG_TYPE_ERROR))
                  {
                    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                    *buf = 138543618;
                    v43 = _updateLatestSummary;
                    v44 = 2114;
                    v45 = v10;
                    _os_log_impl(&dword_0, persistedEntryID, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeFromPersistedActiveJobs} unable to load auto-asset-selector | entryID:%{public}@", buf, 0x16u);
                  }
                }

                persistedActiveJobs5 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
                [persistedActiveJobs5 removePersistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

                [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_removeFromPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v10 removedDescriptor:v15 message:@"removed auto-asset-descriptor for previously active job"];
              }

              goto LABEL_18;
            }

            persistedActiveJobs6 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            [persistedActiveJobs6 removePersistedEntry:v10 fromLocation:@"_removeFromPersistedActiveJobs"];

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_removeFromPersistedActiveJobs" forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:v10 removedDescriptor:v15 message:@"removed blank auto-asset-descriptor"];
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v43 = _updateLatestSummary2;
              v44 = 2114;
              v45 = v10;
              v21 = v19;
              v22 = OS_LOG_TYPE_DEFAULT;
              v23 = "[%{public}@] {_removeFromPersistedActiveJobs} removed blank auto-asset-descriptor | entryID:%{public}@";
              goto LABEL_16;
            }
          }

          else
          {
            v19 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v43 = _updateLatestSummary2;
              v44 = 2114;
              v45 = v10;
              v21 = v19;
              v22 = OS_LOG_TYPE_ERROR;
              v23 = "[%{public}@] {_removeFromPersistedActiveJobs} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
              _os_log_impl(&dword_0, v21, v22, v23, buf, 0x16u);
            }
          }

          goto LABEL_18;
        }

        v15 = _MADLog(@"AutoControl");
        if (!os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_19;
        }

        _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v43 = _updateLatestSummary3;
        v44 = 2114;
        v45 = v10;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeFromPersistedActiveJobs} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
LABEL_18:

LABEL_19:
        objc_autoreleasePoolPop(v11);
        v9 = v9 + 1;
      }

      while (v37 != v9);
      v32 = [obj countByEnumeratingWithState:&v38 objects:v46 count:16];
      v37 = v32;
      if (!v32)
      {
LABEL_30:

        v8 = v33;
        break;
      }
    }
  }
}

- (void)_scheduleSelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    v7 = [(MADAutoAssetControlManager *)self _updatePolicyForSelector:selectorCopy];
    persistedEntryID = [selectorCopy persistedEntryID];
    alreadyScheduledSelectors = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
    [alreadyScheduledSelectors setSafeObject:selectorCopy forKey:persistedEntryID];

    v10 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [selectorCopy summary];
      summary2 = [v7 summary];
      v14 = 138543874;
      v15 = _updateLatestSummary;
      v16 = 2114;
      v17 = summary;
      v18 = 2114;
      v19 = summary2;
      _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSelector} scheduling selector | autoAssetSelector:%{public}@, autoUpdatePolicy:%{public}@", &v14, 0x20u);
    }

    +[MADAutoAssetScheduler scheduleSelector:triggeringAtIntervalSecs:](MADAutoAssetScheduler, "scheduleSelector:triggeringAtIntervalSecs:", selectorCopy, [v7 checkForNewerIntervalSecs]);
  }
}

- (void)_scheduleSetConfiguration:(id)configuration withClientSetPolicy:(id)policy
{
  configurationCopy = configuration;
  policyCopy = policy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (!+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
  {
    autoAssetEntries = [configurationCopy autoAssetEntries];
    v11 = [autoAssetEntries count];

    v12 = _MADLog(@"AutoControl");
    v13 = os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT);
    if (v11)
    {
      if (v13)
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [configurationCopy summary];
        if (policyCopy)
        {
          summary2 = [policyCopy summary];
        }

        else
        {
          summary2 = @"N";
        }

        v26 = 138543874;
        v27 = _updateLatestSummary;
        v28 = 2114;
        v29 = summary;
        v30 = 2114;
        v31 = summary2;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSetConfiguration} scheduling set-configuration | setConfiguration:%{public}@ | setUpdatePolicy:%{public}@", &v26, 0x20u);
        if (policyCopy)
        {
        }
      }

      clientDomainName = [configurationCopy clientDomainName];
      assetSetIdentifier = [configurationCopy assetSetIdentifier];
      [MADAutoAssetScheduler scheduleSetDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier usingSetUpdatePolicy:policyCopy forSetConfiguration:configurationCopy];
    }

    else
    {
      if (v13)
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary3 = [configurationCopy summary];
        v26 = 138543618;
        v27 = _updateLatestSummary2;
        v28 = 2114;
        v29 = summary3;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_scheduleSetConfiguration} removing any scheduling of set-identifier (no auto-asset-entries) | setConfiguration:%{public}@", &v26, 0x16u);
      }

      clientDomainName2 = [configurationCopy clientDomainName];
      if (!clientDomainName2 || (v20 = clientDomainName2, [configurationCopy assetSetIdentifier], v21 = objc_claimAutoreleasedReturnValue(), v21, v20, !v21))
      {
        clientDomainName = _MADLog(@"AutoControl");
        if (os_log_type_enabled(clientDomainName, OS_LOG_TYPE_ERROR))
        {
          clientDomainName3 = [configurationCopy clientDomainName];
          assetSetIdentifier2 = [configurationCopy assetSetIdentifier];
          v26 = 138543618;
          v27 = clientDomainName3;
          v28 = 2114;
          v29 = assetSetIdentifier2;
          _os_log_impl(&dword_0, clientDomainName, OS_LOG_TYPE_ERROR, "{_scheduleSetConfiguration} nil client domain name or asset set identifier, will not proceed with eliminate! | clientDomainName:%{public}@ assetSetIdentifier:%{public}@", &v26, 0x16u);
        }

        goto LABEL_19;
      }

      clientDomainName = [configurationCopy clientDomainName];
      assetSetIdentifier = [configurationCopy assetSetIdentifier];
      [MADAutoAssetScheduler controlEliminateSetDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier indicatingWhenEliminated:0];
    }

LABEL_19:
  }
}

- (void)_schedulePushNotifications:(id)notifications
{
  notificationsCopy = notifications;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    safeSummary = [notificationsCopy safeSummary];
    v10 = 138543618;
    v11 = _updateLatestSummary;
    v12 = 2114;
    v13 = safeSummary;
    _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@] {CLOUDCHANNELS:_schedulePushNotifications} scheduling pushes | pushNotificationsBySelector:%{public}@", &v10, 0x16u);
  }

  [MADAutoAssetScheduler schedulePushNotifications:notificationsCopy];
}

- (BOOL)_haveSetAssetEntriesForSchedulerTriggered:(id)triggered
{
  triggeredCopy = triggered;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientDomainName = [triggeredCopy clientDomainName];
  if (clientDomainName)
  {
    v8 = clientDomainName;
    assetSetIdentifier = [triggeredCopy assetSetIdentifier];

    if (assetSetIdentifier)
    {
      clientDomainName2 = [triggeredCopy clientDomainName];
      assetSetIdentifier2 = [triggeredCopy assetSetIdentifier];
      v12 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

      if (v12)
      {
        autoAssetEntries = [v12 autoAssetEntries];
        v14 = [autoAssetEntries count];

        if (v14)
        {
          LOBYTE(assetSetIdentifier) = 1;
LABEL_13:

          goto LABEL_14;
        }

        assetSetIdentifier = _MADLog(@"AutoControl");
        if (os_log_type_enabled(assetSetIdentifier, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary = [triggeredCopy summary];
          summary2 = [v12 summary];
          v19 = 138543874;
          v20 = _updateLatestSummary;
          v21 = 2114;
          v22 = summary;
          v23 = 2112;
          v24 = summary2;
          _os_log_impl(&dword_0, assetSetIdentifier, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_haveSetAssetEntriesForSchedulerTriggered} empty set-configuration | schedulerTriggered:%{public}@ | setConfiguration:%@", &v19, 0x20u);

          goto LABEL_11;
        }
      }

      else
      {
        assetSetIdentifier = _MADLog(@"AutoControl");
        if (os_log_type_enabled(assetSetIdentifier, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          summary = [triggeredCopy summary];
          v19 = 138543618;
          v20 = _updateLatestSummary;
          v21 = 2114;
          v22 = summary;
          _os_log_impl(&dword_0, assetSetIdentifier, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_haveSetAssetEntriesForSchedulerTriggered} no set-configuration | schedulerTriggered:%{public}@", &v19, 0x16u);
LABEL_11:
        }
      }

      LOBYTE(assetSetIdentifier) = 0;
      goto LABEL_13;
    }
  }

  else
  {
    LOBYTE(assetSetIdentifier) = 0;
  }

LABEL_14:

  return assetSetIdentifier;
}

- (void)_schedulerTickOccurred
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [(MADAutoAssetControlManager *)self setConfigurationTickForPreviouslyVended];

  [(MADAutoAssetControlManager *)self _statsMaintainReporting];
}

+ (id)stagerSetPolicy
{
  if (stagerSetPolicy_dispatchOnceStagerSetPolicy != -1)
  {
    +[MADAutoAssetControlManager stagerSetPolicy];
  }

  v3 = stagerSetPolicy___stagerSetPolicy;

  return v3;
}

void __45__MADAutoAssetControlManager_stagerSetPolicy__block_invoke(id a1)
{
  v1 = objc_alloc_init(MANAutoAssetSetPolicy);
  v2 = stagerSetPolicy___stagerSetPolicy;
  stagerSetPolicy___stagerSetPolicy = v1;

  [stagerSetPolicy___stagerSetPolicy setUserInitiated:1];
  [stagerSetPolicy___stagerSetPolicy setLockInhibitsEmergencyRemoval:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOnBattery:1];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadWhenBatteryLow:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadWhenCPUHigh:1];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOverExpensive:0];
  [stagerSetPolicy___stagerSetPolicy setAllowCheckDownloadOverCellular:1];
  [stagerSetPolicy___stagerSetPolicy setBlockCheckDownload:0];
  v3 = _MADLog(@"Auto");
  if (os_log_type_enabled(v3, OS_LOG_TYPE_DEFAULT))
  {
    v4 = [stagerSetPolicy___stagerSetPolicy summary];
    v5 = 138543362;
    v6 = v4;
    _os_log_impl(&dword_0, v3, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{autoControlManager} initialized the fixed stager-set-policy | stagerSetPolicy:%{public}@", &v5, 0xCu);
  }
}

- (void)removePreviouslyStagedSetDescriptors
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v31 = objc_alloc_init(NSMutableArray);
  setDescriptorWalkKeys = [(MADAutoAssetControlManager *)self setDescriptorWalkKeys];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"removePreviouslyStagedSetDescriptors" ofContainer:@"setDescriptorWalkKeys"];
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  obj = setDescriptorWalkKeys;
  v6 = [obj countByEnumeratingWithState:&v37 objects:v46 count:16];
  if (v6)
  {
    v8 = v6;
    v9 = *v38;
    *&v7 = 138412546;
    v30 = v7;
    do
    {
      v10 = 0;
      do
      {
        if (*v38 != v9)
        {
          objc_enumerationMutation(obj);
        }

        v11 = *(*(&v37 + 1) + 8 * v10);
        v12 = objc_autoreleasePoolPush();
        knownSetAtomicInstancesByInstance = [(MADAutoAssetControlManager *)self knownSetAtomicInstancesByInstance];
        v14 = [knownSetAtomicInstancesByInstance safeObjectForKey:v11 ofClass:objc_opt_class()];

        if (!v14 || ([v14 clientDomainName], v15 = objc_claimAutoreleasedReturnValue(), v16 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v15, @"FROM_STAGED_FOR_ALL"), v15, v16))
        {
          v17 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"removePreviouslyStagedSetDescriptors" forKey:v11, v30];
          v18 = v17;
          if (v17)
          {
            clientDomainName = [v17 clientDomainName];
            v20 = [SUCore stringIsEqual:clientDomainName to:@"FROM_STAGED_FOR_ALL"];

            if ((v20 & 1) == 0)
            {
              v21 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_FAULT))
              {
                summary = [v18 summary];
                *buf = v30;
                v43 = @"removePreviouslyStagedSetDescriptors";
                v44 = 2112;
                v45 = summary;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_FAULT, "{%@} unexpected inconsistency for nextDownloadedSetDescriptor expected in staging | nextDownloadedSetDescriptor:%@", buf, 0x16u);
              }
            }

            [v31 addObject:v18];
          }
        }

        objc_autoreleasePoolPop(v12);
        v10 = v10 + 1;
      }

      while (v8 != v10);
      v8 = [obj countByEnumeratingWithState:&v37 objects:v46 count:16];
    }

    while (v8);
  }

  v35 = 0u;
  v36 = 0u;
  v33 = 0u;
  v34 = 0u;
  v23 = v31;
  v24 = [v23 countByEnumeratingWithState:&v33 objects:v41 count:16];
  if (v24)
  {
    v25 = v24;
    v26 = *v34;
    do
    {
      v27 = 0;
      do
      {
        if (*v34 != v26)
        {
          objc_enumerationMutation(v23);
        }

        v28 = *(*(&v33 + 1) + 8 * v27);
        v29 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v28 fromLocation:@"removePreviouslyStagedSetDescriptors" checkingByInstance:1 regardlessOfLatest:1 historyOperationAI:331 historyOperationSD:375];
        objc_autoreleasePoolPop(v29);
        v27 = v27 + 1;
      }

      while (v25 != v27);
      v25 = [v23 countByEnumeratingWithState:&v33 objects:v41 count:16];
    }

    while (v25);
  }
}

- (void)_stagedNewOSPromoteAdoptSetTargets
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locateNewAllSetTargets = [(MADAutoAssetControlManager *)self locateNewAllSetTargets];
  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  [persistedSetTargets removeAllPersistedEntries:@"auto-asset-stager has indicated new-OS-promotion - all set-targets were from previous OS viewpoint so no longer applicable"];

  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v7 = locateNewAllSetTargets;
  v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
  if (v8)
  {
    v9 = v8;
    v10 = *v15;
    do
    {
      v11 = 0;
      do
      {
        if (*v15 != v10)
        {
          objc_enumerationMutation(v7);
        }

        v12 = *(*(&v14 + 1) + 8 * v11);
        v13 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self modifySetConfiguration:@"_stagedNewOSPromoteAdoptSetTargets" toEntriesFromSetTarget:v12, v14];
        objc_autoreleasePoolPop(v13);
        v11 = v11 + 1;
      }

      while (v9 != v11);
      v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    }

    while (v9);
  }
}

- (void)modifySetConfiguration:(id)configuration toEntriesFromSetTarget:(id)target
{
  targetCopy = target;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  configurationCopy = [[NSString alloc] initWithFormat:@"%@:modifySetConfiguration", configurationCopy];
  clientDomainName = [targetCopy clientDomainName];
  assetSetIdentifier = [targetCopy assetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  if (!v13)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v31 = [NSString alloc];
    summary = [targetCopy summary];
    v33 = [v31 initWithFormat:@"{%@} no set-configuration for set-target | setTarget:%@", configurationCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v33 withResult:6103 withError:0];

    goto LABEL_15;
  }

  bootedOSVersion = [(MADAutoAssetControlManager *)self bootedOSVersion];
  autoControlManagerFSM2 = [MADAutoAssetControlManager restoreVersionFromOSVersion:bootedOSVersion];

  minTargetOSVersion = [targetCopy minTargetOSVersion];
  diag = [MADAutoAssetControlManager restoreVersionFromOSVersion:minTargetOSVersion];

  maxTargetOSVersion = [targetCopy maxTargetOSVersion];
  v19 = [MADAutoAssetControlManager restoreVersionFromOSVersion:maxTargetOSVersion];

  if (![diag isComparable:autoControlManagerFSM2] || !objc_msgSend(v19, "isComparable:", autoControlManagerFSM2))
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [autoControlManagerFSM3 diag];
    v28 = [NSString alloc];
    summary2 = [targetCopy summary];
    v30 = [v28 initWithFormat:@"{%@} set-target versions not comparable (ignoring) | setTarget:%@", configurationCopy, summary2];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6103 withError:0];

LABEL_11:
    goto LABEL_12;
  }

  v20 = [diag compare:autoControlManagerFSM2];
  v21 = [v19 compare:autoControlManagerFSM2];
  if (v20 == &dword_0 + 1 || v21 == -1)
  {
    autoControlManagerFSM3 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(autoControlManagerFSM3, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_12;
    }

    diag2 = [targetCopy summary];
    summary3 = [v13 summary];
    *buf = 138543874;
    v79 = configurationCopy;
    v80 = 2114;
    v81 = diag2;
    v82 = 2114;
    v83 = summary3;
    v27 = "{%{public}@} | set-target out-of-range | setTarget:%{public}@ | setConfiguration:%{public}@";
    goto LABEL_18;
  }

  autoAssetEntries = [targetCopy autoAssetEntries];
  v23 = [autoAssetEntries count];

  if (!v23)
  {
    clientDomainName2 = [v13 clientDomainName];
    assetSetIdentifier2 = [v13 assetSetIdentifier];
    [(MADAutoAssetControlManager *)self _eliminateAtomicTriggeredWhileLoading:configurationCopy forClientDomainName:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

    goto LABEL_13;
  }

  if (![(MADAutoAssetControlManager *)self setTargetEntries:targetCopy matchSetConfiguration:v13])
  {
    v76 = [MADAutoSetConfiguration alloc];
    clientDomainName3 = [v13 clientDomainName];
    autoAssetSetClientName = [v13 autoAssetSetClientName];
    assetSetIdentifier3 = [v13 assetSetIdentifier];
    autoAssetEntries2 = [targetCopy autoAssetEntries];
    discoveredInFlightAtomicInstance = [v13 discoveredInFlightAtomicInstance];
    newerAtomicInstanceOncePersonalized = [v13 newerAtomicInstanceOncePersonalized];
    latestAtomicInstanceToVend = [v13 latestAtomicInstanceToVend];
    latestAtomicInstanceToVendFromPreSUStaging = [v13 latestAtomicInstanceToVendFromPreSUStaging];
    previouslyVendedLockedAtomicInstances = [v13 previouslyVendedLockedAtomicInstances];
    ticksUntilPreviousForceUnlocked = [v13 ticksUntilPreviousForceUnlocked];
    mostRecentlyReceivedCachedAssetSetID = [v13 mostRecentlyReceivedCachedAssetSetID];
    mostRecentlyReceivedDownloadedFromLive = [v13 mostRecentlyReceivedDownloadedFromLive];
    mostRecentlyReceivedLastTimeChecked = [v13 mostRecentlyReceivedLastTimeChecked];
    mostRecentlyReceivedPostedDate = [v13 mostRecentlyReceivedPostedDate];
    latestToVendCachedAssetSetID = [v13 latestToVendCachedAssetSetID];
    latestToVendDownloadedFromLive = [v13 latestToVendDownloadedFromLive];
    latestToVendLastTimeChecked = [v13 latestToVendLastTimeChecked];
    latestToVendPostedDate = [v13 latestToVendPostedDate];
    availableForUseError = [v13 availableForUseError];
    newerVersionError = [v13 newerVersionError];
    everProvidedLatestToVend = [v13 everProvidedLatestToVend];
    inhibitImpliedScheduling = [v13 inhibitImpliedScheduling];
    haveReceivedLookupResponse = [v13 haveReceivedLookupResponse];
    BYTE3(v50) = [v13 vendingAtomicInstanceForConfiguredEntries];
    BYTE2(v50) = haveReceivedLookupResponse;
    BYTE1(v50) = inhibitImpliedScheduling;
    LOBYTE(v50) = everProvidedLatestToVend;
    LOBYTE(v49) = latestAtomicInstanceToVendFromPreSUStaging;
    v77 = [MADAutoSetConfiguration initForClientDomainName:v76 forSetClientName:"initForClientDomainName:forSetClientName:forAssetSetIdentifier:withAutoAssetEntries:withDiscoveredInFlightAtomicInstance:withNewerAtomicInstanceOncePersonalized:withLatestAtomicInstanceToVend:withLatestAtomicInstanceToVendFromPreSUStaging:withPreviouslyVendedLockedAtomicInstances:withTicksUntilPreviousForceUnlocked:withMostRecentlyReceivedCachedAssetSetID:withMostRecentlyReceivedDownloadedFromLive:withMostRecentlyReceivedLastTimeChecked:withMostRecentlyReceivedPostedDate:withLatestToVendCachedAssetSetID:withLatestToVendDownloadedFromLive:withLatestToVendLastTimeChecked:withLatestToVendPostedDate:withAavailableForUseError:withNewerVersionError:havingEverProvidedLatestToVend:inhibitingImpliedScheduling:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:" forAssetSetIdentifier:clientDomainName3 withAutoAssetEntries:autoAssetSetClientName withDiscoveredInFlightAtomicInstance:assetSetIdentifier3 withNewerAtomicInstanceOncePersonalized:autoAssetEntries2 withLatestAtomicInstanceToVend:discoveredInFlightAtomicInstance withLatestAtomicInstanceToVendFromPreSUStaging:newerAtomicInstanceOncePersonalized withPreviouslyVendedLockedAtomicInstances:latestAtomicInstanceToVend withTicksUntilPreviousForceUnlocked:v49 withMostRecentlyReceivedCachedAssetSetID:previouslyVendedLockedAtomicInstances withMostRecentlyReceivedDownloadedFromLive:ticksUntilPreviousForceUnlocked withMostRecentlyReceivedLastTimeChecked:mostRecentlyReceivedCachedAssetSetID withMostRecentlyReceivedPostedDate:mostRecentlyReceivedDownloadedFromLive withLatestToVendCachedAssetSetID:mostRecentlyReceivedLastTimeChecked withLatestToVendDownloadedFromLive:mostRecentlyReceivedPostedDate withLatestToVendLastTimeChecked:latestToVendCachedAssetSetID withLatestToVendPostedDate:latestToVendDownloadedFromLive withAavailableForUseError:latestToVendLastTimeChecked withNewerVersionError:latestToVendPostedDate havingEverProvidedLatestToVend:availableForUseError inhibitingImpliedScheduling:newerVersionError havingReceivedLookupResponse:v50 vendingAtomicInstanceForConfiguredEntries:?];

    v37 = [(MADAutoAssetControlManager *)self setConfigurationNewEntryIDForSetConfiguration:v77];
    persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
    v75 = v37;
    v39 = [persistedKnownSetConfigurations persistedEntry:v37 fromLocation:configurationCopy];

    v40 = v39;
    if (v39)
    {
      [v39 persistSecureCodedObject:v77 forKey:@"setConfiguration"];
      [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
      v41 = v73 = v39;
      summary4 = [v77 summary];
      [v41 storePersistedEntry:v75 withEntrySummary:summary4 fromLocation:configurationCopy];

      v43 = [NSString alloc];
      summary5 = [v13 summary];
      summary6 = [targetCopy summary];
      v45 = [v43 initWithFormat:@"{%@} altered set-configuration auto-asset-entries to align with set-target | setConfiguration:%@ | setTarget:%@", configurationCopy, summary5, summary6];
      v46 = v75;
      [(MADAutoAssetControlManager *)self _logPersistedSetConfiguration:configurationCopy operation:@"ENTRY_MODIFY" forPersistedEntryID:v75 withSetConfiguration:v77 historyOperation:447 message:v45];

      knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
      v40 = v73;
      [knownSetConfigurationsByIdentifier setSafeObject:v77 forKey:v75];
    }

    else
    {
      v46 = v75;
      knownSetConfigurationsByIdentifier = _MADLog(@"AutoControl");
      if (os_log_type_enabled(knownSetConfigurationsByIdentifier, OS_LOG_TYPE_ERROR))
      {
        summary7 = [targetCopy summary];
        *buf = 138543618;
        v79 = configurationCopy;
        v80 = 2114;
        v81 = summary7;
        _os_log_impl(&dword_0, knownSetConfigurationsByIdentifier, OS_LOG_TYPE_ERROR, "{%{public}@} | unable to load persisted-set-configuration file | set-target:%{public}@", buf, 0x16u);

        v40 = 0;
      }
    }

    goto LABEL_13;
  }

  autoControlManagerFSM3 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(autoControlManagerFSM3, OS_LOG_TYPE_ERROR))
  {
    diag2 = [targetCopy summary];
    summary3 = [v13 summary];
    *buf = 138543874;
    v79 = configurationCopy;
    v80 = 2114;
    v81 = diag2;
    v82 = 2114;
    v83 = summary3;
    v27 = "{%{public}@} | set-target entry matches set-configuration | setTarget:%{public}@ | setConfiguration:%{public}@";
LABEL_18:
    _os_log_impl(&dword_0, autoControlManagerFSM3, OS_LOG_TYPE_ERROR, v27, buf, 0x20u);

    goto LABEL_11;
  }

LABEL_12:

LABEL_13:
LABEL_15:
}

- (void)promoteAnyPreviouslyStagedNowDownloaded:(id)downloaded
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (downloadedCopy)
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"promoteAnyPreviouslyStagedNowDownloaded" ofContainer:@"promotedFromStagedToDownloaded"];
    v16 = 0u;
    v17 = 0u;
    v14 = 0u;
    v15 = 0u;
    v7 = downloadedCopy;
    v8 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v15;
      do
      {
        v11 = 0;
        do
        {
          if (*v15 != v10)
          {
            objc_enumerationMutation(v7);
          }

          v12 = *(*(&v14 + 1) + 8 * v11);
          v13 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)self _promotePreviouslyStagedNowDownloaded:v12 forHistoryOperation:205, v14];
          objc_autoreleasePoolPop(v13);
          v11 = v11 + 1;
        }

        while (v9 != v11);
        v9 = [v7 countByEnumeratingWithState:&v14 objects:v18 count:16];
      }

      while (v9);
    }
  }
}

- (void)_promotePreviouslyStagedNowDownloaded:(id)downloaded forHistoryOperation:(int64_t)operation
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  [downloadedCopy setIsOnFilesystem:1];
  v9 = [(MADAutoAssetControlManager *)self setConfigurationForDescriptorIfManagedAsSet:downloadedCopy];

  if (v9)
  {
    [downloadedCopy setFoundByLookupWithoutAssetVersion:1];
  }

  if ([(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:downloadedCopy])
  {
    if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"PROMOTE-PREVIOUSLY-STAGED" forDescriptor:downloadedCopy])
    {
      [MADAutoAssetSecure isPersonalizationRequired:@"PROMOTE-PREVIOUSLY-STAGED" forDescriptor:downloadedCopy];
    }

    v10 = [MAAutoAssetSelector alloc];
    assetType = [downloadedCopy assetType];
    assetSpecifier = [downloadedCopy assetSpecifier];
    assetVersion = [downloadedCopy assetVersion];
    v48 = [v10 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [downloadedCopy summary];
      *buf = 138543618;
      v50 = _updateLatestSummary;
      v51 = 2114;
      v52 = summary;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_promotePreviouslyStagedNowDownloaded} content on filesystem validated for promoted | descriptor:%{public}@", buf, 0x16u);
    }

    [(MADAutoAssetControlManager *)self _statsIncrementPromotedForDescriptor:downloadedCopy];
    LOBYTE(v36) = 1;
    [(MADAutoAssetControlManager *)self trackDescriptor:downloadedCopy persisting:1 fromLocation:@"_promotePreviouslyStagedNowDownloaded" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:operation firstClientName:0 isPromoted:v36];
    v17 = objc_alloc_init(MAAutoAssetNotifications);
    [v17 setContentAvailableForUse:1];
    metadata = [downloadedCopy metadata];
    neverBeenLocked = [downloadedCopy neverBeenLocked];
    downloadUserInitiated = [downloadedCopy downloadUserInitiated];
    downloadedNetworkBytes = [downloadedCopy downloadedNetworkBytes];
    downloadedFilesystemBytes = [downloadedCopy downloadedFilesystemBytes];
    isPatch = [downloadedCopy isPatch];
    patchedFromBaseSelector = [downloadedCopy patchedFromBaseSelector];
    patchedFromBaseFilesystemBytes = [downloadedCopy patchedFromBaseFilesystemBytes];
    patchingAttempted = [downloadedCopy patchingAttempted];
    stagedPriorToAvailable = [downloadedCopy stagedPriorToAvailable];
    stagedFromOSVersion = [downloadedCopy stagedFromOSVersion];
    stagedFromBuildVersion = [downloadedCopy stagedFromBuildVersion];
    patchingAttemptError = [downloadedCopy patchingAttemptError];
    LOBYTE(v40) = 0;
    BYTE1(v39) = stagedPriorToAvailable;
    LOBYTE(v39) = patchingAttempted;
    LOBYTE(v38) = isPatch;
    v37 = downloadedNetworkBytes;
    v25 = v48;
    v47 = v17;
    v26 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v48 withNotifications:v17 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:neverBeenLocked withDownloadUserInitiated:downloadUserInitiated withDownloadProgress:0 withDownloadedNetworkBytes:v37 withDownloadedFilesystemBytes:downloadedFilesystemBytes withDownloadedAsPatch:v38 withPatchedFromBaseSelector:patchedFromBaseSelector withPatchedFromBaseFilesystemBytes:patchedFromBaseFilesystemBytes withPatchingAttempted:v39 withStagedPriorToAvailable:stagedFromOSVersion withStagedFromOSVersion:stagedFromBuildVersion withStagedFromBuildVersion:v40 extendingWithCurrentLockUsage:0 withAvailableForUseError:patchingAttemptError withPatchingAttemptError:0 withNewerVersionError:?];

    currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
    v28 = [(MADAutoAssetControlManager *)self jobSelectorKey:v48];
    [currentStatusBySelector setSafeObject:v26 forKey:v28];

    v29 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary2 = [v26 summary];
      *buf = 138543618;
      v50 = _updateLatestSummary2;
      v51 = 2114;
      v52 = summary2;
      _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][PROMOTED] | currentStatus:%{public}@ | jobUUID:N", buf, 0x16u);
    }

    assetType2 = [downloadedCopy assetType];
    assetSpecifier2 = [downloadedCopy assetSpecifier];
    [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_DOWNLOADED" forAssetType:assetType2 forAssetSpecifier:assetSpecifier2 fromModule:@"STAGER" fromLocation:@"_promotePreviouslyStagedNowDownloaded"];
  }

  else
  {
    [downloadedCopy setIsOnFilesystem:0];
    v25 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary3 = [downloadedCopy summary];
      *buf = 138543618;
      v50 = _updateLatestSummary3;
      v51 = 2114;
      v52 = summary3;
      _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[%{public}@] {_promotePreviouslyStagedNowDownloaded} attempted to promote but not on filesystem | descriptor:%{public}@", buf, 0x16u);
    }
  }
}

+ (id)selectDispatchQueue:(id)queue
{
  queueCopy = queue;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = queueCopy;
  sharedDispatchQueue = v5;
  if (!v5)
  {
    sharedDispatchQueue = [v4 sharedDispatchQueue];
  }

  return sharedDispatchQueue;
}

+ (id)allocIntervalString:(int64_t)string
{
  if (string < 1)
  {
    return @"DISABLED";
  }

  v4 = string / 0x15180uLL;
  v5 = (string % 0x15180uLL) / 3600;
  v6 = (string % 0x15180uLL) % 3600;
  v7 = v6 / 60;
  v8 = v6 % 60;
  v9 = [NSString alloc];
  if (string >> 7 < 0x2A3)
  {
    return [v9 initWithFormat:@"%02ld:%02ld:%02ld", v5, v7, v8, v12, v13];
  }

  if ((string - 86400) >= 0x15180)
  {
    v11 = @"s";
  }

  else
  {
    v11 = &stru_4BD3F0;
  }

  return [v9 initWithFormat:@"%ld day%@ %02ld:%02ld:%02ld", v4, v11, v5, v7, v8];
}

+ (void)persistForJobSelector:(id)selector persistingJobDescriptor:(id)descriptor justDownloaded:(BOOL)downloaded justPatched:(BOOL)patched withJobInformation:(id)information withFirstClientName:(id)name
{
  selectorCopy = selector;
  descriptorCopy = descriptor;
  informationCopy = information;
  nameCopy = name;
  v17 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v17 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v17 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    v22[0] = _NSConcreteStackBlock;
    v22[1] = 3221225472;
    v22[2] = __142__MADAutoAssetControlManager_persistForJobSelector_persistingJobDescriptor_justDownloaded_justPatched_withJobInformation_withFirstClientName___block_invoke;
    v22[3] = &unk_4B48E8;
    downloadedCopy = downloaded;
    v23 = descriptorCopy;
    patchedCopy = patched;
    v24 = v17;
    v25 = nameCopy;
    v26 = selectorCopy;
    v27 = informationCopy;
    dispatch_sync(extendedStateQueue, v22);

    v21 = v23;
  }

  else
  {
    v21 = _MADLog(@"Auto");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{persistForJobSelector} Skipping operation since FSM is not initialized", buf, 2u);
    }
  }
}

void __142__MADAutoAssetControlManager_persistForJobSelector_persistingJobDescriptor_justDownloaded_justPatched_withJobInformation_withFirstClientName___block_invoke(uint64_t a1)
{
  if (*(a1 + 72) == 1)
  {
    v2 = [*(a1 + 32) assetType];
    v3 = [*(a1 + 32) assetId];
    v4 = getAutoLocalUrlFromTypeAndIdWithPurpose(v2, v3, 2, @"auto");
    v5 = [v4 path];

    if (*(a1 + 73) == 1)
    {
      [*(a1 + 32) setIsPatch:1];
    }

    [*(a1 + 40) _statsIncrementDownloadedForDescriptor:*(a1 + 32)];
    if (v5)
    {
      v6 = [[NSURL alloc] initFileURLWithPath:v5];
      v7 = [v6 URLByDeletingLastPathComponent];
      updateClientUsageDate(v7);
    }

    else
    {
      v6 = [*(a1 + 40) autoControlManagerFSM];
      v7 = [v6 diag];
      v8 = [NSString alloc];
      v9 = [*(a1 + 32) summary];
      v10 = [v8 initWithFormat:@"{persistForJobSelector} unable to determine local repository path for jobDescriptor:%@", v9];
      [v7 trackAnomaly:@"AUTO-CONTROL" forReason:v10 withResult:6101 withError:0];
    }

    v11 = *(a1 + 48);
    v12 = [*(a1 + 32) assetId];
    v13 = *(a1 + 56);
    if (v11)
    {
      [MADAutoAssetHistory recordOperation:100 toHistoryType:0 fromClient:v11 forAssetID:v12 withSelector:v13];
    }

    else
    {
      [MADAutoAssetHistory recordOperation:201 toHistoryType:0 fromLayer:1 forAssetID:v12 withSelector:v13];
    }

    [*(a1 + 40) _removeUnlockedForOlderSelectorsWithoutVersion:*(a1 + 32)];
  }

  LOBYTE(v21) = 0;
  [*(a1 + 40) trackDescriptor:*(a1 + 32) persisting:1 fromLocation:@"persistForJobSelector" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:*(a1 + 48) isPromoted:v21];
  v14 = *(a1 + 64);
  if (v14)
  {
    v22 = [*(a1 + 40) _autoAssetJobProgressNewValidatedCurrentStatus:v14 requiringProgress:0];
    v15 = [MAAutoAssetSelector alloc];
    v16 = [*(a1 + 32) assetType];
    v17 = [*(a1 + 32) assetSpecifier];
    v18 = [*(a1 + 32) assetVersion];
    v19 = [v15 initForAssetType:v16 withAssetSpecifier:v17 matchingAssetVersion:v18];

    if ([*(a1 + 32) foundByLookupWithoutAssetVersion])
    {
      v20 = 0;
    }

    else
    {
      v20 = [v19 assetVersion];
    }

    [*(a1 + 40) updateAutoAssetStatus:v19 forActiveJobUUID:0 withLatestJobStatus:v22 matchingAssetVersion:v20 fromLocation:@"persistForJobSelector"];
  }
}

+ (BOOL)persistSetJobDescriptor:(id)descriptor withCurrentSetStatus:(id)status withFirstClientName:(id)name fromLocation:(id)location
{
  descriptorCopy = descriptor;
  statusCopy = status;
  nameCopy = name;
  locationCopy = location;
  v13 = +[MADAutoAssetControlManager autoControlManager];
  locationCopy = [[NSString alloc] initWithFormat:@"%@:persistSetJobDescriptor", locationCopy];
  v29 = 0;
  v30 = &v29;
  v31 = 0x2020000000;
  v32 = 0;
  autoControlManagerFSM = [v13 autoControlManagerFSM];
  v16 = autoControlManagerFSM == 0;

  if (v16)
  {
    v20 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543362;
      v34 = locationCopy;
      _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "AUTO-SET-CONTROL:{%{public}@} Skipping operation since FSM is not initialized", buf, 0xCu);
    }

    v19 = *(v30 + 24);
  }

  else
  {
    autoControlManagerFSM2 = [v13 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __108__MADAutoAssetControlManager_persistSetJobDescriptor_withCurrentSetStatus_withFirstClientName_fromLocation___block_invoke;
    block[3] = &unk_4B3F60;
    v23 = v13;
    v24 = locationCopy;
    v25 = statusCopy;
    v26 = descriptorCopy;
    v28 = &v29;
    v27 = nameCopy;
    dispatch_sync(extendedStateQueue, block);

    v19 = *(v30 + 24);
  }

  _Block_object_dispose(&v29, 8);

  return v19 & 1;
}

void __108__MADAutoAssetControlManager_persistSetJobDescriptor_withCurrentSetStatus_withFirstClientName_fromLocation___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = *(a1 + 40);
  v4 = [*(a1 + 48) assetSetIdentifier];
  [v2 _updateCurrentSetStatus:v3 forSetIdentifier:v4 withSetStatus:*(a1 + 48)];

  v5 = *(a1 + 32);
  v6 = [v5 atomicInstanceForSetDescriptor:*(a1 + 56)];
  LOBYTE(v5) = [v5 isAtomicInstancePartOfPSUS:v6];

  v7 = *(a1 + 56);
  v8 = *(a1 + 32);
  v9 = *(a1 + 40);
  v10 = [v7 isDiscoveredFullyDownloaded];
  v11 = [*(a1 + 56) discoveredAtomicInstance];
  v12 = *(a1 + 48);
  v13 = [*(a1 + 56) isDiscoveredFullyDownloaded];
  LOBYTE(v38) = v5;
  BYTE2(v36) = [*(a1 + 56) isDiscoveredFullyDownloaded];
  BYTE1(v36) = v13;
  LOBYTE(v36) = 0;
  *(*(*(a1 + 72) + 8) + 24) = [v8 trackSetDescriptor:v7 fromLocation:v9 forLatestDownloaded:v10 forSpecificAtomicInstance:v11 withCurrentSetStatus:v12 changedWhileTerminated:0 changedNeverBeenLocked:v36 notifyingIfJustDownloaded:0 latestToVend:*(a1 + 64) historyOperation:v38 firstClientName:? fromPreSUStaging:?];

  v14 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
  {
    v15 = *(a1 + 40);
    if (*(*(*(a1 + 72) + 8) + 24))
    {
      v16 = @"Y";
    }

    else
    {
      v16 = @"N";
    }

    v17 = [*(a1 + 56) summary];
    *buf = 138543874;
    v48 = v15;
    v49 = 2114;
    v50 = v16;
    v51 = 2114;
    v52 = v17;
    _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[SET-DESCRIPTOR][VEND] update to set-descriptor provided by set-job | justBecameLatestToVend:%{public}@ | setJobDescriptor:%{public}@", buf, 0x20u);
  }

  if ([*(a1 + 56) isDiscoveredFullyDownloaded])
  {
    v44 = 0u;
    v45 = 0u;
    v42 = 0u;
    v43 = 0u;
    v40 = a1;
    v18 = [*(a1 + 56) latestDowloadedAtomicInstanceEntries];
    v41 = [v18 countByEnumeratingWithState:&v42 objects:v46 count:16];
    if (v41)
    {
      v19 = *v43;
      v39 = *v43;
      do
      {
        for (i = 0; i != v41; i = i + 1)
        {
          if (*v43 != v19)
          {
            objc_enumerationMutation(v18);
          }

          v21 = *(*(&v42 + 1) + 8 * i);
          v22 = objc_autoreleasePoolPush();
          v23 = [v21 assetID];

          if (v23)
          {
            v24 = [v21 fullAssetSelector];
            v25 = [v24 assetType];
            v26 = [v21 assetID];
            v27 = getAutoLocalUrlFromTypeAndIdWithPurpose(v25, v26, 2, @"auto");
            v28 = [v27 path];

            if (v28)
            {
              v29 = [[NSURL alloc] initFileURLWithPath:v28];
              v30 = [v29 URLByDeletingLastPathComponent];
              updateClientUsageDate(v30);
            }

            else
            {
              v31 = v18;
              v29 = [*(v40 + 32) autoControlManagerFSM];
              v30 = [v29 diag];
              v32 = [NSString alloc];
              v33 = *(v40 + 40);
              v34 = [v21 summary];
              v37 = v33;
              v18 = v31;
              v19 = v39;
              v35 = [v32 initWithFormat:@"{%@} unable to determine local repository path for nextDownloadedAtomicEntry:%@", v37, v34];
              [v30 trackAnomaly:@"AUTO-CONTROL" forReason:v35 withResult:6101 withError:0];
            }
          }

          objc_autoreleasePoolPop(v22);
        }

        v41 = [v18 countByEnumeratingWithState:&v42 objects:v46 count:16];
      }

      while (v41);
    }
  }
}

+ (id)loadDescriptorsForJobSelector:(id)selector promotingIfCurrentlyStaged:(id)staged immediatelyPromotedDescriptor:(id *)descriptor
{
  selectorCopy = selector;
  stagedCopy = staged;
  v9 = +[MADAutoAssetControlManager autoControlManager];
  v29 = 0;
  v30 = &v29;
  v31 = 0x3032000000;
  v32 = __Block_byref_object_copy__12;
  v33 = __Block_byref_object_dispose__12;
  v34 = 0;
  v23 = 0;
  v24 = &v23;
  v25 = 0x3032000000;
  v26 = __Block_byref_object_copy__12;
  v27 = __Block_byref_object_dispose__12;
  v28 = 0;
  autoControlManagerFSM = [v9 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v9 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __117__MADAutoAssetControlManager_loadDescriptorsForJobSelector_promotingIfCurrentlyStaged_immediatelyPromotedDescriptor___block_invoke;
    block[3] = &unk_4B4910;
    v17 = stagedCopy;
    v18 = v9;
    v20 = &v23;
    v19 = selectorCopy;
    v21 = &v29;
    dispatch_sync(extendedStateQueue, block);

    if (descriptor)
    {
      *descriptor = v24[5];
    }

    v13 = v30[5];
  }

  else
  {
    v14 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{loadDescriptorsForJobSelector} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v13 = v30[5];
  }

  _Block_object_dispose(&v23, 8);

  _Block_object_dispose(&v29, 8);

  return v13;
}

void __117__MADAutoAssetControlManager_loadDescriptorsForJobSelector_promotingIfCurrentlyStaged_immediatelyPromotedDescriptor___block_invoke(uint64_t a1)
{
  if (*(a1 + 32))
  {
    [*(a1 + 40) ensureStagerFullyResumed];
    v2 = [MADAutoAssetStager controlConvertStagedToDownloaded:*(a1 + 32)];
    v3 = *(*(a1 + 56) + 8);
    v4 = *(v3 + 40);
    *(v3 + 40) = v2;

    v5 = *(*(*(a1 + 56) + 8) + 40);
    if (v5)
    {
      [*(a1 + 40) _promotePreviouslyStagedNowDownloaded:v5 forHistoryOperation:204];
    }
  }

  v6 = objc_alloc_init(NSMutableDictionary);
  v7 = [*(a1 + 40) locateDownloadedNewForSelector:@"loadDescriptorsForJobSelector" assetSelector:*(a1 + 48) limitedToStaging:0];
  [*(a1 + 40) trackPerformanceIteration:@"loadDescriptorsForJobSelector" ofContainer:@"locateDownloadedNewForSelector"];
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v8 = v7;
  v9 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v18;
    do
    {
      v12 = 0;
      do
      {
        if (*v18 != v11)
        {
          objc_enumerationMutation(v8);
        }

        v13 = *(*(&v17 + 1) + 8 * v12);
        v14 = objc_autoreleasePoolPush();
        v15 = [v8 safeObjectForKey:v13 ofClass:{objc_opt_class(), v17}];
        v16 = [v15 assetVersion];
        [v6 setSafeObject:v15 forKey:v16];

        objc_autoreleasePoolPop(v14);
        v12 = v12 + 1;
      }

      while (v10 != v12);
      v10 = [v8 countByEnumeratingWithState:&v17 objects:v21 count:16];
    }

    while (v10);
  }

  if ([v6 count])
  {
    objc_storeStrong((*(*(a1 + 64) + 8) + 40), v6);
  }
}

- (void)removeActiveJobForFullSelector:(id)selector removingFullSelector:(id)fullSelector alsoRemovingNoVersionSelector:(id)versionSelector
{
  selectorCopy = selector;
  fullSelectorCopy = fullSelector;
  versionSelectorCopy = versionSelector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  selectorCopy = [[NSString alloc] initWithFormat:@"%@:removeActiveJobForFullSelector", selectorCopy];
  if (fullSelectorCopy)
  {
    persistedEntryID = [fullSelectorCopy persistedEntryID];
    v14 = [(MADAutoAssetControlManager *)self jobSelectorKey:fullSelectorCopy];
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v16 = [persistedActiveJobs persistedEntryAlreadyExists:persistedEntryID fromLocation:selectorCopy];

    if (!v16)
    {
LABEL_9:
      currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
      [currentJobsBySelector removeObjectForKey:v14];

      goto LABEL_10;
    }

    persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v18 = [persistedActiveJobs2 persistedEntry:persistedEntryID fromLocation:selectorCopy];

    if (v18)
    {
      persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      autoControlManagerFSM2 = [persistedActiveJobs3 decodeFromLocation:selectorCopy ofEntryName:persistedEntryID fromPersistedEntry:v18 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!autoControlManagerFSM2)
      {
LABEL_8:

        goto LABEL_9;
      }

      v43 = v18;
      persistedActiveJobs4 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      [persistedActiveJobs4 removePersistedEntry:persistedEntryID fromLocation:selectorCopy];

      v22 = [NSString alloc];
      summary = [fullSelectorCopy summary];
      summary2 = [v22 initWithFormat:@"removed descriptor for fullSelector:%@ from previously active jobs", summary];
      [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:selectorCopy forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:persistedEntryID removedDescriptor:autoControlManagerFSM2 message:summary2];
    }

    else
    {
      v43 = 0;
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      summary = [autoControlManagerFSM2 diag];
      v25 = [NSString alloc];
      summary2 = [fullSelectorCopy summary];
      v26 = [v25 initWithFormat:@"{%@} | no persistedEntryID for fullSelector:%@", selectorCopy, summary2];
      [summary trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6110 withError:0];
    }

    v18 = v43;
    goto LABEL_8;
  }

LABEL_10:
  if (!versionSelectorCopy)
  {
    goto LABEL_19;
  }

  persistedEntryID2 = [versionSelectorCopy persistedEntryID];
  v29 = [(MADAutoAssetControlManager *)self jobSelectorKey:versionSelectorCopy];
  persistedActiveJobs5 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  v31 = [persistedActiveJobs5 persistedEntryAlreadyExists:persistedEntryID2 fromLocation:selectorCopy];

  if (v31)
  {
    persistedActiveJobs6 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v33 = [persistedActiveJobs6 persistedEntry:persistedEntryID2 fromLocation:selectorCopy];

    if (v33)
    {
      persistedActiveJobs7 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      autoControlManagerFSM3 = [persistedActiveJobs7 decodeFromLocation:selectorCopy ofEntryName:persistedEntryID2 fromPersistedEntry:v33 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (!autoControlManagerFSM3)
      {
LABEL_17:

        goto LABEL_18;
      }

      v44 = v33;
      persistedActiveJobs8 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      [persistedActiveJobs8 removePersistedEntry:persistedEntryID2 fromLocation:selectorCopy];

      v37 = [NSString alloc];
      summary3 = [versionSelectorCopy summary];
      summary4 = [v37 initWithFormat:@"removed descriptor for noVersionSelector:%@ from previously active jobs", summary3];
      [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:selectorCopy forComponentType:@"ACTIVE-JOBS" removedPersistedEntryID:persistedEntryID2 removedDescriptor:autoControlManagerFSM3 message:summary4];
    }

    else
    {
      v44 = 0;
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      summary3 = [autoControlManagerFSM3 diag];
      v40 = [NSString alloc];
      summary4 = [versionSelectorCopy summary];
      v41 = [v40 initWithFormat:@"{%@} | no persistedEntryID for noVersionSelector:%@", selectorCopy, summary4];
      [summary3 trackAnomaly:@"AUTO-CONTROL" forReason:v41 withResult:6110 withError:0];
    }

    v33 = v44;
    goto LABEL_17;
  }

LABEL_18:
  currentJobsBySelector2 = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  [currentJobsBySelector2 removeObjectForKey:v29];

LABEL_19:
}

- (id)persistedKnownDescriptorForSetAtomicEntry:(id)entry
{
  fullAssetSelector = [entry fullAssetSelector];
  if (fullAssetSelector)
  {
    v5 = [(MADAutoAssetControlManager *)self _persistedKnownDescriptorForFullAssetSelector:fullAssetSelector];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (id)_persistedKnownDescriptorForFullAssetSelector:(id)selector
{
  persistedEntryID = [selector persistedEntryID];
  if (persistedEntryID)
  {
    v5 = [(MADAutoAssetControlManager *)self _persistedKnownDescriptorForPersistedEntryID:persistedEntryID];
  }

  else
  {
    v5 = 0;
  }

  return v5;
}

- (id)_persistedKnownDescriptorForPersistedEntryID:(id)d
{
  dCopy = d;
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v6 = [persistedKnownDescriptors persistedEntry:dCopy fromLocation:@"persistedKnownDescriptorForSelector"];

  if (v6)
  {
    persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v8 = [persistedKnownDescriptors2 decodeFromLocation:@"persistedKnownDescriptorForSelector" ofEntryName:dCopy fromPersistedEntry:v6 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    if (v8)
    {
      v9 = v8;
    }
  }

  else
  {
    v8 = 0;
  }

  return v8;
}

+ (id)newestDownloadedForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  autoControlManagerFSM = [v4 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v4 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __63__MADAutoAssetControlManager_newestDownloadedForSetDescriptor___block_invoke;
    block[3] = &unk_4B4478;
    v12 = v4;
    v13 = descriptorCopy;
    v14 = &v16;
    dispatch_sync(extendedStateQueue, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{newestDownloadedForSetDescriptor} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

void __63__MADAutoAssetControlManager_newestDownloadedForSetDescriptor___block_invoke(uint64_t a1)
{
  v2 = *(a1 + 32);
  v3 = [*(a1 + 40) clientDomainName];
  v4 = [*(a1 + 40) assetSetIdentifier];
  v5 = [v2 locateSetConfigurationByClientDomain:v3 forAssetSetIdentifier:v4];

  if (v5)
  {
    v6 = [v5 latestAtomicInstanceToVend];

    v7 = *(a1 + 32);
    if (v6)
    {
      v8 = [v5 latestAtomicInstanceToVend];
      v9 = [v7 locateSetStatusByInstance:v8];
      v10 = *(*(a1 + 48) + 8);
      v11 = *(v10 + 40);
      *(v10 + 40) = v9;

      goto LABEL_21;
    }

    [v7 trackPerformanceIteration:@"newestDownloadedForSetDescriptor" ofContainer:@"currentSetStatusByInstance"];
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    obj = [*(a1 + 32) currentSetStatusByInstance];
    v29 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    if (!v29)
    {
      goto LABEL_20;
    }

    v12 = *v32;
LABEL_6:
    v13 = 0;
    while (1)
    {
      if (*v32 != v12)
      {
        objc_enumerationMutation(obj);
      }

      v14 = *(*(&v31 + 1) + 8 * v13);
      context = objc_autoreleasePoolPush();
      v15 = [*(a1 + 32) currentSetStatusByInstance];
      v16 = [v15 safeObjectForKey:v14 ofClass:objc_opt_class()];

      v17 = [v16 clientDomainName];
      v18 = [*(a1 + 40) clientDomainName];
      if (([SUCore stringIsEqual:v17 to:v18]& 1) == 0)
      {
        break;
      }

      [v16 assetSetIdentifier];
      v20 = v19 = v12;
      v21 = [*(a1 + 40) assetSetIdentifier];
      v22 = [SUCore stringIsEqual:v20 to:v21];

      v12 = v19;
      if (v22)
      {
        v23 = *(*(a1 + 48) + 8);
        v24 = *(v23 + 40);
        if (v24)
        {
          v25 = [v24 latestDownloadedAtomicInstance];

          if (v25)
          {
            goto LABEL_18;
          }

          v26 = [v16 latestDownloadedAtomicInstance];

          if (!v26)
          {
            goto LABEL_18;
          }

          v23 = *(*(a1 + 48) + 8);
        }

        v27 = v16;
        v17 = *(v23 + 40);
        *(v23 + 40) = v27;
        goto LABEL_17;
      }

LABEL_18:

      objc_autoreleasePoolPop(context);
      if (v29 == ++v13)
      {
        v29 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
        if (!v29)
        {
LABEL_20:

          goto LABEL_21;
        }

        goto LABEL_6;
      }
    }

LABEL_17:
    goto LABEL_18;
  }

LABEL_21:
}

+ (id)newAtomicInstancesDownloadedForSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  autoControlManagerFSM = [v4 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v4 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __75__MADAutoAssetControlManager_newAtomicInstancesDownloadedForSetIdentifier___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = identifierCopy;
    dispatch_sync(extendedStateQueue, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{newAtomicInstancesDownloadedForSetIdentifier} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

uint64_t __75__MADAutoAssetControlManager_newAtomicInstancesDownloadedForSetIdentifier___block_invoke(uint64_t a1)
{
  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) _newAtomicInstancesDownloadedForSetIdentifier:*(a1 + 40)];

  return _objc_release_x1();
}

+ (id)localAssetURLForDescriptor:(id)descriptor fromLocation:(id)location
{
  descriptorCopy = descriptor;
  locationCopy = location;
  if ([descriptorCopy isMAAutoAsset] && (objc_msgSend(descriptorCopy, "assetType"), (v7 = objc_claimAutoreleasedReturnValue()) != 0) && (v8 = v7, objc_msgSend(descriptorCopy, "assetId"), v9 = objc_claimAutoreleasedReturnValue(), v9, v8, v9))
  {
    assetType = [descriptorCopy assetType];
    assetId = [descriptorCopy assetId];
    v12 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType, assetId, 2, @"auto");
    path = [v12 path];

    autoControlManagerFSM = [[NSString alloc] initWithFormat:@"/%@", @"AssetData"];
    v15 = [autoControlManagerFSM length];
    v16 = [path length];
    v17 = 0;
    if ([path hasSuffix:autoControlManagerFSM] && v16 > v15)
    {
      v17 = [path substringWithRange:{0, v16 - v15}];
    }
  }

  else
  {
    path = +[MADAutoAssetControlManager autoControlManager];
    autoControlManagerFSM = [path autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v19 = [NSString alloc];
    summary = [descriptorCopy summary];
    v21 = [v19 initWithFormat:@"{%@} unable to construct local URL from descriptor:%@", locationCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v21 withResult:6111 withError:0];

    v17 = 0;
  }

  return v17;
}

+ (id)localAssetURLForAtomicEntry:(id)entry
{
  entryCopy = entry;
  fullAssetSelector = [entryCopy fullAssetSelector];
  assetType = [fullAssetSelector assetType];
  if (!assetType)
  {

    goto LABEL_7;
  }

  v6 = assetType;
  assetID = [entryCopy assetID];

  if (!assetID)
  {
LABEL_7:
    path = +[MADAutoAssetControlManager autoControlManager];
    autoControlManagerFSM = [path autoControlManagerFSM];
    diag = [autoControlManagerFSM diag];
    v18 = [NSString alloc];
    summary = [entryCopy summary];
    v20 = [v18 initWithFormat:@"unable to construct local URL from atomicEntry:%@", summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v20 withResult:6111 withError:0];

    v16 = 0;
    goto LABEL_8;
  }

  fullAssetSelector2 = [entryCopy fullAssetSelector];
  assetType2 = [fullAssetSelector2 assetType];
  assetID2 = [entryCopy assetID];
  v11 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType2, assetID2, 2, @"auto");
  path = [v11 path];

  autoControlManagerFSM = [[NSString alloc] initWithFormat:@"/%@", @"AssetData"];
  v14 = [autoControlManagerFSM length];
  v15 = [path length];
  v16 = 0;
  if ([path hasSuffix:autoControlManagerFSM] && v15 > v14)
  {
    v16 = [path substringWithRange:{0, v15 - v14}];
  }

LABEL_8:

  return v16;
}

+ (id)restoreVersionFromOSVersion:(id)version
{
  versionCopy = version;
  v4 = [versionCopy componentsSeparatedByString:@"."];
  v5 = [v4 count];
  if (v5 <= 0)
  {
    versionCopy = [[NSString alloc] initWithFormat:@"%@.0.0.0.0, 0", versionCopy];
    if (!versionCopy)
    {
LABEL_13:
      v14 = 0;
      goto LABEL_18;
    }
  }

  else
  {
    v6 = v5;
    if (v5 > 4)
    {
      v15 = _MADLog(@"Auto");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543362;
        v18 = versionCopy;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "AUTO-CONTROL:{restoreVersionFromOSVersion} too many elements | osVersion:%{public}@", buf, 0xCu);
      }

      versionCopy = @"0.0.0.0.0,0";
    }

    else
    {
      v7 = [NSMutableString alloc];
      v8 = [v4 objectAtIndexedSubscript:0];
      v9 = [v7 initWithString:v8];

      if (v6 != &dword_0 + 1)
      {
        for (i = 1; i != v6; ++i)
        {
          v11 = [v4 objectAtIndexedSubscript:i];
          [v9 appendFormat:@".%@", v11];
        }
      }

      if (v6 != 4 && v6 != &dword_4 + 1)
      {
        v12 = 5 - v6;
      }

      else
      {
        v12 = 1;
      }

      do
      {
        [v9 appendString:@".0"];
        --v12;
      }

      while (v12);
      versionCopy = [[NSString alloc] initWithFormat:@"%@, 0", v9];

      if (!versionCopy)
      {
        goto LABEL_13;
      }
    }
  }

  v14 = [[SUCoreRestoreVersion alloc] initWithRestoreVersion:versionCopy];
LABEL_18:

  return v14;
}

- (unsigned)isLocalContentValidForSetAtomicEntry:(id)entry fromLocation:(id)location
{
  entryCopy = entry;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:isLocalContentValidForSetAtomicEntry", locationCopy];
  if (entryCopy && ([entryCopy localContentURL], (v11 = objc_claimAutoreleasedReturnValue()) != 0) && (v12 = v11, objc_msgSend(entryCopy, "localContentURL"), v13 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v13, "URLByDeletingLastPathComponent"), v14 = objc_claimAutoreleasedReturnValue(), v14, v13, v12, v14))
  {
    localContentURL = [entryCopy localContentURL];
    uRLByDeletingLastPathComponent = [localContentURL URLByDeletingLastPathComponent];
    v17 = [uRLByDeletingLastPathComponent URLByAppendingPathComponent:@"Info.plist"];
    path = [v17 path];

    v19 = [(MADAutoAssetControlManager *)self filesystemDoesFileExist:locationCopy atPath:path];
  }

  else
  {
    v19 = 0;
  }

  return v19;
}

- (id)getCorruptedEntryInfo:(id)info
{
  infoCopy = info;
  v4 = infoCopy;
  if (!infoCopy || ([infoCopy localContentURL], (v5 = objc_claimAutoreleasedReturnValue()) == 0) || (v6 = v5, objc_msgSend(v4, "localContentURL"), v7 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v7, "URLByDeletingLastPathComponent"), v8 = objc_claimAutoreleasedReturnValue(), v8, v7, v6, !v8) || (objc_msgSend(v4, "localContentURL"), v9 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v9, "URLByDeletingLastPathComponent"), v10 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v10, "path"), v11 = objc_claimAutoreleasedReturnValue(), v10, v9, !v11))
  {
    fullAssetSelector = [v4 fullAssetSelector];
    summary = [fullAssetSelector summary];

    if (summary)
    {
      v11 = summary;
    }

    else
    {
      v11 = @" ";
    }
  }

  return v11;
}

- (void)trackDescriptor:(id)descriptor persisting:(BOOL)persisting fromLocation:(id)location changedWhileTerminated:(BOOL)terminated changedNeverBeenLocked:(BOOL)locked historyOperation:(int64_t)operation firstClientName:(id)name isPromoted:(BOOL)self0
{
  lockedCopy = locked;
  terminatedCopy = terminated;
  persistingCopy = persisting;
  descriptorCopy = descriptor;
  locationCopy = location;
  nameCopy = name;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (descriptorCopy && ![descriptorCopy isBlankEntry])
  {
    v89 = nameCopy;
    v90 = locationCopy;
    v25 = [MAAutoAssetSelector alloc];
    assetType = [descriptorCopy assetType];
    assetSpecifier = [descriptorCopy assetSpecifier];
    assetVersion = [descriptorCopy assetVersion];
    v29 = [v25 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

    if (![descriptorCopy isOnFilesystem])
    {
      v31 = 0;
      v86 = 0;
      v37 = 1;
      v38 = @"job has just updated status";
      v32 = v29;
      nameCopy = v89;
      locationCopy = v90;
      goto LABEL_40;
    }

    v30 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:v29];
    v31 = v30;
    v32 = v29;
    if (persistingCopy)
    {
      v85 = v29;
      v33 = v30;
      v34 = [NSString alloc];
      if (terminatedCopy)
      {
        v35 = @"previously in-flight";
      }

      else
      {
        v35 = @"just";
      }

      nameCopy = v89;
      locationCopy = v90;
      if (lockedCopy)
      {
        v36 = @"first-locked";
      }

      else if ([descriptorCopy foundAsPreInstalled])
      {
        v36 = @"migrated-preinstalled";
      }

      else
      {
        isPatch = [descriptorCopy isPatch];
        v36 = @"downloaded(full)";
        if (isPatch)
        {
          v36 = @"patched";
        }
      }

      v87 = [v34 initWithFormat:@"%@ %@ auto-asset-descriptor status update", v35, v36];
      v40 = _MADLog(@"AutoControl");
      v31 = v33;
      v32 = v85;
      if (os_log_type_enabled(v40, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        if (v31)
        {
          summary = [v31 summary];
        }

        else
        {
          summary = @"N";
        }

        summary2 = [descriptorCopy summary];
        *buf = 138544386;
        v93 = _updateLatestSummary;
        v94 = 2114;
        v95 = v90;
        v96 = 2114;
        v97 = v87;
        v98 = 2114;
        v99 = summary;
        v100 = 2114;
        v101 = summary2;
        _os_log_impl(&dword_0, v40, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:trackDescriptor} %{public}@ | previousDescriptor:%{public}@ | recentDescriptor:%{public}@", buf, 0x34u);
        if (v31)
        {
        }

        v32 = v85;
        locationCopy = v90;
      }

      v86 = @"DOWNLOADED_DESCRIPTORS";
      v38 = v87;
      if (!operation)
      {
LABEL_30:
        if (v31)
        {
          if ([v31 isOnFilesystem] & 1) != 0 || (objc_msgSend(descriptorCopy, "isOnFilesystem"))
          {
            v44 = 0;
          }

          else
          {
            v44 = [(MADAutoAssetControlManager *)self _updateTrackedDescriptor:v31 fromLatestDescriptor:descriptorCopy];
          }

          v37 = 0;
          if ((v44 & 1) == 0 && !persistingCopy)
          {
            persistedEntryID = _MADLog(@"AutoControl");
            if (os_log_type_enabled(persistedEntryID, OS_LOG_TYPE_DEBUG))
            {
              [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v46 = v32;
              v48 = v47 = v31;
              summary3 = [v46 summary];
              *buf = 138543874;
              v93 = v48;
              v94 = 2114;
              v95 = locationCopy;
              v96 = 2114;
              v97 = summary3;
              _os_log_impl(&dword_0, persistedEntryID, OS_LOG_TYPE_DEBUG, "[%{public}@] {%{public}@:trackDescriptor} update to descriptor not performed (nothing changed) | selector:%{public}@", buf, 0x20u);

              v31 = v47;
              v32 = v46;
            }

LABEL_78:

            goto LABEL_79;
          }
        }

        else
        {
          v37 = 1;
        }

LABEL_40:
        if (!persistingCopy)
        {
LABEL_79:

          goto LABEL_80;
        }

        persistedEntryID = [v32 persistedEntryID];
        v88 = v31;
        if (([descriptorCopy isOnFilesystem] & 1) == 0 && !objc_msgSend(v31, "isOnFilesystem"))
        {
          v53 = 0;
LABEL_64:
          if ([descriptorCopy isOnFilesystem])
          {
            v65 = v53;
          }

          else
          {
            persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v67 = [persistedActiveJobs persistedEntryAlreadyExists:persistedEntryID fromLocation:locationCopy];

            persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
            v65 = [persistedActiveJobs2 persistedEntry:persistedEntryID fromLocation:locationCopy];

            if (v65)
            {
              if (v67)
              {
                v69 = @"ENTRY_MODIFY";
              }

              else
              {
                v69 = @"ENTRY_ADD";
              }

              [v65 persistSecureCodedObject:descriptorCopy forKey:@"assetDescriptor"];
              persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
              [descriptorCopy summary];
              v72 = v71 = v32;
              [persistedActiveJobs3 storePersistedEntry:persistedEntryID withEntrySummary:v72 fromLocation:v90];

              v32 = v71;
              locationCopy = v90;

              [(MADAutoAssetControlManager *)self _logPersistedEntry:v90 forComponentType:@"JOB_DESCRIPTORS" operation:v69 forPersistedEntryID:persistedEntryID forClientRequest:0 withJobUUID:0 withAssetDescriptor:descriptorCopy baseForPatchDescriptor:0 message:v38];
            }

            else
            {
              v73 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v73, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                [v32 summary];
                v76 = v75 = v32;
                *buf = 138543874;
                v93 = _updateLatestSummary2;
                v94 = 2114;
                v95 = v90;
                v96 = 2114;
                v97 = v76;
                _os_log_impl(&dword_0, v73, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:trackDescriptor} unable to load active-job persisted-descriptor file | selector:%{public}@", buf, 0x20u);

                v32 = v75;
              }

              if (promoted)
              {
                analyticsManager = [(MADAutoAssetControlManager *)self analyticsManager];
                assetSpecifier2 = [v32 assetSpecifier];
                [v32 assetType];
                v80 = v79 = v32;
                assetVersion2 = [v79 assetVersion];
                v82 = [analyticsManager recordMobileAssetPromotionAttempt:assetSpecifier2 assetType:v80 assetVersion:assetVersion2 osPromotion:1 successfullyPromoted:0 withReason:5];

                v32 = v79;
              }

              locationCopy = v90;
            }

            v31 = v88;
          }

          nameCopy = v89;
          goto LABEL_78;
        }

        v50 = v32;
        v51 = v38;
        persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v53 = [persistedKnownDescriptors persistedEntry:persistedEntryID fromLocation:locationCopy];

        if (!v53)
        {
          v55 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            summary4 = [v50 summary];
            *buf = 138543874;
            v93 = _updateLatestSummary3;
            v94 = 2114;
            v95 = locationCopy;
            v96 = 2114;
            v97 = summary4;
            _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:trackDescriptor} unable to load persisted-descriptor file | selector:%{public}@", buf, 0x20u);
          }

          v53 = 0;
          goto LABEL_62;
        }

        v31 = v88;
        v54 = v88;
        if (v37)
        {
          v55 = descriptorCopy;
          v56 = @"ENTRY_ADD";
        }

        else
        {
          v55 = v54;
          if (([v54 isOnFilesystem]& 1) == 0)
          {
            v59 = descriptorCopy;

            v84 = @"ENTRY_MODIFY";
            v55 = v59;
            v31 = v88;
            goto LABEL_54;
          }

          v56 = @"ENTRY_MODIFY";
        }

        v84 = v56;
LABEL_54:
        if ([descriptorCopy isOnFilesystem])
        {
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v61 = [persistedKnownDescriptors2 decodeFromLocation:locationCopy ofEntryName:persistedEntryID fromPersistedEntry:v53 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:1];

          if (v61)
          {
            [v61 setNeverBeenLocked:{-[NSObject neverBeenLocked](v55, "neverBeenLocked")}];
            [v61 setIsOnFilesystem:{-[NSObject isOnFilesystem](v55, "isOnFilesystem")}];
            v62 = v61;

            v55 = v62;
          }

          v31 = v88;
        }

        if (![v55 isOnFilesystem])
        {
          goto LABEL_63;
        }

        if (lockedCopy)
        {
          [v55 setNeverBeenLocked:0];
        }

        [v53 persistSecureCodedObject:v55 forKey:@"assetDescriptor"];
        persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        summary5 = [v55 summary];
        [persistedKnownDescriptors3 storePersistedEntry:persistedEntryID withEntrySummary:summary5 fromLocation:locationCopy];

        [(MADAutoAssetControlManager *)self _logPersistedEntry:locationCopy forComponentType:v86 operation:v84 forPersistedEntryID:persistedEntryID forClientRequest:0 withJobUUID:0 withAssetDescriptor:v55 baseForPatchDescriptor:0 message:v51];
LABEL_62:
        v31 = v88;
LABEL_63:

        v38 = v51;
        v32 = v50;
        goto LABEL_64;
      }
    }

    else
    {
      v86 = 0;
      v38 = @"job has just updated status";
      nameCopy = v89;
      locationCopy = v90;
      if (!operation)
      {
        goto LABEL_30;
      }
    }

    assetId = [descriptorCopy assetId];
    if (nameCopy)
    {
      [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromClient:nameCopy forAssetID:assetId withSelector:v32];
    }

    else
    {
      [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromLayer:1 forAssetID:assetId withSelector:v32];
    }

    locationCopy = v90;
    goto LABEL_30;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  v22 = [NSString alloc];
  summary6 = [descriptorCopy summary];
  v24 = [v22 initWithFormat:@"{trackDescriptor} nil or blank-entry jobDescriptor:%@", summary6];
  [diag trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6103 withError:0];

LABEL_80:
}

- (BOOL)trackSetDescriptor:(id)descriptor fromLocation:(id)location forLatestDownloaded:(BOOL)downloaded forSpecificAtomicInstance:(id)instance withCurrentSetStatus:(id)status changedWhileTerminated:(BOOL)terminated changedNeverBeenLocked:(BOOL)locked notifyingIfJustDownloaded:(BOOL)self0 latestToVend:(BOOL)self1 historyOperation:(int64_t)self2 firstClientName:(id)self3 fromPreSUStaging:(BOOL)self4
{
  descriptorCopy = descriptor;
  statusCopy = status;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:trackSetDescriptor", locationCopy];
  if (descriptorCopy)
  {
    vendCopy = vend;
    clientDomainName = [descriptorCopy clientDomainName];
    assetSetIdentifier = [descriptorCopy assetSetIdentifier];
    v26 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

    clientDomainName2 = [descriptorCopy clientDomainName];
    assetSetIdentifier2 = [descriptorCopy assetSetIdentifier];
    v29 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier2];

    discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];
    v134 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:discoveredAtomicInstance];

    latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
    v133 = [(MADAutoAssetControlManager *)self locateSetDescriptorActiveJobByAtomicInstanceUUID:latestDownloadedAtomicInstance];

    latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
    v33 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestDownloadedAtomicInstance2 requireExists:0];

    v132 = v33;
    if (v33)
    {
      v131 = v29;
      v34 = v26;
      clientDomainName3 = [descriptorCopy clientDomainName];
      assetSetIdentifier3 = [descriptorCopy assetSetIdentifier];
      v37 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3];

      [(MADAutoAssetControlManager *)self persistSetDescriptorDownloadedJob:descriptorCopy fromLocation:locationCopy];
      latestAtomicInstanceToVend = [v37 latestAtomicInstanceToVend];

      if (!latestAtomicInstanceToVend)
      {
        vendCopy = 1;
      }

      v39 = 0;
LABEL_6:
      v40 = 0;
      if (v39)
      {
        v26 = v34;
        v29 = v131;
      }

      else
      {
        v26 = v34;
        v29 = v131;
        if (vendCopy)
        {
          clientDomainName4 = [descriptorCopy clientDomainName];
          assetSetIdentifier4 = [descriptorCopy assetSetIdentifier];
          v43 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName4 forAssetSetIdentifier:assetSetIdentifier4];

          if (v43)
          {
            latestAtomicInstanceToVend2 = [v43 latestAtomicInstanceToVend];
            latestDownloadedAtomicInstance3 = [descriptorCopy latestDownloadedAtomicInstance];
            v46 = [SUCore stringIsEqual:latestAtomicInstanceToVend2 to:latestDownloadedAtomicInstance3];

            if (v46)
            {
LABEL_10:
              v40 = 0;
LABEL_24:

              goto LABEL_25;
            }

            if ([descriptorCopy isOnFilesystem] && (objc_msgSend(descriptorCopy, "onFilesystemIncomplete") & 1) == 0)
            {
              if ([(MADAutoAssetControlManager *)self _doesSetDescriptorRequirePersonalization:locationCopy forSetDescriptor:descriptorCopy])
              {
                autoControlManagerFSM2 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
                {
                  goto LABEL_22;
                }

                summary = [descriptorCopy summary];
                *buf = 138543618;
                v136 = locationCopy;
                v137 = 2114;
                v138 = summary;
                v90 = "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] not setting latestAtomicInstanceToVend (requiresPersonalization) | setJobDescriptor:%{public}@";
              }

              else
              {
                if (![(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:locationCopy forSetDescriptor:descriptorCopy])
                {
                  latestAtomicInstanceToVend3 = [v43 latestAtomicInstanceToVend];

                  if (![(MADAutoAssetControlManager *)self setConfigurationAdoptLatestToVend:locationCopy fromSetDescriptor:descriptorCopy toSetConfiguration:v43 fromPreSUStaging:staging allowEmpty:0])
                  {
                    goto LABEL_10;
                  }

                  autoControlManagerFSM2 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
                  {
                    v92 = v26;
                    if (latestAtomicInstanceToVend3)
                    {
                      v93 = @"replaced what had been";
                    }

                    else
                    {
                      v93 = @"now have";
                    }

                    summary2 = [v43 summary];
                    *buf = 138543874;
                    v136 = locationCopy;
                    v137 = 2114;
                    v138 = v93;
                    v26 = v92;
                    v139 = 2114;
                    v140 = summary2;
                    _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT, "{%{public}@}\n[LATEST-TO-VEND] %{public}@ latestAtomicInstanceToVend | setConfiguration:%{public}@", buf, 0x20u);
                  }

                  v40 = 1;
LABEL_23:

                  goto LABEL_24;
                }

                autoControlManagerFSM2 = _MADLog(@"AutoControl");
                if (!os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
                {
LABEL_22:
                  v40 = 0;
                  goto LABEL_23;
                }

                summary = [descriptorCopy summary];
                *buf = 138543618;
                v136 = locationCopy;
                v137 = 2114;
                v138 = summary;
                v90 = "{%{public}@}\n[POTENTIAL-LATEST-TO-VEND] not setting latestAtomicInstanceToVend (same as already latest-to-vend) | setJobDescriptor:%{public}@";
              }

              _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT, v90, buf, 0x16u);
LABEL_21:

              goto LABEL_22;
            }

            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            summary = [autoControlManagerFSM2 diag];
            v58 = [NSString alloc];
            summary3 = [descriptorCopy summary];
            v57 = [v58 initWithFormat:@"{%@} about to adopt as latest-to-vend yet not on filesystem | setJobDescriptor:%@", locationCopy, summary3];
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            summary = [autoControlManagerFSM2 diag];
            v55 = [NSString alloc];
            summary3 = [descriptorCopy summary];
            v57 = [v55 initWithFormat:@"{%@} no setConfiguration | setJobDescriptor:%@", locationCopy, summary3];
          }

          v59 = v57;
          [(__CFString *)summary trackAnomaly:@"AUTO-SET-CONTROL" forReason:v57 withResult:6103 withError:0];

          goto LABEL_21;
        }
      }

LABEL_25:

      goto LABEL_26;
    }

    if (![descriptorCopy isOnFilesystem] || (objc_msgSend(descriptorCopy, "onFilesystemIncomplete") & 1) != 0)
    {
      activeSetDescriptorsByIdentifier = [(MADAutoAssetControlManager *)self activeSetDescriptorsByIdentifier];
      [activeSetDescriptorsByIdentifier setSafeObject:descriptorCopy forKey:v26];

      activeSetDescriptorsByInstance = [(MADAutoAssetControlManager *)self activeSetDescriptorsByInstance];
      discoveredAtomicInstance2 = [descriptorCopy discoveredAtomicInstance];
      [activeSetDescriptorsByInstance setSafeObject:descriptorCopy forKey:discoveredAtomicInstance2];

      [(MADAutoAssetControlManager *)self persistSetDescriptorActiveJob:descriptorCopy fromLocation:locationCopy];
      v40 = 0;
      goto LABEL_25;
    }

    v61 = 0;
    v130 = 0;
    if (statusCopy && justDownloaded)
    {
      clientDomainName5 = [statusCopy clientDomainName];
      assetSetIdentifier5 = [statusCopy assetSetIdentifier];
      v130 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName5 forAssetSetIdentifier:assetSetIdentifier5];

      latestDownloadedAtomicInstance4 = [descriptorCopy latestDownloadedAtomicInstance];
      v61 = [(MADAutoAssetControlManager *)self shouldAdoptJobFoundAllContent:locationCopy forJobAtomicInstance:latestDownloadedAtomicInstance4 withCurrentSetStatus:statusCopy];
    }

    if (v29)
    {
      clientDomainName6 = [descriptorCopy clientDomainName];
      assetSetIdentifier6 = [descriptorCopy assetSetIdentifier];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByClientDomain:clientDomainName6 forAssetSetIdentifier:assetSetIdentifier6 fromLocation:locationCopy];
    }

    if (v134)
    {
      discoveredAtomicInstance3 = [descriptorCopy discoveredAtomicInstance];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:discoveredAtomicInstance3];
    }

    operationCopy = operation;
    if (v133)
    {
      latestDownloadedAtomicInstance5 = [descriptorCopy latestDownloadedAtomicInstance];
      [(MADAutoAssetControlManager *)self removeSetDescriptorActiveJobByAtomicInstanceUUID:latestDownloadedAtomicInstance5];
    }

    v131 = v29;
    if (v61)
    {
      operationCopy2 = operation;
      latestDownloadedAtomicInstance6 = [statusCopy latestDownloadedAtomicInstance];
      latestDowloadedAtomicInstanceEntries = [statusCopy latestDowloadedAtomicInstanceEntries];
      v72 = latestDowloadedAtomicInstanceEntries;
      if (latestDownloadedAtomicInstance6 && latestDowloadedAtomicInstanceEntries && [latestDowloadedAtomicInstanceEntries count])
      {
        v73 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:descriptorCopy];
        v74 = [(MADAutoAssetControlManager *)self setAtomicEntriesRemoveDuplicates:locationCopy dedupingAtomicEntries:v72];

        v72 = v74;
        autoAssetEntries = [v130 autoAssetEntries];
        [descriptorCopy setRequestedAutoAssetEntries:autoAssetEntries];

        catalogCachedAssetSetID = [statusCopy catalogCachedAssetSetID];
        [descriptorCopy setCatalogCachedAssetSetID:catalogCachedAssetSetID];

        catalogDownloadedFromLive = [statusCopy catalogDownloadedFromLive];
        [descriptorCopy setCatalogDownloadedFromLive:catalogDownloadedFromLive];

        catalogLastTimeChecked = [statusCopy catalogLastTimeChecked];
        [descriptorCopy setCatalogLastTimeChecked:catalogLastTimeChecked];

        catalogPostedDate = [statusCopy catalogPostedDate];
        [descriptorCopy setCatalogPostedDate:catalogPostedDate];

        downloadedCatalogCachedAssetSetID = [statusCopy downloadedCatalogCachedAssetSetID];
        [descriptorCopy setDownloadedCatalogCachedAssetSetID:downloadedCatalogCachedAssetSetID];

        downloadedCatalogDownloadedFromLive = [statusCopy downloadedCatalogDownloadedFromLive];
        [descriptorCopy setDownloadedCatalogDownloadedFromLive:downloadedCatalogDownloadedFromLive];

        downloadedCatalogLastTimeChecked = [statusCopy downloadedCatalogLastTimeChecked];
        [descriptorCopy setDownloadedCatalogLastTimeChecked:downloadedCatalogLastTimeChecked];

        downloadedCatalogPostedDate = [statusCopy downloadedCatalogPostedDate];
        [descriptorCopy setDownloadedCatalogPostedDate:downloadedCatalogPostedDate];

        newerDiscoveredAtomicEntries = [statusCopy newerDiscoveredAtomicEntries];
        [descriptorCopy setDiscoveredAtomicEntries:newerDiscoveredAtomicEntries];

        [descriptorCopy setLatestDownloadedAtomicInstance:latestDownloadedAtomicInstance6];
        [descriptorCopy setLatestDowloadedAtomicInstanceEntries:v72];
        [descriptorCopy setIsOnFilesystem:1];
        [descriptorCopy setIsDiscoveredFullyDownloaded:1];
        [descriptorCopy setAtomicInstanceDownloadedNotified:0];
        [descriptorCopy setNeverBeenLocked:1];
        assetSetIdentifier7 = [statusCopy assetSetIdentifier];
        [(MADAutoAssetControlManager *)self _updateCurrentSetStatus:locationCopy forSetIdentifier:assetSetIdentifier7 withSetStatus:statusCopy];

        v86 = v73;
        [(MADAutoAssetControlManager *)self updateAutoAssetSetStatus:locationCopy forSetDescriptor:descriptorCopy];
        if (v73)
        {
          v34 = v26;
          [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:locationCopy toNewStatus:@"UNTRACKED" forAtomicInstance:v86];
        }

        else
        {
          v34 = v26;
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          [autoControlManagerFSM3 diag];
          v95 = v124 = latestDownloadedAtomicInstance6;
          v127 = v72;
          v96 = [NSString alloc];
          summary4 = [descriptorCopy summary];
          v98 = [v96 initWithFormat:@"{%@} no setAtomicInstance | setJobDescriptor:%@", locationCopy, summary4];
          [v95 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v98 withResult:6103 withError:0];

          v72 = v127;
          v86 = 0;

          latestDownloadedAtomicInstance6 = v124;
        }

        [(MADAutoAssetControlManager *)self _removeAllUnlockedForOtherAtomicInstances:descriptorCopy fromLocation:locationCopy];

        v39 = 0;
        operationCopy2 = 356;
      }

      else
      {
        v34 = v26;
        v87 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v87, OS_LOG_TYPE_DEFAULT))
        {
          if (latestDownloadedAtomicInstance6)
          {
            v88 = latestDownloadedAtomicInstance6;
          }

          else
          {
            v88 = @"N";
          }

          v120 = [v72 count];
          [descriptorCopy summary];
          v89 = v123 = latestDownloadedAtomicInstance6;
          *buf = 138544130;
          v136 = locationCopy;
          v137 = 2114;
          v138 = v88;
          v139 = 2048;
          v140 = v120;
          v141 = 2114;
          v142 = v89;
          _os_log_impl(&dword_0, v87, OS_LOG_TYPE_DEFAULT, "{%{public}@} set-job current-set-status incomplete | downloadedAtomicInstance:%{public}@ | latestDownloadedEntries:%ld | setJobDescriptor:%{public}@", buf, 0x2Au);

          latestDownloadedAtomicInstance6 = v123;
        }

        v39 = 1;
      }

      operationCopy = operationCopy2;
    }

    else
    {
      v34 = v26;
      v39 = 1;
    }

    if ([(MADAutoAssetControlManager *)self _doesSetDescriptorDownloadedMatchLatestToVend:locationCopy forSetDescriptor:descriptorCopy])
    {
      discoveredAtomicInstance4 = [descriptorCopy discoveredAtomicInstance];
      v100 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:discoveredAtomicInstance4];

      latestDownloadedAtomicInstance7 = [descriptorCopy latestDownloadedAtomicInstance];
      v102 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestDownloadedAtomicInstance7];

      v128 = v102;
      if (!v130)
      {
        clientDomainName7 = [descriptorCopy clientDomainName];
        assetSetIdentifier8 = [descriptorCopy assetSetIdentifier];
        v130 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName7 forAssetSetIdentifier:assetSetIdentifier8];

        v102 = v128;
      }

      latestDowloadedAtomicInstanceEntries2 = v100;
      if (v100)
      {
        if (!v130 || ([v100 atomicInstanceUUID], v105 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v130, "latestAtomicInstanceToVend"), v106 = objc_claimAutoreleasedReturnValue(), v107 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v105, v106), v106, v100 = latestDowloadedAtomicInstanceEntries2, v105, v102 = v128, (v107 & 1) == 0))
        {
          atomicInstanceUUID = [v100 atomicInstanceUUID];
          [(MADAutoAssetControlManager *)self atomicInstanceRemove:locationCopy setAtomicInstanceUUID:atomicInstanceUUID removingForReason:@"set-descriptor (to be adopted as just-downloaded) discoveredAtomicInstance matches latest-to-vend [nothing new]" historyOperation:1501];
        }
      }

      if (!v102)
      {
        v113 = v130;
LABEL_88:

        goto LABEL_89;
      }

      atomicInstanceUUID2 = [v102 atomicInstanceUUID];
      v110 = v100;
      atomicInstanceUUID5 = atomicInstanceUUID2;
      atomicInstanceUUID3 = [v110 atomicInstanceUUID];
      if (([SUCore stringIsEqual:atomicInstanceUUID5 to:atomicInstanceUUID3]& 1) != 0)
      {

        v102 = v128;
        v113 = v130;
LABEL_86:

        goto LABEL_87;
      }

      if (v130)
      {
        atomicInstanceUUID4 = [v128 atomicInstanceUUID];
        latestAtomicInstanceToVend4 = [v130 latestAtomicInstanceToVend];
        v119 = [SUCore stringIsEqual:atomicInstanceUUID4 to:latestAtomicInstanceToVend4];

        if (v119)
        {
          v102 = v128;
          v113 = v130;
LABEL_87:
          v100 = latestDowloadedAtomicInstanceEntries2;
          goto LABEL_88;
        }
      }

      else
      {
      }

      v102 = v128;
      atomicInstanceUUID5 = [v128 atomicInstanceUUID];
      [(MADAutoAssetControlManager *)self atomicInstanceRemove:locationCopy setAtomicInstanceUUID:atomicInstanceUUID5 removingForReason:@"set-descriptor (to be adopted as just-downloaded) downloadedAtomicInstance matches latest-to-vend [nothing new]" historyOperation:1501];
    }

    else
    {
      [(MADAutoAssetControlManager *)self persistSetDescriptorDownloadedJob:descriptorCopy fromLocation:locationCopy];
      if (!operationCopy)
      {
        v113 = v130;
LABEL_89:

        goto LABEL_6;
      }

      latestDowloadedAtomicInstanceEntries2 = [descriptorCopy latestDowloadedAtomicInstanceEntries];
      v118 = [latestDowloadedAtomicInstanceEntries2 count];
      clientDomainName8 = [descriptorCopy clientDomainName];
      [descriptorCopy assetSetIdentifier];
      atomicInstanceUUID5 = v114 = operationCopy;
      discoveredAtomicInstance5 = [descriptorCopy discoveredAtomicInstance];
      v116 = v114;
      v102 = clientDomainName8;
      [MADAutoAssetHistory recordOperation:v116 toHistoryType:2 fromLayer:1 usageCount:v118 forClientDomainName:clientDomainName8 forAssetSetIdentifier:atomicInstanceUUID5 forAtomicInstance:discoveredAtomicInstance5];
    }

    v113 = v130;
    goto LABEL_86;
  }

  autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM4 diag];
  v49 = [[NSString alloc] initWithFormat:@"{%@} nil setJobDescriptor", locationCopy];
  [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v49 withResult:6103 withError:0];

  v40 = 0;
LABEL_26:

  return v40;
}

- (void)_logTrackedSetDescriptors:(id)descriptors forSetJobDescriptor:(id)descriptor
{
  descriptorsCopy = descriptors;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [descriptorCopy summary];
    v13 = 138543874;
    v14 = _updateLatestSummary;
    v15 = 2114;
    v16 = descriptorsCopy;
    v17 = 2114;
    v18 = summary;
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_logTrackedSetDescriptors} setJobDesciptor:%{public}@", &v13, 0x20u);
  }
}

- (void)trackDescriptorForgetAssetSelector:(id)selector forHistoryOperation:(int64_t)operation firstClientName:(id)name
{
  selectorCopy = selector;
  nameCopy = name;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [selectorCopy summary];
    *buf = 138543618;
    v55 = _updateLatestSummary;
    v56 = 2114;
    v57 = summary;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetSelector} forgetting | assetSelector:%{public}@", buf, 0x16u);
  }

  assetType = [selectorCopy assetType];

  if (assetType)
  {
    assetSpecifier = [selectorCopy assetSpecifier];

    if (assetSpecifier)
    {
      assetVersion = [selectorCopy assetVersion];

      if (assetVersion)
      {
        v18 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:selectorCopy];
        if (v18)
        {
          assetType3 = v18;
          if ((operation - 405) >= 2)
          {
            v20 = 1;
          }

          else
          {
            v20 = 5;
          }
        }

        else
        {
          v26 = [(MADAutoAssetControlManager *)self locateActiveJobDescriptorBySelector:selectorCopy];
          if ((operation - 405) >= 2)
          {
            v20 = 1;
          }

          else
          {
            v20 = 5;
          }

          if (!v26)
          {
            persistedEntryID = _MADLog(@"AutoControl");
            if (os_log_type_enabled(persistedEntryID, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary2 = [selectorCopy summary];
              *buf = 138543618;
              v55 = _updateLatestSummary2;
              v56 = 2114;
              v57 = summary2;
              _os_log_impl(&dword_0, persistedEntryID, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetSelector} no descriptor for asset-version | assetSelector:%{public}@", buf, 0x16u);
            }

            assetType3 = 0;
            LOBYTE(v30) = 0;
LABEL_30:

            v42 = [(MADAutoAssetControlManager *)self jobSelectorKey:selectorCopy];
            if (v42)
            {
              if ((v30 & 1) != 0 || ![assetType3 isOnFilesystem])
              {
                goto LABEL_37;
              }

              assetId = [assetType3 assetId];
              if (nameCopy)
              {
                [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromClient:nameCopy forAssetID:assetId withSelector:selectorCopy];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromLayer:v20 forAssetID:assetId withSelector:selectorCopy];
              }
            }

            else
            {
              assetId = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
              diag = [assetId diag];
              v45 = [NSString alloc];
              summary3 = [selectorCopy summary];
              v47 = [v45 initWithFormat:@"{trackDescriptorForgetAssetSelector} nil jobSelectorKey | assetSelector:%@", summary3];
              [diag trackAnomaly:@"AUTO-CONTROL" forReason:v47 withResult:6103 withError:0];
            }

LABEL_37:
            assetType2 = [selectorCopy assetType];
            assetSpecifier2 = [selectorCopy assetSpecifier];
            assetVersion2 = [selectorCopy assetVersion];
            [(MADAutoAssetControlManager *)self _logTrackedDescriptors:@"trackDescriptorForgetAssetSelector" forAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion2];

            goto LABEL_38;
          }

          assetType3 = v26;
        }

        persistedEntryID = [selectorCopy persistedEntryID];
        persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        [persistedKnownDescriptors removePersistedEntry:persistedEntryID fromLocation:@"trackDescriptorForgetAssetSelector"];

        if ([assetType3 isOnFilesystem])
        {
          v29 = @"DOWNLOADED_DESCRIPTORS";
        }

        else
        {
          v29 = @"JOB_DESCRIPTORS";
        }

        [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"trackDescriptorForgetAssetSelector" forComponentType:v29 removedPersistedEntryID:persistedEntryID removedDescriptor:assetType3 message:@"forget all auto-specific-assets associated with the given asset-selector"];
        LODWORD(v30) = [assetType3 isOnFilesystem];
        if (v30)
        {
          assetId2 = [assetType3 assetId];
          if (nameCopy)
          {
            [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromClient:nameCopy forAssetID:assetId2 withSelector:selectorCopy];
          }

          else
          {
            [MADAutoAssetHistory recordOperation:operation toHistoryType:0 fromLayer:v20 forAssetID:assetId2 withSelector:selectorCopy];
          }

          if (+[MAAIRBEventReporter isAvailable])
          {
            v32 = [MAAIRBMobileAssetOperationMetadata alloc];
            v33 = [MADAutoAssetHistoryTracker operationName:operation];
            v51 = [(MAAIRBMobileAssetOperationMetadata *)v32 initWithCode:operation name:v33];

            v52 = [MAAIRBMobileAssetAssetSelector alloc];
            [selectorCopy assetType];
            v34 = v53 = v20;
            assetSpecifier3 = [selectorCopy assetSpecifier];
            assetVersion3 = [selectorCopy assetVersion];
            v37 = [(MAAIRBMobileAssetAssetSelector *)v52 initWithAssetType:v34 assetSpecifier:assetSpecifier3 assetVersion:assetVersion3];
            LOBYTE(v52) = v30;
            v30 = v37;

            v38 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v51 assetSelector:v30];
            v39 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v38];
            [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v39];

            v20 = v53;
            LOBYTE(v30) = v52;
          }
        }

        goto LABEL_30;
      }

      assetType3 = [selectorCopy assetType];
      assetSpecifier4 = [selectorCopy assetSpecifier];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:assetType3 forAssetSpecifier:assetSpecifier4 firstClientName:nameCopy];
    }

    else
    {
      assetType3 = [selectorCopy assetType];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetType:assetType3 firstClientName:nameCopy];
    }
  }

  else
  {
    assetType3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag2 = [assetType3 diag];
    v22 = [NSString alloc];
    summary4 = [selectorCopy summary];
    v24 = [v22 initWithFormat:@"{trackDescriptorForgetAssetSelector} nil assetType | assetSelector:%@", summary4];
    [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v24 withResult:6103 withError:0];
  }

LABEL_38:
}

- (void)trackDescriptorForgetAssetType:(id)type forAssetSpecifier:(id)specifier firstClientName:(id)name
{
  typeCopy = type;
  specifierCopy = specifier;
  nameCopy = name;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v12 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138543874;
    v109 = _updateLatestSummary;
    v110 = 2114;
    v111 = typeCopy;
    v112 = 2114;
    v113 = specifierCopy;
    _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} | assetType:%{public}@, assetSpecifier:%{public}@", buf, 0x20u);
  }

  if (!typeCopy || !specifierCopy)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    specifierCopy = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType:forAssetSpecifier:} missing parameter assetType:%@ assetSpecifier:%@", typeCopy, specifierCopy];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:specifierCopy withResult:6102 withError:0];
    goto LABEL_60;
  }

  v81 = objc_alloc_init(NSMutableDictionary);
  [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorForAssetType:typeCopy];
  v101 = 0u;
  v102 = 0u;
  v103 = 0u;
  v14 = v104 = 0u;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v83 = typeCopy;
  v88 = [v14 countByEnumeratingWithState:&v101 objects:v107 count:16];
  v91 = specifierCopy;
  if (!v88)
  {
    goto LABEL_27;
  }

  v86 = *v102;
  do
  {
    for (i = 0; i != v88; i = i + 1)
    {
      if (*v102 != v86)
      {
        objc_enumerationMutation(v14);
      }

      v17 = *(*(&v101 + 1) + 8 * i);
      v18 = objc_autoreleasePoolPush();
      v19 = [v14 safeObjectForKey:v17 ofClass:objc_opt_class()];
      v20 = v19;
      if (v19)
      {
        v21 = p_weak_ivar_lyt[223];
        assetSpecifier = [v19 assetSpecifier];
        LODWORD(v21) = [v21 stringIsEqual:assetSpecifier to:specifierCopy];

        if (!v21)
        {
          goto LABEL_25;
        }

        v23 = [MAAutoAssetSelector alloc];
        assetType = [v20 assetType];
        assetSpecifier2 = [v20 assetSpecifier];
        assetVersion = [v20 assetVersion];
        autoControlManagerFSM3 = [v23 initForAssetType:assetType withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion];

        persistedEntryID = [autoControlManagerFSM3 persistedEntryID];
        persistedKnownDescriptors = [(MADAutoAssetControlManager *)selfCopy persistedKnownDescriptors];
        [persistedKnownDescriptors removePersistedEntry:persistedEntryID fromLocation:@"trackDescriptorForgetAssetType"];

        if ([v20 isOnFilesystem])
        {
          v30 = @"DOWNLOADED_DESCRIPTORS";
        }

        else
        {
          v30 = @"JOB_DESCRIPTORS";
        }

        [(MADAutoAssetControlManager *)selfCopy _logPersistedRemovedEntry:@"trackDescriptorForgetAssetType" forComponentType:v30 removedPersistedEntryID:persistedEntryID removedDescriptor:v20 message:@"forget all descriptors for the asset-type + asset-specifier"];
        if ([v20 isOnFilesystem])
        {
          assetId = [v20 assetId];
          if (nameCopy)
          {
            [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:nameCopy forAssetID:assetId withSelector:autoControlManagerFSM3];
          }

          else
          {
            [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:assetId withSelector:autoControlManagerFSM3];
          }

          if (+[MAAIRBEventReporter isAvailable])
          {
            v33 = [MAAIRBMobileAssetOperationMetadata alloc];
            v34 = [MADAutoAssetHistoryTracker operationName:300];
            v84 = [(MAAIRBMobileAssetOperationMetadata *)v33 initWithCode:300 name:v34];

            v35 = [MAAIRBMobileAssetAssetSelector alloc];
            assetType2 = [autoControlManagerFSM3 assetType];
            assetSpecifier3 = [autoControlManagerFSM3 assetSpecifier];
            assetVersion2 = [autoControlManagerFSM3 assetVersion];
            v39 = [(MAAIRBMobileAssetAssetSelector *)v35 initWithAssetType:assetType2 assetSpecifier:assetSpecifier3 assetVersion:assetVersion2];

            v40 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v84 assetSelector:v39];
            v41 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v40];
            [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v41];

            typeCopy = v83;
          }

          [v81 setSafeObject:v20 forKey:persistedEntryID];
        }

        specifierCopy = v91;
      }

      else
      {
        autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        persistedEntryID = [autoControlManagerFSM3 diag];
        specifierCopy2 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType:forAssetSpecifier:} unable to load descriptor | assetType:%@, assetSpecifier:%@", typeCopy, specifierCopy];
        [persistedEntryID trackAnomaly:@"AUTO-CONTROL" forReason:specifierCopy2 withResult:6103 withError:0];
      }

      p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
LABEL_25:

      objc_autoreleasePoolPop(v18);
    }

    v88 = [v14 countByEnumeratingWithState:&v101 objects:v107 count:16];
  }

  while (v88);
LABEL_27:

  v89 = objc_alloc_init(NSMutableDictionary);
  v97 = 0u;
  v98 = 0u;
  v99 = 0u;
  v100 = 0u;
  v42 = v14;
  v43 = [v42 countByEnumeratingWithState:&v97 objects:v106 count:16];
  v87 = v42;
  if (v43)
  {
    v44 = v43;
    v45 = *v98;
    do
    {
      for (j = 0; j != v44; j = j + 1)
      {
        if (*v98 != v45)
        {
          objc_enumerationMutation(v42);
        }

        v47 = *(*(&v97 + 1) + 8 * j);
        v48 = objc_autoreleasePoolPush();
        v49 = [v42 safeObjectForKey:v47 ofClass:objc_opt_class()];
        assetType3 = [v49 assetType];
        if (([SUCore stringIsEqual:assetType3 to:typeCopy]& 1) != 0)
        {
          assetSpecifier4 = [v49 assetSpecifier];
          v52 = [SUCore stringIsEqual:assetSpecifier4 to:v91];

          typeCopy = v83;
          if (v52)
          {
            v53 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v53, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary = [v49 summary];
              *buf = 138543618;
              v109 = _updateLatestSummary2;
              v110 = 2114;
              v111 = summary;
              _os_log_impl(&dword_0, v53, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} removing from downloadedDescriptorsBySelector | forgetDescriptor:%{public}@", buf, 0x16u);

              typeCopy = v83;
            }

            [(MADAutoAssetControlManager *)selfCopy _statsIncrementRemovedForDescriptor:v49];
            [v89 setSafeObject:v49 forKey:v47];
          }
        }

        else
        {
        }

        objc_autoreleasePoolPop(v48);
        v42 = v87;
      }

      v44 = [v87 countByEnumeratingWithState:&v97 objects:v106 count:16];
    }

    while (v44);
  }

  v95 = 0u;
  v96 = 0u;
  v93 = 0u;
  v94 = 0u;
  specifierCopy = v89;
  specifierCopy = v91;
  autoControlManagerFSM2 = v81;
  v90 = [specifierCopy countByEnumeratingWithState:&v93 objects:v105 count:16];
  if (v90)
  {
    v85 = *v94;
    do
    {
      for (k = 0; k != v90; k = k + 1)
      {
        if (*v94 != v85)
        {
          objc_enumerationMutation(specifierCopy);
        }

        v59 = *(*(&v93 + 1) + 8 * k);
        v60 = [specifierCopy safeObjectForKey:v59 ofClass:objc_opt_class()];
        v61 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v61, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          *buf = 138543618;
          v109 = _updateLatestSummary3;
          v110 = 2114;
          v111 = v59;
          _os_log_impl(&dword_0, v61, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:forAssetSpecifier:} removed from downloadedDescriptorsBySelector | jobSelectorKey:%{public}@", buf, 0x16u);
        }

        if ([v60 isOnFilesystem])
        {
          v63 = [autoControlManagerFSM2 safeObjectForKey:v59 ofClass:objc_opt_class()];
          if (!v63)
          {
            v64 = [MAAutoAssetSelector alloc];
            assetType4 = [v60 assetType];
            assetSpecifier5 = [v60 assetSpecifier];
            assetVersion3 = [v60 assetVersion];
            v68 = [v64 initForAssetType:assetType4 withAssetSpecifier:assetSpecifier5 matchingAssetVersion:assetVersion3];

            assetId2 = [v60 assetId];
            if (nameCopy)
            {
              [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:nameCopy forAssetID:assetId2 withSelector:v68];
            }

            else
            {
              [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:assetId2 withSelector:v68];
            }

            if (+[MAAIRBEventReporter isAvailable])
            {
              v70 = [MAAIRBMobileAssetOperationMetadata alloc];
              v71 = [MADAutoAssetHistoryTracker operationName:300];
              v72 = [(MAAIRBMobileAssetOperationMetadata *)v70 initWithCode:300 name:v71];

              v73 = [MAAIRBMobileAssetAssetSelector alloc];
              assetType5 = [v68 assetType];
              assetSpecifier6 = [v68 assetSpecifier];
              assetVersion4 = [v68 assetVersion];
              v77 = [(MAAIRBMobileAssetAssetSelector *)v73 initWithAssetType:assetType5 assetSpecifier:assetSpecifier6 assetVersion:assetVersion4];

              v78 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v72 assetSelector:v77];
              v79 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v78];
              [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v79];
            }

            typeCopy = v83;
            autoControlManagerFSM2 = v81;
          }

          specifierCopy = v91;
        }
      }

      v90 = [specifierCopy countByEnumeratingWithState:&v93 objects:v105 count:16];
    }

    while (v90);
  }

  [(MADAutoAssetControlManager *)selfCopy _logTrackedDescriptors:@"trackDescriptorForgetAssetType" forAssetType:typeCopy withAssetSpecifier:specifierCopy matchingAssetVersion:0];
  diag = v87;
LABEL_60:
}

- (void)trackDescriptorForgetAssetType:(id)type firstClientName:(id)name
{
  typeCopy = type;
  nameCopy = name;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (typeCopy)
  {
    v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewBySelectorForAssetType:typeCopy];
    v74 = objc_alloc_init(NSMutableDictionary);
    v92 = 0u;
    v93 = 0u;
    v94 = 0u;
    v95 = 0u;
    obj = v10;
    v77 = [obj countByEnumeratingWithState:&v92 objects:v102 count:16];
    v80 = typeCopy;
    v73 = nameCopy;
    selfCopy = self;
    if (v77)
    {
      v75 = *v93;
      do
      {
        for (i = 0; i != v77; i = i + 1)
        {
          if (*v93 != v75)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v92 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          v14 = [obj safeObjectForKey:v12 ofClass:objc_opt_class()];
          if (v14)
          {
            v15 = [MAAutoAssetSelector alloc];
            assetType = [v14 assetType];
            assetSpecifier = [v14 assetSpecifier];
            assetVersion = [v14 assetVersion];
            autoControlManagerFSM2 = [v15 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

            persistedEntryID = [autoControlManagerFSM2 persistedEntryID];
            persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [persistedKnownDescriptors removePersistedEntry:persistedEntryID fromLocation:@"trackDescriptorForgetAssetType"];

            if ([v14 isOnFilesystem])
            {
              v22 = @"DOWNLOADED_DESCRIPTORS";
            }

            else
            {
              v22 = @"JOB_DESCRIPTORS";
            }

            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"trackDescriptorForgetAssetType" forComponentType:v22 removedPersistedEntryID:persistedEntryID removedDescriptor:v14 message:@"forget all descriptors for the asset-type"];
            if ([v14 isOnFilesystem])
            {
              assetId = [v14 assetId];
              if (nameCopy)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:nameCopy forAssetID:assetId withSelector:autoControlManagerFSM2];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:assetId withSelector:autoControlManagerFSM2];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v25 = [MAAIRBMobileAssetOperationMetadata alloc];
                v26 = [MADAutoAssetHistoryTracker operationName:300];
                v27 = [(MAAIRBMobileAssetOperationMetadata *)v25 initWithCode:300 name:v26];

                v28 = [MAAIRBMobileAssetAssetSelector alloc];
                assetType2 = [autoControlManagerFSM2 assetType];
                assetSpecifier2 = [autoControlManagerFSM2 assetSpecifier];
                assetVersion2 = [autoControlManagerFSM2 assetVersion];
                v32 = [(MAAIRBMobileAssetAssetSelector *)v28 initWithAssetType:assetType2 assetSpecifier:assetSpecifier2 assetVersion:assetVersion2];

                v33 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v27 assetSelector:v32];
                v34 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v33];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v34];

                nameCopy = v73;
                self = selfCopy;
              }

              [v74 setSafeObject:v14 forKey:persistedEntryID];
            }

            typeCopy = v80;
          }

          else
          {
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            persistedEntryID = [autoControlManagerFSM2 diag];
            typeCopy = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType} unable to load descriptor | assetType:%@", typeCopy];
            [persistedEntryID trackAnomaly:@"AUTO-CONTROL" forReason:typeCopy withResult:6103 withError:0];
          }

          objc_autoreleasePoolPop(v13);
        }

        v77 = [obj countByEnumeratingWithState:&v92 objects:v102 count:16];
      }

      while (v77);
    }

    v78 = objc_alloc_init(NSMutableDictionary);
    v88 = 0u;
    v89 = 0u;
    v90 = 0u;
    v91 = 0u;
    obja = obj;
    v35 = [obja countByEnumeratingWithState:&v88 objects:v101 count:16];
    if (v35)
    {
      v36 = v35;
      v37 = *v89;
      do
      {
        for (j = 0; j != v36; j = j + 1)
        {
          if (*v89 != v37)
          {
            objc_enumerationMutation(obja);
          }

          v39 = *(*(&v88 + 1) + 8 * j);
          v40 = objc_autoreleasePoolPush();
          v41 = [obja safeObjectForKey:v39 ofClass:objc_opt_class()];
          assetType3 = [v41 assetType];
          v43 = [SUCore stringIsEqual:assetType3 to:typeCopy];

          self = selfCopy;
          if (v43)
          {
            v44 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v44, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              summary = [v41 summary];
              *buf = 138543618;
              v98 = _updateLatestSummary;
              v99 = 2114;
              v100 = summary;
              _os_log_impl(&dword_0, v44, OS_LOG_TYPE_DEFAULT, "[%{public}@] {trackDescriptorForgetAssetType:} removing from downloadedDescriptorsBySelector | forgetDescriptor:%{public}@", buf, 0x16u);

              self = selfCopy;
            }

            [(MADAutoAssetControlManager *)self _statsIncrementRemovedForDescriptor:v41];
            [v78 setSafeObject:v41 forKey:v39];
            typeCopy = v80;
          }

          objc_autoreleasePoolPop(v40);
        }

        v36 = [obja countByEnumeratingWithState:&v88 objects:v101 count:16];
      }

      while (v36);
    }

    v86 = 0u;
    v87 = 0u;
    v84 = 0u;
    v85 = 0u;
    v47 = v78;
    v48 = [v47 countByEnumeratingWithState:&v84 objects:v96 count:16];
    if (v48)
    {
      v49 = v48;
      v50 = *v85;
      v79 = *v85;
      do
      {
        for (k = 0; k != v49; k = k + 1)
        {
          if (*v85 != v50)
          {
            objc_enumerationMutation(v47);
          }

          v52 = *(*(&v84 + 1) + 8 * k);
          v53 = [v47 safeObjectForKey:v52 ofClass:objc_opt_class()];
          if ([v53 isOnFilesystem])
          {
            v54 = [v74 safeObjectForKey:v52 ofClass:objc_opt_class()];
            if (!v54)
            {
              v55 = [MAAutoAssetSelector alloc];
              assetType4 = [v53 assetType];
              assetSpecifier3 = [v53 assetSpecifier];
              assetVersion3 = [v53 assetVersion];
              v59 = [v55 initForAssetType:assetType4 withAssetSpecifier:assetSpecifier3 matchingAssetVersion:assetVersion3];

              assetId2 = [v53 assetId];
              if (v73)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v73 forAssetID:assetId2 withSelector:v59];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:assetId2 withSelector:v59];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v61 = [MAAIRBMobileAssetOperationMetadata alloc];
                v62 = [MADAutoAssetHistoryTracker operationName:300];
                v76 = [(MAAIRBMobileAssetOperationMetadata *)v61 initWithCode:300 name:v62];

                v63 = [MAAIRBMobileAssetAssetSelector alloc];
                assetType5 = [v59 assetType];
                assetSpecifier4 = [v59 assetSpecifier];
                assetVersion4 = [v59 assetVersion];
                v67 = [(MAAIRBMobileAssetAssetSelector *)v63 initWithAssetType:assetType5 assetSpecifier:assetSpecifier4 assetVersion:assetVersion4];

                v68 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v76 assetSelector:v67];
                v69 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v68];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v69];
              }

              self = selfCopy;
              v50 = v79;
            }
          }
        }

        v49 = [v47 countByEnumeratingWithState:&v84 objects:v96 count:16];
      }

      while (v49);
    }

    typeCopy = v80;
    [(MADAutoAssetControlManager *)self _logTrackedDescriptors:@"trackDescriptorForgetAssetType(done)" forAssetType:v80 withAssetSpecifier:0 matchingAssetVersion:0];

    nameCopy = v73;
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM3 diag];
    v72 = [[NSString alloc] initWithFormat:@"{trackDescriptorForgetAssetType} nil assetType"];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v72 withResult:6103 withError:0];
  }
}

- (void)_trackActiveDescriptor:(id)descriptor operation:(id)operation usingSelector:(id)selector withJobUUID:(id)d triggeredByClientMessage:(id)message downloadingDescriptor:(id)downloadingDescriptor baseForPatchDescriptor:(id)patchDescriptor message:(id)self0
{
  descriptorCopy = descriptor;
  operationCopy = operation;
  selectorCopy = selector;
  dCopy = d;
  messageCopy = message;
  downloadingDescriptorCopy = downloadingDescriptor;
  patchDescriptorCopy = patchDescriptor;
  v22 = a10;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v48 = operationCopy;
  v25 = [operationCopy isEqualToString:@"ENTRY_ADD"];
  if (downloadingDescriptorCopy || (v25 & 1) != 0)
  {
    persistedEntryID = [selectorCopy persistedEntryID];
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v30 = [persistedActiveJobs persistedEntry:persistedEntryID fromLocation:descriptorCopy];

    if (v30)
    {
      if (messageCopy)
      {
        [v30 persistSecureCodedObject:messageCopy forKey:@"clientRequestMessage"];
      }

      if (selectorCopy)
      {
        [v30 persistSecureCodedObject:selectorCopy forKey:@"assetSelector"];
      }

      if (dCopy)
      {
        [v30 persistString:dCopy forKey:@"autoAssetUUID"];
      }

      if (!downloadingDescriptorCopy)
      {
        downloadingDescriptorCopy = [[MADAutoAssetDescriptor alloc] initBlankEntry];
      }

      v44 = selectorCopy;
      v46 = dCopy;
      [v30 persistSecureCodedObject:downloadingDescriptorCopy forKey:@"assetDescriptor"];
      v31 = messageCopy;
      if (patchDescriptorCopy)
      {
        [v30 persistSecureCodedObject:patchDescriptorCopy forKey:@"baseForPatchDescriptor"];
      }

      else
      {
        initBlankEntry = [[MADAutoAssetDescriptor alloc] initBlankEntry];
        [v30 persistSecureCodedObject:initBlankEntry forKey:@"baseForPatchDescriptor"];
      }

      v35 = patchDescriptorCopy;
      persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      summary = [downloadingDescriptorCopy summary];
      v38 = persistedEntryID;
      [persistedActiveJobs2 storePersistedEntry:persistedEntryID withEntrySummary:summary fromLocation:descriptorCopy];

      v39 = v35;
      operationCopy = v48;
      messageCopy = v31;
      v40 = v31;
      dCopy = v46;
      [(MADAutoAssetControlManager *)self _logPersistedEntry:descriptorCopy forComponentType:@"ACTIVE-JOBS" operation:v48 forPersistedEntryID:v38 forClientRequest:v40 withJobUUID:v46 withAssetDescriptor:downloadingDescriptorCopy baseForPatchDescriptor:v35 message:v22];
      selectorCopy = v44;
      goto LABEL_35;
    }

    v32 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
    {
LABEL_34:
      v41 = v32;
      v39 = patchDescriptorCopy;

      v38 = persistedEntryID;
      operationCopy = v48;
LABEL_35:

      patchDescriptorCopy = v39;
      goto LABEL_36;
    }

    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary2 = [selectorCopy summary];
    if (messageCopy)
    {
      messageName = [messageCopy messageName];
      if (downloadingDescriptorCopy)
      {
        goto LABEL_20;
      }
    }

    else
    {
      messageName = @"N";
      if (downloadingDescriptorCopy)
      {
LABEL_20:
        summary3 = [downloadingDescriptorCopy summary];
        if (patchDescriptorCopy)
        {
LABEL_21:
          summary4 = [patchDescriptorCopy summary];
LABEL_27:
          *buf = 138544898;
          v51 = _updateLatestSummary;
          v52 = 2114;
          v53 = descriptorCopy;
          v54 = 2114;
          v55 = summary2;
          v56 = 2114;
          v57 = dCopy;
          v58 = 2114;
          v59 = messageName;
          v60 = 2114;
          v61 = summary3;
          v62 = 2114;
          v63 = summary4;
          _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@:_trackActiveDescriptor} unable to create active persisted-state for selector:%{public}@ JobUUID:%{public}@ message:%{public}@ downloadingDescriptor:%{public}@ baseForPatchDescriptor:%{public}@", buf, 0x48u);
          if (patchDescriptorCopy)
          {
          }

          if (downloadingDescriptorCopy)
          {
          }

          if (messageCopy)
          {
          }

          goto LABEL_34;
        }

LABEL_26:
        summary4 = @"N";
        goto LABEL_27;
      }
    }

    summary3 = @"N";
    if (patchDescriptorCopy)
    {
      goto LABEL_21;
    }

    goto LABEL_26;
  }

  downloadingDescriptorCopy = _MADLog(@"AutoControl");
  if (os_log_type_enabled(downloadingDescriptorCopy, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary5 = [selectorCopy summary];
    *buf = 138544130;
    v51 = _updateLatestSummary2;
    v52 = 2114;
    v53 = descriptorCopy;
    v54 = 2114;
    v55 = summary5;
    v56 = 2114;
    v57 = dCopy;
    _os_log_impl(&dword_0, downloadingDescriptorCopy, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_trackActiveDescriptor} early active-descriptor non-add tracking [before downloading] - not recording to active-job persisted-state for selector:%{public}@ JobUUID:%{public}@", buf, 0x2Au);
  }

LABEL_36:
}

- (void)_logTrackedDescriptors:(id)descriptors forAssetType:(id)type withAssetSpecifier:(id)specifier matchingAssetVersion:(id)version
{
  descriptorsCopy = descriptors;
  typeCopy = type;
  specifierCopy = specifier;
  versionCopy = version;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MAAutoAssetSelector alloc];
  if (specifierCopy && versionCopy)
  {
    v17 = [v16 initForAssetType:typeCopy withAssetSpecifier:specifierCopy matchingAssetVersion:versionCopy];
  }

  else if (specifierCopy)
  {
    v17 = [v16 initForAssetType:typeCopy withAssetSpecifier:specifierCopy];
  }

  else
  {
    v17 = [v16 initForAssetType:typeCopy];
  }

  v18 = v17;
  v19 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:descriptorsCopy assetSelector:v17 limitedToStaging:0];
  v20 = v19;
  v61 = v19;
  v62 = v18;
  if (versionCopy)
  {
    v65 = 0u;
    v66 = 0u;
    v63 = 0u;
    v64 = 0u;
    v21 = v19;
    v22 = [v21 countByEnumeratingWithState:&v63 objects:v87 count:16];
    if (v22)
    {
      v23 = v22;
      selfCopy2 = self;
      v59 = versionCopy;
      v60 = specifierCopy;
      v24 = *v64;
      v25 = @"missing";
      while (2)
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v64 != v24)
          {
            objc_enumerationMutation(v21);
          }

          v27 = *(*(&v63 + 1) + 8 * i);
          v28 = objc_autoreleasePoolPush();
          v29 = [v21 safeObjectForKey:v27 ofClass:objc_opt_class()];
          if (v29)
          {

            objc_autoreleasePoolPop(v28);
            v25 = @"present";
            goto LABEL_47;
          }

          objc_autoreleasePoolPop(v28);
        }

        v23 = [v21 countByEnumeratingWithState:&v63 objects:v87 count:16];
        if (v23)
        {
          continue;
        }

        goto LABEL_47;
      }
    }

    v25 = @"missing";
    goto LABEL_48;
  }

  if (specifierCopy)
  {
    v55 = descriptorsCopy;
    v21 = [[NSMutableString alloc] initWithString:@"versionsOfSpecifier:"];
    v67 = 0u;
    v68 = 0u;
    v69 = 0u;
    v70 = 0u;
    v30 = v20;
    v31 = [v30 countByEnumeratingWithState:&v67 objects:v88 count:16];
    if (v31)
    {
      v32 = v31;
      selfCopy2 = self;
      v59 = 0;
      v60 = specifierCopy;
      v56 = typeCopy;
      v33 = 0;
      v34 = *v68;
      do
      {
        for (j = 0; j != v32; j = j + 1)
        {
          if (*v68 != v34)
          {
            objc_enumerationMutation(v30);
          }

          v36 = *(*(&v67 + 1) + 8 * j);
          v37 = objc_autoreleasePoolPush();
          v38 = [v30 safeObjectForKey:v36 ofClass:objc_opt_class()];
          v39 = v38;
          if (v38)
          {
            assetVersion = [v38 assetVersion];
            v41 = assetVersion;
            if (v33)
            {
              [v21 appendFormat:@", %@", assetVersion];
            }

            else
            {
              [v21 appendString:assetVersion];
            }

            v33 = 1;
          }

          objc_autoreleasePoolPop(v37);
        }

        v32 = [v30 countByEnumeratingWithState:&v67 objects:v88 count:16];
      }

      while (v32);

      if (v33)
      {
        v25 = v21;
      }

      else
      {
        v25 = @"descriptorsOfAssetType(missing)";
      }

      descriptorsCopy = v55;
      typeCopy = v56;
LABEL_47:
      versionCopy = v59;
      specifierCopy = v60;
      self = selfCopy2;
      goto LABEL_48;
    }

    v25 = @"descriptorsOfAssetType(missing)";
LABEL_48:

    goto LABEL_49;
  }

  v57 = typeCopy;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:descriptorsCopy ofContainer:@"locateDownloadedNewAllBySelector"];
  v73 = 0u;
  v74 = 0u;
  v71 = 0u;
  v72 = 0u;
  v42 = v20;
  v43 = [v42 countByEnumeratingWithState:&v71 objects:v89 count:16];
  if (v43)
  {
    v44 = v43;
    v45 = 0;
    v46 = *v72;
    do
    {
      for (k = 0; k != v44; k = k + 1)
      {
        if (*v72 != v46)
        {
          objc_enumerationMutation(v42);
        }

        v48 = *(*(&v71 + 1) + 8 * k);
        v49 = objc_autoreleasePoolPush();
        v50 = [v42 safeObjectForKey:v48 ofClass:objc_opt_class()];
        if (v50)
        {
          ++v45;
        }

        objc_autoreleasePoolPop(v49);
      }

      v44 = [v42 countByEnumeratingWithState:&v71 objects:v89 count:16];
    }

    while (v44);
  }

  else
  {
    v45 = 0;
  }

  v25 = [[NSString alloc] initWithFormat:@"descriptorsOfAssetType:%ld", v45];
  typeCopy = v57;
  versionCopy = 0;
  specifierCopy = 0;
LABEL_49:
  v51 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    *buf = 138544642;
    v53 = @"N";
    v76 = _updateLatestSummary;
    if (specifierCopy)
    {
      v54 = specifierCopy;
    }

    else
    {
      v54 = @"N";
    }

    v77 = 2114;
    if (versionCopy)
    {
      v53 = versionCopy;
    }

    v78 = descriptorsCopy;
    v79 = 2114;
    v80 = typeCopy;
    v81 = 2114;
    v82 = v54;
    v83 = 2114;
    v84 = v53;
    v85 = 2114;
    v86 = v25;
    _os_log_impl(&dword_0, v51, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@:_logTrackedDescriptors} assetType:%{public}@, assetSpecifier:%{public}@, assetVersion:%{public}@ | downloadedBySelector:%{public}@", buf, 0x3Eu);
  }
}

- (BOOL)jobDescriptorOnFilesystemValidated:(id)validated forOSBuild:(id)build
{
  validatedCopy = validated;
  buildCopy = build;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([validatedCopy isOnFilesystem])
  {
    v10 = [MADAutoAssetControlManager localAssetURLForDescriptor:validatedCopy fromLocation:@"jobDescriptorOnFilesystemValidated"];
    if (v10 && [(MADAutoAssetControlManager *)self filesystemDoesFileExist:@"jobDescriptorOnFilesystemValidated" atPath:v10])
    {
      if (!buildCopy || !+[MADAutoAssetSecure isCodeAsset:forDescriptor:](MADAutoAssetSecure, "isCodeAsset:forDescriptor:", @"jobDescriptorOnFilesystemValidated", validatedCopy) || ([validatedCopy wasBuiltForOSBuild:buildCopy] & 1) != 0)
      {
        v11 = 1;
LABEL_13:

        goto LABEL_14;
      }

      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        assetBuild = [validatedCopy assetBuild];
        summary = [validatedCopy summary];
        v17 = 138544386;
        v18 = _updateLatestSummary;
        v19 = 2114;
        v20 = buildCopy;
        v21 = 2114;
        v22 = assetBuild;
        v23 = 2114;
        v24 = summary;
        v25 = 2114;
        v26 = v10;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {jobDescriptorOnFilesystemValidated} SMAC for different OS-build | osBuild:%{public}@ | assetBuild:%{public}@ | jobDescriptor:%{public}@ | localURLForDescriptor:%{public}@", &v17, 0x34u);

        goto LABEL_11;
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        assetBuild = [validatedCopy summary];
        v17 = 138543874;
        v18 = _updateLatestSummary;
        v19 = 2114;
        v20 = assetBuild;
        v21 = 2114;
        v22 = v10;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_ERROR, "[%{public}@] {jobDescriptorOnFilesystemValidated} asset file does not exist | jobDescriptor:%{public}@ | localURLForDescriptor:%{public}@", &v17, 0x20u);
LABEL_11:
      }
    }

    v11 = 0;
    goto LABEL_13;
  }

  v11 = 0;
LABEL_14:

  return v11;
}

+ (BOOL)jobDescriptorOnFilesystemConfirmed:(id)confirmed
{
  confirmedCopy = confirmed;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v16 = 0;
  v17 = &v16;
  v18 = 0x2020000000;
  v19 = 0;
  autoControlManagerFSM = [v4 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v4 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __65__MADAutoAssetControlManager_jobDescriptorOnFilesystemConfirmed___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = confirmedCopy;
    dispatch_sync(extendedStateQueue, block);

    v8 = *(v17 + 24);
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{jobDescriptorOnFilesystemConfirmed} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = *(v17 + 24);
  }

  _Block_object_dispose(&v16, 8);

  return v8 & 1;
}

id __65__MADAutoAssetControlManager_jobDescriptorOnFilesystemConfirmed___block_invoke(uint64_t a1)
{
  result = [*(a1 + 32) jobDescriptorOnFilesystemValidated:*(a1 + 40)];
  *(*(*(a1 + 48) + 8) + 24) = result;
  return result;
}

- (BOOL)jobDescriptorInFlightNowOnFilesystem:(id)filesystem
{
  filesystemCopy = filesystem;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([filesystemCopy isOnFilesystem])
  {
    v7 = [(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:filesystemCopy];
  }

  else if (([filesystemCopy isBlankEntry] & 1) != 0 || (objc_msgSend(filesystemCopy, "assetId"), v8 = objc_claimAutoreleasedReturnValue(), v8, !v8))
  {
    v7 = 0;
  }

  else
  {
    v9 = [MADAutoAssetControlManager localAssetURLForDescriptor:filesystemCopy fromLocation:@"jobDescriptorInFlightNowOnFilesystem"];
    if (v9 && [(MADAutoAssetControlManager *)self filesystemDoesFileExist:@"jobDescriptorInFlightNowOnFilesystem" atPath:v9])
    {
      v7 = 1;
      [filesystemCopy setIsOnFilesystem:1];
    }

    else
    {
      v7 = 0;
    }
  }

  return v7;
}

+ (id)fileManagerFailureErrorString
{
  v2 = __error();
  v3 = *v2;
  v4 = strerror(*v2);
  v5 = @"errno[0](no errror information from fileManager)";
  if (v3)
  {
    v6 = v4;
    v7 = [NSString alloc];
    if (v6)
    {
      v8 = [v7 initWithFormat:@"errno[%d](%@)", v3, @"errno[0](no errror information from fileManager)"];
    }

    else
    {
      v8 = [v7 initWithFormat:@"errno[%d](unknown to strerror)", v3, v10];
    }

    v5 = v8;
  }

  return v5;
}

- (void)_eliminatePromotedNeverLocked:(id)locked forAssetSelector:(id)selector
{
  lockedCopy = locked;
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v62 = objc_alloc_init(NSMutableArray);
  v9 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_eliminatePromotedNeverLocked" assetSelector:selectorCopy limitedToStaging:0];
  v10 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    v12 = [v9 count];
    summary = [selectorCopy summary];
    *buf = 138543874;
    v79 = _updateLatestSummary;
    v80 = 2048;
    v81 = v12;
    v82 = 2114;
    v83 = summary;
    _os_log_impl(&dword_0, v10, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} reviewing all downloadedDescriptorsBySelector(%ld) | eliminateSelector:%{public}@", buf, 0x20u);
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_eliminatePromotedNeverLocked" ofContainer:@"locateDownloadedNewAllBySelector"];
  v74 = 0u;
  v75 = 0u;
  v72 = 0u;
  v73 = 0u;
  v14 = v9;
  v15 = [v14 countByEnumeratingWithState:&v72 objects:v77 count:16];
  v63 = selectorCopy;
  v64 = v14;
  if (v15)
  {
    v16 = v15;
    obj = *v73;
    do
    {
      for (i = 0; i != v16; i = i + 1)
      {
        if (*v73 != obj)
        {
          objc_enumerationMutation(v14);
        }

        v18 = *(*(&v72 + 1) + 8 * i);
        v19 = objc_autoreleasePoolPush();
        v20 = [v14 safeObjectForKey:v18 ofClass:objc_opt_class()];
        v21 = v20;
        if (v20)
        {
          assetType = [v20 assetType];
          assetSpecifier = [v21 assetSpecifier];
          v24 = [(MADAutoAssetControlManager *)self _doesEliminateSelector:selectorCopy matchAssetType:assetType withAssetSpecifier:assetSpecifier withAssetVersion:0 fromLocation:@"_eliminatePromotedNeverLocked"];

          if (v24 && [v21 stagedPriorToAvailable] && objc_msgSend(v21, "neverBeenLocked"))
          {
            v25 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary2 = [selectorCopy summary];
              summary3 = [v21 summary];
              *buf = 138543874;
              v79 = _updateLatestSummary2;
              v80 = 2114;
              v81 = summary2;
              v82 = 2114;
              v83 = summary3;
              _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} will eliminate | eliminateSelector:%{public}@, downloadedDescriptor:%{public}@", buf, 0x20u);

              v14 = v64;
            }

            [v62 addObject:v21];
          }

          else
          {
            v29 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              summary4 = [selectorCopy summary];
              summary5 = [v21 summary];
              *buf = 138543874;
              v79 = _updateLatestSummary3;
              v80 = 2114;
              v81 = summary4;
              v82 = 2114;
              v83 = summary5;
              _os_log_impl(&dword_0, v29, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminatePromotedNeverLocked} will not eliminate | eliminateSelector:%{public}@, downloadedDescriptor:%{public}@", buf, 0x20u);

              v14 = v64;
            }
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v35 = [NSString alloc];
          _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v37 = v35;
          v14 = v64;
          v38 = [v37 initWithFormat:@"{_eliminatePromotedNeverLocked} nil downloadedDescriptor on downloadedDescriptorsBySelector for jobSelectorKey:%@ | %@", v18, _updateLatestSummary4];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v38 withResult:6103 withError:0];

          selectorCopy = v63;
        }

        objc_autoreleasePoolPop(v19);
      }

      v16 = [v14 countByEnumeratingWithState:&v72 objects:v77 count:16];
    }

    while (v16);
  }

  v70 = 0u;
  v71 = 0u;
  v68 = 0u;
  v69 = 0u;
  obja = v62;
  v39 = [obja countByEnumeratingWithState:&v68 objects:v76 count:16];
  if (v39)
  {
    v40 = v39;
    v41 = *v69;
    do
    {
      for (j = 0; j != v40; j = j + 1)
      {
        if (*v69 != v41)
        {
          objc_enumerationMutation(obja);
        }

        v43 = *(*(&v68 + 1) + 8 * j);
        v44 = objc_autoreleasePoolPush();
        v45 = [(MADAutoAssetControlManager *)self clientRequestMessageInstance:lockedCopy];
        autoAssetClientName = [v45 autoAssetClientName];
        if (autoAssetClientName)
        {
          [v45 autoAssetClientName];
        }

        else
        {
          [v45 clientProcessName];
        }
        v47 = ;

        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"_eliminatePromotedNeverLocked" droppingDescriptor:v43 forHistoryOperation:301 firstClientName:v47];
        objc_autoreleasePoolPop(v44);
      }

      v40 = [obja countByEnumeratingWithState:&v68 objects:v76 count:16];
    }

    while (v40);
  }

  clientRequest = [lockedCopy clientRequest];
  clientReplyCompletion = [clientRequest clientReplyCompletion];

  if (clientReplyCompletion)
  {
    clientRequest2 = [lockedCopy clientRequest];
    clientRequestMessage = [clientRequest2 clientRequestMessage];
    v52 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage];
    clientRequest3 = [lockedCopy clientRequest];
    clientRequestMessage2 = [clientRequest3 clientRequestMessage];
    clientID = [clientRequestMessage2 clientID];
    autoControlManagerFSM3 = [MADAutoAssetControlManager createSeverMessageWithName:v52 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:0];

    clientRequest4 = [lockedCopy clientRequest];
    [(MADAutoAssetControlManager *)self issueResponseToClientRequest:clientRequest4 issuingResponseMessage:autoControlManagerFSM3 withResponseError:0];
    v58 = v63;
  }

  else
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    clientRequest4 = [autoControlManagerFSM3 diag];
    v59 = [NSString alloc];
    v58 = v63;
    summary6 = [v63 summary];
    v61 = [v59 initWithFormat:@"{_eliminatePromotedNeverLocked} no client reply completion | eliminateSelector:%@", summary6];
    [clientRequest4 trackAnomaly:@"AUTO-CONTROL" forReason:v61 withResult:6111 withError:0];
  }
}

- (void)_eliminateBegin:(id)begin forAssetSelector:(id)selector limitingToActivity:(BOOL)activity fromLocation:(id)location
{
  activityCopy = activity;
  beginCopy = begin;
  selectorCopy = selector;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_eliminateBegin", locationCopy];
  activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v128 = selectorCopy;
  persistedEntryID = [selectorCopy persistedEntryID];
  v18 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

  if (v18)
  {
    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:beginCopy withErrorCode:6113 fromAction:@"_eliminateBegin" withDescription:@"already performing eliminate operation for the specified asset-selector"];

LABEL_3:
    v19 = v128;
    goto LABEL_100;
  }

  v20 = [MADAutoAssetEliminate alloc];
  clientRequest = [beginCopy clientRequest];
  v22 = [(MADAutoAssetEliminate *)v20 initWithClientRequest:clientRequest];

  if (!v22)
  {
    if (activityCopy)
    {
      v43 = @"handleClientCancelActivityForSelectorRequest";
    }

    else
    {
      v43 = @"handleClientEliminateAllForSelectorRequest";
    }

    [(MADAutoAssetControlManager *)self issueResponseForEventInfo:beginCopy withErrorCode:6101 fromAction:v43 withDescription:@"unable to allocate eliminate operation tracking entry"];
    goto LABEL_3;
  }

  v19 = v128;
  v131 = locationCopy;
  selfCopy = self;
  v121 = v22;
  v119 = locationCopy;
  v120 = beginCopy;
  v118 = activityCopy;
  if (activityCopy)
  {
    goto LABEL_68;
  }

  v23 = [MADAutoAssetLocker lockedSelectorsForEliminate:v128];
  v24 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary = [(MADAutoAssetEliminate *)v22 summary];
    *buf = 138543874;
    v154 = _updateLatestSummary;
    v155 = 2114;
    v156 = summary;
    v157 = 2048;
    v158 = [v23 count];
    _os_log_impl(&dword_0, v24, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminateBegin} | eliminateTracker:%{public}@, lockedEliminateSelectors:%ld", buf, 0x20u);
  }

  v147 = 0u;
  v148 = 0u;
  v145 = 0u;
  v146 = 0u;
  v27 = v23;
  v28 = [v27 countByEnumeratingWithState:&v145 objects:v152 count:16];
  if (v28)
  {
    v29 = v28;
    v30 = *v146;
    do
    {
      for (i = 0; i != v29; i = i + 1)
      {
        if (*v146 != v30)
        {
          objc_enumerationMutation(v27);
        }

        v32 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v145 + 1) + 8 * i)];
        if ([v32 secureOperationInProgress])
        {
          [v32 setSecureOperationEliminating:1];
          [(MADAutoAssetEliminate *)v22 setAwaitingSecureOperations:[(MADAutoAssetEliminate *)v22 awaitingSecureOperations]+ 1];
        }

        else
        {
          [(MADAutoAssetControlManager *)self secureForceUngraft:locationCopy forDescriptorBeingRemoved:v32];
          if ([v32 secureOperationEliminating])
          {
            [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:locationCopy forAutoAssetDescriptor:v32 failingClientRequestForEventInfo:0];
          }
        }
      }

      v29 = [v27 countByEnumeratingWithState:&v145 objects:v152 count:16];
    }

    while (v29);
  }

  v143 = 0u;
  v144 = 0u;
  v141 = 0u;
  v142 = 0u;
  obj = v27;
  v33 = [obj countByEnumeratingWithState:&v141 objects:v151 count:16];
  if (v33)
  {
    v34 = v33;
    v35 = *v142;
    do
    {
      for (j = 0; j != v34; j = j + 1)
      {
        if (*v142 != v35)
        {
          objc_enumerationMutation(obj);
        }

        v37 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:*(*(&v141 + 1) + 8 * j)];
        if ([v37 secureOperationInProgress])
        {
          [v37 setSecureOperationEliminating:1];
          [(MADAutoAssetEliminate *)v22 setAwaitingSecureOperations:[(MADAutoAssetEliminate *)v22 awaitingSecureOperations]+ 1];
        }

        else
        {
          [(MADAutoAssetControlManager *)self secureForceUngraft:locationCopy forDescriptorBeingRemoved:v37];
          if ([v37 secureOperationEliminating])
          {
            [(MADAutoAssetControlManager *)self eliminateUngraftDescriptor:locationCopy forAutoAssetDescriptor:v37 failingClientRequestForEventInfo:0];
          }
        }
      }

      v34 = [obj countByEnumeratingWithState:&v141 objects:v151 count:16];
    }

    while (v34);
  }

  v19 = v128;
  assetType = [v128 assetType];

  if (assetType)
  {
    assetSpecifier = [v128 assetSpecifier];

    persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    persistedKnownDescriptors2 = persistedKnownDescriptors;
    if (!assetSpecifier)
    {
      assetType2 = [v128 assetType];
      v44 = [persistedKnownDescriptors2 persistedEntryIDs:@"_eliminateBegin" assetType:assetType2];

      goto LABEL_40;
    }

    v42 = [persistedKnownDescriptors persistedEntryIDs:@"_eliminateBegin" assetSelector:v128];
  }

  else
  {
    persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v42 = [persistedKnownDescriptors2 persistedEntryIDs:@"_eliminateBegin"];
  }

  v44 = v42;
LABEL_40:

  if (![v44 count])
  {
    goto LABEL_63;
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"persistedKnownDescriptors"];
  v139 = 0u;
  v140 = 0u;
  v137 = 0u;
  v138 = 0u;
  v117 = v44;
  v125 = v44;
  v46 = [v125 countByEnumeratingWithState:&v137 objects:v150 count:16];
  if (!v46)
  {
    goto LABEL_62;
  }

  v47 = v46;
  v48 = *v138;
  v122 = *v138;
  do
  {
    v49 = 0;
    v123 = v47;
    do
    {
      if (*v138 != v48)
      {
        objc_enumerationMutation(v125);
      }

      v50 = *(*(&v137 + 1) + 8 * v49);
      v51 = objc_autoreleasePoolPush();
      persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v53 = [persistedKnownDescriptors3 persistedEntry:v50 fromLocation:locationCopy];

      if (v53)
      {
        persistedKnownDescriptors4 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v55 = [persistedKnownDescriptors4 decodeFromLocation:locationCopy ofEntryName:v50 fromPersistedEntry:v53 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (!v55)
        {
          goto LABEL_60;
        }

        assetType3 = [v55 assetType];
        [v55 assetSpecifier];
        v58 = v57 = self;
        assetVersion = [v55 assetVersion];
        if ([(MADAutoAssetControlManager *)v57 _doesEliminateSelector:v128 matchAssetType:assetType3 withAssetSpecifier:v58 withAssetVersion:assetVersion fromLocation:locationCopy])
        {
          v60 = [MADAutoAssetSecure isGraftedOrMounted:locationCopy forDescriptor:v55];

          if (!v60)
          {
            self = selfCopy;
            v48 = v122;
            v47 = v123;
            goto LABEL_60;
          }

          [v55 setSecureOperationInProgress:1];
          v136 = 0;
          [MADAutoAssetSecure ungraft:locationCopy forDescriptor:v55 ungraftingError:&v136];
          assetType3 = v136;
          [v55 setSecureOperationInProgress:0];
          v61 = _MADLog(@"AutoControl");
          v58 = v61;
          if (assetType3)
          {
            if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
            {
              assetVersion = [v55 summary];
              checkedDescription = [assetType3 checkedDescription];
              *buf = 138543874;
              v154 = v131;
              v155 = 2114;
              v156 = assetVersion;
              v157 = 2114;
              v158 = checkedDescription;
              _os_log_impl(&dword_0, v58, OS_LOG_TYPE_ERROR, "\n[ELIMINATE] {%{public}@} ungraft|unmount failure | downloadedDescriptor:%{public}@ | ungraftError:%{public}@", buf, 0x20u);

              goto LABEL_58;
            }

LABEL_59:
            v48 = v122;
            v47 = v123;

            locationCopy = v131;
            self = selfCopy;
            goto LABEL_60;
          }

          if (!os_log_type_enabled(v61, OS_LOG_TYPE_DEFAULT))
          {
            goto LABEL_59;
          }

          assetVersion = [v55 summary];
          *buf = 138543618;
          v154 = v131;
          v155 = 2114;
          v156 = assetVersion;
          _os_log_impl(&dword_0, v58, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {%{public}@} ungrafted|unmounted | downloadedDescriptor:%{public}@", buf, 0x16u);
        }

LABEL_58:

        goto LABEL_59;
      }

      v55 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v55, OS_LOG_TYPE_ERROR))
      {
        *buf = 138543618;
        v154 = locationCopy;
        v155 = 2114;
        v156 = v50;
        _os_log_impl(&dword_0, v55, OS_LOG_TYPE_ERROR, "\n[CONSIDER-ELIMINATE] {%{public}@} unable to access asset-descriptor | entryID:%{public}@", buf, 0x16u);
      }

LABEL_60:

      objc_autoreleasePoolPop(v51);
      v49 = v49 + 1;
    }

    while (v47 != v49);
    v47 = [v125 countByEnumeratingWithState:&v137 objects:v150 count:16];
  }

  while (v47);
LABEL_62:

  v19 = v128;
  v22 = v121;
  v44 = v117;
LABEL_63:
  [(MADAutoAssetControlManager *)self forceGlobalUnlockFromLocation:locationCopy dueToError:0 fullAssetSelector:v19 historyOperationAI:1500 historyOperationSD:392];
  [(MADAutoAssetControlManager *)self _removeAllContentForEliminateTracker:v22 unlessCurrentlyLocked:0];
  assetVersion2 = [v19 assetVersion];

  if (!assetVersion2)
  {
    [(MADAutoAssetEliminate *)v22 setAwaitingSchedulerAck:1];
    persistedEntryID2 = [v19 persistedEntryID];
    [MADAutoAssetScheduler controlEliminateSelector:v19];
    if (persistedEntryID2)
    {
      alreadyScheduledSelectors = [(MADAutoAssetControlManager *)self alreadyScheduledSelectors];
      [alreadyScheduledSelectors removeObjectForKey:persistedEntryID2];
    }
  }

LABEL_68:
  v66 = [MAAutoAssetSelector alloc];
  assetType4 = [v19 assetType];
  assetSpecifier2 = [v19 assetSpecifier];
  v126 = [v66 initForAssetType:assetType4 withAssetSpecifier:assetSpecifier2];

  currentJobsBySelector = [(MADAutoAssetControlManager *)self currentJobsBySelector];
  v70 = [currentJobsBySelector copy];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"currentJobsBySelector"];
  v134 = 0u;
  v135 = 0u;
  v132 = 0u;
  v133 = 0u;
  v71 = v70;
  v72 = [v71 countByEnumeratingWithState:&v132 objects:v149 count:16];
  obja = v71;
  if (!v72)
  {
    goto LABEL_86;
  }

  v73 = v72;
  v74 = *v133;
  while (2)
  {
    v75 = 0;
    while (2)
    {
      if (*v133 != v74)
      {
        objc_enumerationMutation(v71);
      }

      v76 = *(*(&v132 + 1) + 8 * v75);
      v77 = objc_autoreleasePoolPush();
      v78 = [v71 safeObjectForKey:v76 ofClass:objc_opt_class()];
      v79 = v78;
      if (v78 && ([v78 autoAssetSetJob] & 1) == 0)
      {
        autoAssetSelector = [v79 autoAssetSelector];
        assetType5 = [autoAssetSelector assetType];
        assetType6 = [v19 assetType];
        v83 = [SUCore stringIsEqual:assetType5 to:assetType6];

        if (v83)
        {
          assetSpecifier3 = [v19 assetSpecifier];
          if (!assetSpecifier3 || (v85 = assetSpecifier3, [v79 autoAssetSelector], v86 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v86, "assetSpecifier"), v87 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v19, "assetSpecifier"), v88 = objc_claimAutoreleasedReturnValue(), v89 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v87, v88), v88, v19 = v128, v87, v86, v85, v89))
          {
            assetVersion3 = [v19 assetVersion];
            v91 = v19;
            if (!assetVersion3 || (v92 = assetVersion3, [v79 autoAssetSelector], v93 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v93, "assetVersion"), v94 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v91, "assetVersion"), v95 = v74, v96 = v91, v97 = objc_claimAutoreleasedReturnValue(), v124 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v94, v97), v97, v91 = v96, v74 = v95, v94, v93, v92, v124))
            {
              activeJobsByUUID = [(MADAutoAssetEliminate *)v121 activeJobsByUUID];
              autoAssetUUID = [v79 autoAssetUUID];
              autoAssetUUID2 = [v79 autoAssetUUID];
              [activeJobsByUUID setSafeObject:autoAssetUUID forKey:autoAssetUUID2];

              locationCopy = v131;
              [(MADAutoAssetControlManager *)selfCopy removeActiveJobForFullSelector:v131 removingFullSelector:v91 alsoRemovingNoVersionSelector:v126];

              [v79 setBeingCanceled:1];
              [v79 cancelAutoAssetJob];
              v126 = 0;
              v19 = v91;
              goto LABEL_83;
            }

            v19 = v91;
          }
        }

        locationCopy = v131;
LABEL_83:
        v71 = obja;
      }

      objc_autoreleasePoolPop(v77);
      if (v73 != ++v75)
      {
        continue;
      }

      break;
    }

    v73 = [v71 countByEnumeratingWithState:&v132 objects:v149 count:16];
    if (v73)
    {
      continue;
    }

    break;
  }

LABEL_86:

  if (v126)
  {
    [(MADAutoAssetControlManager *)selfCopy removeActiveJobForFullSelector:locationCopy removingFullSelector:0 alsoRemovingNoVersionSelector:?];
  }

  if (v118)
  {
    v101 = [[MADAutoAssetControlManagerParam alloc] initForAssetSelector:v19];
    [(MADAutoAssetEliminate *)v121 setAwaitingCancelActivityAck:1];
    [(MADAutoAssetEliminate *)v121 setLimitedToCancelActivity:1];
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    [autoControlManagerFSM2 postEvent:@"CancelActivityAck" withInfo:v101];
  }

  else
  {
    [(MADAutoAssetEliminate *)v121 setAwaitingStagerAck:1];
    [(MADAutoAssetControlManager *)selfCopy ensureStagerFullyResumed];
    [MADAutoAssetStager controlEliminateSelector:v19];
  }

  locationCopy = v119;
  if ([(MADAutoAssetEliminate *)v121 eliminatingSet])
  {
    autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    diag = [autoControlManagerFSM3 diag];
    v105 = [NSString alloc];
    summary2 = [(MADAutoAssetEliminate *)v121 summary];
    v106 = [v105 initWithFormat:@"{_eliminateBegin} called for set eliminateTracker:%@", summary2];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v106 withResult:6103 withError:0];

    v19 = v128;
    v108 = obja;
    goto LABEL_96;
  }

  assetSelector = [(MADAutoAssetEliminate *)v121 assetSelector];
  autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy jobSelectorKey:assetSelector];

  v108 = obja;
  if (autoControlManagerFSM3)
  {
    currentStatusBySelector = [(MADAutoAssetControlManager *)selfCopy currentStatusBySelector];
    [currentStatusBySelector removeObjectForKey:autoControlManagerFSM3];

    diag = _MADLog(@"AutoControl");
    if (os_log_type_enabled(diag, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
      *buf = 138543618;
      v154 = _updateLatestSummary2;
      v155 = 2114;
      v156 = autoControlManagerFSM3;
      _os_log_impl(&dword_0, diag, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][REMOVED] | eliminateSelectorKey:%{public}@", buf, 0x16u);
    }

LABEL_96:
  }

  activelyEliminatingSelectors2 = [(MADAutoAssetControlManager *)selfCopy activelyEliminatingSelectors];
  persistedEntryID3 = [v19 persistedEntryID];
  [activelyEliminatingSelectors2 setSafeObject:v121 forKey:persistedEntryID3];

  v114 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v114, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    summary3 = [(MADAutoAssetEliminate *)v121 summary];
    *buf = 138543618;
    v154 = _updateLatestSummary3;
    v155 = 2114;
    v156 = summary3;
    _os_log_impl(&dword_0, v114, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_eliminateBegin} all elimination operations in progress | eliminateTracker:%{public}@", buf, 0x16u);
  }

  beginCopy = v120;
LABEL_100:
}

- (void)_removeAllContentForEliminateTracker:(id)tracker unlessCurrentlyLocked:(id)locked
{
  trackerCopy = tracker;
  lockedCopy = locked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v98 = objc_alloc_init(NSMutableArray);
  v103 = trackerCopy;
  assetSelector = [trackerCopy assetSelector];
  v10 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_removeAllContentForEliminateTracker" assetSelector:assetSelector limitedToStaging:0];
  selfCopy = self;
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeAllContentForEliminateTracker" ofContainer:@"locateDownloadedNewAllBySelector"];
  v134 = 0u;
  v135 = 0u;
  v132 = 0u;
  v133 = 0u;
  obj = v10;
  v109 = assetSelector;
  v104 = [obj countByEnumeratingWithState:&v132 objects:v151 count:16];
  if (v104)
  {
    v101 = 0;
    v11 = *v133;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v99 = *v133;
    while (1)
    {
      v13 = 0;
      do
      {
        if (*v133 != v11)
        {
          objc_enumerationMutation(obj);
        }

        v108 = v13;
        v14 = *(*(&v132 + 1) + 8 * v13);
        context = objc_autoreleasePoolPush();
        v15 = [obj safeObjectForKey:v14 ofClass:objc_opt_class()];
        v16 = v15;
        if (v15)
        {
          assetType = [v15 assetType];
          assetSpecifier = [v16 assetSpecifier];
          assetVersion = [v16 assetVersion];
          v20 = [(MADAutoAssetControlManager *)selfCopy _doesEliminateSelector:assetSelector matchAssetType:assetType withAssetSpecifier:assetSpecifier withAssetVersion:assetVersion fromLocation:@"_removeAllContentForEliminateTracker"];

          if (lockedCopy && v20)
          {
            v130 = 0u;
            v131 = 0u;
            v128 = 0u;
            v129 = 0u;
            v111 = lockedCopy;
            v116 = [v111 countByEnumeratingWithState:&v128 objects:v150 count:16];
            if (!v116)
            {
              goto LABEL_24;
            }

            v114 = *v129;
            while (1)
            {
              for (i = 0; i != v116; i = i + 1)
              {
                if (*v129 != v114)
                {
                  objc_enumerationMutation(v111);
                }

                v22 = *(*(&v128 + 1) + 8 * i);
                v23 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  summary = [v16 summary];
                  [assetSelector summary];
                  v27 = v26 = p_weak_ivar_lyt;
                  summary2 = [v22 summary];
                  *buf = 138544130;
                  v138 = _updateLatestSummary;
                  v139 = 2112;
                  v140 = summary;
                  v141 = 2114;
                  v142 = v27;
                  v143 = 2114;
                  v144 = summary2;
                  _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} considering whether elimination blocked by lock | downloadedDescriptor:%{oublic}@, eliminateSelector:%{public}@, lockedSelector:%{public}@", buf, 0x2Au);

                  p_weak_ivar_lyt = v26;
                }

                v29 = p_weak_ivar_lyt[223];
                assetType2 = [v16 assetType];
                assetType3 = [v22 assetType];
                if (![v29 stringIsEqual:assetType2 to:assetType3])
                {
                  goto LABEL_21;
                }

                v32 = p_weak_ivar_lyt[223];
                assetSpecifier2 = [v16 assetSpecifier];
                [v22 assetSpecifier];
                v35 = v34 = p_weak_ivar_lyt;
                if (![v32 stringIsEqual:assetSpecifier2 to:v35])
                {

                  p_weak_ivar_lyt = v34;
LABEL_21:

                  continue;
                }

                v36 = v34[223];
                assetVersion2 = [v16 assetVersion];
                assetVersion3 = [v22 assetVersion];
                LODWORD(v36) = [v36 stringIsEqual:assetVersion2 to:assetVersion3];

                assetSelector = v109;
                p_weak_ivar_lyt = v34;
                if (v36)
                {
                  ++v101;

                  v11 = v99;
                  goto LABEL_28;
                }
              }

              v116 = [v111 countByEnumeratingWithState:&v128 objects:v150 count:16];
              if (!v116)
              {
LABEL_24:

                v11 = v99;
                goto LABEL_27;
              }
            }
          }

          if (v20)
          {
LABEL_27:
            [v98 addObject:v16];
          }
        }

        else
        {
          autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
          diag = [autoControlManagerFSM2 diag];
          v41 = [NSString alloc];
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v43 = [v41 initWithFormat:@"{_removeAllContentForEliminateTracker} nil downloadedDescriptor on downloadedDescriptorsBySelector for jobSelectorKey:%@ | %@", v14, _updateLatestSummary2];
          [diag trackAnomaly:@"AUTO-CONTROL" forReason:v43 withResult:6103 withError:0];
        }

LABEL_28:

        objc_autoreleasePoolPop(context);
        v13 = v108 + 1;
      }

      while ((v108 + 1) != v104);
      v104 = [obj countByEnumeratingWithState:&v132 objects:v151 count:16];
      if (!v104)
      {
        goto LABEL_32;
      }
    }
  }

  v101 = 0;
LABEL_32:

  v127 = 0u;
  v125 = 0u;
  v126 = 0u;
  v124 = 0u;
  v117 = v98;
  v44 = [v117 countByEnumeratingWithState:&v124 objects:v149 count:16];
  v45 = v103;
  if (v44)
  {
    v46 = v44;
    v47 = *v125;
    do
    {
      for (j = 0; j != v46; j = j + 1)
      {
        if (*v125 != v47)
        {
          objc_enumerationMutation(v117);
        }

        v49 = *(*(&v124 + 1) + 8 * j);
        v50 = objc_autoreleasePoolPush();
        clientRequest = [v45 clientRequest];
        clientRequestMessage = [clientRequest clientRequestMessage];

        message = [clientRequestMessage message];
        v54 = [message safeObjectForKey:@"instance" ofClass:objc_opt_class()];
        autoAssetClientName = [v54 autoAssetClientName];
        if (autoAssetClientName)
        {
          [v54 autoAssetClientName];
        }

        else
        {
          [v54 clientProcessName];
        }
        v56 = ;

        [(MADAutoAssetControlManager *)selfCopy _removeDescriptorFromFilesystem:@"_removeAllContentForEliminateTracker" droppingDescriptor:v49 forHistoryOperation:300 firstClientName:v56];
        objc_autoreleasePoolPop(v50);
        v45 = v103;
      }

      v46 = [v117 countByEnumeratingWithState:&v124 objects:v149 count:16];
    }

    while (v46);
  }

  v57 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
    v59 = [obj count];
    v60 = [v117 count];
    summary3 = [v45 summary];
    v62 = [lockedCopy count];
    *buf = 138544642;
    v138 = _updateLatestSummary3;
    v139 = 2048;
    v140 = v59;
    v141 = 2048;
    v142 = v60;
    v143 = 2048;
    v144 = v101;
    v145 = 2114;
    v146 = summary3;
    v147 = 2048;
    v148 = v62;
    _os_log_impl(&dword_0, v57, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} reviewed all downloadedDescriptorsBySelector(%ld) | removeDescriptors:%ld | notRemovedStillLocked:%ld | eliminateTracker:%{public}@, lockedEliminateSelectors:%ld", buf, 0x3Eu);
  }

  assetSelector2 = [v45 assetSelector];
  assetSpecifier3 = [assetSelector2 assetSpecifier];

  v65 = v109;
  if (!assetSpecifier3)
  {
    if ([lockedCopy count])
    {
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      diag2 = [autoControlManagerFSM3 diag];
      path = [[NSString alloc] initWithFormat:@"{_removeAllContentForEliminateTracker} still have locked selectors | lockedEliminateSelectors:%ld", objc_msgSend(lockedCopy, "count")];
      [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:path withResult:6109 withError:0];
LABEL_76:

      goto LABEL_77;
    }

    assetType4 = [v109 assetType];
    autoControlManagerFSM3 = getAutoLocalUrlFromTypeWithPurpose(assetType4, 2, @"auto");

    if (autoControlManagerFSM3)
    {
      diag2 = +[NSFileManager defaultManager];
      path = [autoControlManagerFSM3 path];
      v70 = +[NSFileManager defaultManager];
      v71 = [v70 fileExistsAtPath:path];

      if (!v71)
      {
        goto LABEL_76;
      }

      v123 = 0;
      autoControlManagerFSM6 = diag2;
      v72 = [diag2 contentsOfDirectoryAtPath:path error:&v123];
      summary7 = v123;
      v74 = path;
      v115 = path;
      if (summary7)
      {
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        diag3 = [autoControlManagerFSM4 diag];
        v77 = [NSString alloc];
        summary4 = [v45 summary];
        v79 = [v77 initWithFormat:@"{_removeAllContentForEliminateTracker} unable to get repo directory | eliminateTracker:%@ | assetDirectory:%@", summary4, path];
        [diag3 trackAnomaly:@"AUTO-CONTROL" forReason:v79 withResult:6101 withError:summary7];

        goto LABEL_74;
      }

      v121 = 0u;
      v122 = 0u;
      v119 = 0u;
      v120 = 0u;
      autoControlManagerFSM4 = v72;
      v82 = [autoControlManagerFSM4 countByEnumeratingWithState:&v119 objects:v136 count:16];
      if (v82)
      {
        v83 = v82;
        v100 = v72;
        v105 = autoControlManagerFSM3;
        v84 = *v120;
        v85 = autoControlManagerFSM6;
        v112 = autoControlManagerFSM4;
        while (1)
        {
          for (k = 0; k != v83; k = k + 1)
          {
            if (*v120 != v84)
            {
              objc_enumerationMutation(v112);
            }

            v87 = [v74 stringByAppendingPathComponent:*(*(&v119 + 1) + 8 * k)];
            if (!v87)
            {
              autoControlManagerFSM5 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
              diag4 = [autoControlManagerFSM5 diag];
              v90 = [[NSString alloc] initWithFormat:@"{_removeAllContentForEliminateTracker} unable to determine local repository path for assetDirectory:%@", v74];
              [diag4 trackAnomaly:@"AUTO-CONTROL" forReason:v90 withResult:6101 withError:0];
              goto LABEL_71;
            }

            diag4 = [[NSURL alloc] initFileURLWithPath:v87];
            if ([diag4 hasDirectoryPath])
            {
              v89 = getControlManager();
              v90 = [v89 getSAFRegistrationBundleID:diag4];

              v74 = v115;
            }

            else
            {
              v90 = 0;
            }

            v118 = 0;
            [v85 removeItemAtPath:v87 error:&v118];
            autoControlManagerFSM5 = v118;
            v92 = _MADLog(@"AutoControl");
            v93 = v92;
            if (autoControlManagerFSM5)
            {
              if (os_log_type_enabled(v92, OS_LOG_TYPE_ERROR))
              {
                _updateLatestSummary4 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                summary5 = [v103 summary];
                *buf = 138544130;
                v138 = _updateLatestSummary4;
                v139 = 2114;
                v140 = summary5;
                v141 = 2114;
                v142 = v87;
                v143 = 2114;
                v144 = autoControlManagerFSM5;
                _os_log_impl(&dword_0, v93, OS_LOG_TYPE_ERROR, "[%{public}@] {_removeAllContentForEliminateTracker} unable to remove repo entry (after eliminate-all-for-asset-type) | eliminateTracker:%{public}@ | filename:%{public}@ | error:%{public}@", buf, 0x2Au);

                v85 = autoControlManagerFSM6;
                v74 = v115;
              }
            }

            else
            {
              if (os_log_type_enabled(v92, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary5 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                summary6 = [v103 summary];
                *buf = 138543874;
                v138 = _updateLatestSummary5;
                v139 = 2114;
                v140 = summary6;
                v141 = 2114;
                v142 = v87;
                _os_log_impl(&dword_0, v93, OS_LOG_TYPE_DEFAULT, "[%{public}@] {_removeAllContentForEliminateTracker} removed repo entry (after eliminate-all-for-asset-type) | eliminateTracker:%{public}@ | removed:%{public}@", buf, 0x20u);

                v85 = autoControlManagerFSM6;
                v74 = v115;
              }

              if (!v90)
              {
                goto LABEL_70;
              }

              v93 = getControlManager();
              [v93 updateSpaceAttributionForBundleID:v90 assetPath:diag4 doRegistration:0];
            }

LABEL_70:
            v45 = v103;
LABEL_71:

            v65 = v109;
          }

          autoControlManagerFSM4 = v112;
          v83 = [v112 countByEnumeratingWithState:&v119 objects:v136 count:16];
          if (!v83)
          {
            autoControlManagerFSM3 = v105;
            v72 = v100;
            summary7 = 0;
            break;
          }
        }
      }

LABEL_74:
    }

    else
    {
      autoControlManagerFSM6 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
      diag5 = [autoControlManagerFSM6 diag];
      v81 = [NSString alloc];
      summary7 = [v45 summary];
      v72 = [v81 initWithFormat:@"{_removeAllContentForEliminateTracker} no assetTypeRepoLocation | eliminateTracker:%@", summary7];
      v115 = diag5;
      [diag5 trackAnomaly:@"AUTO-CONTROL" forReason:v72 withResult:6101 withError:0];
    }

    diag2 = autoControlManagerFSM6;
    path = v115;
    goto LABEL_76;
  }

LABEL_77:
}

- (void)_removeUnlockedForOlderSelectorsWithoutVersion:(id)version
{
  versionCopy = version;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([versionCopy foundByLookupWithoutAssetVersion])
  {
    v44 = +[MADAutoAssetLocker copyOfLocksBySelector];
    v7 = [SUCoreRestoreVersion alloc];
    assetVersion = [versionCopy assetVersion];
    v48 = [v7 initWithRestoreVersion:assetVersion];

    v43 = objc_alloc_init(NSMutableArray);
    v9 = [MAAutoAssetSelector alloc];
    assetType = [versionCopy assetType];
    assetSpecifier = [versionCopy assetSpecifier];
    v12 = [v9 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

    v42 = v12;
    v13 = [(MADAutoAssetControlManager *)self locateDownloadedNewForSelector:@"_removeUnlockedForOlderSelectorsWithoutVersion" assetSelector:v12 limitedToStaging:0];
    selfCopy = self;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_removeUnlockedForOlderSelectorsWithoutVersion" ofContainer:@"locateDownloadedNewAllBySelector"];
    v56 = 0u;
    v57 = 0u;
    v54 = 0u;
    v55 = 0u;
    v14 = v13;
    v15 = [v14 countByEnumeratingWithState:&v54 objects:v59 count:16];
    v45 = versionCopy;
    if (v15)
    {
      v16 = v15;
      v17 = *v55;
      do
      {
        for (i = 0; i != v16; i = i + 1)
        {
          if (*v55 != v17)
          {
            objc_enumerationMutation(v14);
          }

          v19 = *(*(&v54 + 1) + 8 * i);
          v20 = objc_autoreleasePoolPush();
          v21 = [v14 safeObjectForKey:v19 ofClass:objc_opt_class()];
          v22 = v21;
          if (v21)
          {
            assetVersion2 = [v21 assetVersion];
            assetVersion3 = [versionCopy assetVersion];
            v25 = [SUCore stringIsEqual:assetVersion2 to:assetVersion3];

            if ((v25 & 1) == 0 && ![(MADAutoAssetControlManager *)selfCopy _isDownloadedDescriptorPartOfLatestToVend:v22 fromLocation:@"_removeUnlockedForOlderSelectorsWithoutVersion"])
            {
              v26 = [SUCoreRestoreVersion alloc];
              assetVersion4 = [v22 assetVersion];
              v28 = [v26 initWithRestoreVersion:assetVersion4];

              if ([v28 isComparable:v48] && objc_msgSend(v48, "compare:", v28) == &dword_0 + 1)
              {
                v47 = [MAAutoAssetSelector alloc];
                assetType2 = [v22 assetType];
                assetSpecifier2 = [v22 assetSpecifier];
                assetVersion5 = [v22 assetVersion];
                v31 = [v47 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion5];

                v32 = v31;
                persistedEntryID = [v31 persistedEntryID];
                v34 = [v44 safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

                if (!v34)
                {
                  [v43 addObject:v22];
                }

                versionCopy = v45;
              }
            }
          }

          objc_autoreleasePoolPop(v20);
        }

        v16 = [v14 countByEnumeratingWithState:&v54 objects:v59 count:16];
      }

      while (v16);
    }

    v52 = 0u;
    v53 = 0u;
    v50 = 0u;
    v51 = 0u;
    v35 = v43;
    v36 = [v35 countByEnumeratingWithState:&v50 objects:v58 count:16];
    if (v36)
    {
      v37 = v36;
      v38 = *v51;
      do
      {
        for (j = 0; j != v37; j = j + 1)
        {
          if (*v51 != v38)
          {
            objc_enumerationMutation(v35);
          }

          v40 = *(*(&v50 + 1) + 8 * j);
          v41 = objc_autoreleasePoolPush();
          [(MADAutoAssetControlManager *)selfCopy _removeDescriptorFromFilesystem:@"_removeUnlockedForOlderSelectorsWithoutVersion" droppingDescriptor:v40 forHistoryOperation:402 firstClientName:0];
          objc_autoreleasePoolPop(v41);
        }

        v37 = [v35 countByEnumeratingWithState:&v50 objects:v58 count:16];
      }

      while (v37);
    }

    versionCopy = v45;
  }
}

- (void)_removeDescriptorFromFilesystem:(id)filesystem droppingDescriptor:(id)descriptor forHistoryOperation:(int64_t)operation firstClientName:(id)name
{
  descriptorCopy = descriptor;
  nameCopy = name;
  filesystemCopy = filesystem;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  filesystemCopy = [[NSString alloc] initWithFormat:@"%@:_removeDescriptorFromFilesystem", filesystemCopy];
  v15 = [MAAutoAssetSelector alloc];
  assetType = [descriptorCopy assetType];
  assetSpecifier = [descriptorCopy assetSpecifier];
  assetVersion = [descriptorCopy assetVersion];
  v19 = [v15 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  v20 = [MADAutoAssetControlManager localAssetURLForDescriptor:descriptorCopy fromLocation:filesystemCopy];
  if ([MADAutoAssetSecure isSecureAsset:filesystemCopy forDescriptor:descriptorCopy])
  {
    [(MADAutoAssetControlManager *)self secureForceUngraft:filesystemCopy forDescriptorBeingRemoved:descriptorCopy];
    [MADAutoAssetSecure depersonalizeIfSecure:filesystemCopy forDescriptor:descriptorCopy];
  }

  if (v20)
  {
    v39 = v19;
    v40 = nameCopy;
    v21 = [[NSURL alloc] initFileURLWithPath:v20];
    path = [v21 path];
    v23 = [(MADAutoAssetControlManager *)self filesystemDoesFileExist:filesystemCopy atPath:path];

    if (v23)
    {
      v24 = getControlManager();
      v25 = [v24 getSAFRegistrationBundleID:v21];

      v41 = 0;
      renameWithExtThenRemoveExposeError(v20, @".purged", &v41);
      v26 = v41;
    }

    else
    {
      v30 = [[NSString alloc] initWithFormat:@"dropping descriptor when no item exists at path:%@", v20];
      v26 = [MAAutoAssetError buildError:6110 fromOperation:filesystemCopy underlyingError:0 withDescription:v30];

      v25 = 0;
    }

    v31 = _MADLog(@"AutoControl");
    v32 = v31;
    if (v26)
    {
      if (os_log_type_enabled(v31, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary = [descriptorCopy summary];
        v35 = [MADAutoAssetClientRequest responseErrorSummary:v26];
        *buf = 138544130;
        v43 = _updateLatestSummary;
        v44 = 2114;
        v45 = filesystemCopy;
        v46 = 2114;
        v47 = summary;
        v48 = 2114;
        v49 = v35;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[%{public}@] {%{public}@} unable to remove from filesystem | dropDescriptor:%{public}@, error:%{public}@", buf, 0x2Au);
      }
    }

    else
    {
      if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary2 = [descriptorCopy summary];
        *buf = 138543874;
        v43 = _updateLatestSummary2;
        v44 = 2114;
        v45 = filesystemCopy;
        v46 = 2114;
        v47 = summary2;
        _os_log_impl(&dword_0, v32, OS_LOG_TYPE_DEFAULT, "[%{public}@] {%{public}@} removed from filesystem | dropDescriptor:%{public}@ ", buf, 0x20u);
      }

      [(MADAutoAssetControlManager *)self _statsIncrementRemovedForDescriptor:descriptorCopy];
      [(MADAutoAssetControlManager *)self trackDescriptorForgetAssetSelector:v39 forHistoryOperation:operation firstClientName:v40];
      v32 = getControlManager();
      [v32 updateSpaceAttributionForBundleID:v25 assetPath:v21 doRegistration:0];
    }

    v19 = v39;
    nameCopy = v40;
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    descriptorCopy = [[NSString alloc] initWithFormat:@"{%@} unable to determine local URL for descriptor:%@", filesystemCopy, descriptorCopy];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:descriptorCopy withResult:6101 withError:0];
  }
}

- (void)_removeAllUnlockedForOtherAtomicInstances:(id)instances fromLocation:(id)location
{
  instancesCopy = instances;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v74 = locationCopy;
  locationCopy = [[NSString alloc] initWithFormat:@"%@:_removeAllUnlockedForOtherAtomicInstances", locationCopy];
  [(MADAutoAssetControlManager *)self _reclaimDownloadedDescriptorsWhenJustDownloaded:instancesCopy fromLocation:locationCopy];
  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v12 = [persistedDownloadedSetDescriptors persistedEntryIDs:locationCopy];

  if ([v12 count])
  {
    v79 = instancesCopy;
    v80 = objc_alloc_init(NSMutableArray);
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"persistedDownloadedSetDescriptors"];
    v96 = 0u;
    v97 = 0u;
    v94 = 0u;
    v95 = 0u;
    v73 = v12;
    obj = v12;
    v13 = [obj countByEnumeratingWithState:&v94 objects:v107 count:16];
    v84 = locationCopy;
    selfCopy = self;
    if (!v13)
    {
      goto LABEL_35;
    }

    v14 = v13;
    v15 = *v95;
    p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
    v77 = *v95;
    while (1)
    {
      v17 = 0;
      v82 = v14;
      do
      {
        if (*v95 != v15)
        {
          objc_enumerationMutation(obj);
        }

        v18 = *(*(&v94 + 1) + 8 * v17);
        v19 = objc_autoreleasePoolPush();
        persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
        [persistedDownloadedSetDescriptors2 persistedEntry:v18 fromLocation:locationCopy];
        v22 = v21 = self;

        if (v18)
        {
          v23 = v22 == 0;
        }

        else
        {
          v23 = 1;
        }

        if (!v23)
        {
          persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)v21 persistedDownloadedSetDescriptors];
          v29 = [persistedDownloadedSetDescriptors3 decodeFromLocation:locationCopy ofEntryName:v18 fromPersistedEntry:v22 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (!v29)
          {
            v44 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
              *buf = 138543874;
              v100 = _updateLatestSummary;
              v101 = 2114;
              v102 = locationCopy;
              v103 = 2114;
              v104 = v18;
              _os_log_impl(&dword_0, v44, OS_LOG_TYPE_ERROR, "[%{public}@]\n[REMOVAL] {%{public}@} unable to load set-descriptor | entryID:%{public}@", buf, 0x20u);

              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            }

            [v80 addObject:v18];
            goto LABEL_32;
          }

          context = v19;
          v30 = p_weak_ivar_lyt[223];
          [v29 clientDomainName];
          v32 = v31 = p_weak_ivar_lyt;
          clientDomainName = [v79 clientDomainName];
          if ([v30 stringIsEqual:v32 to:clientDomainName])
          {
            v34 = v31[223];
            assetSetIdentifier = [v29 assetSetIdentifier];
            assetSetIdentifier2 = [v79 assetSetIdentifier];
            v76 = assetSetIdentifier;
            if ([v34 stringIsEqual:assetSetIdentifier to:assetSetIdentifier2])
            {
              latestDownloadedAtomicInstance = [v29 latestDownloadedAtomicInstance];
              latestDownloadedAtomicInstance2 = [v79 latestDownloadedAtomicInstance];
              v75 = [SUCore stringIsEqual:latestDownloadedAtomicInstance to:latestDownloadedAtomicInstance2];

              locationCopy = v84;
              v15 = v77;
              p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              v19 = context;
              if ((v75 & 1) == 0 && ![(MADAutoAssetControlManager *)selfCopy setDescriptorLocked:v29])
              {
                v39 = [NSString alloc];
                summary = [v79 summary];
                v41 = [v39 initWithFormat:@"older set-descriptor found - dropped setDescriptor:%@", summary];

                v42 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v42, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary2 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
                  *buf = 138544130;
                  v100 = _updateLatestSummary2;
                  v101 = 2114;
                  v102 = v84;
                  v103 = 2114;
                  v104 = v41;
                  v105 = 2114;
                  v106 = v18;
                  _os_log_impl(&dword_0, v42, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} %{public}@ | entryID:%{public}@", buf, 0x2Au);
                }

                [v80 addObject:v18];
                v15 = v77;
                p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
              }

              goto LABEL_32;
            }

            locationCopy = v84;
            v15 = v77;
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          }

          else
          {

            locationCopy = v84;
            v15 = v77;
            p_weak_ivar_lyt = v31;
          }

          v19 = context;
LABEL_32:

          v14 = v82;
          goto LABEL_33;
        }

        v24 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary3 = [(MADAutoAssetControlManager *)selfCopy _updateLatestSummary];
          v26 = _updateLatestSummary3;
          *buf = 138543874;
          v27 = @"N";
          if (v18)
          {
            v27 = v18;
          }

          v100 = _updateLatestSummary3;
          v101 = 2114;
          v102 = locationCopy;
          v103 = 2114;
          v104 = v27;
          _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "[%{public}@]\n[REMOVAL] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
        }

        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        if (v18)
        {
          [v80 addObject:v18];
        }

LABEL_33:

        objc_autoreleasePoolPop(v19);
        v17 = v17 + 1;
        self = selfCopy;
      }

      while (v14 != v17);
      v14 = [obj countByEnumeratingWithState:&v94 objects:v107 count:16];
      if (!v14)
      {
LABEL_35:

        v92 = 0u;
        v93 = 0u;
        v90 = 0u;
        v91 = 0u;
        v46 = v80;
        instancesCopy = v79;
        v83 = [v46 countByEnumeratingWithState:&v90 objects:v98 count:16];
        if (!v83)
        {
          goto LABEL_52;
        }

        v81 = *v91;
        v78 = v46;
        while (1)
        {
          for (i = 0; i != v83; i = i + 1)
          {
            if (*v91 != v81)
            {
              objc_enumerationMutation(v78);
            }

            v48 = *(*(&v90 + 1) + 8 * i);
            contexta = objc_autoreleasePoolPush();
            persistedDownloadedSetDescriptors4 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            v50 = [persistedDownloadedSetDescriptors4 persistedEntry:v48 fromLocation:locationCopy];

            persistedDownloadedSetDescriptors5 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
            obja = v50;
            v52 = [persistedDownloadedSetDescriptors5 decodeFromLocation:locationCopy ofEntryName:v48 fromPersistedEntry:v50 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            clientDomainName2 = [instancesCopy clientDomainName];
            assetSetIdentifier3 = [instancesCopy assetSetIdentifier];
            v55 = [(MADAutoAssetControlManager *)self setConfigurationForClientDomain:clientDomainName2 forAssetSetIdentifier:assetSetIdentifier3];

            latestAtomicInstanceToVend = [v55 latestAtomicInstanceToVend];

            if (latestAtomicInstanceToVend)
            {
              latestAtomicInstanceToVend2 = [v55 latestAtomicInstanceToVend];
              v58 = [(MADAutoAssetControlManager *)self locateSetDescriptor:locationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

              if (v58)
              {
                [(MADAutoAssetControlManager *)self _reclaimDownloadedDescriptorsWhenJustDownloaded:v58 fromLocation:locationCopy];
              }
            }

            if (v52)
            {
              latestDownloadedAtomicInstance3 = [v52 latestDownloadedAtomicInstance];

              if (latestDownloadedAtomicInstance3)
              {
                latestDownloadedAtomicInstance4 = [v52 latestDownloadedAtomicInstance];
                [(MADAutoAssetControlManager *)self atomicInstanceRemove:locationCopy setAtomicInstanceUUID:latestDownloadedAtomicInstance4 removingForReason:@"dropped older set-descriptor" historyOperation:325];

                persistedDownloadedSetDescriptors6 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                [persistedDownloadedSetDescriptors6 removePersistedEntry:v48 fromLocation:locationCopy];

                latestDowloadedAtomicInstanceEntries = [v52 latestDowloadedAtomicInstanceEntries];
                v63 = [latestDowloadedAtomicInstanceEntries count];
                clientDomainName3 = [v52 clientDomainName];
                assetSetIdentifier4 = [v52 assetSetIdentifier];
                discoveredAtomicInstance = [v52 discoveredAtomicInstance];
                [MADAutoAssetHistory recordOperation:378 toHistoryType:2 fromLayer:1 usageCount:v63 forClientDomainName:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier4 forAtomicInstance:discoveredAtomicInstance];

                locationCopy = v84;
                self = selfCopy;
                instancesCopy = v79;

                [(MADAutoAssetControlManager *)selfCopy _logPersistedSetDescriptorRemoved:v84 forComponentType:@"SET_DOWNLOADED_DESCRIPTORS" removedPersistedEntryID:v48 removedSetDescriptor:v52 message:@"removing stale previously persisted downloaded-set-descriptor"];
                goto LABEL_50;
              }

              v67 = @"EntryID: %@. latestDownloadAtomicInstance in descriptor to be dropped is nil";
            }

            else
            {
              v67 = @"EntryID: %@. descriptor to be dropped is nil";
            }

            v68 = [[NSString alloc] initWithFormat:v67, v48];
            autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
            diag = [autoControlManagerFSM2 diag];
            [diag trackAnomaly:v84 forReason:v68 withResult:6101 withError:0];

            locationCopy = v84;
LABEL_50:

            objc_autoreleasePoolPop(contexta);
          }

          v46 = v78;
          v83 = [v78 countByEnumeratingWithState:&v90 objects:v98 count:16];
          if (!v83)
          {
LABEL_52:

            v12 = v73;
            goto LABEL_55;
          }
        }
      }
    }
  }

  v46 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v46, OS_LOG_TYPE_DEFAULT))
  {
    _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
    summary2 = [instancesCopy summary];
    *buf = 138543874;
    v100 = _updateLatestSummary4;
    v101 = 2114;
    v102 = locationCopy;
    v103 = 2114;
    v104 = summary2;
    _os_log_impl(&dword_0, v46, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} no persisted set-descriptors when removing other than setJobDescriptor:%{public}@", buf, 0x20u);
  }

LABEL_55:
}

- (void)_removeIncompleteSetDescriptorFromLocation:(id)location incompleteSetDescriptor:(id)descriptor historyOperationAI:(int64_t)i historyOperationSD:(int64_t)d
{
  locationCopy = location;
  descriptorCopy = descriptor;
  v11 = +[NSFileManager defaultManager];
  v12 = [(MADAutoAssetControlManager *)self atomicInstanceForSetDescriptor:descriptorCopy];
  clientDomainName = [descriptorCopy clientDomainName];
  assetSetIdentifier = [descriptorCopy assetSetIdentifier];
  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  v16 = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName forAssetSetIdentifier:assetSetIdentifier forSetAtomicInstance:latestDownloadedAtomicInstance];

  v17 = [NSString alloc];
  summary = [descriptorCopy summary];
  v19 = [v17 initWithFormat:@"forcing atomic-instance unlocked due to incomplete set-descriptor | setDescriptor:%@", summary];
  v20 = [MAAutoAssetError buildError:6563 fromOperation:locationCopy underlyingError:0 withDescription:v19];

  [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:locationCopy dueToError:v20 forgettingAtomicInstance:v12 historyOperationAI:338 historyOperationSD:381];
  v21 = [(MADAutoAssetControlManager *)self _shortTermSharedLockRemove:locationCopy removingSharedLockFilename:v16 usingFileManager:v11 removingDescription:@"atomic-instance shared lock directory (incomplete set-descriptor atomic-instance)"];
  [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:descriptorCopy];
  [(MADAutoAssetControlManager *)self secureCheckUngraftAll:locationCopy forSetDescriptorNoLongerLocked:descriptorCopy];
  if (__isPlatformVersionAtLeast(2, 18, 4, 0))
  {
    [(MADAutoAssetControlManager *)self notifyEvictedCallbacksForSetDescriptor:descriptorCopy];
  }

  latestDownloadedAtomicInstance2 = [descriptorCopy latestDownloadedAtomicInstance];
  [(MADAutoAssetControlManager *)self atomicInstanceRemove:locationCopy setAtomicInstanceUUID:latestDownloadedAtomicInstance2 removingForReason:@"incomplete set-descriptor atomic-instance" historyOperation:i];

  [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:descriptorCopy fromLocation:locationCopy checkingByInstance:0 regardlessOfLatest:1 historyOperationAI:i historyOperationSD:d];
}

- (void)_removeSetDeterminedToBeIncomplete:(id)incomplete
{
  incompleteCopy = incomplete;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  incompleteCopy = [[NSString alloc] initWithFormat:@"%@:_removeSetDeterminedToBeIncomplete", incompleteCopy];
  descriptorsDroppedOnStartup = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
  if (descriptorsDroppedOnStartup)
  {
    v9 = descriptorsDroppedOnStartup;
    descriptorsDroppedOnStartup2 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
    v11 = [descriptorsDroppedOnStartup2 count];

    if (v11)
    {
      v45 = objc_alloc_init(NSMutableDictionary);
      v47 = deviceOSBuildVersion();
      persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
      v13 = [persistedDownloadedSetDescriptors persistedEntryIDs:@"setDescriptorEliminate"];

      v44 = v13;
      v48 = incompleteCopy;
      v43 = incompleteCopy;
      if ([v13 count])
      {
        [(MADAutoAssetControlManager *)self trackPerformanceIteration:incompleteCopy ofContainer:@"persistedDownloadedSetDescriptors"];
        v64 = 0u;
        v65 = 0u;
        v62 = 0u;
        v63 = 0u;
        v14 = v13;
        v49 = [v14 countByEnumeratingWithState:&v62 objects:v73 count:16];
        if (v49)
        {
          v15 = *v63;
          v46 = *v63;
          do
          {
            for (i = 0; i != v49; i = i + 1)
            {
              if (*v63 != v15)
              {
                objc_enumerationMutation(v14);
              }

              v17 = *(*(&v62 + 1) + 8 * i);
              v18 = objc_autoreleasePoolPush();
              if (v17)
              {
                persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                v20 = [persistedDownloadedSetDescriptors2 persistedEntry:v17 fromLocation:incompleteCopy];

                if (v20)
                {
                  persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
                  v22 = [persistedDownloadedSetDescriptors3 decodeFromLocation:incompleteCopy ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

                  if (v22)
                  {
                    v60 = 0u;
                    v61 = 0u;
                    v58 = 0u;
                    v59 = 0u;
                    descriptorsDroppedOnStartup3 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
                    v24 = [descriptorsDroppedOnStartup3 countByEnumeratingWithState:&v58 objects:v68 count:16];
                    if (v24)
                    {
                      v25 = v24;
                      v26 = v14;
                      v27 = *v59;
                      while (2)
                      {
                        for (j = 0; j != v25; j = j + 1)
                        {
                          if (*v59 != v27)
                          {
                            objc_enumerationMutation(descriptorsDroppedOnStartup3);
                          }

                          if ([(MADAutoAssetControlManager *)self doesSetDescriptor:v22 referenceAssetDescriptor:*(*(&v58 + 1) + 8 * j)])
                          {
                            latestDownloadedAtomicInstance = [v22 latestDownloadedAtomicInstance];
                            [v45 setSafeObject:v22 forKey:latestDownloadedAtomicInstance];

                            goto LABEL_26;
                          }
                        }

                        v25 = [descriptorsDroppedOnStartup3 countByEnumeratingWithState:&v58 objects:v68 count:16];
                        if (v25)
                        {
                          continue;
                        }

                        break;
                      }

LABEL_26:
                      v14 = v26;
                      v15 = v46;
                    }
                  }

                  else
                  {
                    descriptorsDroppedOnStartup3 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(descriptorsDroppedOnStartup3, OS_LOG_TYPE_ERROR))
                    {
                      *buf = 138543618;
                      v70 = v48;
                      v71 = 2114;
                      v72 = v17;
                      _os_log_impl(&dword_0, descriptorsDroppedOnStartup3, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
                    }
                  }
                }

                else
                {
                  v22 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
                  {
                    *buf = 138543618;
                    v70 = v48;
                    v71 = 2114;
                    v72 = v17;
                    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load persisted entry | entryID:%{public}@", buf, 0x16u);
                  }
                }

                incompleteCopy = v48;
              }

              else
              {
                v20 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
                {
                  *buf = 138543362;
                  v70 = incompleteCopy;
                  _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{%{public}@} no entryID", buf, 0xCu);
                }
              }

              objc_autoreleasePoolPop(v18);
            }

            v49 = [v14 countByEnumeratingWithState:&v62 objects:v73 count:16];
          }

          while (v49);
        }
      }

      v56 = 0u;
      v57 = 0u;
      v54 = 0u;
      v55 = 0u;
      v30 = v45;
      v31 = [v30 countByEnumeratingWithState:&v54 objects:v67 count:16];
      if (v31)
      {
        v32 = v31;
        v33 = *v55;
        do
        {
          for (k = 0; k != v32; k = k + 1)
          {
            if (*v55 != v33)
            {
              objc_enumerationMutation(v30);
            }

            v35 = [v30 safeObjectForKey:*(*(&v54 + 1) + 8 * k) ofClass:objc_opt_class()];
            if (v35)
            {
              [(MADAutoAssetControlManager *)self _removeIncompleteSetDescriptorFromLocation:incompleteCopy incompleteSetDescriptor:v35 historyOperationAI:338 historyOperationSD:381];
            }
          }

          v32 = [v30 countByEnumeratingWithState:&v54 objects:v67 count:16];
        }

        while (v32);
      }

      v52 = 0u;
      v53 = 0u;
      v50 = 0u;
      v51 = 0u;
      descriptorsDroppedOnStartup4 = [(MADAutoAssetControlManager *)self descriptorsDroppedOnStartup];
      v37 = [descriptorsDroppedOnStartup4 countByEnumeratingWithState:&v50 objects:v66 count:16];
      if (v37)
      {
        v38 = v37;
        v39 = *v51;
        do
        {
          for (m = 0; m != v38; m = m + 1)
          {
            if (*v51 != v39)
            {
              objc_enumerationMutation(descriptorsDroppedOnStartup4);
            }

            v41 = *(*(&v50 + 1) + 8 * m);
            if ([MADAutoAssetSecure isCodeAsset:@"jobDescriptorOnFilesystemValidated" forDescriptor:v41])
            {
              if ([v41 wasBuiltForOSBuild:v47])
              {
                v42 = 410;
              }

              else
              {
                v42 = 411;
              }
            }

            else
            {
              v42 = 410;
            }

            [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"assetBeingGarbageCollected" droppingDescriptor:v41 forHistoryOperation:v42 firstClientName:0];
          }

          v38 = [descriptorsDroppedOnStartup4 countByEnumeratingWithState:&v50 objects:v66 count:16];
        }

        while (v38);
      }

      incompleteCopy = v43;
      incompleteCopy = v48;
    }
  }

  [(MADAutoAssetControlManager *)self setDescriptorsDroppedOnStartup:0];
}

- (void)_removeDownloadedDescriptorsWithNewerDownloaded:(id)downloaded
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [persistedKnownDescriptors persistedEntryIDs:@"_removeDownloadedDescriptorsWithNewerDownloaded"];

  if ([v7 count])
  {
    v8 = [[NSMutableArray alloc] initWithArray:v7];
    v9 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      v11 = 138543362;
      v12 = _updateLatestSummary;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} crosscheck[BEGIN]", &v11, 0xCu);
    }

    [(MADAutoAssetControlManager *)self _removeNextDownloadedDescriptorIfNewerDownloaded:v8];
  }
}

- (void)_removeNextDownloadedDescriptorIfNewerDownloaded:(id)downloaded
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [downloadedCopy count];
  if (v7 >= 1)
  {
    v8 = v7;
    v9 = [downloadedCopy objectAtIndex:0];
    [downloadedCopy removeObjectAtIndex:0];
    persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v11 = [persistedKnownDescriptors persistedEntry:v9 fromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded"];

    if (v11)
    {
      persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v13 = [persistedKnownDescriptors2 decodeFromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded" ofEntryName:v9 fromPersistedEntry:v11 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

      if (v13)
      {
        v42 = v8;
        v43 = v11;
        v44 = v9;
        v45 = downloadedCopy;
        v14 = objc_alloc_init(NSMutableArray);
        v41 = v13;
        [(MADAutoAssetControlManager *)self _decideRemoveDescriptorWithNewerDownloaded:v13 maintainingRemoveDescriptors:v14 allowRemovalWithoutNewerDescriptor:0 fromLocation:@"_removeNextDownloadedDescriptorIfNewerDownloaded"];
        v49 = 0u;
        v50 = 0u;
        v51 = 0u;
        v52 = 0u;
        v15 = v14;
        v16 = [v15 countByEnumeratingWithState:&v49 objects:v53 count:16];
        if (v16)
        {
          v17 = v16;
          v18 = *v50;
          v19 = @"AutoControl";
          do
          {
            v20 = 0;
            v46 = v17;
            do
            {
              if (*v50 != v18)
              {
                objc_enumerationMutation(v15);
              }

              v21 = *(*(&v49 + 1) + 8 * v20);
              v22 = objc_autoreleasePoolPush();
              v23 = _MADLog(v19);
              if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
              {
                _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                [v21 summary];
                v25 = v18;
                v26 = v19;
                v27 = v15;
                v29 = v28 = self;
                *buf = 138543618;
                v55 = _updateLatestSummary;
                v56 = 2114;
                v57 = v29;
                _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} removing | removeDescriptor:%{public}@", buf, 0x16u);

                self = v28;
                v15 = v27;
                v19 = v26;
                v18 = v25;
                v17 = v46;
              }

              [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:@"_removeNextDownloadedDescriptorIfNewerDownloaded" droppingDescriptor:v21 forHistoryOperation:402 firstClientName:0];
              objc_autoreleasePoolPop(v22);
              v20 = v20 + 1;
            }

            while (v17 != v20);
            v17 = [v15 countByEnumeratingWithState:&v49 objects:v53 count:16];
          }

          while (v17);
        }

        v9 = v44;
        downloadedCopy = v45;
        v8 = v42;
        v11 = v43;
        v13 = v41;
      }

      else
      {
        v15 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v55 = _updateLatestSummary2;
          v56 = 2114;
          v57 = v9;
          _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} unable to decode asset-descriptor | entryID:%{public}@", buf, 0x16u);
        }
      }
    }

    else
    {
      v13 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v55 = _updateLatestSummary3;
        v56 = 2114;
        v57 = v9;
        _os_log_impl(&dword_0, v13, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} unable to load persisted-entry | entryID:%{public}@", buf, 0x16u);
      }
    }

    v32 = [downloadedCopy count];
    if (v32 < 1)
    {
      v37 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v55 = _updateLatestSummary4;
        _os_log_impl(&dword_0, v37, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {_removeNextDownloadedDescriptorIfNewerDownloaded} crosscheck[END]", buf, 0xCu);
      }
    }

    else
    {
      v33 = v32;
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      v35 = autoControlManagerFSM2;
      if (v33 >= v8)
      {
        diag = [autoControlManagerFSM2 diag];
        v40 = [[NSString alloc] initWithFormat:@"{_removeNextDownloadedDescriptorIfNewerDownloaded} recursion problem - abandoning crosscheck | remainingEntryIDCount:%ld | beginEntryIDCount:%ld", v33, v8];
        [diag trackAnomaly:@"AUTO-CONTROL" forReason:v40 withResult:6109 withError:0];
      }

      else
      {
        extendedStateQueue2 = [autoControlManagerFSM2 extendedStateQueue];
        block[0] = _NSConcreteStackBlock;
        block[1] = 3221225472;
        block[2] = __79__MADAutoAssetControlManager__removeNextDownloadedDescriptorIfNewerDownloaded___block_invoke;
        block[3] = &unk_4B2B18;
        block[4] = self;
        v48 = downloadedCopy;
        dispatch_async(extendedStateQueue2, block);
      }
    }
  }
}

- (BOOL)_removeDownloadedSetDescriptorWithNewerDownloadedFromLocation:(id)location setDescriptor:(id)descriptor allowRemovalWithoutNewerDescriptor:(BOOL)newerDescriptor
{
  newerDescriptorCopy = newerDescriptor;
  locationCopy = location;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_removeDownloadedSetDescriptorWithNewerDownloaded", locationCopy];
  v35 = objc_alloc_init(NSMutableArray);
  if ([(MADAutoAssetControlManager *)self _isDownloadedSetDescriptorLatestToVend:descriptorCopy fromLocation:locationCopy])
  {
    v13 = 0;
  }

  else
  {
    v34 = locationCopy;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"latestDowloadedAtomicInstanceEntries"];
    v44 = 0u;
    v45 = 0u;
    v42 = 0u;
    v43 = 0u;
    v33 = descriptorCopy;
    latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
    v15 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v42 objects:v53 count:16];
    if (v15)
    {
      v16 = v15;
      v17 = *v43;
      while (2)
      {
        for (i = 0; i != v16; i = i + 1)
        {
          if (*v43 != v17)
          {
            objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
          }

          fullAssetSelector = [*(*(&v42 + 1) + 8 * i) fullAssetSelector];
          v20 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

          LOBYTE(fullAssetSelector) = [(MADAutoAssetControlManager *)self _decideRemoveDescriptorWithNewerDownloaded:v20 maintainingRemoveDescriptors:v35 allowRemovalWithoutNewerDescriptor:newerDescriptorCopy fromLocation:locationCopy];
          if (fullAssetSelector)
          {

            v13 = 0;
            descriptorCopy = v33;
            locationCopy = v34;
            goto LABEL_22;
          }
        }

        v16 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v42 objects:v53 count:16];
        if (v16)
        {
          continue;
        }

        break;
      }
    }

    v40 = 0u;
    v41 = 0u;
    v38 = 0u;
    v39 = 0u;
    obj = v35;
    v21 = [obj countByEnumeratingWithState:&v38 objects:v52 count:16];
    if (v21)
    {
      v22 = v21;
      v23 = *v39;
      v24 = @"AutoControl";
      selfCopy = self;
      do
      {
        for (j = 0; j != v22; j = j + 1)
        {
          if (*v39 != v23)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v38 + 1) + 8 * j);
          v27 = objc_autoreleasePoolPush();
          v28 = _MADLog(v24);
          if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
          {
            [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v30 = v29 = v24;
            summary = [v26 summary];
            *buf = 138543874;
            v47 = v30;
            v48 = 2114;
            v49 = locationCopy;
            v50 = 2114;
            v51 = summary;
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing | removeDescriptor:%{public}@", buf, 0x20u);

            v24 = v29;
            self = selfCopy;
          }

          [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:locationCopy droppingDescriptor:v26 forHistoryOperation:402 firstClientName:0];
          objc_autoreleasePoolPop(v27);
        }

        v22 = [obj countByEnumeratingWithState:&v38 objects:v52 count:16];
      }

      while (v22);
    }

    v13 = 1;
    descriptorCopy = v33;
    locationCopy = v34;
    [(MADAutoAssetControlManager *)self removeSetDescriptorDownloaded:v33 fromLocation:v34 checkingByInstance:1 regardlessOfLatest:0 historyOperationAI:322 historyOperationSD:376];
  }

LABEL_22:

  return v13;
}

- (BOOL)_decideRemoveDescriptorWithNewerDownloaded:(id)downloaded maintainingRemoveDescriptors:(id)descriptors allowRemovalWithoutNewerDescriptor:(BOOL)descriptor fromLocation:(id)location
{
  descriptorCopy = descriptor;
  downloadedCopy = downloaded;
  descriptorsCopy = descriptors;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v15 = [[NSString alloc] initWithFormat:@"%@:%@", locationCopy, @"_decideRemoveDescriptorWithNewerDownloaded"];
  if (!downloadedCopy)
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      *buf = 138543618;
      v30 = _updateLatestSummary;
      v31 = 2114;
      v32 = v15;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} nil downloadedAssetDescriptor", buf, 0x16u);
LABEL_14:
    }

LABEL_15:

    goto LABEL_16;
  }

  if ([downloadedCopy isBlankEntry])
  {
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary = [downloadedCopy summary];
      *buf = 138543874;
      v30 = _updateLatestSummary2;
      v31 = 2114;
      v32 = v15;
      v33 = 2114;
      v34 = summary;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} encountered blank auto-asset-descriptor - removing | downloadedAssetDescriptor:%{public}@", buf, 0x20u);
    }

    [descriptorsCopy addObject:downloadedCopy];
    goto LABEL_16;
  }

  if (![downloadedCopy isOnFilesystem])
  {
    v19 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
      summary2 = [downloadedCopy summary];
      *buf = 138543874;
      v30 = _updateLatestSummary;
      v31 = 2114;
      v32 = v15;
      v33 = 2114;
      v34 = summary2;
      _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} encountered downloaded descriptor not on the filesystem - ignored | downloadedAssetDescriptor:%{public}@", buf, 0x20u);

      goto LABEL_14;
    }

    goto LABEL_15;
  }

  if (![downloadedCopy foundByLookupWithoutAssetVersion])
  {
LABEL_16:
    v21 = 0;
    goto LABEL_17;
  }

  if (![(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:v15 forDescriptor:downloadedCopy])
  {
    v24 = [(MADAutoAssetControlManager *)self _newestVersionDownloaded:downloadedCopy];
    if ((v24 || descriptorCopy) && ![(MADAutoAssetControlManager *)self _isDownloadedDescriptorPartOfLatestToVend:downloadedCopy fromLocation:v15])
    {
      v25 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
      {
        _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        summary3 = [downloadedCopy summary];
        summary4 = [v24 summary];
        *buf = 138544130;
        v30 = _updateLatestSummary3;
        v31 = 2114;
        v32 = v15;
        v33 = 2114;
        v34 = summary3;
        v35 = 2114;
        v36 = summary4;
        _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing older downloaded descriptor | removingDescriptor:%{public}@, keepingDescriptor:%{public}@", buf, 0x2Au);
      }

      [descriptorsCopy addObject:downloadedCopy];
    }

    goto LABEL_16;
  }

  v21 = 1;
LABEL_17:

  return v21;
}

- (void)_reclaimDownloadedDescriptorsWhenJustDownloaded:(id)downloaded fromLocation:(id)location
{
  downloadedCopy = downloaded;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  locationCopy = [[NSString alloc] initWithFormat:@"%@:_reclaimDownloadedDescriptorsWhenJustDownloaded", locationCopy];
  clientDomainName = [downloadedCopy clientDomainName];
  assetSetIdentifier = [downloadedCopy assetSetIdentifier];
  v50 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:clientDomainName forAssetSetIdentifier:assetSetIdentifier];

  firstAssetType = [downloadedCopy firstAssetType];
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v48 = firstAssetType;
  v15 = [persistedKnownDescriptors persistedEntryIDs:@"_reclaimDownloadedDescriptorsWhenJustDownloaded" assetType:firstAssetType];

  v52 = objc_alloc_init(NSMutableArray);
  v49 = v15;
  if ([v15 count])
  {
    v45 = locationCopy;
    v46 = downloadedCopy;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:locationCopy ofContainer:@"persistedKnownDescriptors"];
    v60 = 0u;
    v61 = 0u;
    v58 = 0u;
    v59 = 0u;
    v16 = v15;
    v17 = [v16 countByEnumeratingWithState:&v58 objects:v71 count:16];
    if (!v17)
    {
      goto LABEL_35;
    }

    v18 = v17;
    v53 = *v59;
    v51 = v16;
    while (1)
    {
      for (i = 0; i != v18; i = i + 1)
      {
        if (*v59 != v53)
        {
          objc_enumerationMutation(v16);
        }

        v20 = *(*(&v58 + 1) + 8 * i);
        v21 = objc_autoreleasePoolPush();
        if (v20)
        {
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v23 = [persistedKnownDescriptors2 persistedEntry:v20 fromLocation:locationCopy];

          if (v23)
          {
            persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v25 = [persistedKnownDescriptors3 decodeFromLocation:locationCopy ofEntryName:v20 fromPersistedEntry:v23 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v25)
            {
              if ([v25 isBlankEntry])
              {
                v26 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
                {
                  _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v64 = _updateLatestSummary;
                  v65 = 2114;
                  v66 = locationCopy;
                  v67 = 2114;
                  v68 = v20;
                  v28 = v26;
                  v29 = OS_LOG_TYPE_DEFAULT;
                  v30 = "[%{public}@]\n[REMOVAL] {%{public}@} encountered blank auto-asset-descriptor - removing | entryID:%{public}@";
                  goto LABEL_30;
                }

                goto LABEL_31;
              }

              if ([v25 isOnFilesystem])
              {
                if ([v25 foundByLookupWithoutAssetVersion]&& [(MADAutoAssetControlManager *)self doesSetConfiguration:v50 coverAssetDescriptor:v25]&& ![(MADAutoAssetControlManager *)self _isDownloadedDescriptorPartOfLatestToVend:v25 fromLocation:locationCopy]&& ![(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:locationCopy forDescriptor:v25])
                {
                  v33 = [(MADAutoAssetControlManager *)self _newestVersionDownloaded:v25];
                  if (v33)
                  {
                    v34 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v34, OS_LOG_TYPE_DEFAULT))
                    {
                      _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                      summary = [v25 summary];
                      [v33 summary];
                      v35 = log = v34;
                      *buf = 138544130;
                      v64 = _updateLatestSummary2;
                      v65 = 2114;
                      v66 = locationCopy;
                      v67 = 2114;
                      v68 = summary;
                      v69 = 2114;
                      v70 = v35;
                      _os_log_impl(&dword_0, log, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[REMOVAL] {%{public}@} removing older downloaded descriptor | removingDescriptor:%{public}@, keepingDescriptor:%{public}@", buf, 0x2Au);

                      v34 = log;
                      v16 = v51;
                    }

                    [v52 addObject:v25];
                  }
                }
              }

              else
              {
                v26 = _MADLog(@"AutoControl");
                if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
                {
                  _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
                  *buf = 138543874;
                  v64 = _updateLatestSummary;
                  v65 = 2114;
                  v66 = locationCopy;
                  v67 = 2114;
                  v68 = v20;
                  v28 = v26;
                  v29 = OS_LOG_TYPE_ERROR;
                  v30 = "[%{public}@]\n[REMOVAL] {%{public}@} encountered downloaded descriptor not on the filesystem - removing | entryID:%{public}@";
LABEL_30:
                  _os_log_impl(&dword_0, v28, v29, v30, buf, 0x20u);

                  v16 = v51;
                }

LABEL_31:

                [v52 addObject:v25];
              }

LABEL_32:

              goto LABEL_33;
            }

            _updateLatestSummary4 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(_updateLatestSummary4, OS_LOG_TYPE_ERROR))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543874;
              v64 = _updateLatestSummary3;
              v65 = 2114;
              v66 = locationCopy;
              v67 = 2114;
              v68 = v20;
              _os_log_impl(&dword_0, _updateLatestSummary4, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} unable to load auto-asset-descriptor | entryID:%{public}@", buf, 0x20u);

              v16 = v51;
            }
          }

          else
          {
            v25 = _MADLog(@"AutoControl");
            if (!os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
            {
              goto LABEL_32;
            }

            _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543874;
            v64 = _updateLatestSummary4;
            v65 = 2114;
            v66 = locationCopy;
            v67 = 2114;
            v68 = v20;
            _os_log_impl(&dword_0, v25, OS_LOG_TYPE_ERROR, "[%{public}@]\n[CONSIDER-REMOVAL] {%{public}@} unable to determine previous status | entryID:%{public}@", buf, 0x20u);
          }

          goto LABEL_32;
        }

LABEL_33:
        objc_autoreleasePoolPop(v21);
      }

      v18 = [v16 countByEnumeratingWithState:&v58 objects:v71 count:16];
      if (!v18)
      {
LABEL_35:

        locationCopy = v45;
        downloadedCopy = v46;
        break;
      }
    }
  }

  v56 = 0u;
  v57 = 0u;
  v54 = 0u;
  v55 = 0u;
  v36 = v52;
  v37 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
  if (v37)
  {
    v38 = v37;
    v39 = *v55;
    do
    {
      for (j = 0; j != v38; j = j + 1)
      {
        if (*v55 != v39)
        {
          objc_enumerationMutation(v36);
        }

        v41 = *(*(&v54 + 1) + 8 * j);
        v42 = objc_autoreleasePoolPush();
        [(MADAutoAssetControlManager *)self _removeDescriptorFromFilesystem:locationCopy droppingDescriptor:v41 forHistoryOperation:402 firstClientName:0];
        objc_autoreleasePoolPop(v42);
      }

      v38 = [v36 countByEnumeratingWithState:&v54 objects:v62 count:16];
    }

    while (v38);
  }
}

- (id)_newestVersionDownloaded:(id)downloaded
{
  downloadedCopy = downloaded;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v8 = [MAAutoAssetSelector alloc];
  assetType = [downloadedCopy assetType];
  assetSpecifier = [downloadedCopy assetSpecifier];
  v11 = [v8 initForAssetType:assetType withAssetSpecifier:assetSpecifier];

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v13 = [persistedKnownDescriptors persistedEntryIDs:@"_newestVersionDownloaded" assetSelector:v11];

  if (![v13 count])
  {
    v50 = 0;
    goto LABEL_40;
  }

  v53 = v11;
  v14 = [MAAutoAssetSelector alloc];
  assetType2 = [downloadedCopy assetType];
  assetSpecifier2 = [downloadedCopy assetSpecifier];
  assetVersion = [downloadedCopy assetVersion];
  v61 = [v14 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion];

  v18 = [SUCoreRestoreVersion alloc];
  v54 = downloadedCopy;
  assetVersion2 = [downloadedCopy assetVersion];
  v56 = [v18 initWithRestoreVersion:assetVersion2];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_newestVersionDownloaded" ofContainer:@"persistedKnownDescriptors"];
  v67 = 0u;
  v68 = 0u;
  v65 = 0u;
  v66 = 0u;
  v52 = v13;
  v20 = v13;
  v64 = [v20 countByEnumeratingWithState:&v65 objects:v73 count:16];
  if (!v64)
  {
    v57 = 0;
    v55 = 0;
    goto LABEL_39;
  }

  v57 = 0;
  v55 = 0;
  v63 = *v66;
  v60 = v20;
  do
  {
    v21 = 0;
    do
    {
      if (*v66 != v63)
      {
        objc_enumerationMutation(v20);
      }

      v22 = *(*(&v65 + 1) + 8 * v21);
      v23 = objc_autoreleasePoolPush();
      persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v25 = [persistedKnownDescriptors2 persistedEntry:v22 fromLocation:@"_newestVersionDownloaded"];

      if (v25)
      {
        persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v27 = [persistedKnownDescriptors3 decodeFromLocation:@"_newestVersionDownloaded" ofEntryName:v22 fromPersistedEntry:v25 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v27)
        {
          if ([v27 isBlankEntry])
          {
            v28 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v28, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              *buf = 138543618;
              v70 = _updateLatestSummary;
              v71 = 2114;
              v72 = v22;
              v30 = v28;
              v31 = OS_LOG_TYPE_DEFAULT;
              v32 = "[%{public}@] {_newestVersionDownloaded} encountered blank auto-asset-descriptor | entryID:%{public}@";
              goto LABEL_16;
            }

LABEL_27:

            goto LABEL_28;
          }

          if (![v27 isOnFilesystem])
          {
            goto LABEL_28;
          }

          v34 = objc_alloc(p_weak_ivar_lyt[267]);
          assetType3 = [v27 assetType];
          assetSpecifier3 = [v27 assetSpecifier];
          assetVersion3 = [v27 assetVersion];
          v28 = [v34 initForAssetType:assetType3 withAssetSpecifier:assetSpecifier3 matchingAssetVersion:assetVersion3];

          _updateLatestSummary = [v28 assetType];
          assetType4 = [v61 assetType];
          if (![SUCore stringIsEqual:_updateLatestSummary to:?])
          {
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            v43 = assetType4;
            goto LABEL_25;
          }

          v59 = _updateLatestSummary;
          assetSpecifier4 = [v28 assetSpecifier];
          assetSpecifier5 = [v61 assetSpecifier];
          v58 = assetSpecifier4;
          if (![SUCore stringIsEqual:assetSpecifier4 to:assetSpecifier5])
          {

            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            v43 = assetType4;
            v44 = v58;
            goto LABEL_24;
          }

          assetVersion4 = [v28 assetVersion];
          assetVersion5 = [v61 assetVersion];
          v42 = [SUCore stringIsEqual:assetVersion4 to:assetVersion5];

          if (v42)
          {
            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v20 = v60;
            goto LABEL_27;
          }

          v45 = [SUCoreRestoreVersion alloc];
          assetVersion6 = [v27 assetVersion];
          v47 = [v45 initWithRestoreVersion:assetVersion6];

          _updateLatestSummary = v47;
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
          v20 = v60;
          if ([v47 isComparable:v56])
          {
            v43 = v57;
            v57 = v43;
            if (!v43)
            {
              v43 = v56;
            }

            if ([_updateLatestSummary compare:{v43, v52}] == &dword_0 + 1)
            {
              _updateLatestSummary = _updateLatestSummary;

              v48 = v27;
              v44 = v55;
              v57 = _updateLatestSummary;
              v55 = v48;
LABEL_24:
            }

LABEL_25:
          }
        }

        else
        {
          v28 = _MADLog(@"AutoControl");
          if (!os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_27;
          }

          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          *buf = 138543618;
          v70 = _updateLatestSummary;
          v71 = 2114;
          v72 = v22;
          v30 = v28;
          v31 = OS_LOG_TYPE_ERROR;
          v32 = "[%{public}@] {_newestVersionDownloaded} unable to load auto-asset-descriptor | entryID:%{public}@";
LABEL_16:
          _os_log_impl(&dword_0, v30, v31, v32, buf, 0x16u);
        }

        goto LABEL_27;
      }

      v27 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v70 = _updateLatestSummary2;
        v71 = 2114;
        v72 = v22;
        _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "[%{public}@] {_newestVersionDownloaded} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
      }

LABEL_28:

      objc_autoreleasePoolPop(v23);
      v21 = v21 + 1;
    }

    while (v64 != v21);
    v49 = [v20 countByEnumeratingWithState:&v65 objects:v73 count:16];
    v64 = v49;
  }

  while (v49);
LABEL_39:

  v11 = v53;
  downloadedCopy = v54;
  v13 = v52;
  v50 = v55;
LABEL_40:

  return v50;
}

- (BOOL)_selectorBeingEliminated:(id)eliminated fromLocation:(id)location
{
  eliminatedCopy = eliminated;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v27 = 0u;
  v28 = 0u;
  v25 = 0u;
  v26 = 0u;
  obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v23 = [obj countByEnumeratingWithState:&v25 objects:v29 count:16];
  if (v23)
  {
    v22 = *v26;
    while (2)
    {
      for (i = 0; i != v23; i = i + 1)
      {
        if (*v26 != v22)
        {
          objc_enumerationMutation(obj);
        }

        v10 = *(*(&v25 + 1) + 8 * i);
        v11 = objc_autoreleasePoolPush();
        activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
        v13 = [activelyEliminatingSelectors safeObjectForKey:v10 ofClass:objc_opt_class()];

        assetSelector = [v13 assetSelector];
        assetType = [eliminatedCopy assetType];
        assetSpecifier = [eliminatedCopy assetSpecifier];
        assetVersion = [eliminatedCopy assetVersion];
        v18 = [(MADAutoAssetControlManager *)self _doesEliminateSelector:assetSelector matchAssetType:assetType withAssetSpecifier:assetSpecifier withAssetVersion:assetVersion fromLocation:locationCopy];

        objc_autoreleasePoolPop(v11);
        if (v18)
        {
          v19 = 1;
          goto LABEL_11;
        }
      }

      v23 = [obj countByEnumeratingWithState:&v25 objects:v29 count:16];
      if (v23)
      {
        continue;
      }

      break;
    }
  }

  v19 = 0;
LABEL_11:

  return v19;
}

- (BOOL)_setInstanceBeingEliminated:(id)eliminated fromLocation:(id)location
{
  eliminatedCopy = eliminated;
  locationCopy = location;
  selfCopy2 = self;
  v25 = locationCopy;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  obj = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
  v10 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
  if (v10)
  {
    v11 = v10;
    v28 = 0;
    v12 = *v32;
    v13 = eliminatedCopy;
    v27 = *v32;
    do
    {
      for (i = 0; i != v11; i = i + 1)
      {
        if (*v32 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v31 + 1) + 8 * i);
        context = objc_autoreleasePoolPush();
        activelyEliminatingSelectors = [(MADAutoAssetControlManager *)selfCopy2 activelyEliminatingSelectors];
        v17 = [activelyEliminatingSelectors safeObjectForKey:v15 ofClass:objc_opt_class()];

        if ([v17 eliminatingSet])
        {
          v18 = v11;
          clientDomainName = [v17 clientDomainName];
          clientDomainName2 = [v13 clientDomainName];
          if ([SUCore stringIsEqual:clientDomainName to:clientDomainName2])
          {
            assetSetIdentifier = [v17 assetSetIdentifier];
            assetSetIdentifier2 = [v13 assetSetIdentifier];
            v23 = [SUCore stringIsEqual:assetSetIdentifier to:assetSetIdentifier2];

            v13 = eliminatedCopy;
            selfCopy2 = self;
            v28 |= v23;
          }

          v11 = v18;

          v12 = v27;
        }

        objc_autoreleasePoolPop(context);
      }

      v11 = [obj countByEnumeratingWithState:&v31 objects:v35 count:16];
    }

    while (v11);
  }

  else
  {
    v28 = 0;
    v13 = eliminatedCopy;
  }

  return v28 & 1;
}

- (BOOL)_isClientRequestSubjectToElimination:(id)elimination
{
  clientRequestMessage = [elimination clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v5 = ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CURRENT_STATUS"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:INTEREST_IN_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:DETERMINE_IF_AVAILABLE"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:LOCK_CONTENT"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO:MAP_LOCKED_CONTENT_TO_EXCLAVE"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"];
  return v5;
}

- (BOOL)_doesClientRequestInvolveSetConfiguration:(id)configuration
{
  clientRequestMessage = [configuration clientRequestMessage];
  messageName = [clientRequestMessage messageName];

  v5 = ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || [SUCore stringIsEqual:messageName to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"];
  return v5;
}

- (void)_eliminateSecureOperationFinished:(id)finished forEliminateDescriptor:(id)descriptor
{
  finishedCopy = finished;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([finishedCopy awaitingSecureOperations] >= 1 && objc_msgSend(descriptorCopy, "secureOperationEliminating"))
  {
    [finishedCopy setAwaitingSecureOperations:{objc_msgSend(finishedCopy, "awaitingSecureOperations") - 1}];
    [descriptorCopy setSecureOperationEliminating:0];
  }

  [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:finishedCopy];
}

- (void)_eliminateSecureOperationFinished:(id)finished forEliminateSetDescriptor:(id)descriptor
{
  finishedCopy = finished;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if ([finishedCopy awaitingSecureOperations] >= 1 && objc_msgSend(descriptorCopy, "secureOperationEliminating"))
  {
    [finishedCopy setAwaitingSecureOperations:{objc_msgSend(finishedCopy, "awaitingSecureOperations") - 1}];
    [descriptorCopy setSecureOperationEliminating:0];
  }

  [(MADAutoAssetControlManager *)self _eliminateCompleteIfAllDone:finishedCopy];
}

- (void)_eliminateCompleteIfAllDone:(id)done
{
  doneCopy = done;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (doneCopy)
  {
    activelyEliminatingSelectors = [(MADAutoAssetControlManager *)self activelyEliminatingSelectors];
    assetSelector = [doneCopy assetSelector];
    persistedEntryID = [assetSelector persistedEntryID];
    v10 = [activelyEliminatingSelectors safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      summary = [doneCopy summary];
      *buf = 138543362;
      v153 = summary;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} checking whether done with elimination | eliminateTracker:%{public}@", buf, 0xCu);
    }

    if (!v10)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      v16 = [NSString alloc];
      summary2 = [doneCopy summary];
      v18 = [v16 initWithFormat:@"{_eliminateCompleteIfAllDone} untracked eliminateTracker:%@", summary2];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v18 withResult:6103 withError:0];

LABEL_15:
      goto LABEL_16;
    }

    if ([doneCopy awaitingSchedulerAck] & 1) != 0 || (objc_msgSend(doneCopy, "awaitingCancelActivityAck") & 1) != 0 || (objc_msgSend(doneCopy, "awaitingStagerAck") & 1) != 0 || (objc_msgSend(doneCopy, "awaitingUnlocked"))
    {
      goto LABEL_13;
    }

    activeJobsByUUID = [doneCopy activeJobsByUUID];
    if ([activeJobsByUUID count])
    {

      goto LABEL_13;
    }

    awaitingSecureOperations = [doneCopy awaitingSecureOperations];

    if (awaitingSecureOperations > 0)
    {
LABEL_13:
      autoControlManagerFSM2 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT))
      {
        summary3 = [doneCopy summary];
        *buf = 138543362;
        v153 = summary3;
        _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_DEFAULT, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} not yet complete | eliminateTracker:%{public}@", buf, 0xCu);
      }

      goto LABEL_15;
    }

    assetSelector2 = [doneCopy assetSelector];
    autoControlManagerFSM2 = [assetSelector2 persistedEntryID];

    v138 = doneCopy;
    selfCopy = self;
    if ([doneCopy eliminatingSet])
    {
      v125 = v10;
      v127 = autoControlManagerFSM2;
      v130 = objc_alloc_init(NSMutableArray);
      v132 = +[NSFileManager defaultManager];
      [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_eliminateCompleteIfAllDone" ofContainer:@"currentSetStatusByInstance"];
      v150 = 0u;
      v151 = 0u;
      v148 = 0u;
      v149 = 0u;
      obj = [(MADAutoAssetControlManager *)self currentSetStatusByInstance];
      v22 = [obj countByEnumeratingWithState:&v148 objects:v158 count:16];
      if (!v22)
      {
        goto LABEL_30;
      }

      v23 = v22;
      v136 = *v149;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      while (1)
      {
        for (i = 0; i != v23; i = i + 1)
        {
          if (*v149 != v136)
          {
            objc_enumerationMutation(obj);
          }

          v26 = *(*(&v148 + 1) + 8 * i);
          v27 = objc_autoreleasePoolPush();
          v28 = [(MADAutoAssetControlManager *)selfCopy locateSetStatusByInstance:v26];
          v29 = p_weak_ivar_lyt[223];
          clientDomainName = [v28 clientDomainName];
          clientDomainName2 = [doneCopy clientDomainName];
          if ([v29 stringIsEqual:clientDomainName to:clientDomainName2])
          {
            v32 = p_weak_ivar_lyt[223];
            assetSetIdentifier = [v28 assetSetIdentifier];
            assetSetIdentifier2 = [v138 assetSetIdentifier];
            LODWORD(v32) = [v32 stringIsEqual:assetSetIdentifier to:assetSetIdentifier2];

            doneCopy = v138;
            if (!v32)
            {
              goto LABEL_28;
            }

            clientDomainName3 = [v28 clientDomainName];
            assetSetIdentifier3 = [v28 assetSetIdentifier];
            latestDownloadedAtomicInstance = [v28 latestDownloadedAtomicInstance];
            clientDomainName = [MANAutoAssetSetStatus shortTermLockFilename:clientDomainName3 forAssetSetIdentifier:assetSetIdentifier3 forSetAtomicInstance:latestDownloadedAtomicInstance];

            doneCopy = v138;
            [v130 addObject:v26];
            v38 = [(MADAutoAssetControlManager *)selfCopy _shortTermSharedLockRemove:@"_eliminateCompleteIfAllDone" removingSharedLockFilename:clientDomainName usingFileManager:v132 removingDescription:@"atomic-instance shared lock file removed (eliminated set-identifier)"];
          }

          else
          {
          }

LABEL_28:
          objc_autoreleasePoolPop(v27);
          p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        }

        v23 = [obj countByEnumeratingWithState:&v148 objects:v158 count:16];
        if (!v23)
        {
LABEL_30:

          v146 = 0u;
          v147 = 0u;
          v144 = 0u;
          v145 = 0u;
          v39 = v130;
          v40 = [v39 countByEnumeratingWithState:&v144 objects:v157 count:16];
          v10 = v125;
          if (v40)
          {
            v41 = v40;
            v42 = *v145;
            do
            {
              for (j = 0; j != v41; j = j + 1)
              {
                if (*v145 != v42)
                {
                  objc_enumerationMutation(v39);
                }

                v44 = *(*(&v144 + 1) + 8 * j);
                if (v44)
                {
                  currentSetStatusByInstance = [(MADAutoAssetControlManager *)selfCopy currentSetStatusByInstance];
                  [currentSetStatusByInstance removeObjectForKey:v44];
                }
              }

              v41 = [v39 countByEnumeratingWithState:&v144 objects:v157 count:16];
            }

            while (v41);
          }

          v142 = 0u;
          v143 = 0u;
          v140 = 0u;
          v141 = 0u;
          downloadedSetDescriptors = [doneCopy downloadedSetDescriptors];
          v47 = [downloadedSetDescriptors countByEnumeratingWithState:&v140 objects:v156 count:16];
          if (v47)
          {
            v48 = v47;
            v49 = *v141;
            do
            {
              for (k = 0; k != v48; k = k + 1)
              {
                if (*v141 != v49)
                {
                  objc_enumerationMutation(downloadedSetDescriptors);
                }

                v51 = *(*(&v140 + 1) + 8 * k);
                [MADAutoAssetLocker eliminateAllPreviousSetLocksByClient:@"ALL_INSTANCES" forSetDescriptor:v51];
                [(MADAutoAssetControlManager *)selfCopy secureCheckUngraftAll:@"_eliminateCompleteIfAllDone" forSetDescriptorNoLongerLocked:v51];
              }

              v48 = [downloadedSetDescriptors countByEnumeratingWithState:&v140 objects:v156 count:16];
            }

            while (v48);
          }

          doneCopy = v138;
          self = selfCopy;
          autoControlManagerFSM2 = v127;
          goto LABEL_77;
        }
      }
    }

    if (([doneCopy limitedToCancelActivity] & 1) == 0)
    {
      persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v53 = [persistedKnownDescriptors persistedEntryAlreadyExists:autoControlManagerFSM2 fromLocation:@"_eliminateCompleteIfAllDone"];

      if (v53)
      {
        persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v55 = [persistedKnownDescriptors2 persistedEntry:autoControlManagerFSM2 fromLocation:@"_eliminateCompleteIfAllDone"];

        if (v55)
        {
          persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v57 = [persistedKnownDescriptors3 decodeFromLocation:@"_eliminateCompleteIfAllDone" ofEntryName:autoControlManagerFSM2 fromPersistedEntry:v55 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

          if (v57)
          {
            persistedKnownDescriptors4 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            [persistedKnownDescriptors4 removePersistedEntry:autoControlManagerFSM2 fromLocation:@"_eliminateCompleteIfAllDone"];

            v59 = [v57 isOnFilesystem]? @"DOWNLOADED_DESCRIPTORS" : @"JOB_DESCRIPTORS";
            [(MADAutoAssetControlManager *)self _logPersistedRemovedEntry:@"_eliminateCompleteIfAllDone" forComponentType:v59 removedPersistedEntryID:autoControlManagerFSM2 removedDescriptor:v57 message:@"removed persisted descriptor entry (no remaining pending operations)"];
            if ([v57 isOnFilesystem])
            {
              v126 = v10;
              v128 = autoControlManagerFSM2;
              clientRequest = [doneCopy clientRequest];
              clientRequestMessage = [clientRequest clientRequestMessage];

              v137 = clientRequestMessage;
              obja = [clientRequestMessage message];
              v62 = [obja safeObjectForKey:@"instance" ofClass:objc_opt_class()];
              autoAssetClientName = [v62 autoAssetClientName];
              v133 = v62;
              if (autoAssetClientName)
              {
                [v62 autoAssetClientName];
              }

              else
              {
                [v62 clientProcessName];
              }
              v65 = ;

              assetId = [v57 assetId];
              assetSelector3 = [doneCopy assetSelector];
              v131 = v65;
              if (v65)
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromClient:v65 forAssetID:assetId withSelector:assetSelector3];
              }

              else
              {
                [MADAutoAssetHistory recordOperation:300 toHistoryType:0 fromLayer:1 forAssetID:assetId withSelector:assetSelector3];
              }

              if (+[MAAIRBEventReporter isAvailable])
              {
                v68 = [MAAIRBMobileAssetOperationMetadata alloc];
                v69 = [MADAutoAssetHistoryTracker operationName:300];
                v70 = [(MAAIRBMobileAssetOperationMetadata *)v68 initWithCode:300 name:v69];

                v71 = [MAAIRBMobileAssetAssetSelector alloc];
                assetSelector4 = [v138 assetSelector];
                assetType = [assetSelector4 assetType];
                assetSelector5 = [v138 assetSelector];
                assetSpecifier = [assetSelector5 assetSpecifier];
                assetSelector6 = [v138 assetSelector];
                assetVersion = [assetSelector6 assetVersion];
                v78 = [(MAAIRBMobileAssetAssetSelector *)v71 initWithAssetType:assetType assetSpecifier:assetSpecifier assetVersion:assetVersion];

                v79 = [MAAIRBAppleIntelligenceAssetDeliveryEventType typeAssetUpdate:v70 assetSelector:v78];
                v80 = [[MAAIRBAppleIntelligenceAssetDeliveryEvent alloc] initWithErrors:&__NSArray0__struct type:v79];
                [MAAIRBEventReporter emitAppleIntelligenceEndEvent:v80];
              }

              doneCopy = v138;
              self = selfCopy;
              v10 = v126;
              autoControlManagerFSM2 = v128;
            }
          }
        }

        else
        {
          v57 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v57, OS_LOG_TYPE_ERROR))
          {
            summary4 = [doneCopy summary];
            *buf = 138543362;
            v153 = summary4;
            _os_log_impl(&dword_0, v57, OS_LOG_TYPE_ERROR, "\n[ELIMINATE] {_eliminateCompleteIfAllDone} no persisted descriptor entry yet entry already exists | eliminateTracker:%{public}@", buf, 0xCu);
          }
        }

        assetSelector7 = [doneCopy assetSelector];
        v82 = [(MADAutoAssetControlManager *)self jobSelectorKey:assetSelector7];

        if (v82)
        {
          currentStatusBySelector = [(MADAutoAssetControlManager *)self currentStatusBySelector];
          [currentStatusBySelector removeObjectForKey:v82];

          v84 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v84, OS_LOG_TYPE_DEFAULT))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            *buf = 138543618;
            v153 = _updateLatestSummary;
            v154 = 2114;
            v155 = v82;
            _os_log_impl(&dword_0, v84, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n[ASSET_STATUS][REMOVED] | statusKey:%{public}@ | jobUUID:N", buf, 0x16u);
          }
        }
      }
    }

    assetSelector8 = [doneCopy assetSelector];
    v39 = [(MADAutoAssetControlManager *)self currentJobBySelector:assetSelector8];

    if (v39)
    {
      v129 = autoControlManagerFSM2;
      autoControlManagerFSM3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag2 = [autoControlManagerFSM3 diag];
      v89 = [NSString alloc];
      summary5 = [v39 summary];
      [doneCopy summary];
      v92 = v91 = doneCopy;
      v93 = [v89 initWithFormat:@"{_eliminateCompleteIfAllDone} unexpected current job by-selector | autoJob:%@ eliminateTracker:%@", summary5, v92];
      [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v93 withResult:6103 withError:0];

      autoAssetUUID = [v39 autoAssetUUID];
      v95 = [(MADAutoAssetControlManager *)self currentJobByUUID:autoAssetUUID fromLocation:@"_eliminateCompleteIfAllDone" notFoundCode:0 notFoundReason:0];

      if (v95)
      {
        autoControlManagerFSM4 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
        diag3 = [autoControlManagerFSM4 diag];
        v98 = [NSString alloc];
        summary6 = [v95 summary];
        summary7 = [v91 summary];
        v100 = [v98 initWithFormat:@"{_eliminateCompleteIfAllDone} unexpected current job by-UUID | activeJob:%@ eliminateTracker:%@", summary6, summary7];
        [diag3 trackAnomaly:@"AUTO-CONTROL" forReason:v100 withResult:6103 withError:0];
      }

      doneCopy = v91;
      autoControlManagerFSM2 = v129;
    }

    if (([doneCopy limitedToCancelActivity] & 1) == 0)
    {
      [(MADAutoAssetControlManager *)self _removeAllContentForEliminateTracker:doneCopy unlessCurrentlyLocked:0];
    }

LABEL_77:

    clientRequest2 = [doneCopy clientRequest];
    clientReplyCompletion = [clientRequest2 clientReplyCompletion];

    if (!clientReplyCompletion)
    {
      autoControlManagerFSM5 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag4 = [autoControlManagerFSM5 diag];
      v118 = [NSString alloc];
      summary8 = [doneCopy summary];
      v119 = [v118 initWithFormat:@"{_eliminateCompleteIfAllDone} no client reply completion | eliminateTracker:%@", summary8];
      [diag4 trackAnomaly:@"AUTO-CONTROL" forReason:v119 withResult:6111 withError:0];
      goto LABEL_88;
    }

    v104 = autoControlManagerFSM2;
    clientRequest3 = [doneCopy clientRequest];
    clientRequestMessage2 = [clientRequest3 clientRequestMessage];
    v107 = [MADAutoAssetControlManager replyMessageNameForRequest:clientRequestMessage2];
    clientRequest4 = [doneCopy clientRequest];
    clientRequestMessage3 = [clientRequest4 clientRequestMessage];
    clientID = [clientRequestMessage3 clientID];
    autoControlManagerFSM5 = [MADAutoAssetControlManager createSeverMessageWithName:v107 sender:@"com.apple.MAAutoControl" clientID:clientID response:0 error:0];

    doneCopy = v138;
    clientRequest5 = [v138 clientRequest];
    [(MADAutoAssetControlManager *)selfCopy issueResponseToClientRequest:clientRequest5 issuingResponseMessage:autoControlManagerFSM5 withResponseError:0];

    LODWORD(clientRequest5) = [v138 eliminatingSet];
    v113 = _MADLog(@"AutoControl");
    v114 = os_log_type_enabled(v113, OS_LOG_TYPE_DEFAULT);
    if (clientRequest5)
    {
      if (v114)
      {
        summary9 = [v138 summary];
        *buf = 138543362;
        v153 = summary9;
        v116 = "\n[SET-ELIMINATE] {_eliminateCompleteIfAllDone} [SUCCESS] done with set-identifier elimination | eliminateTracker:%{public}@";
LABEL_84:
        _os_log_impl(&dword_0, v113, OS_LOG_TYPE_DEFAULT, v116, buf, 0xCu);
      }
    }

    else if (v114)
    {
      summary9 = [v138 summary];
      *buf = 138543362;
      v153 = summary9;
      v116 = "\n[ELIMINATE] {_eliminateCompleteIfAllDone} [SUCCESS] done with asset-selector elimination | eliminateTracker:%{public}@ | MA_MILESTONE";
      goto LABEL_84;
    }

    assetSelector9 = [v138 assetSelector];
    diag4 = [assetSelector9 persistedEntryID];

    autoControlManagerFSM2 = v104;
    if (diag4)
    {
      summary8 = [(MADAutoAssetControlManager *)selfCopy activelyEliminatingSelectors];
      [summary8 removeObjectForKey:diag4];
LABEL_89:

      goto LABEL_15;
    }

    summary8 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
    v119 = [summary8 diag];
    v122 = [NSString alloc];
    summary10 = [v138 summary];
    v123 = [v122 initWithFormat:@"{_eliminateCompleteIfAllDone} nil persistedEntryID | eliminateTracker:%@", summary10];
    [v119 trackAnomaly:@"AUTO-CONTROL" forReason:v123 withResult:6111 withError:0];

LABEL_88:
    goto LABEL_89;
  }

LABEL_16:
}

- (BOOL)_doesEliminateSelector:(id)selector matchAssetType:(id)type withAssetSpecifier:(id)specifier withAssetVersion:(id)version fromLocation:(id)location
{
  selectorCopy = selector;
  typeCopy = type;
  specifierCopy = specifier;
  versionCopy = version;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  assetVersion = [selectorCopy assetVersion];

  if (assetVersion)
  {
    assetType = [selectorCopy assetType];
    if ([SUCore stringIsEqual:typeCopy to:assetType])
    {
      assetSpecifier = [selectorCopy assetSpecifier];
      if ([SUCore stringIsEqual:specifierCopy to:assetSpecifier])
      {
        assetVersion2 = [selectorCopy assetVersion];
        v21 = [SUCore stringIsEqual:versionCopy to:assetVersion2];
      }

      else
      {
        v21 = 0;
      }

      goto LABEL_10;
    }

    v21 = 0;
  }

  else
  {
    assetSpecifier2 = [selectorCopy assetSpecifier];

    assetType = [selectorCopy assetType];
    v23 = [SUCore stringIsEqual:typeCopy to:assetType];
    v21 = (assetSpecifier2 == 0) & v23;
    if (assetSpecifier2 && (v23 & 1) != 0)
    {
      assetSpecifier = [selectorCopy assetSpecifier];
      v21 = [SUCore stringIsEqual:specifierCopy to:assetSpecifier];
LABEL_10:
    }
  }

  return v21;
}

- (BOOL)timerStartForRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:timerStartForRequest", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  v43 = 0;
  v11 = [(MADAutoAssetControlManager *)self clientRequestTimeoutSecs:requestCopy timeoutWasSpecified:&v43];
  if (v11 == -2 || (v43 & 1) == 0)
  {
    if (+[MADAutoAssetControlManager isDeviceConsideredBeforeFirstUnlock])
    {
      v11 = +[MADAutoAssetControlManager preferenceBeforeFirstDefaultTimeoutSecs];
      if (v11 < 0)
      {
        v11 = 600;
LABEL_8:
        v13 = [[MADAutoAssetTimed alloc] initForRequest:requestCopy withTimeout:v11];
        if (!v13)
        {
          v28 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v30 = [requestCopy summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = _updateLatestSummary;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = locationCopy;
            v51 = 2114;
            v52 = @"AFAIL";
            v53 = 2114;
            v54 = @"AFAIL";
            v55 = 2114;
            v56 = v30;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) failed to create timedOperation\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }

          v12 = 1;
          goto LABEL_23;
        }

        timedOperations = [(MADAutoAssetControlManager *)self timedOperations];
        timerUUID = [v13 timerUUID];
        [timedOperations setSafeObject:v13 forKey:timerUUID];

        v16 = v11;
        v36 = _NSConcreteStackBlock;
        v37 = 3221225472;
        v38 = __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke;
        v39 = &unk_4B4938;
        selfCopy = self;
        v17 = v13;
        v41 = v17;
        v18 = locationCopy;
        v42 = v18;
        v19 = [NSTimer timerWithTimeInterval:0 repeats:&v36 block:v16];
        [v17 setTimerInstance:{v19, v36, v37, v38, v39, selfCopy}];

        timerInstance = [v17 timerInstance];
        LODWORD(v19) = timerInstance == 0;

        if (v19)
        {
          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v32 = [requestCopy summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = _updateLatestSummary2;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = v18;
            v51 = 2114;
            v52 = @"CFAIL";
            v53 = 2114;
            v54 = @"CFAIL";
            v55 = 2114;
            v56 = v32;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) unable to create timer\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }
        }

        else
        {
          v21 = +[NSRunLoop mainRunLoop];
          v22 = v21 == 0;

          if (!v22)
          {
            [requestCopy setTimedTracker:v17];
            v23 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
            {
              _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
              v25 = [requestCopy summaryWithResponseMessage:0];
              *buf = 138544642;
              v46 = _updateLatestSummary3;
              v47 = 2114;
              v48 = @">----->";
              v49 = 2114;
              v50 = v18;
              v51 = 2114;
              v52 = @"START";
              v53 = 2114;
              v54 = v25;
              v55 = 2114;
              v56 = @"<-----<";
              _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
            }

            v26 = +[NSRunLoop mainRunLoop];
            timerInstance2 = [v17 timerInstance];
            [v26 addTimer:timerInstance2 forMode:NSDefaultRunLoopMode];

            v12 = 1;
            goto LABEL_22;
          }

          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            _updateLatestSummary4 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
            v34 = [requestCopy summaryWithResponseMessage:0];
            *buf = 138544898;
            v46 = _updateLatestSummary4;
            v47 = 2114;
            v48 = @">----->";
            v49 = 2114;
            v50 = v18;
            v51 = 2114;
            v52 = @"CFAIL";
            v53 = 2114;
            v54 = @"CFAIL";
            v55 = 2114;
            v56 = v34;
            v57 = 2114;
            v58 = @"<-----<";
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) unable to add timer to run loop\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x48u);
          }
        }

        v12 = 0;
LABEL_22:

LABEL_23:
        goto LABEL_24;
      }
    }
  }

  if (v11 >= 1)
  {
    goto LABEL_8;
  }

  v12 = 1;
LABEL_24:
  os_activity_scope_leave(&state);

  return v12;
}

void __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke(uint64_t a1)
{
  v2 = [*(a1 + 32) autoControlManagerFSM];
  v3 = [v2 extendedStateQueue];
  block[0] = _NSConcreteStackBlock;
  block[1] = 3221225472;
  block[2] = __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke_2;
  block[3] = &unk_4B2AF0;
  v4 = *(a1 + 40);
  block[4] = *(a1 + 32);
  v6 = v4;
  v7 = *(a1 + 48);
  dispatch_async(v3, block);
}

void __64__MADAutoAssetControlManager_timerStartForRequest_fromLocation___block_invoke_2(uint64_t a1)
{
  v2 = [*(a1 + 32) timedOperations];
  v3 = [*(a1 + 40) timerUUID];
  v4 = [v2 safeObjectForKey:v3 ofClass:objc_opt_class()];

  v5 = [v4 requestBeingTimed];
  if (([*(a1 + 40) timerInvalidated] & 1) == 0 && v4 && (objc_msgSend(v5, "clientReplyCompletion"), v6 = objc_claimAutoreleasedReturnValue(), v6, v6))
  {
    v7 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      v8 = [*(a1 + 32) _updateLatestSummary];
      v9 = *(a1 + 48);
      v10 = [v5 summaryWithResponseMessage:0];
      *buf = 138544642;
      v43 = v8;
      v44 = 2114;
      v45 = @">----->";
      v46 = 2114;
      v47 = v9;
      v48 = 2114;
      v49 = @"FIRED";
      v50 = 2114;
      v51 = v10;
      v52 = 2114;
      v53 = @"<-----<";
      _os_log_impl(&dword_0, v7, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
    }

    v11 = [v5 responseError];

    if (!v11)
    {
      v12 = [v5 clientRequestMessage];
      v13 = [v12 messageName];

      v14 = +[MADAutoAssetControlManager allocIntervalString:](MADAutoAssetControlManager, "allocIntervalString:", [*(a1 + 40) timeoutSecs]);
      if (([SUCore stringIsEqual:v13 to:@"MA-AUTO:CHECK_FOR_NEWER"]& 1) != 0)
      {
        v15 = @"checkForNewer";
        v16 = 6208;
        v17 = @"check job (in the background)";
      }

      else
      {
        v27 = [SUCore stringIsEqual:v13 to:@"MA-AUTO:LOCK_CONTENT"];
        if (v27)
        {
          v17 = @"reduced job (attempting download but will not lock)";
        }

        else
        {
          v17 = @"decoupled job";
        }

        if (v27)
        {
          v15 = @"lockContent";
        }

        else
        {
          v15 = @"operation";
        }

        if (v27)
        {
          v16 = 6505;
        }

        else
        {
          v16 = 6105;
        }
      }

      v28 = [[NSString alloc] initWithFormat:@"requested %@ unable to complete after waiting %@ | (TIMEOUT) continuing %@", v15, v14, v17];
      v29 = [MAAutoAssetError buildError:v16 fromOperation:*(a1 + 48) underlyingError:0 withDescription:v28];
      [v5 setResponseError:v29];
    }

    v30 = [v5 clientRequestMessage];
    v31 = [MADAutoAssetControlManager replyMessageNameForRequest:v30];
    v32 = [v5 clientID];
    v33 = [v5 responseError];
    v34 = [MADAutoAssetControlManager createSeverMessageWithName:v31 sender:@"com.apple.MAAutoControl" clientID:v32 response:0 error:v33];
    [v5 setResponseMessage:v34];

    v35 = *(a1 + 32);
    v36 = [v5 responseMessage];
    v37 = [v5 responseError];
    [v35 issueResponseToClientRequest:v5 issuingResponseMessage:v36 withResponseError:v37];

    [*(a1 + 40) setTimerInvalidated:1];
  }

  else
  {
    v18 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
    {
      v19 = [*(a1 + 32) _updateLatestSummary];
      v20 = *(a1 + 48);
      v21 = [v5 summaryWithResponseMessage:0];
      *buf = 138544642;
      v43 = v19;
      v44 = 2114;
      v45 = @">----->";
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = @"INVAL";
      v50 = 2114;
      v51 = v21;
      v52 = 2114;
      v53 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", buf, 0x3Eu);
    }

    [*(a1 + 40) setTimerInvalidated:1];
    if (!v4)
    {
      v22 = [*(a1 + 32) autoControlManagerFSM];
      v23 = [v22 diag];
      v24 = [NSString alloc];
      v25 = [*(a1 + 40) summary];
      v26 = [v24 initWithFormat:@"{timerStartForRequest} untracked timer fired | timedOperation:%@", v25];
LABEL_27:
      v41 = v26;
      [v23 trackAnomaly:@"AUTO-CONTROL" forReason:v26 withResult:6111 withError:0];

      goto LABEL_28;
    }
  }

  v38 = [*(a1 + 40) timerUUID];

  v39 = *(a1 + 32);
  if (!v38)
  {
    v22 = [v39 autoControlManagerFSM];
    v23 = [v22 diag];
    v40 = [NSString alloc];
    v25 = [*(a1 + 40) summary];
    v26 = [v40 initWithFormat:@"{timerStartForRequest} nil timerUUID | timedOperation:%@", v25];
    goto LABEL_27;
  }

  v22 = [v39 timedOperations];
  v23 = [*(a1 + 40) timerUUID];
  [v22 removeObjectForKey:v23];
LABEL_28:
}

- (void)timerStopForClientRequest:(id)request fromLocation:(id)location
{
  requestCopy = request;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  timedTracker = [requestCopy timedTracker];
  timedOperations = [(MADAutoAssetControlManager *)self timedOperations];
  timerUUID = [timedTracker timerUUID];
  v13 = [timedOperations safeObjectForKey:timerUUID ofClass:objc_opt_class()];

  if (v13)
  {
    timerInstance = [v13 timerInstance];
    if (timerInstance)
    {
      v15 = timerInstance;
      timerInvalidated = [v13 timerInvalidated];

      if ((timerInvalidated & 1) == 0)
      {
        [v13 setTimerInvalidated:1];
        v17 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v17, OS_LOG_TYPE_DEFAULT))
        {
          _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
          v19 = [requestCopy summaryWithResponseMessage:0];
          v21 = 138544642;
          v22 = _updateLatestSummary;
          v23 = 2114;
          v24 = @">----->";
          v25 = 2114;
          v26 = locationCopy;
          v27 = 2114;
          v28 = @"STOPD";
          v29 = 2114;
          v30 = v19;
          v31 = 2114;
          v32 = @"<-----<";
          _os_log_impl(&dword_0, v17, OS_LOG_TYPE_DEFAULT, "[%{public}@]\n#_CLTMR:%{public}@ {%{public}@}\n#_CLTMR:(%{public}@) clientRequest:%{public}@\n#_CLTMR:%{public}@", &v21, 0x3Eu);
        }

        timerInstance2 = [v13 timerInstance];
        [timerInstance2 fire];
      }
    }
  }
}

- (int64_t)clientRequestTimeoutSecs:(id)secs timeoutWasSpecified:(BOOL *)specified
{
  secsCopy = secs;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  clientRequestMessage = [secsCopy clientRequestMessage];
  v10 = [(MADAutoAssetControlManager *)self clientRequestMessageDesire:clientRequestMessage];

  if (!v10)
  {
    clientReplyCompletion = 0;
    goto LABEL_14;
  }

  clientReplyCompletion = [secsCopy clientReplyCompletion];

  if (!clientReplyCompletion)
  {
    v14 = 0;
    if (!specified)
    {
      goto LABEL_14;
    }

    goto LABEL_13;
  }

  v12 = [(MADAutoAssetControlManager *)self clientRequestMessageName:secsCopy];
  if ([SUCore stringIsEqual:v12 to:@"MA-AUTO:CHECK_FOR_NEWER"])
  {
    checkWaitTimeoutSecs = [v10 checkWaitTimeoutSecs];
LABEL_10:
    clientReplyCompletion = checkWaitTimeoutSecs;
    v14 = 1;
    goto LABEL_12;
  }

  if ([SUCore stringIsEqual:v12 to:@"MA-AUTO:LOCK_CONTENT"])
  {
    checkWaitTimeoutSecs = [v10 lockWaitTimeoutSecs];
    goto LABEL_10;
  }

  v14 = 0;
  clientReplyCompletion = 0;
LABEL_12:

  if (specified)
  {
LABEL_13:
    *specified = v14;
  }

LABEL_14:

  return clientReplyCompletion;
}

+ (BOOL)preferenceScheduledAlwaysNonDiscretionary
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceScheduledAlwaysNonDiscretionary = [v2 preferenceScheduledAlwaysNonDiscretionary];
  }

  else
  {
    preferenceScheduledAlwaysNonDiscretionary = 0;
  }

  return preferenceScheduledAlwaysNonDiscretionary;
}

+ (BOOL)preferenceScheduledBackupTriggersDisabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceScheduledBackupTriggersDisabled = [v2 preferenceScheduledBackupTriggersDisabled];
  }

  else
  {
    preferenceScheduledBackupTriggersDisabled = 0;
  }

  return preferenceScheduledBackupTriggersDisabled;
}

+ (id)preferenceScheduledOnlyForAssetTypes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  preferenceScheduledOnlyForAssetTypes = [v2 preferenceScheduledOnlyForAssetTypes];

  if (preferenceScheduledOnlyForAssetTypes)
  {
    preferenceScheduledOnlyForAssetTypes2 = [v2 preferenceScheduledOnlyForAssetTypes];
    v5 = [preferenceScheduledOnlyForAssetTypes2 componentsSeparatedByString:{@", "}];

    if ([v5 count])
    {
      v6 = v5;
    }

    else
    {
      v6 = objc_alloc_init(NSArray);
    }

    v7 = v6;
  }

  else
  {
    v7 = 0;
  }

  return v7;
}

+ (id)preferenceSessionIDBase
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSessionIDBase = [v2 preferenceSessionIDBase];
  }

  else
  {
    preferenceSessionIDBase = 0;
  }

  return preferenceSessionIDBase;
}

+ (int64_t)preferenceConnectorInitialWaitSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceConnectorInitialWaitSecs = [v2 preferenceConnectorInitialWaitSecs];
  }

  else
  {
    preferenceConnectorInitialWaitSecs = -1;
  }

  return preferenceConnectorInitialWaitSecs;
}

+ (id)preferenceConnectorBackoffRetryTimes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceConnectorBackoffRetryTimes = [v2 preferenceConnectorBackoffRetryTimes];
  }

  else
  {
    preferenceConnectorBackoffRetryTimes = 0;
  }

  return preferenceConnectorBackoffRetryTimes;
}

+ (int64_t)preferenceConnectorWaitBeforeRetrySecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceConnectorWaitBeforeRetrySecs = [v2 preferenceConnectorWaitBeforeRetrySecs];
  }

  else
  {
    preferenceConnectorWaitBeforeRetrySecs = -1;
  }

  return preferenceConnectorWaitBeforeRetrySecs;
}

+ (BOOL)preferenceAutoAssetObserverIgnoreNetworkStatus
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAutoAssetObserverIgnoreNetworkStatus = [v2 preferenceAutoAssetObserverIgnoreNetworkStatus];
  }

  else
  {
    preferenceAutoAssetObserverIgnoreNetworkStatus = 0;
  }

  return preferenceAutoAssetObserverIgnoreNetworkStatus;
}

+ (BOOL)preferenceAutoAssetLogSetCompare
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAutoAssetLogSetCompare = [v2 preferenceAutoAssetLogSetCompare];
  }

  else
  {
    preferenceAutoAssetLogSetCompare = 0;
  }

  return preferenceAutoAssetLogSetCompare;
}

+ (BOOL)preferenceAutoAssetNoPersistedOverflowLimit
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAutoAssetNoPersistedOverflowLimit = [v2 preferenceAutoAssetNoPersistedOverflowLimit];
  }

  else
  {
    preferenceAutoAssetNoPersistedOverflowLimit = 0;
  }

  return preferenceAutoAssetNoPersistedOverflowLimit;
}

+ (int64_t)preferenceMaxStagerDeterminingSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceMaxStagerDeterminingSecs = [v2 preferenceMaxStagerDeterminingSecs];
  }

  else
  {
    preferenceMaxStagerDeterminingSecs = -1;
  }

  return preferenceMaxStagerDeterminingSecs;
}

+ (int64_t)preferenceMaxStagerFilesystemMegabytes
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceMaxStagerFilesystemMegabytes = [v2 preferenceMaxStagerFilesystemMegabytes];
  }

  else
  {
    preferenceMaxStagerFilesystemMegabytes = -1;
  }

  return preferenceMaxStagerFilesystemMegabytes;
}

+ (BOOL)preferenceStagerInjectAvailableDups
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagerInjectAvailableDups = [v2 preferenceStagerInjectAvailableDups];
  }

  else
  {
    preferenceStagerInjectAvailableDups = 0;
  }

  return preferenceStagerInjectAvailableDups;
}

+ (BOOL)preferenceStagerInjectAvailableOlderVersions
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagerInjectAvailableOlderVersions = [v2 preferenceStagerInjectAvailableOlderVersions];
  }

  else
  {
    preferenceStagerInjectAvailableOlderVersions = 0;
  }

  return preferenceStagerInjectAvailableOlderVersions;
}

+ (int64_t)preferenceStagerDeterminePallasResponseFewer
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagerDeterminePallasResponseFewer = [v2 preferenceStagerDeterminePallasResponseFewer];
  }

  else
  {
    preferenceStagerDeterminePallasResponseFewer = -1;
  }

  return preferenceStagerDeterminePallasResponseFewer;
}

+ (BOOL)preferenceStagerDownloadFirstNotInCatalog
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagerDownloadFirstNotInCatalog = [v2 preferenceStagerDownloadFirstNotInCatalog];
  }

  else
  {
    preferenceStagerDownloadFirstNotInCatalog = 0;
  }

  return preferenceStagerDownloadFirstNotInCatalog;
}

+ (BOOL)preferenceStagerDetermineLastRequiredTimesOut
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagerDetermineLastRequiredTimesOut = [v2 preferenceStagerDetermineLastRequiredTimesOut];
  }

  else
  {
    preferenceStagerDetermineLastRequiredTimesOut = 0;
  }

  return preferenceStagerDetermineLastRequiredTimesOut;
}

+ (id)preferenceAsIfBootedOSIsOSVersion
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAsIfBootedOSIsOSVersion = [v2 preferenceAsIfBootedOSIsOSVersion];
  }

  else
  {
    preferenceAsIfBootedOSIsOSVersion = 0;
  }

  return preferenceAsIfBootedOSIsOSVersion;
}

+ (id)preferenceAsIfBootedOSIsBuildVersion
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAsIfBootedOSIsBuildVersion = [v2 preferenceAsIfBootedOSIsBuildVersion];
  }

  else
  {
    preferenceAsIfBootedOSIsBuildVersion = 0;
  }

  return preferenceAsIfBootedOSIsBuildVersion;
}

+ (BOOL)preferenceAsIfBackgroundOrUse:(BOOL)use
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = v4;
  if (v4 && [v4 preferenceAsIfBackgroundSpecified])
  {
    use = [v5 preferenceAsIfBackground];
  }

  return use;
}

+ (BOOL)preferenceAsIfRampOrUse:(BOOL)use
{
  v4 = +[MADAutoAssetControlManager autoControlManager];
  v5 = v4;
  if (v4 && [v4 preferenceAsIfRampSpecified])
  {
    use = [v5 preferenceAsIfRamp];
  }

  return use;
}

+ (BOOL)preferenceAlwaysPromoteStagedAssets
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceAlwaysPromoteStagedAssets = [v2 preferenceAlwaysPromoteStagedAssets];
  }

  else
  {
    preferenceAlwaysPromoteStagedAssets = 0;
  }

  return preferenceAlwaysPromoteStagedAssets;
}

+ (BOOL)preferenceScheduledAsIfNotInternal
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceScheduledAsIfNotInternal = [v2 preferenceScheduledAsIfNotInternal];
  }

  else
  {
    preferenceScheduledAsIfNotInternal = 0;
  }

  return preferenceScheduledAsIfNotInternal;
}

+ (int64_t)preferenceActivityTickerSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityTickerSecs = [v2 preferenceActivityTickerSecs];
  }

  else
  {
    preferenceActivityTickerSecs = -1;
  }

  return preferenceActivityTickerSecs;
}

+ (int64_t)preferenceActivityIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityIntervalSecs = [v2 preferenceActivityIntervalSecs];
  }

  else
  {
    preferenceActivityIntervalSecs = -1;
  }

  return preferenceActivityIntervalSecs;
}

+ (int64_t)preferencePushActivityIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferencePushActivityIntervalSecs = [v2 preferencePushActivityIntervalSecs];
  }

  else
  {
    preferencePushActivityIntervalSecs = -1;
  }

  return preferencePushActivityIntervalSecs;
}

+ (int64_t)preferenceActivityHeightenedIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityHeightenedIntervalSecs = [v2 preferenceActivityHeightenedIntervalSecs];
  }

  else
  {
    preferenceActivityHeightenedIntervalSecs = -1;
  }

  return preferenceActivityHeightenedIntervalSecs;
}

+ (int64_t)preferenceActivityAggressiveIntervalSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityAggressiveIntervalSecs = [v2 preferenceActivityAggressiveIntervalSecs];
  }

  else
  {
    preferenceActivityAggressiveIntervalSecs = -1;
  }

  return preferenceActivityAggressiveIntervalSecs;
}

+ (id)preferenceActivityHeightenedAssetType
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityHeightenedAssetType = [v2 preferenceActivityHeightenedAssetType];
  }

  else
  {
    preferenceActivityHeightenedAssetType = 0;
  }

  return preferenceActivityHeightenedAssetType;
}

+ (id)preferenceActivityAggressiveAssetType
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceActivityAggressiveAssetType = [v2 preferenceActivityAggressiveAssetType];
  }

  else
  {
    preferenceActivityAggressiveAssetType = 0;
  }

  return preferenceActivityAggressiveAssetType;
}

+ (int64_t)preferenceLookupCacheAssetSelectorValidSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceLookupCacheAssetSelectorValidSecs = [v2 preferenceLookupCacheAssetSelectorValidSecs];
  }

  else
  {
    preferenceLookupCacheAssetSelectorValidSecs = -1;
  }

  return preferenceLookupCacheAssetSelectorValidSecs;
}

+ (int64_t)preferenceLookupCacheSetConfigurationValidSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceLookupCacheSetConfigurationValidSecs = [v2 preferenceLookupCacheSetConfigurationValidSecs];
  }

  else
  {
    preferenceLookupCacheSetConfigurationValidSecs = -1;
  }

  return preferenceLookupCacheSetConfigurationValidSecs;
}

+ (int64_t)preferenceBeforeFirstPollSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceBeforeFirstPollSecs = [v2 preferenceBeforeFirstPollSecs];
  }

  else
  {
    preferenceBeforeFirstPollSecs = -1;
  }

  return preferenceBeforeFirstPollSecs;
}

+ (int64_t)preferenceBeforeFirstDefaultTimeoutSecs
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceBeforeFirstDefaultTimeoutSecs = [v2 preferenceBeforeFirstDefaultTimeoutSecs];
  }

  else
  {
    preferenceBeforeFirstDefaultTimeoutSecs = -1;
  }

  return preferenceBeforeFirstDefaultTimeoutSecs;
}

+ (BOOL)preferenceSecureSimulateRequireAll
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSecureSimulateRequireAll = [v2 preferenceSecureSimulateRequireAll];
  }

  else
  {
    preferenceSecureSimulateRequireAll = 0;
  }

  return preferenceSecureSimulateRequireAll;
}

+ (BOOL)preferenceSecureSimulateFailureAll
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSecureSimulateFailureAll = [v2 preferenceSecureSimulateFailureAll];
  }

  else
  {
    preferenceSecureSimulateFailureAll = 0;
  }

  return preferenceSecureSimulateFailureAll;
}

+ (BOOL)preferenceSecureSimulateGraftFailure
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSecureSimulateGraftFailure = [v2 preferenceSecureSimulateGraftFailure];
  }

  else
  {
    preferenceSecureSimulateGraftFailure = 0;
  }

  return preferenceSecureSimulateGraftFailure;
}

+ (int64_t)preferenceSimulatedDownloadFailureResult
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSimulatedDownloadFailureResult = [v2 preferenceSimulatedDownloadFailureResult];
  }

  else
  {
    preferenceSimulatedDownloadFailureResult = -1;
  }

  return preferenceSimulatedDownloadFailureResult;
}

+ (int64_t)preferenceSimulatedStagingLookupFailureResult
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceSimulatedStagingLookupFailureResult = [v2 preferenceSimulatedStagingLookupFailureResult];
  }

  else
  {
    preferenceSimulatedStagingLookupFailureResult = -1;
  }

  return preferenceSimulatedStagingLookupFailureResult;
}

+ (BOOL)preferencePersistedTableLoggingEnabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferencePersistedTableLoggingEnabled = [v2 preferencePersistedTableLoggingEnabled];
  }

  else
  {
    preferencePersistedTableLoggingEnabled = 0;
  }

  return preferencePersistedTableLoggingEnabled;
}

+ (BOOL)preferencePerformanceLoggingEnabled
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferencePerformanceLoggingEnabled = [v2 preferencePerformanceLoggingEnabled];
  }

  else
  {
    preferencePerformanceLoggingEnabled = 0;
  }

  return preferencePerformanceLoggingEnabled;
}

+ (BOOL)preferenceStagingLookupFlipRequiredOptional
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStagingLookupFlipRequiredOptional = [v2 preferenceStagingLookupFlipRequiredOptional];
  }

  else
  {
    preferenceStagingLookupFlipRequiredOptional = 0;
  }

  return preferenceStagingLookupFlipRequiredOptional;
}

+ (BOOL)preferenceStartupSimulateFirstBoot
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceStartupSimulateFirstBoot = [v2 preferenceStartupSimulateFirstBoot];
  }

  else
  {
    preferenceStartupSimulateFirstBoot = 0;
  }

  return preferenceStartupSimulateFirstBoot;
}

+ (BOOL)preferenceForceStartupHealthReport
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceForceStartupHealthReport = [v2 preferenceForceStartupHealthReport];
  }

  else
  {
    preferenceForceStartupHealthReport = 0;
  }

  return preferenceForceStartupHealthReport;
}

+ (id)preferenceHealthReportAdditionalSetNames
{
  v2 = +[MADAutoAssetControlManager autoControlManager];
  v3 = v2;
  if (v2)
  {
    preferenceHealthReportAdditionalSetNames = [v2 preferenceHealthReportAdditionalSetNames];
  }

  else
  {
    preferenceHealthReportAdditionalSetNames = 0;
  }

  return preferenceHealthReportAdditionalSetNames;
}

- (void)_logPersistedEntry:(id)entry forComponentType:(id)type operation:(id)operation forPersistedEntryID:(id)d forClientRequest:(id)request withJobUUID:(id)iD withAssetDescriptor:(id)descriptor baseForPatchDescriptor:(id)self0 message:(id)self1
{
  entryCopy = entry;
  typeCopy = type;
  operationCopy = operation;
  dCopy = d;
  requestCopy = request;
  iDCopy = iD;
  descriptorCopy = descriptor;
  patchDescriptorCopy = patchDescriptor;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v26 = dCopy;
  if (dCopy)
  {
    v52 = messageCopy;
    v53 = descriptorCopy;
    v27 = entryCopy;
    v51 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    v28 = [MADAutoAssetPersisted persistedComponentSymbol:typeCopy];
    v29 = _MADLog(@"AutoControl");
    v30 = os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT);
    if (patchDescriptorCopy)
    {
      if (requestCopy)
      {
        if (iDCopy)
        {
          if (v30)
          {
            newSummaryWithoutSelector = [v53 newSummaryWithoutSelector];
            v31 = [MADAutoAssetControlManager newSummaryForRequestMessage:requestCopy includingSelector:0];
            [patchDescriptorCopy summary];
            *buf = 138548738;
            v58 = @"PERSISTED";
            v59 = 2114;
            v60 = typeCopy;
            v61 = 2114;
            v62 = operationCopy;
            v63 = 2114;
            v64 = v28;
            v65 = 2114;
            v66 = @">----->";
            v67 = 2114;
            v68 = entryCopy;
            v69 = 2114;
            v70 = v52;
            v71 = 2114;
            v72 = v28;
            v73 = 2114;
            v74 = v51;
            v75 = 2114;
            v76 = v26;
            v77 = 2114;
            v78 = newSummaryWithoutSelector;
            v79 = 2114;
            v80 = v28;
            v81 = 2114;
            v82 = v51;
            v83 = 2114;
            v84 = v31;
            v85 = 2114;
            v86 = v28;
            v87 = 2114;
            v88 = v51;
            v89 = 2114;
            v90 = iDCopy;
            v91 = 2114;
            v92 = v28;
            v93 = 2114;
            v94 = v51;
            v96 = v95 = 2114;
            v32 = v96;
            v97 = 2114;
            v98 = v28;
            v99 = 2114;
            v100 = @"<-----<";
            v33 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
            v34 = v29;
            v35 = 222;
LABEL_18:
            _os_log_impl(&dword_0, v34, OS_LOG_TYPE_DEFAULT, v33, buf, v35);
          }
        }

        else if (v30)
        {
          newSummaryWithoutSelector = [v53 newSummaryWithoutSelector];
          v31 = [MADAutoAssetControlManager newSummaryForRequestMessage:requestCopy includingSelector:0];
          [patchDescriptorCopy summary];
          *buf = 138547970;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = typeCopy;
          v61 = 2114;
          v62 = operationCopy;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = entryCopy;
          v69 = 2114;
          v70 = v52;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = newSummaryWithoutSelector;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = v51;
          v83 = 2114;
          v84 = v31;
          v85 = 2114;
          v86 = v28;
          v87 = 2114;
          v88 = v51;
          v90 = v89 = 2114;
          v32 = v90;
          v91 = 2114;
          v92 = v28;
          v93 = 2114;
          v94 = @"<-----<";
          v33 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
          v34 = v29;
          v35 = 192;
          goto LABEL_18;
        }

LABEL_32:

        messageCopy = v52;
        v39 = v53;
        goto LABEL_33;
      }

      if (iDCopy)
      {
        if (!v30)
        {
          goto LABEL_32;
        }

        newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
        summary = [patchDescriptorCopy summary];
        *buf = 138547970;
        v58 = @"PERSISTED";
        v59 = 2114;
        v60 = typeCopy;
        v61 = 2114;
        v62 = operationCopy;
        v63 = 2114;
        v64 = v28;
        v65 = 2114;
        v66 = @">----->";
        v67 = 2114;
        v68 = entryCopy;
        v69 = 2114;
        v70 = v52;
        v71 = 2114;
        v72 = v28;
        v73 = 2114;
        v74 = v51;
        v75 = 2114;
        v76 = v26;
        v77 = 2114;
        v78 = newSummaryWithoutSelector2;
        v79 = 2114;
        v80 = v28;
        v81 = 2114;
        v82 = v51;
        v83 = 2114;
        v84 = iDCopy;
        v85 = 2114;
        v86 = v28;
        v87 = 2114;
        v88 = v51;
        v89 = 2114;
        v90 = summary;
        v91 = 2114;
        v92 = v28;
        v93 = 2114;
        v94 = @"<-----<";
        v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:(%{public}@) baePatch:%{public}@\n#_%{public}@:%{public}@";
LABEL_15:
        v45 = v29;
        v46 = 192;
LABEL_27:
        _os_log_impl(&dword_0, v45, OS_LOG_TYPE_DEFAULT, v44, buf, v46);

        goto LABEL_31;
      }

      if (!v30)
      {
        goto LABEL_32;
      }

      newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
      summary = [patchDescriptorCopy summary];
      *buf = 138547202;
      v58 = @"PERSISTED";
      v59 = 2114;
      v60 = typeCopy;
      v61 = 2114;
      v62 = operationCopy;
      v63 = 2114;
      v64 = v28;
      v65 = 2114;
      v66 = @">----->";
      v67 = 2114;
      v68 = entryCopy;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = v28;
      v73 = 2114;
      v74 = v51;
      v75 = 2114;
      v76 = v26;
      v77 = 2114;
      v78 = newSummaryWithoutSelector2;
      v79 = 2114;
      v80 = v28;
      v81 = 2114;
      v82 = v51;
      v83 = 2114;
      v84 = summary;
      v85 = 2114;
      v86 = v28;
      v87 = 2114;
      v88 = @"<-----<";
      v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) basePatch:%{public}@\n#_%{public}@:%{public}@";
    }

    else
    {
      if (!requestCopy)
      {
        if (iDCopy)
        {
          if (!v30)
          {
            goto LABEL_32;
          }

          newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
          *buf = 138547202;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = typeCopy;
          v61 = 2114;
          v62 = operationCopy;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = entryCopy;
          v69 = 2114;
          v70 = messageCopy;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = newSummaryWithoutSelector2;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = v51;
          v83 = 2114;
          v84 = iDCopy;
          v85 = 2114;
          v86 = v28;
          v87 = 2114;
          v88 = @"<-----<";
          v47 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
          v48 = v29;
          v49 = 162;
        }

        else
        {
          if (!v30)
          {
            goto LABEL_32;
          }

          newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
          *buf = 138546434;
          v58 = @"PERSISTED";
          v59 = 2114;
          v60 = typeCopy;
          v61 = 2114;
          v62 = operationCopy;
          v63 = 2114;
          v64 = v28;
          v65 = 2114;
          v66 = @">----->";
          v67 = 2114;
          v68 = entryCopy;
          v69 = 2114;
          v70 = messageCopy;
          v71 = 2114;
          v72 = v28;
          v73 = 2114;
          v74 = v51;
          v75 = 2114;
          v76 = v26;
          v77 = 2114;
          v78 = newSummaryWithoutSelector2;
          v79 = 2114;
          v80 = v28;
          v81 = 2114;
          v82 = @"<-----<";
          v47 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@";
          v48 = v29;
          v49 = 132;
        }

        _os_log_impl(&dword_0, v48, OS_LOG_TYPE_DEFAULT, v47, buf, v49);
LABEL_31:

        goto LABEL_32;
      }

      if (iDCopy)
      {
        if (!v30)
        {
          goto LABEL_32;
        }

        newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
        summary = [MADAutoAssetControlManager newSummaryForRequestMessage:requestCopy includingSelector:0];
        *buf = 138547970;
        v58 = @"PERSISTED";
        v59 = 2114;
        v60 = typeCopy;
        v61 = 2114;
        v62 = operationCopy;
        v63 = 2114;
        v64 = v28;
        v65 = 2114;
        v66 = @">----->";
        v67 = 2114;
        v68 = entryCopy;
        v69 = 2114;
        v70 = v52;
        v71 = 2114;
        v72 = v28;
        v73 = 2114;
        v74 = v51;
        v75 = 2114;
        v76 = v26;
        v77 = 2114;
        v78 = newSummaryWithoutSelector2;
        v79 = 2114;
        v80 = v28;
        v81 = 2114;
        v82 = v51;
        v83 = 2114;
        v84 = summary;
        v85 = 2114;
        v86 = v28;
        v87 = 2114;
        v88 = v51;
        v89 = 2114;
        v90 = iDCopy;
        v91 = 2114;
        v92 = v28;
        v93 = 2114;
        v94 = @"<-----<";
        v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
        goto LABEL_15;
      }

      if (!v30)
      {
        goto LABEL_32;
      }

      newSummaryWithoutSelector2 = [v53 newSummaryWithoutSelector];
      summary = [MADAutoAssetControlManager newSummaryForRequestMessage:requestCopy includingSelector:0];
      *buf = 138547202;
      v58 = @"PERSISTED";
      v59 = 2114;
      v60 = typeCopy;
      v61 = 2114;
      v62 = operationCopy;
      v63 = 2114;
      v64 = v28;
      v65 = 2114;
      v66 = @">----->";
      v67 = 2114;
      v68 = entryCopy;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = v28;
      v73 = 2114;
      v74 = v51;
      v75 = 2114;
      v76 = v26;
      v77 = 2114;
      v78 = newSummaryWithoutSelector2;
      v79 = 2114;
      v80 = v28;
      v81 = 2114;
      v82 = v51;
      v83 = 2114;
      v84 = summary;
      v85 = 2114;
      v86 = v28;
      v87 = 2114;
      v88 = @"<-----<";
      v44 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:%{public}@";
    }

    v45 = v29;
    v46 = 162;
    goto LABEL_27;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  [autoControlManagerFSM2 diag];
  v37 = v54 = patchDescriptorCopy;
  v38 = [NSString alloc];
  [descriptorCopy summary];
  v40 = v39 = descriptorCopy;
  v41 = [v38 initWithFormat:@"{%@:_logPersistedEntry} %@:%@ | no persistedEntryID | %@ | jobUUID:%@ | assetDescriptor:%@", entryCopy, typeCopy, operationCopy, messageCopy, iDCopy, v40];
  [v37 trackAnomaly:@"AUTO-CONTROL" forReason:v41 withResult:6110 withError:0];

  v26 = 0;
  patchDescriptorCopy = v54;

  v27 = entryCopy;
LABEL_33:
}

- (void)_logPersistedRemovedEntry:(id)entry forComponentType:(id)type removedPersistedEntryID:(id)d removedDescriptor:(id)descriptor message:(id)message
{
  entryCopy = entry;
  typeCopy = type;
  dCopy = d;
  descriptorCopy = descriptor;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v19 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v20 = [MADAutoAssetPersisted persistedComponentSymbol:typeCopy];
  if (dCopy)
  {
    v21 = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
    if (descriptorCopy)
    {
      if (v22)
      {
        v23 = entryCopy;
        newSummaryWithoutSelector = [descriptorCopy newSummaryWithoutSelector];
        *buf = 138546434;
        v33 = @"PERSISTED";
        v34 = 2114;
        v35 = typeCopy;
        v36 = 2114;
        v37 = @"ENTRY_REMOVE";
        v38 = 2114;
        v39 = v20;
        v40 = 2114;
        v41 = @">----->";
        v42 = 2114;
        v43 = v23;
        v44 = 2114;
        v45 = messageCopy;
        v46 = 2114;
        v47 = v20;
        v48 = 2114;
        v49 = v19;
        v50 = 2114;
        v51 = dCopy;
        v52 = 2114;
        v53 = newSummaryWithoutSelector;
        v54 = 2114;
        v55 = v20;
        v56 = 2114;
        v57 = @"<-----<";
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        entryCopy = v23;
      }
    }

    else if (v22)
    {
      *buf = 138546178;
      v33 = @"PERSISTED";
      v34 = 2114;
      v35 = typeCopy;
      v36 = 2114;
      v37 = @"ENTRY_REMOVE";
      v38 = 2114;
      v39 = v20;
      v40 = 2114;
      v41 = @">----->";
      v42 = 2114;
      v43 = entryCopy;
      v44 = 2114;
      v45 = messageCopy;
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = v19;
      v50 = 2114;
      v51 = dCopy;
      v52 = 2114;
      v53 = v20;
      v54 = 2114;
      v55 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v31 = v19;
    v25 = entryCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v28 = [NSString alloc];
    if (descriptorCopy)
    {
      summary = [descriptorCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v30 = [v28 initWithFormat:@"{%@:_logPersistedRemovedEntry} %@ | no persistedEntryID to remove | %@ | removedDescriptor:%@", v25, typeCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6110 withError:0];

    if (descriptorCopy)
    {
    }

    entryCopy = v25;
    v19 = v31;
  }
}

- (void)_logPersistedTableOfContents:(id)contents forComponentType:(id)type
{
  contentsCopy = contents;
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  contentsCopy = [[NSString alloc] initWithFormat:@"%@:_logPersistedTableOfContents", contentsCopy];
  v11 = [MADAutoAssetPersisted persistedComponentSymbol:typeCopy];
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  selfCopy = self;
  if ([SUCore stringIsEqual:typeCopy to:@"ACTIVE-JOBS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
LABEL_13:
    v14 = persistedActiveJobs;
    v15 = [persistedActiveJobs persistedEntryIDs:contentsCopy];
    goto LABEL_14;
  }

  if ([SUCore stringIsEqual:typeCopy to:@"KNOWN_DESCRIPTORS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:typeCopy to:@"SET_ACTIVE_JOB_DESCRIPTORS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:typeCopy to:@"SET_DOWNLOADED_DESCRIPTORS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:typeCopy to:@"SET_TARGETS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedSetTargets];
    goto LABEL_13;
  }

  if ([SUCore stringIsEqual:typeCopy to:@"SET_LOOKUP_RESULTS"])
  {
    persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedSetLookupResults];
    goto LABEL_13;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  typeCopy = [[NSString alloc] initWithFormat:@"{%@} unknown componentType:%@", contentsCopy, typeCopy];
  [diag trackAnomaly:@"AUTO-CONTROL" forReason:typeCopy withResult:6110 withError:0];

  v15 = 0;
  v14 = 0;
LABEL_14:
  if ([v15 count])
  {
    v40 = contentsCopy;
    v44 = [v15 count];
    v16 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v16, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = typeCopy;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @">----->";
      v56 = 2114;
      v57 = contentsCopy;
      _os_log_impl(&dword_0, v16, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v17 = selfCopy;
    if (v44 >= 1)
    {
      v18 = 0;
      v42 = v14;
      v43 = v15;
      do
      {
        context = objc_autoreleasePoolPush();
        v19 = [v15 objectAtIndexedSubscript:v18];
        if ([p_weak_ivar_lyt[223] stringIsEqual:typeCopy to:@"ACTIVE-JOBS"] & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", typeCopy, @"KNOWN_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", typeCopy, @"SET_ACTIVE_JOB_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", typeCopy, @"SET_DOWNLOADED_DESCRIPTORS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", typeCopy, @"SET_TARGETS") & 1) != 0 || (objc_msgSend(p_weak_ivar_lyt[223], "stringIsEqual:to:", typeCopy, @"SET_LOOKUP_RESULTS"))
        {
          v20 = [v14 persistedEntry:v19 fromLocation:contentsCopy];
          if (v20)
          {
            v21 = v20;
            v22 = [v14 decodeFromLocation:contentsCopy ofEntryName:v19 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
            v23 = v22;
            if (v22)
            {
              newSummaryWithoutSelector = [v22 newSummaryWithoutSelector];
              diag2 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(diag2, OS_LOG_TYPE_DEFAULT))
              {
                *buf = 138544642;
                v26 = @"NO SUMMARY";
                if (newSummaryWithoutSelector)
                {
                  v26 = newSummaryWithoutSelector;
                }

                v47 = v11;
                v48 = 2114;
                v49 = @"E_LOD";
                v50 = 2048;
                v51 = (v18 + 1);
                v52 = 2048;
                v53 = v44;
                v54 = 2114;
                v55 = v19;
                v56 = 2114;
                v57 = v26;
                _os_log_impl(&dword_0, diag2, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
              }
            }

            else
            {
              newSummaryWithoutSelector = [(MADAutoAssetControlManager *)v17 autoControlManagerFSM];
              diag2 = [(__CFString *)newSummaryWithoutSelector diag];
              v27 = typeCopy;
              v28 = v11;
              v29 = contentsCopy;
              v30 = [[NSString alloc] initWithFormat:@"{%@} unable to decode persisted auto-asset-descriptor entryID:%@", contentsCopy, v19];
              [diag2 trackAnomaly:@"AUTO-CONTROL" forReason:v30 withResult:6110 withError:0];

              contentsCopy = v29;
              v11 = v28;
              typeCopy = v27;
              v17 = selfCopy;
            }

            p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
            v14 = v42;
            goto LABEL_36;
          }
        }

        else
        {
          autoControlManagerFSM3 = [(MADAutoAssetControlManager *)v17 autoControlManagerFSM];
          diag3 = [autoControlManagerFSM3 diag];
          v32 = v14;
          typeCopy2 = [[NSString alloc] initWithFormat:@"{%@} second component type check - unknown componentType:%@", contentsCopy, typeCopy];
          [diag3 trackAnomaly:@"AUTO-CONTROL" forReason:typeCopy2 withResult:6110 withError:0];

          v14 = v32;
          v15 = v43;
        }

        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          summary = [(MADAutoAssetControlManager *)v17 summary];
          *buf = 138544130;
          v47 = contentsCopy;
          v48 = 2114;
          v49 = typeCopy;
          v50 = 2114;
          v51 = summary;
          v52 = 2114;
          v53 = v19;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);

LABEL_36:
          v15 = v43;
        }

        objc_autoreleasePoolPop(context);
        ++v18;
      }

      while (v44 != v18);
    }

    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = typeCopy;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @"<-----<";
      v56 = 2114;
      v57 = contentsCopy;
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents", buf, 0x3Eu);
    }

    contentsCopy = v40;
  }

  else
  {
    v35 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138545410;
      v47 = @"PERSISTED";
      v48 = 2114;
      v49 = typeCopy;
      v50 = 2114;
      v51 = @"ENTRY_LOAD";
      v52 = 2114;
      v53 = v11;
      v54 = 2114;
      v55 = @">----->";
      v56 = 2114;
      v57 = contentsCopy;
      v58 = 2114;
      v59 = @"empty table-of-contents";
      v60 = 2114;
      v61 = v11;
      v62 = 2114;
      v63 = @"<-----<";
      _os_log_impl(&dword_0, v35, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@", buf, 0x5Cu);
    }
  }
}

- (void)_logPersistedSetConfiguration:(id)configuration operation:(id)operation forPersistedEntryID:(id)d withSetConfiguration:(id)setConfiguration historyOperation:(int64_t)historyOperation recordingSpecifiers:(BOOL)specifiers message:(id)message
{
  configurationCopy = configuration;
  operationCopy = operation;
  dCopy = d;
  setConfigurationCopy = setConfiguration;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    specifiersCopy = specifiers;
    v52 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    v51 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
    v22 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
    {
      newSummaryWithoutEntryID = [setConfigurationCopy newSummaryWithoutEntryID];
      *buf = 138546434;
      v54 = @"PERSISTED";
      v55 = 2114;
      v56 = @"SET_CONFIGURATIONS";
      v57 = 2114;
      v58 = operationCopy;
      v59 = 2114;
      v60 = v51;
      v61 = 2114;
      v62 = @">----->";
      v63 = 2114;
      v64 = configurationCopy;
      v65 = 2114;
      v66 = messageCopy;
      v67 = 2114;
      v68 = v51;
      v69 = 2114;
      v70 = v52;
      v71 = 2114;
      v72 = dCopy;
      v73 = 2114;
      v74 = newSummaryWithoutEntryID;
      v75 = 2114;
      v76 = v51;
      v77 = 2114;
      v78 = @"<-----<";
      _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }

    [(MADAutoAssetControlManager *)self _logSetConfigurationEntries:configurationCopy forSetConfiguration:setConfigurationCopy];
    if (historyOperation != 9999)
    {
      historyOperationCopy = historyOperation;
      v49 = messageCopy;
      latestAtomicInstanceToVend = [setConfigurationCopy latestAtomicInstanceToVend];
      v25 = [(MADAutoAssetControlManager *)self locateSetDescriptor:configurationCopy forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:0];

      latestAtomicInstanceToVend2 = [setConfigurationCopy latestAtomicInstanceToVend];
      v27 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend2];

      autoAssetEntries = [setConfigurationCopy autoAssetEntries];
      v42 = [autoAssetEntries count];
      requestedAutoAssetEntries = [v25 requestedAutoAssetEntries];
      v41 = [requestedAutoAssetEntries count];
      v47 = v25;
      discoveredAtomicEntries = [v25 discoveredAtomicEntries];
      v40 = [discoveredAtomicEntries count];
      v46 = v27;
      instanceEntries = [v27 instanceEntries];
      v29 = [instanceEntries count];
      clientDomainName = [setConfigurationCopy clientDomainName];
      assetSetIdentifier = [setConfigurationCopy assetSetIdentifier];
      latestAtomicInstanceToVend3 = [setConfigurationCopy latestAtomicInstanceToVend];
      v33 = latestAtomicInstanceToVend3;
      if (specifiersCopy)
      {
        v34 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetConfiguration:setConfigurationCopy];
        [MADAutoAssetHistory recordOperation:historyOperationCopy toHistoryType:2 fromLayer:1 configuredCount:v42 requestedCount:v41 fromPallasCount:v40 vendingCount:v29 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:v33 withAddendumMessage:v34];
      }

      else
      {
        [MADAutoAssetHistory recordOperation:historyOperationCopy toHistoryType:2 fromLayer:1 configuredCount:v42 requestedCount:v41 fromPallasCount:v40 vendingCount:v29 forClientDomainName:clientDomainName forAssetSetIdentifier:assetSetIdentifier forAtomicInstance:latestAtomicInstanceToVend3 withAddendumMessage:configurationCopy];
      }

      messageCopy = v49;
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v37 = [NSString alloc];
    summary = [setConfigurationCopy summary];
    v39 = [v37 initWithFormat:@"{%@:_logPersistedSetConfiguration} %@:%@ | no persistedEntryID | %@ | setConfiguration:%@", configurationCopy, @"SET_CONFIGURATIONS", operationCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v39 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetConfigurationRemoved:(id)removed removedPersistedEntryID:(id)d removedSetConfiguration:(id)configuration message:(id)message
{
  removedCopy = removed;
  dCopy = d;
  configurationCopy = configuration;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
  if (dCopy)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (configurationCopy)
    {
      if (v19)
      {
        v20 = removedCopy;
        newSummaryWithoutEntryID = [configurationCopy newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_CONFIGURATIONS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = messageCopy;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = dCopy;
        v49 = 2114;
        v50 = newSummaryWithoutEntryID;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        removedCopy = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_CONFIGURATIONS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = removedCopy;
      v41 = 2114;
      v42 = messageCopy;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = dCopy;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = removedCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = [NSString alloc];
    if (configurationCopy)
    {
      summary = [configurationCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetConfigurationRemoved} %@ | no persistedEntryID to remove | %@ | removedSetConfiguration:%@", v22, @"SET_CONFIGURATIONS", messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (configurationCopy)
    {
    }

    removedCopy = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetConfigurationTableOfContents:(id)contents
{
  contentsCopy = contents;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_CONFIGURATIONS"];
  persistedKnownSetConfigurations = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
  v9 = [persistedKnownSetConfigurations persistedEntryIDs:contentsCopy];

  if ([v9 count])
  {
    v10 = [v9 count];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v28 = @"PERSISTED";
      v29 = 2114;
      v30 = @"SET_CONFIGURATIONS";
      v31 = 2114;
      v32 = @"ENTRY_LOAD";
      v33 = 2114;
      v34 = v7;
      v35 = 2114;
      v36 = @">----->";
      v37 = 2114;
      v38 = contentsCopy;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v25 = v7;

    if (v10 >= 1)
    {
      v12 = 0;
      v24 = v10;
      do
      {
        context = objc_autoreleasePoolPush();
        v13 = [v9 objectAtIndexedSubscript:v12];
        persistedKnownSetConfigurations2 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
        v15 = [persistedKnownSetConfigurations2 persistedEntry:v13 fromLocation:contentsCopy];

        if (v15)
        {
          persistedKnownSetConfigurations3 = [(MADAutoAssetControlManager *)self persistedKnownSetConfigurations];
          v17 = [persistedKnownSetConfigurations3 decodeFromLocation:contentsCopy ofEntryName:v13 fromPersistedEntry:v15 decodingObjectForKey:@"setConfiguration" ofClass:objc_opt_class() allowingNilObject:0];

          if (v17)
          {
            summary = _MADLog(@"AutoControl");
            if (os_log_type_enabled(summary, OS_LOG_TYPE_DEFAULT))
            {
              newSummaryWithoutEntryID = [v17 newSummaryWithoutEntryID];
              *buf = 138544642;
              v28 = v25;
              v29 = 2114;
              v30 = @"E_LOD";
              v31 = 2048;
              v32 = (v12 + 1);
              v10 = v24;
              v33 = 2048;
              v34 = v24;
              v35 = 2114;
              v36 = v13;
              v37 = 2114;
              v38 = newSummaryWithoutEntryID;
              _os_log_impl(&dword_0, summary, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
            }

            goto LABEL_12;
          }
        }

        else
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            summary = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v28 = contentsCopy;
            v29 = 2114;
            v30 = @"SET_CONFIGURATIONS";
            v31 = 2114;
            v32 = summary;
            v33 = 2114;
            v34 = v13;
            _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetConfigurationTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
LABEL_12:
          }
        }

        objc_autoreleasePoolPop(context);
        ++v12;
      }

      while (v10 != v12);
    }

    v20 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v7 = v25;
      goto LABEL_20;
    }

    *buf = 138544642;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_CONFIGURATIONS";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v7 = v25;
    v34 = v25;
    v35 = 2114;
    v36 = @"<-----<";
    v37 = 2114;
    v38 = contentsCopy;
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
    v22 = v20;
    v23 = 62;
    goto LABEL_18;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545410;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_CONFIGURATIONS";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v34 = v7;
    v35 = 2114;
    v36 = @">----->";
    v37 = 2114;
    v38 = contentsCopy;
    v39 = 2114;
    v40 = @"empty table-of-contents";
    v41 = 2114;
    v42 = v7;
    v43 = 2114;
    v44 = @"<-----<";
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
    v22 = v20;
    v23 = 92;
LABEL_18:
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, v21, buf, v23);
  }

LABEL_20:
}

- (void)_logPersistedSetAtomicInstance:(id)instance operation:(id)operation forPersistedEntryID:(id)d withSetAtomicInstance:(id)atomicInstance message:(id)message
{
  instanceCopy = instance;
  operationCopy = operation;
  dCopy = d;
  atomicInstanceCopy = atomicInstance;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    v19 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    v20 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      v28 = messageCopy;
      newSummaryWithoutEntryID = [atomicInstanceCopy newSummaryWithoutEntryID];
      *buf = 138546434;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_ATOMIC_INSTANCES";
      v33 = 2114;
      v34 = operationCopy;
      v35 = 2114;
      v36 = v20;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = instanceCopy;
      v41 = 2114;
      v42 = v28;
      v43 = 2114;
      v44 = v20;
      v45 = 2114;
      v46 = v19;
      v47 = 2114;
      v48 = dCopy;
      v49 = 2114;
      v50 = newSummaryWithoutEntryID;
      v51 = 2114;
      v52 = v20;
      v53 = 2114;
      v54 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

      messageCopy = v28;
    }

    [(MADAutoAssetControlManager *)self _logAtomicInstanceEntries:instanceCopy forAtomicInstance:atomicInstanceCopy];
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = [NSString alloc];
    summary = [atomicInstanceCopy summary];
    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetAtomicInstance} %@:%@ | no persistedEntryID | %@ | setAtomicInstance:%@", instanceCopy, @"SET_ATOMIC_INSTANCES", operationCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetAtomicInstanceRemoved:(id)removed removedPersistedEntryID:(id)d removedSetAtomicInstance:(id)instance message:(id)message
{
  removedCopy = removed;
  dCopy = d;
  instanceCopy = instance;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
  if (dCopy)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (instanceCopy)
    {
      if (v19)
      {
        v20 = removedCopy;
        newSummaryWithoutEntryID = [instanceCopy newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_ATOMIC_INSTANCES";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = messageCopy;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = dCopy;
        v49 = 2114;
        v50 = newSummaryWithoutEntryID;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        removedCopy = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_ATOMIC_INSTANCES";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = removedCopy;
      v41 = 2114;
      v42 = messageCopy;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = dCopy;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = removedCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = [NSString alloc];
    if (instanceCopy)
    {
      summary = [instanceCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetAtomicInstanceRemoved} %@ | no persistedEntryID to remove | %@ | removedSetAtomicInstance:%@", v22, @"SET_ATOMIC_INSTANCES", messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (instanceCopy)
    {
    }

    removedCopy = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetAtomicInstanceTableOfContents:(id)contents
{
  contentsCopy = contents;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_ATOMIC_INSTANCES"];
  persistedKnownSetAtomicInstances = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
  v9 = [persistedKnownSetAtomicInstances persistedEntryIDs:contentsCopy];

  if ([v9 count])
  {
    v10 = [v9 count];
    v11 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v28 = @"PERSISTED";
      v29 = 2114;
      v30 = @"SET_ATOMIC_INSTANCES";
      v31 = 2114;
      v32 = @"ENTRY_LOAD";
      v33 = 2114;
      v34 = v7;
      v35 = 2114;
      v36 = @">----->";
      v37 = 2114;
      v38 = contentsCopy;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v25 = v7;

    if (v10 >= 1)
    {
      v12 = 0;
      v24 = v10;
      do
      {
        context = objc_autoreleasePoolPush();
        v13 = [v9 objectAtIndexedSubscript:v12];
        persistedKnownSetAtomicInstances2 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
        v15 = [persistedKnownSetAtomicInstances2 persistedEntry:v13 fromLocation:contentsCopy];

        if (v15)
        {
          persistedKnownSetAtomicInstances3 = [(MADAutoAssetControlManager *)self persistedKnownSetAtomicInstances];
          v17 = [persistedKnownSetAtomicInstances3 decodeFromLocation:contentsCopy ofEntryName:v13 fromPersistedEntry:v15 decodingObjectForKey:@"setAtomicInstance" ofClass:objc_opt_class() allowingNilObject:0];

          if (v17)
          {
            summary = _MADLog(@"AutoControl");
            if (os_log_type_enabled(summary, OS_LOG_TYPE_DEFAULT))
            {
              newSummaryWithoutEntryID = [v17 newSummaryWithoutEntryID];
              *buf = 138544642;
              v28 = v25;
              v29 = 2114;
              v30 = @"E_LOD";
              v31 = 2048;
              v32 = (v12 + 1);
              v10 = v24;
              v33 = 2048;
              v34 = v24;
              v35 = 2114;
              v36 = v13;
              v37 = 2114;
              v38 = newSummaryWithoutEntryID;
              _os_log_impl(&dword_0, summary, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
            }

            goto LABEL_12;
          }
        }

        else
        {
          v17 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
          {
            summary = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v28 = contentsCopy;
            v29 = 2114;
            v30 = @"SET_ATOMIC_INSTANCES";
            v31 = 2114;
            v32 = summary;
            v33 = 2114;
            v34 = v13;
            _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetAtomicInstanceTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
LABEL_12:
          }
        }

        objc_autoreleasePoolPop(context);
        ++v12;
      }

      while (v10 != v12);
    }

    v20 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
    {
      v7 = v25;
      goto LABEL_20;
    }

    *buf = 138544642;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_ATOMIC_INSTANCES";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v7 = v25;
    v34 = v25;
    v35 = 2114;
    v36 = @"<-----<";
    v37 = 2114;
    v38 = contentsCopy;
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
    v22 = v20;
    v23 = 62;
    goto LABEL_18;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138545410;
    v28 = @"PERSISTED";
    v29 = 2114;
    v30 = @"SET_ATOMIC_INSTANCES";
    v31 = 2114;
    v32 = @"ENTRY_LOAD";
    v33 = 2114;
    v34 = v7;
    v35 = 2114;
    v36 = @">----->";
    v37 = 2114;
    v38 = contentsCopy;
    v39 = 2114;
    v40 = @"empty table-of-contents";
    v41 = 2114;
    v42 = v7;
    v43 = 2114;
    v44 = @"<-----<";
    v21 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
    v22 = v20;
    v23 = 92;
LABEL_18:
    _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, v21, buf, v23);
  }

LABEL_20:
}

- (void)_logPersistedSetDescriptor:(id)descriptor forComponentType:(id)type operation:(id)operation forPersistedEntryID:(id)d forClientRequest:(id)request withJobUUID:(id)iD withSetDescriptor:(id)setDescriptor message:(id)self0
{
  descriptorCopy = descriptor;
  typeCopy = type;
  operationCopy = operation;
  dCopy = d;
  requestCopy = request;
  iDCopy = iD;
  setDescriptorCopy = setDescriptor;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v48 = requestCopy;
  if (dCopy)
  {
    selfCopy = self;
    v45 = operationCopy;
    v24 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    v25 = typeCopy;
    v26 = [MADAutoAssetPersisted persistedComponentSymbol:?];
    v27 = _MADLog(@"AutoControl");
    v28 = os_log_type_enabled(v27, OS_LOG_TYPE_DEFAULT);
    if (requestCopy)
    {
      v29 = descriptorCopy;
      if (iDCopy)
      {
        if (v28)
        {
          summary = [setDescriptorCopy summary];
          *buf = 138547970;
          v50 = @"PERSISTED";
          v51 = 2114;
          v52 = typeCopy;
          v53 = 2114;
          v54 = v45;
          v55 = 2114;
          v56 = v26;
          v57 = 2114;
          v58 = @">----->";
          v59 = 2114;
          v60 = descriptorCopy;
          v61 = 2114;
          v62 = messageCopy;
          v63 = 2114;
          v64 = v26;
          v65 = 2114;
          v66 = v24;
          v67 = 2114;
          v68 = dCopy;
          v69 = 2114;
          v70 = summary;
          v71 = 2114;
          v72 = v26;
          v73 = 2114;
          v74 = v24;
          v75 = 2114;
          v76 = [MADAutoAssetControlManager newSummaryForSetRequestMessage:v48 includingSetAtomicInstance:0];
          v30 = v76;
          v77 = 2114;
          v78 = v26;
          v79 = 2114;
          v80 = v24;
          v81 = 2114;
          v82 = iDCopy;
          v83 = 2114;
          v84 = v26;
          v85 = 2114;
          v86 = @"<-----<";
          v31 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
          v32 = v27;
          v33 = 192;
LABEL_12:
          _os_log_impl(&dword_0, v32, OS_LOG_TYPE_DEFAULT, v31, buf, v33);
        }
      }

      else if (v28)
      {
        summary = [setDescriptorCopy summary];
        *buf = 138547202;
        v50 = @"PERSISTED";
        v51 = 2114;
        v52 = typeCopy;
        v53 = 2114;
        v54 = v45;
        v55 = 2114;
        v56 = v26;
        v57 = 2114;
        v58 = @">----->";
        v59 = 2114;
        v60 = descriptorCopy;
        v61 = 2114;
        v62 = messageCopy;
        v63 = 2114;
        v64 = v26;
        v65 = 2114;
        v66 = v24;
        v67 = 2114;
        v68 = dCopy;
        v69 = 2114;
        v70 = summary;
        v71 = 2114;
        v72 = v26;
        v73 = 2114;
        v74 = v24;
        v75 = 2114;
        v76 = [MADAutoAssetControlManager newSummaryForSetRequestMessage:v48 includingSetAtomicInstance:0];
        v30 = v76;
        v77 = 2114;
        v78 = v26;
        v79 = 2114;
        v80 = @"<-----<";
        v31 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) clientRequest:%{public}@\n#_%{public}@:%{public}@";
        v32 = v27;
        v33 = 162;
        goto LABEL_12;
      }

LABEL_16:

      [(MADAutoAssetControlManager *)selfCopy _logSetDescriptorEntries:v29 forSetDescriptor:setDescriptorCopy];
      operationCopy = v45;
      goto LABEL_17;
    }

    v29 = descriptorCopy;
    if (iDCopy)
    {
      if (!v28)
      {
        goto LABEL_16;
      }

      summary2 = [setDescriptorCopy summary];
      *buf = 138547202;
      v50 = @"PERSISTED";
      v51 = 2114;
      v52 = typeCopy;
      v53 = 2114;
      v54 = v45;
      v55 = 2114;
      v56 = v26;
      v57 = 2114;
      v58 = @">----->";
      v59 = 2114;
      v60 = descriptorCopy;
      v61 = 2114;
      v62 = messageCopy;
      v63 = 2114;
      v64 = v26;
      v65 = 2114;
      v66 = v24;
      v67 = 2114;
      v68 = dCopy;
      v69 = 2114;
      v70 = summary2;
      v71 = 2114;
      v72 = v26;
      v73 = 2114;
      v74 = v24;
      v75 = 2114;
      v76 = iDCopy;
      v77 = 2114;
      v78 = v26;
      v79 = 2114;
      v80 = @"<-----<";
      v40 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:(%{public}@) jobUUID:%{public}@\n#_%{public}@:%{public}@";
      v41 = v27;
      v42 = 162;
    }

    else
    {
      if (!v28)
      {
        goto LABEL_16;
      }

      summary2 = [setDescriptorCopy summary];
      *buf = 138546434;
      v50 = @"PERSISTED";
      v51 = 2114;
      v52 = typeCopy;
      v53 = 2114;
      v54 = v45;
      v55 = 2114;
      v56 = v26;
      v57 = 2114;
      v58 = @">----->";
      v59 = 2114;
      v60 = descriptorCopy;
      v61 = 2114;
      v62 = messageCopy;
      v63 = 2114;
      v64 = v26;
      v65 = 2114;
      v66 = v24;
      v67 = 2114;
      v68 = dCopy;
      v69 = 2114;
      v70 = summary2;
      v71 = 2114;
      v72 = v26;
      v73 = 2114;
      v74 = @"<-----<";
      v40 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@";
      v41 = v27;
      v42 = 132;
    }

    _os_log_impl(&dword_0, v41, OS_LOG_TYPE_DEFAULT, v40, buf, v42);

    goto LABEL_16;
  }

  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  v36 = [NSString alloc];
  summary3 = [setDescriptorCopy summary];
  v29 = descriptorCopy;
  v25 = typeCopy;
  v38 = [v36 initWithFormat:@"{%@:_logPersistedSetDescriptor} %@:%@ | no persistedEntryID | %@ | jobUUID:%@ | setDescriptor:%@", descriptorCopy, typeCopy, operationCopy, messageCopy, iDCopy, summary3];
  [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v38 withResult:6110 withError:0];

  dCopy = 0;
LABEL_17:
}

- (void)_logPersistedSetDescriptorRemoved:(id)removed forComponentType:(id)type removedPersistedEntryID:(id)d removedSetDescriptor:(id)descriptor message:(id)message
{
  removedCopy = removed;
  typeCopy = type;
  dCopy = d;
  descriptorCopy = descriptor;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v19 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v20 = [MADAutoAssetPersisted persistedComponentSymbol:typeCopy];
  if (dCopy)
  {
    v21 = _MADLog(@"AutoControl");
    v22 = os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT);
    if (descriptorCopy)
    {
      if (v22)
      {
        v23 = removedCopy;
        newSummaryWithoutEntryID = [descriptorCopy newSummaryWithoutEntryID];
        *buf = 138546434;
        v33 = @"PERSISTED";
        v34 = 2114;
        v35 = typeCopy;
        v36 = 2114;
        v37 = @"ENTRY_REMOVE";
        v38 = 2114;
        v39 = v20;
        v40 = 2114;
        v41 = @">----->";
        v42 = 2114;
        v43 = v23;
        v44 = 2114;
        v45 = messageCopy;
        v46 = 2114;
        v47 = v20;
        v48 = 2114;
        v49 = v19;
        v50 = 2114;
        v51 = dCopy;
        v52 = 2114;
        v53 = newSummaryWithoutEntryID;
        v54 = 2114;
        v55 = v20;
        v56 = 2114;
        v57 = @"<-----<";
        _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        removedCopy = v23;
      }
    }

    else if (v22)
    {
      *buf = 138546178;
      v33 = @"PERSISTED";
      v34 = 2114;
      v35 = typeCopy;
      v36 = 2114;
      v37 = @"ENTRY_REMOVE";
      v38 = 2114;
      v39 = v20;
      v40 = 2114;
      v41 = @">----->";
      v42 = 2114;
      v43 = removedCopy;
      v44 = 2114;
      v45 = messageCopy;
      v46 = 2114;
      v47 = v20;
      v48 = 2114;
      v49 = v19;
      v50 = 2114;
      v51 = dCopy;
      v52 = 2114;
      v53 = v20;
      v54 = 2114;
      v55 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v31 = v19;
    v25 = removedCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v28 = [NSString alloc];
    if (descriptorCopy)
    {
      summary = [descriptorCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v30 = [v28 initWithFormat:@"{%@:_logPersistedSetDescriptorRemoved} %@ | no persistedEntryID to remove | %@ | removedSetDescriptor:%@", v25, typeCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v30 withResult:6110 withError:0];

    if (descriptorCopy)
    {
    }

    removedCopy = v25;
    v19 = v31;
  }
}

- (void)_logPersistedSetDescriptorTableOfContents:(id)contents forComponentType:(id)type
{
  contentsCopy = contents;
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v10 = [MADAutoAssetPersisted persistedComponentSymbol:typeCopy];
  v34 = typeCopy;
  v35 = [SUCore stringIsEqual:typeCopy to:@"SET_ACTIVE_JOB_DESCRIPTORS"];
  if (v35)
  {
    persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedActiveJobSetDescriptors];
    selfCopy2 = self;
  }

  else
  {
    selfCopy2 = self;
    if (![SUCore stringIsEqual:typeCopy to:@"SET_DOWNLOADED_DESCRIPTORS"])
    {
      goto LABEL_24;
    }

    persistedActiveJobSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  }

  v13 = [persistedActiveJobSetDescriptors persistedEntryIDs:contentsCopy];

  if (v13)
  {
    if ([v13 count])
    {
      v36 = [v13 count];
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138544642;
        v38 = @"PERSISTED";
        v39 = 2114;
        v40 = typeCopy;
        v41 = 2114;
        v42 = @"ENTRY_LOAD";
        v43 = 2114;
        v44 = v10;
        v45 = 2114;
        v46 = @">----->";
        v47 = 2114;
        v48 = contentsCopy;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
      }

      v33 = v10;

      if (v36 >= 1)
      {
        v15 = 0;
        v31 = selfCopy2;
        v32 = v13;
        do
        {
          v16 = objc_autoreleasePoolPush();
          v17 = [v13 objectAtIndexedSubscript:v15];
          if (v35)
          {
            [(MADAutoAssetControlManager *)selfCopy2 persistedActiveJobSetDescriptors];
          }

          else
          {
            [(MADAutoAssetControlManager *)selfCopy2 persistedDownloadedSetDescriptors];
          }
          v18 = ;
          v19 = [v18 persistedEntry:v17 fromLocation:contentsCopy];
          if (v19)
          {
            v20 = [v18 decodeFromLocation:contentsCopy ofEntryName:v17 fromPersistedEntry:v19 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
            if (v20)
            {
              v21 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
              {
                newSummaryWithoutEntryID = [v20 newSummaryWithoutEntryID];
                *buf = 138544642;
                v38 = v33;
                v39 = 2114;
                v40 = @"E_LOD";
                v41 = 2048;
                v42 = (v15 + 1);
                selfCopy2 = v31;
                v43 = 2048;
                v44 = v36;
                v45 = 2114;
                v46 = v17;
                v47 = 2114;
                v48 = newSummaryWithoutEntryID;
                _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);

                v13 = v32;
              }
            }
          }

          else
          {
            v20 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
            {
              summary = [(MADAutoAssetControlManager *)selfCopy2 summary];
              *buf = 138544130;
              v38 = contentsCopy;
              v39 = 2114;
              v40 = v34;
              v41 = 2114;
              v42 = summary;
              v43 = 2114;
              v44 = v17;
              _os_log_impl(&dword_0, v20, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetDescriptorTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
            }
          }

          objc_autoreleasePoolPop(v16);
          ++v15;
        }

        while (v36 != v15);
      }

      v24 = _MADLog(@"AutoControl");
      v10 = v33;
      if (!os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
        goto LABEL_28;
      }

      *buf = 138544642;
      v38 = @"PERSISTED";
      v39 = 2114;
      v40 = v34;
      v41 = 2114;
      v42 = @"ENTRY_LOAD";
      v43 = 2114;
      v44 = v33;
      v45 = 2114;
      v46 = @"<-----<";
      v47 = 2114;
      v48 = contentsCopy;
      v25 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents";
      v26 = v24;
      v27 = 62;
    }

    else
    {
      v24 = _MADLog(@"AutoControl");
      if (!os_log_type_enabled(v24, OS_LOG_TYPE_DEFAULT))
      {
LABEL_28:

        goto LABEL_29;
      }

      *buf = 138545410;
      v38 = @"PERSISTED";
      v39 = 2114;
      v40 = typeCopy;
      v41 = 2114;
      v42 = @"ENTRY_LOAD";
      v43 = 2114;
      v44 = v10;
      v45 = 2114;
      v46 = @">----->";
      v47 = 2114;
      v48 = contentsCopy;
      v49 = 2114;
      v50 = @"empty table-of-contents";
      v51 = 2114;
      v52 = v10;
      v53 = 2114;
      v54 = @"<-----<";
      v25 = "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@";
      v26 = v24;
      v27 = 92;
    }

    _os_log_impl(&dword_0, v26, OS_LOG_TYPE_DEFAULT, v25, buf, v27);
    goto LABEL_28;
  }

LABEL_24:
  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy2 autoControlManagerFSM];
  diag = [autoControlManagerFSM2 diag];
  typeCopy = [[NSString alloc] initWithFormat:@"{%@:_logPersistedSetDescriptorTableOfContents} | no persisted-state for componentType:%@", contentsCopy, typeCopy];
  [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:typeCopy withResult:6110 withError:0];

LABEL_29:
}

- (id)locateDownloadedByFullSelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedEntryID = [selectorCopy persistedEntryID];

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  LODWORD(extendedStateQueue) = [persistedKnownDescriptors persistedEntryAlreadyExists:persistedEntryID fromLocation:@"locateDownloadedByFullSelector"];

  if (!extendedStateQueue)
  {
    v13 = 0;
    goto LABEL_14;
  }

  persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v10 = [persistedKnownDescriptors2 persistedEntry:persistedEntryID fromLocation:@"locateDownloadedByFullSelector"];

  if (v10)
  {
    persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v12 = [persistedKnownDescriptors3 decodeFromLocation:@"locateDownloadedByFullSelector" ofEntryName:persistedEntryID fromPersistedEntry:v10 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    if (v12)
    {
      if ([v12 isOnFilesystem])
      {
        v13 = v12;
LABEL_12:

        goto LABEL_13;
      }
    }

    else
    {
      v14 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        v16 = 138543362;
        v17 = persistedEntryID;
        _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "{locateDownloadedByFullSelector} | no auto-asset-descriptor entry found for entry:%{public}@", &v16, 0xCu);
      }
    }

    v13 = 0;
    goto LABEL_12;
  }

  v13 = 0;
LABEL_13:

LABEL_14:

  return v13;
}

- (id)locateDownloadedNewForSelector:(id)selector assetSelector:(id)assetSelector limitedToStaging:(BOOL)staging
{
  stagingCopy = staging;
  selectorCopy = selector;
  assetSelectorCopy = assetSelector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  selectorCopy = [[NSString alloc] initWithFormat:@"%@:locateDownloadedNewForSelector", selectorCopy];
  v12 = objc_alloc_init(NSMutableDictionary);
  assetSpecifier = [assetSelectorCopy assetSpecifier];
  if (assetSpecifier && (v14 = assetSpecifier, [assetSelectorCopy assetSpecifier], v15 = objc_claimAutoreleasedReturnValue(), v16 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v15, @"MAAutoAsset-all-asset-specifiers"), v15, v14, !v16))
  {
    persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
    v18 = [persistedKnownDescriptors persistedEntryIDs:selectorCopy assetSelector:assetSelectorCopy];
  }

  else
  {
    persistedKnownDescriptors = [assetSelectorCopy assetType];
    v18 = [(MADAutoAssetControlManager *)self locatePersistedKnownDescriptorEntryIDs:selectorCopy forAssetType:persistedKnownDescriptors];
  }

  v19 = v18;

  if (!v19 || ![v19 count])
  {
    v28 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v28, OS_LOG_TYPE_DEBUG))
    {
      summary = [assetSelectorCopy summary];
      *buf = 138543618;
      v67 = selectorCopy;
      v68 = 2114;
      v69 = summary;
      _os_log_impl(&dword_0, v28, OS_LOG_TYPE_DEBUG, "{%{public}@} no persisted-entry found | assetSelector:%{public}@", buf, 0x16u);
    }

    v30 = &__NSDictionary0__struct;
    goto LABEL_52;
  }

  assetSpecifier2 = [assetSelectorCopy assetSpecifier];
  if (assetSpecifier2)
  {
    v21 = assetSpecifier2;
    assetVersion = [assetSelectorCopy assetVersion];

    if (assetVersion)
    {
      persistedEntryID = [assetSelectorCopy persistedEntryID];
      persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v25 = [persistedKnownDescriptors2 persistedEntry:persistedEntryID fromLocation:selectorCopy];

      v57 = persistedEntryID;
      if (v25)
      {
        persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v27 = [persistedKnownDescriptors3 decodeFromLocation:selectorCopy ofEntryName:persistedEntryID fromPersistedEntry:v25 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v27)
        {
          if ([v27 isOnFilesystem]&& (!stagingCopy || [v27 preSoftwareUpdateAssetStaging]))
          {
            [v12 setSafeObject:v27 forKey:persistedEntryID];
          }
        }

        else
        {
          v49 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v49, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v67 = selectorCopy;
            v68 = 2114;
            v69 = v57;
            _os_log_impl(&dword_0, v49, OS_LOG_TYPE_ERROR, "{%{public}@} no auto-asset-descriptor entry found | entry:%{public}@", buf, 0x16u);
          }
        }
      }

      else
      {
        v27 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v67 = selectorCopy;
          v68 = 2114;
          v69 = persistedEntryID;
          _os_log_impl(&dword_0, v27, OS_LOG_TYPE_ERROR, "{%{public}@} no persisted-entry found | entry:%{public}@", buf, 0x16u);
        }
      }

      goto LABEL_51;
    }
  }

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:selectorCopy ofContainer:@"persistedKnownDescriptors"];
  v63 = 0u;
  v64 = 0u;
  v61 = 0u;
  v62 = 0u;
  v52 = v19;
  v31 = v19;
  v32 = [v31 countByEnumeratingWithState:&v61 objects:v65 count:16];
  v57 = v31;
  if (!v32)
  {
    goto LABEL_44;
  }

  v33 = v32;
  v53 = v12;
  v58 = assetSelectorCopy;
  v51 = selectorCopy;
  v60 = *v62;
  selfCopy = self;
  v56 = selectorCopy;
  do
  {
    for (i = 0; i != v33; i = i + 1)
    {
      if (*v62 != v60)
      {
        objc_enumerationMutation(v31);
      }

      v35 = *(*(&v61 + 1) + 8 * i);
      v36 = objc_autoreleasePoolPush();
      persistedKnownDescriptors4 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
      v38 = [persistedKnownDescriptors4 persistedEntry:v35 fromLocation:selectorCopy];

      if (v38)
      {
        persistedKnownDescriptors5 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
        v40 = [persistedKnownDescriptors5 decodeFromLocation:selectorCopy ofEntryName:v35 fromPersistedEntry:v38 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

        if (v40)
        {
          if ([v40 isOnFilesystem]&& (!stagingCopy || [v40 preSoftwareUpdateAssetStaging]))
          {
            assetSpecifier3 = [v58 assetSpecifier];

            assetType = [v40 assetType];
            assetType2 = [v58 assetType];
            v44 = [SUCore stringIsEqual:assetType to:assetType2];
            v45 = v44;
            if (assetSpecifier3)
            {
              if (v44)
              {
                assetSpecifier4 = [v40 assetSpecifier];
                assetSpecifier5 = [v58 assetSpecifier];
                v54 = [SUCore stringIsEqual:assetSpecifier4 to:assetSpecifier5];

                if (!v54)
                {
                  goto LABEL_40;
                }

LABEL_38:
                [v53 setSafeObject:v40 forKey:v35];
              }

              else
              {
              }
            }

            else
            {

              if (v45)
              {
                goto LABEL_38;
              }
            }

LABEL_40:
            self = selfCopy;
            selectorCopy = v56;
            v31 = v57;
          }
        }

        else
        {
          v48 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v67 = selectorCopy;
            v68 = 2114;
            v69 = v35;
            _os_log_impl(&dword_0, v48, OS_LOG_TYPE_ERROR, "{%{public}@} no auto-asset-descriptor entry found | entry:%{public}@", buf, 0x16u);
          }
        }
      }

      else
      {
        v40 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v40, OS_LOG_TYPE_ERROR))
        {
          *buf = 138543618;
          v67 = selectorCopy;
          v68 = 2114;
          v69 = v35;
          _os_log_impl(&dword_0, v40, OS_LOG_TYPE_ERROR, "{%{public}@} no persisted-entry found | entry:%{public}@", buf, 0x16u);
        }
      }

      objc_autoreleasePoolPop(v36);
    }

    v33 = [v31 countByEnumeratingWithState:&v61 objects:v65 count:16];
  }

  while (v33);
  selectorCopy = v51;
  assetSelectorCopy = v58;
  v12 = v53;
LABEL_44:
  v19 = v52;
LABEL_51:

  v30 = v12;
LABEL_52:

  return v30;
}

- (id)locatePersistedKnownDescriptorEntryIDs:(id)ds forAssetType:(id)type
{
  dsCopy = ds;
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  dsCopy = [[NSString alloc] initWithFormat:@"%@:locatePersistedKnownDescriptorEntryIDs", dsCopy];
  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v34 = typeCopy;
  v12 = [persistedKnownDescriptors persistedEntryIDs:dsCopy assetType:typeCopy];

  v32 = objc_alloc_init(NSMutableArray);
  if ([v12 count])
  {
    v31 = dsCopy;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:dsCopy ofContainer:@"persistedKnownDescriptors"];
    v38 = 0u;
    v39 = 0u;
    v36 = 0u;
    v37 = 0u;
    v30 = v12;
    obj = v12;
    v13 = [obj countByEnumeratingWithState:&v36 objects:v44 count:16];
    if (v13)
    {
      v14 = v13;
      v15 = *v37;
      v33 = dsCopy;
      do
      {
        for (i = 0; i != v14; i = i + 1)
        {
          if (*v37 != v15)
          {
            objc_enumerationMutation(obj);
          }

          v17 = *(*(&v36 + 1) + 8 * i);
          v18 = objc_autoreleasePoolPush();
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v20 = [persistedKnownDescriptors2 persistedEntry:v17 fromLocation:dsCopy];

          if (v20)
          {
            persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v22 = [persistedKnownDescriptors3 decodeFromLocation:dsCopy ofEntryName:v17 fromPersistedEntry:v20 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v22)
            {
              v23 = v14;
              selfCopy = self;
              v25 = v15;
              assetType = [v22 assetType];
              v27 = [SUCore stringIsEqual:assetType to:v34];

              if (v27)
              {
                [v32 addObject:v17];
              }

              v15 = v25;
              self = selfCopy;
              v14 = v23;
              dsCopy = v33;
            }

            else
            {
              v28 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543618;
                v41 = dsCopy;
                v42 = 2114;
                v43 = v17;
                _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load known descriptor | entry:%{public}@", buf, 0x16u);
              }
            }
          }

          else
          {
            v22 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543618;
              v41 = dsCopy;
              v42 = 2114;
              v43 = v17;
              _os_log_impl(&dword_0, v22, OS_LOG_TYPE_ERROR, "{%{public}@} unable to load persisted-state entry | entry:%{public}@", buf, 0x16u);
            }
          }

          objc_autoreleasePoolPop(v18);
        }

        v14 = [obj countByEnumeratingWithState:&v36 objects:v44 count:16];
      }

      while (v14);
    }

    v12 = v30;
    dsCopy = v31;
  }

  return v32;
}

- (id)locateDownloadedNewBySelectorForAssetType:(id)type
{
  typeCopy = type;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v29 = typeCopy;
  v8 = [persistedKnownDescriptors persistedEntryIDs:@"locateDownloadedNewAllBySelector" assetType:typeCopy];

  v27 = objc_alloc_init(NSMutableDictionary);
  if ([v8 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateDownloadedNewBySelectorForAssetType" ofContainer:@"persistedKnownDescriptors"];
    v33 = 0u;
    v34 = 0u;
    v31 = 0u;
    v32 = 0u;
    v26 = v8;
    v9 = v8;
    v30 = [v9 countByEnumeratingWithState:&v31 objects:v37 count:16];
    if (v30)
    {
      v10 = *v32;
      v11 = @"locateDownloadedNewBySelectorForAssetType";
      selfCopy = self;
      do
      {
        for (i = 0; i != v30; i = i + 1)
        {
          if (*v32 != v10)
          {
            objc_enumerationMutation(v9);
          }

          v13 = *(*(&v31 + 1) + 8 * i);
          v14 = objc_autoreleasePoolPush();
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v16 = [persistedKnownDescriptors2 persistedEntry:v13 fromLocation:v11];

          if (v16)
          {
            persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v18 = [persistedKnownDescriptors3 decodeFromLocation:@"locateDownloadedNewAllBySelector" ofEntryName:v13 fromPersistedEntry:v16 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v18)
            {
              if ([v18 isOnFilesystem])
              {
                v19 = v11;
                v20 = v10;
                v21 = v9;
                assetType = [v18 assetType];
                v23 = [SUCore stringIsEqual:assetType to:v29];

                if (v23)
                {
                  [v27 setSafeObject:v18 forKey:v13];
                }

                v9 = v21;
                v10 = v20;
                v11 = v19;
                self = selfCopy;
              }
            }

            else
            {
              v24 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v36 = v13;
                _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "{locateDownloadedNewBySelectorForAssetType} | no auto-asset-descriptor entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v18 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v36 = v13;
              _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateDownloadedNewBySelectorForAssetType} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v14);
        }

        v30 = [v9 countByEnumeratingWithState:&v31 objects:v37 count:16];
      }

      while (v30);
    }

    v8 = v26;
  }

  return v27;
}

- (id)locateDownloadedNewBySelectorLimitedToStaging:(BOOL)staging
{
  stagingCopy = staging;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v7 = [persistedKnownDescriptors persistedEntryIDs:@"locateDownloadedNewAllBySelector"];

  v21 = objc_alloc_init(NSMutableDictionary);
  if ([v7 count])
  {
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"locateDownloadedNewBySelectorLimitedToStaging" ofContainer:@"persistedKnownDescriptors"];
    v26 = 0u;
    v27 = 0u;
    v24 = 0u;
    v25 = 0u;
    v20 = v7;
    obj = v7;
    v8 = [obj countByEnumeratingWithState:&v24 objects:v30 count:16];
    if (v8)
    {
      v9 = v8;
      v10 = *v25;
      do
      {
        for (i = 0; i != v9; i = i + 1)
        {
          if (*v25 != v10)
          {
            objc_enumerationMutation(obj);
          }

          v12 = *(*(&v24 + 1) + 8 * i);
          v13 = objc_autoreleasePoolPush();
          persistedKnownDescriptors2 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
          v15 = [persistedKnownDescriptors2 persistedEntry:v12 fromLocation:@"locateDownloadedNewAllBySelector"];

          if (v15)
          {
            persistedKnownDescriptors3 = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
            v17 = [persistedKnownDescriptors3 decodeFromLocation:@"locateDownloadedNewAllBySelector" ofEntryName:v12 fromPersistedEntry:v15 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

            if (v17)
            {
              if ([v17 isOnFilesystem]&& (!stagingCopy || [v17 preSoftwareUpdateAssetStaging]))
              {
                [v21 setSafeObject:v17 forKey:v12];
              }
            }

            else
            {
              v18 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
              {
                *buf = 138543362;
                v29 = v12;
                _os_log_impl(&dword_0, v18, OS_LOG_TYPE_ERROR, "{locateDownloadedNewAllBySelector} | no auto-asset-descriptor entry found for entry:%{public}@", buf, 0xCu);
              }
            }
          }

          else
          {
            v17 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v29 = v12;
              _os_log_impl(&dword_0, v17, OS_LOG_TYPE_ERROR, "{locateDownloadedNewAllBySelector} | unable to determine previous status for entry:%{public}@", buf, 0xCu);
            }
          }

          objc_autoreleasePoolPop(v13);
        }

        v9 = [obj countByEnumeratingWithState:&v24 objects:v30 count:16];
      }

      while (v9);
    }

    v7 = v20;
  }

  return v21;
}

- (int64_t)locateDownloadedCurrentDownloadedCount
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedKnownDescriptors = [(MADAutoAssetControlManager *)self persistedKnownDescriptors];
  v6 = [persistedKnownDescriptors persistedEntryIDs:@"locateDownloadedCurrentDownloadedCount"];

  v7 = [v6 count];
  return v7;
}

- (id)locateActiveJobDescriptorBySelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  persistedEntryID = [selectorCopy persistedEntryID];

  persistedActiveJobs = [(MADAutoAssetControlManager *)self persistedActiveJobs];
  LODWORD(extendedStateQueue) = [persistedActiveJobs persistedEntryAlreadyExists:persistedEntryID fromLocation:@"locateActiveJobDescriptorBySelector"];

  if (extendedStateQueue)
  {
    persistedActiveJobs2 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
    v10 = [persistedActiveJobs2 persistedEntry:persistedEntryID fromLocation:@"locateActiveJobDescriptorBySelector"];

    if (v10)
    {
      persistedActiveJobs3 = [(MADAutoAssetControlManager *)self persistedActiveJobs];
      v12 = [persistedActiveJobs3 decodeFromLocation:@"locateActiveJobDescriptorBySelector" ofEntryName:persistedEntryID fromPersistedEntry:v10 decodingObjectForKey:@"assetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];
    }

    else
    {
      persistedActiveJobs3 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [persistedActiveJobs3 diag];
      v14 = [[NSString alloc] initWithFormat:@"{locateActiveJobDescriptorBySelector} no jobPersistedState | persistedEntryID:%@", persistedEntryID];
      [diag trackAnomaly:@"AUTO-CONTROL" forReason:v14 withResult:6101 withError:0];

      v12 = 0;
    }
  }

  else
  {
    v12 = 0;
  }

  return v12;
}

- (id)_specifierVersionNamesForSetDescriptor:(id)descriptor
{
  descriptorCopy = descriptor;
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  if (latestDowloadedAtomicInstanceEntries)
  {
    discoveredAtomicEntries = latestDowloadedAtomicInstanceEntries;
  }

  else
  {
    discoveredAtomicEntries = [descriptorCopy discoveredAtomicEntries];
    if (!discoveredAtomicEntries)
    {
      v6 = 0;
      goto LABEL_19;
    }
  }

  v20 = descriptorCopy;
  v6 = objc_msgSend([NSMutableString alloc], "initWithString:", @"(");
  v21 = 0u;
  v22 = 0u;
  v23 = 0u;
  v24 = 0u;
  discoveredAtomicEntries = discoveredAtomicEntries;
  v7 = [discoveredAtomicEntries countByEnumeratingWithState:&v21 objects:v25 count:16];
  if (v7)
  {
    v8 = v7;
    v9 = *v22;
    v10 = 1;
    do
    {
      for (i = 0; i != v8; i = i + 1)
      {
        if (*v22 != v9)
        {
          objc_enumerationMutation(discoveredAtomicEntries);
        }

        v12 = *(*(&v21 + 1) + 8 * i);
        if (v12)
        {
          if ((v10 & 1) == 0)
          {
            [v6 appendString:{@", "}];
          }

          fullAssetSelector = [v12 fullAssetSelector];
          assetVersion = [fullAssetSelector assetVersion];

          fullAssetSelector2 = [v12 fullAssetSelector];
          assetSpecifier = [fullAssetSelector2 assetSpecifier];
          if (assetVersion)
          {
            fullAssetSelector3 = [v12 fullAssetSelector];
            assetVersion2 = [fullAssetSelector3 assetVersion];
            [v6 appendFormat:@"%@<%@>", assetSpecifier, assetVersion2];
          }

          else
          {
            [v6 appendString:assetSpecifier];
          }

          v10 = 0;
        }
      }

      v8 = [discoveredAtomicEntries countByEnumeratingWithState:&v21 objects:v25 count:16];
    }

    while (v8);
  }

  [v6 appendString:@""]);
  descriptorCopy = v20;
LABEL_19:

  return v6;
}

- (id)_specifierVersionNamesForAtomicInstance:(id)instance
{
  instanceEntries = [instance instanceEntries];
  v5 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetEntries:instanceEntries];

  return v5;
}

- (id)_specifierVersionNamesForSetConfiguration:(id)configuration
{
  autoAssetEntries = [configuration autoAssetEntries];
  v5 = [(MADAutoAssetControlManager *)self _specifierVersionNamesForSetEntries:autoAssetEntries];

  return v5;
}

- (id)_specifierVersionNamesForSetEntries:(id)entries
{
  entriesCopy = entries;
  if (entriesCopy)
  {
    v4 = objc_msgSend([NSMutableString alloc], "initWithString:", @"(");
    v20 = 0u;
    v21 = 0u;
    v22 = 0u;
    v23 = 0u;
    v19 = entriesCopy;
    v5 = entriesCopy;
    v6 = [v5 countByEnumeratingWithState:&v20 objects:v24 count:16];
    if (v6)
    {
      v7 = v6;
      v8 = *v21;
      v9 = 1;
      do
      {
        for (i = 0; i != v7; i = i + 1)
        {
          if (*v21 != v8)
          {
            objc_enumerationMutation(v5);
          }

          v11 = *(*(&v20 + 1) + 8 * i);
          if (v11)
          {
            if ((v9 & 1) == 0)
            {
              [v4 appendString:{@", "}];
            }

            assetSelector = [v11 assetSelector];
            assetVersion = [assetSelector assetVersion];

            assetSelector2 = [v11 assetSelector];
            assetSpecifier = [assetSelector2 assetSpecifier];
            if (assetVersion)
            {
              assetSelector3 = [v11 assetSelector];
              assetVersion2 = [assetSelector3 assetVersion];
              [v4 appendFormat:@"%@(%@)", assetSpecifier, assetVersion2];
            }

            else
            {
              [v4 appendString:assetSpecifier];
            }

            v9 = 0;
          }
        }

        v7 = [v5 countByEnumeratingWithState:&v20 objects:v24 count:16];
      }

      while (v7);
    }

    [v4 appendString:@""]);
    entriesCopy = v19;
  }

  else
  {
    v4 = 0;
  }

  return v4;
}

- (void)_logPersistedSetTarget:(id)target operation:(id)operation forPersistedEntryID:(id)d withSetTarget:(id)setTarget message:(id)message
{
  targetCopy = target;
  operationCopy = operation;
  dCopy = d;
  setTargetCopy = setTarget;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    autoControlManagerFSM2 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    diag = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      newSummaryWithoutEntryID = [setTargetCopy newSummaryWithoutEntryID];
      *buf = 138546434;
      v27 = @"PERSISTED";
      v28 = 2114;
      v29 = @"SET_TARGETS";
      v30 = 2114;
      v31 = operationCopy;
      v32 = 2114;
      v33 = diag;
      v34 = 2114;
      v35 = @">----->";
      v36 = 2114;
      v37 = targetCopy;
      v38 = 2114;
      v39 = messageCopy;
      v40 = 2114;
      v41 = diag;
      v42 = 2114;
      v43 = autoControlManagerFSM2;
      v44 = 2114;
      v45 = dCopy;
      v46 = 2114;
      v47 = newSummaryWithoutEntryID;
      v48 = 2114;
      v49 = diag;
      v50 = 2114;
      v51 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v23 = [NSString alloc];
    summary = [setTargetCopy summary];
    v25 = [v23 initWithFormat:@"{%@:_logPersistedSetTarget} %@:%@ | no persistedEntryID | %@ | setTarget:%@", targetCopy, @"SET_TARGETS", operationCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetTargetRemoved:(id)removed removedPersistedEntryID:(id)d removedSetTarget:(id)target message:(id)message
{
  removedCopy = removed;
  dCopy = d;
  targetCopy = target;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
  if (dCopy)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (targetCopy)
    {
      if (v19)
      {
        v20 = removedCopy;
        newSummaryWithoutEntryID = [targetCopy newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_TARGETS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = messageCopy;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = dCopy;
        v49 = 2114;
        v50 = newSummaryWithoutEntryID;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        removedCopy = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_TARGETS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = removedCopy;
      v41 = 2114;
      v42 = messageCopy;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = dCopy;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = removedCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = [NSString alloc];
    if (targetCopy)
    {
      summary = [targetCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetConfigurationRemoved} %@ | no persistedEntryID to remove | %@ | removedSetTarget:%@", v22, @"SET_TARGETS", messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (targetCopy)
    {
    }

    removedCopy = v22;
    v16 = v28;
  }
}

- (void)_logPersistedSetTargetTableOfContents:(id)contents
{
  contentsCopy = contents;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  contentsCopy = [[NSString alloc] initWithFormat:@"%@:_logPersistedSetTargetTableOfContents", contentsCopy];
  v8 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_TARGETS"];
  persistedSetTargets = [(MADAutoAssetControlManager *)self persistedSetTargets];
  v10 = [persistedSetTargets persistedEntryIDs:contentsCopy];

  v27 = v10;
  if ([v10 count])
  {
    v24 = contentsCopy;
    v11 = [v10 count];
    v12 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v35 = v8;
      v36 = 2114;
      v37 = @">----->";
      v38 = 2114;
      v39 = contentsCopy;
      _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} table-of-contents...", buf, 0x3Eu);
    }

    v26 = v8;

    if (v11 >= 1)
    {
      v13 = 0;
      v25 = v11;
      do
      {
        v14 = objc_autoreleasePoolPush();
        v15 = [v27 objectAtIndexedSubscript:v13];
        persistedSetTargets2 = [(MADAutoAssetControlManager *)self persistedSetTargets];
        v17 = [persistedSetTargets2 persistedEntry:v15 fromLocation:contentsCopy];

        if (v17)
        {
          persistedSetTargets3 = [(MADAutoAssetControlManager *)self persistedSetTargets];
          v19 = [persistedSetTargets3 decodeFromLocation:contentsCopy ofEntryName:v15 fromPersistedEntry:v17 decodingObjectForKey:@"setTarget" ofClass:objc_opt_class() allowingNilObject:0];

          v20 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
          {
            newSummaryWithoutEntryID = [v19 newSummaryWithoutEntryID];
            *buf = 138544642;
            v11 = v25;
            v29 = v26;
            v30 = 2114;
            v31 = @"E_LOD";
            v32 = 2048;
            v33 = (v13 + 1);
            v34 = 2048;
            v35 = v25;
            v36 = 2114;
            v37 = v15;
            v38 = 2114;
            v39 = newSummaryWithoutEntryID;
            _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "\n#_%{public}@:%{public}@ (%ld of %ld) [%{public}@] | %{public}@", buf, 0x3Eu);
          }
        }

        else
        {
          v19 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            summary = [(MADAutoAssetControlManager *)self summary];
            *buf = 138544130;
            v29 = contentsCopy;
            v30 = 2114;
            v31 = @"SET_TARGETS";
            v32 = 2114;
            v33 = summary;
            v34 = 2114;
            v35 = v15;
            _os_log_impl(&dword_0, v19, OS_LOG_TYPE_ERROR, "{%{public}@:_logPersistedSetTargetTableOfContents} | (%{public}@) %{public}@ | unable to load entry:%{public}@", buf, 0x2Au);
          }
        }

        objc_autoreleasePoolPop(v14);
        ++v13;
      }

      while (v11 != v13);
    }

    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138544642;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v8 = v26;
      v35 = v26;
      v36 = 2114;
      v37 = @"<-----<";
      v38 = 2114;
      v39 = contentsCopy;
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} ...table-of-contents", buf, 0x3Eu);
      contentsCopy = v24;
    }

    else
    {
      contentsCopy = v24;
      v8 = v26;
    }
  }

  else
  {
    v23 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138545410;
      v29 = @"PERSISTED";
      v30 = 2114;
      v31 = @"SET_TARGETS";
      v32 = 2114;
      v33 = @"ENTRY_LOAD";
      v34 = 2114;
      v35 = v8;
      v36 = 2114;
      v37 = @">----->";
      v38 = 2114;
      v39 = contentsCopy;
      v40 = 2114;
      v41 = @"empty table-of-contents";
      v42 = 2114;
      v43 = v8;
      v44 = 2114;
      v45 = @"<-----<";
      _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:%{public}@", buf, 0x5Cu);
    }
  }
}

- (void)_logPersistedSetLookupResult:(id)result operation:(id)operation forPersistedEntryID:(id)d withSetLookupResult:(id)lookupResult message:(id)message
{
  resultCopy = result;
  operationCopy = operation;
  dCopy = d;
  lookupResultCopy = lookupResult;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (dCopy)
  {
    autoControlManagerFSM2 = [MADAutoAssetPersisted persistedOperationSymbol:operationCopy];
    diag = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_LOOKUP_RESULTS"];
    v21 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      newSummaryWithoutEntryID = [lookupResultCopy newSummaryWithoutEntryID];
      *buf = 138546434;
      v27 = @"PERSISTED";
      v28 = 2114;
      v29 = @"SET_LOOKUP_RESULTS";
      v30 = 2114;
      v31 = operationCopy;
      v32 = 2114;
      v33 = diag;
      v34 = 2114;
      v35 = @">----->";
      v36 = 2114;
      v37 = resultCopy;
      v38 = 2114;
      v39 = messageCopy;
      v40 = 2114;
      v41 = diag;
      v42 = 2114;
      v43 = autoControlManagerFSM2;
      v44 = 2114;
      v45 = dCopy;
      v46 = 2114;
      v47 = newSummaryWithoutEntryID;
      v48 = 2114;
      v49 = diag;
      v50 = 2114;
      v51 = @"<-----<";
      _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);
    }
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v23 = [NSString alloc];
    summary = [lookupResultCopy summary];
    v25 = [v23 initWithFormat:@"{%@:_logPersistedSetLookupResult} %@:%@ | no persistedEntryID | %@ | setLookupResult:%@", resultCopy, @"SET_LOOKUP_RESULTS", operationCopy, messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v25 withResult:6110 withError:0];
  }
}

- (void)_logPersistedSetLookupResultRemoved:(id)removed removedPersistedEntryID:(id)d removedSetLookupResult:(id)result message:(id)message
{
  removedCopy = removed;
  dCopy = d;
  resultCopy = result;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v16 = [MADAutoAssetPersisted persistedOperationSymbol:@"ENTRY_REMOVE"];
  v17 = [MADAutoAssetPersisted persistedComponentSymbol:@"SET_LOOKUP_RESULTS"];
  if (dCopy)
  {
    v18 = _MADLog(@"AutoControl");
    v19 = os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT);
    if (resultCopy)
    {
      if (v19)
      {
        v20 = removedCopy;
        newSummaryWithoutEntryID = [resultCopy newSummaryWithoutEntryID];
        *buf = 138546434;
        v30 = @"PERSISTED";
        v31 = 2114;
        v32 = @"SET_LOOKUP_RESULTS";
        v33 = 2114;
        v34 = @"ENTRY_REMOVE";
        v35 = 2114;
        v36 = v17;
        v37 = 2114;
        v38 = @">----->";
        v39 = 2114;
        v40 = v20;
        v41 = 2114;
        v42 = messageCopy;
        v43 = 2114;
        v44 = v17;
        v45 = 2114;
        v46 = v16;
        v47 = 2114;
        v48 = dCopy;
        v49 = 2114;
        v50 = newSummaryWithoutEntryID;
        v51 = 2114;
        v52 = v17;
        v53 = 2114;
        v54 = @"<-----<";
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@] | %{public}@\n#_%{public}@:%{public}@", buf, 0x84u);

        removedCopy = v20;
      }
    }

    else if (v19)
    {
      *buf = 138546178;
      v30 = @"PERSISTED";
      v31 = 2114;
      v32 = @"SET_LOOKUP_RESULTS";
      v33 = 2114;
      v34 = @"ENTRY_REMOVE";
      v35 = 2114;
      v36 = v17;
      v37 = 2114;
      v38 = @">----->";
      v39 = 2114;
      v40 = removedCopy;
      v41 = 2114;
      v42 = messageCopy;
      v43 = 2114;
      v44 = v17;
      v45 = 2114;
      v46 = v16;
      v47 = 2114;
      v48 = dCopy;
      v49 = 2114;
      v50 = v17;
      v51 = 2114;
      v52 = @"<-----<";
      _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "[%{public}@][%{public}@][%{public}@]\n#_%{public}@:%{public}@ {%{public}@} %{public}@\n#_%{public}@:(%{public}@) [%{public}@]\n#_%{public}@:%{public}@", buf, 0x7Au);
    }
  }

  else
  {
    v28 = v16;
    v22 = removedCopy;
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v25 = [NSString alloc];
    if (resultCopy)
    {
      summary = [resultCopy summary];
    }

    else
    {
      summary = @"N";
    }

    v27 = [v25 initWithFormat:@"{%@:_logPersistedSetLookupResultRemoved} %@ | no persistedEntryID to remove | %@ | removedSetLookupResult:%@", v22, @"SET_LOOKUP_RESULTS", messageCopy, summary];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v27 withResult:6110 withError:0];

    if (resultCopy)
    {
    }

    removedCopy = v22;
    v16 = v28;
  }
}

- (void)_logSetConfigurationEntries:(id)entries forSetConfiguration:(id)configuration
{
  entriesCopy = entries;
  configurationCopy = configuration;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9 = [[NSMutableString alloc] initWithString:@"{\n"];
  v24 = 0u;
  v25 = 0u;
  v26 = 0u;
  v27 = 0u;
  autoAssetEntries = [configurationCopy autoAssetEntries];
  v11 = [autoAssetEntries countByEnumeratingWithState:&v24 objects:v38 count:16];
  if (v11)
  {
    v12 = v11;
    v13 = *v25;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v25 != v13)
        {
          objc_enumerationMutation(autoAssetEntries);
        }

        v15 = *(*(&v24 + 1) + 8 * i);
        if (v15)
        {
          assetSelector = [v15 assetSelector];
          v17 = [(MADAutoAssetControlManager *)self _shortNameForSelector:assetSelector];
          [v9 appendFormat:@"  %@\n", v17];
        }
      }

      v12 = [autoAssetEntries countByEnumeratingWithState:&v24 objects:v38 count:16];
    }

    while (v12);
  }

  [v9 appendString:@"}"];
  v18 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
  {
    latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];
    if (latestAtomicInstanceToVend)
    {
      latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
    }

    else
    {
      latestAtomicInstanceToVend2 = @"N";
    }

    assetSetIdentifier = [configurationCopy assetSetIdentifier];
    firstEntryAssetType = [configurationCopy firstEntryAssetType];
    *buf = 138544386;
    v29 = entriesCopy;
    v30 = 2114;
    v31 = latestAtomicInstanceToVend2;
    v32 = 2114;
    v33 = assetSetIdentifier;
    v34 = 2114;
    v35 = firstEntryAssetType;
    v36 = 2114;
    v37 = v9;
    _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@] assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x34u);

    if (latestAtomicInstanceToVend)
    {
    }
  }
}

- (void)_logAtomicInstanceEntries:(id)entries forAtomicInstance:(id)instance
{
  entriesCopy = entries;
  instanceCopy = instance;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v9 = [[NSMutableString alloc] initWithString:@"{\n"];
  v27 = 0u;
  v28 = 0u;
  v29 = 0u;
  v30 = 0u;
  v25 = instanceCopy;
  instanceEntries = [instanceCopy instanceEntries];
  v11 = [instanceEntries countByEnumeratingWithState:&v27 objects:v41 count:16];
  if (v11)
  {
    v12 = v11;
    assetType = 0;
    v14 = *v28;
    do
    {
      for (i = 0; i != v12; i = i + 1)
      {
        if (*v28 != v14)
        {
          objc_enumerationMutation(instanceEntries);
        }

        v16 = *(*(&v27 + 1) + 8 * i);
        if (v16)
        {
          if (!assetType)
          {
            assetSelector = [*(*(&v27 + 1) + 8 * i) assetSelector];
            assetType = [assetSelector assetType];
          }

          assetSelector2 = [v16 assetSelector];
          v19 = [(MADAutoAssetControlManager *)self _shortNameForSelector:assetSelector2];
          [v9 appendFormat:@"  %@\n", v19];
        }
      }

      v12 = [instanceEntries countByEnumeratingWithState:&v27 objects:v41 count:16];
    }

    while (v12);
  }

  else
  {
    assetType = 0;
  }

  [v9 appendString:@"}"];
  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    atomicInstanceUUID = [v25 atomicInstanceUUID];
    assetSetIdentifier = [v25 assetSetIdentifier];
    v23 = assetSetIdentifier;
    *buf = 138544386;
    v24 = @"N";
    v32 = entriesCopy;
    if (assetType)
    {
      v24 = assetType;
    }

    v33 = 2114;
    v34 = atomicInstanceUUID;
    v35 = 2114;
    v36 = assetSetIdentifier;
    v37 = 2114;
    v38 = v24;
    v39 = 2114;
    v40 = v9;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@] assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x34u);
  }
}

- (void)_logSetDescriptorEntries:(id)entries forSetDescriptor:(id)descriptor
{
  entriesCopy = entries;
  descriptorCopy = descriptor;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  latestDownloadedAtomicInstance = [descriptorCopy latestDownloadedAtomicInstance];
  latestDowloadedAtomicInstanceEntries = [descriptorCopy latestDowloadedAtomicInstanceEntries];
  v11 = [[NSMutableString alloc] initWithString:@"{\n"];
  v29 = descriptorCopy;
  if (latestDowloadedAtomicInstanceEntries)
  {
    v27 = @"latestDowloaded";
    v28 = latestDownloadedAtomicInstance;
  }

  else
  {
    discoveredAtomicInstance = [descriptorCopy discoveredAtomicInstance];

    latestDowloadedAtomicInstanceEntries = [descriptorCopy discoveredAtomicEntries];
    v27 = @"discovered";
    v28 = discoveredAtomicInstance;
  }

  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  v32 = 0u;
  v13 = latestDowloadedAtomicInstanceEntries;
  v14 = [v13 countByEnumeratingWithState:&v31 objects:v47 count:16];
  if (v14)
  {
    v15 = v14;
    assetType = 0;
    v17 = *v32;
    do
    {
      for (i = 0; i != v15; i = i + 1)
      {
        if (*v32 != v17)
        {
          objc_enumerationMutation(v13);
        }

        v19 = *(*(&v31 + 1) + 8 * i);
        if (v19)
        {
          if (!assetType)
          {
            fullAssetSelector = [*(*(&v31 + 1) + 8 * i) fullAssetSelector];
            assetType = [fullAssetSelector assetType];
          }

          fullAssetSelector2 = [v19 fullAssetSelector];
          v22 = [(MADAutoAssetControlManager *)self _shortNameForSelector:fullAssetSelector2];
          [v11 appendFormat:@"  %@\n", v22];
        }
      }

      v15 = [v13 countByEnumeratingWithState:&v31 objects:v47 count:16];
    }

    while (v15);
  }

  else
  {
    assetType = 0;
  }

  [v11 appendString:@"}"];
  v23 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
  {
    assetSetIdentifier = [v29 assetSetIdentifier];
    v25 = assetSetIdentifier;
    *buf = 138544642;
    v26 = @"N";
    v36 = entriesCopy;
    if (assetType)
    {
      v26 = assetType;
    }

    v37 = 2114;
    v38 = v28;
    v39 = 2114;
    v40 = v27;
    v41 = 2114;
    v42 = assetSetIdentifier;
    v43 = 2114;
    v44 = v26;
    v45 = 2114;
    v46 = v11;
    _os_log_impl(&dword_0, v23, OS_LOG_TYPE_DEFAULT, "{%{public}@} [AI:%{public}@](%{public}@) assetSetIdentifier:%{public}@ | assetType:%{public}@ | instanceEntries:\n%{public}@", buf, 0x3Eu);
  }
}

- (id)_shortNameForSelector:(id)selector
{
  selectorCopy = selector;
  if (!__isPlatformVersionAtLeast(2, 18, 0, 0) || (objc_opt_respondsToSelector() & 1) == 0 || ([selectorCopy shortName], (persistedEntryID = objc_claimAutoreleasedReturnValue()) == 0))
  {
    persistedEntryID = [selectorCopy persistedEntryID];
  }

  return persistedEntryID;
}

- (void)_logLookupGrantObtained:(id)obtained ofLookupGrant:(id)grant message:(id)message
{
  obtainedCopy = obtained;
  grantCopy = grant;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    summary = [grantCopy summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = obtainedCopy;
    v19 = 2114;
    v20 = messageCopy;
    v21 = 2114;
    v22 = summary;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][OBTAINED]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(OBTAN) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (void)_logLookupGrantAwaiting:(id)awaiting ofLookupGrant:(id)grant message:(id)message
{
  awaitingCopy = awaiting;
  grantCopy = grant;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    summary = [grantCopy summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = awaitingCopy;
    v19 = 2114;
    v20 = messageCopy;
    v21 = 2114;
    v22 = summary;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][AWAITING]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(AWAIT) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (void)_logLookupGrantReleased:(id)released ofLookupGrant:(id)grant message:(id)message
{
  releasedCopy = released;
  grantCopy = grant;
  messageCopy = message;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
  {
    summary = [grantCopy summary];
    v15 = 138544386;
    v16 = @">----->";
    v17 = 2114;
    v18 = releasedCopy;
    v19 = 2114;
    v20 = messageCopy;
    v21 = 2114;
    v22 = summary;
    v23 = 2114;
    v24 = @"<-----<";
    _os_log_impl(&dword_0, v13, OS_LOG_TYPE_DEFAULT, "[LOOKUP-GRANT][RELEASED]\n#_GRANT:%{public}@ {%{public}@} %{public}@\n#_GRANT:(RELES) %{public}@\n#_GRANT:%{public}@", &v15, 0x34u);
  }
}

- (id)newAssetStatusForSelector:(id)selector withNotifications:(id)notifications withAvailableForUseAttributes:(id)attributes withNewerVersionAttributes:(id)versionAttributes withNeverBeenLocked:(BOOL)locked withDownloadUserInitiated:(BOOL)initiated withDownloadProgress:(id)progress withDownloadedNetworkBytes:(int64_t)self0 withDownloadedFilesystemBytes:(int64_t)self1 withDownloadedAsPatch:(BOOL)self2 withPatchedFromBaseSelector:(id)self3 withPatchedFromBaseFilesystemBytes:(int64_t)self4 withPatchingAttempted:(BOOL)self5 withStagedPriorToAvailable:(BOOL)self6 withStagedFromOSVersion:(id)self7 withStagedFromBuildVersion:(id)self8 extendingWithCurrentLockUsage:(BOOL)self9 withAvailableForUseError:(id)error withPatchingAttemptError:(id)attemptError withNewerVersionError:(id)versionError
{
  lockedCopy = locked;
  initiatedCopy = initiated;
  selectorCopy = selector;
  notificationsCopy = notifications;
  attributesCopy = attributes;
  versionAttributesCopy = versionAttributes;
  progressCopy = progress;
  baseSelectorCopy = baseSelector;
  versionCopy = version;
  buildVersionCopy = buildVersion;
  errorCopy = error;
  attemptErrorCopy = attemptError;
  versionErrorCopy = versionError;
  v29 = notificationsCopy;
  v37 = v29;
  if (!v29)
  {
    v29 = objc_alloc_init(MAAutoAssetNotifications);
  }

  v35 = v29;
  if (usage)
  {
    v30 = [MADAutoAssetLocker newCurrentLockUsageForSelector:selectorCopy];
  }

  else
  {
    v30 = 0;
  }

  if (__isPlatformVersionAtLeast(2, 16, 4, 0))
  {
    v31 = v30;
  }

  else
  {
    v31 = 0;
  }

  LOWORD(v34) = __PAIR16__(available, attempted);
  LOBYTE(v33) = patch;
  v42 = [[MAAutoAssetStatus alloc] initWithAssetSelector:selectorCopy withNotifications:v35 withAvailableForUseAttributes:attributesCopy withNewerVersionAttributes:versionAttributesCopy withNeverBeenLocked:lockedCopy withDownloadUserInitiated:initiatedCopy withDownloadProgress:progressCopy withDownloadedNetworkBytes:bytes withDownloadedFilesystemBytes:filesystemBytes withDownloadedAsPatch:v33 withPatchedFromBaseSelector:baseSelectorCopy withPatchedFromBaseFilesystemBytes:baseFilesystemBytes withPatchingAttempted:v34 withStagedPriorToAvailable:versionCopy withStagedFromOSVersion:buildVersionCopy withStagedFromBuildVersion:v31 withCurrentLockUsage:errorCopy withAvailableForUseError:attemptErrorCopy withPatchingAttemptError:versionErrorCopy withNewerVersionError:?];

  return v42;
}

- (id)_newAtomicInstancesDownloadedForSetIdentifier:(id)identifier
{
  identifierCopy = identifier;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = objc_alloc_init(NSMutableArray);
  clientDomainName = [identifierCopy clientDomainName];
  v23 = identifierCopy;
  assetSetIdentifier = [identifierCopy assetSetIdentifier];
  v10 = [(MADAutoAssetControlManager *)self setDescriptorWalkKeysForClientDomainName:clientDomainName assetSetIdentifier:assetSetIdentifier];

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_newAtomicInstancesDownloadedForSetIdentifier" ofContainer:@"setDescriptorKeysForAssetSet"];
  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v11 = v10;
  v12 = [v11 countByEnumeratingWithState:&v24 objects:v28 count:16];
  if (v12)
  {
    v13 = v12;
    v14 = *v25;
    do
    {
      v15 = 0;
      do
      {
        if (*v25 != v14)
        {
          objc_enumerationMutation(v11);
        }

        v16 = *(*(&v24 + 1) + 8 * v15);
        v17 = objc_autoreleasePoolPush();
        v18 = [(MADAutoAssetControlManager *)self setDescriptorWalkLocate:@"_newAtomicInstancesDownloadedForSetIdentifier" forKey:v16];
        latestDownloadedAtomicInstance = [v18 latestDownloadedAtomicInstance];

        if (latestDownloadedAtomicInstance)
        {
          latestDownloadedAtomicInstance2 = [v18 latestDownloadedAtomicInstance];
          [v7 addObject:latestDownloadedAtomicInstance2];
        }

        objc_autoreleasePoolPop(v17);
        v15 = v15 + 1;
      }

      while (v13 != v15);
      v13 = [v11 countByEnumeratingWithState:&v24 objects:v28 count:16];
    }

    while (v13);
  }

  if ([v7 count])
  {
    v21 = v7;
  }

  else
  {
    v21 = 0;
  }

  return v21;
}

- (BOOL)_isClientRequestForSetJob:(id)job
{
  v3 = [(MADAutoAssetControlManager *)self clientRequestMessageName:job];
  v4 = ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ALTER_ENTRIES_REPRESENTING_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:NEED_FOR_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CHECK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:LOCK_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:MAP_LOCKED_ATOMIC_ENTRY"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:FORM_SUB_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CONTINUE_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCK"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:END_ATOMIC_LOCKS_FOR_CLIENT"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ASSET_SET_FOR_STAGING"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:CURRENT_SET_STATUS"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET:ELIMINATE_ATOMIC"]& 1) != 0 || ([SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:ASSET_SETS_OVERVIEW"]& 1) != 0 || [SUCore stringIsEqual:v3 to:@"MA-AUTO-SET-CONTROL:SET_INSTANCE_INFO"];

  return v4;
}

- (id)firstAssetTypeForSetEntries:(id)entries
{
  entriesCopy = entries;
  if ([entriesCopy count])
  {
    v4 = [entriesCopy objectAtIndex:0];
    assetSelector = [v4 assetSelector];
    assetType = [assetSelector assetType];
  }

  else
  {
    assetType = 0;
  }

  return assetType;
}

- (id)currentSetStatusFromJobInformation:(id)information
{
  informationCopy = information;
  foundContent = [informationCopy foundContent];
  currentSetStatus = [foundContent currentSetStatus];

  if (!currentSetStatus)
  {
    currentSetStatus = [informationCopy currentSetStatus];
  }

  return currentSetStatus;
}

- (id)newAssetSetStatus:(id)status forReason:(id)reason forClientDomain:(id)domain forAssetSetIdentifier:(id)identifier withAtomicInstancesDownloaded:(id)downloaded withNewerAtomicInstanceDiscovered:(id)discovered withNewerDiscoveredAtomicEntries:(id)entries withLatestDownloadedAtomicInstance:(id)self0 withLatestDownloadedAtomicInstanceFromPreSUStaging:(BOOL)self1 withLatestDowloadedAtomicInstanceEntries:(id)self2 withCurrentNotifications:(id)self3 withCurrentNeedPolicy:(id)self4 withSchedulerPolicy:(id)self5 withStagerPolicy:(id)self6 withDownloadUserInitiated:(BOOL)self7 withDownloadProgress:(id)self8 withDownloadedNetworkBytes:(int64_t)self9 withDownloadedFilesystemBytes:(int64_t)filesystemBytes extendingWithCurrentLockUsage:(BOOL)usage withSelectorsForStaging:(id)forStaging withAvailableForUseError:(id)error withNewerVersionError:(id)versionError
{
  statusCopy = status;
  domainCopy = domain;
  identifierCopy = identifier;
  downloadedCopy = downloaded;
  discoveredCopy = discovered;
  entriesCopy = entries;
  instanceCopy = instance;
  instanceEntriesCopy = instanceEntries;
  v31 = domainCopy;
  notificationsCopy = notifications;
  v33 = identifierCopy;
  policyCopy = policy;
  selfCopy2 = self;
  schedulerPolicyCopy = schedulerPolicy;
  stagerPolicyCopy = stagerPolicy;
  progressCopy = progress;
  forStagingCopy = forStaging;
  errorCopy = error;
  versionErrorCopy = versionError;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v104 = v31;
  v39 = [(MADAutoAssetControlManager *)self locateSetConfigurationByClientDomain:v31 forAssetSetIdentifier:v33];
  v93 = notificationsCopy;
  if (v39)
  {
    v89 = instanceEntriesCopy;
    v40 = notificationsCopy;
    if (!v40)
    {
      v40 = objc_alloc_init(MANAutoAssetSetNotifications);
    }

    v88 = v40;
    latestAtomicInstanceToVend = [v39 latestAtomicInstanceToVend];

    if (latestAtomicInstanceToVend)
    {
      latestAtomicInstanceToVend2 = [v39 latestAtomicInstanceToVend];
      v43 = [(MADAutoAssetControlManager *)self locateSetDescriptor:statusCopy forAtomicInstanceUUID:latestAtomicInstanceToVend2 requireExists:1];

      if (v43)
      {
        latestDownloadedAtomicInstance = [v43 latestDownloadedAtomicInstance];
        LOBYTE(latestAtomicInstanceToVend) = [SUCore stringIsEqual:instanceCopy to:latestDownloadedAtomicInstance];

        selfCopy2 = self;
      }

      else
      {
        LOBYTE(latestAtomicInstanceToVend) = 0;
      }
    }

    v53 = [(MADAutoAssetControlManager *)selfCopy2 _errorUnlessSameVersionFound:errorCopy changedReportedError:0];

    v54 = [(MADAutoAssetControlManager *)selfCopy2 _errorUnlessSameVersionFound:versionErrorCopy changedReportedError:0];

    v81 = [MANAutoAssetSetStatus alloc];
    v80 = [(MADAutoAssetControlManager *)selfCopy2 setConfigurationAssetEntries:v104 forAssetSetIdentifier:v33];
    [v39 mostRecentlyReceivedCachedAssetSetID];
    v79 = v55 = selfCopy2;
    mostRecentlyReceivedDownloadedFromLive = [v39 mostRecentlyReceivedDownloadedFromLive];
    mostRecentlyReceivedLastTimeChecked = [v39 mostRecentlyReceivedLastTimeChecked];
    mostRecentlyReceivedPostedDate = [v39 mostRecentlyReceivedPostedDate];
    v56 = instanceCopy;
    if ((latestAtomicInstanceToVend & 1) == 0)
    {
      v56 = 0;
    }

    v78 = v56;
    v57 = v89;
    if ((latestAtomicInstanceToVend & 1) == 0)
    {
      v57 = 0;
    }

    v77 = v57;
    latestToVendCachedAssetSetID = [v39 latestToVendCachedAssetSetID];
    latestToVendDownloadedFromLive = [v39 latestToVendDownloadedFromLive];
    latestToVendLastTimeChecked = [v39 latestToVendLastTimeChecked];
    latestToVendPostedDate = [v39 latestToVendPostedDate];
    haveReceivedLookupResponse = [v39 haveReceivedLookupResponse];
    vendingAtomicInstanceForConfiguredEntries = [v39 vendingAtomicInstanceForConfiguredEntries];
    v62 = vendingAtomicInstanceForConfiguredEntries;
    v84 = v54;
    v85 = v53;
    if (usage)
    {
      [(MADAutoAssetControlManager *)v55 setLockUsageMapForClientDomain:v104 forSetIdentifier:v33];
      v64 = v63 = latestToVendDownloadedFromLive;
      v73 = v53;
      v75 = v54;
      BYTE2(v72) = initiated;
      BYTE1(v72) = v62;
      LOBYTE(v72) = haveReceivedLookupResponse;
      LOBYTE(v71) = staging;
      v65 = mostRecentlyReceivedLastTimeChecked;
      v66 = v33;
      v67 = v33;
      diag = v80;
      v49 = v79;
      v68 = mostRecentlyReceivedDownloadedFromLive;
      v92 = [MANAutoAssetSetStatus initStatusForClientDomain:v81 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v104 withAtomicInstancesDownloaded:v67 withCatalogCachedAssetSetID:mostRecentlyReceivedLastTimeChecked withCatalogDownloadedFromLive:mostRecentlyReceivedPostedDate withCatalogLastTimeChecked:discoveredCopy withCatalogPostedDate:entriesCopy withNewerAtomicInstanceDiscovered:v78 withNewerDiscoveredAtomicEntries:v71 withLatestDownloadedAtomicInstance:v77 withLatestDownloadedAtomicInstanceFromPreSUStaging:latestToVendCachedAssetSetID withLatestDowloadedAtomicInstanceEntries:v63 withDownloadedCatalogCachedAssetSetID:latestToVendLastTimeChecked withDownloadedCatalogDownloadedFromLive:latestToVendPostedDate withDownloadedCatalogLastTimeChecked:v88 withDownloadedCatalogPostedDate:policyCopy withCurrentNotifications:schedulerPolicyCopy withCurrentNeedPolicy:stagerPolicyCopy withSchedulerPolicy:v72 withStagerPolicy:progressCopy havingReceivedLookupResponse:bytes vendingAtomicInstanceForConfiguredEntries:filesystemBytes withDownloadUserInitiated:v64 withDownloadProgress:forStagingCopy withDownloadedNetworkBytes:v73 withDownloadedFilesystemBytes:v75 withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];

      latestToVendDownloadedFromLive = v63;
    }

    else
    {
      v74 = v53;
      v76 = v54;
      BYTE2(v72) = initiated;
      BYTE1(v72) = vendingAtomicInstanceForConfiguredEntries;
      LOBYTE(v72) = haveReceivedLookupResponse;
      LOBYTE(v71) = staging;
      v65 = mostRecentlyReceivedLastTimeChecked;
      v66 = v33;
      v69 = v33;
      diag = v80;
      v49 = v79;
      v68 = mostRecentlyReceivedDownloadedFromLive;
      v92 = [MANAutoAssetSetStatus initStatusForClientDomain:v81 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:v104 withAtomicInstancesDownloaded:v69 withCatalogCachedAssetSetID:mostRecentlyReceivedLastTimeChecked withCatalogDownloadedFromLive:mostRecentlyReceivedPostedDate withCatalogLastTimeChecked:discoveredCopy withCatalogPostedDate:entriesCopy withNewerAtomicInstanceDiscovered:v78 withNewerDiscoveredAtomicEntries:v71 withLatestDownloadedAtomicInstance:v77 withLatestDownloadedAtomicInstanceFromPreSUStaging:latestToVendCachedAssetSetID withLatestDowloadedAtomicInstanceEntries:latestToVendDownloadedFromLive withDownloadedCatalogCachedAssetSetID:latestToVendLastTimeChecked withDownloadedCatalogDownloadedFromLive:latestToVendPostedDate withDownloadedCatalogLastTimeChecked:v88 withDownloadedCatalogPostedDate:policyCopy withCurrentNotifications:schedulerPolicyCopy withCurrentNeedPolicy:stagerPolicyCopy withSchedulerPolicy:v72 withStagerPolicy:progressCopy havingReceivedLookupResponse:bytes vendingAtomicInstanceForConfiguredEntries:filesystemBytes withDownloadUserInitiated:0 withDownloadProgress:forStagingCopy withDownloadedNetworkBytes:v74 withDownloadedFilesystemBytes:v76 withCurrentLockUsage:? withSelectorsForStaging:? withAvailableForUseError:? withNewerVersionError:?];
    }

    v47 = statusCopy;
    v48 = v66;
    v52 = entriesCopy;
    autoControlManagerFSM2 = v88;
    instanceEntriesCopy = v89;
    v50 = v84;
    v51 = v85;
  }

  else
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v47 = statusCopy;
    v48 = v33;
    v49 = [[NSString alloc] initWithFormat:@"{%@:newAssetSetStatus} no set-configuration | clientDomainName:%@ | assetSetIdentifier:%@", statusCopy, v104, v33];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v49 withResult:6108 withError:0];
    v92 = 0;
    v50 = versionErrorCopy;
    v51 = errorCopy;
    v52 = entriesCopy;
  }

  return v92;
}

- (id)autoAssetDescriptorsForSet:(id)set
{
  setCopy = set;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v7 = objc_alloc_init(NSMutableArray);
  v16 = 0u;
  v17 = 0u;
  v18 = 0u;
  v19 = 0u;
  latestDowloadedAtomicInstanceEntries = [setCopy latestDowloadedAtomicInstanceEntries];
  v9 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v16 objects:v20 count:16];
  if (v9)
  {
    v10 = v9;
    v11 = *v17;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v17 != v11)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries);
        }

        fullAssetSelector = [*(*(&v16 + 1) + 8 * i) fullAssetSelector];
        v14 = [(MADAutoAssetControlManager *)self locateDownloadedByFullSelector:fullAssetSelector];

        if (v14)
        {
          [v7 addObject:v14];
        }
      }

      v10 = [latestDowloadedAtomicInstanceEntries countByEnumeratingWithState:&v16 objects:v20 count:16];
    }

    while (v10);
  }

  return v7;
}

- (id)alreadyHaveSetDescriptorMatching:(id)matching
{
  matchingCopy = matching;
  latestDowloadedAtomicInstanceEntries = [matchingCopy latestDowloadedAtomicInstanceEntries];
  v5 = [latestDowloadedAtomicInstanceEntries count];

  if (v5 < 1)
  {
    v20 = 0;
    goto LABEL_58;
  }

  persistedDownloadedSetDescriptors = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
  v7 = [persistedDownloadedSetDescriptors persistedEntryIDs:@"alreadyHaveSetDescriptorMatching"];

  if (![v7 count])
  {
    v20 = 0;
    goto LABEL_57;
  }

  v94 = 0u;
  v95 = 0u;
  v92 = 0u;
  v93 = 0u;
  v8 = v7;
  v68 = [v8 countByEnumeratingWithState:&v92 objects:v102 count:16];
  if (!v68)
  {
LABEL_52:
    v20 = 0;
    goto LABEL_56;
  }

  v67 = *v93;
  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v60 = v8;
  v61 = v7;
  selfCopy = self;
  v59 = v5;
LABEL_5:
  v10 = 0;
  while (1)
  {
    if (*v93 != v67)
    {
      objc_enumerationMutation(v8);
    }

    v71 = v10;
    v11 = *(*(&v92 + 1) + 8 * v10);
    v12 = objc_autoreleasePoolPush();
    v13 = v12;
    if (!v11)
    {
      v51 = _MADLog(@"AutoControl");
      v72 = v51;
      if (os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543362;
        v99 = _updateLatestSummary;
        _os_log_impl(&dword_0, v51, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} no entryID", buf, 0xCu);
      }

      v53 = v71;
      goto LABEL_50;
    }

    context = v12;
    persistedDownloadedSetDescriptors2 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    v15 = [persistedDownloadedSetDescriptors2 persistedEntry:v11 fromLocation:@"alreadyHaveSetDescriptorMatching"];

    v72 = v15;
    if (!v15)
    {
      v54 = _MADLog(@"AutoControl");
      v70 = v54;
      if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary2 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v99 = _updateLatestSummary2;
        v100 = 2114;
        v101 = v11;
        _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} unable to determine previous status | entryID:%{public}@", buf, 0x16u);
      }

      goto LABEL_43;
    }

    persistedDownloadedSetDescriptors3 = [(MADAutoAssetControlManager *)self persistedDownloadedSetDescriptors];
    v17 = [persistedDownloadedSetDescriptors3 decodeFromLocation:@"alreadyHaveSetDescriptorMatching" ofEntryName:v11 fromPersistedEntry:v15 decodingObjectForKey:@"assetSetDescriptor" ofClass:objc_opt_class() allowingNilObject:0];

    v70 = v17;
    if (!v17)
    {
      v56 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
      {
        _updateLatestSummary3 = [(MADAutoAssetControlManager *)self _updateLatestSummary];
        *buf = 138543618;
        v99 = _updateLatestSummary3;
        v100 = 2114;
        v101 = v11;
        _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "[%{public}@] {alreadyHaveSetDescriptorMatching} unable to load set-descriptor | entryID:%{public}@", buf, 0x16u);
      }

      v13 = context;
LABEL_48:

      v53 = v71;
      goto LABEL_49;
    }

    latestDowloadedAtomicInstanceEntries2 = [v17 latestDowloadedAtomicInstanceEntries];
    v19 = [latestDowloadedAtomicInstanceEntries2 count];

    if (v19 == v5)
    {
      break;
    }

LABEL_43:
    v53 = v71;
    v13 = context;
LABEL_49:

LABEL_50:
    objc_autoreleasePoolPop(v13);
    v10 = v53 + 1;
    if (v10 == v68)
    {
      v68 = [v8 countByEnumeratingWithState:&v92 objects:v102 count:16];
      if (!v68)
      {
        goto LABEL_52;
      }

      goto LABEL_5;
    }
  }

  v90 = 0u;
  v91 = 0u;
  v88 = 0u;
  v89 = 0u;
  obj = [matchingCopy latestDowloadedAtomicInstanceEntries];
  v20 = v17;
  v64 = [obj countByEnumeratingWithState:&v88 objects:v97 count:16];
  if (!v64)
  {
    goto LABEL_55;
  }

  v65 = *v89;
  while (2)
  {
    v21 = 0;
    while (2)
    {
      if (*v89 != v65)
      {
        objc_enumerationMutation(obj);
      }

      v66 = v21;
      v22 = *(*(&v88 + 1) + 8 * v21);
      v84 = 0u;
      v85 = 0u;
      v86 = 0u;
      v87 = 0u;
      latestDowloadedAtomicInstanceEntries3 = [v20 latestDowloadedAtomicInstanceEntries];
      v23 = [latestDowloadedAtomicInstanceEntries3 countByEnumeratingWithState:&v84 objects:v96 count:16];
      if (!v23)
      {
LABEL_47:

        v8 = v60;
        v7 = v61;
        self = selfCopy;
        v5 = v59;
        v13 = context;
        v56 = obj;
        goto LABEL_48;
      }

      v24 = v23;
      v25 = *v85;
      v78 = *v85;
      while (2)
      {
        v26 = 0;
        v79 = v24;
LABEL_20:
        if (*v85 != v25)
        {
          objc_enumerationMutation(latestDowloadedAtomicInstanceEntries3);
        }

        v27 = *(*(&v84 + 1) + 8 * v26);
        v28 = p_weak_ivar_lyt[223];
        fullAssetSelector = [v27 fullAssetSelector];
        assetType = [fullAssetSelector assetType];
        fullAssetSelector2 = [v22 fullAssetSelector];
        assetType2 = [fullAssetSelector2 assetType];
        if (![v28 stringIsEqual:assetType to:assetType2])
        {
LABEL_31:

LABEL_32:
          if (v24 == ++v26)
          {
            v24 = [latestDowloadedAtomicInstanceEntries3 countByEnumeratingWithState:&v84 objects:v96 count:16];
            if (v24)
            {
              continue;
            }

            goto LABEL_47;
          }

          goto LABEL_20;
        }

        break;
      }

      v81 = assetType;
      localContentURL5 = fullAssetSelector2;
      v32 = p_weak_ivar_lyt[223];
      fullAssetSelector3 = [v27 fullAssetSelector];
      assetSpecifier = [fullAssetSelector3 assetSpecifier];
      [v22 fullAssetSelector];
      v36 = v35 = v27;
      assetSpecifier2 = [v36 assetSpecifier];
      if (![v32 stringIsEqual:assetSpecifier to:assetSpecifier2])
      {

        v25 = v78;
        v24 = v79;
        assetType = v81;
LABEL_30:

        fullAssetSelector2 = localContentURL5;
        goto LABEL_31;
      }

      v77 = p_weak_ivar_lyt[223];
      v74 = v35;
      fullAssetSelector4 = [v35 fullAssetSelector];
      [fullAssetSelector4 assetVersion];
      v76 = fullAssetSelector3;
      v39 = v38 = v22;
      fullAssetSelector5 = [v38 fullAssetSelector];
      [fullAssetSelector5 assetVersion];
      v42 = v41 = p_weak_ivar_lyt;
      LODWORD(v77) = [v77 stringIsEqual:v39 to:v42];

      p_weak_ivar_lyt = v41;
      v22 = v38;

      v25 = v78;
      v24 = v79;
      if (!v77)
      {
        goto LABEL_32;
      }

      v43 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v43, OS_LOG_TYPE_DEFAULT))
      {
        localContentURL = [v74 localContentURL];
        localContentURL2 = [v38 localContentURL];
        *buf = 138412546;
        v99 = localContentURL;
        v100 = 2112;
        v101 = localContentURL2;
        _os_log_impl(&dword_0, v43, OS_LOG_TYPE_DEFAULT, "{alreadyHaveSetDescriptorMatching} nextEntry localContent URL: %@, checkEntry localContent URL: %@", buf, 0x16u);
      }

      localContentURL3 = [v74 localContentURL];
      localContentURL4 = [v38 localContentURL];
      v48 = [localContentURL3 isEqual:localContentURL4];

      if ((v48 & 1) == 0)
      {
        fullAssetSelector = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
        diag = [fullAssetSelector diag];
        v50 = [NSString alloc];
        localContentURL5 = [v22 localContentURL];
        assetType2 = [localContentURL5 absoluteURL];
        assetType = diag;
        fullAssetSelector3 = [v74 localContentURL];
        assetSpecifier = [fullAssetSelector3 absoluteURL];
        v36 = [v50 initWithFormat:@"{alreadyHaveSetDescriptorMatching} Set atomic entries with identical asset type, specifier and version has different paths on the filesystem. foundEntry: %@, persistedEntry:%@", assetType2, assetSpecifier];
        [assetType trackAnomaly:@"AUTO-CONTROL" forReason:v36 withResult:6108 withError:0];
        goto LABEL_30;
      }

      v21 = v66 + 1;
      v20 = v70;
      if ((v66 + 1) != v64)
      {
        continue;
      }

      break;
    }

    v64 = [obj countByEnumeratingWithState:&v88 objects:v97 count:16];
    if (v64)
    {
      continue;
    }

    break;
  }

LABEL_55:

  objc_autoreleasePoolPop(context);
  v8 = v60;
  v7 = v61;
LABEL_56:

LABEL_57:
LABEL_58:

  return v20;
}

- (BOOL)newAtomicInstanceAndSetDescriptor:(id)descriptor fromSetLookupResult:(id)result vendingLatestForConfiguration:(id)configuration inStartup:(BOOL)startup allowEmpty:(BOOL)empty notifyClients:(BOOL)clients forCreationReason:(id)reason recordingHistoryOperation:(int64_t)self0
{
  clientsCopy = clients;
  emptyCopy = empty;
  startupCopy = startup;
  descriptorCopy = descriptor;
  resultCopy = result;
  configurationCopy = configuration;
  reasonCopy = reason;
  selfCopy = self;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  descriptorCopy = [[NSString alloc] initWithFormat:@"%@:newAtomicInstanceAndSetDescriptorFromStaged", descriptorCopy];
  v22 = 0;
  if (resultCopy && configurationCopy)
  {
    discoveredAtomicEntries = [resultCopy discoveredAtomicEntries];
    v24 = [discoveredAtomicEntries count];

    if (v24 || emptyCopy)
    {
      v90 = startupCopy;
      v91 = clientsCopy;
      v96 = descriptorCopy;
      v97 = configurationCopy;
      v92 = reasonCopy;
      firstEntryAssetType = [configurationCopy firstEntryAssetType];
      v106 = 0u;
      v107 = 0u;
      v108 = 0u;
      v109 = 0u;
      v93 = resultCopy;
      discoveredAtomicEntries2 = [resultCopy discoveredAtomicEntries];
      v26 = [discoveredAtomicEntries2 countByEnumeratingWithState:&v106 objects:v119 count:16];
      if (v26)
      {
        v27 = v26;
        v28 = *v107;
        while (2)
        {
          for (i = 0; i != v27; i = i + 1)
          {
            if (*v107 != v28)
            {
              objc_enumerationMutation(discoveredAtomicEntries2);
            }

            v30 = *(*(&v106 + 1) + 8 * i);
            v31 = objc_autoreleasePoolPush();
            if (!v30 || ([v97 autoAssetEntries], v32 = objc_claimAutoreleasedReturnValue(), v33 = -[MADAutoAssetControlManager isAtomicEntry:desiredForAutoAssetSetEntries:](selfCopy, "isAtomicEntry:desiredForAutoAssetSetEntries:", v30, v32), v32, v33) && (objc_msgSend(v30, "fullAssetSelector"), v34 = objc_claimAutoreleasedReturnValue(), objc_msgSend(v34, "assetType"), v35 = objc_claimAutoreleasedReturnValue(), v36 = +[SUCore stringIsEqual:to:](SUCore, "stringIsEqual:to:", v35, firstEntryAssetType), v35, v34, (v36 & 1) == 0))
            {
              objc_autoreleasePoolPop(v31);
              v22 = 0;
              reasonCopy = v92;
              descriptorCopy = v96;
              configurationCopy = v97;
              goto LABEL_44;
            }

            objc_autoreleasePoolPop(v31);
          }

          v27 = [discoveredAtomicEntries2 countByEnumeratingWithState:&v106 objects:v119 count:16];
          if (v27)
          {
            continue;
          }

          break;
        }
      }

      v88 = descriptorCopy;

      v37 = +[NSUUID UUID];
      uUIDString = [v37 UUIDString];

      v99 = objc_alloc_init(NSMutableArray);
      v102 = 0u;
      v103 = 0u;
      v104 = 0u;
      v105 = 0u;
      obj = [resultCopy discoveredAtomicEntries];
      v38 = [obj countByEnumeratingWithState:&v102 objects:v118 count:16];
      configurationCopy = v97;
      v39 = selfCopy;
      if (v38)
      {
        v40 = v38;
        v41 = *v103;
        v98 = *v103;
        do
        {
          for (j = 0; j != v40; j = j + 1)
          {
            if (*v103 != v41)
            {
              objc_enumerationMutation(obj);
            }

            v43 = *(*(&v102 + 1) + 8 * j);
            v44 = objc_autoreleasePoolPush();
            autoAssetEntries = [configurationCopy autoAssetEntries];
            v46 = [(MADAutoAssetControlManager *)v39 isAtomicEntry:v43 desiredForAutoAssetSetEntries:autoAssetEntries];

            if (v46)
            {
              fullAssetSelector = [v43 fullAssetSelector];
              v48 = [(MADAutoAssetControlManager *)v39 locateDownloadedByFullSelector:fullAssetSelector];

              if (v48)
              {
                assetType = [v48 assetType];
                assetId = [v48 assetId];
                v51 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType, assetId, 2, @"auto");

                if (v51)
                {
                  v52 = [MANAutoAssetSetAtomicEntry alloc];
                  fullAssetSelector2 = [v43 fullAssetSelector];
                  assetId2 = [v48 assetId];
                  metadata = [v48 metadata];
                  autoControlManagerFSM3 = [(MANAutoAssetSetAtomicEntry *)v52 initWithFullAssetSelector:fullAssetSelector2 withAssetID:assetId2 withLocalContentURL:v51 withAssetAttributes:metadata inhibitedFromEmergencyRemoval:0];

                  if (autoControlManagerFSM3)
                  {
                    [v99 addObject:autoControlManagerFSM3];
                  }

                  else
                  {
                    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)selfCopy autoControlManagerFSM];
                    diag = [autoControlManagerFSM2 diag];
                    v63 = [NSString alloc];
                    summary = [v48 summary];
                    v65 = [v63 initWithFormat:@"{%@:newAtomicInstanceAndSetDescriptorFromStaged} unable to allocate already-downloaded-atomic-entry | alreadyDownloadedDescriptor:%@", v96, summary];
                    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v65 withResult:6111 withError:0];
                  }

                  configurationCopy = v97;
                }

                else
                {
                  autoControlManagerFSM3 = [(MADAutoAssetControlManager *)v39 autoControlManagerFSM];
                  diag2 = [(MANAutoAssetSetAtomicEntry *)autoControlManagerFSM3 diag];
                  v58 = [NSString alloc];
                  summary2 = [v48 summary];
                  v60 = [v58 initWithFormat:@"{%@} unable to determine localContentURL of already-downloaded-descriptor | alreadyDownloadedDescriptor:%@", v96, summary2];
                  [diag2 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v60 withResult:6111 withError:0];
                }

                v39 = selfCopy;
                v41 = v98;
              }

              else
              {
                [v99 addObject:v43];
              }
            }

            objc_autoreleasePoolPop(v44);
          }

          v40 = [obj countByEnumeratingWithState:&v102 objects:v118 count:16];
        }

        while (v40);
      }

      v66 = [MADAutoSetDescriptor alloc];
      clientDomainName = [configurationCopy clientDomainName];
      [configurationCopy assetSetIdentifier];
      v69 = v68 = v39;
      v70 = [(MADAutoSetDescriptor *)v66 initForClientDomainName:clientDomainName forAssetSetIdentifier:v69 withDiscoveredAtomicInstance:uUIDString withDiscoveredAtomicEntries:v99];

      resultCopy = v93;
      catalogCachedAssetSetID = [v93 catalogCachedAssetSetID];
      [v70 setCatalogCachedAssetSetID:catalogCachedAssetSetID];

      catalogDownloadedFromLive = [v93 catalogDownloadedFromLive];
      [v70 setCatalogDownloadedFromLive:catalogDownloadedFromLive];

      catalogLastTimeChecked = [v93 catalogLastTimeChecked];
      [v70 setCatalogLastTimeChecked:catalogLastTimeChecked];

      catalogPostedDate = [v93 catalogPostedDate];
      [v70 setCatalogPostedDate:catalogPostedDate];

      catalogCachedAssetSetID2 = [v93 catalogCachedAssetSetID];
      [v70 setDownloadedCatalogCachedAssetSetID:catalogCachedAssetSetID2];

      catalogDownloadedFromLive2 = [v93 catalogDownloadedFromLive];
      [v70 setDownloadedCatalogDownloadedFromLive:catalogDownloadedFromLive2];

      catalogLastTimeChecked2 = [v93 catalogLastTimeChecked];
      [v70 setDownloadedCatalogLastTimeChecked:catalogLastTimeChecked2];

      catalogPostedDate2 = [v93 catalogPostedDate];
      [v70 setDownloadedCatalogPostedDate:catalogPostedDate2];

      requestedAutoAssetEntries = [v93 requestedAutoAssetEntries];
      [v70 setRequestedAutoAssetEntries:requestedAutoAssetEntries];

      [v70 setLatestDownloadedAtomicInstance:uUIDString];
      [v70 setLatestDowloadedAtomicInstanceEntries:v99];
      [v70 setIsOnFilesystem:1];
      [v70 setIsDiscoveredFullyDownloaded:1];
      [v70 setAtomicInstanceDownloadedNotified:!v91];
      [v70 setNeverBeenLocked:1];
      descriptorCopy = v96;
      if ([(MADAutoAssetControlManager *)v68 isEveryAssetEntryOnFilesystemForSetDescriptor:v96 forSetDescriptor:v70])
      {
        reasonCopy = v92;
        v80 = [(MADAutoAssetControlManager *)v68 atomicInstanceNewSetAtomicInstance:v96 forCreationReason:v92 recordingHistoryOperation:operation recoveringForSetDescriptor:v70 usingAsSetClient:@"AutoControlManagerActingAsClient"];
        descriptorCopy = v88;
        v81 = v90 && [(MADAutoAssetControlManager *)v68 isAtomicInstancePartOfPSUS:v80];
        LOBYTE(v87) = v81;
        BYTE2(v86) = 0;
        LOWORD(v86) = 0;
        v82 = v68;
        discoveredAtomicEntries2 = uUIDString;
        [MADAutoAssetControlManager trackSetDescriptor:v82 fromLocation:"trackSetDescriptor:fromLocation:forLatestDownloaded:forSpecificAtomicInstance:withCurrentSetStatus:changedWhileTerminated:changedNeverBeenLocked:notifyingIfJustDownloaded:latestToVend:historyOperation:firstClientName:fromPreSUStaging:" forLatestDownloaded:v70 forSpecificAtomicInstance:v96 withCurrentSetStatus:1 changedWhileTerminated:uUIDString changedNeverBeenLocked:0 notifyingIfJustDownloaded:0 latestToVend:v86 historyOperation:operation firstClientName:@"AutoControlManagerActingAsClient" fromPreSUStaging:v87];
        v83 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v83, OS_LOG_TYPE_DEFAULT))
        {
          summary3 = [v70 summary];
          *buf = 138544130;
          v111 = v96;
          v112 = 2114;
          v113 = v92;
          v114 = 2114;
          v115 = summary3;
          v116 = 2114;
          v117 = v99;
          _os_log_impl(&dword_0, v83, OS_LOG_TYPE_DEFAULT, "{%{public}@} [%{public}@] | fromLookupResultSetDescriptor:%{public}@ | reportedDiscoveredEntries:\n%{public}@", buf, 0x2Au);

          descriptorCopy = v96;
        }

        configurationCopy = v97;
        v22 = [(MADAutoAssetControlManager *)selfCopy setConfigurationAdoptLatestToVend:descriptorCopy fromSetDescriptor:v70 toSetConfiguration:v97 fromPreSUStaging:v81 allowEmpty:emptyCopy];
      }

      else
      {
        v22 = 0;
        descriptorCopy = v88;
        discoveredAtomicEntries2 = uUIDString;
        reasonCopy = v92;
      }

LABEL_44:
    }

    else
    {
      v22 = 0;
    }
  }

  return v22;
}

- (BOOL)cancelActiveSetJob:(id)job activeSetJob:(id)setJob
{
  setJobCopy = setJob;
  jobCopy = job;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  jobCopy = [[NSString alloc] initWithFormat:@"%@:cancelActiveSetJob", jobCopy];
  clientDomainName = [setJobCopy clientDomainName];
  autoAssetSetIdentifier = [setJobCopy autoAssetSetIdentifier];
  v13 = [(MADAutoAssetControlManager *)self locateSetJobForClientDomain:clientDomainName byIdentifier:autoAssetSetIdentifier];

  clientDomainName2 = [setJobCopy clientDomainName];
  autoAssetSetIdentifier2 = [setJobCopy autoAssetSetIdentifier];
  v16 = [(MADAutoAssetControlManager *)self locateCancelingSetJobForClientDomain:clientDomainName2 byIdentifier:autoAssetSetIdentifier2];

  if (!v13)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v22 = [NSString alloc];
    summary = [setJobCopy summary];
    v18Diag = summary;
    if (v16)
    {
      v25 = [v22 initWithFormat:@"{%@} canceling active set-job that is already in canceling table | currentSetJob:%@", jobCopy, summary];
      v26 = diag;
      v27 = v25;
      v28 = 6110;
    }

    else
    {
      v25 = [v22 initWithFormat:@"{%@} canceling active set-job that is not in routing table | currentSetJob:%@", jobCopy, summary];
      v26 = diag;
      v27 = v25;
      v28 = 6111;
    }

    [v26 trackAnomaly:@"AUTO-SET-CONTROL" forReason:v27 withResult:v28 withError:0];

    goto LABEL_10;
  }

  if (v16)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v19 = [NSString alloc];
    summary2 = [setJobCopy summary];
    v21 = [v19 initWithFormat:@"{%@} canceling active set-job that is also already in canceling table | currentSetJob:%@", jobCopy, summary2];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v21 withResult:6111 withError:0];

LABEL_11:
    v33 = 0;
    goto LABEL_12;
  }

  clientDomainName3 = [setJobCopy clientDomainName];
  autoAssetSetIdentifier3 = [setJobCopy autoAssetSetIdentifier];
  autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self newSetEntryIDForClientDomain:clientDomainName3 forAssetSetIdentifier:autoAssetSetIdentifier3];

  if (!autoControlManagerFSM2)
  {
    diag = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    v18Diag = [diag diag];
    v35 = [NSString alloc];
    summary3 = [setJobCopy summary];
    v37 = [v35 initWithFormat:@"{%@} canceling active set-job but unable to form set-job-key | currentSetJob:%@", jobCopy, summary3];
    [v18Diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v37 withResult:6101 withError:0];

LABEL_10:
    goto LABEL_11;
  }

  currentSetJobsByIdentifier = [(MADAutoAssetControlManager *)self currentSetJobsByIdentifier];
  [currentSetJobsByIdentifier removeObjectForKey:autoControlManagerFSM2];

  cancelingSetJobsByIdentifier = [(MADAutoAssetControlManager *)self cancelingSetJobsByIdentifier];
  [cancelingSetJobsByIdentifier setSafeObject:setJobCopy forKey:autoControlManagerFSM2];

  v33 = 1;
  [setJobCopy setBeingCanceled:1];
  [setJobCopy cancelAutoAssetJob];
LABEL_12:

  return v33;
}

- (id)_errorUnlessSameVersionFound:(id)found changedReportedError:(BOOL *)error
{
  foundCopy = found;
  v6 = foundCopy;
  if (!foundCopy)
  {
    v9 = 0;
    v10 = 0;
    if (!error)
    {
      goto LABEL_10;
    }

LABEL_9:
    *error = v10;
    goto LABEL_10;
  }

  domain = [foundCopy domain];
  if (![SUCore stringIsEqual:domain to:@"com.apple.MobileAssetError.AutoAsset"])
  {
    v10 = 0;
    v9 = v6;
LABEL_8:

    if (!error)
    {
      goto LABEL_10;
    }

    goto LABEL_9;
  }

  code = [v6 code];

  if (code == "ateCoreConnect.framework/SoftwareUpdateCoreConnect")
  {
    v9 = 0;
    v10 = 1;
    domain = v6;
    goto LABEL_8;
  }

  v10 = 0;
  v9 = v6;
  if (error)
  {
    goto LABEL_9;
  }

LABEL_10:

  return v9;
}

- (id)_constructSetInfoSameFoundFrom:(id)from forSetConfiguration:(id)configuration fromSetStatus:(id)status
{
  fromCopy = from;
  configurationCopy = configuration;
  statusCopy = status;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v13 = fromCopy;
  v14 = v13;
  v15 = v13;
  if (v13)
  {
    v15 = v13;
    if (configurationCopy)
    {
      latestAtomicInstanceToVend = [configurationCopy latestAtomicInstanceToVend];
      v17 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"_constructSetInfoSameFoundFrom" forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:1];

      v15 = v14;
      if (v17)
      {
        v49 = [MANAutoAssetSetStatus alloc];
        clientDomainName = [configurationCopy clientDomainName];
        assetSetIdentifier = [configurationCopy assetSetIdentifier];
        autoAssetEntries = [configurationCopy autoAssetEntries];
        v74 = [autoAssetEntries copy];
        atomicInstancesDownloaded = [statusCopy atomicInstancesDownloaded];
        v73 = [atomicInstancesDownloaded copy];
        catalogCachedAssetSetID = [statusCopy catalogCachedAssetSetID];
        v72 = [catalogCachedAssetSetID copy];
        catalogDownloadedFromLive = [statusCopy catalogDownloadedFromLive];
        v71 = [catalogDownloadedFromLive copy];
        catalogLastTimeChecked = [statusCopy catalogLastTimeChecked];
        v70 = [catalogLastTimeChecked copy];
        catalogPostedDate = [statusCopy catalogPostedDate];
        v69 = [catalogPostedDate copy];
        latestAtomicInstanceToVend2 = [configurationCopy latestAtomicInstanceToVend];
        v68 = [latestAtomicInstanceToVend2 copy];
        latestDowloadedAtomicInstanceEntries = [v17 latestDowloadedAtomicInstanceEntries];
        v67 = [latestDowloadedAtomicInstanceEntries copy];
        latestAtomicInstanceToVend3 = [configurationCopy latestAtomicInstanceToVend];
        v66 = [latestAtomicInstanceToVend3 copy];
        latestAtomicInstanceToVendFromPreSUStaging = [configurationCopy latestAtomicInstanceToVendFromPreSUStaging];
        latestDowloadedAtomicInstanceEntries2 = [v17 latestDowloadedAtomicInstanceEntries];
        v65 = [latestDowloadedAtomicInstanceEntries2 copy];
        latestToVendCachedAssetSetID = [configurationCopy latestToVendCachedAssetSetID];
        v64 = [latestToVendCachedAssetSetID copy];
        latestToVendDownloadedFromLive = [configurationCopy latestToVendDownloadedFromLive];
        v63 = [latestToVendDownloadedFromLive copy];
        latestToVendLastTimeChecked = [configurationCopy latestToVendLastTimeChecked];
        v62 = [latestToVendLastTimeChecked copy];
        latestToVendPostedDate = [configurationCopy latestToVendPostedDate];
        v61 = [latestToVendPostedDate copy];
        currentNotifications = [statusCopy currentNotifications];
        v37 = [currentNotifications copy];
        currentNeedPolicy = [statusCopy currentNeedPolicy];
        v35 = [currentNeedPolicy copy];
        schedulerPolicy = [statusCopy schedulerPolicy];
        v34 = [schedulerPolicy copy];
        stagerPolicy = [statusCopy stagerPolicy];
        v33 = [stagerPolicy copy];
        haveReceivedLookupResponse = [configurationCopy haveReceivedLookupResponse];
        vendingAtomicInstanceForConfiguredEntries = [configurationCopy vendingAtomicInstanceForConfiguredEntries];
        downloadUserInitiated = [statusCopy downloadUserInitiated];
        downloadProgress = [statusCopy downloadProgress];
        v60 = v17;
        v30 = [downloadProgress copy];
        downloadedNetworkBytes = [statusCopy downloadedNetworkBytes];
        downloadedFilesystemBytes = [statusCopy downloadedFilesystemBytes];
        currentLockUsage = [statusCopy currentLockUsage];
        selectorsForStaging = [statusCopy selectorsForStaging];
        availableForUseError = [configurationCopy availableForUseError];
        newerVersionError = [configurationCopy newerVersionError];
        BYTE2(v29) = downloadUserInitiated;
        BYTE1(v29) = vendingAtomicInstanceForConfiguredEntries;
        LOBYTE(v29) = haveReceivedLookupResponse;
        LOBYTE(v28) = latestAtomicInstanceToVendFromPreSUStaging;
        v50 = [MANAutoAssetSetStatus initStatusForClientDomain:v49 forAssetSetIdentifier:"initStatusForClientDomain:forAssetSetIdentifier:withConfiguredAssetEntries:withAtomicInstancesDownloaded:withCatalogCachedAssetSetID:withCatalogDownloadedFromLive:withCatalogLastTimeChecked:withCatalogPostedDate:withNewerAtomicInstanceDiscovered:withNewerDiscoveredAtomicEntries:withLatestDownloadedAtomicInstance:withLatestDownloadedAtomicInstanceFromPreSUStaging:withLatestDowloadedAtomicInstanceEntries:withDownloadedCatalogCachedAssetSetID:withDownloadedCatalogDownloadedFromLive:withDownloadedCatalogLastTimeChecked:withDownloadedCatalogPostedDate:withCurrentNotifications:withCurrentNeedPolicy:withSchedulerPolicy:withStagerPolicy:havingReceivedLookupResponse:vendingAtomicInstanceForConfiguredEntries:withDownloadUserInitiated:withDownloadProgress:withDownloadedNetworkBytes:withDownloadedFilesystemBytes:withCurrentLockUsage:withSelectorsForStaging:withAvailableForUseError:withNewerVersionError:" withConfiguredAssetEntries:clientDomainName withAtomicInstancesDownloaded:assetSetIdentifier withCatalogCachedAssetSetID:v74 withCatalogDownloadedFromLive:v73 withCatalogLastTimeChecked:v72 withCatalogPostedDate:v71 withNewerAtomicInstanceDiscovered:v70 withNewerDiscoveredAtomicEntries:v69 withLatestDownloadedAtomicInstance:v68 withLatestDownloadedAtomicInstanceFromPreSUStaging:v67 withLatestDowloadedAtomicInstanceEntries:v66 withDownloadedCatalogCachedAssetSetID:v28 withDownloadedCatalogDownloadedFromLive:v65 withDownloadedCatalogLastTimeChecked:v64 withDownloadedCatalogPostedDate:v63 withCurrentNotifications:v62 withCurrentNeedPolicy:v61 withSchedulerPolicy:v37 withStagerPolicy:v35 havingReceivedLookupResponse:v34 vendingAtomicInstanceForConfiguredEntries:v33 withDownloadUserInitiated:v29 withDownloadProgress:v30 withDownloadedNetworkBytes:downloadedNetworkBytes withDownloadedFilesystemBytes:downloadedFilesystemBytes withCurrentLockUsage:currentLockUsage withSelectorsForStaging:selectorsForStaging withAvailableForUseError:availableForUseError withNewerVersionError:newerVersionError];

        v24 = [MANAutoAssetSetInfoFound alloc];
        assetSetIdentifier2 = [configurationCopy assetSetIdentifier];
        v26 = v24;
        v17 = v60;
        v15 = [(MANAutoAssetSetInfoFound *)v26 initForAssetSetIdentifier:assetSetIdentifier2 reportingStatus:v50];
      }
    }
  }

  return v15;
}

- (BOOL)jobToBeIncluded:(id)included basedOnControl:(id)control
{
  includedCopy = included;
  controlCopy = control;
  v7 = controlCopy;
  if (controlCopy && ([controlCopy limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v20 = 0u;
    v21 = 0u;
    v18 = 0u;
    v19 = 0u;
    limitedToAssetTypes = [v7 limitedToAssetTypes];
    v10 = [limitedToAssetTypes countByEnumeratingWithState:&v18 objects:v22 count:16];
    if (v10)
    {
      v17 = v7;
      v11 = *v19;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v19 != v11)
          {
            objc_enumerationMutation(limitedToAssetTypes);
          }

          v13 = *(*(&v18 + 1) + 8 * i);
          autoAssetSelector = [includedCopy autoAssetSelector];
          assetType = [autoAssetSelector assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:assetType to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [limitedToAssetTypes countByEnumeratingWithState:&v18 objects:v22 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }

LABEL_14:
      v7 = v17;
    }
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

+ (BOOL)selectorToBeIncluded:(id)included basedOnControl:(id)control
{
  includedCopy = included;
  controlCopy = control;
  v7 = controlCopy;
  if (controlCopy && ([controlCopy limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v18 = 0u;
    v19 = 0u;
    v16 = 0u;
    v17 = 0u;
    limitedToAssetTypes = [v7 limitedToAssetTypes];
    v10 = [limitedToAssetTypes countByEnumeratingWithState:&v16 objects:v20 count:16];
    if (v10)
    {
      v11 = *v17;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v17 != v11)
          {
            objc_enumerationMutation(limitedToAssetTypes);
          }

          v13 = *(*(&v16 + 1) + 8 * i);
          assetType = [includedCopy assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:assetType to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [limitedToAssetTypes countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

LABEL_14:
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

+ (BOOL)descriptorToBeIncluded:(id)included basedOnControl:(id)control
{
  includedCopy = included;
  controlCopy = control;
  v7 = controlCopy;
  if (controlCopy && ([controlCopy limitedToAssetTypes], v8 = objc_claimAutoreleasedReturnValue(), v8, v8))
  {
    v18 = 0u;
    v19 = 0u;
    v16 = 0u;
    v17 = 0u;
    limitedToAssetTypes = [v7 limitedToAssetTypes];
    v10 = [limitedToAssetTypes countByEnumeratingWithState:&v16 objects:v20 count:16];
    if (v10)
    {
      v11 = *v17;
      while (2)
      {
        for (i = 0; i != v10; i = i + 1)
        {
          if (*v17 != v11)
          {
            objc_enumerationMutation(limitedToAssetTypes);
          }

          v13 = *(*(&v16 + 1) + 8 * i);
          assetType = [includedCopy assetType];
          LOBYTE(v13) = [SUCore stringIsEqual:assetType to:v13];

          if (v13)
          {
            LOBYTE(v10) = 1;
            goto LABEL_14;
          }
        }

        v10 = [limitedToAssetTypes countByEnumeratingWithState:&v16 objects:v20 count:16];
        if (v10)
        {
          continue;
        }

        break;
      }
    }

LABEL_14:
  }

  else
  {
    LOBYTE(v10) = 1;
  }

  return v10;
}

- (id)_preInstalledSetAtomicEntriesFromInstanceEntries:(id)entries
{
  entriesCopy = entries;
  v38 = objc_alloc_init(NSMutableArray);
  v43 = 0u;
  v44 = 0u;
  v45 = 0u;
  v46 = 0u;
  v5 = entriesCopy;
  v6 = [v5 countByEnumeratingWithState:&v43 objects:v51 count:16];
  obj = v5;
  if (!v6)
  {
LABEL_25:

    goto LABEL_26;
  }

  v8 = v6;
  v9 = *v44;
  v42 = 1;
  *&v7 = 138543362;
  v37 = v7;
  v39 = *v44;
  do
  {
    v10 = 0;
    v40 = v8;
    do
    {
      if (*v44 != v9)
      {
        objc_enumerationMutation(obj);
      }

      v11 = *(*(&v43 + 1) + 8 * v10);
      v12 = objc_autoreleasePoolPush();
      assetSelector = [v11 assetSelector];
      assetType = [assetSelector assetType];
      assetSelector2 = [v11 assetSelector];
      assetSpecifier = [assetSelector2 assetSpecifier];
      v17 = [(MADAutoAssetControlManager *)self _preInstalledDescriptor:@"_preInstalledSetAtomicEntriesFromInstanceEntries" forAssetType:assetType withAssetSpecifier:assetSpecifier];

      if (v17)
      {
        assetType2 = [v17 assetType];
        assetId = [v17 assetId];
        v20 = getAutoLocalUrlFromTypeAndIdWithPurpose(assetType2, assetId, 2, @"auto");

        if (v20)
        {
          selfCopy = self;
          v22 = [MAAutoAssetSelector alloc];
          assetType3 = [v17 assetType];
          assetSpecifier2 = [v17 assetSpecifier];
          assetVersion = [v17 assetVersion];
          v26 = [v22 initForAssetType:assetType3 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion];

          v27 = [MANAutoAssetSetAtomicEntry alloc];
          assetId2 = [v17 assetId];
          metadata = [v17 metadata];
          v30 = [(MANAutoAssetSetAtomicEntry *)v27 initWithFullAssetSelector:v26 withAssetID:assetId2 withLocalContentURL:v20 withAssetAttributes:metadata inhibitedFromEmergencyRemoval:0];

          if (v30)
          {
            [v38 addObject:v30];
          }

          else
          {
            v32 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
            {
              summary = [v17 summary];
              *buf = v37;
              v48 = summary;
              _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledSetAtomicEntriesFromInstanceEntries} unable to allocate set-atomic-entry | nextDescriptor:%{public}@", buf, 0xCu);
            }

            v42 = 0;
          }

          self = selfCopy;
          v8 = v40;

          v9 = v39;
        }

        else
        {
          v26 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            summary2 = [v17 summary];
            *buf = v37;
            v48 = summary2;
            _os_log_impl(&dword_0, v26, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] [LOCAL-CONTENT-URL] {_preInstalledSetAtomicEntriesFromInstanceEntries} unable to get local content URL | nextDescriptor:%{public}@", buf, 0xCu);
          }

          v42 = 0;
        }
      }

      else
      {
        v42 = 0;
      }

      objc_autoreleasePoolPop(v12);
      v10 = v10 + 1;
    }

    while (v8 != v10);
    v8 = [obj countByEnumeratingWithState:&v43 objects:v51 count:16];
  }

  while (v8);

  if ((v42 & 1) == 0 && [v38 count])
  {
    v5 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 138543618;
      v48 = obj;
      v49 = 2114;
      v50 = v38;
      _os_log_impl(&dword_0, v5, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledSetAtomicEntriesFromInstanceEntries} found some of desired instance-entries (valid when providing pre-installed)\ninstanceEntries:\n%{public}@\npreInstalledAtomicEntries:\n%{public}@", buf, 0x16u);
    }

    goto LABEL_25;
  }

LABEL_26:
  if ([v38 count])
  {
    v34 = v38;
  }

  else
  {
    v34 = 0;
  }

  v35 = v34;

  return v34;
}

- (void)_preInstalledMakeDescriptorAvailable:(id)available fromLocation:(id)location
{
  availableCopy = available;
  locationCopy = location;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  assetType = [availableCopy assetType];
  assetSpecifier = [availableCopy assetSpecifier];
  assetVersion = [availableCopy assetVersion];
  v13 = [(MADAutoAssetControlManager *)self _latestDownloadedDescriptor:@"IssueClientReplyJobResponse" forAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

  if (v13)
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v16 = [NSString alloc];
    summary = [availableCopy summary];
    summary2 = [v13 summary];
    v19 = [v16 initWithFormat:@"{%@:_preInstalledMakeDescriptorAvailable} already migrated | availableToMigrate:%@, alreadyAvailable:%@", locationCopy, summary, summary2];
    [diag trackAnomaly:@"AUTO-CONTROL" forReason:v19 withResult:6109 withError:0];

    goto LABEL_3;
  }

  [availableCopy setIsOnFilesystem:1];
  if (![(MADAutoAssetControlManager *)self jobDescriptorOnFilesystemValidated:availableCopy])
  {
    [availableCopy setIsOnFilesystem:0];
    autoControlManagerFSM2 = _MADLog(@"AutoControl");
    if (!os_log_type_enabled(autoControlManagerFSM2, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_4;
    }

    diag = [availableCopy summary];
    *buf = 138543618;
    v38 = locationCopy;
    v39 = 2114;
    v40 = diag;
    _os_log_impl(&dword_0, autoControlManagerFSM2, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {%{public}@:_preInstalledMakeDescriptorAvailable} attempted to migrate asset but not on filesystem | descriptor:%{public}@", buf, 0x16u);
LABEL_3:

LABEL_4:
    goto LABEL_5;
  }

  v20 = [MAAutoAssetSelector alloc];
  assetType2 = [availableCopy assetType];
  assetSpecifier2 = [availableCopy assetSpecifier];
  assetVersion2 = [availableCopy assetVersion];
  v24 = [v20 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion2];

  v25 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v25, OS_LOG_TYPE_DEFAULT))
  {
    summary3 = [availableCopy summary];
    *buf = 138543618;
    v38 = locationCopy;
    v39 = 2114;
    v40 = summary3;
    _os_log_impl(&dword_0, v25, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {%{public}@:_preInstalledMakeDescriptorAvailable} content on filesystem validated for migration | descriptor:%{public}@", buf, 0x16u);
  }

  LOBYTE(v33) = 0;
  [(MADAutoAssetControlManager *)self trackDescriptor:availableCopy persisting:1 fromLocation:@"_preInstalledMakeDescriptorAvailable" changedWhileTerminated:0 changedNeverBeenLocked:0 historyOperation:0 firstClientName:0 isPromoted:v33];
  v27 = objc_opt_new();
  [v27 setContentAvailableForUse:1];
  metadata = [availableCopy metadata];
  LOBYTE(v36) = 0;
  LOWORD(v35) = 0;
  LOBYTE(v34) = 0;
  v29 = [(MADAutoAssetControlManager *)self newAssetStatusForSelector:v24 withNotifications:v27 withAvailableForUseAttributes:metadata withNewerVersionAttributes:0 withNeverBeenLocked:1 withDownloadUserInitiated:0 withDownloadProgress:0 withDownloadedNetworkBytes:-1 withDownloadedFilesystemBytes:-1 withDownloadedAsPatch:v34 withPatchedFromBaseSelector:0 withPatchedFromBaseFilesystemBytes:-1 withPatchingAttempted:v35 withStagedPriorToAvailable:0 withStagedFromOSVersion:0 withStagedFromBuildVersion:v36 extendingWithCurrentLockUsage:0 withAvailableForUseError:0 withPatchingAttemptError:0 withNewerVersionError:?];

  assetVersion3 = [v24 assetVersion];
  [(MADAutoAssetControlManager *)self updateAutoAssetStatus:v24 forActiveJobUUID:0 withLatestJobStatus:v29 matchingAssetVersion:assetVersion3 fromLocation:@"_preInstalledMakeDescriptorAvailable"];

  assetType3 = [availableCopy assetType];
  assetSpecifier3 = [availableCopy assetSpecifier];
  [MADAutoAssetControlManager postNotificationName:@"ASSET_VERSION_DOWNLOADED" forAssetType:assetType3 forAssetSpecifier:assetSpecifier3 fromModule:@"PRE-INSTALLED" fromLocation:@"_preInstalledMakeDescriptorAvailable"];

LABEL_5:
}

- (id)_preInstalledRelocateAutoAssets
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v5 = getRepositoryPath(@"/private/var/MobileAsset/PreinstalledAssetsV2/InstallWithOs");
  v6 = +[NSFileManager defaultManager];
  v114 = 0;
  v7 = [v6 contentsOfDirectoryAtPath:v5 error:&v114];
  v8 = v114;

  if (v7)
  {
    v9 = v8 == 0;
  }

  else
  {
    v9 = 0;
  }

  if (v9)
  {
    v98 = objc_opt_new();
    selfCopy = self;
    [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_preInstalledRelocateAutoAssets" ofContainer:@"dirs(MA_PATH_TO_INSTALL_WITH_OS)"];
    v112 = 0u;
    v113 = 0u;
    v110 = 0u;
    v111 = 0u;
    v13 = v7;
    v14 = [v13 countByEnumeratingWithState:&v110 objects:v127 count:16];
    if (v14)
    {
      v15 = v14;
      v16 = *v111;
      p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
      v92 = v5;
      v85 = v13;
      v86 = v7;
      v84 = *v111;
      do
      {
        v18 = 0;
        v87 = v15;
        do
        {
          if (*v111 != v16)
          {
            objc_enumerationMutation(v13);
          }

          v19 = *(*(&v110 + 1) + 8 * v18);
          if (isWellFormedNormalizedAssetType(v19))
          {
            v103 = assetTypeFromNormalized(v19);
            v20 = getPreInstalledAssets(v5, v103, 0, 0);
            v21 = v20;
            if (v20 && [v20 count])
            {
              v108 = 0u;
              v109 = 0u;
              v106 = 0u;
              v107 = 0u;
              allKeys = [v21 allKeys];
              v102 = [allKeys countByEnumeratingWithState:&v106 objects:v126 count:16];
              if (!v102)
              {
                goto LABEL_68;
              }

              v88 = v18;
              v100 = *v107;
              v101 = v21;
              v23 = v103;
              obj = allKeys;
              while (1)
              {
                for (i = 0; i != v102; i = i + 1)
                {
                  if (*v107 != v100)
                  {
                    objc_enumerationMutation(obj);
                  }

                  v25 = *(*(&v106 + 1) + 8 * i);
                  v26 = objc_autoreleasePoolPush();
                  v27 = [v101 objectForKeyedSubscript:v25];
                  v28 = getPathToAssetWithPurpose(v5, v23, v25, 0);
                  lastPathComponent = [v28 lastPathComponent];
                  if ([p_weak_ivar_lyt[316] isAutoAssetMetadata:v27])
                  {
                    v30 = objc_alloc(p_weak_ivar_lyt[316]);
                    v105 = 0;
                    v31 = [v30 initForAssetType:v23 fromMetadata:v27 invalidReasons:&v105];
                    v32 = v105;
                    if (v31)
                    {
                      if (([v31 isMAAutoAsset]& 1) != 0)
                      {
                        if ([v28 isFileURL])
                        {
                          v33 = v28;
                        }

                        else
                        {
                          absoluteURL = [v28 absoluteURL];
                          path = [absoluteURL path];
                          v42 = [NSURL fileURLWithPath:path isDirectory:1];

                          v33 = v42;
                        }

                        path2 = [v28 path];
                        v43 = getDownloadManager();
                        v97 = v33;
                        v44 = [v43 decryptContentEncryptedAssetAtPathIfRequired:v33];

                        v96 = v26;
                        if (v44)
                        {
                          v45 = repositoryPath(v103);
                          v46 = getAutoLocalUrlFromTypeGivenDefaultRepoWithPurpose(v103, 1, v45, @"auto");

                          path3 = [v46 path];
                          v48 = ensureDirectory(path3);

                          v49 = [v46 URLByAppendingPathComponent:lastPathComponent];

                          v94 = v49;
                          path4 = [v49 path];
                          path5 = [v28 path];

                          v52 = +[NSFileManager defaultManager];
                          v104 = 0;
                          v93 = path5;
                          v95 = path4;
                          [v52 moveItemAtPath:path5 toPath:path4 error:&v104];
                          v53 = v104;

                          if (v53)
                          {
                            v54 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
                            {
                              summary = [v31 summary];
                              checkedDescription = [v53 checkedDescription];
                              *buf = 138544130;
                              v118 = summary;
                              v119 = 2114;
                              v120 = path5;
                              v121 = 2114;
                              v122 = v95;
                              v123 = 2114;
                              v124 = checkedDescription;
                              v56 = checkedDescription;
                              _os_log_impl(&dword_0, v54, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Attempted to move auto-asset but failed | descriptor:%{public}@ | fromPath:%{public}@ | toPath:%{public}@ | error:%{public}@", buf, 0x2Au);
                            }

                            v57 = +[NSFileManager defaultManager];
                            [v57 removeItemAtPath:v95 error:0];

                            v58 = +[NSFileManager defaultManager];
                            path2 = v93;
                            [v58 removeItemAtPath:v93 error:0];

                            v59 = [v98 objectForKeyedSubscript:@"Failure"];
                            v60 = v59;
                            if (v59)
                            {
                              [v59 arrayByAddingObject:v31];
                            }

                            else
                            {
                              v116 = v31;
                              [NSArray arrayWithObjects:&v116 count:1];
                            }
                            v69 = ;
                            v68 = v92;
                            [v98 setObject:v69 forKeyedSubscript:@"Failure"];
                          }

                          else
                          {
                            [v31 setFoundAsPreInstalled:1];
                            [(MADAutoAssetControlManager *)selfCopy _preinstalledTrackBySelector:v31];
                            v66 = [v98 objectForKeyedSubscript:@"Success"];
                            v91 = v66;
                            if (v66)
                            {
                              [v66 arrayByAddingObject:v31];
                            }

                            else
                            {
                              v115 = v31;
                              [NSArray arrayWithObjects:&v115 count:1];
                            }
                            v70 = ;
                            [v98 setObject:v70 forKeyedSubscript:@"Success"];

                            v71 = getControlManager();
                            v69 = [v71 getSAFRegistrationBundleID:v94];

                            v72 = getControlManager();
                            [v72 updateSpaceAttributionForBundleID:v69 assetPath:v28 doRegistration:0];

                            v73 = getControlManager();
                            [v73 updateSpaceAttributionForBundleID:v69 assetPath:v94 doRegistration:1];

                            v74 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
                            {
                              summary2 = [v31 summary];
                              *buf = 138543618;
                              v118 = v95;
                              v119 = 2114;
                              v120 = summary2;
                              _os_log_impl(&dword_0, v74, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Added descriptor for pre-installed asset | path:%{public}@ | descriptor:%{public}@ ", buf, 0x16u);
                            }

                            v68 = v92;
                            path2 = v93;
                            v60 = v91;
                          }

                          v65 = v94;
                          v67 = v95;
                        }

                        else
                        {
                          v61 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
                          {
                            summary3 = [v31 summary];
                            *buf = 138543874;
                            v118 = v28;
                            v119 = 2114;
                            v120 = v103;
                            v121 = 2114;
                            v122 = summary3;
                            _os_log_impl(&dword_0, v61, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Failed to decrypt contentEncrypted asset at | path:%{public}@ | assetType:%{public}@ | descriptor:%{public}@", buf, 0x20u);
                          }

                          v63 = +[NSFileManager defaultManager];
                          [v63 removeItemAtPath:path2 error:0];

                          v64 = [v98 objectForKeyedSubscript:@"Failure"];
                          v65 = v64;
                          if (v64)
                          {
                            [v64 arrayByAddingObject:v31];
                          }

                          else
                          {
                            v125 = v31;
                            [NSArray arrayWithObjects:&v125 count:1];
                          }
                          v67 = ;
                          v68 = v92;
                          [v98 setObject:v67 forKeyedSubscript:@"Failure"];
                        }

                        v5 = v68;
                        v26 = v96;
                      }

                      else
                      {
                        path2 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(path2, OS_LOG_TYPE_ERROR))
                        {
                          summary4 = [v31 summary];
                          *buf = 138543874;
                          v118 = v5;
                          v119 = 2114;
                          v120 = v103;
                          v121 = 2114;
                          v122 = summary4;
                          _os_log_impl(&dword_0, path2, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Descriptor created for auto-asset metadata does not describe an auto-asset | path:%{public}@ | assetType:%{public}@ | descriptor:%{public}@", buf, 0x20u);
                        }
                      }

                      goto LABEL_60;
                    }

                    path2 = _MADLog(@"AutoControl");
                    v35 = os_log_type_enabled(path2, OS_LOG_TYPE_ERROR);
                    if (v32)
                    {
                      if (v35)
                      {
                        *buf = 138543874;
                        v118 = v5;
                        v119 = 2114;
                        v120 = v103;
                        v121 = 2114;
                        v122 = v32;
                        v36 = path2;
                        v37 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Unable to create descriptor | path:%{public}@ | assetType:%{public}@ | reasons:%{public}@";
                        v38 = 32;
                        goto LABEL_47;
                      }
                    }

                    else if (v35)
                    {
                      *buf = 138543618;
                      v118 = v5;
                      v119 = 2114;
                      v120 = v103;
                      v36 = path2;
                      v37 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Unable to create descriptor | path:%{public}@ | assetType:%{public}@";
                      v38 = 22;
LABEL_47:
                      _os_log_impl(&dword_0, v36, OS_LOG_TYPE_ERROR, v37, buf, v38);
                    }

LABEL_60:

                    p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
                    goto LABEL_61;
                  }

                  v31 = _MADLog(@"AutoControl");
                  if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
                  {
                    *buf = 138543874;
                    v118 = v5;
                    v119 = 2114;
                    v120 = v23;
                    v121 = 2114;
                    v122 = v25;
                    _os_log_impl(&dword_0, v31, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Not migrating since not an auto-asset | path:%{public}@ | assetType:%{public}@ | assetID:%{public}@", buf, 0x20u);
                  }

                  v32 = 0;
LABEL_61:

                  objc_autoreleasePoolPop(v26);
                  v23 = v103;
                }

                allKeys = obj;
                v102 = [obj countByEnumeratingWithState:&v106 objects:v126 count:16];
                if (!v102)
                {
                  v13 = v85;
                  v7 = v86;
                  v15 = v87;
                  v18 = v88;
                  v16 = v84;
                  v21 = v101;
                  goto LABEL_68;
                }
              }
            }

            allKeys = _MADLog(@"AutoControl");
            if (os_log_type_enabled(allKeys, OS_LOG_TYPE_DEFAULT))
            {
              *buf = 138543618;
              v118 = v5;
              v119 = 2114;
              v120 = v103;
              _os_log_impl(&dword_0, allKeys, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No pre-installed assets for asset-type | path:%{public}@ | assetType:%{public}@", buf, 0x16u);
            }

LABEL_68:
          }

          else
          {
            v76 = _MADLog(@"AutoControl");
            v103 = v76;
            if (os_log_type_enabled(v76, OS_LOG_TYPE_ERROR))
            {
              *buf = 138543362;
              v118 = v19;
              _os_log_impl(&dword_0, v76, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Skipping malformed asset directory | assetDir:%{public}@ ", buf, 0xCu);
            }
          }

          v18 = v18 + 1;
        }

        while (v18 != v15);
        v15 = [v13 countByEnumeratingWithState:&v110 objects:v127 count:16];
      }

      while (v15);
    }

    v77 = [v98 count];
    v11 = _MADLog(@"AutoControl");
    v78 = os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT);
    if (v77 <= 0)
    {
      if (v78)
      {
        *buf = 138543362;
        v118 = v5;
        v80 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No pre-installed auto-assets were relocated | path:%{public}@";
        v81 = v11;
        v82 = 12;
LABEL_81:
        _os_log_impl(&dword_0, v81, OS_LOG_TYPE_DEFAULT, v80, buf, v82);
      }
    }

    else if (v78)
    {
      v79 = @"s";
      *buf = 134218498;
      v118 = v77;
      v119 = 2114;
      if (v77 == &dword_0 + 1)
      {
        v79 = &stru_4BD3F0;
      }

      v120 = v79;
      v121 = 2114;
      v122 = v5;
      v80 = "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} %ld pre-installed auto-asset%{public}@ successfully relocated | path:%{public}@";
      v81 = v11;
      v82 = 32;
      goto LABEL_81;
    }

    v8 = 0;
    goto LABEL_83;
  }

  v10 = _MADLog(@"AutoControl");
  v11 = v10;
  if (v8)
  {
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      checkedDescription2 = [v8 checkedDescription];
      *buf = 138543618;
      v118 = v5;
      v119 = 2114;
      v120 = checkedDescription2;
      _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} Failed to read directories at path to pre-installed assets | path:%{public}@ | error:%{public}@", buf, 0x16u);
    }
  }

  else if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 138543362;
    v118 = v5;
    _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledRelocateAutoAssets} No directories found at path to pre-installed assets | path:%{public}@", buf, 0xCu);
  }

  v98 = 0;
LABEL_83:

  return v98;
}

- (void)_preInstalledMigrateAssets
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v4 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v4, OS_LOG_TYPE_DEFAULT))
  {
    *buf = 0;
    _os_log_impl(&dword_0, v4, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} Starting pre-installed asset migration...", buf, 2u);
  }

  p_weak_ivar_lyt = &MAAIRBMobileAssetOperationMetadata__metaData.weak_ivar_lyt;
  v6 = +[NSFileManager defaultManager];
  v7 = [v6 fileExistsAtPath:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist"];

  if (v7)
  {
    _preInstalledRelocateAutoAssets = _MADLog(@"AutoControl");
    if (os_log_type_enabled(_preInstalledRelocateAutoAssets, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, _preInstalledRelocateAutoAssets, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} Already migrated assets, no need to run again", buf, 2u);
    }
  }

  else
  {
    _preInstalledRelocateAutoAssets = [(MADAutoAssetControlManager *)self _preInstalledRelocateAutoAssets];
    v9 = [_preInstalledRelocateAutoAssets objectForKeyedSubscript:@"Success"];
    v10 = [_preInstalledRelocateAutoAssets objectForKeyedSubscript:@"Failure"];
    v47 = objc_opt_new();
    if (v9 && [v9 count])
    {
      [(MADAutoAssetControlManager *)self setMigratedFromPreinstalled:1];
      v54 = 0u;
      v55 = 0u;
      v52 = 0u;
      v53 = 0u;
      v11 = v9;
      v12 = [v11 countByEnumeratingWithState:&v52 objects:v58 count:16];
      if (v12)
      {
        v13 = v12;
        v42 = _preInstalledRelocateAutoAssets;
        obj = v11;
        v38 = v10;
        v40 = v9;
        v14 = *v53;
        do
        {
          for (i = 0; i != v13; i = i + 1)
          {
            if (*v53 != v14)
            {
              objc_enumerationMutation(obj);
            }

            v16 = *(*(&v52 + 1) + 8 * i);
            v17 = objc_autoreleasePoolPush();
            assetType = [v16 assetType];
            assetSpecifier = [v16 assetSpecifier];
            assetVersion = [v16 assetVersion];
            v21 = [NSString stringWithFormat:@"%@|%@|%@", assetType, assetSpecifier, assetVersion];

            [(MADAutoAssetControlManager *)self _preInstalledMakeDescriptorAvailable:v16 fromLocation:@"_preInstalledMigrateAssets"];
            [v47 setSafeObject:@"Success" forKey:v21];

            objc_autoreleasePoolPop(v17);
          }

          v13 = [obj countByEnumeratingWithState:&v52 objects:v58 count:16];
        }

        while (v13);
        v9 = v40;
        _preInstalledRelocateAutoAssets = v42;
        v10 = v38;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v11 = obj;
      }
    }

    else
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} no descriptors found to migrate", buf, 2u);
      }
    }

    if (v10 && [v10 count])
    {
      v50 = 0u;
      v51 = 0u;
      v48 = 0u;
      v49 = 0u;
      v22 = v10;
      v23 = [v22 countByEnumeratingWithState:&v48 objects:v57 count:16];
      if (v23)
      {
        v24 = v23;
        v43 = _preInstalledRelocateAutoAssets;
        obja = v22;
        v39 = v10;
        v41 = v9;
        v25 = *v49;
        do
        {
          for (j = 0; j != v24; j = j + 1)
          {
            if (*v49 != v25)
            {
              objc_enumerationMutation(obja);
            }

            v27 = *(*(&v48 + 1) + 8 * j);
            v28 = objc_autoreleasePoolPush();
            assetType2 = [v27 assetType];
            assetSpecifier2 = [v27 assetSpecifier];
            assetVersion2 = [v27 assetVersion];
            v32 = [NSString stringWithFormat:@"%@|%@|%@", assetType2, assetSpecifier2, assetVersion2];

            [v47 setSafeObject:@"Failure" forKey:v32];
            objc_autoreleasePoolPop(v28);
          }

          v24 = [obja countByEnumeratingWithState:&v48 objects:v57 count:16];
        }

        while (v24);
        v9 = v41;
        _preInstalledRelocateAutoAssets = v43;
        v10 = v39;
        p_weak_ivar_lyt = (&MAAIRBMobileAssetOperationMetadata__metaData + 56);
        v22 = obja;
      }
    }

    else
    {
      v22 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 0;
        _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} no descriptors failed migration", buf, 2u);
      }
    }

    v33 = _MADLog(@"AutoControl");
    if (os_log_type_enabled(v33, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v33, OS_LOG_TYPE_DEFAULT, "[AUTO-PRE-INSTALLED] {_preInstalledMigrateAssets} ...Finishing pre-installed asset migration", buf, 2u);
    }

    [v47 writeToFile:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist" atomically:1];
    defaultManager = [p_weak_ivar_lyt[278] defaultManager];
    v35 = [defaultManager fileExistsAtPath:@"/private/var/MobileSoftwareUpdate/.MAAMigrated.plist"];

    if ((v35 & 1) == 0)
    {
      autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
      diag = [autoControlManagerFSM2 diag];
      [diag trackAnomaly:@"[AUTO-PRE-INSTALLED]" forReason:@"Failed to write cookie file" withResult:*__error() withError:0];
    }
  }
}

- (void)_preinstalledTrackBySelector:(id)selector
{
  selectorCopy = selector;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  if (![selectorCopy foundAsPreInstalled])
  {
    autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
    diag = [autoControlManagerFSM2 diag];
    v26 = [NSString alloc];
    summary = [selectorCopy summary];
    v28 = [v26 initWithFormat:@"{_preinstalledTrackBySelector} not a pre-installed asset-descriptor | downloadedDescriptor:%@", summary];
    [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v28 withResult:6103 withError:0];

LABEL_18:
    goto LABEL_19;
  }

  v7 = [(MADAutoAssetControlManager *)self setConfigurationForDescriptorIfManagedAsSet:selectorCopy];
  autoControlManagerFSM2 = v7;
  if (!v7 || ([v7 everProvidedLatestToVend] & 1) == 0)
  {
    diag = [selectorCopy typeAndSpecifierKey];
    preinstalledAssetDescriptorsBySelector = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
    v11 = [preinstalledAssetDescriptorsBySelector safeObjectForKey:diag ofClass:objc_opt_class()];

    if (v11)
    {
      assetVersion = [selectorCopy assetVersion];
      assetVersion2 = [v11 assetVersion];
      v14 = [SUCore stringIsEqual:assetVersion to:assetVersion2];

      if ((v14 & 1) == 0)
      {
        v15 = [SUCoreRestoreVersion alloc];
        assetVersion3 = [selectorCopy assetVersion];
        v17 = [v15 initWithRestoreVersion:assetVersion3];

        v18 = [SUCoreRestoreVersion alloc];
        assetVersion4 = [v11 assetVersion];
        v20 = [v18 initWithRestoreVersion:assetVersion4];

        if ([v17 isComparable:v20])
        {
          v21 = [v17 compare:v20];
          v22 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(v22, OS_LOG_TYPE_DEFAULT))
          {
            summary2 = [selectorCopy summary];
            [v11 summary];
            v24 = v32 = v21;
            *buf = 138543618;
            v34 = summary2;
            v35 = 2114;
            v36 = v24;
            _os_log_impl(&dword_0, v22, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {_preinstalledTrackBySelector} [PRE-INSTALLED] multiple for same specifier | left(downloadedDescriptor):%{public}@ | right(preinstalledDescriptor):%{public}@", buf, 0x16u);

            v21 = v32;
          }

          if (v21 != &dword_0 + 1)
          {
            goto LABEL_16;
          }

          preinstalledAssetDescriptorsBySelector2 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
          [preinstalledAssetDescriptorsBySelector2 setSafeObject:selectorCopy forKey:diag];
        }

        else
        {
          preinstalledAssetDescriptorsBySelector2 = _MADLog(@"AutoControl");
          if (os_log_type_enabled(preinstalledAssetDescriptorsBySelector2, OS_LOG_TYPE_ERROR))
          {
            summary3 = [selectorCopy summary];
            summary4 = [v11 summary];
            *buf = 138543618;
            v34 = summary3;
            v35 = 2114;
            v36 = summary4;
            _os_log_impl(&dword_0, preinstalledAssetDescriptorsBySelector2, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-PERSONALIZATION][STARTUP] {_preinstalledTrackBySelector} [PRE-INSTALLED] asset-versions not comparable | left(downloadedDescriptor):%{public}@ | right(preinstalledDescriptor):%{public}@", buf, 0x16u);
          }
        }

LABEL_16:
      }
    }

    else
    {
      preinstalledAssetDescriptorsBySelector3 = [(MADAutoAssetControlManager *)self preinstalledAssetDescriptorsBySelector];
      [preinstalledAssetDescriptorsBySelector3 setSafeObject:selectorCopy forKey:diag];
    }

    goto LABEL_18;
  }

LABEL_19:
}

- (void)secureCheckUngraft:(id)ungraft forDescriptorNoLongerLocked:(id)locked
{
  ungraftCopy = ungraft;
  lockedCopy = locked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureCheckUngraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:ungraftCopy forDescriptor:lockedCopy]&& [MADAutoAssetSecure isSecureAsset:ungraftCopy forDescriptor:lockedCopy])
  {
    if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:ungraftCopy forDescriptor:lockedCopy])
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 138543362;
        v21 = ungraftCopy;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n{%{public}@:secureCheckUngraft} [AUTO-SECURE] NOT ungrafting (currently locked)", buf, 0xCu);
      }
    }

    else
    {
      v12 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
      {
        summary = [lockedCopy summary];
        *buf = 138543618;
        v21 = ungraftCopy;
        v22 = 2114;
        v23 = summary;
        _os_log_impl(&dword_0, v12, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungrafting|unmounting (NOT currently locked) | downloadedDescriptor:%{public}@", buf, 0x16u);
      }

      [lockedCopy setSecureOperationInProgress:1];
      v18 = 0;
      [MADAutoAssetSecure ungraft:ungraftCopy forDescriptor:lockedCopy ungraftingError:&v18];
      v11 = v18;
      [lockedCopy setSecureOperationInProgress:0];
      if (v11)
      {
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
        {
          checkedDescription = [v11 checkedDescription];
          summary2 = [lockedCopy summary];
          *buf = 138543874;
          v21 = ungraftCopy;
          v22 = 2114;
          v23 = checkedDescription;
          v24 = 2114;
          v25 = summary2;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungraft|unmount ERROR | error:%{public}@ | downloadedDescriptor:%{public}@", buf, 0x20u);
        }
      }

      else
      {
        v14 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v14, OS_LOG_TYPE_DEFAULT))
        {
          summary3 = [lockedCopy summary];
          *buf = 138543618;
          v21 = ungraftCopy;
          v22 = 2114;
          v23 = summary3;
          _os_log_impl(&dword_0, v14, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureCheckUngraft} | ungraft|unmount SUCCESS | downloadedDescriptor:%{public}@", buf, 0x16u);
        }
      }
    }
  }

  os_activity_scope_leave(&state);
}

- (void)secureForceUngraft:(id)ungraft forDescriptorBeingRemoved:(id)removed
{
  ungraftCopy = ungraft;
  removedCopy = removed;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v10 = _os_activity_create(&dword_0, "MADAutoControl:secureForceUngraft", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v10, &state);

  if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:ungraftCopy forDescriptor:removedCopy]&& [MADAutoAssetSecure isSecureAsset:ungraftCopy forDescriptor:removedCopy])
  {
    if ([(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:ungraftCopy forDescriptor:removedCopy])
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        summary = [removedCopy summary];
        *buf = 138543618;
        v22 = ungraftCopy;
        v23 = 2114;
        v24 = summary;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | forcing ungraft of asset-descriptor that is currently locked | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }

    else
    {
      v11 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
      {
        summary2 = [removedCopy summary];
        *buf = 138543618;
        v22 = ungraftCopy;
        v23 = 2114;
        v24 = summary2;
        _os_log_impl(&dword_0, v11, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungrafting|unmounting (NOT currently locked) | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }

    [removedCopy setSecureOperationInProgress:1];
    v19 = 0;
    [MADAutoAssetSecure ungraft:ungraftCopy forDescriptor:removedCopy ungraftingError:&v19];
    v14 = v19;
    [removedCopy setSecureOperationInProgress:0];
    if (v14)
    {
      v15 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        checkedDescription = [v14 checkedDescription];
        summary3 = [removedCopy summary];
        *buf = 138543874;
        v22 = ungraftCopy;
        v23 = 2114;
        v24 = checkedDescription;
        v25 = 2114;
        v26 = summary3;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungraft|unmount ERROR | error:%{public}@ | downloadedDescriptor:%{public}@", buf, 0x20u);
      }
    }

    else
    {
      v15 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v15, OS_LOG_TYPE_DEFAULT))
      {
        summary4 = [removedCopy summary];
        *buf = 138543618;
        v22 = ungraftCopy;
        v23 = 2114;
        v24 = summary4;
        _os_log_impl(&dword_0, v15, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE][SINGLETON-CONTROL] {%{public}@:secureForceUngraft} | ungraft|unmount SUCCESS | downloadedDescriptor:%{public}@", buf, 0x16u);
      }
    }
  }

  os_activity_scope_leave(&state);
}

- (void)secureCheckUngraftAll:(id)all forSetDescriptorNoLongerLocked:(id)locked
{
  allCopy = all;
  lockedCopy = locked;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v9 = _os_activity_create(&dword_0, "MADAutoControl:secureCheckUngraftAll", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v9, &state);

  allCopy = [[NSString alloc] initWithFormat:@"%@:secureCheckUngraftAll", allCopy];
  [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:lockedCopy];
  v33 = 0u;
  v34 = 0u;
  v31 = 0u;
  obj = v32 = 0u;
  v10 = [obj countByEnumeratingWithState:&v31 objects:v42 count:16];
  if (v10)
  {
    v11 = 0;
    v12 = *v32;
    v13 = 1;
    do
    {
      for (i = 0; i != v10; i = i + 1)
      {
        if (*v32 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v15 = *(*(&v31 + 1) + 8 * i);
        v16 = objc_autoreleasePoolPush();
        if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:allCopy forDescriptor:v15])
        {
          v11 |= [MADAutoAssetSecure isSecureAsset:allCopy forDescriptor:v15];
        }

        v17 = [(MADAutoAssetControlManager *)self isDescriptorCurrentlyLocked:allCopy forDescriptor:v15];
        objc_autoreleasePoolPop(v16);
        v13 &= v17 ^ 1;
      }

      v10 = [obj countByEnumeratingWithState:&v31 objects:v42 count:16];
    }

    while (v10);

    if (v11 & v13)
    {
      v18 = _MADLog(@"AutoControl");
      if (os_log_type_enabled(v18, OS_LOG_TYPE_DEFAULT))
      {
        summary = [lockedCopy summary];
        *buf = 138543618;
        v37 = allCopy;
        v38 = 2114;
        v39 = summary;
        _os_log_impl(&dword_0, v18, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungrafting ALL | containsSecureAssets:Y | allAssetsOfSetUnlocked:Y | setDescriptor:%{public}@", buf, 0x16u);
      }

      v30 = 0;
      [MADAutoAssetSecure ungraftAll:allCopy forSetDescriptor:lockedCopy withAutoAssetDescriptors:obj ungraftingError:&v30];
      v20 = v30;
      if (v20)
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          checkedDescription = [v20 checkedDescription];
          summary2 = [lockedCopy summary];
          *buf = 138543874;
          v37 = allCopy;
          v38 = 2114;
          v39 = checkedDescription;
          v40 = 2114;
          v41 = summary2;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_ERROR, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungraft|unmount ERROR | error:%{public}@ | setDescriptor:%{public}@", buf, 0x20u);
        }
      }

      else
      {
        v21 = _MADLog(@"AutoControl");
        if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
        {
          summary3 = [lockedCopy summary];
          *buf = 138543618;
          v37 = allCopy;
          v38 = 2114;
          v39 = summary3;
          _os_log_impl(&dword_0, v21, OS_LOG_TYPE_DEFAULT, "\n[SECURE][AUTO-GRAFT-REMOVE-ALL][SET-CONTROL] {%{public}@:secureCheckUngraftAll} | ungraft|unmount SUCCESS | setDescriptor:%{public}@", buf, 0x16u);
        }
      }

      goto LABEL_27;
    }
  }

  else
  {

    LOBYTE(v11) = 0;
    v13 = 1;
  }

  v20 = _MADLog(@"AutoControl");
  if (os_log_type_enabled(v20, OS_LOG_TYPE_DEFAULT))
  {
    v24 = @"N";
    if (v11)
    {
      v25 = @"Y";
    }

    else
    {
      v25 = @"N";
    }

    *buf = 138543874;
    v37 = allCopy;
    v38 = 2114;
    v39 = v25;
    if (v13)
    {
      v24 = @"Y";
    }

    v40 = 2114;
    v41 = v24;
    _os_log_impl(&dword_0, v20, OS_LOG_TYPE_DEFAULT, "\n{%{public}@:secureCheckUngraftAll} [AUTO-SECURE] NOT ungrafting | containsSecureAssets:%{public}@ | allAssetsOfSetUnlocked:%{public}@", buf, 0x20u);
  }

LABEL_27:

  os_activity_scope_leave(&state);
}

- (void)secureClearInsecureLatestAtomicInstances
{
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  state.opaque[0] = 0;
  state.opaque[1] = 0;
  v4 = _os_activity_create(&dword_0, "MADAutoControl:secureClearInsecureLatestAtomicInstances", &_os_activity_current, OS_ACTIVITY_FLAG_DEFAULT);
  os_activity_scope_enter(v4, &state);

  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"secureClearInsecureLatestAtomicInstances" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v101 = 0u;
  v102 = 0u;
  v99 = 0u;
  v100 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  obj = [allKeys copy];

  v7 = [obj countByEnumeratingWithState:&v99 objects:v111 count:16];
  if (v7)
  {
    v70 = *v100;
    do
    {
      v8 = 0;
      v69 = v7;
      do
      {
        if (*v100 != v70)
        {
          objc_enumerationMutation(obj);
        }

        v72 = v8;
        v9 = *(*(&v99 + 1) + 8 * v8);
        v71 = objc_autoreleasePoolPush();
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v75 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v9 ofClass:objc_opt_class()];

        if (v75)
        {
          latestAtomicInstanceToVend = [v75 latestAtomicInstanceToVend];
          v73 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"secureClearInsecureLatestAtomicInstances" forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:0];

          if (v73)
          {
            v97 = 0u;
            v98 = 0u;
            v95 = 0u;
            v96 = 0u;
            v12 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:?];
            v13 = [v12 countByEnumeratingWithState:&v95 objects:v106 count:16];
            if (v13)
            {
              v83 = 0;
              v84 = 0;
              v14 = *v96;
LABEL_10:
              v15 = 0;
              while (1)
              {
                if (*v96 != v14)
                {
                  objc_enumerationMutation(v12);
                }

                v16 = *(*(&v95 + 1) + 8 * v15);
                v17 = objc_autoreleasePoolPush();
                if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                {
                  v18 = [MAAutoAssetSelector alloc];
                  assetType = [v16 assetType];
                  assetSpecifier = [v16 assetSpecifier];
                  assetVersion = [v16 assetVersion];
                  v22 = [v18 initForAssetType:assetType withAssetSpecifier:assetSpecifier matchingAssetVersion:assetVersion];

                  if ([MADAutoAssetSecure isGraftedOrMounted:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                  {
                    v23 = 1;
                  }

                  else
                  {
                    if ([MADAutoAssetSecure isPersonalizationRequired:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v16])
                    {
                      v24 = _MADLog(@"AutoControl");
                      if (os_log_type_enabled(v24, OS_LOG_TYPE_ERROR))
                      {
                        summary = [v22 summary];
                        *buf = 138543618;
                        v108 = @"secureClearInsecureLatestAtomicInstances";
                        v109 = 2114;
                        v110 = summary;
                        _os_log_impl(&dword_0, v24, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalization required after startup secure-healing | downloadedSelector:%{public}@", buf, 0x16u);
                      }

                      v23 = 0;
                      v84 = 1;
                    }

                    else
                    {
                      locksPriorToSecureHealing = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
                      persistedEntryID = [v22 persistedEntryID];
                      v24 = [locksPriorToSecureHealing safeObjectForKey:persistedEntryID ofClass:objc_opt_class()];

                      if (v24 && [v24 longValue]> 0)
                      {
                        v28 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
                        {
                          summary2 = [v22 summary];
                          *buf = 138543618;
                          v108 = @"secureClearInsecureLatestAtomicInstances";
                          v109 = 2114;
                          v110 = summary2;
                          _os_log_impl(&dword_0, v28, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to re-graft during startup secure-healing | downloadedSelector:%{public}@", buf, 0x16u);
                        }

                        v23 = 0;
                        v83 = 1;
                      }

                      else
                      {
                        v30 = _MADLog(@"AutoControl");
                        if (os_log_type_enabled(v30, OS_LOG_TYPE_DEFAULT))
                        {
                          summary3 = [v22 summary];
                          *buf = 138543618;
                          v108 = @"secureClearInsecureLatestAtomicInstances";
                          v109 = 2114;
                          v110 = summary3;
                          _os_log_impl(&dword_0, v30, OS_LOG_TYPE_DEFAULT, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | latest-to-vend includes personalized-not-grafted|mounted (acceptable since not currently locked) | downloadedSelector:%{public}@", buf, 0x16u);
                        }

                        v23 = 1;
                      }
                    }
                  }
                }

                else
                {
                  v23 = 1;
                }

                objc_autoreleasePoolPop(v17);
                if (!v23)
                {
                  break;
                }

                if (v13 == ++v15)
                {
                  v13 = [v12 countByEnumeratingWithState:&v95 objects:v106 count:16];
                  if (v13)
                  {
                    goto LABEL_10;
                  }

                  break;
                }
              }
            }

            else
            {
              v83 = 0;
              v84 = 0;
            }

            if ((v84 | v83))
            {
              latestAtomicInstanceToVend2 = [v75 latestAtomicInstanceToVend];
              v34 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:latestAtomicInstanceToVend2];

              v35 = _MADLog(@"AutoControl");
              if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
              {
                summary4 = [v75 summary];
                *buf = 138543618;
                v108 = @"secureClearInsecureLatestAtomicInstances";
                v109 = 2114;
                v110 = summary4;
                _os_log_impl(&dword_0, v35, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} unable to self-heal, clearing latest-to-vend | setConfiguration:%{public}@", buf, 0x16u);
              }

              [(MADAutoAssetControlManager *)self setConfigurationForceUnlocked:@"secureClearInsecureLatestAtomicInstances" forSetConfiguration:v75];
              if (v34)
              {
                [(MADAutoAssetControlManager *)self _clearAtomicInstanceFromSetConfiguration:v75 forSetDesriptor:v73 forSetAtomicInstance:v34 fromLocation:@"secureClearInsecureLatestAtomicInstances"];
                autoControlManagerFSM2 = v73;
                v73 = 0;
              }

              else
              {
                autoControlManagerFSM2 = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
                diag = [autoControlManagerFSM2 diag];
                v39 = [NSString alloc];
                summary5 = [v75 summary];
                v41 = [v39 initWithFormat:@"{%@} no set-atomic-instance for set-configuration latest-to-vend | setConfiguration:%@", @"secureClearInsecureLatestAtomicInstances", summary5];
                [diag trackAnomaly:@"AUTO-SET-CONTROL" forReason:v41 withResult:6111 withError:0];
              }

              v74 = 1;
            }

            else
            {
              v74 = 0;
            }
          }

          else
          {
            v74 = 0;
            v73 = 0;
          }

          v93 = 0u;
          v94 = 0u;
          v91 = 0u;
          v92 = 0u;
          previouslyVendedLockedAtomicInstances = [v75 previouslyVendedLockedAtomicInstances];
          v76 = [previouslyVendedLockedAtomicInstances copy];

          v78 = [v76 countByEnumeratingWithState:&v91 objects:v105 count:16];
          if (v78)
          {
            v77 = *v92;
            do
            {
              for (i = 0; i != v78; i = i + 1)
              {
                if (*v92 != v77)
                {
                  objc_enumerationMutation(v76);
                }

                v81 = *(*(&v91 + 1) + 8 * i);
                context = objc_autoreleasePoolPush();
                v43 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"secureClearInsecureLatestAtomicInstances" forAtomicInstanceUUID:v81 requireExists:0];
                v79 = v43;
                if (v43)
                {
                  v89 = 0u;
                  v90 = 0u;
                  v87 = 0u;
                  v88 = 0u;
                  v44 = [(MADAutoAssetControlManager *)self autoAssetDescriptorsForSet:v43];
                  v45 = [v44 countByEnumeratingWithState:&v87 objects:v104 count:16];
                  if (v45)
                  {
                    v82 = 0;
                    v46 = *v88;
LABEL_55:
                    v47 = 0;
                    while (1)
                    {
                      if (*v88 != v46)
                      {
                        objc_enumerationMutation(v44);
                      }

                      v48 = *(*(&v87 + 1) + 8 * v47);
                      v49 = objc_autoreleasePoolPush();
                      v50 = [MAAutoAssetSelector alloc];
                      assetType2 = [v48 assetType];
                      assetSpecifier2 = [v48 assetSpecifier];
                      assetVersion2 = [v48 assetVersion];
                      v54 = [v50 initForAssetType:assetType2 withAssetSpecifier:assetSpecifier2 matchingAssetVersion:assetVersion2];

                      if ([MADAutoAssetSecure doesDescriptorInvolvePersonalization:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48]&& ![MADAutoAssetSecure isGraftedOrMounted:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48])
                      {
                        if ([MADAutoAssetSecure isPersonalizationRequired:@"secureClearInsecureLatestAtomicInstances" forDescriptor:v48])
                        {
                          v56 = _MADLog(@"AutoControl");
                          if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
                          {
                            summary6 = [v54 summary];
                            *buf = 138543618;
                            v108 = @"secureClearInsecureLatestAtomicInstances";
                            v109 = 2114;
                            v110 = summary6;
                            _os_log_impl(&dword_0, v56, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalization required after startup secure-healing (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                          }

                          HIDWORD(v82) = 1;
                        }

                        else
                        {
                          locksPriorToSecureHealing2 = [(MADAutoAssetControlManager *)self locksPriorToSecureHealing];
                          persistedEntryID2 = [v54 persistedEntryID];
                          v56 = [locksPriorToSecureHealing2 safeObjectForKey:persistedEntryID2 ofClass:objc_opt_class()];

                          if (v56 && [v56 longValue]> 0)
                          {
                            v60 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
                            {
                              summary7 = [v54 summary];
                              *buf = 138543618;
                              v108 = @"secureClearInsecureLatestAtomicInstances";
                              v109 = 2114;
                              v110 = summary7;
                              _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to re-graft during startup secure-healing (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                            }
                          }

                          else
                          {
                            v60 = _MADLog(@"AutoControl");
                            if (os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
                            {
                              summary8 = [v54 summary];
                              *buf = 138543618;
                              v108 = @"secureClearInsecureLatestAtomicInstances";
                              v109 = 2114;
                              v110 = summary8;
                              _os_log_impl(&dword_0, v60, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | personalized-not-grafted|mounted (previously vended locked) | downloadedSelector:%{public}@", buf, 0x16u);
                            }
                          }

                          LODWORD(v82) = 1;
                        }

                        v55 = 0;
                      }

                      else
                      {
                        v55 = 1;
                      }

                      objc_autoreleasePoolPop(v49);
                      if (!v55)
                      {
                        break;
                      }

                      if (v45 == ++v47)
                      {
                        v45 = [v44 countByEnumeratingWithState:&v87 objects:v104 count:16];
                        if (v45)
                        {
                          goto LABEL_55;
                        }

                        break;
                      }
                    }
                  }

                  else
                  {
                    v82 = 0;
                  }

                  if ((HIDWORD(v82) | v82))
                  {
                    v63 = [(MADAutoAssetControlManager *)self locateSetAtomicInstanceByInstanceUUID:v81];
                    v64 = _MADLog(@"AutoControl");
                    if (os_log_type_enabled(v64, OS_LOG_TYPE_ERROR))
                    {
                      summary9 = [v75 summary];
                      *buf = 138543618;
                      v108 = @"secureClearInsecureLatestAtomicInstances";
                      v109 = 2114;
                      v110 = summary9;
                      _os_log_impl(&dword_0, v64, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} unable to self-heal, clearing previously vended locked | setConfiguration:%{public}@", buf, 0x16u);
                    }

                    if (![(MADAutoAssetControlManager *)self setConfigurationForgetIfTrackedAsPreviouslyVended:@"secureClearInsecureLatestAtomicInstances" forSetConfiguration:v75 removingAtomicInstance:v81])
                    {
                      [(MADAutoAssetControlManager *)self atomicInstanceForceUnlock:@"secureClearInsecureLatestAtomicInstances" dueToError:0 forgettingAtomicInstance:v63];
                    }

                    [(MADAutoAssetControlManager *)self atomicInstanceUpdateUsageStatus:@"secureClearInsecureLatestAtomicInstances" toNewStatus:@"FORGOTTEN" forAtomicInstance:v63];

                    v74 = 1;
                  }
                }

                objc_autoreleasePoolPop(context);
              }

              v78 = [v76 countByEnumeratingWithState:&v91 objects:v105 count:16];
            }

            while (v78);
          }

          if (v74)
          {
            v66 = _MADLog(@"AutoControl");
            if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR))
            {
              summary10 = [v75 summary];
              *buf = 138543618;
              v108 = @"secureClearInsecureLatestAtomicInstances";
              v109 = 2114;
              v110 = summary10;
              _os_log_impl(&dword_0, v66, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} altered set-configuration previouslyVendedLockedAtomicInstance | setConfiguration:%{public}@", buf, 0x16u);
            }

            [(MADAutoAssetControlManager *)self setConfigurationPersist:v75 fromLocation:@"secureClearInsecureLatestAtomicInstances" forReason:@"altered previouslyVendedLocked (not accessible on startup)" dueToAlter:0 forHistoryOperation:9999];
          }
        }

        else
        {
          v32 = _MADLog(@"AutoControl");
          v73 = v32;
          if (os_log_type_enabled(v32, OS_LOG_TYPE_ERROR))
          {
            *buf = 138543618;
            v108 = @"secureClearInsecureLatestAtomicInstances";
            v109 = 2114;
            v110 = v9;
            _os_log_impl(&dword_0, v32, OS_LOG_TYPE_ERROR, "\n[AUTO-SECURE][AUTO-VALIDATE][SET-CONTROL][STARTUP] {%{public}@} | unable to load set-configuration | setConfigurationKey:%{public}@", buf, 0x16u);
          }
        }

        objc_autoreleasePoolPop(v71);
        v8 = v72 + 1;
      }

      while ((v72 + 1) != v69);
      v7 = [obj countByEnumeratingWithState:&v99 objects:v111 count:16];
    }

    while (v7);
  }

  os_activity_scope_leave(&state);
}

+ (id)buildDirectivesSummary
{
  v2 = [[NSMutableString alloc] initWithString:&stru_4BD3F0];
  [v2 appendString:@"|BUILDING_DAEMON"];
  [v2 appendString:@"|TARGET_OS_MAC"];
  [v2 appendString:@"|TARGET_OS_IPHONE"];
  [v2 appendString:@"|MA_SUPPORTS_SPACE_ATTRIBUTION"];
  if ([SUCore stringIsEqual:v2 to:&stru_4BD3F0])
  {
    v3 = [[NSMutableString alloc] initWithString:@"(NO_TARGETS_DEFINED)"];

    v2 = v3;
  }

  else
  {
    [v2 appendString:@"|"];
  }

  return v2;
}

+ (id)getHealthReportForSets:(id)sets
{
  setsCopy = sets;
  v16 = 0;
  v17 = &v16;
  v18 = 0x3032000000;
  v19 = __Block_byref_object_copy__12;
  v20 = __Block_byref_object_dispose__12;
  v21 = 0;
  v4 = +[MADAutoAssetControlManager autoControlManager];
  autoControlManagerFSM = [v4 autoControlManagerFSM];

  if (autoControlManagerFSM)
  {
    autoControlManagerFSM2 = [v4 autoControlManagerFSM];
    extendedStateQueue = [autoControlManagerFSM2 extendedStateQueue];
    block[0] = _NSConcreteStackBlock;
    block[1] = 3221225472;
    block[2] = __53__MADAutoAssetControlManager_getHealthReportForSets___block_invoke;
    block[3] = &unk_4B2E80;
    v14 = &v16;
    v12 = v4;
    v13 = setsCopy;
    dispatch_sync(extendedStateQueue, block);

    v8 = v17[5];
  }

  else
  {
    v9 = _MADLog(@"Auto");
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 0;
      _os_log_impl(&dword_0, v9, OS_LOG_TYPE_DEFAULT, "AUTO-CONTROL:{getHealthReportForSets} Skipping operation since FSM is not initialized", buf, 2u);
    }

    v8 = v17[5];
  }

  _Block_object_dispose(&v16, 8);

  return v8;
}

uint64_t __53__MADAutoAssetControlManager_getHealthReportForSets___block_invoke(uint64_t a1)
{
  *(*(*(a1 + 48) + 8) + 40) = [*(a1 + 32) _getHealthReportForSets:*(a1 + 40)];

  return _objc_release_x1();
}

- (id)_getHealthReportForSets:(id)sets
{
  setsCopy = sets;
  autoControlManagerFSM = [(MADAutoAssetControlManager *)self autoControlManagerFSM];
  extendedStateQueue = [autoControlManagerFSM extendedStateQueue];
  dispatch_assert_queue_V2(extendedStateQueue);

  v31 = +[NSMutableArray array];
  [(MADAutoAssetControlManager *)self trackPerformanceIteration:@"_getHealthReportForSets" ofContainer:@"knownSetConfigurationsByIdentifier"];
  v36 = 0u;
  v37 = 0u;
  v34 = 0u;
  v35 = 0u;
  knownSetConfigurationsByIdentifier = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
  allKeys = [knownSetConfigurationsByIdentifier allKeys];
  v9 = [allKeys copy];

  obj = v9;
  v10 = [v9 countByEnumeratingWithState:&v34 objects:v38 count:16];
  if (v10)
  {
    v11 = v10;
    v12 = *v35;
    selfCopy = self;
    do
    {
      v13 = 0;
      v32 = v11;
      do
      {
        if (*v35 != v12)
        {
          objc_enumerationMutation(obj);
        }

        v14 = *(*(&v34 + 1) + 8 * v13);
        knownSetConfigurationsByIdentifier2 = [(MADAutoAssetControlManager *)self knownSetConfigurationsByIdentifier];
        v16 = [knownSetConfigurationsByIdentifier2 safeObjectForKey:v14 ofClass:objc_opt_class()];

        assetSetIdentifier = [v16 assetSetIdentifier];
        if (v16 && (!setsCopy || [setsCopy containsObject:assetSetIdentifier]))
        {
          v18 = setsCopy;
          latestAtomicInstanceToVend = [v16 latestAtomicInstanceToVend];
          if (latestAtomicInstanceToVend)
          {
            v20 = [(MADAutoAssetControlManager *)self locateSetDescriptor:@"MAHealthReport" forAtomicInstanceUUID:latestAtomicInstanceToVend requireExists:1];
            if (v20)
            {
              v21 = [(MADAutoAssetControlManager *)self isSetDescriptorCurrentlyLocked:@"MAHealthReport" forSetDescriptor:v20];
              latestToVendCachedAssetSetID = [v16 latestToVendCachedAssetSetID];
            }

            else
            {
              latestToVendCachedAssetSetID = 0;
              v21 = 0;
            }
          }

          else
          {
            latestToVendCachedAssetSetID = 0;
            v21 = 0;
          }

          v23 = objc_opt_new();
          [v23 setSetIdentifier:assetSetIdentifier];
          mostRecentlyReceivedCachedAssetSetID = [v16 mostRecentlyReceivedCachedAssetSetID];
          [v23 setLatestDiscoveredAssetSetUUID:mostRecentlyReceivedCachedAssetSetID];

          [v23 setLatestToVendAssetSetUUID:latestToVendCachedAssetSetID];
          mostRecentlyReceivedLastTimeChecked = [v16 mostRecentlyReceivedLastTimeChecked];
          [v23 setLastCheckedDate:mostRecentlyReceivedLastTimeChecked];

          [v23 setLastestToVendIsLocked:v21];
          [v23 setLastestToVendMatchesSetConfig:{objc_msgSend(v16, "vendingAtomicInstanceForConfiguredEntries")}];
          availableForUseError = [v16 availableForUseError];
          [v23 setAvailableForUseError:availableForUseError];

          newerVersionError = [v16 newerVersionError];
          [v23 setNewerVersionError:newerVersionError];

          [v23 setLatestInstanceFromPreSUStaging:{objc_msgSend(v16, "latestAtomicInstanceToVendFromPreSUStaging")}];
          configurationChangedDate = [v16 configurationChangedDate];
          [v23 setConfigurationChangedDate:configurationChangedDate];

          [v31 addObject:v23];
          setsCopy = v18;
          self = selfCopy;
          v11 = v32;
        }

        v13 = v13 + 1;
      }

      while (v11 != v13);
      v11 = [obj countByEnumeratingWithState:&v34 objects:v38 count:16];
    }

    while (v11);
  }

  return v31;
}

@end