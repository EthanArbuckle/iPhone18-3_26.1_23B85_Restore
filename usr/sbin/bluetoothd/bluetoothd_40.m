uint64_t sub_1002A7B14()
{
  if (off_100B60C70)
  {
    v0 = off_100B60C70();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7BA0()
{
  if (off_100B60C78)
  {
    v0 = off_100B60C78();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7C2C()
{
  if (off_100B60C80)
  {
    v0 = off_100B60C80();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7CB8()
{
  if (off_100B60C88)
  {
    v0 = off_100B60C88();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7D44()
{
  if (off_100B60C90)
  {
    v0 = off_100B60C90();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7DD0()
{
  if (off_100B60C98)
  {
    v0 = off_100B60C98();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7E5C()
{
  if (off_100B60CA0)
  {
    v0 = off_100B60CA0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7EE8()
{
  if (off_100B60CA8)
  {
    v0 = off_100B60CA8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A7F74()
{
  if (off_100B60CB0)
  {
    v0 = off_100B60CB0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8000()
{
  if (off_100B60C68)
  {
    v0 = off_100B60C68();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A808C(unsigned __int16 *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  if (!sub_1000ABD24(a1))
  {
    return 122;
  }

  if (off_100B60CD8)
  {
    v12 = off_100B60CD8(*a1, a2, a3, a4, a5, a6);
    if (!v12)
    {
      return v12;
    }
  }

  else
  {
    v12 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v13, v14, v15, v16, v17, v18, v19, v12);
    v20 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v12;
}

uint64_t sub_1002A8168()
{
  if (off_100B60658)
  {
    v0 = off_100B60658();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A81F4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  if (off_100B60D00)
  {
    v5 = off_100B60D00(a1, a2, a3, a4, a5);
    if (!v5)
    {
      return v5;
    }
  }

  else
  {
    v5 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v6, v7, v8, v9, v10, v11, v12, v5);
    v13 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v5;
}

uint64_t sub_1002A82D0()
{
  if (off_100B60CB8)
  {
    v0 = off_100B60CB8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A835C()
{
  if (off_100B60978)
  {
    v0 = off_100B60978();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A83E8()
{
  if (off_100B60AC8)
  {
    v0 = off_100B60AC8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8474()
{
  if (off_100B60BF0)
  {
    v0 = off_100B60BF0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8500()
{
  if (off_100B60C08)
  {
    v0 = off_100B60C08();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A858C()
{
  if (off_100B60C10)
  {
    v0 = off_100B60C10();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8618()
{
  if (off_100B60988)
  {
    v0 = off_100B60988();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A86A4()
{
  if (off_100B60C18)
  {
    v0 = off_100B60C18();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8730()
{
  if (off_100B60C20)
  {
    v0 = off_100B60C20();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A87BC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v3 = a3;
  if (*(a1 + 30) == a3)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Phy stats for handle %p is already %s", v5, v6, v7, v8, v9, v10, v11, a1);
      v12 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        sub_10080F6C8();
      }
    }

    return 408;
  }

  else
  {
    if (off_100B60AA0)
    {
      v13 = off_100B60AA0(a1, a2, a3);
      if (!v13)
      {
        *(a1 + 30) = v3 != 0;
        return v13;
      }
    }

    else
    {
      v13 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC PhyStatsEnable failed %!", v14, v15, v16, v17, v18, v19, v20, v13);
      v21 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v13;
}

uint64_t sub_1002A88DC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  v3 = a3;
  if (*(a1 + 31) == a3)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("State of Phy stats for handle %p is already %s", v5, v6, v7, v8, v9, v10, v11, a1);
      v12 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        sub_10080F6C8();
      }
    }

    return 408;
  }

  else
  {
    if (off_100B60AA0)
    {
      v13 = off_100B60AA0(a1, a2, a3);
      if (!v13)
      {
        *(a1 + 31) = v3;
        *(a1 + 30) = v3 != 0;
        return v13;
      }
    }

    else
    {
      v13 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC PhyStatsEnable failed %!", v14, v15, v16, v17, v18, v19, v20, v13);
      v21 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v13;
}

uint64_t sub_1002A8A14()
{
  if (off_100B60C50)
  {
    v0 = off_100B60C50();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8AA0()
{
  if (off_100B605C8)
  {
    v0 = off_100B605C8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8B2C()
{
  if (off_100B605D0)
  {
    v0 = off_100B605D0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8BB8()
{
  if (off_100B60BF8)
  {
    v0 = off_100B60BF8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8C44()
{
  if (off_100B60AA8)
  {
    v0 = off_100B60AA8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8CD0()
{
  if (off_100B60D20)
  {
    v0 = off_100B60D20();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8D5C()
{
  if (off_100B60AC0)
  {
    v0 = off_100B60AC0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8DE8()
{
  if (off_100B60AD0)
  {
    v0 = off_100B60AD0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8E74()
{
  if (off_100B60AD8)
  {
    v0 = off_100B60AD8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8F00()
{
  if (off_100B60AE0)
  {
    v0 = off_100B60AE0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A8F8C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (off_100B60AE8)
  {
    v4 = off_100B60AE8(a1, a2, a3, a4);
    if (!v4)
    {
      return v4;
    }
  }

  else
  {
    v4 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
    v12 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v4;
}

uint64_t sub_1002A9080()
{
  if (off_100B607F8)
  {
    v0 = off_100B607F8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A910C()
{
  if (off_100B60B10)
  {
    v0 = off_100B60B10();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A91DC()
{
  if (off_100B60B18)
  {
    v0 = off_100B60B18();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9268()
{
  if (off_100B60CC0)
  {
    v0 = off_100B60CC0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A92F4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (!sub_1000B8B5C(a1))
  {
    return 122;
  }

  if (off_100B60CC8)
  {
    v6 = off_100B60CC8(a1, a2, a3);
    if (!v6)
    {
      return v6;
    }
  }

  else
  {
    v6 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v7, v8, v9, v10, v11, v12, v13, "BT_VSC_EnableSetSpecialSniffTransition");
    v14 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v6;
}

uint64_t sub_1002A93B8()
{
  if (off_100B60CD0)
  {
    v0 = off_100B60CD0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9444()
{
  if (off_100B60CF0)
  {
    v0 = off_100B60CF0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A94D0()
{
  if (off_100B60CF8)
  {
    v0 = off_100B60CF8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A955C()
{
  if (off_100B60D28)
  {
    v0 = off_100B60D28();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A95E8(uint64_t a1, uint64_t a2)
{
  if (off_100B60C38)
  {
    v2 = off_100B60C38(a1, a2);
    if (!v2)
    {
      return v2;
    }
  }

  else
  {
    v2 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    v10 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v2;
}

uint64_t sub_1002A968C()
{
  if (off_100B60C40)
  {
    v0 = off_100B60C40();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9718()
{
  if (off_100B60F10)
  {
    v0 = off_100B60F10();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A97A4()
{
  if (off_100B60F18)
  {
    v0 = off_100B60F18();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9830()
{
  if (off_100B60F08)
  {
    v0 = off_100B60F08();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A98BC(unsigned int a1, __int16 a2, uint64_t a3, unsigned int a4)
{
  if ((dword_100B603C0 - 1) > 0x7CE || (v4 = 101, (a2 & 0x8000) == 0) && a1 <= 4 && a3 && a4 <= 0xE6)
  {
    if (off_100B60D30)
    {
      v4 = off_100B60D30();
      if (!v4)
      {
        return v4;
      }
    }

    else
    {
      v4 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
      v12 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v4;
}

uint64_t sub_1002A9978(uint64_t a1, int a2)
{
  if ((dword_100B603C0 - 1) <= 0x7CE && (!a1 || a2 != 250 && a2 != 210))
  {
    return 101;
  }

  if (off_100B60D38)
  {
    v2 = off_100B60D38();
    if (!v2)
    {
      return v2;
    }
  }

  else
  {
    v2 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
    v10 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v2;
}

uint64_t sub_1002A9A34(unsigned int a1, uint64_t a2, unsigned int a3)
{
  if ((dword_100B603C0 - 1) > 0x7CE || (v3 = 101, a1 <= 0x18) && a2 && a3 <= 0xCF)
  {
    if (off_100B60D40)
    {
      v3 = off_100B60D40();
      if (!v3)
      {
        return v3;
      }
    }

    else
    {
      v3 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC failed %!", v4, v5, v6, v7, v8, v9, v10, v3);
      v11 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v3;
}

uint64_t sub_1002A9AEC()
{
  if (off_100B60D50)
  {
    v0 = off_100B60D50();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9B78()
{
  if (off_100B60D80)
  {
    v0 = off_100B60D80();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9C04()
{
  if (off_100B60D58)
  {
    v0 = off_100B60D58();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9C90()
{
  if (off_100B60D88)
  {
    v0 = off_100B60D88();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9D1C()
{
  if (off_100B60D60)
  {
    v0 = off_100B60D60();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9DA8()
{
  if (off_100B60D68)
  {
    v0 = off_100B60D68();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9E34()
{
  if (off_100B60D70)
  {
    v0 = off_100B60D70();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9EC0()
{
  if (off_100B60D78)
  {
    v0 = off_100B60D78();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002A9F4C(uint64_t a1)
{
  if (!a1)
  {
    return 101;
  }

  if (off_100B60D48)
  {
    v1 = off_100B60D48();
    if (!v1)
    {
      return v1;
    }
  }

  else
  {
    v1 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    v9 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v1;
}

uint64_t sub_1002A9FE4()
{
  if (off_100B60D90)
  {
    v0 = off_100B60D90();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA070(uint64_t a1)
{
  if (!a1)
  {
    return 101;
  }

  if (off_100B60D98)
  {
    v1 = off_100B60D98();
    if (!v1)
    {
      return v1;
    }
  }

  else
  {
    v1 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    v9 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v1;
}

uint64_t sub_1002AA108(uint64_t a1)
{
  if (!a1)
  {
    return 101;
  }

  if (off_100B60DA0)
  {
    v1 = off_100B60DA0();
    if (!v1)
    {
      return v1;
    }
  }

  else
  {
    v1 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    v9 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v1;
}

uint64_t sub_1002AA1A0()
{
  if (off_100B60DA8)
  {
    v0 = off_100B60DA8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA22C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (!sub_1000ABD24(a3))
  {
    return 122;
  }

  if (off_100B60DF8)
  {
    v8 = off_100B60DF8(a1, a2, a3, a4);
    if (!v8)
    {
      return v8;
    }
  }

  else
  {
    v8 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v9, v10, v11, v12, v13, v14, v15, v8);
    v16 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v8;
}

uint64_t sub_1002AA2F4(uint64_t a1, uint64_t a2)
{
  if (!sub_1000ABD24(a1))
  {
    return 122;
  }

  if (off_100B60E00)
  {
    v4 = off_100B60E00(a1, a2);
    if (!v4)
    {
      return v4;
    }
  }

  else
  {
    v4 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v5, v6, v7, v8, v9, v10, v11, v4);
    v12 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v4;
}

uint64_t sub_1002AA3A0(uint64_t a1)
{
  if (!a1 || !*(a1 + 8) || !*(a1 + 40))
  {
    return 101;
  }

  if (off_100B60DF0)
  {
    v1 = off_100B60DF0();
    if (!v1)
    {
      return v1;
    }
  }

  else
  {
    v1 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s failed %!", v3, v4, v5, v6, v7, v8, v9, "BT_VSC_AddToFilterAcceptListUnified");
    v10 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v1;
}

uint64_t sub_1002AA44C()
{
  if (off_100B60DB0)
  {
    v0 = off_100B60DB0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA4D8(unsigned int a1, uint64_t a2)
{
  v2 = 101;
  if (a1 <= 0x1E && a2)
  {
    if (off_100B60DB8)
    {
      v2 = off_100B60DB8();
      if (!v2)
      {
        return v2;
      }
    }

    else
    {
      v2 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC failed %!", v3, v4, v5, v6, v7, v8, v9, v2);
      v10 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v2;
}

uint64_t sub_1002AA574()
{
  if (off_100B60EE0)
  {
    v0 = off_100B60EE0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA600()
{
  if (off_100B60EE8)
  {
    v0 = off_100B60EE8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_SrsFwLogUTCTimeSync");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA694()
{
  if (off_100B60EF0)
  {
    v0 = off_100B60EF0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_SetInqPageMode");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA728()
{
  if (off_100B60EF8)
  {
    v0 = off_100B60EF8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_EnableUartRanging");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA7BC(uint64_t a1, const void *a2, unsigned int a3, uint64_t (*a4)(void, void, void, void), uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v8 = sub_100251128(a1, a2, a3, a4, a5, a6, a7, a8, a5, v18);
  if (v8)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("%s failed %!", v9, v10, v11, v12, v13, v14, v15, "BT_VSC_sendRawHCIcmd");
      v16 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  return v8;
}

uint64_t sub_1002AA840()
{
  if (off_100B60DC8)
  {
    v0 = off_100B60DC8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA8CC()
{
  if (off_100B60DD0)
  {
    v0 = off_100B60DD0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA958()
{
  if (off_100B60DD8)
  {
    v0 = off_100B60DD8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AA9E4()
{
  if (off_100B60E08)
  {
    v0 = off_100B60E08();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAA70(uint64_t a1)
{
  if (off_100B60E10)
  {
    v1 = off_100B60E10(a1);
    if (!v1)
    {
      return v1;
    }
  }

  else
  {
    v1 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v2, v3, v4, v5, v6, v7, v8, v1);
    v9 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v1;
}

uint64_t sub_1002AAB04()
{
  if (off_100B60E18)
  {
    v0 = off_100B60E18();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAB90()
{
  if (off_100B60E58)
  {
    v0 = off_100B60E58();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_DebugAntennaAndPowerDiversityPolicy");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAC24()
{
  if (off_100B60E60)
  {
    v0 = off_100B60E60();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_AntennaAndPowerDiversityPolicy");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AACB8()
{
  if (off_100B60E68)
  {
    v0 = off_100B60E68();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_ConfigAntennaDiversityPolicy");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAD4C()
{
  if (off_100B60E70)
  {
    v0 = off_100B60E70();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_EnableBTCoreDiversity");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AADE0()
{
  if (off_100B60E78)
  {
    v0 = off_100B60E78();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_MrcTxbfLoggingEnable");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAE74()
{
  if (off_100B60E80)
  {
    v0 = off_100B60E80();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAF00()
{
  if (off_100B60E88)
  {
    v0 = off_100B60E88();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AAF8C()
{
  if (off_100B60E90)
  {
    v0 = off_100B60E90();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB018()
{
  if (off_100B60E98)
  {
    v0 = off_100B60E98();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB0A4()
{
  if (off_100B60EA0)
  {
    v0 = off_100B60EA0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_ReadPciePowerProfilingStats");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB138()
{
  if (off_100B60EA8)
  {
    v0 = off_100B60EA8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB1C4()
{
  if (off_100B60EB0)
  {
    v0 = off_100B60EB0();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_ReadEnhancedPowerStatsPerCore");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB258()
{
  if (off_100B60EB8)
  {
    v0 = off_100B60EB8();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("%s VSC failed %!", v1, v2, v3, v4, v5, v6, v7, "BT_VSC_AddToFilterAcceptListEnhancedConnectionTagging");
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB2EC()
{
  if (off_100B60F00)
  {
    v0 = off_100B60F00();
    if (!v0)
    {
      return v0;
    }
  }

  else
  {
    v0 = 3601;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("VSC failed %!", v1, v2, v3, v4, v5, v6, v7, v0);
    v8 = sub_10000C050(0x54u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  return v0;
}

uint64_t sub_1002AB378(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  if (sub_1002555B4(a2) && sub_1000ABD24(a3))
  {
    if (off_100B60660)
    {
      v12 = off_100B60660(a1, a2, a3, a4, a5, a6);
      if (!v12)
      {
        return v12;
      }
    }

    else
    {
      v12 = 3601;
    }

    if (sub_10000C240())
    {
      sub_10000AF54("VSC failed %!", v22, v23, v24, v25, v26, v27, v28, v12);
      v29 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }
  }

  else
  {
    if (sub_10000C240())
    {
      sub_10000AF54("BT_VSC_EnableCisLinkQualityStats failed, no connection", v13, v14, v15, v16, v17, v18, v19, v30);
      v20 = sub_10000C050(0x54u);
      if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }

    return 122;
  }

  return v12;
}

uint64_t sub_1002AB4A0()
{
  byte_100B61150 = 0;
  qword_100B61160 = 0;
  return 0;
}

uint64_t sub_1002AB4B8(char *a1)
{
  *a1 = 0;
  if (sub_10029CA58(2))
  {
    *a1 |= 1u;
  }

  if (sub_10029CA58(1))
  {
    *a1 |= 2u;
  }

  if (sub_10029CA58(3))
  {
    *a1 |= 8u;
  }

  if (sub_10029CA58(4))
  {
    *a1 |= 0x10u;
  }

  v2 = sub_10029CB0C();
  v3 = *a1;
  if (v2)
  {
    v3 = *a1 | 0x20;
  }

  *a1 = v3 | 0x80;
  a1[1] |= 2u;
  return 0;
}

uint64_t sub_1002AB568()
{
  if (((byte_100B61150 + 1) & 0x100) != 0)
  {
    v0 = byte_100B61150 + 2;
  }

  else
  {
    v0 = byte_100B61150 + 1;
  }

  byte_100B61150 = v0;
  return v0;
}

uint64_t sub_1002AB58C(uint64_t a1, int a2)
{
  v6[1] = &v7;
  v7 = a1;
  v6[0] = 8;
  v3 = sub_1000B12AC(a1);
  sub_10002242C(*(v3 + 84));
  *(sub_1000B12AC(v7) + 84) = 0;
  v4 = sub_1000B12AC(v7);
  return sub_10002195C(sub_1002AB608, v6, a2, (v4 + 84));
}

void sub_1002AB608(uint64_t a1)
{
  v1 = **(a1 + 8);
  if (!*v1)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Timer expired, but channel %p is not used any more.", v3, v4, v5, v6, v7, v8, v9, v1);
      v10 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_8;
      }
    }

    return;
  }

  *(sub_1000B12AC(**(a1 + 8)) + 84) = 0;
  v2 = *(sub_1000B12AC(v1) + 16);
  if (v2 <= 4)
  {
    if (v2 != 1)
    {
      if (v2 != 3)
      {
        goto LABEL_17;
      }

LABEL_14:
      if (!sub_10000C240())
      {
        goto LABEL_23;
      }

      sub_10000AF54("Timeout waiting for CONFIG_RSP", v19, v20, v21, v22, v23, v24, v25, v43);
      v26 = sub_10000C050(0x2Fu);
      if (!os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_23;
      }

      goto LABEL_22;
    }

    if (!sub_10000C240())
    {
      goto LABEL_23;
    }

    sub_10000AF54("Timeout waiting for CONNECT_RSP", v35, v36, v37, v38, v39, v40, v41, v43);
    v42 = sub_10000C050(0x2Fu);
    if (!os_log_type_enabled(v42, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_23;
    }

LABEL_22:
    sub_1000E09C0();
LABEL_23:
    sub_10028EE5C(v1, 559);
    return;
  }

  if (v2 == 5)
  {
    goto LABEL_14;
  }

  if (v2 == 6)
  {
    if (!sub_10000C240())
    {
      goto LABEL_23;
    }

    sub_10000AF54("Timeout waiting for DISCONNECT_RSP", v11, v12, v13, v14, v15, v16, v17, v43);
    v18 = sub_10000C050(0x2Fu);
    if (!os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      goto LABEL_23;
    }

    goto LABEL_22;
  }

LABEL_17:
  if (sub_10000C240())
  {
    sub_10000AF54("Timeout for unknown message type!", v27, v28, v29, v30, v31, v32, v33, v43);
    v34 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v34, OS_LOG_TYPE_ERROR))
    {
LABEL_8:
      sub_1000E09C0();
    }
  }
}

uint64_t sub_1002AB7D0(uint64_t a1)
{
  v2 = sub_1000B12AC(a1);
  v3 = sub_10002242C(*(v2 + 84));
  *(sub_1000B12AC(a1) + 84) = 0;
  return v3;
}

uint64_t sub_1002AB810(_BYTE *a1, unsigned int a2, uint64_t a3, _BYTE *a4, char a5, uint64_t a6, uint64_t a7, uint64_t a8, uint64_t a9)
{
  v119 = 0;
  v120 = 0;
  ptr = 0;
  result = sub_1002ACE2C(&ptr, 107, a2, a5);
  if (result)
  {
    return result;
  }

  v115 = a3;
  v116 = a5;
  v117 = a4;
  v15 = 0;
  LOBYTE(a3) = 0;
  LOBYTE(v16) = 0;
  v120 = &a9;
  while (1)
  {
    v17 = *a1;
    if (v17 <= 0x6C)
    {
      break;
    }

    if (*a1 > 0x71u)
    {
      if (v17 == 114)
      {
        v51 = v120++;
        v52 = *v51;
        if (v52)
        {
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_232:
            v93 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_233:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 686, v93);
          }

          v53 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_232;
          }

          if (BYTE6(v119) != 2)
          {
            v93 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_233;
          }

          ++WORD2(v119);
          *(ptr + v53) = 4;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_183:
            v84 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_208:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 688, v84);
          }

          v54 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_183;
          }

          if (BYTE6(v119) != 2)
          {
            v84 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_208;
          }

          ++WORD2(v119);
          *(ptr + v54) = 9;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_191:
            v89 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_222:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 690, v89);
          }

          v55 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_191;
          }

          if (BYTE6(v119) != 2)
          {
            v89 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_222;
          }

          v56 = *v52;
          ++WORD2(v119);
          *(ptr + v55) = v56;
          v57 = v120++;
          v58 = *v57;
          if (*v57)
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_262:
              v104 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_274:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 695, v104);
            }

            v59 = WORD2(v119);
            if (WORD1(v119) <= WORD2(v119))
            {
              goto LABEL_262;
            }

            if (BYTE6(v119) != 2)
            {
              v104 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_274;
            }

            v60 = *v58;
          }

          else
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_285:
              v111 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_289:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 697, v111);
            }

            v59 = WORD2(v119);
            if (WORD1(v119) <= WORD2(v119))
            {
              goto LABEL_285;
            }

            v60 = a3;
            if (BYTE6(v119) != 2)
            {
              v111 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_289;
            }
          }

          WORD2(v119) = v59 + 1;
          *(ptr + v59) = v60;
          v62 = v120++;
          v63 = *v62;
          if (*v62)
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_268:
              v103 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_269:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 701, v103);
            }

            v64 = WORD2(v119);
            if (WORD1(v119) <= WORD2(v119))
            {
              goto LABEL_268;
            }

            if (BYTE6(v119) != 2)
            {
              v103 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_269;
            }

            v65 = *v63;
          }

          else
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_282:
              v109 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_287:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 703, v109);
            }

            v64 = WORD2(v119);
            if (WORD1(v119) <= WORD2(v119))
            {
              goto LABEL_282;
            }

            v65 = a3;
            if (BYTE6(v119) != 2)
            {
              v109 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_287;
            }
          }

          WORD2(v119) = v64 + 1;
          *(ptr + v64) = v65;
          v66 = v120++;
          v67 = *v66;
          if (v67)
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_278:
              v107 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_279:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 708, v107);
            }

            if (WORD1(v119) - WORD2(v119) <= 1)
            {
              goto LABEL_278;
            }

            if (BYTE6(v119) != 2)
            {
              v107 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_279;
            }

            *(ptr + WORD2(v119)) = *v67;
            v68 = v67[1];
          }

          else
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_298:
              v110 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_299:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 710, v110);
            }

            if (WORD1(v119) - WORD2(v119) <= 1)
            {
              goto LABEL_298;
            }

            if (BYTE6(v119) != 2)
            {
              v110 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_299;
            }

            *(ptr + WORD2(v119)) = a3;
            v68 = v16;
          }

          *(ptr + WORD2(v119) + 1) = v68;
          v69 = WORD2(v119) + 2;
          WORD2(v119) += 2;
          v70 = v120++;
          v71 = *v70;
          if (v71)
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_265:
              v106 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_276:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 714, v106);
            }

            if (WORD1(v119) - v69 <= 1)
            {
              goto LABEL_265;
            }

            if (BYTE6(v119) != 2)
            {
              v106 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_276;
            }

            *(ptr + v69) = *v71;
            v72 = v71[1];
          }

          else
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_293:
              v108 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_294:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 716, v108);
            }

            if (WORD1(v119) - v69 <= 1)
            {
              goto LABEL_293;
            }

            if (BYTE6(v119) != 2)
            {
              v108 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_294;
            }

            *(ptr + v69) = a3;
            v72 = v16;
          }

          *(ptr + WORD2(v119) + 1) = v72;
          v73 = WORD2(v119) + 2;
          WORD2(v119) += 2;
          v74 = v120++;
          v75 = *v74;
          if (v75)
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_271:
              v105 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_272:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 720, v105);
            }

            if (WORD1(v119) - v73 <= 1)
            {
              goto LABEL_271;
            }

            if (BYTE6(v119) != 2)
            {
              v105 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_272;
            }

            *(ptr + v73) = *v75;
            v76 = v75[1];
          }

          else
          {
            if (HIBYTE(v119))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_291:
              v112 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_296:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 722, v112);
            }

            if (WORD1(v119) - v73 <= 1)
            {
              goto LABEL_291;
            }

            if (BYTE6(v119) != 2)
            {
              v112 = "(bs).__RWFlag == BYTESTREAM_WRITE";
              goto LABEL_296;
            }

            *(ptr + v73) = a3;
            v76 = v16;
          }

          *(ptr + WORD2(v119) + 1) = v76;
          WORD2(v119) += 2;
          v15 += 11;
        }
      }

      else if (v17 == 115)
      {
        v31 = v120++;
        v32 = *v31;
        if (v32)
        {
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_187:
            v87 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_210:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 743, v87);
          }

          v33 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_187;
          }

          if (BYTE6(v119) != 2)
          {
            v87 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_210;
          }

          ++WORD2(v119);
          *(ptr + v33) = 3;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_195:
            v92 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_224:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 745, v92);
          }

          v34 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_195;
          }

          if (BYTE6(v119) != 2)
          {
            v92 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_224;
          }

          ++WORD2(v119);
          *(ptr + v34) = 22;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_205:
            v82 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_206:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 747, v82);
          }

          v35 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_205;
          }

          if (BYTE6(v119) != 2)
          {
            v82 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_206;
          }

          ++WORD2(v119);
          *(ptr + v35) = 0;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_220:
            v97 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_242:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 749, v97);
          }

          v36 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_220;
          }

          if (BYTE6(v119) != 2)
          {
            v97 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_242;
          }

          v37 = *v32;
          ++WORD2(v119);
          *(ptr + v36) = v37;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_256:
            v101 = "ByteStream_NumReadBytesAvail(bs) >= 4";
LABEL_257:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 751, v101);
          }

          if (WORD1(v119) - WORD2(v119) <= 3)
          {
            goto LABEL_256;
          }

          if (BYTE6(v119) != 2)
          {
            v101 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_257;
          }

          *(ptr + WORD2(v119)) = 0;
          *(ptr + WORD2(v119) + 1) = 0;
          *(ptr + WORD2(v119) + 3) = 0;
          v38 = WORD2(v119) + 4;
          WORD2(v119) += 4;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_239:
            v98 = "ByteStream_NumReadBytesAvail(bs) >= 4";
LABEL_249:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 752, v98);
          }

          if (WORD1(v119) - v38 <= 3)
          {
            goto LABEL_239;
          }

          if (BYTE6(v119) != 2)
          {
            v98 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_249;
          }

          *(ptr + v38) = 0;
          *(ptr + WORD2(v119) + 1) = 0;
          *(ptr + WORD2(v119) + 3) = 0;
          v39 = WORD2(v119) + 4;
          WORD2(v119) += 4;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_244:
            v100 = "ByteStream_NumReadBytesAvail(bs) >= 4";
LABEL_254:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 753, v100);
          }

          if (WORD1(v119) - v39 <= 3)
          {
            goto LABEL_244;
          }

          if (BYTE6(v119) != 2)
          {
            v100 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_254;
          }

          *(ptr + v39) = 0;
          *(ptr + WORD2(v119) + 1) = 0;
          *(ptr + WORD2(v119) + 3) = 0;
          v40 = WORD2(v119) + 4;
          WORD2(v119) += 4;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_247:
            v102 = "ByteStream_NumReadBytesAvail(bs) >= 4";
LABEL_259:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 754, v102);
          }

          if (WORD1(v119) - v40 <= 3)
          {
            goto LABEL_247;
          }

          if (BYTE6(v119) != 2)
          {
            v102 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_259;
          }

          *(ptr + v40) = -1;
          *(ptr + WORD2(v119) + 1) = -1;
          *(ptr + WORD2(v119) + 2) = -1;
          *(ptr + WORD2(v119) + 3) = -1;
          v41 = WORD2(v119) + 4;
          WORD2(v119) += 4;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_251:
            v99 = "ByteStream_NumReadBytesAvail(bs) >= 4";
LABEL_252:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 755, v99);
          }

          if (WORD1(v119) - v41 <= 3)
          {
            goto LABEL_251;
          }

          if (BYTE6(v119) != 2)
          {
            v99 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_252;
          }

          *(ptr + v41) = -1;
          *(ptr + WORD2(v119) + 1) = -1;
          *(ptr + WORD2(v119) + 2) = -1;
          *(ptr + WORD2(v119) + 3) = -1;
          WORD2(v119) += 4;
          v15 += 24;
        }
      }
    }

    else
    {
      if (v17 == 109)
      {
        v48 = v120++;
        v27 = *v48;
        if (!v27)
        {
          goto LABEL_146;
        }

        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_181:
          v83 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_203:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 654, v83);
        }

        v49 = WORD2(v119);
        if (WORD1(v119) <= WORD2(v119))
        {
          goto LABEL_181;
        }

        if (BYTE6(v119) != 2)
        {
          v83 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_203;
        }

        ++WORD2(v119);
        *(ptr + v49) = 1;
        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_189:
          v88 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_218:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 656, v88);
        }

        v50 = WORD2(v119);
        if (WORD1(v119) <= WORD2(v119))
        {
          goto LABEL_189;
        }

        if (BYTE6(v119) != 2)
        {
          v88 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_218;
        }

        ++WORD2(v119);
        *(ptr + v50) = 2;
        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_198:
          v94 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_235:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 658, v94);
        }

        v30 = WORD2(v119);
        if (WORD1(v119) - WORD2(v119) <= 1)
        {
          goto LABEL_198;
        }

        if (BYTE6(v119) != 2)
        {
          v94 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_235;
        }

        goto LABEL_81;
      }

      if (v17 == 111)
      {
        v20 = v120++;
        v21 = *v20;
        if (v21)
        {
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_200:
            v95 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_237:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 767, v95);
          }

          v22 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_200;
          }

          if (BYTE6(v119) != 2)
          {
            v95 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_237;
          }

          ++WORD2(v119);
          *(ptr + v22) = 5;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_215:
            v86 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_216:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 769, v86);
          }

          v23 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_215;
          }

          if (BYTE6(v119) != 2)
          {
            v86 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_216;
          }

          ++WORD2(v119);
          *(ptr + v23) = 1;
          if (HIBYTE(v119))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_229:
            v91 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_230:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 771, v91);
          }

          v24 = WORD2(v119);
          if (WORD1(v119) <= WORD2(v119))
          {
            goto LABEL_229;
          }

          if (BYTE6(v119) != 2)
          {
            v91 = "(bs).__RWFlag == BYTESTREAM_WRITE";
            goto LABEL_230;
          }

          v25 = *v21;
          ++WORD2(v119);
          *(ptr + v24) = v25;
          v15 += 3;
        }
      }
    }

LABEL_146:
    ++a1;
  }

  if (*a1 > 0x63u)
  {
    if (v17 == 100)
    {
      v42 = v120++;
      v43 = *v42;
      v120 = v42 + 2;
      v44 = *(v42 + 2);
      v45 = ptr;
      v46 = WORD2(v119);
      if (HIBYTE(v119))
      {
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        v47 = 0;
      }

      else
      {
        v47 = WORD1(v119) - WORD2(v119);
      }

      if (v47 < v44)
      {
        v79 = "ByteStream_NumReadBytesAvail(bs) >= (count)";
        goto LABEL_168;
      }

      if (BYTE6(v119) != 2)
      {
        v79 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_168:
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 734, v79);
      }

      v15 += v44;
      memmove(&v45[v46], v43, v44);
      WORD2(v119) += v44;
    }

    else if (v17 == 102)
    {
      v26 = v120++;
      v27 = *v26;
      if (v27)
      {
        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_212:
          v85 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_213:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 670, v85);
        }

        v28 = WORD2(v119);
        if (WORD1(v119) <= WORD2(v119))
        {
          goto LABEL_212;
        }

        if (BYTE6(v119) != 2)
        {
          v85 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_213;
        }

        ++WORD2(v119);
        *(ptr + v28) = 2;
        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_226:
          v90 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_227:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 672, v90);
        }

        v29 = WORD2(v119);
        if (WORD1(v119) <= WORD2(v119))
        {
          goto LABEL_226;
        }

        if (BYTE6(v119) != 2)
        {
          v90 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_227;
        }

        ++WORD2(v119);
        *(ptr + v29) = 2;
        if (HIBYTE(v119))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_179:
          v96 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_201:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 674, v96);
        }

        v30 = WORD2(v119);
        if (WORD1(v119) - WORD2(v119) <= 1)
        {
          goto LABEL_179;
        }

        if (BYTE6(v119) != 2)
        {
          v96 = "(bs).__RWFlag == BYTESTREAM_WRITE";
          goto LABEL_201;
        }

LABEL_81:
        *(ptr + v30) = *v27;
        *(ptr + WORD2(v119) + 1) = v27[1];
        WORD2(v119) += 2;
        v15 += 4;
        goto LABEL_146;
      }
    }

    goto LABEL_146;
  }

  if (v17 == 97)
  {
    v61 = v120++;
    if (HIBYTE(v119))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_170:
      v80 = "ByteStream_NumReadBytesAvail(bs) >= 2";
LABEL_173:
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 637, v80);
    }

    if (WORD1(v119) - WORD2(v119) <= 1)
    {
      goto LABEL_170;
    }

    if (BYTE6(v119) != 2)
    {
      v80 = "(bs).__RWFlag == BYTESTREAM_WRITE";
      goto LABEL_173;
    }

    LODWORD(a3) = *v61;
    *(ptr + WORD2(v119)) = *v61;
    v16 = a3 >> 8;
    *(ptr + WORD2(v119) + 1) = BYTE1(a3);
    WORD2(v119) += 2;
    v15 += 2;
    goto LABEL_146;
  }

  if (v17 == 99)
  {
    v18 = v120++;
    if (HIBYTE(v119))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_175:
      v81 = "ByteStream_NumReadBytesAvail(bs) >= 1";
LABEL_176:
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 644, v81);
    }

    v19 = WORD2(v119);
    if (WORD1(v119) <= WORD2(v119))
    {
      goto LABEL_175;
    }

    if (BYTE6(v119) != 2)
    {
      v81 = "(bs).__RWFlag == BYTESTREAM_WRITE";
      goto LABEL_176;
    }

    LOBYTE(v16) = 0;
    LODWORD(a3) = *v18;
    ++WORD2(v119);
    *(ptr + v19) = a3;
    ++v15;
    goto LABEL_146;
  }

  if (*a1)
  {
    goto LABEL_146;
  }

  v77 = WORD2(v119);
  WORD2(v119) = 0;
  if (HIBYTE(v119))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_301;
  }

  if (WORD1(v119) <= 1u)
  {
LABEL_301:
    v113 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_303;
  }

  if (BYTE6(v119) != 2)
  {
    v113 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_303:
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 787, v113);
  }

  *ptr = v15 + 4;
  *(ptr + WORD2(v119) + 1) = (v15 + 4) >> 8;
  WORD2(v119) += 2;
  if (WORD1(v119) <= 5u)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 788, "(size_t)(6) <= (size_t)((bs).__size)");
  }

  WORD2(v119) = 6;
  if (HIBYTE(v119))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_306;
  }

  if (WORD1(v119) <= 7u)
  {
LABEL_306:
    v114 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_308;
  }

  if (BYTE6(v119) != 2)
  {
    v114 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_308:
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 789, v114);
  }

  *(ptr + 6) = v15;
  *(ptr + WORD2(v119) + 1) = BYTE1(v15);
  WORD2(v119) += 2;
  if (v77 > WORD1(v119))
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 790, "(size_t)(pos) <= (size_t)((bs).__size)");
  }

  WORD2(v119) = v77;
  if (BYTE6(v119) == 2)
  {
    WORD1(v119) = v77;
  }

  BYTE6(v119) = 15;
  if (a2 <= 6 && ((1 << a2) & 0x54) != 0)
  {
    if (!v115)
    {
      sub_1000D660C();
    }

    v78 = sub_1003045A0(0x2Fu);
    if (sub_1002AB58C(v115, *(v78 + 6)))
    {
      sub_10000C1E8(ptr);
      return 104;
    }

    *(sub_1000B12AC(v115) + 28) = v116;
  }

  return sub_1002AD124(v117, &ptr);
}

uint64_t sub_1002ACE2C(uint64_t *a1, __int16 a2, char a3, char a4)
{
  v8 = a2 + 8;
  v9 = sub_100007618((a2 + 8), 0xA00CCD61uLL);
  if (v9)
  {
    if (!v8)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 463, "(totalLen) > 0");
    }

    *a1 = v9;
    *(a1 + 4) = v8;
    *(a1 + 3) = 0x20000;
    *(a1 + 5) = v8;
    if (v8 == 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 467, "ByteStream_NumReadBytesAvail(*pBs) >= 2");
    }

    *v9 = a2 + 4;
    *(*a1 + *(a1 + 6) + 1) = (a2 + 4) >> 8;
    v10 = *(a1 + 6) + 2;
    *(a1 + 6) = v10;
    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    }

    else if (*(a1 + 5) - v10 > 1)
    {
      if (*(a1 + 14) == 2)
      {
        *(*a1 + v10) = 1;
        *(*a1 + *(a1 + 6) + 1) = 0;
        v11 = *(a1 + 6);
        *(a1 + 6) = v11 + 2;
        if (*(a1 + 15))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        }

        else if (*(a1 + 5) > (v11 + 2))
        {
          if (*(a1 + 14) == 2)
          {
            v12 = *a1;
            *(a1 + 6) = v11 + 3;
            *(v12 + (v11 + 2)) = a3;
            if (*(a1 + 15))
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            }

            else
            {
              v13 = *(a1 + 6);
              if (*(a1 + 5) > v13)
              {
                if (*(a1 + 14) == 2)
                {
                  v14 = *a1;
                  *(a1 + 6) = v13 + 1;
                  *(v14 + v13) = a4;
                  if (*(a1 + 15))
                  {
                    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                  }

                  else if (*(a1 + 5) - *(a1 + 6) > 1)
                  {
                    if (*(a1 + 14) == 2)
                    {
                      result = 0;
                      *(*a1 + *(a1 + 6)) = a2;
                      *(a1 + 6) += 2;
                      return result;
                    }

                    v19 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_35:
                    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 473, v19);
                  }

                  v19 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
                  goto LABEL_35;
                }

                v18 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_31:
                sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 472, v18);
              }
            }

            v18 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
            goto LABEL_31;
          }

          v17 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_27:
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 471, v17);
        }

        v17 = "ByteStream_NumReadBytesAvail(*pBs) >= 1";
        goto LABEL_27;
      }

      v16 = "(*pBs).__RWFlag == BYTESTREAM_WRITE";
LABEL_23:
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 468, v16);
    }

    v16 = "ByteStream_NumReadBytesAvail(*pBs) >= 2";
    goto LABEL_23;
  }

  return 106;
}

uint64_t sub_1002AD124(_BYTE *a1, uint64_t a2)
{
  v4 = sub_1001BBBD8(0x98uLL, 0x10F20402EF40073uLL);
  if (!v4)
  {
    return 106;
  }

  v5 = v4;
  sub_10001FF10((v4 + 40), 1u);
  sub_10001F968(v5 + 40, *a2, *(a2 + 10), 1u);
  *v5 = 1;
  *(v5 + 4) = 0;
  v6 = sub_1000B85D8(v5, a1, 0, 1);
  if (v6)
  {
    sub_1000B7B40((v5 + 40));
    sub_10000C1E8(v5);
  }

  if (v6 == 412)
  {
    return 0;
  }

  else
  {
    return v6;
  }
}

uint64_t sub_1002AD1D8(_BYTE *a1, uint64_t a2, __int16 a3, __int16 a4, __int16 a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v10 = 0;
  if (a2 == 2)
  {
    v8 = &v10 + 3;
    BYTE1(v10) = HIBYTE(a4);
    HIBYTE(a3) = HIBYTE(a5);
    BYTE2(v10) = a5;
    goto LABEL_5;
  }

  if (a2 == 1)
  {
    v8 = &v10 + 1;
LABEL_5:
    *v8 = HIBYTE(a3);
  }

  return sub_1002AB810("ad", 1u, 0, a1, a6, a6, a7, a8, a2);
}

uint64_t sub_1002AD274(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, __int16 a5)
{
  if (a3 && a1)
  {
    v10 = sub_1001BBBD8(0xE0uLL, 0x10F2040D088555EuLL);
    if (v10)
    {
      v11 = v10;
      v10[152] = 8;
      *(v10 + 24) = qword_100B61160;
      qword_100B61160 = v10;
      if (((byte_100B61150 + 1) & 0x100) != 0)
      {
        v12 = byte_100B61150 + 2;
      }

      else
      {
        v12 = byte_100B61150 + 1;
      }

      byte_100B61150 = v12;
      v10[153] = v12;
      v13 = *a3;
      *(v10 + 92) = *(a3 + 4);
      *(v10 + 45) = v13;
      *(v10 + 21) = a2;
      *(v10 + 25) = a1;
      *(v10 + 26) = a4;
      *(v10 + 108) = a5;
      v14 = sub_10023B6AC(sub_1002AD378, a3);
      if (v14)
      {
        sub_1002AD6D0(v11, 0);
      }
    }

    else
    {
      return 104;
    }
  }

  else
  {
    sub_1000D660C();
    return 101;
  }

  return v14;
}

void sub_1002AD378(uint64_t a1, uint64_t a2, _BYTE *a3)
{
  v5 = a1;
  v6 = qword_100B61160;
  if (!qword_100B61160)
  {
LABEL_7:
    if (sub_10000C240() && (sub_10000AF54("Missing command tracker %:", v8, v9, v10, v11, v12, v13, v14, a2), v15 = sub_10000C050(0x2Fu), os_log_type_enabled(v15, OS_LOG_TYPE_ERROR)))
    {
      sub_100815874();
      if (v5)
      {
        return;
      }
    }

    else if (v5)
    {
      return;
    }

    sub_1000D2538(a3, 19);
    return;
  }

  while (*(v6 + 180) != *a2 || *(v6 + 184) != *(a2 + 4))
  {
    v6 = *(v6 + 192);
    if (!v6)
    {
      goto LABEL_7;
    }
  }

  v44 = v6;
  if (!a1)
  {
    v42 = 0;
    v43 = 0;
    *(v6 + 160) = a3;
    v16 = *(v6 + 152);
    if (v16 != 8)
    {
      if (v16 != 10)
      {
        goto LABEL_32;
      }

      v17 = sub_1002ACE2C(&v42, 2, 10, *(v6 + 153));
      if (!v17)
      {
        if (HIBYTE(v43))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        }

        else
        {
          v18 = WORD2(v43);
          if (WORD1(v43) - WORD2(v43) > 1)
          {
            if (BYTE6(v43) == 2)
            {
              v19 = (v42 + WORD2(v43));
              *v19 = *(v6 + 200);
              v19[1] = *(v6 + 201);
              v20 = v18 + 2;
              goto LABEL_28;
            }

            v38 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_43:
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 882, v38);
          }
        }

        v38 = "ByteStream_NumReadBytesAvail(bs) >= 2";
        goto LABEL_43;
      }

LABEL_29:
      v27 = v17;
      if (sub_10000C240())
      {
        sub_10000AF54("Failed to send command", v28, v29, v30, v31, v32, v33, v34, v40);
        v35 = sub_10000C050(0x2Fu);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
        {
          sub_1008148EC();
        }
      }

LABEL_34:
      sub_1002AD6D0(v6, v27);
      return;
    }

    v17 = sub_1002ACE2C(&v42, *(v6 + 216) + 2, 8, *(v6 + 153));
    if (v17)
    {
      goto LABEL_29;
    }

    if (HIBYTE(v43))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    }

    else
    {
      v21 = WORD1(v43);
      v22 = WORD2(v43);
      if (WORD1(v43) - WORD2(v43) > 1)
      {
        if (BYTE6(v43) == 2)
        {
          v23 = v42;
          v24 = (v42 + WORD2(v43));
          *v24 = *(v6 + 216);
          v24[1] = *(v6 + 217);
          v25 = v22 + 2;
          v26 = *(v6 + 216);
          if (v21 - (v22 + 2) < v26)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 891, "ByteStream_NumReadBytesAvail(bs) >= (tracker->data.echoData.len)");
          }

          memmove((v23 + v25), *(v6 + 208), v26);
          v20 = *(v6 + 216) + v25;
LABEL_28:
          WORD2(v43) = v20;
          WORD1(v43) = v20;
          BYTE6(v43) = 15;
          v17 = sub_1002AD124(a3, &v42);
          if (v17)
          {
            goto LABEL_29;
          }

LABEL_32:
          v41[1] = &v44;
          v41[0] = 8;
          v36 = sub_1003045A0(0x2Fu);
          v37 = sub_10002195C(sub_1002ADEE4, v41, *(v36 + 6), (v44 + 176));
          if (!v37)
          {
            return;
          }

          v27 = v37;
          v6 = v44;
          goto LABEL_34;
        }

        v39 = "(bs).__RWFlag == BYTESTREAM_WRITE";
LABEL_45:
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 890, v39);
      }
    }

    v39 = "ByteStream_NumReadBytesAvail(bs) >= 2";
    goto LABEL_45;
  }

  sub_1002AD6D0(v6, a1);
}

void sub_1002AD6D0(uint64_t a1, uint64_t a2)
{
  if (!qword_100B61160)
  {
    sub_1000D660C();
  }

  sub_10002242C(*(a1 + 176));
  v4 = *(a1 + 160);
  if (v4)
  {
    sub_1000D2538(v4, 19);
  }

  v5 = &qword_100B61160;
  v6 = qword_100B61160;
  if (qword_100B61160 == a1)
  {
LABEL_9:
    *v5 = *(v6 + 192);
    if (a2)
    {
      v8 = sub_1000E1FE8(a1 + 180);
      if (sub_1000B8B5C(v8) || (v9 = sub_1000E1FE8(a1 + 180), sub_1000C0E08(v9)) || (v10 = sub_1000E1FE8(a1 + 180), sub_1000ABD24(v10)) || (v11 = sub_1000E1FE8(a1 + 180), sub_1000B7994(v11)))
      {
        v12 = *(a1 + 152);
        if (v12 == 10)
        {
          (*(a1 + 208))(a1 + 180, *(a1 + 168), *(a1 + 200), 0, 0, a2);
        }

        else if (v12 == 8)
        {
          (*(a1 + 200))(a1 + 180, *(a1 + 168), *(a1 + 208), *(a1 + 216), 0, 0, a2);
        }

        else
        {
          sub_1000D660C();
        }
      }
    }

    sub_10000C1E8(a1);
  }

  else
  {
    while (v6)
    {
      v7 = v6;
      v6 = *(v6 + 192);
      if (v6 == a1)
      {
        v5 = (v7 + 192);
        v6 = a1;
        goto LABEL_9;
      }
    }
  }
}

uint64_t sub_1002AD818(uint64_t a1, uint64_t a2, uint64_t a3, __int16 a4)
{
  if (a1 && a3)
  {
    v8 = sub_1001BBBD8(0xE0uLL, 0x10F2040D088555EuLL);
    if (v8)
    {
      v9 = v8;
      v8[152] = 10;
      *(v8 + 24) = qword_100B61160;
      qword_100B61160 = v8;
      if (((byte_100B61150 + 1) & 0x100) != 0)
      {
        v10 = byte_100B61150 + 2;
      }

      else
      {
        v10 = byte_100B61150 + 1;
      }

      byte_100B61150 = v10;
      v8[153] = v10;
      v11 = *a3;
      *(v8 + 92) = *(a3 + 4);
      *(v8 + 45) = v11;
      *(v8 + 21) = a2;
      *(v8 + 100) = a4;
      *(v8 + 26) = a1;
      v12 = sub_10023B6AC(sub_1002AD378, a3);
      if (v12)
      {
        sub_1002AD6D0(v9, 0);
      }
    }

    else
    {
      if (sub_10000C240())
      {
        sub_10000AF54("AllocCommandTracker() failed", v14, v15, v16, v17, v18, v19, v20, v22);
        v21 = sub_10000C050(0x2Fu);
        if (os_log_type_enabled(v21, OS_LOG_TYPE_ERROR))
        {
          sub_1000E09C0();
        }
      }

      return 104;
    }
  }

  else
  {
    sub_1000D660C();
    return 101;
  }

  return v12;
}

uint64_t sub_1002AD958(unsigned int a1, uint64_t a2)
{
  v6 = 0;
  if (sub_1000ABC7C(a1, &v6))
  {
    return 403;
  }

  v4 = sub_1000B12AC(v6);
  result = 0;
  v5 = *(v4 + 14);
  *a2 = *(v4 + 10);
  *(a2 + 4) = v5;
  return result;
}

void sub_1002AD9B8(_BYTE *a1, unsigned __int16 *a2, size_t size)
{
  v68 = 0;
  if (!a1[2])
  {
    v11 = size;
    if (size <= 3)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("Received L2CAP header with 0 length, disc ACL", v13, v14, v15, v16, v17, v18, v19, (a1 + 48));
        v20 = sub_10000C050(0x2Fu);
        if (os_log_type_enabled(v20, OS_LOG_TYPE_ERROR))
        {
          sub_10080F604();
        }
      }

      sub_10023BA68((a1 + 48));
      return;
    }

    v21 = a2;
    if (a2[1] + 4 == size)
    {
      v22 = 0;
    }

    else
    {
      v23 = sub_100007618(size, 0x7A14E641uLL);
      if (!v23)
      {
        if (sub_10000C240())
        {
          sub_10000AF54("OI_SignalMan_Recv Malloc failed!", v51, v52, v53, v54, v55, v56, v57, v67);
          v58 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v58, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_4;
          }
        }

        return;
      }

      v22 = v23;
      memmove(v23, v21, v11);
      v21 = v22;
    }

    v69 = v21;
    v70 = v11;
    v72 = 0x10000;
    v71 = v11;
    while (1)
    {
      v24 = v71;
      v25 = v72;
      if (v71 <= v72)
      {
        break;
      }

      if (BYTE2(v72) != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1864, "(bs).__RWFlag == BYTESTREAM_READ");
      }

      LOWORD(v72) = v72 + 1;
      v26 = *(v69 + v25);
      if (v71 <= (v25 + 1))
      {
        HIBYTE(v72) = 1;
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_47:
        HIBYTE(v72) = 1;
        if (sub_10000C240())
        {
          sub_10000AF54("OI_SignalMan_Recv - %!", v59, v60, v61, v62, v63, v64, v65, 411);
          v66 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v66, OS_LOG_TYPE_ERROR))
          {
            sub_1000E09C0();
          }
        }

        break;
      }

      LOWORD(v72) = v25 + 2;
      if (v71 - (v25 + 2) <= 1)
      {
        goto LABEL_47;
      }

      v27 = *(v69 + v25 + 1);
      v28 = *(v69 + v25 + 2);
      v29 = v25 + 4;
      LOWORD(v72) = v29;
      if ((v26 - 18) > 0xFFFFFFEE)
      {
        if (v26 <= 0x11 && ((1 << v26) & 0x2A0AA) != 0)
        {
          if (sub_10028DB10(a1, v27, &v68))
          {
            break;
          }

          sub_1002AB7D0(v68);
          v29 = v72;
          v24 = v71;
        }

        v40 = v28 + v29;
        if (v40 <= v24)
        {
          qword_100AE9C20[v26](&v69, v27, v28, a1);
          if (v40 > v71)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1909, "(size_t)(endSignalPos) <= (size_t)((bs).__size)");
          }
        }

        else
        {
          if (sub_10000C240())
          {
            sub_10000AF54("%! - Signalling packet length error", v41, v42, v43, v44, v45, v46, v47, 411);
            v48 = sub_10000C050(0x2Fu);
            if (os_log_type_enabled(v48, OS_LOG_TYPE_ERROR))
            {
              v50 = sub_10000C0FC();
              *buf = 136446466;
              v74 = v50;
              v75 = 1024;
              v76 = 0xFFFF;
              _os_log_error_impl(&_mh_execute_header, v48, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }

          LOWORD(v40) = v71;
        }
      }

      else
      {
        if (sub_10000C240())
        {
          sub_10000AF54("Unrecognized command (%d), sending CommandReject", v30, v31, v32, v33, v34, v35, v36, v26);
          v37 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
          {
            v49 = sub_10000C0FC();
            *buf = 136446466;
            v74 = v49;
            v75 = 1024;
            v76 = 0xFFFF;
            _os_log_error_impl(&_mh_execute_header, v37, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
          }
        }

        *buf = 0;
        sub_1002AB810("ad", 1u, 0, a1, v27, v34, v35, v36, 0);
        if (HIBYTE(v72))
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v38 = 0;
        }

        else
        {
          v38 = v71 - v72;
        }

        if (v38 < v28)
        {
          HIBYTE(v72) = 1;
LABEL_51:
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          break;
        }

        LOWORD(v40) = v72 + v28;
      }

      LOWORD(v72) = v40;
      if (HIBYTE(v72))
      {
        goto LABEL_51;
      }
    }

    if (v22)
    {
      sub_10000C1E8(v22);
    }

    return;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("Signalling channel should only be used by ACL handles.", v3, v4, v5, v6, v7, v8, v9, v67);
    v10 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_ERROR))
    {
LABEL_4:
      sub_1000E09C0();
    }
  }
}

void sub_1002ADEE4(uint64_t a1)
{
  v1 = **(a1 + 8);
  v2 = &qword_100B61160;
  do
  {
    v3 = *v2;
    v2 = (*v2 + 192);
    if (v3)
    {
      v4 = v3 == v1;
    }

    else
    {
      v4 = 1;
    }
  }

  while (!v4);
  if (v3)
  {
    if (*(v1 + 152) == 8)
    {
      v5 = 440;
    }

    else
    {
      v5 = 441;
    }

    sub_1002AD6D0(v1, v5);
  }
}

void sub_1002ADF24(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  qmemcpy(v74, "IOIOIO", sizeof(v74));
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v8 = 0;
  }

  else
  {
    v8 = *(a1 + 10) - *(a1 + 12);
  }

  if (v8 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1017, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1020, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  v73 = 0;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_10:
    *(a1 + 15) = 1;
    v10 = 20297;
    goto LABEL_11;
  }

  v9 = *(a1 + 12);
  if (*(a1 + 10) - v9 < 2)
  {
    goto LABEL_10;
  }

  v10 = *(*a1 + v9);
  *(a1 + 12) = v9 + 2;
LABEL_11:
  if (sub_10000C240())
  {
    sub_10000AF54("Received Command Reject, identifier %d, handle %d, reason %d", v11, v12, v13, v14, v15, v16, v17, a2);
    v18 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      sub_1000E09C0();
    }
  }

  if (v10 == 2)
  {
    if (*(a1 + 14) != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1031, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      v27 = *(a1 + 14);
      *(a1 + 15) = 1;
      if (v27 != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1032, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }
    }

    else
    {
      v45 = *(a1 + 12);
      if (*(a1 + 10) - v45 > 1)
      {
        v74[1] = *(*a1 + v45);
        *(a1 + 12) = v45 + 2;
        if (*(a1 + 10) - (v45 + 2) >= 2)
        {
          v74[0] = *(*a1 + (v45 + 2));
          *(a1 + 12) = v45 + 4;
LABEL_42:
          if (sub_10000C240())
          {
            sub_10000AF54("  Rejected - invalid CID, localCID %d, remoteCID %d", v46, v47, v48, v49, v50, v51, v52, v74[1]);
            v53 = sub_10000C050(0x2Fu);
            if (os_log_type_enabled(v53, OS_LOG_TYPE_ERROR))
            {
              goto LABEL_44;
            }
          }

          goto LABEL_45;
        }

LABEL_41:
        *(a1 + 15) = 1;
        goto LABEL_42;
      }

      *(a1 + 15) = 1;
    }

    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_41;
  }

  if (v10 == 1)
  {
    if (*(a1 + 14) != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1027, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    }

    else
    {
      v36 = *(a1 + 12);
      if (*(a1 + 10) - v36 >= 2)
      {
        v74[2] = *(*a1 + v36);
        *(a1 + 12) = v36 + 2;
LABEL_33:
        if (sub_10000C240())
        {
          sub_10000AF54("  Rejected - MTU exceeded, max MTU = %d", v37, v38, v39, v40, v41, v42, v43, v74[2]);
          v44 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
          {
            goto LABEL_44;
          }
        }

        goto LABEL_45;
      }
    }

    *(a1 + 15) = 1;
    goto LABEL_33;
  }

  if (v10)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("  Rejected - unknown reason code", v28, v29, v30, v31, v32, v33, v34, v72);
      v35 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
      {
        goto LABEL_44;
      }
    }
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("  Rejected - Command not understood", v19, v20, v21, v22, v23, v24, v25, v72);
    v26 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
    {
LABEL_44:
      sub_1000E09C0();
    }
  }

LABEL_45:
  if (*(a1 + 15))
  {
    if (sub_10000C240())
    {
      sub_10000AF54("SignalMan_RecvCommandReject - %!", v54, v55, v56, v57, v58, v59, v60, 411);
      v61 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }
  }

  else if (sub_10028DB10(a4, a2, &v73))
  {
    if (sub_10000C240())
    {
      sub_10000AF54("No channel found for identifier %d, ignoring command reject packet", v62, v63, v64, v65, v66, v67, v68, a2);
      v69 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }
  }

  else if (*v73 == 2)
  {
    v70 = sub_1000B12AC(v73);
    if (*(a4 + 48) != *(v70 + 10) || *(a4 + 52) != *(v70 + 14))
    {
      sub_1000D660C();
    }

    sub_10028EE5C(v73, 445);
  }
}

void sub_1002AE404(uint64_t a1, char a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v14 = 771;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1078, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  v13 = 0;
  if (!sub_100303B64(a1, 1u, &v14, 2u, a5, a6, a7, a8, &v13))
  {
    sub_100291FF4(a4, v13, 0, a2);
  }
}

void sub_1002AE4DC(uint64_t a1, uint64_t a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v14 = 50529027;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1100, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  v13 = 0;
  if (!sub_100303B64(a1, 1u, &v14, 4u, a5, a6, a7, a8, &v13))
  {
    sub_100292450(a4, 0, v13, 0, 0, a2);
  }
}

void sub_1002AE5CC(uint64_t *a1, char a2, uint64_t a3, uint64_t a4)
{
  memset(v136, 0, 44);
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v8 = 0;
  }

  else
  {
    v8 = *(a1 + 5) - *(a1 + 6);
  }

  if (v8 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1169, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1175, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  v9 = *(a1 + 6);
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v10 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v10 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1176, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_14;
  }

  if (*(a1 + 5) - v9 <= 1)
  {
    *(a1 + 15) = 1;
LABEL_14:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v11 = 0;
    goto LABEL_15;
  }

  v11 = *(*a1 + v9);
  *(a1 + 6) = v9 + 2;
  if (*(a1 + 5) - (v9 + 2) <= 1)
  {
LABEL_15:
    *(a1 + 15) = 1;
    goto LABEL_16;
  }

  v12 = *(*a1 + (v9 + 2));
  *(a1 + 6) = v9 + 4;
  if (v12)
  {
    v13 = 1;
    goto LABEL_17;
  }

LABEL_16:
  v13 = 0;
LABEL_17:
  v14 = v9 + a3;
  if (a3 <= 3)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Bogus length in configuration request - must be corrupt packet", v16, v17, v18, v19, v20, v21, v22, v129);
      v23 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v23, OS_LOG_TYPE_ERROR))
      {
        sub_1008158FC();
      }
    }

    v15 = 411;
  }

  else
  {
    v15 = 0;
  }

  v24 = *(a1 + 6);
  if (v14 > v24)
  {
    v131 = v15;
    v132 = v11;
    v133 = a2;
    v25 = 0;
    LOBYTE(v26) = 0;
    v27 = 0;
    v28 = 0;
    size = a3 - 4;
    v135 = (a3 - 4);
    v134 = v14;
    while (1)
    {
      if (*(a1 + 15))
      {
LABEL_142:
        a2 = v133;
        v11 = v132;
        v80 = v27;
        v15 = v131;
        goto LABEL_143;
      }

      if (*(a1 + 14) != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1190, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      v29 = *(a1 + 5);
      if (v29 <= v24)
      {
        *(a1 + 15) = 1;
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      }

      else
      {
        v30 = *a1;
        v31 = v24 + 1;
        *(a1 + 6) = v31;
        v32 = *(v30 + v24);
        if (v29 > v31)
        {
          v33 = *a1;
          *(a1 + 6) = v24 + 2;
          v25 = *(v33 + v31);
          v34 = 1;
          goto LABEL_33;
        }

        LOBYTE(v26) = v32;
      }

      v34 = 0;
      *(a1 + 15) = 1;
      v32 = v26;
LABEL_33:
      v26 = v32 & 0x7F;
      if ((v32 & 0x7Fu) <= 3)
      {
        switch(v26)
        {
          case 1:
            if (*(a1 + 14) != 1)
            {
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1201, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }

            if (v34)
            {
              v44 = *(a1 + 6);
              if (*(a1 + 5) - v44 >= 2)
              {
                WORD2(v136[0]) = *(*a1 + v44);
                *(a1 + 6) = v44 + 2;
LABEL_100:
                LODWORD(v136[0]) |= 1u;
                goto LABEL_123;
              }
            }

            else
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            }

            *(a1 + 15) = 1;
            goto LABEL_100;
          case 2:
            LODWORD(v136[0]) |= 2u;
            if (*(a1 + 14) != 1)
            {
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1205, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }

            if (v34)
            {
              v43 = *(a1 + 6);
              if (*(a1 + 5) - v43 >= 2)
              {
                WORD3(v136[0]) = *(*a1 + v43);
LABEL_91:
                v62 = v43 + 2;
LABEL_132:
                *(a1 + 6) = v62;
                goto LABEL_123;
              }

              goto LABEL_122;
            }

            goto LABEL_121;
          case 3:
            LODWORD(v136[0]) |= 4u;
            if (v34)
            {
              v37 = *(a1 + 6);
              if (*(a1 + 5) > v37)
              {
                v38 = v37 + 1;
                *(a1 + 6) = v37 + 1;
                if (*(a1 + 14) != 1)
                {
                  goto LABEL_181;
                }

                v39 = *(a1 + 5);
                if (v39 > v38)
                {
                  v40 = *a1;
                  v41 = v37 + 2;
                  *(a1 + 6) = v41;
                  BYTE8(v136[0]) = *(v40 + v38);
                  v42 = v39 - v41;
LABEL_96:
                  if (v42 < v25 - 2)
                  {
                    goto LABEL_122;
                  }

                  *(a1 + 6) += v25 - 2;
                  goto LABEL_123;
                }

LABEL_95:
                *(a1 + 15) = 1;
                sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                v42 = 0;
                goto LABEL_96;
              }
            }

            else
            {
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            }

            *(a1 + 15) = 1;
            if (*(a1 + 14) != 1)
            {
LABEL_181:
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1210, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }

            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            goto LABEL_95;
        }
      }

      else if ((v32 & 0x7Fu) > 5)
      {
        if (v26 == 6)
        {
          LODWORD(v136[0]) |= 0x20u;
          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1226, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if (v34)
          {
            v63 = *(a1 + 6);
            if (*(a1 + 5) > v63)
            {
              v64 = *a1;
              v65 = v63 + 1;
              *(a1 + 6) = v63 + 1;
              BYTE8(v136[1]) = *(v64 + v63);
              if (*(a1 + 5) > (v63 + 1))
              {
                v66 = *a1;
                v67 = v63 + 2;
                *(a1 + 6) = v67;
                BYTE9(v136[1]) = *(v66 + v65);
                if (*(a1 + 5) - v67 > 1)
                {
                  WORD5(v136[1]) = *(*a1 + v67);
                  *(a1 + 6) = v67 + 2;
                  if (*(a1 + 5) - (v67 + 2) > 3)
                  {
                    HIDWORD(v136[1]) = *(*a1 + (v67 + 2));
                    *(a1 + 6) = v67 + 6;
                    if (*(a1 + 5) - (v67 + 6) > 3)
                    {
                      LODWORD(v136[2]) = *(*a1 + (v67 + 6));
                      *(a1 + 6) = v67 + 10;
                      if (*(a1 + 5) - (v67 + 10) >= 4)
                      {
                        DWORD1(v136[2]) = *(*a1 + (v67 + 10));
                        v62 = v67 + 14;
                        goto LABEL_132;
                      }

                      goto LABEL_122;
                    }

                    *(a1 + 15) = 1;
                    goto LABEL_121;
                  }

                  *(a1 + 15) = 1;
LABEL_120:
                  sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                  v78 = *(a1 + 14);
                  *(a1 + 15) = 1;
                  if (v78 != 1)
                  {
                    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1231, "(*pBs).__RWFlag == BYTESTREAM_READ");
                  }

LABEL_121:
                  sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_122:
                  *(a1 + 15) = 1;
                  goto LABEL_123;
                }

                *(a1 + 15) = 1;
LABEL_119:
                sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                v77 = *(a1 + 14);
                *(a1 + 15) = 1;
                if (v77 != 1)
                {
                  sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1230, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }

                goto LABEL_120;
              }

              *(a1 + 15) = 1;
LABEL_118:
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
              v76 = *(a1 + 14);
              *(a1 + 15) = 1;
              if (v76 != 1)
              {
                sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1229, "(*pBs).__RWFlag == BYTESTREAM_READ");
              }

              goto LABEL_119;
            }

            *(a1 + 15) = 1;
          }

          else
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            v69 = *(a1 + 14);
            *(a1 + 15) = 1;
            if (v69 != 1)
            {
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1227, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
          }

          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v75 = *(a1 + 14);
          *(a1 + 15) = 1;
          if (v75 != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1228, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          goto LABEL_118;
        }

        if (v26 == 7)
        {
          LODWORD(v136[0]) |= 0x40u;
          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1234, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if (v34)
          {
            v43 = *(a1 + 6);
            if (*(a1 + 5) - v43 >= 2)
            {
              WORD4(v136[2]) = *(*a1 + v43);
              goto LABEL_91;
            }

            goto LABEL_122;
          }

          goto LABEL_121;
        }
      }

      else
      {
        if (v26 == 4)
        {
          LODWORD(v136[0]) |= 8u;
          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1215, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if (v34)
          {
            v56 = *(a1 + 6);
            if (*(a1 + 5) > v56)
            {
              v57 = *a1;
              *(a1 + 6) = v56 + 1;
              BYTE10(v136[0]) = *(v57 + v56);
              if (*(a1 + 5) > (v56 + 1))
              {
                v58 = *a1;
                v59 = v56 + 2;
                *(a1 + 6) = v56 + 2;
                BYTE11(v136[0]) = *(v58 + v56 + 1);
                if (*(a1 + 5) > (v56 + 2))
                {
                  v60 = *a1;
                  v61 = v56 + 3;
                  *(a1 + 6) = v61;
                  BYTE12(v136[0]) = *(v60 + v59);
                  if (*(a1 + 5) - v61 > 1)
                  {
                    HIWORD(v136[0]) = *(*a1 + v61);
                    *(a1 + 6) = v61 + 2;
                    if (*(a1 + 5) - (v61 + 2) > 1)
                    {
                      LOWORD(v136[1]) = *(*a1 + (v61 + 2));
                      *(a1 + 6) = v61 + 4;
                      if (*(a1 + 5) - (v61 + 4) >= 2)
                      {
                        WORD1(v136[1]) = *(*a1 + (v61 + 4));
                        v62 = v61 + 6;
                        goto LABEL_132;
                      }

                      goto LABEL_122;
                    }

                    *(a1 + 15) = 1;
                    goto LABEL_121;
                  }

                  *(a1 + 15) = 1;
                  goto LABEL_114;
                }

                *(a1 + 15) = 1;
LABEL_113:
                sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                v73 = *(a1 + 14);
                *(a1 + 15) = 1;
                if (v73 != 1)
                {
                  sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1219, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }

LABEL_114:
                sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                v74 = *(a1 + 14);
                *(a1 + 15) = 1;
                if (v74 != 1)
                {
                  sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1220, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }

                goto LABEL_121;
              }

              *(a1 + 15) = 1;
LABEL_112:
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
              v72 = *(a1 + 14);
              *(a1 + 15) = 1;
              if (v72 != 1)
              {
                sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1218, "(*pBs).__RWFlag == BYTESTREAM_READ");
              }

              goto LABEL_113;
            }

            *(a1 + 15) = 1;
          }

          else
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            v68 = *(a1 + 14);
            *(a1 + 15) = 1;
            if (v68 != 1)
            {
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1216, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }
          }

          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v71 = *(a1 + 14);
          *(a1 + 15) = 1;
          if (v71 != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1217, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          goto LABEL_112;
        }

        if (v26 == 5)
        {
          LODWORD(v136[0]) |= 0x10u;
          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1223, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if ((v34 & 1) == 0)
          {
            goto LABEL_121;
          }

          v35 = *(a1 + 6);
          if (*(a1 + 5) <= v35)
          {
            goto LABEL_122;
          }

          v36 = *a1;
          *(a1 + 6) = v35 + 1;
          BYTE4(v136[1]) = *(v36 + v35);
          goto LABEL_123;
        }
      }

      if (v32 < 0)
      {
        if (v34)
        {
          v70 = *(a1 + 5) - *(a1 + 6);
        }

        else
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v70 = 0;
        }

        if (v70 >= v25)
        {
          v62 = *(a1 + 6) + v25;
          goto LABEL_132;
        }

        goto LABEL_122;
      }

      if (!v27)
      {
        v27 = sub_100007618(size, 0x1000040BDFB0063uLL);
        if (!v27)
        {
          if (sub_10000C240())
          {
            sub_10000AF54("Unable to allocate buffer for unknown opts", v121, v122, v123, v124, v125, v126, v127, v129);
            v128 = sub_10000C050(0x2Fu);
            if (os_log_type_enabled(v128, OS_LOG_TYPE_ERROR))
            {
              sub_100815984();
            }

            v80 = 0;
            v15 = 104;
          }

          else
          {
            v80 = 0;
            v15 = 104;
          }

          goto LABEL_146;
        }
      }

      if (v135 < (v28 + 2 + v25))
      {
        if (sub_10000C240())
        {
          sub_10000AF54("Bogus length in unknown option - must be corrupt packet", v112, v113, v114, v115, v116, v117, v118, v129);
          v119 = sub_10000C050(0x2Fu);
          v80 = v27;
          if (os_log_type_enabled(v119, OS_LOG_TYPE_ERROR))
          {
            sub_1008158FC();
          }
        }

        else
        {
          v80 = v27;
        }

        goto LABEL_145;
      }

      v45 = a3;
      v27[v28] = v26;
      v27[v28 + 1] = v25;
      memmove(&v27[v28 + 2], (*a1 + *(a1 + 6)), v25);
      v28 += v25 + 2;
      v46 = sub_10000C240();
      if (v28 > 0x5Du)
      {
        if (v46)
        {
          sub_10000AF54("Buffers can not accomedate unknownOptsLen %d, optionLen %d", v47, v48, v49, v50, v51, v52, v53, v28);
          v120 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v120, OS_LOG_TYPE_ERROR))
          {
            sub_10080F604();
          }
        }

        v80 = v27;
        v15 = 428;
        goto LABEL_146;
      }

      if (v46)
      {
        sub_10000AF54("Received config request with unknown option (%d), optionLen %d, unknownOptsLen %d", v47, v48, v49, v50, v51, v52, v53, v26);
        v54 = sub_10000C050(0x2Fu);
        if (os_log_type_enabled(v54, OS_LOG_TYPE_ERROR))
        {
          v79 = sub_10000C0FC();
          *buf = 136446466;
          *&buf[4] = v79;
          v138 = 1024;
          v139 = 463;
          _os_log_error_impl(&_mh_execute_header, v54, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
        }
      }

      if (*(a1 + 15))
      {
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        v55 = 0;
      }

      else
      {
        v55 = *(a1 + 5) - *(a1 + 6);
      }

      a3 = v45;
      v14 = v134;
      if (v55 >= v25)
      {
        *(a1 + 6) += v25;
      }

      else
      {
        *(a1 + 15) = 1;
      }

LABEL_123:
      v24 = *(a1 + 6);
      if (v14 <= v24)
      {
        goto LABEL_142;
      }
    }
  }

  v80 = 0;
LABEL_143:
  if (a3 >= 4)
  {
    if (*(a1 + 15))
    {
LABEL_145:
      v15 = 411;
      goto LABEL_146;
    }

    if (!v80)
    {
      sub_100292C94(a4, a2, v11, v13, v136);
      return;
    }

    *buf = 0;
    if (sub_1000ABC7C(v11, buf))
    {
      if (sub_10000C240())
      {
        sub_10000AF54("cid %d not found", v99, v100, v101, v102, v103, v104, v105, v11);
        v106 = sub_10000C050(0x2Fu);
        if (os_log_type_enabled(v106, OS_LOG_TYPE_ERROR))
        {
          sub_1008148EC();
        }
      }
    }

    else
    {
      v107 = *sub_1000B12AC(*buf);
      v108 = sub_1000B12AC(*buf);
      sub_1002AB810("aaad", 5u, 0, v107, a2, v109, v110, v111, *(v108 + 8));
    }

    goto LABEL_154;
  }

LABEL_146:
  if (sub_10000C240())
  {
    sub_10000AF54("SignalMan_RecvConfigReq %!", v81, v82, v83, v84, v85, v86, v87, v15);
    v88 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v88, OS_LOG_TYPE_ERROR))
    {
      sub_10080F604();
    }
  }

  if (v15 != 428 || (v89 = sub_10023BA68(a4 + 48), !v89) || (v90 = v89, !sub_10000C240()) || (sub_10000AF54("Failed to forced disconnect %!", v91, v92, v93, v94, v95, v96, v97, v90), v98 = sub_10000C050(0x2Fu), !os_log_type_enabled(v98, OS_LOG_TYPE_ERROR)))
  {
    if (!v80)
    {
      return;
    }

    goto LABEL_154;
  }

  sub_10080F604();
  if (v80)
  {
LABEL_154:
    sub_10000C1E8(v80);
  }
}

void sub_1002AF55C(uint64_t *a1, unsigned int a2, int a3, uint64_t a4)
{
  v73 = 0;
  v72 = 0;
  memset(v71, 0, 44);
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v8 = 0;
  }

  else
  {
    v8 = *(a1 + 5) - *(a1 + 6);
  }

  if (v8 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1334, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1340, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  v9 = *(a1 + 6);
  v67 = a2;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v10 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v10 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1341, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_14;
  }

  if (*(a1 + 5) - v9 <= 1)
  {
    *(a1 + 15) = 1;
LABEL_14:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v14 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v14 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1345, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    v65 = 0;
    goto LABEL_16;
  }

  v65 = *(*a1 + v9);
  *(a1 + 6) = v9 + 2;
  if (*(a1 + 5) - (v9 + 2) <= 1)
  {
    *(a1 + 15) = 1;
LABEL_16:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v64 = 0;
    LOWORD(v12) = *(a1 + 6);
    goto LABEL_17;
  }

  v11 = *(*a1 + (v9 + 2));
  LOWORD(v12) = v9 + 4;
  *(a1 + 6) = v9 + 4;
  v64 = v11 & 1;
  if (*(a1 + 5) - (v9 + 4) > 1)
  {
    v13 = 0;
    v63 = *(*a1 + (v9 + 4));
    LOWORD(v12) = v9 + 6;
    *(a1 + 6) = v9 + 6;
    goto LABEL_18;
  }

LABEL_17:
  v63 = 0;
  v13 = 1;
  *(a1 + 15) = 1;
LABEL_18:
  v66 = a4;
  v15 = v9 + a3;
  if (v9 + a3 > v12)
  {
    v16 = 0;
    v17 = 0;
    v18 = 0;
    v19 = 0;
    v69 = 0;
    v70 = 0;
    v68 = 0;
    while (1)
    {
      if (*(a1 + 15))
      {
        goto LABEL_102;
      }

      if (*(a1 + 14) != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1349, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      v20 = *(a1 + 5);
      if (v20 <= v12)
      {
        *(a1 + 15) = 1;
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      }

      else
      {
        v21 = *a1;
        *(a1 + 6) = v12 + 1;
        v17 = *(v21 + v12);
        if (v20 > (v12 + 1))
        {
          v22 = *a1;
          *(a1 + 6) = v12 + 2;
          v16 = *(v22 + v12 + 1);
          v23 = 1;
          goto LABEL_27;
        }
      }

      v23 = 0;
      *(a1 + 15) = 1;
LABEL_27:
      if (v17 > 2)
      {
        if (v17 == 3)
        {
          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1372, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if (v23)
          {
            v29 = *(a1 + 5);
            v30 = *(a1 + 6);
            if (v29 > v30)
            {
              v31 = *a1;
              *(a1 + 6) = v30 + 1;
              HIBYTE(v72) = *(v31 + v30);
              v32 = v29 - (v30 + 1);
LABEL_65:
              if (v32 >= v16 - 1)
              {
                *(a1 + 6) += v16 - 1;
              }

              else
              {
                *(a1 + 15) = 1;
              }

              v68 = &v72 + 1;
              goto LABEL_95;
            }
          }

          else
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          }

          *(a1 + 15) = 1;
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v32 = 0;
          goto LABEL_65;
        }

        if (v17 != 4)
        {
          if (v17 != 5)
          {
            goto LABEL_58;
          }

          if (*(a1 + 14) != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1376, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }

          if (v23)
          {
            v24 = *(a1 + 5);
            v25 = *(a1 + 6);
            if (v24 > v25)
            {
              v26 = *a1;
              *(a1 + 6) = v25 + 1;
              LOBYTE(v72) = *(v26 + v25);
              v27 = v24 - (v25 + 1);
LABEL_76:
              if (v27 >= v16 - 1)
              {
                *(a1 + 6) += v16 - 1;
              }

              else
              {
                *(a1 + 15) = 1;
              }

              v19 = &v72;
              goto LABEL_95;
            }
          }

          else
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          }

          *(a1 + 15) = 1;
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v27 = 0;
          goto LABEL_76;
        }

        if (*(a1 + 14) != 1)
        {
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1362, "(*pBs).__RWFlag == BYTESTREAM_READ");
        }

        if (v23)
        {
          v33 = *(a1 + 6);
          if (*(a1 + 5) > v33)
          {
            v34 = *a1;
            *(a1 + 6) = v33 + 1;
            BYTE10(v71[0]) = *(v34 + v33);
            if (*(a1 + 5) > (v33 + 1))
            {
              v35 = *a1;
              v36 = v33 + 2;
              *(a1 + 6) = v33 + 2;
              BYTE11(v71[0]) = *(v35 + v33 + 1);
              if (*(a1 + 5) > (v33 + 2))
              {
                v37 = *a1;
                v38 = v33 + 3;
                *(a1 + 6) = v38;
                BYTE12(v71[0]) = *(v37 + v36);
                if (*(a1 + 5) - v38 > 1)
                {
                  HIWORD(v71[0]) = *(*a1 + v38);
                  *(a1 + 6) = v38 + 2;
                  if (*(a1 + 5) - (v38 + 2) > 1)
                  {
                    LOWORD(v71[1]) = *(*a1 + (v38 + 2));
                    *(a1 + 6) = v38 + 4;
                    if (*(a1 + 5) - (v38 + 4) >= 2)
                    {
                      WORD1(v71[1]) = *(*a1 + (v38 + 4));
                      *(a1 + 6) = v38 + 6;
LABEL_94:
                      v18 = v71;
                      goto LABEL_95;
                    }

LABEL_93:
                    *(a1 + 15) = 1;
                    goto LABEL_94;
                  }

                  *(a1 + 15) = 1;
LABEL_92:
                  sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                  goto LABEL_93;
                }

                *(a1 + 15) = 1;
LABEL_91:
                sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
                v53 = *(a1 + 14);
                *(a1 + 15) = 1;
                if (v53 != 1)
                {
                  sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1367, "(*pBs).__RWFlag == BYTESTREAM_READ");
                }

                goto LABEL_92;
              }

              *(a1 + 15) = 1;
LABEL_90:
              sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
              v52 = *(a1 + 14);
              *(a1 + 15) = 1;
              if (v52 != 1)
              {
                sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1366, "(*pBs).__RWFlag == BYTESTREAM_READ");
              }

              goto LABEL_91;
            }

            *(a1 + 15) = 1;
LABEL_89:
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            v51 = *(a1 + 14);
            *(a1 + 15) = 1;
            if (v51 != 1)
            {
              sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1365, "(*pBs).__RWFlag == BYTESTREAM_READ");
            }

            goto LABEL_90;
          }

          *(a1 + 15) = 1;
        }

        else
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
          v49 = *(a1 + 14);
          *(a1 + 15) = 1;
          if (v49 != 1)
          {
            sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1363, "(*pBs).__RWFlag == BYTESTREAM_READ");
          }
        }

        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        v50 = *(a1 + 14);
        *(a1 + 15) = 1;
        if (v50 != 1)
        {
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1364, "(*pBs).__RWFlag == BYTESTREAM_READ");
        }

        goto LABEL_89;
      }

      if (v17 != 1)
      {
        if (v17 != 2)
        {
LABEL_58:
          if (sub_10000C240())
          {
            sub_10000AF54("rcvd config rsp with unknown option (%d) len %d, ignoring option", v40, v41, v42, v43, v44, v45, v46, v17);
            v47 = sub_10000C050(0x2Fu);
            if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
            {
              v54 = sub_10000C0FC();
              *buf = 136446466;
              v75 = v54;
              v76 = 1024;
              v77 = 0xFFFF;
              _os_log_error_impl(&_mh_execute_header, v47, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }

          if (*(a1 + 15))
          {
            sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
            v48 = 0;
          }

          else
          {
            v48 = *(a1 + 5) - *(a1 + 6);
          }

          if (v48 >= v16)
          {
            *(a1 + 6) += v16;
          }

          else
          {
            *(a1 + 15) = 1;
          }

          goto LABEL_95;
        }

        if (*(a1 + 14) != 1)
        {
          sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1357, "(*pBs).__RWFlag == BYTESTREAM_READ");
        }

        if (v23)
        {
          v28 = *(a1 + 6);
          if (*(a1 + 5) - v28 >= 2)
          {
            LOWORD(v73) = *(*a1 + v28);
            *(a1 + 6) = v28 + 2;
LABEL_82:
            v70 = &v73;
            goto LABEL_95;
          }
        }

        else
        {
          sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
        }

        *(a1 + 15) = 1;
        goto LABEL_82;
      }

      if (*(a1 + 14) != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1353, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      if ((v23 & 1) == 0)
      {
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_72:
        *(a1 + 15) = 1;
        goto LABEL_73;
      }

      v39 = *(a1 + 6);
      if (*(a1 + 5) - v39 < 2)
      {
        goto LABEL_72;
      }

      HIWORD(v73) = *(*a1 + v39);
      *(a1 + 6) = v39 + 2;
LABEL_73:
      v69 = &v73 + 2;
LABEL_95:
      v12 = *(a1 + 6);
      if (v15 <= v12)
      {
        if (*(a1 + 15))
        {
          goto LABEL_102;
        }

        goto LABEL_106;
      }
    }
  }

  v68 = 0;
  v69 = 0;
  v70 = 0;
  v19 = 0;
  v18 = 0;
  if (v13)
  {
LABEL_102:
    if (sub_10000C240())
    {
      sub_10000AF54("SignalMan_RecvConfigRsp - %!", v55, v56, v57, v58, v59, v60, v61, 411);
      v62 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v62, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }
  }

  else
  {
LABEL_106:
    sub_1002935A4(v66, v67, v65, v64, v69, v68, v70, v18, v19, v63);
  }
}

void sub_1002AFEC4(uint64_t a1, uint64_t a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v14 = 771;
  v13 = 0;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1120, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (!sub_100303B64(a1, 1u, &v14, 2u, a5, a6, a7, a8, &v13))
  {
    sub_100293948(a4, v13, 0, a2);
  }
}

void sub_1002AFF9C(uint64_t a1, uint64_t a2, int a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v13 = 771;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v11 = 0;
  }

  else
  {
    v11 = *(a1 + 10) - *(a1 + 12);
  }

  if (v11 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1140, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  v12 = 0;
  if (!sub_100303B64(a1, 1u, &v13, 2u, a5, a6, a7, a8, &v12))
  {
    sub_100293D68(a4, v12, 0);
  }
}

void sub_1002B0074(uint64_t *a1, uint64_t a2, uint64_t a3, _BYTE *a4)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v8 = 0;
  }

  else
  {
    v8 = *(a1 + 5) - *(a1 + 6);
  }

  if (v8 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1407, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  v25 = 0;
  v24 = 0;
  if (sub_10023DC00(a4, &v24))
  {
    if (sub_10000C240())
    {
      sub_10000AF54("getBdaddrFromHandle failed", v12, v13, v14, v15, v16, v17, v18, v23);
      v19 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }
  }

  else if (a3 >= 0x18 && off_100B61158)
  {
    off_100B61158(*a1, *(a1 + 5), a3, a2, a4);
  }

  else
  {
    v20 = *a1;
    v21 = *(a1 + 6);
    if (a3 == 5 && (*(v20 + v21) == 1819308097 ? (v22 = *(v20 + v21 + 4) == 101) : (v22 = 0), v22))
    {
      sub_1002AB810("d", 9u, 0, a4, a2, v9, v10, v11, "Apple Computer Inc.");
    }

    else
    {
      sub_1002AB810("d", 9u, 0, a4, a2, v9, v10, v11, v20 + v21);
    }
  }
}

void sub_1002B020C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v6 = 0;
  }

  else
  {
    v6 = *(a1 + 10) - *(a1 + 12);
  }

  if (v6 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1444, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  v7 = qword_100B61160;
  if (!qword_100B61160)
  {
    goto LABEL_15;
  }

  while (*(v7 + 153) != a2)
  {
    v7 = *(v7 + 192);
    if (!v7)
    {
      goto LABEL_15;
    }
  }

  if (*(v7 + 152) == 8)
  {
    v8 = *(v7 + 200);
    if (!v8)
    {
      sub_1000D660C();
      v8 = *(v7 + 200);
    }

    v8(v7 + 180, *(v7 + 168), *(v7 + 208), *(v7 + 216), *a1 + *(a1 + 12), a3, 0);

    sub_1002AD6D0(v7, 0);
  }

  else
  {
LABEL_15:
    if (sub_10000C240())
    {
      sub_10000AF54("Unexpected Echo Response (id %d)", v9, v10, v11, v12, v13, v14, v15, a2);
      v16 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
      {
        sub_100815A0C();
      }
    }
  }
}

void sub_1002B0370(uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v29 = 0;
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1471, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1473, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_13;
  }

  v13 = *(a1 + 12);
  if (*(a1 + 10) - v13 < 2)
  {
LABEL_13:
    *(a1 + 15) = 1;
    if (sub_10000C240())
    {
      sub_10000AF54("SignalMan_RecvInfoReq - %!", v15, v16, v17, v18, v19, v20, v21, 411);
      v22 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }

    return;
  }

  v14 = *(*a1 + v13);
  *(a1 + 12) = v13 + 2;
  switch(v14)
  {
    case 3:
      v30 = 0;
      if (sub_10028E064(&v30))
      {
        if (sub_10000C240())
        {
          sub_10000AF54("Error retreiving the supported fixed channels", v23, v24, v25, v26, a6, a7, a8, v28);
          v27 = sub_10000C050(0x2Fu);
          if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
          {
            sub_1000E09C0();
          }
        }
      }

      v14 = 3;
      break;
    case 2:
      sub_1002AB4B8(&v29);
      v14 = 2;
      break;
    case 1:
      sub_1003045A0(0x2Fu);
      v14 = 1;
      break;
  }

  sub_1002AB810("aad", 0xBu, 0, a4, a2, a6, a7, a8, v14);
}

void sub_1002B05D8(uint64_t *a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v8 = 0;
  }

  else
  {
    v8 = *(a1 + 5) - *(a1 + 6);
  }

  if (v8 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1539, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 <= 3)
  {
    sub_1000D660C();
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v9 = 0;
  }

  else
  {
    v9 = *(a1 + 5) - *(a1 + 6);
  }

  v10 = a3 - 4;
  if (a3 < 4 || v9 < a3)
  {
    if (sub_10000C240())
    {
      if (*(a1 + 15))
      {
        sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      }

      sub_10000AF54("Invalid RecvInfoRsp input: cmdLen %d, NumReadBytesAvail %d.  Disconecting physical link.", v12, v13, v14, v15, v16, v17, v18, a3);
      v27 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        sub_10080F604();
      }
    }

    sub_10023BD60(a4 + 48);
    return;
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1548, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v11 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v11 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1549, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_27;
  }

  v19 = *(a1 + 6);
  if (*(a1 + 5) - v19 <= 1)
  {
    *(a1 + 15) = 1;
LABEL_27:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v21 = 0;
    v20 = *a1;
    v22 = *(a1 + 6);
    goto LABEL_28;
  }

  v20 = *a1;
  v21 = *(*a1 + v19);
  v22 = v19 + 2;
  *(a1 + 6) = v19 + 2;
  if (*(a1 + 5) - (v19 + 2) < 2)
  {
LABEL_28:
    *(a1 + 15) = 1;
    v26 = v20 + v22;
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v28 = 0;
    goto LABEL_29;
  }

  v23 = *(v20 + (v19 + 2));
  v24 = v19 + 4;
  *(a1 + 6) = v19 + 4;
  if (!v23)
  {
    v26 = v20 + v24;
    v28 = *(a1 + 5) - v24;
LABEL_29:
    v23 = 0;
    if (v28 >= v10)
    {
      *(a1 + 6) += v10;
      v25 = 1;
    }

    else
    {
      v25 = 1;
      *(a1 + 15) = 1;
    }

    goto LABEL_32;
  }

  v25 = 0;
  v26 = 0;
  v10 = 0;
LABEL_32:
  v29 = qword_100B61160;
  if (!qword_100B61160)
  {
    goto LABEL_41;
  }

  while (*(v29 + 153) != a2)
  {
    v29 = *(v29 + 192);
    if (!v29)
    {
      goto LABEL_41;
    }
  }

  if (*(v29 + 152) == 10)
  {
    sub_10002242C(*(v29 + 176));
    if (!*(v29 + 208))
    {
      sub_1000D660C();
    }

    if (*(a1 + 15))
    {
      v30 = v29;
      v31 = 411;
    }

    else
    {
      if (v25)
      {
        v40 = 0;
      }

      else
      {
        v40 = (v23 + 470);
      }

      (*(v29 + 208))(v29 + 180, *(v29 + 168), v21, v26, v10, v40);
      v30 = v29;
      v31 = 0;
    }

    sub_1002AD6D0(v30, v31);
  }

  else
  {
LABEL_41:
    if (sub_10000C240())
    {
      sub_10000AF54("Unexpected Info Response (id %d)", v32, v33, v34, v35, v36, v37, v38, a2);
      v39 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v39, OS_LOG_TYPE_ERROR))
      {
        sub_100815A0C();
      }
    }
  }
}

uint64_t sub_1002B099C(uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1586, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 == 5)
  {
    if (*(a1 + 14) != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1589, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      v13 = *(a1 + 14);
      *(a1 + 15) = 1;
      if (v13 != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1590, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      goto LABEL_18;
    }

    v19 = *(a1 + 12);
    if (*(a1 + 10) - v19 <= 1)
    {
      *(a1 + 15) = 1;
LABEL_18:
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      v20 = *(a1 + 14);
      *(a1 + 15) = 1;
      if (v20 != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1591, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      goto LABEL_19;
    }

    *(a1 + 12) = v19 + 2;
    if (*(a1 + 10) - (v19 + 2) <= 1)
    {
      *(a1 + 15) = 1;
LABEL_19:
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_20;
    }

    *(a1 + 12) = v19 + 4;
    if (*(a1 + 10) <= (v19 + 4))
    {
LABEL_20:
      *(a1 + 15) = 1;
      return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
    }

    *(a1 + 12) = v19 + 5;
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("Wrong command size for channel creation command", v14, v15, v16, v17, a6, a7, a8, v22);
    v18 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      sub_1000E09C0();
    }
  }

  return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
}

void sub_1002B0BD4(uint64_t a1, uint64_t a2, int a3)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v6 = 0;
  }

  else
  {
    v6 = *(a1 + 10) - *(a1 + 12);
  }

  if (v6 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1618, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 != 8)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Wrong command size for channel creation response", v8, v9, v10, v11, v12, v13, v14, v29);
      v15 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }

    goto LABEL_23;
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1621, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v7 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v7 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1622, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_19;
  }

  v16 = *(a1 + 12);
  if (*(a1 + 10) - v16 <= 1)
  {
    *(a1 + 15) = 1;
LABEL_19:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v17 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v17 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1623, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_20;
  }

  *(a1 + 12) = v16 + 2;
  if (*(a1 + 10) - (v16 + 2) <= 1)
  {
    *(a1 + 15) = 1;
LABEL_20:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v18 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v18 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1624, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_21;
  }

  *(a1 + 12) = v16 + 4;
  if (*(a1 + 10) - (v16 + 4) <= 1)
  {
    *(a1 + 15) = 1;
LABEL_21:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_22;
  }

  *(a1 + 12) = v16 + 6;
  if (*(a1 + 10) - (v16 + 6) < 2)
  {
LABEL_22:
    *(a1 + 15) = 1;
    goto LABEL_23;
  }

  *(a1 + 12) = v16 + 8;
LABEL_23:
  v19 = qword_100B61160;
  if (!qword_100B61160)
  {
    goto LABEL_30;
  }

  while (*(v19 + 153) != a2)
  {
    v19 = *(v19 + 192);
    if (!v19)
    {
      goto LABEL_30;
    }
  }

  if (*(v19 + 152) == 12)
  {
    sub_10002242C(*(v19 + 176));
    if (*(a1 + 15))
    {
      v20 = 411;
    }

    else
    {
      v20 = 0;
    }

    sub_1002AD6D0(v19, v20);
  }

  else
  {
LABEL_30:
    if (sub_10000C240())
    {
      sub_10000AF54("Unexpected create channel Response (id %d)", v21, v22, v23, v24, v25, v26, v27, a2);
      v28 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
      {
        sub_100815A0C();
      }
    }
  }
}

uint64_t sub_1002B0EE4(uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1657, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 == 3)
  {
    if (*(a1 + 14) != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1660, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      v13 = *(a1 + 14);
      *(a1 + 15) = 1;
      if (v13 != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1661, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      goto LABEL_17;
    }

    v19 = *(a1 + 12);
    if (*(a1 + 10) - v19 <= 1)
    {
      *(a1 + 15) = 1;
LABEL_17:
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_18;
    }

    *(a1 + 12) = v19 + 2;
    if (*(a1 + 10) <= (v19 + 2))
    {
LABEL_18:
      *(a1 + 15) = 1;
      return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
    }

    *(a1 + 12) = v19 + 3;
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("Wrong command size for channel move command", v14, v15, v16, v17, a6, a7, a8, v21);
    v18 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      sub_1000E09C0();
    }
  }

  return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
}

void sub_1002B10B4(uint64_t a1, uint64_t a2, int a3)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v6 = 0;
  }

  else
  {
    v6 = *(a1 + 10) - *(a1 + 12);
  }

  if (v6 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1681, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 != 4)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Wrong command size for channel move response", v8, v9, v10, v11, v12, v13, v14, v27);
      v15 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }

    goto LABEL_19;
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1684, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v7 = *(a1 + 14);
    *(a1 + 15) = 1;
    if (v7 != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1685, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    goto LABEL_17;
  }

  v16 = *(a1 + 12);
  if (*(a1 + 10) - v16 <= 1)
  {
    *(a1 + 15) = 1;
LABEL_17:
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    goto LABEL_18;
  }

  *(a1 + 12) = v16 + 2;
  if (*(a1 + 10) - (v16 + 2) < 2)
  {
LABEL_18:
    *(a1 + 15) = 1;
    goto LABEL_19;
  }

  *(a1 + 12) = v16 + 4;
LABEL_19:
  v17 = qword_100B61160;
  if (!qword_100B61160)
  {
    goto LABEL_26;
  }

  while (*(v17 + 153) != a2)
  {
    v17 = *(v17 + 192);
    if (!v17)
    {
      goto LABEL_26;
    }
  }

  if (*(v17 + 152) == 14)
  {
    sub_10002242C(*(v17 + 176));
    if (*(a1 + 15))
    {
      v18 = 411;
    }

    else
    {
      v18 = 0;
    }

    sub_1002AD6D0(v17, v18);
  }

  else
  {
LABEL_26:
    if (sub_10000C240())
    {
      sub_10000AF54("Unexpected create channel Response (id %d)", v19, v20, v21, v22, v23, v24, v25, a2);
      v26 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
      {
        sub_100815A0C();
      }
    }
  }
}

uint64_t sub_1002B12F4(uint64_t a1, char a2, int a3, _BYTE *a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v12 = 0;
  }

  else
  {
    v12 = *(a1 + 10) - *(a1 + 12);
  }

  if (v12 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1717, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 == 4)
  {
    if (*(a1 + 14) != 1)
    {
      sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1719, "(*pBs).__RWFlag == BYTESTREAM_READ");
    }

    if (*(a1 + 15))
    {
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      v13 = *(a1 + 14);
      *(a1 + 15) = 1;
      if (v13 != 1)
      {
        sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1720, "(*pBs).__RWFlag == BYTESTREAM_READ");
      }

      goto LABEL_17;
    }

    v19 = *(a1 + 12);
    if (*(a1 + 10) - v19 <= 1)
    {
      *(a1 + 15) = 1;
LABEL_17:
      sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
      goto LABEL_18;
    }

    *(a1 + 12) = v19 + 2;
    if (*(a1 + 10) - (v19 + 2) < 2)
    {
LABEL_18:
      *(a1 + 15) = 1;
      return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
    }

    *(a1 + 12) = v19 + 4;
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("Wrong command size for channel move confirmation", v14, v15, v16, v17, a6, a7, a8, v21);
    v18 = sub_10000C050(0x2Fu);
    if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
    {
      sub_1000E09C0();
    }
  }

  return sub_1002AB810("ad", 1u, 0, a4, a2, a6, a7, a8, 0);
}

void sub_1002B14C8(uint64_t a1, uint64_t a2, int a3)
{
  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
    v6 = 0;
  }

  else
  {
    v6 = *(a1 + 10) - *(a1 + 12);
  }

  if (v6 < a3)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1737, "cmdLen <= ByteStream_NumReadBytesAvail(*pBs)");
  }

  if (a3 != 2)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Wrong command size for channel move response", v7, v8, v9, v10, v11, v12, v13, v26);
      v14 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v14, OS_LOG_TYPE_ERROR))
      {
        sub_1000E09C0();
      }
    }

    goto LABEL_15;
  }

  if (*(a1 + 14) != 1)
  {
    sub_1000E78B4("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c", 1740, "(*pBs).__RWFlag == BYTESTREAM_READ");
  }

  if (*(a1 + 15))
  {
    sub_100303A8C("/Library/Caches/com.apple.xbs/Sources/MobileBluetooth_base/Stack/corestack/l2cap/signalman.c");
LABEL_14:
    *(a1 + 15) = 1;
    goto LABEL_15;
  }

  v15 = *(a1 + 12);
  if (*(a1 + 10) - v15 < 2)
  {
    goto LABEL_14;
  }

  *(a1 + 12) = v15 + 2;
LABEL_15:
  v16 = qword_100B61160;
  if (!qword_100B61160)
  {
    goto LABEL_22;
  }

  while (*(v16 + 153) != a2)
  {
    v16 = *(v16 + 192);
    if (!v16)
    {
      goto LABEL_22;
    }
  }

  if (*(v16 + 152) == 16)
  {
    sub_10002242C(*(v16 + 176));
    if (*(a1 + 15))
    {
      v17 = 411;
    }

    else
    {
      v17 = 0;
    }

    sub_1002AD6D0(v16, v17);
  }

  else
  {
LABEL_22:
    if (sub_10000C240())
    {
      sub_10000AF54("Unexpected move channel Confirmation Response (id %d)", v18, v19, v20, v21, v22, v23, v24, a2);
      v25 = sub_10000C050(0x2Fu);
      if (os_log_type_enabled(v25, OS_LOG_TYPE_ERROR))
      {
        sub_100815A0C();
      }
    }
  }
}

void sub_1002B16B4(int a1)
{
  if (sub_10000C240())
  {
    v9 = "incoming connection";
    if (a1)
    {
      v9 = "address change";
    }

    sub_10000AF54("Advertising stopped due to %s", v2, v3, v4, v5, v6, v7, v8, v9);
    v10 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v59 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  byte_100B61169 = 0;
  v11 = byte_100B65338;
  if (byte_100B65338)
  {
    v12 = 0;
    v13 = vdupq_n_s64(byte_100B65338 - 1);
    v14 = 53888 * ((byte_100B65338 + 15) >> 4);
    v15 = xmmword_1008A4930;
    v16 = xmmword_1008A4940;
    v17 = xmmword_1008A4950;
    v18 = xmmword_1008A4960;
    v19 = xmmword_1008A4970;
    v20 = xmmword_1008A4980;
    v21 = xmmword_1008A4990;
    v22 = xmmword_1008A49A0;
    v23 = vdupq_n_s64(0x10uLL);
    do
    {
      v24 = vmovn_s64(vcgeq_u64(v13, v22));
      if (vuzp1_s8(vuzp1_s16(v24, *v13.i8), *v13.i8).u8[0])
      {
        BYTE5(qword_100B61170[v12 / 8 + 417]) = 0;
      }

      if (vuzp1_s8(vuzp1_s16(v24, *&v13), *&v13).i8[1])
      {
        BYTE5(qword_100B61170[v12 / 8 + 838]) = 0;
      }

      if (vuzp1_s8(vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v21))), *&v13).i8[2])
      {
        BYTE5(qword_100B61170[v12 / 8 + 1259]) = 0;
        BYTE5(qword_100B61170[v12 / 8 + 1680]) = 0;
      }

      v25 = vmovn_s64(vcgeq_u64(v13, v20));
      if (vuzp1_s8(*&v13, vuzp1_s16(v25, *&v13)).i32[1])
      {
        BYTE5(qword_100B61170[v12 / 8 + 2101]) = 0;
      }

      if (vuzp1_s8(*&v13, vuzp1_s16(v25, *&v13)).i8[5])
      {
        BYTE5(qword_100B61170[v12 / 8 + 2522]) = 0;
      }

      if (vuzp1_s8(*&v13, vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v19)))).i8[6])
      {
        BYTE5(qword_100B61170[v12 / 8 + 2943]) = 0;
        BYTE5(qword_100B61170[v12 / 8 + 3364]) = 0;
      }

      v26 = vmovn_s64(vcgeq_u64(v13, v18));
      if (vuzp1_s8(vuzp1_s16(v26, *v13.i8), *v13.i8).u8[0])
      {
        BYTE5(qword_100B61170[v12 / 8 + 3785]) = 0;
      }

      if (vuzp1_s8(vuzp1_s16(v26, *&v13), *&v13).i8[1])
      {
        BYTE5(qword_100B61170[v12 / 8 + 4206]) = 0;
      }

      if (vuzp1_s8(vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v17))), *&v13).i8[2])
      {
        BYTE5(qword_100B61170[v12 / 8 + 4627]) = 0;
        BYTE5(qword_100B61170[v12 / 8 + 5048]) = 0;
      }

      v27 = vmovn_s64(vcgeq_u64(v13, v16));
      if (vuzp1_s8(*&v13, vuzp1_s16(v27, *&v13)).i32[1])
      {
        BYTE5(qword_100B61170[v12 / 8 + 5469]) = 0;
      }

      if (vuzp1_s8(*&v13, vuzp1_s16(v27, *&v13)).i8[5])
      {
        BYTE5(qword_100B61170[v12 / 8 + 5890]) = 0;
      }

      if (vuzp1_s8(*&v13, vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v15)))).i8[6])
      {
        BYTE5(qword_100B61170[v12 / 8 + 6311]) = 0;
        BYTE5(qword_100B61170[v12 / 8 + 6732]) = 0;
      }

      v20 = vaddq_s64(v20, v23);
      v21 = vaddq_s64(v21, v23);
      v22 = vaddq_s64(v22, v23);
      v19 = vaddq_s64(v19, v23);
      v18 = vaddq_s64(v18, v23);
      v17 = vaddq_s64(v17, v23);
      v16 = vaddq_s64(v16, v23);
      v12 += 53888;
      v15 = vaddq_s64(v15, v23);
    }

    while (v14 != v12);
    if (byte_100B65339)
    {
      v28 = sub_100018960(207, 0);
      if (v28)
      {
        v29 = v28;
        if (sub_10000C240())
        {
          sub_10000AF54("Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!", v30, v31, v32, v33, v34, v35, v36, v29);
          v37 = sub_10000C050(0x42u);
          if (os_log_type_enabled(v37, OS_LOG_TYPE_ERROR))
          {
            sub_10080F7A0();
          }
        }
      }
    }

    else
    {
      v48 = a1 ^ 1u;
      if (v11 > v48)
      {
        do
        {
          if (sub_1002A48BC())
          {
            if (sub_10000C240())
            {
              sub_10000AF54("Could not stop the LE advertising for instance %d with status %!, but moving forward !", v49, v50, v51, v52, v53, v54, v55, byte_100B6533A[v48]);
              v56 = sub_10000C050(0x42u);
              if (os_log_type_enabled(v56, OS_LOG_TYPE_ERROR))
              {
                v57 = sub_10000C0FC();
                *buf = 136446466;
                v59 = v57;
                v60 = 1024;
                v61 = 0xFFFF;
                _os_log_error_impl(&_mh_execute_header, v56, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
              }
            }
          }

          ++v48;
        }

        while (v48 < byte_100B65338);
      }
    }

    sub_100093054(0);
  }

  else
  {
    if (a1)
    {
      if (!byte_100B61E7D)
      {
        return;
      }

      v38 = sub_100018960(170, sub_1002B1C48);
      if (!v38)
      {
        byte_100B61E7D = 3;
        return;
      }

      v39 = v38;
      if (sub_10000C240())
      {
        sub_10000AF54("Could not stop the LE advertising : %!", v40, v41, v42, v43, v44, v45, v46, v39);
        v47 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v47, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }
    }

    else
    {
      byte_100B61E7D = 0;
    }

    sub_1002B1C48(0);
  }
}

void sub_1002B1C48(uint64_t a1)
{
  byte_100B61E7D = 0;
  if (byte_100B61169 == 1)
  {
    v14 = v1;
    v15 = v2;
    *(v13 + 3) = 0;
    v13[0] = 0;
    sub_1000841FC(v13);
    v3 = sub_100018960(166, sub_1002B1D58);
    if (v3)
    {
      v4 = v3;
      if (sub_10000C240())
      {
        sub_10000AF54("Failed to restart advertising : %!", v5, v6, v7, v8, v9, v10, v11, v4);
        v12 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      sub_100092D80(v4, 0, 0);
    }
  }

  else
  {

    sub_100092D80(a1, 1, 0);
  }
}

void sub_1002B1D58(uint64_t a1)
{
  v1 = a1;
  if (a1 || (v1 = sub_100018960(168, sub_1002B45C0), v1))
  {
    if (sub_10000C240())
    {
      sub_10000AF54("advertisingParametersCb Could not start advertising : %!", v2, v3, v4, v5, v6, v7, v8, v1);
      v9 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    byte_100B61E7D = 0;
    sub_100092D80(v1, 0, 0);
  }
}

uint64_t sub_1002B1E10(int a1)
{
  if (byte_100B61E7D != 2)
  {
    return 0;
  }

  if ((byte_100B61169 & 1) != 0 || a1 && byte_100B6118D != 3)
  {
    return 0;
  }

  result = sub_10008D2E4();
  if (!result)
  {
    byte_100B61169 = 1;
  }

  return result;
}

void sub_1002B1EA4()
{
  if (sub_10000C240())
  {
    sub_10000AF54("Halting advertising and resetting states", v0, v1, v2, v3, v4, v5, v6, v30);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v32 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  byte_100B61169 = 0;
  v8 = byte_100B65338;
  if (byte_100B65338)
  {
    v9 = qword_100B61170;
    do
    {
      *(v9 + 3341) = 0;
      *v9 = 0;
      v9 += 421;
      --v8;
    }

    while (v8);
    if (byte_100B65339)
    {
      v10 = sub_100018960(207, 0, v1, v2, v3, v4, v5, v6, 0);
      if (v10)
      {
        v11 = v10;
        if (sub_10000C240())
        {
          sub_10000AF54("Could not stop the LE advertising OI_HCI_CMD_LE_SetExtendedAdvertisingEnable returned %!", v12, v13, v14, v15, v16, v17, v18, v11);
          v19 = sub_10000C050(0x42u);
          if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
          {
            sub_10080F7A0();
          }
        }
      }

      sub_10008E3CC();
    }

    else
    {
      v20 = 0;
      do
      {
        if (sub_1002A48BC())
        {
          if (sub_10000C240())
          {
            sub_10000AF54("Could not stop the LE advertising for instance %d with status %!, but moving forward !", v21, v22, v23, v24, v25, v26, v27, byte_100B6533A[v20]);
            v28 = sub_10000C050(0x42u);
            if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
            {
              v29 = sub_10000C0FC();
              *buf = 136446466;
              v32 = v29;
              v33 = 1024;
              v34 = 0xFFFF;
              _os_log_error_impl(&_mh_execute_header, v28, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
            }
          }
        }

        ++v20;
      }

      while (v20 < byte_100B65338);
    }
  }

  byte_100B65344 = 0;
  bzero(qword_100B61170, 0x41C8uLL);
}

uint64_t sub_1002B213C(int *a1, unsigned int a2, uint64_t a3)
{
  if (byte_100B65338 <= a2)
  {
    return 120;
  }

  v3 = &byte_100B65345[8 * a2 - a2];
  v4 = *a1;
  *(v3 + 3) = *(a1 + 3);
  *v3 = v4;
  if (byte_100B65339)
  {
    v5 = sub_100018960(203, a3);
    if (v5)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("OI_HCI_CMD_LE_SetAdvertisingSetRandomAddress returned %!", v6, v7, v8, v9, v10, v11, v12, v5);
        v13 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
LABEL_6:
          sub_10080F7A0();
        }
      }
    }
  }

  else
  {
    v5 = sub_1002A4948();
    if (v5)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("BT_VSC_UpdateMultipleAdvInstanceAddress returned %!", v15, v16, v17, v18, v19, v20, v21, v5);
        v22 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_6;
        }
      }
    }
  }

  return v5;
}

uint64_t sub_1002B226C(uint64_t a1, unsigned int a2, unsigned int a3)
{
  v3 = 101;
  if (a2 <= 2 && a3 <= 2)
  {
    v3 = sub_1002A1268();
    if (v3)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("BT_VSC_SetAdvPhyOptions returned %!", v4, v5, v6, v7, v8, v9, v10, v3);
        v11 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v11, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }
    }
  }

  return v3;
}

uint64_t sub_1002B2310(unsigned int a1)
{
  if (byte_100B65338 <= a1)
  {
    return 0;
  }

  else
  {
    return byte_100B6533A[a1];
  }
}

uint64_t sub_1002B2338(uint64_t (*a1)(void, void, void))
{
  if (off_100B65370)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Already initializing", v1, v2, v3, v4, v5, v6, v7, v45);
      v8 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v8, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    return 408;
  }

  if (byte_100B65338)
  {
    return 140;
  }

  bzero(qword_100B61170, 0x41C8uLL);
  off_100B65370 = a1;
  if (byte_100B65339 == 1)
  {
    v12 = byte_100B61168;
    byte_100B65338 = byte_100B61168;
    __memset_chk();
    if (v12)
    {
      v13 = vdupq_n_s64(v12 - 1);
      v14 = xmmword_1008A4930;
      v15 = xmmword_1008A4940;
      v16 = xmmword_1008A4950;
      v17 = xmmword_1008A4960;
      v18 = xmmword_1008A4970;
      v19 = xmmword_1008A4980;
      v20 = xmmword_1008A4990;
      v21 = &dword_100B65340 + 1;
      v22 = 15;
      v23 = xmmword_1008A49A0;
      v24 = vdupq_n_s64(0x10uLL);
      do
      {
        v25 = v22 - 15;
        v26 = vmovn_s64(vcgeq_u64(v13, v23));
        if (vuzp1_s8(vuzp1_s16(v26, *v13.i8), *v13.i8).u8[0])
        {
          *(v21 - 7) = v25;
        }

        if (vuzp1_s8(vuzp1_s16(v26, *&v13), *&v13).i8[1])
        {
          *(v21 - 6) = v25 | 1;
        }

        if (vuzp1_s8(vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v20))), *&v13).i8[2])
        {
          *(v21 - 5) = v25 | 2;
          *(v21 - 4) = v25 | 3;
        }

        v27 = vmovn_s64(vcgeq_u64(v13, v19));
        if (vuzp1_s8(*&v13, vuzp1_s16(v27, *&v13)).i32[1])
        {
          *(v21 - 3) = v25 | 4;
        }

        if (vuzp1_s8(*&v13, vuzp1_s16(v27, *&v13)).i8[5])
        {
          *(v21 - 2) = v25 | 5;
        }

        if (vuzp1_s8(*&v13, vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v18)))).i8[6])
        {
          *(v21 - 1) = v25 | 6;
          *v21 = v25 | 7;
        }

        v28 = vmovn_s64(vcgeq_u64(v13, v17));
        if (vuzp1_s8(vuzp1_s16(v28, *v13.i8), *v13.i8).u8[0])
        {
          v21[1] = v25 | 8;
        }

        if (vuzp1_s8(vuzp1_s16(v28, *&v13), *&v13).i8[1])
        {
          v21[2] = v25 | 9;
        }

        if (vuzp1_s8(vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v16))), *&v13).i8[2])
        {
          v21[3] = v25 | 0xA;
          v21[4] = v25 | 0xB;
        }

        v29 = vmovn_s64(vcgeq_u64(v13, v15));
        if (vuzp1_s8(*&v13, vuzp1_s16(v29, *&v13)).i32[1])
        {
          v21[5] = v25 | 0xC;
        }

        if (vuzp1_s8(*&v13, vuzp1_s16(v29, *&v13)).i8[5])
        {
          v21[6] = v25 | 0xD;
        }

        if (vuzp1_s8(*&v13, vuzp1_s16(*&v13, vmovn_s64(vcgeq_u64(v13, *&v14)))).i8[6])
        {
          v21[7] = v25 | 0xE;
          v21[8] = v25 | 0xF;
        }

        v19 = vaddq_s64(v19, v24);
        v20 = vaddq_s64(v20, v24);
        v23 = vaddq_s64(v23, v24);
        v18 = vaddq_s64(v18, v24);
        v17 = vaddq_s64(v17, v24);
        v16 = vaddq_s64(v16, v24);
        v15 = vaddq_s64(v15, v24);
        v14 = vaddq_s64(v14, v24);
        v22 += 16;
        v21 += 16;
      }

      while (v22 - ((v12 + 15) & 0x1F0) != 15);
    }

    sub_1002D2704(0, &unk_100B65361);
    if (!sub_100018960(208, sub_1002B2790, v30, v31, v32, v33, v34, v35, v45))
    {
      return 0;
    }

    sub_1000D660C();
    v48 = 105;
    v47[1] = &v48;
    v47[0] = 4;
    v36 = sub_10002195C(sub_1002B28A8, v47, 0, 0);
    if (!v36)
    {
      return 105;
    }

    v9 = v36;
    if (sub_10000C240())
    {
      sub_10000AF54("Could not register dispatchReadRemoteVersionInformation", v37, v38, v39, v40, v41, v42, v43, v46);
      v44 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v44, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    return v9;
  }

  return sub_1002A4600();
}

void sub_1002B2790(int a1, unsigned int a2)
{
  v20 = a1;
  if (a1)
  {
    a2 = word_100B6537A;
  }

  else
  {
    word_100B6537A = a2;
  }

  if (a2 >= 0x673)
  {
    sub_1000D660C();
    if (word_100B6537A >= 0x673u)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("fControllerMaxExtendedAdvertisingPayloadSize=%d", v2, v3, v4, v5, v6, v7, v8, word_100B6537A);
        v9 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      word_100B6537A = 1650;
    }
  }

  v19[1] = &v20;
  v19[0] = 4;
  if (sub_10002195C(sub_1002B28A8, v19, 0, 0) && sub_10000C240())
  {
    sub_10000AF54("Could not register dispatchReadRemoteVersionInformation", v10, v11, v12, v13, v14, v15, v16, v18);
    v17 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      sub_10080F7A0();
    }
  }
}

uint64_t sub_1002B28A8(uint64_t a1)
{
  result = off_100B65370(**(a1 + 8), byte_100B6533A, byte_100B65338);
  off_100B65370 = 0;
  return result;
}

uint64_t sub_1002B28EC(uint64_t result, char a2)
{
  if (result)
  {
    if (off_100B65370)
    {
      result = off_100B65370(result, byte_100B6533A, byte_100B65338);
      off_100B65370 = 0;
    }
  }

  else
  {
    v2 = byte_100B65338;
    byte_100B6533A[byte_100B65338] = a2;
    byte_100B65338 = v2 + 1;
    if (byte_100B61168 == (v2 + 1))
    {
      __memset_chk();
      sub_1002D2704(0, &unk_100B65361);
      sub_1002D2704(0, byte_100B65345);
      v3 = off_100B65370;
      v4 = byte_100B65338;

      return v3(0, byte_100B6533A, v4);
    }

    else
    {
      *(v5 + 3) = 0;
      v5[0] = 1;
      arc4random_buf(v5 + 1, 6uLL);
      BYTE1(v5[0]) &= 0x3Fu;
      return sub_1002A4600();
    }
  }

  return result;
}

uint64_t sub_1002B2A24(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  if (!byte_100B65338)
  {
    return 103;
  }

  if (byte_100B65339)
  {
    v8 = sub_100018960(211, nullsub_145, a3, a4, a5, a6, a7, a8, v31);
    if (v8)
    {
      v9 = v8;
      if (sub_10000C240())
      {
        sub_10000AF54("OI_HCI_CMD_LE_ClearAdvertisingSets returned %!", v10, v11, v12, v13, v14, v15, v16, v9);
        v17 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }
    }
  }

  else if (byte_100B61168)
  {
    v19 = 0;
    do
    {
      v20 = sub_1002A468C();
      if (v20)
      {
        v21 = v20;
        if (sub_10000C240())
        {
          sub_10000AF54("BT_VSC_RemoveMultipleAdvInstance returned %!", v22, v23, v24, v25, v26, v27, v28, v21);
          v29 = sub_10000C050(0x42u);
          if (os_log_type_enabled(v29, OS_LOG_TYPE_ERROR))
          {
            v30 = sub_10000C0FC();
            *buf = 136446466;
            v33 = v30;
            v34 = 1024;
            v35 = 0xFFFF;
            _os_log_error_impl(&_mh_execute_header, v29, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
          }
        }
      }

      ++v19;
    }

    while (v19 < byte_100B61168);
  }

  result = 0;
  byte_100B65338 = 0;
  off_100B65370 = 0;
  return result;
}

uint64_t sub_1002B2C0C(uint64_t result)
{
  byte_100B65378 = result;
  if (result)
  {
    byte_100B65339 = 1;
  }

  return result;
}

BOOL sub_1002B2C40()
{
  if (byte_100B65338)
  {
    v0 = 0;
    v1 = byte_100B6533A;
    v2 = 1;
    v3 = byte_100B65338;
    for (i = &byte_100B61E7D; (*i | 2) != 3; i += 3368)
    {
      v0 = v2 >= byte_100B65338;
      ++v1;
      ++v2;
      if (!--v3)
      {
        return 1;
      }
    }

    if (sub_10000C240())
    {
      sub_10000AF54("ADV instance %d is in state %d", v5, v6, v7, v8, v9, v10, v11, *v1);
      v12 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
      {
        *buf = 136446210;
        v15 = sub_10000C0FC();
        _os_log_impl(&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }
  }

  else
  {
    return 1;
  }

  return v0;
}

BOOL sub_1002B2D70()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_isPeriodicAdvStarting", v0, v1, v2, v3, v4, v5, v6, *v12);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v12 = 136446210;
      *&v12[4] = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", v12, 0xCu);
    }
  }

  v8 = 0;
  v9 = 0;
  do
  {
    v10 = dword_100B653A0[420 * v9];
    if (v8)
    {
      break;
    }

    v8 = 1;
    v9 = 1;
  }

  while (v10 != 1);
  return v10 == 1;
}

BOOL sub_1002B2E64(uint64_t a1)
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_isPeriodicAdvCtxInUse advHandle=%d", v2, v3, v4, v5, v6, v7, v8, a1);
    v9 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v17 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  v10 = 0;
  v11 = 1;
  do
  {
    while (1)
    {
      v12 = v11;
      v13 = &dword_100B653A0[420 * v10];
      if (*(v13 + 6) == a1)
      {
        break;
      }

      v11 = 0;
      result = 0;
      v10 = 1;
      if ((v12 & 1) == 0)
      {
        return result;
      }
    }

    v14 = *v13;
    result = v14 == 2;
    if (v14 == 2)
    {
      break;
    }

    v11 = 0;
    v10 = 1;
  }

  while (((v12 ^ 1) & 1) == 0);
  return result;
}

_DWORD *sub_1002B2F84()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_AllocatePeriodicAdvCtx", v0, v1, v2, v3, v4, v5, v6, *v21);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *v21 = 136446210;
      *&v21[4] = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", v21, 0xCu);
    }
  }

  v8 = 0;
  v9 = 1;
  do
  {
    v10 = &dword_100B653A0[420 * v8];
    if (!*v10)
    {
      bzero(v10, 0x690uLL);
      return v10;
    }

    v11 = v9;
    v9 = 0;
    v8 = 1;
  }

  while ((v11 & 1) != 0);
  if (sub_10000C240())
  {
    sub_10000AF54("LE_AllocatePeriodicAdvCtx there is no free periodic advertisng parameter.", v12, v13, v14, v15, v16, v17, v18, *v21);
    v19 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      sub_10080F7A0();
    }
  }

  return 0;
}

uint64_t sub_1002B30C8(uint64_t (*a1)(void, void), uint64_t (*a2)(void, void))
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_InitPeriodicAdvertising", v4, v5, v6, v7, v8, v9, v10, *v13);
    v11 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *v13 = 136446210;
      *&v13[4] = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", v13, 0xCu);
    }
  }

  byte_100B65388 = 0;
  off_100B65390 = a1;
  off_100B65398 = a2;
  bzero(dword_100B653A0, 0xD20uLL);
  return 0;
}

void sub_1002B31C0()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_TerminatePeriodicAdvertising", v0, v1, v2, v3, v4, v5, v6, v21);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v23 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_1002B338C())
  {
    v8 = 0;
    v9 = 1;
    do
    {
      v10 = v9;
      v11 = &dword_100B653A0[420 * v8];
      if ((*v11 - 1) <= 1 && sub_1002B3458(*(v11 + 6), 1) && sub_10000C240())
      {
        sub_10000AF54("Failed to stop periodic advertising advHandle %x", v12, v13, v14, v15, v16, v17, v18, *(v11 + 6));
        v19 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
        {
          v20 = sub_10000C0FC();
          *buf = 136446466;
          v23 = v20;
          v24 = 1024;
          v25 = 0xFFFF;
          _os_log_error_impl(&_mh_execute_header, v19, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
        }
      }

      v9 = 0;
      v8 = 1;
    }

    while ((v10 & 1) != 0);
  }
}

uint64_t sub_1002B338C()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_ReturnNumPeriodicAdvStarted numPeriodicAdvStarted=%d", v0, v1, v2, v3, v4, v5, v6, byte_100B65388);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v10 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return byte_100B65388;
}

uint64_t sub_1002B3458(uint64_t a1, char a2)
{
  v4 = 0;
  v5 = 1;
  while (1)
  {
    v6 = &dword_100B653A0[420 * v4];
    if (*(v6 + 6) == a1)
    {
      break;
    }

    v7 = v5;
    v5 = 0;
    v4 = 1;
    if ((v7 & 1) == 0)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("LE_GetPeriodicAdvCtxByAdvHandle cannot find the context advHandle=%d.", v8, v9, v10, v11, v12, v13, v14, a1);
        v15 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v15, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      v6 = 0;
      break;
    }
  }

  if (sub_10000C240())
  {
    sub_10000AF54("LE_StopPeriodicAdvertising advHandle=%d", v16, v17, v18, v19, v20, v21, v22, a1);
    v23 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v23, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v80 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v23, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if ((a2 & 1) == 0)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("LE_isPeriodicAdvStopping", v24, v25, v26, v27, v28, v29, v30, v78);
      v31 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v31, OS_LOG_TYPE_DEFAULT))
      {
        v32 = sub_10000C0FC();
        *buf = 136446210;
        v80 = v32;
        _os_log_impl(&_mh_execute_header, v31, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
      }
    }

    v33 = 0;
    v34 = 0;
    do
    {
      v35 = dword_100B653A0[420 * v34];
      if (v33)
      {
        break;
      }

      v33 = 1;
      v34 = 1;
    }

    while (v35 != 3);
    if (v35 == 3)
    {
      if (!sub_10000C240())
      {
        return 117;
      }

      sub_10000AF54("LE_StopPeriodicAdvertising pending stop command", v36, v37, v38, v39, v40, v41, v42, v78);
      v43 = sub_10000C050(0x42u);
      if (!os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        return 117;
      }

      goto LABEL_40;
    }
  }

  if (v6)
  {
    if (off_100B65398)
    {
      if (*v6 != 2)
      {
        if (!sub_10000C240())
        {
          return 117;
        }

        sub_10000AF54("No LE Periodic Advertising in progress.", v70, v71, v72, v73, v74, v75, v76, v78);
        v77 = sub_10000C050(0x42u);
        if (!os_log_type_enabled(v77, OS_LOG_TYPE_ERROR))
        {
          return 117;
        }

LABEL_40:
        sub_10080F7A0();
        return 117;
      }

      if (sub_10000C240())
      {
        sub_10000AF54("Stopping Periodic Advertising", v44, v45, v46, v47, v48, v49, v50, v78);
        v51 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v51, OS_LOG_TYPE_DEFAULT))
        {
          v52 = sub_10000C0FC();
          *buf = 136446210;
          v80 = v52;
          _os_log_impl(&_mh_execute_header, v51, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      result = sub_100018960(214, sub_1002B3C34, v45, v46, v47, v48, v49, v50, 0);
      if (!result)
      {
        *v6 = 3;
      }
    }

    else
    {
      if (sub_10000C240())
      {
        sub_10000AF54("Invalid periodic advertising parameters no periodicAdvStoppedCb", v62, v63, v64, v65, v66, v67, v68, v78);
        v69 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v69, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      return 114;
    }
  }

  else
  {
    if (sub_10000C240())
    {
      sub_10000AF54("LE_StopPeriodicAdvertising invalid advHandle=%d", v54, v55, v56, v57, v58, v59, v60, a1);
      v61 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v61, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    return 120;
  }

  return result;
}

uint64_t sub_1002B3820(unsigned __int8 *a1)
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_StartPeriodicAdvertising advHandle=%d", v2, v3, v4, v5, v6, v7, v8, *a1);
    v9 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v88 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (sub_1002B2D70())
  {
    if (!sub_10000C240())
    {
      return 117;
    }

    sub_10000AF54("LE_StartPeriodicAdvertising pending start command", v10, v11, v12, v13, v14, v15, v16, v86);
    v17 = sub_10000C050(0x42u);
    if (!os_log_type_enabled(v17, OS_LOG_TYPE_ERROR))
    {
      return 117;
    }

    goto LABEL_7;
  }

  if (off_100B65390)
  {
    v19 = *a1;
    if (v19 >= 0xF0)
    {
      if (!sub_10000C240())
      {
        return 101;
      }

      sub_10000AF54("Invalid periodic advertising parameters advHandle: %x", v20, v21, v22, v23, v24, v25, v26, *a1);
      v27 = sub_10000C050(0x42u);
      if (!os_log_type_enabled(v27, OS_LOG_TYPE_ERROR))
      {
        return 101;
      }

      goto LABEL_25;
    }

    if (*(a1 + 1) <= 5u)
    {
      if (!sub_10000C240())
      {
        return 101;
      }

      sub_10000AF54("Invalid periodic advertising parameters periodicAdvInterval: %x", v36, v37, v38, v39, v40, v41, v42, *(a1 + 1));
      v43 = sub_10000C050(0x42u);
      if (!os_log_type_enabled(v43, OS_LOG_TYPE_ERROR))
      {
        return 101;
      }

      goto LABEL_25;
    }

    if ((a1[4] & 0xBF) != 0)
    {
      if (!sub_10000C240())
      {
        return 101;
      }

      sub_10000AF54("Invalid periodic advertising parameters periodicAdvProperty: %x", v44, v45, v46, v47, v48, v49, v50, a1[4]);
      v51 = sub_10000C050(0x42u);
      if (!os_log_type_enabled(v51, OS_LOG_TYPE_ERROR))
      {
        return 101;
      }

LABEL_25:
      sub_10080F7A0();
      return 101;
    }

    if (sub_1002B2E64(v19))
    {
      if (!sub_10000C240())
      {
        return 117;
      }

      sub_10000AF54("LE_StartPeriodicAdvertising advHandle=%d is already started", v53, v54, v55, v56, v57, v58, v59, *a1);
      v60 = sub_10000C050(0x42u);
      if (!os_log_type_enabled(v60, OS_LOG_TYPE_ERROR))
      {
        return 117;
      }

LABEL_7:
      sub_10080F7A0();
      return 117;
    }

    v61 = sub_1002B2F84();
    if (v61)
    {
      v68 = v61;
      *(v61 + 6) = *a1;
      *(v61 + 4) = *(a1 + 1);
      *(v61 + 10) = a1[4];
      v69 = *(a1 + 3);
      if (*(a1 + 3))
      {
        memmove(v61 + 14, a1 + 8, v69);
        *(v68 + 6) = *(a1 + 3);
        *(v68 + 832) = 0;
      }

      v18 = sub_1002B3BC0(v68, v62, v69, v63, v64, v65, v66, v67);
      if (v18)
      {
        if (sub_10000C240())
        {
          sub_10000AF54("Could not start the LE periodic advertising %!", v70, v71, v72, v73, v74, v75, v76, v18);
          v77 = sub_10000C050(0x42u);
          if (os_log_type_enabled(v77, OS_LOG_TYPE_ERROR))
          {
            sub_10080F7A0();
          }
        }
      }
    }

    else
    {
      if (sub_10000C240())
      {
        sub_10000AF54("LE_StartPeriodicAdvertising No resource", v78, v79, v80, v81, v82, v83, v84, v86);
        v85 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v85, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      return 104;
    }
  }

  else
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Invalid periodic advertising parameters no periodicAdvStartedCb", v28, v29, v30, v31, v32, v33, v34, v86);
      v35 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v35, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    return 114;
  }

  return v18;
}

uint64_t sub_1002B3BC0(unsigned __int8 *a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6, uint64_t a7, uint64_t a8)
{
  v9 = sub_100018960(212, sub_1002B4B28, a3, a4, a5, a6, a7, a8, a1[6]);
  if (v9)
  {
    sub_1002B4884(a1);
  }

  else
  {
    *a1 = 1;
  }

  return v9;
}

void sub_1002B3C34(uint64_t a1)
{
  v2 = 0;
  v3 = 1;
  while (1)
  {
    v4 = &dword_100B653A0[420 * v2];
    if (*v4 == 3)
    {
      break;
    }

    v5 = v3;
    v3 = 0;
    v2 = 1;
    if ((v5 & 1) == 0)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("LE_GetPeriodicAdvCtxStopping cannot find the context", v6, v7, v8, v9, v10, v11, v12, v39);
        v13 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v13, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      sub_1000D660C();
      v4 = 0;
      break;
    }
  }

  if (sub_10000C240())
  {
    sub_10000AF54("Periodic advertising stopped %! advHandle=%d", v14, v15, v16, v17, v18, v19, v20, a1);
    v21 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v21, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v41 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v21, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  *v4 = 0;
  --byte_100B65388;
  if (sub_10000C240())
  {
    sub_10000AF54("notifyPeriodicAdvStoppped status=%d advHandle=%d", v22, v23, v24, v25, v26, v27, v28, a1);
    v29 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v29, OS_LOG_TYPE_DEFAULT))
    {
      v30 = sub_10000C0FC();
      *buf = 136446210;
      v41 = v30;
      _os_log_impl(&_mh_execute_header, v29, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1002B4884(v4);
  if (off_100B65398)
  {
    off_100B65398(a1, v4[6]);
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("Could not find a callback, might be a problem ?", v31, v32, v33, v34, v35, v36, v37, v39);
    v38 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v38, OS_LOG_TYPE_ERROR))
    {
      sub_10080F7A0();
    }
  }
}

uint64_t sub_1002B3E70()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_RefreshPeriodicAdvRandomAddress", v0, v1, v2, v3, v4, v5, v6, v19);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v21 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  v8 = 0;
  v9 = 0;
  v10 = 1;
  do
  {
    v11 = v10;
    v12 = &unk_100B653A0 + 1680 * v8;
    if (*v12 == 2)
    {
      v12[4] = 1;
      v13 = sub_100018960(214, sub_1002B4060, v1, v2, v3, v4, v5, v6, 1);
      if (v13)
      {
        v14 = v13;
        v12[4] = 0;
        if (sub_10000C240())
        {
          sub_10000AF54("Fail to refresh random address for periodic advertising advHandle=%d", v15, v1, v2, v3, v4, v5, v6, v12[6]);
          v16 = sub_10000C050(0x42u);
          if (os_log_type_enabled(v16, OS_LOG_TYPE_ERROR))
          {
            v17 = sub_10000C0FC();
            *buf = 136446466;
            v21 = v17;
            v22 = 1024;
            v23 = 0xFFFF;
            _os_log_error_impl(&_mh_execute_header, v16, OS_LOG_TYPE_ERROR, "%{public}s (status=%{bluetooth:OI_STATUS}u)", buf, 0x12u);
          }
        }

        v9 = v14;
      }
    }

    v10 = 0;
    v8 = 1;
  }

  while ((v11 & 1) != 0);
  return v9;
}

void sub_1002B4060(uint64_t a1)
{
  v2 = sub_1002B4A90();
  if (!v2)
  {
    sub_1000D660C();
  }

  if (sub_10000C240())
  {
    sub_10000AF54("Periodic advertising started %! advHandle=%d addressChanged=%d", v3, v4, v5, v6, v7, v8, v9, a1);
    v10 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v28 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (v2[4] == 1)
  {
    if (a1 && sub_10000C240())
    {
      sub_10000AF54("Fail to refresh random address for periodic advertising advHandle=%d", v11, v12, v13, v14, v15, v16, v17, v2[6]);
      v18 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    v2[4] = 0;
  }

  else
  {
    if (a1)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("Could not start advertising : %!", v19, v20, v21, v22, v23, v24, v25, a1);
        v26 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }
    }

    else
    {
      *v2 = 2;
      ++byte_100B65388;
    }

    sub_1002B4954(a1, v2);
  }
}

uint64_t sub_1002B4224()
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_GetPeriodicAdvertisingEnabled enabled=%d", v0, v1, v2, v3, v4, v5, v6, byte_100B65380);
    v7 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v7, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v10 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v7, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  return byte_100B65380;
}

void sub_1002B42F0(char a1)
{
  byte_100B6536F = a1;
  if (sub_10000C240())
  {
    sub_10000AF54("Invoking fake OI_BUSY_FAIL every %d attempts", v1, v2, v3, v4, v5, v6, v7, byte_100B6536F);
    v8 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v8, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v10 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v8, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }
}

uint64_t sub_1002B43BC()
{
  sub_100304AF8("LE_Advertising:\n");
  result = sub_100304AF8("gNumOfAdvHandles=%d gInitMultiAdvCb=%x currentHandle=%d tech=%d extendedAdvertisingEnabled=%d gMaxControllerSupportedAdvertisingPacketSize=%d", byte_100B65338, off_100B65370, byte_100B65344, byte_100B65339, byte_100B65378, word_100B6537A);
  if (byte_100B65338)
  {
    v1 = 0;
    v2 = &byte_100B65346;
    v3 = qword_100B61170;
    do
    {
      sub_100304AF8("advertisingParams for instance %d :", v1);
      sub_100304AF8("\tintervalMin=%d intervalMax=%d type=%d channelMap=%d state=%d", *(v3 + 8), *(v3 + 9), *(v3 + 20), *(v3 + 28), *(v3 + 3341));
      sub_100304AF8("\tdata:%@", v3 + 4, *(v3 + 15));
      sub_100304AF8("\tscanRsp:%@", v3 + 211, *(v3 + 843));
      sub_100304AF8("\taddress: %: type:%d", v2, *(v2 - 1));
      sub_100304AF8("\tprimaryPHY:%d", *(v3 + 3351));
      sub_100304AF8("\tsecondaryPHY:%d", *(v3 + 3352));
      sub_100304AF8("\tprimaryPhyOptions:%d", *(v3 + 3353));
      sub_100304AF8("\tsecondaryPhyOptions:%d", *(v3 + 3354));
      sub_100304AF8("\tuseDecisionBasedAdvPayload:%d", *(v3 + 3355));
      sub_100304AF8("\tDBAFDecisionTypeFlags:%d", *(v3 + 3356));
      sub_100304AF8("\tDBAFDecisionDataLength:%d", *(v3 + 3357));
      result = sub_100304AF8("\tDBAFDecisionData:%s", v3[420]);
      ++v1;
      v2 += 7;
      v3 += 421;
    }

    while (v1 < byte_100B65338);
  }

  return result;
}

void sub_1002B45C0(uint64_t a1)
{
  v1 = a1;
  if (a1)
  {
LABEL_2:
    if (sub_10000C240())
    {
      sub_10000AF54("advertisingDataCb Could not start advertising : %!", v2, v3, v4, v5, v6, v7, v8, v10);
      v9 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    byte_100B61E7D = 0;
    sub_100092D80(v1, 0, 0);
    return;
  }

  if (word_100B61806)
  {
    v10 = word_100B61806;
    v1 = sub_100018960(169, sub_1002B46CC);
    if (!v1)
    {
      return;
    }

    goto LABEL_2;
  }

  if (sub_100018960(169, sub_1002B46CC))
  {

    sub_1002B46CC(0);
  }
}

void sub_1002B46CC(uint64_t a1)
{
  v1 = a1;
  if (a1 || (v1 = sub_100018960(170, sub_1002B477C), v1))
  {
    if (sub_10000C240())
    {
      sub_10000AF54("scanResponseDataCb Could not start advertising : %!", v2, v3, v4, v5, v6, v7, v8, v1);
      v9 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    byte_100B61E7D = 0;
    sub_100092D80(v1, 0, 0);
  }
}

void sub_1002B477C(uint64_t a1)
{
  if (a1)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("advertiseStart Could not start advertising : %!", v2, v3, v4, v5, v6, v7, v8, a1);
      v9 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }
  }

  byte_100B61E7D = 2;
  sub_100092D80(a1, 0, 0);
}

void sub_1002B480C(uint64_t a1)
{
  if (a1)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("Could not setAdvPhyOptions: %!", v2, v3, v4, v5, v6, v7, v8, a1);
      v9 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }
  }

  sub_1000C2730(0);
}

void sub_1002B4884(void *a1)
{
  if (sub_10000C240())
  {
    sub_10000AF54("LE_FreePeriodicAdvCtx", v2, v3, v4, v5, v6, v7, v8, *v10);
    v9 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v9, OS_LOG_TYPE_DEFAULT))
    {
      *v10 = 136446210;
      *&v10[4] = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v9, OS_LOG_TYPE_DEFAULT, " %{public}s", v10, 0xCu);
    }
  }

  if (a1)
  {
    bzero(a1, 0x690uLL);
  }
}

void sub_1002B4954(uint64_t a1, unsigned __int8 *a2)
{
  if (sub_10000C240())
  {
    sub_10000AF54("notifyPeriodicAdvStarted status=%d advHandle=%d", v4, v5, v6, v7, v8, v9, v10, a1);
    v11 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v22 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (a1)
  {
    sub_1002B4884(a2);
  }

  if (off_100B65390)
  {
    off_100B65390(a1, a2[6]);
  }

  else if (sub_10000C240())
  {
    sub_10000AF54("Could not find a callback, might be a problem ?", v12, v13, v14, v15, v16, v17, v18, v20);
    v19 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      sub_10080F7A0();
    }
  }
}

_DWORD *sub_1002B4A90()
{
  v1 = 0;
  for (i = 1; ; i = 0)
  {
    result = (&unk_100B653A0 + 1680 * v1);
    if (*result == 1)
    {
      break;
    }

    v4 = i;
    v1 = 1;
    if ((v4 & 1) == 0)
    {
      if (sub_10000C240())
      {
        sub_10000AF54("LE_GetPeriodicAdvCtxStarting cannot find the context", v5, v6, v7, v8, v9, v10, v11, v0);
        v12 = sub_10000C050(0x42u);
        if (os_log_type_enabled(v12, OS_LOG_TYPE_ERROR))
        {
          sub_10080F7A0();
        }
      }

      return 0;
    }
  }

  return result;
}

void sub_1002B4B28(uint64_t a1)
{
  v2 = sub_1002B4A90();
  if (!v2)
  {
    sub_1000D660C();
  }

  if (sub_10000C240())
  {
    sub_10000AF54("setPeriodicAdvParamsCompleteCb status %! ", v3, v4, v5, v6, v7, v8, v9, a1);
    v10 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v10, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v29 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v10, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (a1)
  {
LABEL_7:
    if (sub_10000C240())
    {
      sub_10000AF54("Could not start periodic advertising : %!", v11, v12, v13, v14, v15, v16, v17, a1);
      v18 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }

    *v2 = 0;
    sub_1002B4954(a1, v2);
    return;
  }

  if (*(v2 + 6))
  {
    a1 = sub_1002B4EA4(v2);
    if (!a1)
    {
      return;
    }

    goto LABEL_7;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("Periodic advertising data size is 0, skip setting data for adv instance %d", v19, v20, v21, v22, v23, v24, v25, v2[6]);
    v26 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v26, OS_LOG_TYPE_DEFAULT))
    {
      v27 = sub_10000C0FC();
      *buf = 136446210;
      v29 = v27;
      _os_log_impl(&_mh_execute_header, v26, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  sub_1002B4D00(0, v2);
}

void sub_1002B4D00(uint64_t a1, unsigned __int8 *a2)
{
  if (sub_10000C240())
  {
    sub_10000AF54("Set Periodic Advertising Data Complete %! advHandle=%d", v4, v5, v6, v7, v8, v9, v10, a1);
    v11 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v11, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v30 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v11, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (!a1)
  {
    v20 = sub_100018960(214, sub_1002B4060, v5, v6, v7, v8, v9, v10, 1);
    if (!v20)
    {
      return;
    }

    a1 = v20;
    if (sub_10000C240())
    {
      sub_10000AF54("Failed to start advertising OI_HCI_CMD_LE_SetPeriodicAdvertisingEnable returned %!", v21, v22, v23, v24, v25, v26, v27, a1);
      v28 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v28, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }
  }

  if (sub_10000C240())
  {
    sub_10000AF54("Could not start peirodic advertising : %!", v12, v13, v14, v15, v16, v17, v18, a1);
    v19 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v19, OS_LOG_TYPE_ERROR))
    {
      sub_10080F7A0();
    }
  }

  *a2 = 0;
  sub_1002B4954(a1, a2);
}

uint64_t sub_1002B4EA4(uint64_t a1)
{
  v2 = *(a1 + 12) - *(a1 + 1664);
  if (v2 >= 0xFCu)
  {
    v3 = 252;
  }

  else
  {
    v3 = *(a1 + 12) - *(a1 + 1664);
  }

  if (v2 > 0xFCu)
  {
    v4 = 1;
  }

  else
  {
    v4 = 3;
  }

  if (*(a1 + 1664))
  {
    v5 = 2 * (v2 < 0xFDu);
  }

  else
  {
    v5 = v4;
  }

  if (sub_10000C240())
  {
    sub_10000AF54("setPeriodicAdvDataPacket operation:%d dataLeft:%d totalDataLen:%d dataLengthThisPacket:%d position:%d", v6, v7, v8, v9, v10, v11, v12, v5);
    v13 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v13, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v25 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v13, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  v14 = sub_100018960(213, sub_1002B5048, v7, v8, v9, v10, v11, v12, *(a1 + 6));
  if (v14)
  {
    if (sub_10000C240())
    {
      sub_10000AF54("OI_HCI_CMD_LE_SetPeriodicAdvertisingData returned %!", v15, v16, v17, v18, v19, v20, v21, v14);
      v22 = sub_10000C050(0x42u);
      if (os_log_type_enabled(v22, OS_LOG_TYPE_ERROR))
      {
        sub_10080F7A0();
      }
    }
  }

  else
  {
    *(a1 + 1664) += v3;
  }

  return v14;
}

void sub_1002B5048(uint64_t a1)
{
  v2 = sub_1002B4A90();
  if (!v2)
  {
    sub_1000D660C();
  }

  v3 = *(v2 + 6);
  v4 = *(v2 + 832);
  if (sub_10000C240())
  {
    sub_10000AF54("setPeriodicAdvDataPacketCompleteCb dataLeft:%d status:%!", v5, v6, v7, v8, v9, v10, v11, (v3 - v4));
    v12 = sub_10000C050(0x42u);
    if (os_log_type_enabled(v12, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v14 = sub_10000C0FC();
      _os_log_impl(&_mh_execute_header, v12, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
    }
  }

  if (a1 || v3 == v4 || (a1 = sub_1002B4EA4(v2), a1))
  {
    sub_1002B4D00(a1, v2);
  }
}

uint64_t sub_1002B5164()
{
  if (qword_100B660E0)
  {
    return qword_100B660E0();
  }

  return result;
}

uint64_t sub_1002B5178()
{
  if (off_100B660F0)
  {
    return off_100B660F0();
  }

  return result;
}

uint64_t sub_1002B518C()
{
  if (off_100B660E8)
  {
    return off_100B660E8();
  }

  return result;
}

uint64_t sub_1002B51A0()
{
  xmmword_100B66100 = 0u;
  unk_100B66110 = 0u;
  qword_100B66120 = 0;
  sub_1002DB89C(off_100AE9CB0);
  if (v0)
  {
    v1 = v0;
    if (sub_10000C240())
    {
      sub_10000AF54("Failed to add state callbacks : %!", v2, v3, v4, v5, v6, v7, v8, v1);
      v9 = sub_10000C050(0x44u);
      if (os_log_type_enabled(v9, OS_LOG_TYPE_ERROR))
      {
LABEL_4:
        sub_1000E09C0();
      }
    }
  }

  else
  {
    v10 = sub_1002CE244(off_100AE9CC8);
    if (v10)
    {
      v1 = v10;
      if (sub_10000C240())
      {
        sub_10000AF54("Failed to add GAP connections callbacks : %!", v11, v12, v13, v14, v15, v16, v17, v1);
        v18 = sub_10000C050(0x44u);
        if (os_log_type_enabled(v18, OS_LOG_TYPE_ERROR))
        {
          goto LABEL_4;
        }
      }
    }

    else
    {
      dword_100B66128 = 0;
      qword_100B66130 = 0;
      v1 = sub_10028E64C(4, 3, 16, 3u, &xmmword_100B66100, sub_1002B6D1C);
      if (v1 || !xmmword_100B66100)
      {
        if (sub_10000C240())
        {
          sub_10000AF54("Could not register the l2cap : %!", v19, v20, v21, v22, v23, v24, v25, v1);
          v26 = sub_10000C050(0x44u);
          if (os_log_type_enabled(v26, OS_LOG_TYPE_ERROR))
          {
            sub_1000E09C0();
          }
        }
      }

      else
      {
        *sub_1000CD958(xmmword_100B66100) = 527;
        *(sub_1000CD958(xmmword_100B66100) + 2) = -1;
      }

      if (sub_10000C240())
      {
        v27 = sub_1000CD958(xmmword_100B66100);
        sub_10000AF54("ATT L2CAP channel MTU: %d", v28, v29, v30, v31, v32, v33, v34, *v27);
        v35 = sub_10000C050(0x44u);
        if (os_log_type_enabled(v35, OS_LOG_TYPE_DEFAULT))
        {
          *buf = 136446210;
          v48 = sub_10000C0FC();
          _os_log_impl(&_mh_execute_header, v35, OS_LOG_TYPE_DEFAULT, " %{public}s", buf, 0xCu);
        }
      }

      qword_100B66138 = sub_1000BAE38(0, sub_1002B8F74);
      v36 = sub_1001BC1A4();
      if (v36)
      {
        v37 = v36;
        if (sub_10000C240())
        {
          sub_10000AF54("ATT classic registration failed with %!", v38, v39, v40, v41, v42, v43, v44, v37);
          v45 = sub_10000C050(0x44u);
          if (os_log_type_enabled(v45, OS_LOG_TYPE_ERROR))
          {
            sub_1000E09C0();
          }
        }
      }
    }
  }

  return v1;
}