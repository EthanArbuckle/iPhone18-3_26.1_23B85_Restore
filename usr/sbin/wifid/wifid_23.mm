void sub_1001A3988()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager.", "WiFiDeviceManagerDispatchSimulatedColocatedJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A39F4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: __WiFiDeviceManagerCopyCurrentCoreWiFiScanResult() returned NULL", "__WiFiDeviceManagerSimulatedColocatedJoinNotificationScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3A60()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: scan results were empty", "__WiFiDeviceManagerSimulatedColocatedJoinNotificationScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3ACC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: manager is null", "__WiFiDeviceManagerSimulatedColocatedJoinNotificationScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3B38()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: app name is null", "WiFiDeviceManagerDispatchAppJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3BA4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: network name is null", "WiFiDeviceManagerDispatchAppJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3C10()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null device manager", "WiFiDeviceManagerDispatchAppJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3C7C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: metric is null", "WiFiDeviceManagerSubmitSetupMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3CE8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Not able to submit setup metric __WiFiDeviceManagerCopyCurrentCoreWiFiNetworkProfile returned NULL", "WiFiDeviceManagerSubmitSetupMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3D54()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Not able to submit setup metric __WiFiDeviceManagerCopyCurrentCoreWiFiScanResult returned NULL", "WiFiDeviceManagerSubmitSetupMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3DC0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: User has already set up device", "WiFiDeviceManagerSubmitSetupMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3E2C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to retrieve password for %@", "__WiFiDeviceManagerProcessColocatedJoinNotification", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A3E9C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to  %@", "__WiFiDeviceManagerProcessColocatedJoinNotification", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A3F0C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: no matching profile for %@", "__WiFiDeviceManagerProcessColocatedJoinNotification", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A3F7C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: no SSID in additional information", "__WiFiDeviceManagerProcessColocatedJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A3FE8(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A4064()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: metric is null", "__WiFiDeviceManagerProcessColocatedJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A40D0(void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to get password for %@", "__WiFiDeviceManagerColocatedJoinAssociationCallback", *a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A4144()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"Could not create WiFiNetworkRef from scan result"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A419C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null config.", "WiFiDeviceManagerSetBackgroundScanConfiguration"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4208()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null interfaceName.", "WiFiDeviceManagerSetBackgroundScanConfiguration"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4274()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager.", "WiFiDeviceManagerSetBackgroundScanConfiguration"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A42E0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager.", "WiFiDeviceManagerCopyBackgroundScanConfiguration"}];
  }

  objc_autoreleasePoolPop(v0);
}

id sub_1001A434C()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No scan parameters specified";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A43C0()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No jittdImpactEstimator configured";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A4434()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No device manager configured";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

void sub_1001A44A8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"Invalid ref con"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4500()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null originTimeNum", "__WiFiDeviceManagerManageMissingPasswordList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4560()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null ssid", "__WiFiDeviceManagerManageMissingPasswordList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A45CC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networksMissingPassword", "__WiFiDeviceManagerManageMissingPasswordList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4638()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null network", "__WiFiDeviceManagerManageMissingPasswordList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A46A4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "__WiFiDeviceManagerManageMissingPasswordList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4710()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: NULL manager", "__WiFiDeviceManagerIsMIS5GhzEnabled"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A477C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no known BSS for this network. Learning environment.", "__WiFiDeviceManagerEvaluateAPEnvironment"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A47E8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"Null LQA manager\n"];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001A4840(uint64_t a1)
{
  result = sub_10018A684(a1);
  if (result && *(a1 + 5267) && *(a1 + 5264) >= 0xFu)
  {
    v3 = sub_10000D7B8();

    return sub_1000C47C0(v3, v4);
  }

  return result;
}

void sub_1001A48A0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: deviceManagerRef is Null!", "__WiFiDeviceManagerP2pThreadCoexEventCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A490C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s, roamManager is NULL", "__WiFiDeviceManagerSubmitRoamStatusMetrics"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4978()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s, roamStatusdict is NULL", "__WiFiDeviceManagerSubmitRoamStatusMetrics"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A49E4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s, WiFiDeviceManagerRef is NULL", "__WiFiDeviceManagerSubmitRoamStatusMetrics"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4A50(const void **a1, const void *a2)
{
  v3 = *a1;
  if (v3)
  {
    CFRelease(v3);
  }

  v4 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a2);
    sub_1000F8A68();
  }

  objc_autoreleasePoolPop(v4);
}

void sub_1001A4ACC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null queue.", "__WiFiDeviceManagerProcessAssociationResult"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4B2C(uint64_t *a1, void ***a2)
{
  v2 = sub_10000843C(a1, a2);
  sub_1000F8BFC(COERCE_DOUBLE(3221225472), v2, v3);
  v4[2] = sub_1000EC7CC;
  v4[3] = &unk_10025EFD8;
  v4[4] = v6;
  v4[5] = v5;
  dispatch_async(v7, v4);
}

void sub_1001A4B70()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: network is null", "__WiFiDeviceManagerProcessAutoHotspotJoinRecommendationNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4BDC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null queue.", "__WiFiDeviceManagerProcessAutoHotspotJoinRecommendationNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4C48()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: location timestamp is nil", "__WiFiDeviceManagerIsGeotagged5GhzNetworkPresent"}];
  }

  objc_autoreleasePoolPop(v0);
}

id sub_1001A4CB4(uint64_t a1, void *a2)
{
  v3 = 0;
  v4 = 0;
  v5 = a1 + 6040;
  do
  {
    v6 = [sub_1000F8B44() objectAtIndex:?];
    if (v6)
    {
      v7 = [v6 unsignedIntegerValue];
      if (v7 <= 0xCu && ((1 << v7) & v3) == 0)
      {
        v3 |= (1 << v7);
        ++*(v5 + 2 * v7);
      }
    }

    ++v4;
    result = [a2 count];
  }

  while (v4 < result);
  return result;
}

void sub_1001A4D4C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s !__WiFiDeviceManagerIsNetworkSuitableForAutojoin but couldn't get problematicNetwork", "__WiFiDeviceManagerTrackBlacklistedNetworksExcludedFromAutoJoin"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4DB8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null mruNetworkChanList", "__WiFiDeviceManagerScanMRUNetworkChannels"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4E18()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Failed to create remaining or supp ch list array", "__WiFiDeviceManagerScanRemainingChannels"}];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001A4E78()
{
  sub_10001131C();
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Fallback to all channel scans", "__WiFiDeviceManagerScanRemainingChannels"}];
  }

  objc_autoreleasePoolPop(v2);
  result = sub_100191434(v1);
  *v0 = result;
  return result;
}

void sub_1001A4EF0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"logMessage is Null!"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4F48()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"ScanResults is Null!"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A4FA0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s  logMessage is NULL", "__WiFiDeviceManagerPrepareDeferredNetworkList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A500C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: deferred network list is NULL", "__WiFiDeviceManagerPrepareDeferredNetworkList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5078()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: scan candidates is NULL", "__WiFiDeviceManagerPrepareDeferredNetworkList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A50E4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: manager object is NULL", "__WiFiDeviceManagerPrepareDeferredNetworkList"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5150()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no scan candidate network", "__WiFiDeviceManagerFilterCandidatesWithRssiThreshold"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A51BC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: manager is Null!", "__WiFiDeviceManagerFilterCandidatesWithRssiThreshold"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5228(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Done processing AJ candidates, %ld", "__WiFiDeviceManagerProcessCandidates", *(a1 + 1176)}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A5290(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_100058F60(*(a1 + 7153));
    v3 = *(a1 + 7153);
    sub_10002D39C();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A530C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: No scan results", "__WiFiDeviceManagerProcessDeferredNetworks"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5378()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: No GAS queries.", "__WiFiDeviceManagerProcessDeferredNetworks"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A53E4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"No HS2.0 networks to query"];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001A543C(uint64_t a1, uint64_t a2, _DWORD *a3)
{
  sub_100094FF0();
  Count = CFArrayGetCount(*(v6 + 3616));
  if (Count)
  {
    v8 = Count;
    Mutable = *v4;
    if (!*v4)
    {
      Mutable = CFArrayCreateMutable(kCFAllocatorDefault, 0, &kCFTypeArrayCallBacks);
      *v4 = Mutable;
    }

    v13.location = 0;
    v13.length = v8;
    CFArrayAppendArray(Mutable, *(v3 + 3616), v13);
    v10 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: Appending deffered networks to candidates list", "__WiFiDeviceManagerProcessDeferredNetworks"}];
    }

    objc_autoreleasePoolPop(v10);
  }

  CFArrayRemoveAllValues(*(v3 + 3608));
  CFArrayRemoveAllValues(*(v3 + 3616));
  [*(v3 + 3704) clearScanResultsForAutoJoinSessionReset];
  sub_1000E9010(v3, *v4);
  if (!sub_100192B7C(v3))
  {
    return 1;
  }

  v11 = sub_1000E9864(v3);
  result = 0;
  *a3 = v11;
  return result;
}

void sub_1001A5540(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: error: scan index invalid, %ld", "__WiFiDeviceManagerScanForHiddenNetworks", *(a1 + 1176)}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A55B4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s bssid is nil", "__CopyReasonsFromSubStatesForBssBlacklist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5620()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s dict is nil", "__CopyReasonsFromSubStatesForBssBlacklist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A568C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to create network", "__WiFiDeviceManagerProcessEAPTrustNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A56F8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to make mutable copy of eap client config", "__WiFiDeviceManagerProcessEAPTrustNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5764(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A57E0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to make mutable copy of eap profile", "__WiFiDeviceManagerProcessEAPTrustNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A584C(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A58C8(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A5944(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A59C0()
{
  sub_10001131C();
  sub_100193574(v2, v3, 1);
  v8 = sub_10001A9BC(v0);
  sub_10000A540(v0, @"BSSID");
  v4 = sub_100011340();
  v7 = sub_1000BE2EC(v4, v5, 0, v6, 3);
  [*(v1 + 6720) setNetworkDenyListInfo:v7 forScanResult:v8];
}

void sub_1001A5A4C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to archive network to path %@", "__WiFiDeviceManagerOpenSettings", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A5ABC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: skip persisting network to disk", "__WiFiDeviceManagerOpenSettings"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5B28(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to create urlString for type %d", "__WiFiDeviceManagerOpenSettings", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A5B98(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: failed to create urlPathString for type %d", "__WiFiDeviceManagerOpenSettings", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A5C08()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null detailedState.", "__WiFiDeviceManagerPostUserJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5C74()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null status.", "__WiFiDeviceManagerPostUserJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5CE0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager.", "__WiFiDeviceManagerPostUserJoinNotification"}];
  }

  objc_autoreleasePoolPop(v0);
}

double sub_1001A5D4C(uint64_t a1, uint64_t a2)
{
  v4 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Error returned by Associate Async %d", "__WiFiDeviceManagerAutoInstantHotspotAssociate", a1}];
  }

  objc_autoreleasePoolPop(v4);
  *(a2 + 6952) = 0;
  *(a2 + 3336) = *(a2 + 6972);
  sub_1000329B4(a2);
  *(a2 + 3336) = *(a2 + 6972);
  sub_100021D58();
  sub_100193BAC();
  *(a2 + 6536) = a1;

  return sub_100146CAC((a2 + 6536));
}

void sub_1001A5E04(_DWORD *a1)
{
  a1[834] = a1[1743];
  sub_100193BAC();
  a1[1634] = -3906;
  sub_100146CAC(a1 + 1634);
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: did not find the top network", "__WiFiDeviceManagerAutoInstantHotspotScanCallback"}];
  }

  objc_autoreleasePoolPop(v2);
}

double sub_1001A5E98(uint64_t a1, uint64_t a2, int a3)
{
  sub_100094FF0();
  v5 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no scan result. ", "__WiFiDeviceManagerAutoInstantHotspotScanCallback"}];
  }

  objc_autoreleasePoolPop(v5);
  v3[834] = v3[1743];
  sub_100193BAC();
  v3[1634] = a3;

  return sub_100146CAC(v3 + 1634);
}

void sub_1001A5F3C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No Network", "__WiFiDeviceManagerAutoInstantHotspotScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A5FA8()
{
  sub_100011560();
  v3 = sub_100193CE8(v2, *(v2 + 6936), *(v1 + 48));
  if (v3)
  {
    v5 = v3;
    v6 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: error initiating scan = %d", "__WiFiDeviceManagerAutoInstantHotspotScanCallback_block_invoke_2", v5}];
    }

    objc_autoreleasePoolPop(v6);
    sub_100025C70();
    sub_100193BAC();
    sub_10002CF08();
  }

  v4 = *v0;

  CFRelease(v4);
}

void sub_1001A6050()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No Network", "__WiFiDeviceManagerAutoInstantHotspotAssociationCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A60BC(uint64_t a1, uint64_t *a2)
{
  v3 = sub_100193CE8(a1, *(a1 + 6936), *(a1 + 7048));
  if (v3)
  {
    v5 = v3;
    v6 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: error = %d", "__WiFiDeviceManagerAutoInstantHotspotAssociationCallback_block_invoke_2", v5}];
    }

    objc_autoreleasePoolPop(v6);
    sub_100025C70();
    sub_100193BAC();
    sub_10002CF08();
    sub_1000329B4(*a2);
  }

  v4 = *a2;

  CFRelease(v4);
}

void sub_1001A6174()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null notificationDict.", "__WiFiDeviceManagerPostAutoJoinNotificationWithMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A61E0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null status.", "__WiFiDeviceManagerPostAutoJoinNotificationWithMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A624C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager.", "__WiFiDeviceManagerPostAutoJoinNotificationWithMetric"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A62B8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: countryCode is null\n", "__WiFiDeviceManagerIsRegulatoryUNII3Restricted"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6324()
{
  sub_100024B78();
  v3 = v2;
  v5 = v4;
  sub_100094FF0();
  v6 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    v7 = *(v0 + 5308);
    sub_100034900();
    [v8 WFLog:3 message:{"%s: MIS Mode: %s, Client Type: NAN Link Client client macAddr: %@"}];
  }

  objc_autoreleasePoolPop(v6);
  CFSetAddValue(*v5, v1);
  ++*v3;
  sub_10006AD5C();

  sub_10018A7CC(v9, v10);
}

void sub_1001A63E8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"__WiFiDeviceManagerNANPHSSTALeavingCallback", 11058}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6450()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"__WiFiDeviceManagerNANPHSSTALeavingCallback", 11057}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A64B8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"__WiFiDeviceManagerNANPHSPublisherMetricsCallback", 10852}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6520()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"__WiFiDeviceManagerNANPHSPublisherMetricsCallback", 10851}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6588()
{
  sub_100024B78();
  sub_100008C40();
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    v3 = *(*v0 + 5308);
    CFSetContainsValue(*(*v0 + 5360), *v1);
    sub_100026290();
  }

  objc_autoreleasePoolPop(v2);
  CFSetRemoveValue(*(*v0 + 5360), *v1);
  sub_10018A7CC(*v0, 0);
  if (_os_feature_enabled_impl())
  {
    [+[CWFHotspotClientManager sharedInstance](CWFHotspotClientManager clientDisassociated:"clientDisassociated:", *v1];
  }

  --*(*v0 + 5266);
  sub_10006AD5C();
}

void sub_1001A666C()
{
  sub_100011560();
  sub_100194030();
  v2 = *v1;
  [objc_msgSend(*v0 "wapCfg")];
  v3 = sub_1000305C4();
  sub_10014C6CC(v3, 1, v4);
}

void sub_1001A66AC()
{
  sub_10000D798();
  v3 = v2;
  sub_100008C40();
  if (!sub_1000C7464(v4, 8) || *(v0 + 5433))
  {
    v5 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      sub_10000A878(v3);
      sub_1000A9B58();
    }

    objc_autoreleasePoolPop(v5);
    v6 = sub_100006F88(*v1);
    sub_1000B9DC8(v0, v6, 1007, "__WiFiDeviceManagerStartNANSession", 24927);
  }

  sub_1000084B8();
}

void sub_1001A6754()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"MIS Service is not available"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A67AC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"misSession is NULL"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6804(int a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    strerror(a1);
    sub_100008328();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A6878()
{
  sub_10001131C();
  sub_100194030();
  v2 = *(v1 + 64);
  [objc_msgSend(*v0 "wapCfg")];
  v3 = sub_1000305C4();
  sub_10014C6CC(v3, 0, v4);
}

void sub_1001A68B8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"__WiFiDeviceManagerStartMISSession: Detected non-NULL misSession"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6910()
{
  sub_100011560();
  sub_100194030();
  v2 = *v1;
  [objc_msgSend(*v0 "wapCfg")];
  v3 = sub_1000305C4();
  sub_10014C6CC(v3, 0, v4);
}

void sub_1001A6950()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"MIS Scan: Failed to get supported channel list"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A699C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"MIS Scan: mis allowed channels list is empty"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A69E8(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"Error initiating MIS scan request: %d", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A6A44()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null scanData", "__WiFiDeviceManagerStartMISScan"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6AA4(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"WiFi is Powered OFF, Unable to start MIS Scan"}];
  }

  objc_autoreleasePoolPop(v2);
  bzero(v3, 0xB8uLL);
  v4 = 6;
  sub_1000C67C8(a1, v3);
}

void sub_1001A6B1C(uint64_t a1)
{
  if (sub_10018A684(a1) && !*(a1 + 5267))
  {
    v2 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: Starting MIS", "__WiFiDeviceManagerStopNetworkCallback"}];
    }

    objc_autoreleasePoolPop(v2);
    sub_1000C7790(a1);
  }

  CFSetAddValue(*(a1 + 5320), @"wifid");
  v3 = sub_10000D7B8();
  sub_10018A7CC(v3, v4);
  v5 = *(a1 + 64);
  sub_10014C5C0();

  sub_1000C7220(a1, 5);
}

void sub_1001A6BD8()
{
  sub_10000D798();
  sub_10001131C();
  qword_100298688 = *(v3 + 40);
  if (!qword_100298688)
  {
    v4 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:4 message:"Error transfering misKey to CFString"];
    }

    objc_autoreleasePoolPop(v4);
    v2 = *v0;
  }

  *(*v0 + 5268) = sub_10018A684(v2);
  if (_MISDetach)
  {
    v5 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:"%s: MIS dynamic store key: %@"];
    }

    objc_autoreleasePoolPop(v5);
    _MISDetach(*(v1 + 48));
    v6 = *v0;
  }

  sub_10018FE18();
  v7 = *v0;
  sub_1000084B8();

  CFRelease(v8);
}

void sub_1001A6CCC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No HS2.0 accounts", "__WiFiDeviceManagerSetHS20HomeOperatorNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6D38()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No GAS responses received", "__WiFiDeviceManagerSetHS20HomeOperatorNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6DA4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No HS2.0 accounts", "__WiFiDeviceManagerFindMatchingHS20Account"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6E10()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: No GAS responses received", "__WiFiDeviceManagerFindMatchingHS20Account"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6E7C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null manager.", "__WiFiDeviceManagerClearDpsHUD"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6EE8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null manager.", "__WiFiDeviceManagerClearSlowWiFiHUD"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A6F54()
{
  sub_100094FF0();
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: disregarding update, profile='%@' expected='%@'", "__WiFiDeviceManagerUpdateNetworkProfileWithDiscoveredDevices", v0, v1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A6FD0(void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [a1 discoveredDevices];
    sub_1000F8A68();
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A7050()
{
  sub_10001131C();
  sub_1001909BC(v0, 1);
  v1 = sub_100011580();
  sub_10018ADC8(v1, v2, 1);
}

void sub_1001A7084(uint64_t a1, uint64_t a2, uint64_t *a3)
{
  if (*(a1 + 40) == 1)
  {
    *(a2 + 3466) = 1;
    [+[WiFiUserInteractionMonitor sharedInstance](WiFiUserInteractionMonitor updateIsMediaPlaying:"updateIsMediaPlaying:", 1];
LABEL_3:
    v5 = *a3;
    goto LABEL_5;
  }

  *(a2 + 3466) = 0;
  [+[WiFiUserInteractionMonitor sharedInstance](WiFiUserInteractionMonitor updateIsMediaPlaying:"updateIsMediaPlaying:", 0];
  v5 = *a3;
  if (!*(*a3 + 6704))
  {
    v7 = _os_feature_enabled_impl();
    v8 = *a3;
    if (v7)
    {
      sub_100019814(v8, 0x1BuLL);
    }

    else
    {
      sub_1000BBDEC(v8, 2);
    }

    goto LABEL_3;
  }

LABEL_5:
  if (*(v5 + 441))
  {
    sub_100008DCC(v5, 3);
    v5 = *a3;
  }

  if (*(v5 + 7480))
  {
    [*(v5 + 7480) setMediaState:*(v5 + 3466) != 0];
    v5 = *a3;
  }

  sub_100021870(v5, 0);
  if (*a3)
  {
    sub_100048F18(*(*a3 + 120), *(a1 + 40) == 1);
    v6 = *a3;
  }

  else
  {
    v6 = 0;
  }

  CFRelease(v6);
}

void sub_1001A71A8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: wifi is off", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7214()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: on a moving network", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7280()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Active Ranging Session", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A72EC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: display is on", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7358()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: in carplay", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A73C4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: voip on going", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7430()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: call on going", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A749C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: media playing", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7508()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Awdl RealTime is active", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7574()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Airplay over Infra is active", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A75E0(double a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: timeSinceLinkUp %f", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition", *&a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A765C(double a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: timeSinceLastScan %f", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition", *&a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A76D8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: already tried enough times", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7744()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: not associated", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A77B0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no known networks", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A781C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: manager ref is null", "__WiFiDeviceManagerIsStateSuitableForNetworkTransition"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7888(void *a1, uint64_t a2)
{
  v4 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"Error initiating scan request: %d", a2}];
  }

  objc_autoreleasePoolPop(v4);
  free(a1);
}

void sub_1001A78F8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null scanData", "__WiFiDeviceManagerTransitionToNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7958()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: not now...", "__WiFiDeviceManagerTransitionToNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A79B8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: failed to create scan request", "__WiFiDeviceManagerTransitionToNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7A18()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no mru channels found", "__WiFiDeviceManagerTransitionToNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7A78(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"Error in scan: %d", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001A7AE0()
{
  sub_1000086C4();
  sub_100095008();
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    CFArrayGetCount(v1);
    sub_100026290();
  }

  objc_autoreleasePoolPop(v2);
  v3 = sub_100021D58();
  sub_100191FA0(v3, v4);
  if (CFArrayGetCount(v1) < 1)
  {
LABEL_9:
    v10 = objc_autoreleasePoolPush();
    v11 = sub_1000F8B2C();
    if (!v11)
    {
LABEL_12:
      sub_100010944();

      objc_autoreleasePoolPop(v13);
      return;
    }

    v12 = "%s: did not find the top network";
LABEL_11:
    [v11 WFLog:3 message:v12];
    goto LABEL_12;
  }

  v5 = 0;
  v6 = v0 + 4096;
  while (1)
  {
    ValueAtIndex = CFArrayGetValueAtIndex(v1, v5);
    if (ValueAtIndex)
    {
      v8 = ValueAtIndex;
      v9 = *(v0 + 3432);
      if (v9)
      {
        if (CFEqual(v9, v8))
        {
          break;
        }
      }
    }

    if (CFArrayGetCount(v1) <= ++v5)
    {
      goto LABEL_9;
    }
  }

  v15 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    sub_10000A878(v8);
    sub_100026290();
  }

  objc_autoreleasePoolPop(v15);
  if (!sub_1000F37B8(v0))
  {
    v34 = objc_autoreleasePoolPush();
    v11 = sub_1000F8B2C();
    if (!v11)
    {
      goto LABEL_12;
    }

    v12 = "%s: not now...";
    goto LABEL_11;
  }

  if (!*(v0 + 6704))
  {
    v31 = *(v0 + 3488);
    if (v31)
    {
      if (CFEqual(v8, v31))
      {
        v32 = objc_autoreleasePoolPush();
        if (off_100298C40)
        {
          sub_10000A878(v8);
          sub_1000F8A68();
        }

        objc_autoreleasePoolPop(v32);
        if (*(v6 + 2600) == 1)
        {
          *(v6 + 2600) = 0;
          v33 = objc_autoreleasePoolPush();
          v11 = sub_1000F8B2C();
          if (!v11)
          {
            goto LABEL_12;
          }

          v12 = "%s:Clearing colocatedScopeTransition state";
          goto LABEL_11;
        }

LABEL_36:
        sub_100010944();
        return;
      }
    }
  }

  ++*(v0 + 3448);
  *(v0 + 3456) = CFAbsoluteTimeGetCurrent();
  sub_1000BCCD4(v0);
  sub_100006F88(*(v0 + 64));
  sub_1000F8B44();
  sub_1000F8AB8();
  if (!sub_1000C9DD4(v16, v17, v18, v19, v20, v21, 0, 1013))
  {
    goto LABEL_36;
  }

  v22 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"%s: Error returned by Associate Async %d"];
  }

  objc_autoreleasePoolPop(v22);
  if (*(v0 + 6696) == 1)
  {
    *(v0 + 6696) = 0;
    v23 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:"%s:Clearing colocatedScopeTransition state"];
    }

    objc_autoreleasePoolPop(v23);
  }

  sub_1000329B4(v0);
  sub_100006F88(*(v0 + 64));
  sub_1000F8A18();
  sub_100010944();

  sub_1000D62B4(v24, v25, v26, v27, v28, v29);
}

void sub_1001A7DC4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no scan result", "__WiFiDeviceManagerNetworkTransitionScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7E30()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "__WiFiDeviceManagerNetworkTransitionScanCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7F04(uint64_t *a1, void ***a2)
{
  v2 = sub_10000843C(a1, a2);
  sub_1000F8BFC(COERCE_DOUBLE(3221225472), v2, v3);
  v4[2] = sub_1000F4750;
  v4[3] = &unk_10025EFD8;
  v4[4] = v6;
  v4[5] = v5;
  dispatch_async(v7, v4);
}

void sub_1001A7F48()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: network is NULL", "__WiFiDeviceManagerUserNotificationAssociationCallback"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A7FB4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: probeOptions is NULL !", "__WiFiDeviceManagerTriggerDpsACProbe"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A8014(const void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: probeSizeArrRef is NULL !", "__WiFiDeviceManagerTriggerDpsACProbe"}];
  }

  objc_autoreleasePoolPop(v2);
  CFRelease(a1);
}

void sub_1001A8080()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: numProbesRef is NULL !", "__WiFiDeviceManagerTriggerDpsACProbe"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A80E0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: manager is NULL !", "__WiFiDeviceManagerTriggerDpsACProbe"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A814C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null manager.", "__WiFiDeviceManagerTriggerOrSuppressSubsequentDpsProbes"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001A81AC(const void **a1, char a2, const __CFDate *a3)
{
  v6 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    v7 = sub_10000A878(*a1);
    if (a2)
    {
      v8 = "Instant";
    }

    else
    {
      v8 = "Auto instant";
    }

    Current = CFAbsoluteTimeGetCurrent();
    v10 = +[NSString stringWithFormat:](NSString, "stringWithFormat:", @"%s", [[NSString stringWithFormat:?];
    if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v12 = [+[NSString stringWithFormat:](NSString UTF8String:@"[WiFiPolicy] %s"];
      _os_log_impl(&_mh_execute_header, &_os_log_default, OS_LOG_TYPE_DEFAULT, "%{public}s", buf, 0xCu);
    }
  }

  objc_autoreleasePoolPop(v6);
}

id sub_1001A8354()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"Below minimum RSSI threshold";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A83C8()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"Join candidate not suitable for auto-join";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A843C()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No matching known network specified";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A84B0()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No join candidate specified";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

id sub_1001A8524()
{
  sub_1000F8A5C();
  *v1 = NSLocalizedDescriptionKey;
  *v2 = @"No auto-join manager configured";
  sub_1000F8AD0(NSDictionary, v2, v3, v4);
  result = [sub_100029DCC() errorWithDomain:? code:? userInfo:?];
  *v0 = result;
  return result;
}

void sub_1001A8598(unsigned int *a1, const void **a2, char a3)
{
  v6 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    v7 = sub_10000A878(*a2);
    v8 = "Auto instant";
    if (a3)
    {
      v8 = "Instant";
    }

    v9 = +[NSString stringWithFormat:](NSString, "stringWithFormat:", @"%s", [[NSString stringWithFormat:?];
    if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_DEFAULT))
    {
      *buf = 136446210;
      v11 = [+[NSString stringWithFormat:](NSString UTF8String:@"[WiFiPolicy] %s"];
      _os_log_impl(&_mh_execute_header, &_os_log_default, OS_LOG_TYPE_DEFAULT, "%{public}s", buf, 0xCu);
    }
  }

  objc_autoreleasePoolPop(v6);
}

void sub_1001A8720()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"No valid impact estimator ref"];
  }

  objc_autoreleasePoolPop(v0);
}

const __CFDictionary *sub_1001A957C(uint64_t a1, CFDictionaryRef *a2, const void *a3)
{
  v6 = sub_10009D548(a2, a3);
  v7 = v6;
  if (!a3)
  {
    if (v6)
    {
      Value = CFDictionaryGetValue(v6, @"EAPClientConfiguration");
      if (Value)
      {
        v9 = CFDictionaryGetValue(Value, @"UserPassword");
        v10 = CFRetain(a2);
        if (v10)
        {
          v11 = v10;
          if (sub_10000AFE4(v10))
          {
            v12 = v9 != 0;
            while (sub_10009F2A4(v11) && !v12)
            {
              v13 = objc_autoreleasePoolPush();
              if (off_100298C40)
              {
                [off_100298C40 WFLog:4 message:{"%s: did not manage to find password for HS2.0 account %@. Looking for next matching account...", "__WiFiDeviceCopyPreparedEAPProfile", sub_10000A878(v11)}];
              }

              objc_autoreleasePoolPop(v13);
              v14 = *(a1 + 16);
              v15 = sub_100009664(v14);
              v16 = sub_100060B60(v14, v15, v11);
              CFRelease(v11);
              if (!v16)
              {
                v19 = objc_autoreleasePoolPush();
                if (off_100298C40)
                {
                  [off_100298C40 WFLog:4 message:{"%s: did not manage to find password for HS2.0 network %@. No more matching HS2.0 account", "__WiFiDeviceCopyPreparedEAPProfile", sub_10000A878(a2)}];
                }

                objc_autoreleasePoolPop(v19);
                return v7;
              }

              if (v7)
              {
                CFRelease(v7);
              }

              v11 = v16;
              v17 = sub_10009D548(v16, 0);
              v7 = v17;
              v12 = v17 && (v18 = CFDictionaryGetValue(v17, @"EAPClientConfiguration")) != 0 && CFDictionaryGetValue(v18, @"UserPassword") != 0;
              if (!sub_10000AFE4(v11))
              {
                break;
              }
            }
          }

          CFRelease(v11);
        }
      }
    }
  }

  return v7;
}

void sub_1001A9760()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: network is null.", "__WiFiDeviceEAPConfigureWoWEapolFilterIfNeeded"}];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001A9D64(uint64_t *a1)
{
  sub_100106A0C();
  CWFErrorDescription();
  sub_1000305C4();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

uint64_t sub_1001A9DA8(void *a1)
{
  sub_100106A0C();
  CWFErrorDescription();
  sub_1000305C4();
  if (!CWFErrorWithDescription())
  {
    return 1;
  }

  result = [sub_100011430() response];
  if (result)
  {
    v3 = sub_10000845C([a1 response]);
    v4(v3);
    return 0;
  }

  return result;
}

uint64_t sub_1001A9E14(uint64_t *a1)
{
  sub_100024F98();
  CWFErrorDescription();
  sub_100024F98();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

uint64_t sub_1001A9E58(uint64_t *a1)
{
  CWFErrorDescription();
  sub_1000305C4();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

uint64_t sub_1001A9EA0(uint64_t *a1)
{
  sub_10000DBC0();
  CWFErrorDescription();
  sub_1000305C4();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

uint64_t sub_1001A9EE4(uint64_t *a1)
{
  CWFErrorDescription();
  sub_1000305C4();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

void sub_1001A9F2C(const void *a1, const void *a2, uint64_t *a3)
{
  CWFErrorDescription();
  *a3 = CWFErrorWithDescription();
  CFRelease(a1);

  CFRelease(a2);
}

void sub_1001A9FA4()
{
  sub_10001131C();
  CWFErrorDescription();
  sub_10000757C();
  v0 = CWFErrorWithDescription();
  v1 = sub_100011368(v0);
  CFRelease(v1);
}

void sub_1001A9FF8()
{
  sub_10001131C();
  sub_100029DDC();
  CWFErrorDescription();
  sub_10000757C();
  v0 = CWFErrorWithDescription();
  v1 = sub_100011368(v0);

  CFRelease(v1);
}

uint64_t sub_1001AA054()
{
  sub_10001131C();
  CWFErrorDescription();
  sub_10000757C();
  result = CWFErrorWithDescription();
  *v0 = result;
  return result;
}

void sub_1001AA0A4()
{
  sub_10001131C();
  sub_100029DDC();
  CWFErrorDescription();
  sub_10000757C();
  v0 = CWFErrorWithDescription();
  v1 = sub_100011368(v0);
  CFRelease(v1);
}

id sub_1001AA0F4()
{
  sub_100008C40();
  CWFErrorDescription();
  sub_10000757C();
  result = CWFErrorWithDescription();
  if (result)
  {
    result = [sub_100011430() response];
    if (result)
    {
      v2 = *([v0 response] + 2);

      return v2();
    }
  }

  return result;
}

uint64_t sub_1001AA198(uint64_t *a1)
{
  CWFErrorDescription();
  sub_1000305C4();
  result = CWFErrorWithDescription();
  *a1 = result;
  return result;
}

void sub_1001AA1E0(void *a1, uint64_t a2)
{
  if ([a1 response])
  {
    v3 = [a1 response];
    v3[2](v3, a2, 0);
  }
}

uint64_t sub_1001AA244()
{
  sub_100008C40();
  CWFErrorDescription();
  sub_10000757C();
  if (!CWFErrorWithDescription())
  {
    return 1;
  }

  result = [sub_100011430() response];
  if (result)
  {
    v2 = sub_10000845C([v0 response]);
    v3(v2);
    return 0;
  }

  return result;
}

uint64_t sub_1001AA2B8(void *a1)
{
  sub_100024F98();
  CWFErrorDescription();
  sub_100024F98();
  if (!CWFErrorWithDescription())
  {
    return 1;
  }

  result = [sub_100011430() response];
  if (result)
  {
    v3 = sub_10000845C([a1 response]);
    v4(v3);
    return 0;
  }

  return result;
}

void sub_1001AA3C0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null _applications", "-[WiFiAppStateManager _unRegisterApplication:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA42C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null bundleID", "-[WiFiAppStateManager _unRegisterApplication:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA498()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null _applications", "-[WiFiAppStateManager _registerApplication:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA4F8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null capabilitiesRef", "-[WiFiAppStateManager _registerApplication:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA558()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null bundleID", "-[WiFiAppStateManager _registerApplication:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA5C4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: Nil queue", "-[WiFiAppStateManager _setApplicationState:active:underLock:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA630()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: No queue", "-[WiFiAppStateManager _setApplicationState:active:underLock:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA690()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null background applications", "-[WiFiAppStateManager _setApplicationState:active:underLock:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA6FC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null active applications", "-[WiFiAppStateManager _setApplicationState:active:underLock:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA768()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null bundleID", "-[WiFiAppStateManager _setApplicationState:active:underLock:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA7D4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null bundleID", "-[WiFiAppStateManager _appStateChanged:bundleID:capabilities:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA840()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null _applicationStateMonitor", "-[WiFiAppStateManager _getAppCapabilitiesForBundleID:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AA8AC(uint64_t a1, void *a2)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_10010A0C4();
    sub_100008470();
    _os_log_error_impl(v3, v4, v5, v6, v7, 0x12u);
  }

  *a2 = 0;
}

void sub_1001AA960()
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_10010A0C4();
    sub_100008470();
    _os_log_error_impl(v0, v1, v2, v3, v4, 0x12u);
  }
}

void sub_1001AAA0C(uint64_t a1, uint64_t a2, void *a3)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100024FA4();
    sub_10000DBCC();
    sub_100008470();
    _os_log_error_impl(v5, v6, v7, v8, v9, 0x1Cu);
  }

  *a3 = a2;
}

void sub_1001AAAD4(uint64_t a1, uint64_t a2, void *a3)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100024FA4();
    sub_10000DBCC();
    sub_100008470();
    _os_log_error_impl(v5, v6, v7, v8, v9, 0x1Cu);
  }

  *a3 = a2;
}

void sub_1001AAB9C(uint64_t *a1)
{
  v6 = *a1;
  sub_100008470();
  _os_log_error_impl(v1, v2, v3, v4, v5, 0x16u);
}

void sub_1001AAC30()
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
  }
}

void sub_1001AACCC()
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v0, v1, v2, v3, v4, 0xCu);
  }
}

void sub_1001AAD68()
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_DEFAULT))
  {
    v0[0] = 136315394;
    sub_100024FA4();
    v1 = @"/tmp/Centauri/wifi-assert-strings.bin";
    _os_log_impl(&_mh_execute_header, &_os_log_default, OS_LOG_TYPE_DEFAULT, "%s: error opening file %@", v0, 0x16u);
  }
}

void sub_1001AAE10()
{
  sub_10010A0C4();
  sub_100008470();
  _os_log_error_impl(v0, v1, v2, v3, v4, 0x12u);
}

void sub_1001AAE98(void *a1, void *a2, void *a3)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v6, v7, v8, v9, v10, 0xCu);
  }
}

void sub_1001AAF5C(void *a1, void *a2)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v4, v5, v6, v7, v8, 0xCu);
  }
}

void sub_1001AB010(void *a1)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v2, v3, v4, v5, v6, 0xCu);
  }
}

void sub_1001AB0BC(void *a1)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100008470();
    _os_log_error_impl(v2, v3, v4, v5, v6, 0x16u);
  }
}

void sub_1001AB17C(uint64_t a1, void *a2)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100024FA4();
    sub_100008470();
    _os_log_error_impl(v3, v4, v5, v6, v7, 0x16u);
  }
}

void sub_1001AB230(uint64_t a1, void *a2)
{
  if (os_log_type_enabled(&_os_log_default, OS_LOG_TYPE_ERROR))
  {
    sub_100024FA4();
    sub_100008470();
    _os_log_error_impl(v3, v4, v5, v6, v7, 0x16u);
  }
}

uint64_t sub_1001AB3EC(const __CFAllocator *a1, CFIndex a2)
{
  if (!qword_100298AE0)
  {
    pthread_once(&stru_100297C90, sub_10010A11C);
  }

  Instance = _CFRuntimeCreateInstance();
  v5 = Instance;
  if (Instance)
  {
    *(Instance + 64) = 0u;
    *(Instance + 80) = 0u;
    *(Instance + 32) = 0u;
    *(Instance + 48) = 0u;
    *(Instance + 16) = 0u;
    *(Instance + 24) = a2;
    Mutable = CFArrayCreateMutable(a1, a2, &kCFTypeArrayCallBacks);
    *(v5 + 16) = Mutable;
    if (Mutable && (v7 = CFSetCreateMutable(kCFAllocatorDefault, 0, &kCFTypeSetCallBacks), (*(v5 + 80) = v7) != 0))
    {
      *(v5 + 72) = 0;
    }

    else
    {
      CFRelease(v5);
      return 0;
    }
  }

  return v5;
}

void sub_1001AB4C8(uint64_t a1)
{
  if (a1)
  {
    v1 = *(a1 + 64);
    if (v1)
    {
      dispatch_source_set_timer(v1, 0xFFFFFFFFFFFFFFFFLL, 0xFFFFFFFFFFFFFFFFLL, 0);
    }
  }
}

void sub_1001AB4E8(uint64_t a1)
{
  *(a1 + 72) = 0;
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: retrying command", "__WiFiCommandQueueTimerCallback"}];
  }

  objc_autoreleasePoolPop(v2);

  sub_100026684(a1);
}

void sub_1001AB564(uint64_t a1, uint64_t a2)
{
  valuePtr = a2;
  if (a1)
  {
    Count = CFArrayGetCount(*(a1 + 16));
    if (Count >= 1)
    {
      v4 = Count;
      v5 = 0;
      while (1)
      {
        v9 = 0xAAAAAAAAAAAAAAAALL;
        ValueAtIndex = CFArrayGetValueAtIndex(*(a1 + 16), v5);
        if (ValueAtIndex)
        {
          v11.location = 0;
          v11.length = 8;
          CFDataGetBytes(ValueAtIndex, v11, &v9);
          if (valuePtr == v9)
          {
            v7 = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt64Type, &valuePtr);
            if (v7)
            {
              break;
            }
          }
        }

        if (v4 == ++v5)
        {
          return;
        }
      }

      v8 = v7;
      CFSetAddValue(*(a1 + 80), v7);
      CFRelease(v8);
    }
  }
}

void sub_1001AB638(uint64_t a1)
{
  if (a1)
  {
    v2 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:"Resetting deferred command queue IDs"];
    }

    objc_autoreleasePoolPop(v2);
    idx = -1;
    v3 = sub_1000262D0(a1, &idx);
    CFSetRemoveAllValues(*(a1 + 80));
    if (v3)
    {
      ValueAtIndex = CFArrayGetValueAtIndex(*(a1 + 16), idx);
      CFArrayInsertValueAtIndex(*(a1 + 16), 0, ValueAtIndex);
      CFArrayRemoveValueAtIndex(*(a1 + 16), idx + 1);
    }

    else
    {
      sub_1000264E8(a1, 0);
    }
  }
}

void sub_1001AB6F8(void *a1)
{
  v2 = +[NSAssertionHandler currentHandler];
  v3 = [NSString stringWithUTF8String:"void *SpringBoardServicesLibrary(void)"];
  [v2 handleFailureInFunction:v3 file:@"WiFiSmartCoverStateObserver.h" lineNumber:17 description:{@"%s", *a1}];

  __break(1u);
}

void sub_1001AB778()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: motionServices is null", "registerSmartCoverStateInitialize"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AB7E4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null smartCoverStateChangeCb", "registerSmartCoverStateInitialize"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AB850()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "registerSmartCoverStateInitialize"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AB8BC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"smartCoverStateChangeCb is NULL!"];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001AB9C4(NSObject **a1, void *a2)
{
  v4 = CWFGetOSLog();
  if (v4)
  {
    v5 = CWFGetOSLog();
  }

  else
  {
    v5 = &_os_log_default;
    v6 = &_os_log_default;
  }

  result = os_log_type_enabled(v5, OS_LOG_TYPE_DEFAULT);
  if (result)
  {
    result = _os_log_send_and_compose_impl();
  }

  *a2 = 0;
  *a1 = v5;
  return result;
}

void sub_1001ABA80()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: Error: User Settings CWFKeyValueStore alloc failed", "-[WiFiUserSettingsStore init]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ABAE0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: KVS change disregarded, syncing not enabled", "-[WiFiUserSettingsStore _kvsDidChangeWithKeys:isExternal:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ABB4C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: local changed to KVS keys='%@'", "-[WiFiUserSettingsStore _kvsDidChangeWithKeys:isExternal:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001ABBBC(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: auto hotspot mode change disregarded, syncing not enabled (new value: %ld)", "-[WiFiUserSettingsStore setAutoInstantHotspotMode:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001ABC2C(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: ask to join mode change disregarded, syncing not enabled (new value: %ld)", "-[WiFiUserSettingsStore setAskToJoinMode:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001ABE30(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"Zero(0) message identifier, bail."}];
  }

  objc_autoreleasePoolPop(v2);
  v3 = [NSError errorWithDomain:@"com.apple.wifi.analytics.errordomain" code:9010 userInfo:0];
  (*(a1 + 16))(a1, 0, v3);
}

void sub_1001ABEC0(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s NULL reply supplied trying to process: %u", "-[WiFiManagerAnalytics prepareMessageForSubmission:withData:andReply:]_block_invoke", *(a1 + 48)}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001ABF34()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: failed to get deviceIdentifier", "-[WiFiManagerAnalytics __copyHashOfSSID:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ABFA0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s Failed to get key kWiFiDPSSypmtom", "-[WiFiManagerAnalytics _populateDPSNotificationMessage:andReply:]_block_invoke"}];
  }

  objc_autoreleasePoolPop(v0);
}

void *sub_1001AC000()
{
  if (!qword_100298B08)
  {
    pthread_once(&stru_100297D00, sub_10010DA90);
  }

  result = _CFRuntimeCreateInstance();
  if (result)
  {
    result[2] = 0;
    result[3] = 0;
    result[4] = 0;
  }

  return result;
}

uint64_t sub_1001AC0C4(uint64_t a1)
{
  result = sub_10001D1DC(a1);
  if (result)
  {
    v3 = v1[6];
    if (Apple80211EventMonitoringInit2())
    {
      v9 = objc_autoreleasePoolPush();
      if (off_100298C40)
      {
        [off_100298C40 WFLog:4 message:{"%s: Unable to init event monitoring", "WiFiVirtualInterfaceMonitorEvents"}];
      }

      objc_autoreleasePoolPop(v9);
    }

    else
    {
      v4 = v1[2];
      if (!Apple80211StartMonitoringEvent())
      {
        v5 = v1[2];
        if (!Apple80211StartMonitoringEvent())
        {
          v6 = v1[2];
          if (!Apple80211StartMonitoringEvent())
          {
            return v1[2];
          }
        }
      }
    }

    if (v1[2])
    {
      v7 = objc_autoreleasePoolPush();
      if (off_100298C40)
      {
        [off_100298C40 WFLog:4 message:{"%s: failed to start event monitoring on %@", "WiFiVirtualInterfaceMonitorEvents", v1[5]}];
      }

      objc_autoreleasePoolPop(v7);
      v8 = v1[2];
      Apple80211EventMonitoringHalt();
      result = 0;
      v1[2] = 0;
    }

    else
    {
      return 0;
    }
  }

  return result;
}

CFDataRef sub_1001AC1E0(uint64_t a1)
{
  *buffer = 0;
  v16 = 0;
  v2 = *(a1 + 184);
  if (!v2 || ![v2 isEnabled])
  {
    v5 = *(a1 + 32);
    if (v5)
    {
      Value = CFDictionaryGetValue(v5, @"VIRT_IF_NAME");
      if (Value)
      {
        v7 = Value;
        SystemEncoding = CFStringGetSystemEncoding();
        CFStringGetCString(v7, buffer, 16, SystemEncoding);
        *v17 = xmmword_1001CE820;
        v18 = 3;
        v19 = if_nametoindex(buffer);
        size = 0;
        sysctl(v17, 6u, 0, &size, 0, 0);
        if (size)
        {
          v9 = malloc_type_malloc(size, 0xDE39BB77uLL);
          if (v9)
          {
            v10 = v9;
            if (sysctl(v17, 6u, v9, &size, 0, 0) < 0)
            {
              v13 = objc_autoreleasePoolPush();
              if (off_100298C40)
              {
                [off_100298C40 WFLog:3 message:{"%s: sysctl failed.", "WiFiVirtualInterfaceCopyMACAddress"}];
              }

              objc_autoreleasePoolPop(v13);
              v11 = 0;
            }

            else
            {
              v11 = CFDataCreate(kCFAllocatorDefault, &v10[v10[117] + 120], 6);
            }

            free(v10);
            return v11;
          }

          v12 = objc_autoreleasePoolPush();
          if (off_100298C40)
          {
            [off_100298C40 WFLog:3 message:{"%s: reqBuff is NULL.", "WiFiVirtualInterfaceCopyMACAddress"}];
          }
        }

        else
        {
          v12 = objc_autoreleasePoolPush();
          if (off_100298C40)
          {
            [off_100298C40 WFLog:3 message:{"%s: failed to get mib length.", "WiFiVirtualInterfaceCopyMACAddress"}];
          }
        }

        objc_autoreleasePoolPop(v12);
      }
    }

    return 0;
  }

  v3 = [objc_msgSend(*(a1 + 184) "macAddress")];
  if (!v3)
  {
    return 0;
  }

  return CFRetain(v3);
}

uint64_t sub_1001AC428(uint64_t a1, __CFDictionary **a2)
{
  valuePtr = 0;
  result = 4294963396;
  if (!a1 || !a2)
  {
    return result;
  }

  v5 = *(a1 + 32);
  if (!v5)
  {
    return 4294963393;
  }

  Value = CFDictionaryGetValue(v5, @"VIRT_IF_ROLE");
  if (!Value)
  {
    return 4294963393;
  }

  CFNumberGetValue(Value, kCFNumberSInt32Type, &valuePtr);
  if (valuePtr != 6)
  {
    return 4294963393;
  }

  v7 = *(a1 + 184);
  if (v7)
  {
    v8 = [v7 isEnabled] ^ 1;
  }

  else
  {
    v8 = 1;
  }

  Mutable = CFDictionaryCreateMutable(kCFAllocatorDefault, 0, &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);
  if (!Mutable)
  {
    return 4294963395;
  }

  v10 = Mutable;
  if (sub_10014E1FC(*(a1 + 24), *(a1 + 40)))
  {
    v11 = kCFBooleanTrue;
  }

  else
  {
    v11 = kCFBooleanFalse;
  }

  CFDictionarySetValue(v10, @"LINK_CHANGED_IS_AVAILABLE", v11);
  if (v8)
  {
    v12 = kCFBooleanTrue;
  }

  else
  {
    v12 = kCFBooleanFalse;
  }

  CFDictionarySetValue(v10, @"LINK_CHANGED_IS_LINKDOWN", v12);
  if (*(a1 + 224))
  {
    v13 = [*(a1 + 192) queryPeerDatabase];
    if (v13)
    {
      v14 = CFRetain(v13);
      if (v14)
      {
        v15 = v14;
        sub_100024F28(v14, @"LINK_CHANGED_PEER_LIST");
        CFRelease(v15);
      }
    }
  }

  v16 = CFDictionaryCreateMutable(kCFAllocatorDefault, 0, &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);
  if (!v16)
  {
    CFRelease(v10);
    return 4294963395;
  }

  v17 = v16;
  v18 = sub_1001AC1E0(a1);
  if (v18)
  {
    v19 = v18;
    CFDictionarySetValue(v17, @"AWDL_IF_MAC_ADDRESS", v18);
    CFRelease(v19);
  }

  theDict = 0;
  sub_1001AC74C(a1, &theDict);
  if (theDict)
  {
    v20 = CFDictionaryGetValue(theDict, @"AWDL_INFO_PREFERRED_CHANNEL");
    v21 = CFDictionaryGetValue(theDict, @"AWDL_INFO_PEER_MASTER_CHANNEL");
    v29 = CFDictionaryGetValue(theDict, @"AWDL_INFO_EXT");
    if (v20)
    {
      CFDictionarySetValue(v17, @"AWDL_INFO_PREFERRED_CHANNEL", v20);
    }

    if (v21)
    {
      CFDictionarySetValue(v17, @"AWDL_INFO_PEER_MASTER_CHANNEL", v21);
    }

    if (sub_10014D6A8(*(a1 + 24), v22, v23, v24, v25, v26, v27, v28, v35, v36, theDict, v38, valuePtr, v40, v41, v42, v43, v44, v45, v46, v47) && v29)
    {
      CFDictionarySetValue(v17, @"AWDL_INFO_EXT", v29);
    }

    v30 = *(a1 + 232);
    if (v30)
    {
      CFRelease(v30);
      *(a1 + 232) = 0;
    }

    *(a1 + 232) = CFRetain(theDict);
    if (theDict)
    {
      CFRelease(theDict);
      theDict = 0;
    }
  }

  HIDWORD(v36) = sub_10010F604(a1);
  v31 = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt32Type, &v36 + 4);
  if (v31)
  {
    v32 = v31;
    CFDictionarySetValue(v17, @"AWDL_INFO_SUPPORTED_CHANNEL_FLAGS", v31);
    CFRelease(v32);
  }

  LODWORD(v36) = 2;
  v33 = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt32Type, &v36);
  if (v33)
  {
    v34 = v33;
    CFDictionarySetValue(v17, @"AWDL_INFO_ASSISTED_DISCOVERY_METRIC", v33);
    CFRelease(v34);
  }

  sub_100024F28(v33, @"AWDL_INFO");
  CFRelease(v17);
  result = 0;
  *a2 = v10;
  return result;
}

uint64_t sub_1001AC74C(uint64_t a1, CFMutableDictionaryRef *a2)
{
  if (!a1 || !a2)
  {
    v13 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: null params.", "WiFiVirtualInterfaceCopyAwdlPreferredChannels"}];
    }

    goto LABEL_18;
  }

  if (!*(a1 + 184))
  {
    v13 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: no awdl state", "WiFiVirtualInterfaceCopyAwdlPreferredChannels"}];
    }

LABEL_18:
    objc_autoreleasePoolPop(v13);
    return 4294963396;
  }

  *a2 = 0;
  Mutable = CFDictionaryCreateMutable(kCFAllocatorDefault, 0, &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);
  if (!Mutable)
  {
    return 4294963395;
  }

  v5 = Mutable;
  *bytes = -21846;
  valuePtr = [objc_msgSend(*(a1 + 184) "peerPrimaryPreferredChannel")];
  v14 = 0;
  if (!sub_100060188(*(a1 + 24), valuePtr, &v14))
  {
    valuePtr = v14;
  }

  v6 = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt16Type, &valuePtr);
  if (!v6)
  {
    goto LABEL_12;
  }

  v7 = v6;
  sub_100024F28(v6, @"AWDL_INFO_PREFERRED_CHANNEL");
  CFRelease(v7);
  valuePtr = [objc_msgSend(*(a1 + 184) "peerMasterChannel")];
  v8 = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt16Type, &valuePtr);
  if (!v8 || (v9 = v8, sub_100024F28(v8, @"AWDL_INFO_PEER_MASTER_CHANNEL"), CFRelease(v9), *bytes = [objc_msgSend(*(a1 + 184) "peerSecondaryPreferredChannel")], (v10 = CFDataCreate(kCFAllocatorDefault, bytes, 2)) == 0))
  {
LABEL_12:
    CFRelease(v5);
    return 4294963395;
  }

  v11 = v10;
  CFDictionarySetValue(v5, @"AWDL_INFO_EXT", v10);
  CFRelease(v11);
  result = 0;
  *a2 = v5;
  return result;
}

uint64_t sub_1001AC940(uint64_t a1)
{
  if (!*(a1 + 16))
  {
    return 4294963393;
  }

  for (i = 6; ; --i)
  {
    result = Apple80211SetPowerState();
    if (result != -3905 && result != 61 && result != 16)
    {
      break;
    }

    if (!i)
    {
      break;
    }

    sub_10000390C();
    v5 = *(a1 + 16);
  }

  return result;
}

uint64_t sub_1001AC9AC(uint64_t a1)
{
  if (!sub_10001D1DC(a1))
  {
    return 4294963393;
  }

  v1[9] = v2;
  v1[10] = v3;
  for (i = 6; ; --i)
  {
    v5 = Apple80211ScanAsync();
    v6 = v5;
    v7 = v5 == -3905 || v5 == 16;
    if (!v7 && v5 != 61 || !i)
    {
      break;
    }

    sub_10000390C();
    v8 = v1[2];
  }

  if (v5)
  {
    sub_10010F8D4(v1, v1[5], 0, v5);
  }

  return v6;
}

uint64_t sub_1001ACA3C(void *a1, uint64_t a2, uint64_t a3, uint64_t a4, int a5, uint64_t a6, uint64_t a7)
{
  if (!a1[2])
  {
    return 4294963393;
  }

  a1[7] = a6;
  a1[8] = a7;
  v8 = 6;
  if (a5)
  {
    while (1)
    {
      result = Apple80211AssociateAsync();
      if (result != -3905 && result != 61 && result != 16)
      {
        break;
      }

      if (!v8)
      {
        break;
      }

      sub_10000390C();
      v11 = a1[2];
      --v8;
    }
  }

  else
  {
    while (1)
    {
      result = Apple80211Associate();
      if (result != -3905 && result != 61 && result != 16)
      {
        break;
      }

      if (!v8)
      {
        break;
      }

      sub_10000390C();
      v12 = a1[2];
      --v8;
    }
  }

  return result;
}

uint64_t sub_1001ACAEC(uint64_t a1)
{
  if (!sub_10001D1DC(a1))
  {
    return 4294963393;
  }

  v5 = v2;
  v1[11] = v3;
  v1[12] = v4;
  for (i = 6; ; --i)
  {
    v7 = Apple80211Set();
    v8 = v7;
    v9 = v7 == -3905 || v7 == 16;
    if (!v9 && v7 != 61 || !i)
    {
      break;
    }

    sub_10000390C();
    v10 = v1[2];
  }

  if (v7)
  {
    v12 = v1[11];
    v11 = v1[12];
    v1[11] = 0;
    v1[12] = 0;
    if (v12)
    {
      v12(v1[3], v5, v7, v11);
    }

    sub_10002ECA0(v1[3]);
  }

  return v8;
}

uint64_t sub_1001ACBA8(uint64_t a1)
{
  if (!sub_10001D1DC(a1))
  {
    return 4294963393;
  }

  for (i = 6; ; --i)
  {
    result = Apple80211Disassociate();
    if (result != -3905 && result != 61 && result != 16)
    {
      break;
    }

    if (!i)
    {
      break;
    }

    sub_10000390C();
    v5 = *(v1 + 16);
  }

  return result;
}

CFHashCode sub_1001ACC00(uint64_t a1)
{
  v1 = sub_1001AC1E0(a1);
  v2 = CFHash(v1);
  if (v1)
  {
    CFRelease(v1);
  }

  return v2;
}

void sub_1001ACC3C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"invalid args: virtInf:%s, eventDict:%s", "Null", "non-Null"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ACCB0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null property.", "WiFiVirtualInterfaceSetProperty"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ACD1C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null key.", "WiFiVirtualInterfaceSetProperty"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ACD88()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null virtInf.", "WiFiVirtualInterfaceSetProperty"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ACDF4(uint64_t a1, __CFDictionary **a2, int *a3)
{
  memset(v19, 0, sizeof(v19));
  Mutable = CFDictionaryCreateMutable(kCFAllocatorDefault, 0, &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);
  if (Mutable)
  {
    v7 = Mutable;
    v8 = sub_1001AC1E0(a1);
    if (v8)
    {
      v9 = v8;
      BytePtr = CFDataGetBytePtr(v8);
      v11 = ether_ntoa(BytePtr);
      if (v11)
      {
        v12 = v11;
        SystemEncoding = CFStringGetSystemEncoding();
        v14 = CFStringCreateWithCString(kCFAllocatorDefault, v12, SystemEncoding);
        if (v14)
        {
          v15 = v14;
          CFDictionarySetValue(v7, @"BSSID", v14);
          CFRelease(v15);
        }
      }

      CFDictionarySetValue(v7, @"STATION_MAC", v9);
      CFRelease(v9);
    }

    CFDictionarySetValue(v7, @"SSID_STR", &stru_1002680F8);
    v16 = CFDataCreate(kCFAllocatorDefault, v19, 32);
    if (v16)
    {
      v17 = v16;
      CFDictionarySetValue(v7, @"SSID", v16);
      v18 = 0;
      *a2 = v7;
      v7 = v17;
    }

    else
    {
      v18 = -3901;
    }

    CFRelease(v7);
  }

  else
  {
    v18 = -3901;
  }

  *a3 = v18;
}

void sub_1001ACF78()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null follow mode policy.", "WiFiVirtualInterfaceStartAwdl"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001ACFE4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: timed out waiting for assisted discovery registration", "WiFiVirtualInterfaceStartAwdl"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD044()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no AWDL request", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD0A4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null peer Context array.", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD104()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null peerContext.", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD170()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null policy.", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD1DC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null ifname.", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD248()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null AWDL interface.", "__WiFiVirtualInterfaceCreateFollowModePolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD2B4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: no AWDL request", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD314()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null peer Context array.", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD374()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null peerContext.", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD3E0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null policy.", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD44C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null ifname.", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD4B8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null AWDL interface.", "__WiFiVirtualInterfaceCreateAssistedDiscoveryPolicyFromRequest"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD524()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:"Failed to send traffic registration because failed to parse dictionary"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD570()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null follow mode policy.", "WiFiVirtualInterfaceStopAwdl"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AD634(uint64_t a1, uint64_t a2, char *a3)
{
  v5 = sub_1001AC1E0(a1);
  v6 = sub_1001AC1E0(a2);
  if (CFEqual(v5, v6))
  {
    if (v5)
    {
      CFRelease(v5);
    }

    v7 = 1;
    v8 = 1;
    if (v6)
    {
LABEL_5:
      CFRelease(v6);
      v8 = v7;
    }
  }

  else
  {
    if (v5)
    {
      CFRelease(v5);
    }

    v7 = 0;
    v8 = 0;
    if (v6)
    {
      goto LABEL_5;
    }
  }

  *a3 = v8;
}

_OWORD *sub_1001AD6C8()
{
  if (!qword_100298B28)
  {
    pthread_once(&stru_100297D80, sub_1001115F8);
  }

  Instance = _CFRuntimeCreateInstance();
  v1 = Instance;
  if (Instance)
  {
    Instance[2] = 0u;
    Instance[3] = 0u;
    Instance[1] = 0u;
    *(Instance + 16) = 0;
    Mutable = CFArrayCreateMutable(kCFAllocatorDefault, 0, &kCFTypeArrayCallBacks);
    *(v1 + 3) = Mutable;
    if (Mutable)
    {
      *(v1 + 57) = 0;
      if (objc_opt_class())
      {
        *(v1 + 58) = [+[LockdownModeManager shared](LockdownModeManager "shared")];
      }
    }

    else
    {
      CFRelease(v1);
      return 0;
    }
  }

  return v1;
}

void sub_1001AD798(uint64_t a1)
{
  if (!a1)
  {
    return;
  }

  v2 = *(a1 + 24);
  if (v2 && CFArrayGetCount(v2))
  {
    Count = CFArrayGetCount(*(a1 + 24));
    if (CFArrayGetCount(*(a1 + 24)) >= 1)
    {
      for (i = 0; i < CFArrayGetCount(*(a1 + 24)); ++i)
      {
        ValueAtIndex = CFArrayGetValueAtIndex(*(a1 + 24), i);
        if (ValueAtIndex)
        {
          v6 = ValueAtIndex;
          Current = CFAbsoluteTimeGetCurrent();
          sub_1001AE568(v6);
          Value = CFDictionaryGetValue(v6, @"atjHistTblEntCreationTimeStamp");
          if (!Value)
          {
            goto LABEL_27;
          }

          AbsoluteTime = CFDateGetAbsoluteTime(Value);
          if (AbsoluteTime == 0.0 || Current <= AbsoluteTime)
          {
            v20 = objc_autoreleasePoolPush();
            if (off_100298C40)
            {
              v28 = v20;
              [off_100298C40 WFLog:3 message:{"%s: current time is less than creation time", "__WiFiATJMgrATJHistTblEntGetAverageInRangeTime"}];
              v20 = v28;
            }

            objc_autoreleasePoolPop(v20);
LABEL_27:
            if (!CFEqual(v6, *(a1 + 32)))
            {
              CFArrayRemoveValueAtIndex(*(a1 + 24), i--);
            }

            continue;
          }

          sub_10000847C();
          if (v12)
          {
            v13 = 1;
          }

          else
          {
            v13 = 0;
          }

          if (v11 < dbl_1001CE840[v13])
          {
            goto LABEL_27;
          }

          v14 = CFAbsoluteTimeGetCurrent();
          v15 = CFDictionaryGetValue(v6, @"atjHistTblEntCreationTimeStamp");
          if (v15)
          {
            v16 = CFDateGetAbsoluteTime(v15);
            if (v16 == 0.0 || v14 <= v16)
            {
              v21 = objc_autoreleasePoolPush();
              if (off_100298C40)
              {
                [off_100298C40 WFLog:3 message:{"%s: current time is less than last seen time", "__WiFiATJMgrATJHistTblEntGetTimeElapsedSinceLastSeen"}];
              }

              objc_autoreleasePoolPop(v21);
              continue;
            }

            sub_10000847C();
            v19 = v12;
            if (v18 > dbl_1001CE850[v19])
            {
              goto LABEL_27;
            }
          }
        }
      }
    }

    v22 = objc_autoreleasePoolPush();
    v23 = off_100298C40;
    if (!off_100298C40)
    {
      goto LABEL_38;
    }

    v26 = Count;
    v27 = CFArrayGetCount(*(a1 + 24));
    v24 = "ATJManager: entries before cleanup %ld, entries after cleanup %ld";
    v25 = v23;
  }

  else
  {
    v22 = objc_autoreleasePoolPush();
    v25 = off_100298C40;
    if (!off_100298C40)
    {
      goto LABEL_38;
    }

    v24 = "ATJManager: no entries to purge";
  }

  [v25 WFLog:3 message:{v24, v26, v27}];
LABEL_38:

  objc_autoreleasePoolPop(v22);
}

void sub_1001ADA24(uint64_t a1, unsigned int a2)
{
  if (a1)
  {
    if (*(a1 + 58))
    {
      v4 = objc_autoreleasePoolPush();
      if (off_100298C40)
      {
        [off_100298C40 WFLog:3 message:{"%s: Lockdown Mode is enabled, ignoring SetATJMode %ld", "WiFiATJMgrSetATJMode", a2}];
      }

      objc_autoreleasePoolPop(v4);
    }

    else if (*(a1 + 16) != a2)
    {
      *(a1 + 16) = a2;
      if (!a2)
      {
        v5 = *(a1 + 32);
        if (v5)
        {
          CFRelease(v5);
          *(a1 + 32) = 0;
        }

        *(a1 + 40) = 0;
        *(a1 + 48) = 0;
        *(a1 + 56) = 0;
        v6 = *(a1 + 24);

        CFArrayRemoveAllValues(v6);
      }
    }
  }
}

void sub_1001ADB08(uint64_t a1, int a2)
{
  if (a1)
  {
    *(a1 + 57) = a2;
    v3 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      v4 = "enabled";
      if (!a2)
      {
        v4 = "disabled";
      }

      [off_100298C40 WFLog:3 message:{"ATJManager: atj test mode %s ", v4}];
    }

    objc_autoreleasePoolPop(v3);
  }
}

uint64_t sub_1001ADB94(uint64_t result)
{
  if (result)
  {
    return *(result + 57);
  }

  return result;
}

uint64_t sub_1001ADBA0(uint64_t result)
{
  if (result)
  {
    return *(result + 20);
  }

  return result;
}

uint64_t sub_1001ADBAC(uint64_t result)
{
  if (result)
  {
    return *(result + 16);
  }

  return result;
}

BOOL sub_1001ADBB8(uint64_t a1, _BOOL8 a2, const __CFArray *a3, uint64_t a4)
{
  Current = CFAbsoluteTimeGetCurrent();
  if (!a1)
  {
    return 0;
  }

  v9 = Current;
  v10 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    if (*(a1 + 20) == 1)
    {
      v11 = "Interactive";
    }

    else
    {
      v11 = "NonInteractive";
    }

    [off_100298C40 WFLog:3 message:{"ATJManager: atjAction=%d atjEnabled=%d userInteractionMode=%s discovered %ld networks", a4, *(a1 + 16), v11, CFArrayGetCount(a2)}];
  }

  objc_autoreleasePoolPop(v10);
  if (a2)
  {
    if (!CFArrayGetCount(a2) || *(a1 + 20) != 1)
    {
LABEL_58:
      a2 = 0;
      goto LABEL_119;
    }

    if (a4 != 3)
    {
      Count = CFArrayGetCount(a2);
      if (a3)
      {
        if (Count && CFArrayGetCount(a3) && CFArrayGetCount(a2) >= 1)
        {
          v13 = 0;
          while (1)
          {
            ValueAtIndex = CFArrayGetValueAtIndex(a2, v13);
            if (ValueAtIndex)
            {
              v15 = ValueAtIndex;
              v79.length = CFArrayGetCount(a3);
              v79.location = 0;
              if (CFArrayContainsValue(a3, v79, v15))
              {
                break;
              }
            }

            if (++v13 >= CFArrayGetCount(a2))
            {
              goto LABEL_19;
            }
          }

          v41 = objc_autoreleasePoolPush();
          if (off_100298C40)
          {
            [off_100298C40 WFLog:3 message:{"%s: in range of preferred network.", "__WiFiATJMgrIsPreferredNetworkInRange"}];
          }

          objc_autoreleasePoolPop(v41);
          goto LABEL_58;
        }
      }
    }

LABEL_19:
    v80.length = CFArrayGetCount(a2);
    v80.location = 0;
    CFArraySortValues(a2, v80, sub_1000A0950, 0);
    v16 = *(a1 + 32);
    if (v16)
    {
      if (sub_1001AE46C(v16, a2))
      {
        v35 = *(a1 + 40);
        v36 = v9 - v35;
        v19 = v35 == 0.0;
        v37 = 0.0;
        if (!v19)
        {
          v37 = v36;
        }

        if (v37 > 1800.0)
        {
          v37 = 1800.0;
        }

        *(a1 + 48) = *(a1 + 48) + v37;
        v38 = objc_autoreleasePoolPush();
        if (off_100298C40)
        {
          v39 = "monitored";
          if (!*(a1 + 56))
          {
            v39 = "unmonitored";
          }

          [off_100298C40 WFLog:3 message:{"ATJManager: device still at %s atj point for %f seconds", v39, *(a1 + 48)}];
        }

        objc_autoreleasePoolPop(v38);
        v40 = *(a1 + 32);
        if (v40)
        {
          a2 = 0;
LABEL_96:
          v62 = CFAbsoluteTimeGetCurrent();
          v63 = CFDateCreate(kCFAllocatorDefault, v62);
          if (v63)
          {
            v64 = v63;
            CFDictionarySetValue(v40, @"atjHistTblEntLastSeenTimeStamp", v63);
            CFRelease(v64);
          }

LABEL_98:
          if (a4 == 2)
          {
            sub_10000847C();
            if (v19)
            {
              v65 = 18000.0;
            }

            else
            {
              v65 = 120.0;
            }
          }

          else
          {
            v65 = 0.0;
            if (a4 == 1)
            {
              sub_10000847C();
              if (v19)
              {
                v65 = 60.0;
              }

              else
              {
                v65 = 5.0;
              }
            }
          }

          v70 = *(a1 + 32);
          if (v70)
          {
            if (sub_1001AE568(v70) + *(a1 + 48) >= v65)
            {
              v71 = *(a1 + 32);
              if (v71)
              {
                if (CFDictionaryGetValue(v71, @"atjHistTblEntUserPromptPending") == kCFBooleanTrue)
                {
                  v72 = objc_autoreleasePoolPush();
                  if (off_100298C40)
                  {
                    [off_100298C40 WFLog:3 message:{"ATJManager: prompt user for action=%d", a4}];
                  }

                  objc_autoreleasePoolPop(v72);
                  a2 = 1;
                }
              }
            }
          }

          goto LABEL_119;
        }
      }

      else
      {
        v17 = *(a1 + 48);
        sub_10000847C();
        v18 = 60.0;
        if (!v19)
        {
          v18 = 25.0;
        }

        if (v17 > v18)
        {
          v20 = *(a1 + 32);
          if (v20)
          {
            valuePtr = v17 + sub_1001AE568(*(a1 + 32));
            v21 = CFNumberCreate(kCFAllocatorDefault, kCFNumberDoubleType, &valuePtr);
            if (v21)
            {
              v22 = v21;
              CFDictionarySetValue(v20, @"atjHistTblEntInRangeTime", v21);
              CFRelease(v22);
            }
          }

          if (!*(a1 + 56))
          {
            v23 = *(a1 + 24);
            if (v23)
            {
              v24 = *(a1 + 32);
              v81.length = CFArrayGetCount(*(a1 + 24));
              v81.location = 0;
              if (CFArrayContainsValue(v23, v81, v24))
              {
                v34 = objc_autoreleasePoolPush();
                if (off_100298C40)
                {
                  [off_100298C40 WFLog:3 message:{"ATJManager: atjTableEntry already exists in table", v74, v75, v76}];
                }
              }

              else
              {
                CFArrayGetCount(*(a1 + 24));
                sub_10000847C();
                v26 = 5;
                if (v19)
                {
                  v26 = 64;
                }

                if (v25 >= v26)
                {
                  v27 = *(a1 + 24);
                  v82.length = CFArrayGetCount(v27);
                  v82.location = 0;
                  CFArraySortValues(v27, v82, sub_1001116B0, 0);
                  if (*(a1 + 32))
                  {
                    if (*(a1 + 56))
                    {
                      v28 = *(a1 + 24);
                      v83.length = CFArrayGetCount(v28);
                      v83.location = 0;
                      FirstIndexOfValue = CFArrayGetFirstIndexOfValue(v28, v83, *(a1 + 32));
                      if (FirstIndexOfValue != -1)
                      {
                        CFArrayRemoveValueAtIndex(*(a1 + 24), FirstIndexOfValue);
                        CFArrayInsertValueAtIndex(*(a1 + 24), 0, *(a1 + 32));
                      }
                    }
                  }

                  v30 = *(a1 + 24);
                  sub_10000847C();
                  if (v19)
                  {
                    v31 = 63;
                  }

                  else
                  {
                    v31 = 4;
                  }

                  CFArrayGetCount(v30);
                  sub_10000847C();
                  v33 = -5;
                  if (v19)
                  {
                    v33 = -64;
                  }

                  v84.length = v32 + v33 + 1;
                  v84.location = v31;
                  CFArrayReplaceValues(v30, v84, 0, 0);
                }

                CFArrayAppendValue(*(a1 + 24), v24);
                v34 = objc_autoreleasePoolPush();
                if (off_100298C40)
                {
                  [off_100298C40 WFLog:3 message:{"ATJManager: %ld entries in atjHistory Table, add %@ to %@", CFArrayGetCount(*(a1 + 24)), v24, *(a1 + 24)}];
                }
              }
            }

            else
            {
              v34 = objc_autoreleasePoolPush();
              if (off_100298C40)
              {
                [off_100298C40 WFLog:3 message:{"%s, ATJManager: atj table is NULL", "__WiFiATJMgrATJHistTblAddEntry"}];
              }
            }

            objc_autoreleasePoolPop(v34);
          }
        }

        v42 = objc_autoreleasePoolPush();
        if (off_100298C40)
        {
          v43 = "monitored";
          if (!*(a1 + 56))
          {
            v43 = "unmonitored";
          }

          [off_100298C40 WFLog:3 message:{"ATJManager: device moved from %s atj point after %f seconds", v43, *(a1 + 48)}];
        }

        objc_autoreleasePoolPop(v42);
        v44 = *(a1 + 32);
        if (v44)
        {
          CFRelease(v44);
          *(a1 + 32) = 0;
        }

        *(a1 + 48) = 0;
        *(a1 + 56) = 0;
      }
    }

    if (CFArrayGetCount(a2) && (v45 = CFArrayGetCount(*(a1 + 24)), v45 >= 1))
    {
      v66 = v45;
      v67 = 0;
      while (1)
      {
        v68 = CFArrayGetValueAtIndex(*(a1 + 24), v67);
        if (v68)
        {
          if (sub_1001AE46C(v68, a2))
          {
            break;
          }
        }

        if (v66 == ++v67)
        {
          goto LABEL_71;
        }
      }

      v69 = CFArrayGetValueAtIndex(*(a1 + 24), v67);
      a2 = 0;
      *(a1 + 32) = CFRetain(v69);
      *(a1 + 56) = 1;
    }

    else
    {
LABEL_71:
      valuePtr = 0.0;
      v46 = CFArrayGetCount(a2);
      if (v46 && (v47 = v46, (v48 = CFDateCreate(kCFAllocatorDefault, v9)) != 0))
      {
        v49 = v48;
        v50 = CFNumberCreate(kCFAllocatorDefault, kCFNumberDoubleType, &valuePtr);
        if (v50)
        {
          v51 = v50;
          Mutable = CFArrayCreateMutable(kCFAllocatorDefault, 0, &kCFTypeArrayCallBacks);
          if (Mutable)
          {
            v53 = Mutable;
            v54 = CFDictionaryCreateMutable(kCFAllocatorDefault, 0, &kCFTypeDictionaryKeyCallBacks, &kCFTypeDictionaryValueCallBacks);
            v55 = v54;
            if (v54)
            {
              v77 = a4;
              CFDictionaryAddValue(v54, @"atjHistTblEntCreationTimeStamp", v49);
              CFDictionaryAddValue(v55, @"atjHistTblEntLastSeenTimeStamp", v49);
              CFDictionaryAddValue(v55, @"atjHistTblEntInRangeTime", v51);
              CFDictionarySetValue(v55, @"atjHistTblEntUserPromptPending", kCFBooleanTrue);
              if (v47 >= 1)
              {
                for (i = 0; i != v47; ++i)
                {
                  if (CFArrayGetCount(v53) > 4)
                  {
                    break;
                  }

                  v57 = CFArrayGetValueAtIndex(a2, i);
                  if (v57)
                  {
                    v58 = sub_10000A540(v57, @"BSSID");
                    if (v58)
                    {
                      v59 = v58;
                      v85.length = CFArrayGetCount(v53);
                      v85.location = 0;
                      if (!CFArrayContainsValue(v53, v85, v59))
                      {
                        CFArrayAppendValue(v53, v59);
                      }
                    }
                  }
                }
              }

              CFDictionaryAddValue(v55, @"atjHistTblEntBSSIDList", v53);
              if (!CFArrayGetCount(v53))
              {
                CFRelease(v55);
                v55 = 0;
              }

              a4 = v77;
            }

            CFRelease(v53);
          }

          else
          {
            v55 = 0;
          }

          CFRelease(v51);
        }

        else
        {
          v55 = 0;
        }

        CFRelease(v49);
      }

      else
      {
        v55 = 0;
      }

      *(a1 + 32) = v55;
      *(a1 + 56) = 0;
      a2 = a4 == 2;
    }

    *(a1 + 48) = 0;
    v60 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      v61 = "monitored";
      if (!*(a1 + 56))
      {
        v61 = "unmonitored";
      }

      [off_100298C40 WFLog:3 message:{"ATJManager: device detected at a previously %s atj point", v61}];
    }

    objc_autoreleasePoolPop(v60);
    v40 = *(a1 + 32);
    if (!v40)
    {
      goto LABEL_98;
    }

    goto LABEL_96;
  }

LABEL_119:
  *(a1 + 40) = v9;
  sub_1001AD798(a1);
  return a2;
}

uint64_t sub_1001AE46C(const __CFDictionary *a1, CFArrayRef theArray)
{
  Count = CFArrayGetCount(theArray);
  result = 0;
  if (theArray)
  {
    if (Count)
    {
      result = CFDictionaryGetValue(a1, @"atjHistTblEntBSSIDList");
      if (result)
      {
        v6 = result;
        v7 = CFArrayGetCount(result);
        if (v7 >= 1)
        {
          v8 = v7;
          v9 = 0;
          while (1)
          {
            ValueAtIndex = CFArrayGetValueAtIndex(v6, v9);
            if (ValueAtIndex)
            {
              if (Count >= 1)
              {
                break;
              }
            }

LABEL_14:
            if (++v9 == v8)
            {
              return 0;
            }
          }

          v11 = ValueAtIndex;
          v12 = 0;
          while (1)
          {
            v13 = CFArrayGetValueAtIndex(theArray, v12);
            if (v13)
            {
              v14 = sub_10000A540(v13, @"BSSID");
              if (v14)
              {
                if (CFEqual(v11, v14))
                {
                  return 1;
                }
              }
            }

            if (Count == ++v12)
            {
              goto LABEL_14;
            }
          }
        }

        else
        {
          return 0;
        }
      }
    }
  }

  return result;
}

double sub_1001AE568(const __CFDictionary *a1)
{
  valuePtr = 0;
  v1 = 0.0;
  if (a1)
  {
    Value = CFDictionaryGetValue(a1, @"atjHistTblEntInRangeTime");
    if (Value)
    {
      return CFNumberGetValue(Value, kCFNumberDoubleType, &valuePtr);
    }

    else
    {
      v4 = objc_autoreleasePoolPush();
      if (off_100298C40)
      {
        [off_100298C40 WFLog:4 message:"atjTableEntry does not have in range time"];
      }

      objc_autoreleasePoolPop(v4);
    }
  }

  return v1;
}

void sub_1001AE5F8(uint64_t a1)
{
  if (a1)
  {
    v1 = *(a1 + 32);
    if (v1)
    {
      CFDictionarySetValue(v1, @"atjHistTblEntUserPromptPending", kCFBooleanFalse);
    }
  }
}

void sub_1001AE678(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: from scan result not found for notification (%@)", "-[WiFiUserNotificationManager userNotificationCenter:didReceiveNotificationResponse:withCompletionHandler:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001AE6E8(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: to scan result not found for notification (%@)", "-[WiFiUserNotificationManager userNotificationCenter:didReceiveNotificationResponse:withCompletionHandler:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001AE758()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: notifyReason is nil", "-[WiFiUserNotificationManager userNotificationCenter:didReceiveNotificationResponse:withCompletionHandler:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AE7C4(uint64_t a1)
{
  v2 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: recommendation not found for notification (%@)", "-[WiFiUserNotificationManager userNotificationCenter:didReceiveNotificationResponse:withCompletionHandler:]", a1}];
  }

  objc_autoreleasePoolPop(v2);
}

void sub_1001AE834()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: no scan results", "-[WiFiTimeDeferredNetworksAJManager setScanResultsWithAutoJoinSessionCompletion:complete:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AE8A0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: scanResults NULL", "-[WiFiTimeDeferredNetworksAJManager setScanResultsWithAutoJoinSessionCompletion:complete:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AE99C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"failed to create SFRemoteHotspotSession"];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001AE9E8()
{
  v0 = objc_autoreleasePoolPush();
  if (objc_opt_class())
  {
    if (!qword_100298B30)
    {
      pthread_once(&stru_100297E50, sub_100118564);
    }

    Instance = _CFRuntimeCreateInstance();
    v2 = Instance;
    if (Instance)
    {
      *(Instance + 16) = 0u;
      *(Instance + 32) = 0u;
      v3 = objc_alloc_init(AudioRouteMonitor);
      *(v2 + 40) = v3;
      [(AudioRouteMonitor *)v3 initializeWithHandler:v2];
    }
  }

  else
  {
    v2 = 0;
  }

  objc_autoreleasePoolPop(v0);
  return v2;
}

id sub_1001AEFA8(_BYTE *a1)
{
  if (*a1)
  {
    v1 = [NSString stringWithUTF8String:a1];
  }

  else
  {
    v1 = @"??????";
  }

  result = [(__CFString *)v1 hasPrefix:@"WiFiDebug"];
  if ((result & 1) == 0)
  {
    v3 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:2 message:{"Log collection started (event=DumpLogs, reason=%@)", v1}];
    }

    objc_autoreleasePoolPop(v3);
    result = objc_alloc_init(sub_10011ABC0());
    if (result)
    {
      v4 = result;
      v8 = @"Reason";
      v9 = v1;
      result = [sub_10011ACAC() requestWithItemID:71 configuration:{+[NSDictionary dictionaryWithObjects:forKeys:count:](NSDictionary, "dictionaryWithObjects:forKeys:count:", &v9, &v8, 1)}];
      if (result)
      {
        v6[0] = @"Reason";
        v6[1] = @"Compress";
        v7[0] = v1;
        v7[1] = &__kCFBooleanTrue;
        v5 = result;
        return [v4 collectLogs:+[NSArray arrayWithObjects:count:](NSArray configuration:"arrayWithObjects:count:" update:&v5 reply:{1), +[NSDictionary dictionaryWithObjects:forKeys:count:](NSDictionary, "dictionaryWithObjects:forKeys:count:", v7, v6, 2), 0, &stru_100263450}];
      }
    }
  }

  return result;
}

id sub_1001AF130(_BYTE *a1)
{
  if (*a1)
  {
    v1 = [NSString stringWithUTF8String:a1];
  }

  else
  {
    v1 = @"??????";
  }

  result = [(__CFString *)v1 hasPrefix:@"WiFiDebug"];
  if ((result & 1) == 0)
  {
    v3 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:2 message:{"Log collection started (event=DatapathStall, reason=%@)", v1}];
    }

    objc_autoreleasePoolPop(v3);
    result = objc_alloc_init(sub_10011ABC0());
    if (result)
    {
      v4 = result;
      result = [sub_10011ACAC() requestWithItemID:72 configuration:0];
      if (result)
      {
        v6[0] = @"Reason";
        v6[1] = @"Compress";
        v7[0] = v1;
        v7[1] = &__kCFBooleanTrue;
        v5 = result;
        return [v4 collectLogs:+[NSArray arrayWithObjects:count:](NSArray configuration:"arrayWithObjects:count:" update:&v5 reply:{1), +[NSDictionary dictionaryWithObjects:forKeys:count:](NSDictionary, "dictionaryWithObjects:forKeys:count:", v7, v6, 2), 0, &stru_100263470}];
      }
    }
  }

  return result;
}

void sub_1001AFDF4(void *a1)
{
  v1 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null clientPath", "-[WiFiUserInteractionMonitorNetworkAgent assertAgentWithOptions:]"}];
  }

  objc_autoreleasePoolPop(v1);
}

void sub_1001AFE6C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null clientUUID", "-[WiFiUserInteractionMonitorNetworkAgent assertAgentWithOptions:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AFED8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null userInfo", "-[WiFiUserInteractionMonitorNetworkAgent assertAgentWithOptions:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AFF44()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: notify token is null", "-[WiFiUserInteractionMonitor _notifyCaptiveWithApplicationState]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001AFFB0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"Invalid cellular interface name\n"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0008()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"Invalid cellular connection reference\n"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0060()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:"Invalid dictionary\n"];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B02B0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:4 message:{"%s: null incoming data.", "-[WiFiIDSSyncEngine service:account:incomingData:fromID:context:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B031C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null network", "-[WiFiIDSSyncEngine updateGuessedNetworkCredentials:password:]"}];
  }

  objc_autoreleasePoolPop(v0);
}

uint64_t sub_1001B0388(void *a1)
{
  v2 = objc_autoreleasePoolPush();
  if (!a1)
  {
    v7 = objc_autoreleasePoolPush();
    if (off_100298C40)
    {
      [off_100298C40 WFLog:3 message:{"%s: null syncFormattedNetworkRecord", "WiFiNetworkSyncHelperGetNetworkSecurity"}];
    }

    objc_autoreleasePoolPop(v7);
    goto LABEL_7;
  }

  v3 = [a1 objectForKey:@"WEP"];
  if (v3 && ([v3 BOOLValue] & 1) != 0)
  {
    v4 = 1;
  }

  else if ([a1 objectForKey:@"WPA3_RSN_IE"])
  {
    v4 = 4;
  }

  else if ([a1 objectForKey:@"RSN_IE"])
  {
    v4 = 3;
  }

  else
  {
    if (![a1 objectForKey:@"WPA_IE"])
    {
LABEL_7:
      v4 = 0;
      goto LABEL_8;
    }

    v4 = 2;
  }

LABEL_8:
  v5 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: <%@> security %d", "WiFiNetworkSyncHelperGetNetworkSecurity", objc_msgSend(a1, "objectForKey:", @"SSID_STR", v4}];
  }

  objc_autoreleasePoolPop(v5);
  objc_autoreleasePoolPop(v2);
  return v4;
}

void sub_1001B04D8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: network object passed in is not WiFiNetwork type", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0544()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null customNetworkSetDictRef", "__WiFiNetworkSyncHelperIsCustomNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B05B0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: error - null apMode", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B061C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null ssid... abort", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0688()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networkRecord", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B06F4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null cloudNetwork", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0760()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B07CC()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networkRef ", "WiFiNetworkSyncHelperCreateSyncableNetworkRecord"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0838()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null network", "WiFiNetworkSyncHelperSanitizeNetwork"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B08A4()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null WIFICLOUDSYNC_NETWORKKEY_SSID", "WiFiNetworkSyncHelperCreateNetworkRef"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0910()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networkRecord", "WiFiNetworkSyncHelperCreateNetworkRef"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B097C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null cloudNetworkDict", "WiFiNetworkSyncHelperCreateNetworkRef"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B09E8()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "WiFiNetworkSyncHelperAddNetworkToPlist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0A54()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networkRef ", "WiFiNetworkSyncHelperAddNetworkToPlist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0AC0()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null manager", "WiFiNetworkSyncHelperRemoveNetworkFromPlist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0B2C()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"%s: null networkRef ", "WiFiNetworkSyncHelperRemoveNetworkFromPlist"}];
  }

  objc_autoreleasePoolPop(v0);
}

void sub_1001B0B98()
{
  v0 = objc_autoreleasePoolPush();
  if (off_100298C40)
  {
    [off_100298C40 WFLog:3 message:{"Error: %s: eventObject is null", "__WiFiCoexManagerHandleEvent"}];
  }

  objc_autoreleasePoolPop(v0);
}

CFRange CFStringFind(CFStringRef theString, CFStringRef stringToFind, CFStringCompareFlags compareOptions)
{
  v5 = _CFStringFind(theString, stringToFind, compareOptions);
  length = v5.length;
  location = v5.location;
  result.length = length;
  result.location = location;
  return result;
}

CLLocationCoordinate2D CLLocationCoordinate2DMake(CLLocationDegrees latitude, CLLocationDegrees longitude)
{
  v4 = _CLLocationCoordinate2DMake(latitude, longitude);
  v3 = v4.longitude;
  v2 = v4.latitude;
  result.longitude = v3;
  result.latitude = v2;
  return result;
}